5.6.2.  Aggregated and Distributed Claims
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Aggregated and distributed Claims are represented 
by using special _claim_names and _claim_sources members 
of the JSON object containing the Claims.

.. glossary::

    _claim_names
        JSON object whose member names are the Claim Names 
        for the Aggregated and Distributed Claims. 

        The member values are references to the member names 
        in the :term:`_claim_sources` member 
        from which the actual Claim Values can be retrieved.

    _claim_sources
        JSON object whose member names are referenced 
        by the member values of the _claim_names member. 

        The member values contain sets of Aggregated Claims 
        or reference locations for Distributed Claims. 

        The member values can have one of the following formats 
        depending on whether it is providing Aggregated or Distributed Claims:

            Aggregated Claims
                JSON object that MUST contain the JWT member 
                whose value is a JWT [JWT] that MUST contain all the Claims 
                in the _claim_names object that references 
                the corresponding _claim_sources member. 

                Other members MAY be present. 

                Any members used that are not understood MUST be ignored.

                    JWT
                        REQUIRED. 

                        JWT containing Claim Values.

                The JWT SHOULD NOT contain a sub (subject) Claim 
                unless its value is an identifier for the End-User 
                at the Claims Provider 
                (and not for the OpenID Provider or another party); 
                this typically means that a sub Claim SHOULD NOT be provided.

            Distributed Claims
                JSON object that contains the following members and values:

                    endpoint
                        REQUIRED. 
        
                        OAuth 2.0 resource endpoint 
                        from which the associated Claim can be retrieved. 

                        The endpoint URL MUST return the Claim as a JWT.

                        .. note::
                            - JWT で返す事

                    access_token
                        OPTIONAL. 

                        Access Token enabling retrieval of the Claims 
                        from the endpoint URL 
                        by using the :doc:`OAuth 2.0 Bearer Token Usage <oauth_bearer>` 
                        [RFC6750] protocol. 

                        Claims SHOULD be requested using the Authorization Request header field 
                        and Claims Providers MUST support this method. 

                        If the Access Token is not available, 
                        RPs MAY need to retrieve the Access Token out of band 
                        or use an Access Token that was pre-negotiated 
                        between the Claims Provider and RP, 
                        or the Claims Provider MAY reauthenticate the End-User 
                        and/or reauthorize the RP.

                        .. note::
                            - トークン

                                1. UserInfoで返す
                                2. 事前に手に入れる                                
                                3. CPに認証要求される/RPを再認可する

                A :term:`sub` (subject) Claim SHOULD NOT be returned 
                from the Claims Provider unless its value is an identifier 
                for the End-User at the Claims Provider 
                (and not for the OpenID Provider or another party); 
                this typically means that a sub Claim SHOULD NOT be provided.

                .. note::
                    - CPはサブジェクトは(本人以外には)返さないこと。

In general, 
it is up to the OP when it is appropriate 
to use Aggregated Claims and Distributed Claims. 

In some cases, 
information about when to use what Claim Types might be negotiated 
out of band between RPs and OPs.

(draft17)
