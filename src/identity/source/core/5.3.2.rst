5.3.2.  Successful UserInfo Response
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The UserInfo Claims MUST be returned as the members of a JSON object 
unless a signed or encrypted response was requested during Client Registration. 
The Claims defined in Section 5.1 can be returned, 
as can additional Claims not specified there.

For privacy reasons, 
OpenID Providers MAY elect to not return values for some requested Claims.

If a Claim is not returned, 
that Claim Name SHOULD be omitted from the JSON object representing the Claims; 
it SHOULD NOT be present with a null or empty string value.

The :term:`sub` (subject) Claim MUST always be returned in the UserInfo Response.

NOTE: 

    Due to the possibility of token substitution attacks 
    (see Section 16.11), 
    the UserInfo Response is not guaranteed to be about the End-User identified 
    by the sub (subject) element of the ID Token. 

    The sub Claim in the UserInfo Response MUST be verified to exactly match 
    the sub Claim in the ID Token; 
    if they do not match, 
    the UserInfo Response values MUST NOT be used.

Upon receipt of the UserInfo Request, 
the UserInfo Endpoint MUST return the JSON Serialization of the UserInfo Response 
as in Section 13.3 in the HTTP response body 
unless a different format was specified during Registration [OpenID.Registration]. 
The UserInfo Endpoint MUST return a content-type header to indicate 
which format is being returned. 
The content-type of the HTTP response MUST be application/json 
if the response body is a text JSON object; 
the response body SHOULD be encoded using UTF-8.

If the UserInfo Response is signed and/or encrypted, 
then the Claims are returned in a JWT 
and the content-type MUST be application/jwt. 

The response MAY be encrypted without also being signed. 
If both signing and encryption are requested, 
the response MUST be signed then encrypted, 
with the result being a Nested JWT, as defined in [JWT].

If signed, 
the UserInfo Response SHOULD contain the Claims :term:`iss` (issuer) 
and :term:`aud` (audience) as members. 
The iss value SHOULD be the OP's Issuer Identifier URL. 
The aud value SHOULD be or include the RP's Client ID value.

The following is a non-normative example of a UserInfo Response:

::

  HTTP/1.1 200 OK
  Content-Type: application/json

  {
   "sub": "248289761001",
   "name": "Jane Doe",
   "given_name": "Jane",
   "family_name": "Doe",
   "preferred_username": "j.doe",
   "email": "janedoe@example.com",
   "picture": "http://example.com/janedoe/me.jpg"
  }

(draft17)
