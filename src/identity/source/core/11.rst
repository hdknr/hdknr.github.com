11.  Offline Access
====================================

OpenID Connect defines the following scope value to request offline access:

.. glossary::

    offline_access
        OPTIONAL. 

        This scope value requests that an OAuth 2.0 :term:`Refresh Token` be issued 
        that can be used to obtain an Access Token that grants access 
        to the End-User's UserInfo Endpoint 
        even when the End-User is not present (not logged in).

When offline access is requested, 
a prompt parameter value of consent MUST be used 
unless other conditions for processing the request permitting offline access 
to the requested resources are in place. 

The OP MUST always obtain consent to returning a Refresh Token 
that enables offline access to the requested resources. 

A previously saved user consent is not always sufficient 
to grant offline access.

Upon receipt of a scope parameter 
containing the offline_access value, the Authorization Server:

    -   MUST ensure that the prompt parameter contains consent 
        unless other conditions for processing the request permitting offline access 
        to the requested resources are in place; 
        unless one or both of these conditions are fulfilled, 
        then it MUST ignore the offline_access request,

    -   MUST ignore the offline_access request 
        unless the Client is using a :term:`response_type` value 
        that would result in an :term:`Authorization Code` being returned,

    -   MUST explicitly receive or have consent for all Clients 
        when the registered :term:`application_type` is **web**,

    -   SHOULD explicitly receive or have consent for all Clients 
        when the registered :term:`application_type` is **native**.

The use of Refresh Tokens is not exclusive to the offline_access use case. 

The Authorization Server MAY grant Refresh Tokens 
in other contexts that are beyond the scope of this specification.

(draft17)
