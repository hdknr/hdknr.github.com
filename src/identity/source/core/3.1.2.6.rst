3.1.2.6.  Authentication Error Response
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

An Authentication Error Response is an OAuth 2.0 Authorization Error Response message 
returned from the OP's Authorization Endpoint 
in response to the Authorization Request message sent by the RP.

If the End-User denies the request or the End-User authentication fails, 
the OP (Authorization Server) informs the RP (Client) 
by using the Error Response parameters 
defined in :ref:`Section 4.1.2.1 <oauth.4.1.2.1>` of OAuth 2.0 :ref:`[RFC6749]`. 
(HTTP errors unrelated to RFC 6749 are returned to the User Agent 
using the appropriate HTTP status code.)

Unless the Redirection URI is invalid, 
the Authorization Server returns the Client to the Redirection URI 
specified in the Authorization Request with the appropriate error 
and state parameters. 
Other parameters SHOULD NOT be returned.

In addition to the error codes defined in :ref:`Section 4.1.2.1 of OAuth 2.0 <oauth.4.1.2.1>`, 
this specification also defines the following error codes:

.. glossary::
    
    interaction_required
        The Authorization Server requires End-User interaction of some form to proceed. This error MAY be returned when the prompt parameter value in the Authentication Request is none, but the Authentication Request cannot be completed without displaying a user interface for End-User interaction.

    login_required
        The Authorization Server requires End-User authentication. This error MAY be returned when the prompt parameter value in the Authentication Request is none, but the Authentication Request cannot be completed without displaying a user interface for End-User authentication.

    account_selection_required
        The End-User is REQUIRED to select a session at the Authorization Server. The End-User MAY be authenticated at the Authorization Server with different associated accounts, but the End-User did not select a session. This error MAY be returned when the prompt parameter value in the Authentication Request is none, but the Authentication Request cannot be completed without displaying a user interface to prompt for a session to use.

    consent_required
        The Authorization Server requires End-User consent. This error MAY be returned when the prompt parameter value in the Authentication Request is none, but the Authentication Request cannot be completed without displaying a user interface for End-User consent.
    
    invalid_request_uri
        The request_uri in the Authorization Request returns an error or contains invalid data.

    invalid_request_object
        The request parameter contains an invalid Request Object.

    request_not_supported
        The OP does not support use of the request parameter defined in Section 6.

    request_uri_not_supported
        The OP does not support use of the request_uri parameter defined in Section 6.

    registration_not_supported
        The OP does not support use of the registration parameter defined in Section 7.2.1.

The error response parameters are the following:

.. glossary::

    error
        REQUIRED. Error code.

    error_description
        OPTIONAL. Human-readable ASCII encoded text description of the error.

    error_uri
        OPTIONAL. URI of a web page that includes additional information about the error.

    state
        OAuth 2.0 state value. 

        REQUIRED 
        if the Authorization Request included the state parameter. 

        Set to the value received from the Client.

When using the Authorization Code Flow, 
the error response parameters are added to the query component of the Redirection URI, 
unless a different Response Mode was specified.

The following is a non-normative example error response 
using this flow (with line wraps within values for display purposes only):

::

  HTTP/1.1 302 Found

  Location: https://client.example.org/cb?
    error=invalid_request
    &error_description=
      Unsupported%20response_type%20value
    &state=af0ifjsldkj

