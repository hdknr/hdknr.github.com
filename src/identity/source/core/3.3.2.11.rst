3.3.2.11.  ID Token
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

The contents of the ID Token are as described in :ref:`Section 2 <core.2>`. 
When using the Hybrid Flow, 
these additional requirements for the following ID Token Claims apply 
to an ID Token returned from the Authorization Endpoint:

.. glossary::

    nonce
        Use of the :term:`nonce` Claim is REQUIRED for this flow.


    at_hash
        Access Token hash value. 

        Its value is the base64url encoding of the left-most half 
        of the hash of the octets of the ASCII representation 
        of the access_token value, 
        where the hash algorithm used is the hash algorithm 
        used in the alg header parameter of the ID Token's JWS [JWS] header. 

        For instance, 
        if the alg is RS256, hash the access_token value with SHA-256, 
        then take the left-most 128 bits and base64url encode them. 

        The at_hash value is a case sensitive string.

        If the ID Token is issued from the Authorization Endpoint 
        with an :term:`access_token` value, 
        which is the case for the :term:`response_type` value :term:`code id_token token`, this is REQUIRED; 
        otherwise, its inclusion is OPTIONAL.

    c_hash
        Code hash value. 

        Its value is the :term:`base64url` encoding of the left-most half 
        of the hash of the octets of the ASCII representation 
        of the :term:`code` value, 
        where the hash algorithm used is the hash algorithm 
        used in the alg header parameter of the ID Token's JWS [JWS] header. 

        For instance, 
        if the alg is HS512, hash the code value with SHA-512, 
        then take the left-most 256 bits and base64url encode them. 

        The c_hash value is a case sensitive string.

        If the ID Token is issued from the Authorization Endpoint with a :term:`code`, 
        which is the case for the :term:`response_type` values :term:`code id_token` 
        and :term:`code id_token token`, this is REQUIRED; 
        otherwise, its inclusion is OPTIONAL.


(draft17)
