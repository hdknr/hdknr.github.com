.. _oauth_auth.authreq:

2.1.  Authentication Request
--------------------------------------------

.. note::
    - :ref:`OpenID Connect AuthReq <basic.authreq>`

In addition to the parameters defined in Section 4.1.1 [RFC6749], the
following additional parameters are defined:


.. glossary::

   min_alv 
           OPTIONAL.  A value of "1", "2", "3", or "4".  The minimum
           requested authentication assurance level as defined by
           [ISO29115] (see also [NIST_SP-800-63-2]).  If the
           authorization server is unable to meet or exceed the
           requested authentication assurance level, the server SHALL
           return an "unsupported_response_type" error per section
           4.1.2.1 [RFC6749]. [[should there be a specific error_uri
           value for alv not supported?]] When the value is omitted, the
           authorization server MAY choose any authentication assurance
           level.

   prompt
           OPTIONAL.  Space delimited, case sensitive list of ASCII
           string values that specifies whether the Authorization Server
           prompts the End-User for reauthentication and consent.  The
           defined values are:

           none    
                   The suthorization server MUST NOT display any
                   authentication or consent user interface pages.  An
                   error is returned if the End-User is not already
                   authenticated or the Client does not have pre-
                   configured consent for the requested Claims or does
                   not fulfill other conditions for processing.  This
                   can be used as a method to check for existing
                   authentication and/or consent.

           login   
                   Regardless of the current user authentication state,
                   the Authorization Server SHOULD prompt the End-User
                   for reauthentication.  If it cannot prompt the End-
                   User, it MUST return an error.

           select_account  
                   The Authorization Server SHOULD prompt the
                   End-User to select a user account.  This allows an
                   End-User who has multiple accounts at the
                   Authorization Server to select amongst the multiple
                   accounts that they might have current sessions for.

                   If it cannot prompt the End-User, it MUST return an
                   error.

   hint
           OPTIONAL.  A helpful text message that should be displayed to
           the user during a re-authentication or re-authorization
           process.

For xample, the client directs the user-agent to make the following
HTTP request using TLS (with extra line breaks for display purposes only):

::

    GET /authenticate?
    response_type=code
    &client_id=s6BhdRkqt3
    &redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
    &state=af0ifjsldkj
    &prompt=login
    Host: server.example.com


The authorization server MUST:

   -  Perform the normal OAuth2 authorization process,

   -  MAY elect not to request consent if no access token is to be issued
      (i.e. this is an authentication only request),

   -  MUST re-authenticate the user if "prompt" contains the parameter "login",

   -  MUST obtain consent from the user if "prompt" contains the
      parameter "consent", and,

   -  MUST return an error if "prompt" contains "none" and the user is
      not currently authenticated.


