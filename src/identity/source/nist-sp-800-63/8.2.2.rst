8.2.2. Level 2
^^^^^^^^^^^^^^^^^

Level 2 allows a wide range of available authentication technologies to be employed 
and permits the use of any of the token methods of Levels 3 or 4, as well as passwords. 
Successful authentication requires that the :term:`claimant` shall prove, through a secure authentication protocol, 
that he/she controls the token. 
Eavesdropper, replay, and on-line guessing attacks shall be prevented. 
Approved cryptography is required to prevent eavesdroppers.

8.2.2.1.Credential and Token Lifetime, Status or Revocation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

:term:`CSPs <CSP>` shall provide a secure mechanism, such as a digitally signed revocation list or a status responder, 
to allow verifiers or relying parties to ensure that the credentials are still valid. 
Verifiers or relying parties shall check to ensure that the credentials they use are valid.  
Shared secret based authentication systems may simply remove revoked subscribers from the verification database.

CSPs shall revoke credentials and tokens within **72 hours** after being notified that a credential is no longer valid 
or a token is compromised to ensure that a claimant using the token cannot successfully be authenticated. 
If the CSP issues credentials that expire automatically within 72 hours 
(e.g. issues fresh certificates with a 24 hour validity period each day) 
then the CSP is not required to provide an explicit mechanism to revoke the credentials. 
CSPs that register passwords shall ensure that the revocation or 
de-registration of the password can be accomplished in no more than 72 hours and 
that the use of that password in authentication shall fail.

CAs cross-certified with the Federal Bridge CA at the Basic, Medium, High, Citizen and Commerce Class, or Common Certificate Policy levels are considered to meet credential status and revocation provisions of this level.



8.2.2.2.Assertions
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Relying parties may accept assertions that are: 

- digitally signed by a trusted entity (e.g., the verifier); or
- obtained directly from a trusted entity 
  (e.g. a repository or the verifier) using a protocol 
  where the trusted entity authenticates to the relying party using a secure protocol (e.g. TLS) 
  that cryptographically authenticates the verifier and protects the assertion;

Assertions generated by a verifier shall expire after **12 hours** and should not be accepted thereafter by the relying party.


8.2.2.3.Protection of Long-term Shared Secrets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Long term shared authentication secrets, if used, 
shall never be revealed to any party except the subscriber and CSP (including verifiers operated as a part of the CSP), 
however session (temporary) shared secrets may be provided by the CSP to independent verifiers.

Files of shared secrets used by CSPs at Level 2 shall be protected by discretionary access controls 
that limit access to administrators and only those applications that require access. 
Such shared secret files shall not contain the plaintext passwords or secret; 
two alternative methods may be used to protect the shared secret:


    1.  Passwords may be concatenated to a salt and/or username and then hashed with a Approved algorithm 
        so that the computations used to conduct a dictionary or exhaustion attack on a stolen password file    
        are not useful to attack other similar password files. The hashed passwords are then stored in the password file.

    2.  Store shared secrets in encrypted form using Approved encryption algorithms and modes 
        and decrypt the needed secret only when immediately required for authentication. 
        In addition any method allowed to protect shared secrets at Level 3 or 4 may be used at Level 2.


8.2.2.4.Password Strength
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

For password based Level 2 authentication systems, 
the probability of success of an on-line password guessing attack by an attacker 
who has no a priori knowledge of the password, but knows the user name of the target, 
shall not exceed 2-14 (1 in 16,384), over the life of the password. 

Level 2 passwords shall have at least 10 bits of min-entropy. 
:ref:`Appendix A <nist-800-63.appendix.a>` contains information about estimating the entropy of passwords.


8.2.2.5.Example Implementations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

A wide variety of technologies can meet the requirements of Level 2. 
For example, a verifier might authenticate a claimant who provides a password 
through a secure (encrypted) TLS protocol session (tunneling). 

This prevents eavesdropper attacks, but generally does not adequately block not man-in-the middle attacks 
or verification impersonation attacks because common web browser clients offer many avenues to fool or trick users. 

After a successful authentication, 
the verifier then puts a security assertion for the claimant in a secure server, 
and sends a “handle” for that assertion to a relying party in an HTTP referral.


Summary 
~~~~~~~~~

 +------------------------------+---------------------------------------------------------------+
 | Registration and Issuance    | Anonymous credentials permitted,                              |
 |                              | no explicit requirements Otherwise,                           |
 |                              | valid government ID (in person)                               |
 |                              | or Valid gov’t ID and financial account numbers (remote)      |
 +------------------------------+---------------------------------------------------------------+ 
 | Tokens                       | 
 |                              |
 +------------------------------+---------------------------------------------------------------+
 | Token and                    |
 | Credential Management        |                                                               |   
 +------------------------------+---------------------------------------------------------------+
 | Authentication Process       |
 +------------------------------+---------------------------------------------------------------+
 | Assertions                   |
 |                              |
 +------------------------------+---------------------------------------------------------------+

