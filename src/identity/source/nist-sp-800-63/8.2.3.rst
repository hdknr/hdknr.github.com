8.2.3. Level 3
^^^^^^^^^^^^^^^^^^

Level 3 authentication is based on proof of possession of a cryptographic key using a cryptographic protocol. 
Level 3 authentication assurance requires cryptographic strength mechanisms that protect the primary authentication token 
(a secret key or a private key) against compromise by the following protocol threats defined in :ref:`section 8.1.1 <nist-800-63.8.1.1>`: 
eavesdropper, replay, on-line guessing, verifier impersonation and man-in-the-middle attacks. 

Level 3 also requires :term:`two factor authentication` ; in addition to the key, 
the user must employ a password or biometric to activate the key.

Three kinds of tokens described below may be used to meet Level 3 requirements:


    Soft cryptographic token: 
    a cryptographic key stored on a general-purpose computer. 
    Hardware tokens validated at FIPS 140-2 Level 1 or higher may also be used to hold the key 
    and perform cryptographic operations. 
    The claimant shall be required to activate the key before using it with a password or biometric, or, 
    alternatively shall use a password as well as the key in an authentication protocol with the verifier. 
    If a password is employed to unlock the soft token key, 
    the key shall be kept encrypted under a key derived from a password meeting the requirements for Level 2 authentication, 
    and decrypted only for actual use in authentication. 
    Alternatively, if a password protocol is employed with the verifier, 
    the use of the password shall meet the requirements for Level 2 authentication assurance.


    Hard token: 
    a cryptographic key stored on a special hardware device. 
    Tokens must be validated at FIPS 140-2 Level 1 or higher overall. 
    The claimant shall be required to activate the key before using it with a password or biometric, 
    or, alternatively, shall use a password as well as the key in an authentication protocol with the verifier. 
    The authentication mechanism used to authenticate the claimant to unlock token shall be validated   
    as meeting the operator authentication requirements for FIPS 140-2 Level 2. 
    Alternatively, if a password protocol is employed with a verifier, 
    the use of the password shall meet the requirements for Level 1 authentication assurance.


    One-time password device tokens: 
    the authentication depends on a symmetric key stored on a personal hardware device 
    that is a cryptographic module validated at FIPS 140-2 Level 1 or higher overall. 
    The device combines a nonce with a cryptographic key to produce an output 
    that is sent to the verifier as a password. 
    The password shall be used only once and is cryptographically generated; 
    therefore it needs no additional eavesdropper protection. 
    The one-time password output by the device shall have at least 106 possible values. 
    The verifier must be authenticated cryptographically to the claimant, 
    for example using a TLS server. 
    To protect against the use of a stolen token, one of the following measures shall be used:

        - The authentication mechanism used to authenticate the claimant to the token 
          shall be validated as meeting the operator authentication requirements for FIPS 140-2 Level 2.

        - The claimant sends the verifier a personal password meeting the requirements for (E-authentication) Level 1 
          with the one-time password.
       

Authentication requires that the claimant shall prove through a secure authentication protocol that he or she controls the token. Long-term shared authentication secrets, if used, shall never be revealed to any party except the claimant and CSP, however session (temporary) shared secrets may be provided to verifiers by the CSP. Approved cryptographic techniques shall be used for all operations.


Each of the three token types has somewhat different utility and security properties. Soft token solutions are easily realized in “thin clients” with TLS and client certificates. Moreover this solution allows not only initial authentication of claimants, but also allows the entire session, or as much of it as is security critical, to be cryptographically authenticated by a key created during the authentication process. Hard token solutions provide the additional assurance of a physical token, and users should know if their token has been stolen. Like soft tokens, hard tokens allow not only initial authentication of claimants, but also allows the entire session, or as much of it as is security critical, to be cryptographically authenticated by a key created during the authentication process. One- time password device token systems are commercially available, portable and work easily with any browser client. Like hard tokens, one-time password device tokens have the security advantage that the token is a tangible, physical object. Subscribers should know if their token is stolen, and the key is not vulnerable to network, shoulder-surfing or keyboard sniffer attacks. Unlike soft tokens or hard tokens, a session key is not created from the authentication process to authenticate subsequent data transfers.


All three token types present the eavesdroppers with similar strong cryptographic protection.   Each has its advantages and disadvantages against various types of attacks. All three offer considerably greater strength than Level 2 solutions. Application implementers with specific Level 3 authentication requirements, who need to select a particular technology should chose the one that best suits the functional needs and risks of their application. 


8.2.3.1. Credential/Token Lifetime, Status or Revocation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

CSPs shall provide a secure mechanism to allow verifiers or relying parties to ensure that the credentials are valid. Such mechanisms may include: revocation lists, on-line validation servers, and the use of credentials with short life-times or the involvement of CSP servers that have access to status records in authentication transactions. Shared secret based authentication systems may simply remove revoked subscribers from the verification database. Verifiers shall check to ensure that the credentials they use are valid.
CSPs shall have a procedure to revoke credentials and tokens within 24 hours. The certificate status provisions of CAs cross-certified with the Federal Bridge CA at the Basic, Medium, High or Common Certificate Policy levels are considered to meet credential status and revocation provisions of this level.

Verifiers shall ensure that the tokens they rely upon are either freshly issued (within 24 hours) or still valid.


8.2.3.2. Assertions
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Relying parties may accept assertions that are: 

-   digitally signed by a trusted entity (e.g., the verifier); or 
-   obtained directly from a trusted entity (e.g. a repository or the verifier) using a protocol 
    where the trusted entity authenticates to the relying party using a secure protocol (e.g. TLS) 
    that cryptographically authenticates the verifier and protects the assertion;

Assertions generated by a verifier shall expire after 2 hours and should not be accepted thereafter by the relying party.

8.2.3.3.Protection of Long-term Shared Secrets
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Files of long-term shared secrets used by CSPs or verifiers at Level 3 shall be protected by discretionary access controls that limit access to administrators and only those applications that require access. Such shared secret files shall be encrypted so that:

1.  The encryption key for the shared secret file is encrypted under a key held in a FIPS 140-2 Level 2 or higher validated hardware cryptographic module or any FIPS 140-2 Level 3 or 4 cryptographic module and decrypted only as immediately required for an authentication operation.
2.  Shared secrets are protected as a key within the boundary of a FIPS 140-2 Level 2 or higher validated hardware cryptographic module or any FIPS 140-2 Level 3 or 4 cryptographic module and is not exported in plaintext from the module.
3.  Shared secrets are split by a cryptographic secret sharing method between m separate verifier systems, so that the cooperation of n (where 2 ≤ n ≤ m) systems in a secure protocol is required to perform the authentication and an attacker who learns n-1 of the secret shares, learns nothing about the secret (except, perhaps, its size).

Temporary session authentication keys may be generated from long-term shared secret keys by CSPs and distributed to third party verifiers, in an appropriate protocol, but long- term shared secrets shall not be shared with any third parties, including third party verifiers. Session authentication keys are typically created by cryptographically combining the long term shared secret with a nonce challenge, to generate a session key. The challenge and session key are securely transmitted to the verifier. The verifier in turn sends only the challenge to the claimant, and the claimant applies the challenge to the long-term shared secret to generate the session key. Both claimant and verifier now share a session key, which can be used for authentication. Such protocols are permitted at this level provided that all keys preserve at least 80-bits of entropy and approved cryptographic algorithms (e.g., AES, SHA-1, SHA256, HMAC) are used for all operations.


8.2.3.4.Example Implementations
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Level 3 assurance can be satisfied by client authenticated TLS (implemented in all modern browsers), with claimants who have public key certificates. Other protocols with similar properties can also be used. Level 3 authentication assurance can also be met by tunneling the output of a one-time password device and a Level 1 personal password through a TLS session.

