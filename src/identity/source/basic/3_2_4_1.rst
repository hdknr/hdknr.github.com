3.2.4.1.  End-User Grants Authorization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note::

    "Grants Authorization" means that the end user grants issuing tokens at OP and OP return authz response.

If the resource owner grants the access request, 
the :term:`Authorization Server` issues an :term:`Access Token` and 
delivers it to the client by adding the following parameters to the **fragment component** of the redirection URI 
using the application/x-www-form-urlencoded format 
as defined in :ref:`Section 4.2.2 of OAuth 2.0 [OAuth.2.0] <oauth_4_2_2>` 

In the :term:`Implicit Flow` the entire response is returned in the **fragment component** of the redirect URL, 
as defined in :ref:`4.2.2 of OAuth 2.0 [OAuth.2.0] <oauth_4_2_2>`

.. glossary::

    access_token
        REQUIRED. 
        The :term:`Access Token` for the UserInfo Endpoint.

    token_type
        REQUIRED.
        Value MUST be "**bearer**"

    id_token
        REQUIRED.
        The Access Token for the :term:`Check ID Endpoint`.

    state

        REQUIRED if the state parameter in the request. 
        Clients MUST verify that the **state** value is equal to the exact value of **state** parameter 
        in the :term:`Authorization Request`. 

    expires_in
        OPTIONAL.
        The expirery time in seconds of the :term:`access_token`

.. note::
    ID Token has its own expirey.
   

The client can then use the Access Token to access protected resources at :term:`Resource Servers <resource server>`. 

.. note::
   access_token is only for UserInfo ? No. The OP can allow the token to be used for additional resources.


The following is a non-normative example. 
Line wraps after the second line is for the display purpose only::

    HTTP/1.1 302 Found
    Location: https://client.example.com/#
    access_token=SlAV32hkKG&
    token_type=bearer&
    id_token=1234567.SlAV32hkKG.abcde1234&
    expires_in=3600&
    &state=af0ifjsldkj

(Draft 15)
