5.6.2.5 ECCFullPublicKeyValidationRoutine
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ECC full public key validation refers to the process of checking all the arithmetic properties of a candidate ECC public key to ensure that it has the unique correct representation in the correct (additive) subgroup (and therefore is also in the correct EC group) specified by the associated ECC domain parameters. ECC full public key validation does not require knowledge of the associated private key and so may be done at any time by anyone. This method may be used for a static ECC public key, or an ephemeral ECC public key, when assurance of the validity of the key is obtained by method 1 or method 2 of Sections 5.6.2.1, 5.6.2.2, and 5.6.2.3.
Input:
1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
2. Q=(xQ, yQ ): A candidate ECC public key.
Process:
1.
2.
3.
4.
Verify that Q is not the point at infinity O. This can be done by inspection if the point is entered in the standard affine representation.
(Partial check of the public key for an invalid range in the EC group.)
Verify that xQ and yQ are integers in the interval [0, p-1] in the case that q is an odd prime
p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
(Ensures that each coordinate of the public key has the unique correct representation of
an element in the underlying field.) Ifqisanoddprimep,verifythat(yQ)2â‰¡(xQ)3+axQ +b(modp). Ifq=2m,verifythat(yQ)2+xQ yQ =(xQ)3+a(xQ)2+binthefinitefieldofsize2m. (Ensures that the public key is on the correct elliptic curve.)
V erify that nQ = O.
(Ensures that the public key has the correct order. Along with check 1, ensures that the public key is in the correct range in the correct EC subgroup, that is, it is in the correct EC subgroup and is not the identity element.)
Output: If any of the above checks fail, then output an error indicator. Otherwise, output an indication of successful validation.

