6.2.1 Initiator Has a Static Key Pair and Generates an Ephemeral Key Pair; Responder Has a Static Key Pair, C(1, 2)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

For these schemes, 
party U (the initiator) uses both static and ephemeral private/public key pairs. 

Party V (the responder) uses only a static private/public key pair. 

Party U and party V obtain each other’s static public keys in a trusted manner. 

.. note::
    - パブリックキーなので、 :ref:`jwe.jku` でダウンロード化、でもよい

Party U also sends its ephemeral public key to party V. 

.. note::
    - :ref:`jwa.epk`


A **shared secret** is generated by both parties 
using the available static and ephemeral keys. 

The shared secret keying material is derived 
using the shared secret (see Figure 6).


Prerequisites: 
The following are prerequisites for the use of all C(1, 2) schemes.

.. note::
    1. ドメインパラメータを会わせる
    2. 共にスタティックキーペアのオーナーであること。互いにそればわかる事。
    3. 認証済みキー派生関数、 認証済みハッシュ関数を使う事
    4. 識別子とパブリックキーが結びついている事 (jku, kid)

1.  Each party shall have an authentic copy of the same set of domain parameters, D. 
    These parameters shall have been generated as specified in :ref:`Section 5.5.1 <nist-sp600-56a.5.5.1>`. 


    For FFC schemes, 
    D = (p, q, g{, SEED, pgenCounter}); for 
    ECC schemes, D = (q, FR, a, b{, SEED}, G, n, h). 

    Furthermore, 
    each party shall have assurance of the validity of these domain parameters 
    as specified in :ref:`Section 5.5.2 <nist-sp600-56a.5.5.2>`.

2.  Each party shall have been designated as the owner of a static key pair 
    that was generated as specified in :ref:`Section 5.6.1 <nist-sp600-56a.5.6.1>` 
    using the set of domain parameters, D. 

    For FFC schemes, 
    the static key pair is (x, y); 
    for ECC schemes, the static key pair is (ds, Qs). 

    Each party shall obtain assurance of the validity of its own static public key 
    as specified in :ref:`Section 5.6.2.1 <nist-sp600-56a.5.6.2.1>`. 

    Each party shall obtain assurance of its possession 
    of the correct value for its own private key as specified in :ref:`Section 5.6.3.1 <nist-sp600-56a.5.6.3.1>`.

3.  The parties shall have agreed upon an :term:`Approved key derivation function` 
    (see :ref:`Section 5.8 <nist-sp800-56a.5.8>`) 
    as well as an :term:`Approved hash function` appropriate for use 
    with the :term:`key derivation function` and associated parameters 
    (see :ref:`Section 5.5 <nist-sp800-56a.5.5>`). 

    If :term:`key confirmation` is used, 
    the parties shall have agreed upon an Approved MAC 
    and associated parameters (see Tables 1 and 2).

4.  Prior to or during the key agreement process, 
    each party shall obtain the :term:`identifier` associated with the other party 
    during the key agreement scheme 
    and the static public key that is bound to that identifier. 

    These static public keys shall be obtained in a trusted manner 
    (e.g., from a certificate signed by a trusted CA). 

    Each party shall obtain assurance of the validity 
    of the other party’s static public key as specified in :ref:`Section 5.6.2.2 <nist-sp800-56a.5.6.2.2>`.



The recipient of a static public key shall obtain assurance 
that its (claimed) owner is (or was) in possession of the corresponding static private key, 
as specified in Section :ref:`5.6.3.2 <nist-sp800-56a.5.6.3.2>`.
