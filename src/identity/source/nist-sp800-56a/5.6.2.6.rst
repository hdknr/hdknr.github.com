5.6.2.6 ECCPartialPublicKeyValidationRoutine
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

ECC partial public key validation refers to the process of checking some (but not all) of the arithmetic properties of a candidate ECC public key to ensure that it is in the correct group (but not necessarily the correct subgroup) specified by the associated ECC domain parameters. ECC Partial Public Key Validation omits the validation of subgroup membership, and therefore is usually faster than ECC Full Public Key Validation. ECC partial public key validation does not require knowledge of the associated private key and so may be done at any time by anyone. This method may only be used for an ephemeral ECC public key when assurance of the validity of the key is obtained by method 3 or 4 of Section 5.6.2.3.
Input:
1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
2. Q = (xQ, yQ): A candidate ECC public key.
Process:
1. Verify that Q is not the point at infinity O. This can be done by inspection if the point is entered in the standard affine representation.
(Partial check of the public key for an invalid range in the EC group.)
2. Verify that xQ and yQ are integers in the interval [0, p-1] in the case that q is an odd prime
p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
(Ensures that each coordinate of the public key has the unique correct representation of
an element in the underlying field.)
3. Ifqisanoddprimep,verifythat(yQ)2â‰¡(xQ)3+axQ +b(modp).
Ifq=2m,verifythat(yQ)2+xQ yQ =(xQ)3+a(xQ)2+binthefinitefieldofsize2m. (Ensures that the public key is on the correct elliptic curve.)
(Note: Since its order is not verified, there is no check that the public key is in the correct EC subgroup.)
Output: If any of the above checks fail, then output an error indicator. Otherwise, output an indication of validation success.

