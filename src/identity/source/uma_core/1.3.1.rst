1.3.1.  Protection API
^^^^^^^^^^^^^^^^^^^^^^^^^^^^

.. note::
    1. リソースセット登録
    2. クライアント要求パーミッション登録
    3. トークンイントロスペクション

The authorization server MUST present an TLS- and OAuth-protected,
HTTP-based protection API for use by resource servers.  

The authorization server thus has an OAuth token endpoint 
and user authorization endpoint, 
and has the option to issue an OAuth refresh token along 
with any access tokens issued for these APIs.  

The authorization server MUST declare 
all of its protection API endpoints 
in its configuration data (see :ref:`Section 1.4 <uma_core.1.4>`).

The protection API consists of three endpoints:

-  OAuth :term:`resource set registration endpoint` 
   as defined by [OAuth-resource-reg]

-  Endpoint for :ref:`registering client-requested permissions`

-  OAuth token introspection endpoint 
   as defined by :term:`[OAuth-introspection]` 
   and :ref:`Section 3.3.1 <uma_core.3.3.1>`

An entity seeking protection API access 
MUST have the scope "http://docs.kantarainitiative.org/uma/scopes/prot.json".  

(This URI resolves to a JSON-encoded scope description, 
as defined in :term:`[OAuth-resource-reg]`.  

The description is non-normative for UMA purposes.)  

An access token with at least this scope is called 
a :term:`protection API token` (:term:`PAT`) 
and an entity with this scope is definitionally a resource server.  

A single entity can serve in both resource server and client roles 
if it has the appropriate OAuth scopes.  

If a request to an endpoint fails due to an invalid,
missing, or expired PAT, or requires higher privileges 
at this endpoint than provided by the PAT, 
the authorization server responds with an OAuth error.

The authorization server MUST support the :term:`OAuth bearer token profile`
for PAT issuance, 
and MAY support other OAuth token profiles 
(for example, 
the SAML bearer token grant type :term:`[OAuth-SAML]`).  

It MUST declare all supported token profiles 
and grant types for PAT issuance in its configuration data.

A PAT binds a resource owner, 
a resource server the owner uses for resource management, 
and an authorization server the owner uses 
for protection of resources at this resource server.  

It is not specific to any client or requesting party.  

The issuance of a PAT represents the approval of the resource owner 
for this resource server to trust this authorization server 
for protecting its resources belonging to this resource owner.

(draft09)
