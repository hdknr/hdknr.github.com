3.1.2. Client Presents an RPT That Has Insufficient Authorization Data
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

If the client presents an RPT with its request, the resource server
SHOULD determine the RPT's status (see :ref:`Section 3.3 <uma_core.3.3>`).  

If the RPT is invalid, 
the resource server redirects the client to the RPT endpoint
at the authorization server to obtain a correct RPT (see :ref:`Section 3.4.2 <uma_core.3.4.2>`).

If the RPT is valid but has insufficient permission for the type of access sought, 
the :term:`resource server` SHOULD register a :term:`permission` with the :term:`authorization server` 
that would suffice for that scope of access (see :ref:`Section 3.2 <uma_core.3.2>`), 
and then respond to the client with the HTTP 403 (Forbidden) status code, 
along with providing the authorization server's URI in the header of the message 
and the permission ticket it just received from the authorization server in the body in JSON form.

Example of the host's response:

::

   HTTP/1.1 403 Forbidden
   WWW-Authenticate: UMA realm="example",
     host_id="photoz.example.com",
     as_uri="http://am.example.com"
     error="insufficient_scope"

   {
   "ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
   }

( http://tools.ietf.org/html/draft-hardjono-oauth-umacore-06#section-3.1.2 )
