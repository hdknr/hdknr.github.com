2. Protecting a Resource
========================================================


Phase 1 of UMA is protecting a resource.  
The :term:`user`, :term:`host`, and :term:`AM`
perform the following steps in order to successfully complete Phase 1:

   1.  The :term:`host` 
       (having learned the general location of the relevant :term:`AM` out of band) 
       looks up the AM's configuration data and 
       learns about its relevant endpoints and supported formats.

       .. note::
        
            - Discovery ( :doc:`discovery` )? for 

                - configuration parameters
                - endpoints

   2.  If the host has not yet obtained a unique OAuth client identifier
       and optional secret from the AM, 
       it registers with the AM as required.

       .. note::

            - Dynamic Registration ( :doc:`reg` ) ? to get

                - OAuth :term:`Client Identifier`
                - OAuth :term:`Client Secret`

   3.  The host obtains a :term:`protection API token` (:term:`PAT`) from the AM with
       the authorizing user's consent, by asking for the
       "http://docs.kantarainitiative.org/uma/scopes/prot.json" scope.

       .. note::

            - OAuth Flow
            - optional scope : http://docs.kantarainitiative.org/uma/scopes/prot.json

   4.  The host registers any resource sets with the AM that are
       intended to be protected.  
       (This step is repeated when and as needed.)

If the host undertakes these actions successfully, the results are as follows:

   -  The host has received configuration data about the AM, such as
      endpoints it needs to use in interacting with the AM.

   -  The host has received a PAT that represents this authorizing
      user's approval for the host to work with the AM in protecting
      resources.

   -  The AM has acquired information about :term:`resource sets` 
      at this host that it is supposed to protect on behalf of this authorizing user.

(draft 05 )
