3.1.3.1.  Requester's Token Has Insufficient Permission
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If the :term:`token status` is not associated with any currently valid :term:`permission` 
that applies to the :term:`scope` of access attempted by the :term:`requester`, 
the :term:`Host` SHOULD register a :term:`permission` with the :term:`AM` 
(see :ref:`Section 3.4 <uma_core.3.4>`) that would suffice for that scope of access, 
and then respond to the :term:`requester` with the HTTP 403 (Forbidden) status code,
along with providing the AM's URI in the header of the message and
the :term:`permission ticket` it just received from the **AM** in the body of the JSON form.

For example:

::

   HTTP/1.1 403 Forbidden
   WWW-Authenticate: UMA realm="example",
     host_id="photoz.example.com",
     am_uri="http://am.example.com"

   {
   "ticket": "016f84e8-f9b9-11e0-bd6f-0021cc6004de"
   }

.. note::

    - Host register a permmision. (:ref:`uma_core.3.4` )
    - Host get a ticket from AM for a permission registration. ( ticket is a JSON in response body from AM )
    - Host return the ticket to the request in HTTP 403 for the resource request. ( described in this section)
    - Requester ask AM to get access token with the ticket and other information(:ref:`uma_core.3.5` ) 

        - AM check the policy for the requester and its request with claims (:ref:`uma_core.3.6` )

.. note::
    - "A Requester has a valid access token" means that "Authrizing User allowed the reuqester to access a resource in the Host"
    - So "Host" may register permission to the scope on "AM" for the "Requester".  This is proved by the "Ticket"
    - If the "Requester" provides a valid "Ticket" for the "Token".  the "AM" issues a new token (Updated Token)

(draft 03)
