3.  JWT Format and Processing Requirements
===========================================================================

In order to issue an :term:`access token` response 
as described in The OAuth 2.0 Authorization Protocol [:term:`I-D.ietf.oauth-v2`] 
or to rely on a :term:`JWT` for :term:`client authentication`, 
the :term:`authorization server` MUST validate the JWT according to the criteria below.  
Application of additional restrictions 
and policy are at the discretion of the :term:`authorization server`.

-  The JWT MUST contain an ":term:`iss`" (issuer) claim 
   that contains a unique identifier for the entity that issued the JWT.

-  The JWT MUST contain a ":term:`prn`" (principal) claim 
   identifying the subject of the transaction.  
   The principal MAY identify the :term:`resource owner` 
   for whom the :term:`access token` is being requested.  
   For :term:`client authentication`, 
   the principal MUST be the :term:`client_id` of the :term:`OAuth client`.  

   When using JWTs as an :term:`authorization grant`, 
   the principal SHOULD identify an authorized accessor 
   for whom the access token is being requested 
   (typically the :term:`resource owner`, or an authorized delegate).

-  The :term:`JWT` MUST contain an ":term:`aud`" (audience) claim 
   containing a URI reference that identifies the :term:`authorization server`, 
   or the service provider principal entity of its controlling domain, 
   as an intended audience.  
   The :term:`token endpoint` URL of the :term:`authorization server` MAY be used 
   as an acceptable value for an ":term:`aud`" element.  
   The authorization server MUST verify that it is an intended audience for the JWT.

-  The JWT MUST contain an ":term:`exp`" (expiration) claim 
   that limits the time window during which the JWT can be used.  
   The :term:`authorization server` MUST verify that the expiration time has not passed,
   subject to allowable clock skew between systems.  
   The :term:`authorization server` MAY reject JWTs with an "exp" claim value
   that is unreasonably far in the future.

-  The JWT MAY contain an ":term:`nbf`" (not before) claim 
   that identifies the time before which the token MUST NOT be accepted for processing.

-  The JWT MAY contain other claims.

-  The JWT MUST be digitally signed by the issuer and the authorization server MUST verify the signature.

-  The :term:`authorization server` MUST verify 
   that the JWT is valid in all other respects per JSON Web Token (JWT) [:term:`JWT`].

(draft 02)
