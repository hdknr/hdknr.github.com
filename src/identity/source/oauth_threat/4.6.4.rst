4.6.4. Threat: Access token phishing by counterfeit resource server
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

An attacker may pretend to be a particular :term:`resource server` 
and to accept tokens from a particular :term:`authorization server`.  
If the client sends a valid :term:`access tokens <Access Token>` to this counterfeit resource server, 
the server in turn may use that token to access other services on behalf of the resource owner.

Countermeasures:

    -   Clients SHOULD not make authenticated requests with an access token 
        to unfamiliar resource servers, regardless of the presence of a secure channel.  
        If the resource server address is well-known to the client, it may authenticate the resource servers 
        (see :ref:`Section 5.1.2 <oauth_threat.5.1.2>` ).

    -   Associate the endpoint address of the resource server the client talked to with the :term:`access token`
        (e.g. in an :term:`audience` field) and validate association at legitimate resource server.  
        The endpoint address validation policy may be strict (exact match) or more relaxed (e.g. same host).  
        This would require to tell the authorization server the resource server endpoint address in the authorization process.

    -   Associate an access token with a client and authenticate the client with resource server requests 
        (typically via **signature** in order to not disclose secret to a potential attacker).  
        This prevents the attack because the counterfeit server is assumed to miss the capabilities 
        to correctly authenticate on behalf of the legitimate client to the resource server (:ref:`Section 5.4.2 <oauth_threat.5.4.2>`).

    -   Restrict the :term:`token scope` (see :ref:`Section 5.1.5.1 <oauth_threat.5.1.5.1>`) 
        and or limit the token to a certain resource server (:ref:`Section 5.1.5.5 <oauth_threat.5.1.5.5>`).
