4.4.1.2.  Threat: Obtain authorization codes from authorization server database
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

This threat is applicable 
if the :term:`authorization server` stores :term:`authorization codes <authorization code>` as handles in a database.  

An attacker may obtain authorization codes from the authorization server's database 
by gaining access to the database or launching a :term:`SQL injection` attack.

Impact: 
disclosure of all authorization codes, 
most likely along with the respective :term:`redirect_uri` and :term:`client_id` values.

   -  **Credential storage protection** can be employed - :ref:`Section 5.1.4.1 <oauth_threat.5.1.4.1>`

   -  System security measures - :ref:`Section 5.1.4.1.1 <oauth_threat.5.1.4.1.1>`

   -  Store access token hashes only - :ref:`Section 5.1.4.1.3 <oauth_threat.5.1.4.1.3>`

   -  Standard SQL injection countermeasures - :ref:`Section 5.1.4.1.2 <oauth_threat.5.1.4.1.2>`
