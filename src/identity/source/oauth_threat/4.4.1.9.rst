4.4.1.9.  Threat: Clickjacking attack against authorization
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

With :term:`Clickjacking`, 
a malicious site loads the target site in a transparent iframe 
overlaid on top of a set of dummy buttons 
which are carefully constructed to be placed directly 
under important buttons on the target site.  

When a user clicks a visible button,
they are actually clicking a button (such as an "Authorize" button) on the hidden page.

Impact: 
An attacker can steal a user's authentication credentials and
access their resources

Countermeasure

   -  Native applications SHOULD use external browsers instead of
      **embedding browsers** in an iFrame when requesting end-user authorization

   -  For newer browsers, 
      avoidance of iFrames can be enforced server side 
      by using the :term:`X-FRAME-OPTION` header - :ref:`Section 5.2.2.6 <oauth_threat.5.2.2.6>`

   -  For older browsers, 
      :term:`javascript framebusting` techniques can be used
      but may not be effective in all browsers.


