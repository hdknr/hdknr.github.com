5.2.2.3. Refresh Token Rotation
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. note::

    Return new refresh token when client refreshes access token.    

:term:`Refresh token` rotation is intended to automatically detect 
and prevent attempts to use the same refresh token in parallel 
from different apps/devices.  

This happens if a token gets stolen from the :term:`client` 
and is subsequently used by the attacker and the legitimate client.  

The basic idea is to change the refresh token value with every refresh request 
in order to detect attempts to obtain :term:`access tokens <access token>` using old refresh tokens.  
Since the :term:`authorization server` cannot determine 
whether the attacker or the legitimate client is trying to access, 
in case of such an access attempt the valid refresh token and the access authorization 
associated with it are both revoked.

The :doc:`OAuth specification <oauth>` supports this measure 
in that the tokens response allows the authorization server 
to return a new refresh token even for requests with grant type "refresh_token".

Note: 
this measure may cause problems in clustered environments 
since usage of the currently valid refresh token must be ensured.  
In such an environment, other measures might be more appropriate.
