.. _oauth.refreshing_an_access_token:

6. Refreshing an Access Token
======================================================

If the :term:`authorization server` issued a :term:`refresh token` to the client, 
the client makes a refresh request to the :term:`token endpoint` 
by adding the following parameters using the "**application/x-www-form-urlencoded**" format 
per Appendix B 
with a character encoding of UTF-8 in the HTTP request entity-body:

.. glossary::

    grant_type
          REQUIRED.  Value MUST be set to "refresh_token".
    
    refresh_token
          REQUIRED.  The refresh token issued to the client.
    
    scope
          OPTIONAL.  

          The :term:`scope` of the access request as described by :ref:`Section 3.3 <oauth.3.3>`.  

          The requested scope MUST NOT include any scope not originally granted by the resource owner, 
          and if omitted is treated as equal to the scope originally granted by the resource owner.

Because refresh tokens are typically long-lasting credentials used to
request additional access tokens, 
the refresh token is bound to the client to which it was issued.  

If the client type is confidential or the client was issued client credentials 
(or assigned other authentication requirements), 
the client MUST authenticate with the authorization server 
as described in :ref:`Section 3.2.1 <oauth.3.2.1>`.

.. note::

    - Refreshing tokens require the **Client Authentication**.

For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes
only):


::

  POST /token HTTP/1.1
  Host: server.example.com
  Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
  Content-Type: application/x-www-form-urlencoded

  grant_type=refresh_token&refresh_token=tGzv3JOkF0XG5Qx2TlKWIA

.. note::

    - Above sample uess the Basic Authentication

The authorization server MUST:

-  require :ref:`client authentication <oauth.client_authentication>` 
   for :term:`confidential clients` or 
   for any client that was issued client credentials 
   (or with other authentication requirements),

-  authenticate the client if :ref:`client authentication <oauth.client_authentication>` is included and
   ensure that the :term:`refresh token` was issued to the authenticated client, and

-  validate the refresh token.

If valid and authorized, 
the authorization server issues an :term:`access token` as described in :ref:`Section 5.1 <oauth.5.1>`.  
If the request failed verification or is invalid, 
the authorization server returns an error response as described in :ref:`Section 5.2 <oauth.5.2>`.

The :term:`authorization server` MAY issue a new refresh token, 
in which case the client MUST discard the old refresh token 
and replace it with the new refresh token.  
The authorization server MAY revoke the old refresh token 
after issuing a new refresh token to the client.  
If a new refresh token is issued, 
the refresh token :term:`scope` MUST be identical to 
that of the refresh token included by the client in the request.

.. note::

    - scope of refresh tokens = scope in authorization request

( http://tools.ietf.org/html/rfc6749.html#section-6 ) 
