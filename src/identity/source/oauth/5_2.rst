5.2. Error Response
------------------------

The authorization server responds with an HTTP 400 (Bad Request)
status code and includes the following parameters with the response:

   error
         REQUIRED.  

         A single ASCII [USASCII] error code from the following:

         invalid_request
               The request is missing a required parameter, 
               includes an unsupported parameter value ((other than grant type), 
               repeats a parameter, 
               includes multiple credentials, 
               utilizes more than one mechanism for authenticating the client, 
               or is otherwise malformed.

        invalid_client
               Client authentication failed 
               (e.g. unknown client, 
               no client authentication included, 
               or unsupported authentication method).  

               The authorization server MAY return an HTTP 401 (Unauthorized) status code 
               to indicate which HTTP authentication schemes are supported.  
               If the client attempted to authenticate via the "**Authorization**" request header field, 
               the authorization server MUST respond with an HTTP 401 (Unauthorized) status code, 
               and include the "WWW-Authenticate" response header field matching the authentication scheme used by the client.

         invalid_grant
               The provided authorization grant 
               (e.g. authorization code, 
               resource owner credentials, 
               client credentials) is 
               invalid, 
               expired, 
               revoked, 
               does not match the redirection URI used in the authorization request, 
               or was issued to another client.

         unauthorized_client [#]_ 
               The authenticated client is not authorized to use this authorization grant type.

         unsupported_grant_type
               The authorization grant type is not supported by the authorization server.

         invalid_scope
               The requested scope is invalid, 
               unknown, 
               malformed, or
               exceeds the scope granted by the resource owner.

   error_description
         OPTIONAL.  
         A human-readable ASCII [USASCII] text 
         providing additional information, 
         used to assist the client developer in understanding the error that occurred.

         Values for the "error_description" parameter MUST NOT include
         characters outside the set %x20-21 / %x23-5B / %x5D-7E.


         .. code-block:: python

             >>> [ chr(i) for i in range(0x20,0x22)]
             [' ', '!']
             >>> [ chr(i) for i in range(0x23,0x5B)]
             ['#', '$', '%', '&', "'", '(', ')', '*', '+', ',', '-', '.', '/',
             '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', ':', ';', '<', '=', '>', '?', '@', 
             'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N',
             'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
             >>> [ chr(i) for i in range(0x5D,0x7E)]
             [']', '^', '_', '`',
             'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 
             'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z', '{', '|', '}']

   error_uri
         OPTIONAL.  

         A URI identifying a human-readable web page 
         with information about the error, 
         used to provide the client developer with additional information about the error.

         Values for the "error_uri" parameter MUST conform to the URI-
         Reference syntax, and thus MUST NOT include characters outside
         the set %x21 / %x23-5B / %x5D-7E. 

.. [#] "client credentials" is handled by "invalid_grant" error. What exactly "unauthorized_client" mean?

The parameters are included in the entity body of the HTTP response
using the "application/json" media type as defined by [RFC4627].  
The parameters are serialized into a JSON structure by adding each parameter 
at the highest structure level.  
Parameter names and string values are included as JSON strings.  
Numerical values are included as JSON numbers.
The order of parameters does not matter and can vary.

For example::

     HTTP/1.1 400 Bad Request
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "error":"invalid_request"
     }


.. note::

    - :ref:`messages_2_2_4`

(draft 31, http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-5.2)
