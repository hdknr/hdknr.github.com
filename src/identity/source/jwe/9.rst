9. Encrypting JWEs with Cryptographic Algorithms
----------------------------------------------------------------------

JWE uses cryptographic algorithms to encrypt the :term:`Content Encryption Key (CEK)` and the Plaintext.  
This section specifies a set of specific algorithms for these purposes.

The table below :ref:`Table 3 <jwe.table.3>` is the set of ":term:`alg`" header parameter values 
that are reserved by this specification.  
These algorithms are used to encrypt the :term:`CEK`, which produces the :term:`JWE Encrypted Key`.

.. _jwe.table.3:

.. list-table:: Table 3: JWE Reserved alg Parameter Values
    :widths: 100 800

    *   - alg Parameter Value 
        - Encryption Algorithm

    *   - RSA1_5  
        - RSA using RSA-PKCS1-1.5 padding, as defined in RFC 3447 [:term:`RFC3447`]

    *   - RSA-OAEP    
        - RSA using Optimal Asymmetric Encryption Padding (:term:`OAEP`), 
          as defined in RFC 3447 [:term:`RFC3447`]

    *   - ECDH-ES 
        - Elliptic Curve Diffie-Hellman Ephemeral Static, 
          as defined in RFC 6090 [:term:`RFC6090`], 
          and using the Concat KDF, as defined in [:term:`NIST‑800‑56A`], 
          where the Digest Method is SHA-256

    *   - A128KW  
        - Advanced Encryption Standard (:term:`AES`) Key Wrap Algorithm 
          using **128** bit keys, as defined in RFC 3394 [:term:`RFC3394`]

    *   - A256KW  
        - Advanced Encryption Standard (:term:`AES`) Key Wrap Algorithm 
          using **256** bit keys, as defined in RFC 3394 [:term:`RFC3394`]

    *   - A128GCM 
        - Advanced Encryption Standard (:term:`AES`) 
          using **128** bit keys in Galois/Counter Mode, 
          as defined in [:term:`FIPS‑197]` and [:term:`NIST‑800‑38D`]

    *   - A256GCM 
        - Advanced Encryption Standard (:term:`AES`) 
          using **256** bit keys in Galois/Counter Mode, 
          as defined in [:term:`FIPS‑197`] and [:term:`NIST‑800‑38D`]

The table below :ref:`Table 4  <jwe.table.4>` is the set of "enc" header parameter values
that are reserved by this specification.  These algorithms are used
to encrypt the Plaintext, which produces the Ciphertext.

.. _jwe.table.4:

.. list-table:: Table 4: JWE Reserved enc Parameter Values
    :widths: 100 800

    *   - enc 
        - Parameter Value Symmetric Encryption Algorithm

    *   - A128CBC 
        - Advanced Encryption Standard (:term:`AES`) 
          using 128 bit keys in Cipher Block Chaining mode, as defined in [FIPS‑197] and [NIST‑800‑38A]

    *   - A256CBC 
        - Advanced Encryption Standard (:term:`AES`) 
          using 256 bit keys in Cipher Block Chaining mode, as defined in [FIPS‑197] and [NIST‑800‑38A]

    *   - A128GCM 
        - Advanced Encryption Standard (:term:`AES`) 
          using 128 bit keys in Galois/Counter Mode, as defined in [FIPS‑197] and [NIST‑800‑38D]

    *   - A256GCM 
        - Advanced Encryption Standard (:term:`AES`) 
          using 256 bit keys in Galois/Counter Mode, as defined in [FIPS‑197] and [NIST‑800‑38D]

Of these algorithms, 
only :term:`RSA-PKCS1-1.5` with 2048 bit keys, 
:term:`AES-128-CBC`, 
and :term:`AES-256-CBC` MUST be implemented by conforming implementations.  
It is RECOMMENDED that 
implementations also support :term:`ECDH-ES` with 256 bit keys, :term:`AES-128-GCM`, 
and :term:`AES-256-GCM`.  
Support for other algorithms and key sizes is OPTIONAL.

