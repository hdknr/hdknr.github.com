4.1.  Reserved Header Parameter Names
------------------------------------------------

The following header parameter names are reserved. All the names are short because a core goal of JWE is for the representations to be compact.

TBD: Describe the relationship between the JWS and JWE header parameters - especially the alg parameter, which can contain either signature algorithms (from JWS) or encryption algorithms (from JWE), and the key reference parameters jku, kid, x5u, and x5t. 

.. _jwe.table.1:

.. table::  Table 1: Reserved Header Parameter Definitions 

    ======================   =============== ======================= ============================
    Header Parameter Name    JSON Value Type Header Parameter Syntax Header Parameter Semantics
    ======================   =============== ======================= ============================

.. glossary::

    alg     
        string  

        StringOrURI     

        The alg (algorithm) header parameter identifies the cryptographic algorithm 
        used to secure the :term:`JWE Encrypted Key`. 
        A list of defined alg values is presented in :ref:`Table 3 <jwe.table.3>`. 
        The processing of the alg (algorithm) header parameter requires 
        that the value MUST be one that is both supported 
        and for which there exists a key for use with that algorithm 
        associated with the intended recipient. 
        The alg value is case sensitive. This header parameter is REQUIRED.

    enc     
        string  

        StringOrURI     

        The enc (encryption method) header parameter identifies the symmetric encryption algorithm 
        used to secure the Ciphertext. 
        A list of defined enc values is presented in :ref:`Table 4 <jwe.table.4>`. 
        The processing of the enc (encryption method) header parameter requires 
        that the value MUST be one that is supported. 
        The enc value is case sensitive. This header parameter is REQUIRED.

    iv  
        string  

        String  

        Initialization Vector (iv) value for algorithms requiring it, 
        represented as a base64url encoded string. 
        This header parameter is OPTIONAL.

    epk     
        object  

        JWK Key Object  

        Ephemeral Public Key (epk) value created by the originator 
        for the use in ECDH-ES RFC 6090 [:term:`RFC6090`] encryption. 
        This key is represented in the same manner as a JSON Web Key [JWK] JWK Key Object value, 
        containing crv (curve), x, and y members. 
        The inclusion of the JWK Key Object alg (algorithm) member is OPTIONAL. 
        This header parameter is OPTIONAL.

    zip     
        string  

        String  

        Compression algorithm (zip) applied to the Plaintext before encryption, if any. 
        This specification defines the value GZIP to refer to the encoding format 
        produced by the file compression program "gzip" (GNU zip) as described in [:term:`RFC1952`]; 
        this format is a Lempel-Ziv coding (LZ77) with a 32 bit CRC. 
        If no zip parameter is present, 
        or its value is none, no compression is applied to the Plaintext before encryption. 
        The zip value is case sensitive. This header parameter is OPTIONAL.

    jku     
        string  

        URL     

        The jku (JSON Web Key URL) header parameter is an absolute URL 
        that refers to a resource for a set of JSON-encoded public keys, 
        one of which corresponds to the key that was used to encrypt the JWE. 
        The keys MUST be encoded as described in the JSON Web Key (JWK) [:term:`JWK`] specification. 
        The protocol used to acquire the resource MUST provide integrity protection. 
        An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818] RFC 5246 [RFC5246] 
        with server authentication RFC 6125 [RFC6125]. 
        This header parameter is OPTIONAL.

    kid     
        string  

        String  

        The kid (key ID) header parameter is a hint indicating which key was used to encrypt the JWE. 
        This allows originators to explicitly signal a change of key to recipients. 
        The interpretation of the contents of the kid parameter is unspecified. This header parameter is OPTIONAL.

    x5u     
        string  

        URL     

        The x5u (X.509 URL) header parameter is an absolute URL that refers to a resource 
        for the X.509 public key certificate or certificate chain corresponding to the key used to encrypt the JWE. 
        The identified resource MUST provide a representation of the certificate or certificate chain 
        that conforms to RFC 5280 [RFC5280] in PEM encoded form RFC 1421 [RFC1421]. 
        The protocol used to acquire the resource MUST provide integrity protection. 
        An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818] RFC 5246 [RFC5246] 
        with server authentication RFC 6125 [RFC6125]. 
        This header parameter is OPTIONAL.

    x5t     
        string  

        String  

        The x5t (x.509 certificate thumbprint) header parameter provides 
        a base64url encoded SHA-1 thumbprint (a.k.a. digest) of the DER encoding 
        of the X.509 certificate that corresponds to the key that was used to encrypt the JWE. This header parameter is OPTIONAL.

    typ     
        string  

        String  

        The typ (type) header parameter is used to declare the type of the encrypted content. 
        The typ value is case sensitive. This header parameter is OPTIONAL. 


Additional reserved header parameter names MAY be defined via the IANA JSON Web Encryption Header Parameters registry, as per Section 10. The syntax values used above are defined as follows: 


.. _jwe.table.2:

.. table::  Table 2: Header Parameter Syntax Definitions 

 ===========    ===================================================
 Syntax Name    Syntax Definition
 ===========    ===================================================
 String         Any string value MAY be used.

 StringOrURI    Any string value MAY be used but a value 
                containing a ":" character MUST be a URI 
                as defined in RFC 3986 [RFC3986].

 URL            A URL as defined in RFC 1738 [RFC1738].
 ===========    ===================================================


( : http://self-issued.info/docs/draft-jones-json-web-encryption.html#ReservedHeaderParameterName )
