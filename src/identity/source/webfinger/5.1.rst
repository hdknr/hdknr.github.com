5.1. Performing a WebFinger Query
------------------------------------

The first step a client must perform in executing a WebFinger query
is to query for the :term:`host metadata` using HTTPS or HTTP.  
The procedures are defined in the :term:`Web Host Metadata` [10] specification.

WebFinger clients MUST locate the :term:`LRDD` :term:`link relation`, if present, 
and perform a query for that :term:`link relation`, if present.  
All other :term:`link templates` found must be processed to form 
a complete resource descriptor.  
The processing rules in Section 4.2 of :rfc:`6415` MUST be followed.

WebFinger servers MUST accept requests for both :term:`XRD` [9] and :term:`JRD` [10] documents.  
The default representation returned by the server MUST be an XRD document, 
but a JRD document MUST be returned if the client explicitly requests it 
by using **/.well-known/host-meta.json** or includes an :term:`Accept` header 
in the HTTP request with a type of "**application/json**" [5].

If the client requests a JRD document when querying for host metadata, 
the WebFinger server can assume that the client will want a JRD documents 
when querying the LRDD resource.  
As such, 
when the WebFinger server returns a JRD document containing host metadata 
it should include a URI for an LRDD resource that can return a JRD document 
and MAY include a URI for an LRDD resource that will return an XRD document.

If the client queries the LRDD resource and provides a URI 
for which the server has no information, 
the server MUST return a 404 status code.  
Likewise, 
any query to a URI in the resource descriptor that is unknown to the server 
MUST result in the server returning a 404 status code.

WebFinger servers MAY include cache validators in a response 
to enable conditional requests by clients and/or expiration times 
as per RFC 2616 section 13.

(Internet Draft 06)

