3. The WWW-Authenticate Response Header Field
====================================================================

If the protected resource request does not include authentication credentials 
or does not contain an access token that enables access to the protected resource, 
the resource server MUST include the HTTP "WWW-Authenticate" response header field; 
it MAY include it in response to other conditions as well.  
The "WWW-Authenticate" header field uses the framework 
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth] as follows:

:: 

   challenge       = "Bearer" [ 1*SP 1#param ]

   param           = realm / scope /
                     error / error-desc / error-uri /
                     auth-param

   scope           = "scope" "=" quoted-string
   error           = "error" "=" quoted-string
   error-desc      = "error_description" "=" quoted-string
   error-uri       = "error_uri" "=" quoted-string


A "realm" attribute MAY be included to indicate the scope of protection 
in the manner described in HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth].  
The "realm" attribute MUST NOT appear more than once.  
The "realm" value is intended for programmatic use 
and is not meant to be displayed to end users.

The "scope" attribute is a space-delimited list of scope values
indicating the required scope of the access token 
for accessing the requested resource.  
In some cases, 
the "scope" value will be used 
when requesting a new access token with sufficient scope of access 
to utilize the protected resource.  
The "scope" attribute MUST NOT appear more than once.  
The "scope" value is intended for programmatic use 
and is not meant to be displayed to end users.

If the protected resource request included an access token 
and failed authentication, 
the resource server SHOULD include the "error" attribute 
to provide the client with the reason why the access request was declined.  
The parameter value is described in :ref:`Section 3.1 <bearer.3.1>`.  
In addition, 
the resource server MAY include the "error_description" attribute 
to provide developers a human-readable explanation 
that is not meant to be displayed to end users.  
It also MAY include the "error_uri" attribute 
with an absolute URI identifying a human-readable web page explaining the error.  
The "error", "error_description", and "error_uri" attributes MUST NOT appear more than once.

Producers of "scope" strings MUST NOT use characters 
outside the set %x21 / %x23-5B / %x5D-7E for representing the scope values 
and %x20 for the delimiter.  
Producers of "error" and "error_description" strings MUST NOT use characters 
outside the set %x20-21 / %x23-5B / %x5D-7E for representing these values.  
Producers of "error-uri" strings MUST NOT use characters 
outside the set %x21 / %x23-5B / %x5D-7E for representing these values.  
Furthermore, "error-uri" strings MUST conform to the URI-Reference syntax.  
In all these cases, 
no character quoting will occur, as senders are prohibited from using the %5C ('\') character.

For example, 
in response to a protected resource request without authentication:

::

   HTTP/1.1 401 Unauthorized
   WWW-Authenticate: Bearer realm="example"

And in response to a protected resource request with an authentication attempt 
using an expired access token:

::

   HTTP/1.1 401 Unauthorized
   WWW-Authenticate: Bearer realm="example",
                     error="invalid_token",
                     error_description="The access token expired"

(v.15)
