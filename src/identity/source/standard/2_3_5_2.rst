2.3.5.2.  End-User Denies Authorization or Invalid Request
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

If the :term:`End-User` denies the authorization or the user authentication fails, 
the :term:`Authorization Server` MUST return the error authorization response 
as defined in OpenID Connect Messages 1.0 [:term:`OpenID.Messages`]. 

The :term:`Authorization Server` returns the :term:`Client` 
to the :term:`redirection URI` specified in the :term:`Authorization Request` 
with the appropriate error parameters. 
No other parameters SHOULD be returned.

The error response parameters are the following:

.. glossary::
   
    error
        REQUIRED. The error code. 

    error_description
        OPTIONAL. A human-readable UTF-8 encoded text description of the error. 

    error_uri
        OPTIONAL. A URI to a web page that includes additional information about the error. 

    state
        REQUIRED if the :term:`Authorization Request` included the :term:`state` parameter. 
        Set to the exact value received from the :term:`Client`. 

If the :term:`response_type` parameter 
in the :term:`Authorization Request` includes the string value ":term:`token`" or ":term:`id_token`", 
all error response parameters SHOULD be added to the :term:`fragment component` of the :term:`redirection URI`. 
Otherwise, 
the response parameters are added to the :term:`query component` of the :term:`redirection URI`.

The following is a non-normative example. Line wraps after the second line is for the display purpose only:

::

    HTTP/1.1 302 Found
    Location: https://client.example.com/cb?
    error=invalid_request
    &error_description=the%20request%20is%20not%20valid%20or%20malformed
    &state=af0ifjsldkj


(draft 07)
