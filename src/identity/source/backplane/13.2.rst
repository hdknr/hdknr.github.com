13.2.  Get Messages
----------------------------------------

Retrieve messages from the server.

    Endpoint
        /v2/messages 

    HTTP mehod
        GET 

    Security
        HTTPS 

    Authorization
        The client MUST present the access token obtained 
        from a :ref:`Access Token Request (Access Token Request) <backplane.13.1>` 
        as described in section 2.1 
        (Jones, M., Hardt, D., and D. Recordon, “The OAuth 2.0 Protocol: Bearer Tokens,” Jun 2011.) 
        [OAuth2.token.bearer]. 

        The server MUST retrieve the :ref:`Access Scopes (Access Scopes) <backplane.12.1>` 
        associated with the presented access token, 
        determine the :ref:`Message Sequence (Message Sequences and Retrieval) <backplane.12>` filter 
        and :ref:`access level (Access Levels) <backplane.5>`, 
        and respond accordingly. 

    Parameters

            -   block (integer, default 0): 
                if no messages are available for immediate retrieval, 
                this parameter communicates how long (in seconds) 
                the server should wait before returning an empty response

            -   callback (string, optional): 
                callback function to pad the response with (see :ref:`Padded Responses (Padded Responses) <backplane.7>`); 
                MUST only contain alphanumeric characters (a-zA-Z0-9)

            -   since (optional, string): 
                the :term:`Message Identifier` representing the starting point of 
                the requested Message Sequence. 
                See Message Sequences and Retrieval (:ref:`Message Sequences and Retrieval <backplane.12>`).

    Returns
        On success, a JSON object is returned with the following fields:

            -   nextURL (string): 
                a complete URL pointing to the Get Messages endpoint 
                that the client can invoke to retrieve subsequent messages from the server. 
                The URL MUST contain a :term:`Message Identifier` in the since query parameter.

            -   messages[]: 
                an array of messages in the order they were originally received by the server. 
                Each message within the array is represented as a JSON object of the same structure 
                as returned by the :ref:`Get Single Message (Get Single Message) <backplane.13.3>` API method.

        Response example

.. code-block:: javascript

        {
          "nextURL": "https://bp.example.com/v2/messages?since=958bfa2dd8aed82c86afbd54b4a314a5",
          "messages": [
            {
              "bus": "customer.com",
              "channel": "67dc880cc265b0dbc755ea959b257118",
              "messageURL": "https://bp.example.com/v2/message/097a5cc401001f95b45d37aca32a3bd2",
              "payload": {
                "role": "administrator"
              },
              "source": "http://aboutecho.com",
              "type": "identity/ack"
            }
          ]
        }

(draft 08)
