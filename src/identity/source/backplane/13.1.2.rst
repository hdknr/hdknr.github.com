13.1.2.  Authenticated Access Token Request
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

If the ":term:`grant_type`" parameter is ":term:`code`" and both ":term:`client_id`" 
and ":term:`client_secret`" are present, 
the server MAY attempt :ref:`Static Client Registration (Static Client Registration) <blackplane.6.2.2>`.

The server MUST check the credentials of the client. 
If the credentials are valid, the request is a authenticated access token request; 
otherwise the server MUST return error per section 5.2 
(Habber-Lahav, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” May 2011.) 
[OAuth2] (error "unautorized_client").

The server MUST check that the client making the request is authorized for the requested scopes. 
If the client is not authorized for any of the requested scopes the server MUST return error 
per section 5.2 
(Habber-Lahav, E., Recordon, D., and D. Hardt, “The OAuth 2.0 Authorization Protocol,” May 2011.) 
[OAuth2] (error "invalid_scope").

In response to a authenticated access token request 
the :term:`Backplane Server` issues an :ref:`privileged access token (Privileged Access) <backplane.5.2>` 
to the client for the requested scope. 
If no ":term:`scope`" parameter was specified in the request, 
the client is granted access to all buses it is authorized to per the server configuration.

(draft 08)

