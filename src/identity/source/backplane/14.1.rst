.. _Backplane.init:

14.1.  Initialization
------------------------------------

Backplane is initialized using the **Backplane.init** method.

During initialization the library generates a random :term:`Channel Name` 
unless information about one for the specified bus name already exists 
in the **backplane-channel** cookie. 
Since client-side generation of the channel name is non-secure, 
the library performs a request to obtain a channel name from the :term:`Backplane Server`.

There can be at most one :term:`channel` active on a :term:`Web Page` at a given time.

After initialization the library stores the current :term:`Channel Name` 
in the **backplane-channel** cookie set 
against the complete domain name of currently opened page. 
The cookie is set for 5 years in advance 
and keeps information about association of :term:`Bus names` to :term:`Channel Names` 
(to support possibility to use the library with several different Bus names on the same domain). 
The information about the association is stored in a serialized form.

Here is an example of cookie that stores association of Bus names example.com and example.org to the corresponding channel names 123 and 456:

:: 

    backplane-channel=example.com:123|example.org:456

After the :term:`channel ID` has been determined, 
the library performs a first reading of messages from a channel, 
discards all of them (remembering only the identifier of the very last one) 
and starts polling the :term:`Backplane Server` for new messages 
since the latest :term:`Backplane Message`. 
This way the library is guaranteed to push to subscribers only those Backplane Messages 
which arrived after the library had been fully initialized. 

(draft 08)
