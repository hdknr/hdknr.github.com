3.2. MAC with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512
---------------------------------------------------------------------------

Hash-based Message Authentication Codes (HMACs) enable one to use a
**secret** plus a :term:`cryptographic hash function` 
to generate a :term:`Message Authentication Code` (:term:`MAC`).  
This can be used to demonstrate that the
:term:`MAC` matches the **hashed content**, 
in this case the :term:`JWS Secured Input`,
which therefore demonstrates that whoever generated the MAC was in
possession of the **secret**.  
The means of **exchanging the shared key** is outside the scope of this specification.

The algorithm for implementing and validating HMACs is provided in
RFC 2104 [RFC2104].  
This section defines the use of the HMAC SHA-256, HMAC SHA-384, and HMAC SHA-512 
functions [SHS].  
The "alg" (algorithm) header parameter values "HS256", "HS384", and "HS512" are
used in the JWS Header to indicate that the Encoded JWS Signature
contains a base64url encoded HMAC value using the respective hash
function.

A key of the same size as the hash output (for instance, 256 bits for
"HS256") or larger MUST be used with this algorithm.

The HMAC SHA-256 MAC is generated per RFC 2104, using SHA-256 as the
hash algorithm "H", using the bytes of the ASCII [USASCII]
representation of the JWS Secured Input as the "text" value, and
using the shared key.  The HMAC output value is the JWS Signature.
The JWS signature is base64url encoded to produce the Encoded JWS
Signature.

The HMAC SHA-256 MAC for a JWS is validated by computing an HMAC
value per RFC 2104, using SHA-256 as the hash algorithm "H", using
the bytes of the ASCII representation of the received JWS Secured
input as the "text" value, and using the shared key.  This computed
HMAC value is then compared to the result of base64url decoding the
received Encoded JWS signature.  Alternatively, the computed HMAC
value can be base64url encoded and compared to the received Encoded
JWS Signature, as this comparison produces the same result as
comparing the unencoded values.  In either case, if the values match,
the HMAC has been validated.  If the validation fails, the JWS MUST
be rejected.

Securing content with the HMAC SHA-384 and HMAC SHA-512 algorithms is
performed identically to the procedure for HMAC SHA-256 - just using
the corresponding hash algorithm with correspondingly larger minimum
key sizes and result values: 384 bits each for HMAC SHA-384 and 512
bits each for HMAC SHA-512.


(draft 04 http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.2 )
