4.8.1. Key Derivation for "A128CBC+HS256" and "A256CBC+HS512"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


The key derivation process derives CEK and CIK values from the CMK.
This section defines the specifics of deriving keys for the "enc"
algorithms "A128CBC+HS256" and "A256CBC+HS512".

Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256
or SHA-512, respectively.  The Concat KDF parameters are set as
follows:


   Z  
      This is set to the Content Master Key (CMK).

   keydatalen  
      This is set to the number of bits in the desired output
      key.

   AlgorithmID  
      This is set to the concatenation of keydatalen
      represented as a 32 bit big endian integer and the bytes of the
      UTF-8 representation of the "enc" header parameter value.

   PartyUInfo  
      If an "epu" (encryption PartyUInfo) header parameter is
      present, this is set to the result of base64url decoding the "epu"
      value; otherwise, it is set to the empty byte string.

   PartyVInfo  
      If an "epv" (encryption PartyVInfo) header parameter is
      present, this is set to the result of base64url decoding the "epv"
      value; otherwise, it is set to the empty byte string.

   SuppPubInfo  
      This is set to the bytes of one of the ASCII strings
      "Encryption" ([69, 110, 99, 114, 121, 112, 116, 105, 111, 110]) or
      "Integrity" ([73, 110, 116, 101, 103, 114, 105, 116, 121])
      respectively, depending upon whether the CEK or CIK is being
      generated.

   SuppPrivInfo  
      This is set to the empty byte string.

To compute the CEK from the CMK, the ASCII label "Encryption" is used
for the SuppPubInfo value.  For "A128CBC+HS256", the keydatalen is
128 and the digest function used is SHA-256.  For "A256CBC+HS512",
the keydatalen is 256 and the digest function used is SHA-512.

To compute the CIK from the CMK, the ASCII label "Integrity" is used
for the SuppPubInfo value.  For "A128CBC+HS256", the keydatalen is
256 and the digest function used is SHA-256.  For "A256CBC+HS512",
the keydatalen is 512 and the digest function used is SHA-512.

Example derivation computations are shown in Appendices A.4 and A.5
of [JWE].

(draft 06, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.1)
