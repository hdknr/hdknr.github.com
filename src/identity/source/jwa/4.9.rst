4.9. Plaintext Encryption with AES GCM
------------------------------------------------------------------

This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128 or 256 bit keys.  The "enc" header
parameter values "A128GCM" or "A256GCM" are used in this case.

The CMK is used as the encryption key.

Use of an initialization vector of size 96 bits is REQUIRED with this algorithm.

The "additional authenticated data" parameter is used to secure the
header and key values.  The "additional authenticated data" value
used is the bytes of the ASCII representation of the concatenation of
the Encoded JWE Header, a period ('.') character, the Encoded JWE
Encrypted Key, a second period character ('.'), and the Encoded JWE
Initialization Vector.  This same "additional authenticated data"
value is used when decrypting as well.

The requested size of the "authentication tag" output MUST be 128
bits, regardless of the key size.

As GCM is an AEAD algorithm, the JWE Integrity Value is set to be the
"authentication tag" value produced by the encryption.  During
decryption, the received JWE Integrity Value is used as the
"authentication tag" value.

Examples using this algorithm are shown in Appendices :ref:`A.1 <jwe.appendix.a.1>` 
and :ref:`A.3 <jwe.appendix.a.3>` of [JWE].

(draft 06, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9)
