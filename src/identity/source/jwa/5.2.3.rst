.. _AES_128_CBC_HMAC_SHA_256:

5.2.3. AES_128_CBC_HMAC_SHA_256
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

This algorithm is a concrete instantiation of 
the generic :ref:`AES_CBC_HMAC_SHA2` algorithm above.  

It uses the HMAC message authentication code [RFC2104] 
with the SHA-256 hash function [SHS] to
provide message authentication, 
with the HMAC output truncated to 128 bits, 
corresponding to the HMAC-SHA-256-128 algorithm 
defined in [RFC4868].  

For encryption, 
it uses AES in the Cipher Block Chaining (CBC) mode of operation 
as defined in Section 6.2 of [NIST.800-38A],
with PKCS #7 padding 
and a 128 bit initialization vector (IV) value.

.. note::
    - PKCS#5ではなくPKCS#7

The AES_CBC_HMAC_SHA2 parameters specific to AES_128_CBC_HMAC_SHA_256
are:

- The input key K is 32 octets long.

- ENC_KEY_LEN is 16 octets.

- MAC_KEY_LEN is 16 octets.

- The SHA-256 hash algorithm is used for the HMAC.

- The HMAC-SHA-256 output is truncated to T_LEN=16 octets, 
  by stripping off the final 16 octets.

(draft28)
