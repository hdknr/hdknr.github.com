4.8.3. Integrity Calculation for "A128CBC+HS256" and "A256CBC+HS512"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


This section defines the specifics of computing the JWE Integrity
Value for the "enc" algorithms "A128CBC+HS256" and "A256CBC+HS512".
This value is computed as a MAC of the JWE parameters to be secured.

The MAC input value is the bytes of the ASCII representation of the
concatenation of the Encoded JWE Header, a period ('.') character,
the Encoded JWE Encrypted Key, a second period character ('.'), the
Encoded JWE Initialization Vector, a third period ('.') character,
and the Encoded JWE Ciphertext.

The CIK is used as the MAC key.

For "A128CBC+HS256", HMAC SHA-256 is used as the MAC algorithm.  For
"A256CBC+HS512", HMAC SHA-512 is used as the MAC algorithm.

The resulting MAC value is used as the JWE Integrity Value.  The same
integrity calculation is performed during decryption.  During
decryption, the computed integrity value must match the received JWE
Integrity Value.

(draft 06, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3 )

