4.6. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)
------------------------------------------------------------------------------------

This section defines the specifics of key agreement with Elliptic
Curve Diffie-Hellman Ephemeral Static [RFC6090], in combination with
the Concat KDF, as defined in Section 5.8.1 of [NIST.800-56A].  The
key agreement result can be used in one of two ways:

    1.  directly as the Content Encryption Key (CEK) for the "enc"
        algorithm, in the Direct Key Agreement mode, or
    
    2.  as a symmetric key used to wrap the CEK with the "A128KW",
        "A192KW", or "A256KW" algorithms, in the Key Agreement with Key
        Wrapping mode.

A new ephemeral public key value MUST be generated for each key
agreement operation.

In Direct Key Agreement mode, the output of the Concat KDF MUST be a
key of the same length as that used by the "enc" algorithm.  In this
case, the empty octet sequence is used as the JWE Encrypted Key
value.  The "alg" Header Parameter value "ECDH-ES" is used in the
Direct Key Agreement mode.

In Key Agreement with Key Wrapping mode, the output of the Concat KDF
MUST be a key of the length needed for the specified key wrapping
algorithm.  In this case, the JWE Encrypted Key is the CEK wrapped
with the agreed upon key.

The following "alg" (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the result of the key agreement algorithm as the key
encryption key for the corresponding key wrapping algorithm:


   +-------------------+-----------------------------------------------+
   | alg Parameter     | Key Management Algorithm                      |
   | Value             |                                               |
   +-------------------+-----------------------------------------------+
   | ECDH-ES+A128KW    | ECDH-ES using Concat KDF and CEK wrapped with |
   |                   | "A128KW"                                      |
   +-------------------+-----------------------------------------------+
   | ECDH-ES+A192KW    | ECDH-ES using Concat KDF and CEK wrapped with |
   |                   | "A192KW"                                      |
   +-------------------+-----------------------------------------------+
   | ECDH-ES+A256KW    | ECDH-ES using Concat KDF and CEK wrapped with |
   |                   | "A256KW"                                      |
   +-------------------+-----------------------------------------------+

(draft20)
(https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6)
