4.7. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)
--------------------------------------------------------------------------------------------------------


This section defines the specifics of key agreement with Elliptic
Curve Diffie-Hellman Ephemeral Static [RFC6090], and using the Concat
KDF, as defined in Section 5.8.1 of :term:`[NIST.800-56A]`.  
The key agreement result can be used in one of two ways: (1) directly as the
Content Master Key (CMK) for the "enc" algorithm, or (2) as a
symmetric key used to wrap the CMK with either the "A128KW" or
"A256KW" algorithms.  The "alg" header parameter values "ECDH-ES",
"ECDH-ES+A128KW", and "ECDH-ES+A256KW" are respectively used in this
case.

In the direct case, the output of the Concat KDF MUST be a key of the
same length as that used by the "enc" algorithm; in this case, the
empty byte array is used as the JWE Encrypted Key value.  In the key
wrap case, the output of the Concat KDF MUST be a key of the length
needed for the specified key wrap algorithm, either 128 or 256 bits
respectively.

A new "epk" (ephemeral public key) value MUST be generated for each
key agreement transaction.

(draft 06 , http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7 )
