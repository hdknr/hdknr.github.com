4.7.1. Key Derivation for "ECDH-ES"
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^


The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].

Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:


.. glossary::

   Z  
      This is set to the representation of the shared secret Z as a byte
      array.

   keydatalen  
      This is set to the number of bits in the desired output
      key.  For "ECDH-ES", this is length of the key used by the "enc"
      algorithm.  For "ECDH-ES+A128KW", and "ECDH-ES+A256KW", this is
      128 and 256, respectively.

   AlgorithmID  
      This is set to the concatenation of keydatalen
      represented as a 32 bit big endian integer and the bytes of the
      UTF-8 representation of the "alg" header parameter value.

   PartyUInfo  
      If an "apu" (agreement PartyUInfo) header parameter is
      present, this is set to the result of base64url decoding the "apu"
      value; otherwise, it is set to the empty byte string.

   PartyVInfo  
      If an "apv" (agreement PartyVInfo) header parameter is
      present, this is set to the result of base64url decoding the "apv"
      value; otherwise, it is set to the empty byte string.

   SuppPubInfo  
      This is set to the empty byte string.

   SuppPrivInfo  
      This is set to the empty byte string.

For all three "alg" values, the digest function used is SHA-256.

(draft 06, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7.1 )
