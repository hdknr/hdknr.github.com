3.3. Digital Signature with RSA SHA-256, RSA SHA-384, or RSA SHA-512
-------------------------------------------------------------------------------------


This section defines the use of the RSASSA-PKCS1-V1_5 digital
signature algorithm as defined in Section 8.2 of RFC 3447 [RFC3447],
(commonly known as PKCS #1), using SHA-256, SHA-384, or SHA-512 [SHS]
as the hash functions.  
The "alg" (algorithm) header parameter values
"RS256", "RS384", and "RS512" are used in the JWS Header to indicate
that the Encoded JWS Signature contains a base64url encoded RSA
digital signature using the respective hash function.

A key of size 2048 bits or larger MUST be used with these algorithms.

The RSA SHA-256 digital signature is generated as follows:

   1.  Generate a digital signature of the bytes of the ASCII
       representation of the JWS Secured Input using RSASSA-PKCS1-V1_5-
       SIGN and the SHA-256 hash function with the desired private key.
       The output will be a byte array.

   2.  Base64url encode the resulting byte array.

The output is the Encoded JWS Signature for that JWS.

The RSA SHA-256 digital signature for a JWS is validated as follows:

   1.  Take the Encoded JWS Signature and base64url decode it into a
       byte array.  If decoding fails, the JWS MUST be rejected.

   2.  Submit the bytes of the ASCII representation of the JWS Secured
       Input and the public key corresponding to the private key used by
       the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm using SHA-
       256 as the hash function.

   3.  If the validation fails, the JWS MUST be rejected.

Signing with the RSA SHA-384 and RSA SHA-512 algorithms is performed
identically to the procedure for RSA SHA-256 - just using the
corresponding hash algorithm with correspondingly larger result
values: 384 bits for RSA SHA-384 and 512 bits for RSA SHA-512.

(draft 04, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.3 )
