.. _jwa.jwe.alg:

4.1. "alg" (Algorithm) Header Parameter Values for JWE
------------------------------------------------------------------------------------------

.. note::
    - キー(CMK)の暗号手順

The table below is the set of "alg" (algorithm) header parameter
values that are defined by this specification for use with JWE.

These algorithms are used to encrypt the CMK, 
producing the :term:`JWE Encrypted Key`, 
or to use key agreement to agree upon the CMK.

   +-------------------+-----------------+------------+----------------+
   | alg Parameter     | Key Management  | Additional | Implementation |
   | Value             | Algorithm       | Header     | Requirements   |
   |                   |                 | Parameters |                |
   +-------------------+-----------------+------------+----------------+
   | RSA1_5            | RSAES-PKCS1-V1_ | (none)     | Required       |
   |                   | 5[RFC3447]      |            |                |
   +-------------------+-----------------+------------+----------------+
   | RSA-OAEP          | RSAES using     | (none)     | Optional       |
   |                   | Optimal         |            |                |
   |                   | Asymmetric      |            |                |
   |                   | Encryption      |            |                |
   |                   | Padding (OAEP)  |            |                |
   |                   | [RFC3447], with |            |                |
   |                   | the default     |            |                |
   |                   | parameters      |            |                |
   |                   | specified by    |            |                |
   |                   | RFC 3447 in     |            |                |
   |                   | Section A.2.1   |            |                |
   +-------------------+-----------------+------------+----------------+
   | A128KW            | Advanced        | (none)     | Recommended    |
   |                   | Encryption      |            |                |
   |                   | Standard (AES)  |            |                |
   |                   | Key Wrap        |            |                |
   |                   | Algorithm       |            |                |
   |                   | [RFC3394] using |            |                |
   |                   | the default     |            |                |
   |                   | initial value   |            |                |
   |                   | specified in    |            |                |
   |                   | Section 2.2.3.1 |            |                |
   |                   | and using 128   |            |                |
   |                   | bit keys        |            |                |
   +-------------------+-----------------+------------+----------------+
   | A192KW            | AES Key Wrap    | (none)     | Optional       |
   |                   | Algorithm using |            |                |
   |                   | the default     |            |                |
   |                   | initial value   |            |                |
   |                   | specified in    |            |                |
   |                   | Section 2.2.3.1 |            |                |
   |                   | and using 192   |            |                |
   |                   | bit keys        |            |                |
   +-------------------+-----------------+------------+----------------+
   | A256KW            | AES Key Wrap    | (none)     | Recommended    |
   |                   | Algorithm using |            |                |
   |                   | the default     |            |                |
   |                   | initial value   |            |                |
   |                   | specified in    |            |                |
   |                   | Section 2.2.3.1 |            |                |
   |                   | and using 256   |            |                |
   |                   | bit keys        |            |                |
   |                   |                 |            |                |
   +-------------------+-----------------+------------+----------------+
   | dir               | Direct use of a | (none)     | Recommended    |
   |                   | shared          |            |                |
   |                   | symmetric key   |            |                |
   |                   | as the Content  |            |                |
   |                   | Encryption Key  |            |                |
   |                   | (CEK) for the   |            |                |
   |                   | content         |            |                |
   |                   | encryption step |            |                |
   |                   | (rather than    |            |                |
   |                   | using the       |            |                |
   |                   | symmetric key   |            |                |
   |                   | to wrap the     |            |                |
   |                   | CEK)            |            |                |
   +-------------------+-----------------+------------+----------------+
   | ECDH-ES           | Elliptic Curve  | "epk",     | Recommended+   |
   |                   | Diffie-Hellman  | "apu",     |                |
   |                   | Ephemeral       | "apv"      |                |
   |                   | Static          |            |                |
   |                   | [RFC6090] key   |            |                |
   |                   | agreement using |            |                |
   |                   | the Concat KDF, |            |                |
   |                   | as defined in   |            |                |
   |                   | Section 5.8.1   |            |                |
   |                   | of              |            |                |
   |                   | [NIST.800-56A], |            |                |
   |                   | with the        |            |                |
   |                   | agreed-upon key |            |                |
   |                   | being used      |            |                |
   |                   | directly as the |            |                |
   |                   | Content         |            |                |
   |                   | Encryption Key  |            |                |
   |                   | (CEK) (rather   |            |                |
   |                   | than being used |            |                |
   |                   | to wrap the     |            |                |
   |                   | CEK), as        |            |                |
   |                   | specified in    |            |                |
   |                   | Section 4.7     |            |                |
   +-------------------+-----------------+------------+----------------+
   | ECDH-ES+A128KW    | Elliptic Curve  | "epk",     | Recommended    |
   |                   | Diffie-Hellman  | "apu",     |                |
   |                   | Ephemeral       | "apv"      |                |
   |                   | Static key      |            |                |
   |                   | agreement per   |            |                |
   |                   | "ECDH-ES" and   |            |                |
   |                   | Section 4.7,    |            |                |
   |                   | where the       |            |                |
   |                   | agreed-upon key |            |                |
   |                   | is used to wrap |            |                |
   |                   | the Content     |            |                |
   |                   | Encryption Key  |            |                |
   |                   | (CEK) with the  |            |                |
   |                   | "A128KW"        |            |                |
   |                   | function        |            |                |
   |                   | (rather than    |            |                |
   |                   | being used      |            |                |
   |                   | directly as the |            |                |
   |                   | CEK)            |            |                |
   +-------------------+-----------------+------------+----------------+
   | ECDH-ES+A192KW    | Elliptic Curve  | "epk",     | Optional       |
   |                   | Diffie-Hellman  | "apu",     |                |
   |                   | Ephemeral       | "apv"      |                |
   |                   | Static key      |            |                |
   |                   | agreement,      |            |                |
   |                   | where the       |            |                |
   |                   | agreed-upon key |            |                |
   |                   | is used to wrap |            |                |
   |                   | the Content     |            |                |
   |                   | Encryption Key  |            |                |
   |                   | (CEK) with the  |            |                |
   |                   | "A192KW"        |            |                |
   |                   | function        |            |                |
   |                   | (rather than    |            |                |
   |                   | being used      |            |                |
   |                   | directly as the |            |                |
   |                   | CEK)            |            |                |
   +-------------------+-----------------+------------+----------------+
   | ECDH-ES+A256KW    | Elliptic Curve  | "epk",     | Recommended    |
   |                   | Diffie-Hellman  | "apu",     |                |
   |                   | Ephemeral       | "apv"      |                |
   |                   | Static key      |            |                |
   |                   | agreement,      |            |                |
   |                   | where the       |            |                |
   |                   | agreed-upon key |            |                |
   |                   | is used to wrap |            |                |
   |                   | the Content     |            |                |
   |                   | Encryption Key  |            |                |
   |                   | (CEK) with the  |            |                |
   |                   | "A256KW"        |            |                |
   |                   | function        |            |                |
   |                   | (rather than    |            |                |
   |                   | being used      |            |                |
   |                   | directly as the |            |                |
   |                   | CEK)            |            |                |
   +-------------------+-----------------+------------+----------------+
   | A128GCMKW         | AES in          | "iv",      | Optional       |
   |                   | Galois/Counter  | "tag"      |                |
   |                   | Mode (GCM)      |            |                |
   |                   | [AES]           |            |                |
   |                   | [NIST.800-38D]  |            |                |
   |                   | using 128 bit   |            |                |
   |                   | keys            |            |                |
   +-------------------+-----------------+------------+----------------+
   | A192GCMKW         | AES GCM using   | "iv",      | Optional       |
   |                   | 192 bit keys    | "tag"      |                |
   +-------------------+-----------------+------------+----------------+
   | A256GCMKW         | AES GCM using   | "iv",      | Optional       |
   |                   | 256 bit keys    | "tag"      |                |
   +-------------------+-----------------+------------+----------------+
   | PBES2-HS256+A128K | PBES2 [RFC2898] | "p2s",     | Optional       |
   | W                 | with HMAC       | "p2c"      |                |
   |                   | SHA-256 as the  |            |                |
   |                   | PRF and AES Key |            |                |
   |                   | Wrap [RFC3394]  |            |                |
   |                   | using 128 bit   |            |                |
   |                   | keys for the    |            |                |
   |                   | encryption      |            |                |
   |                   | scheme          |            |                |
   +-------------------+-----------------+------------+----------------+
   | PBES2-HS384+A192K | PBES2 with HMAC | "p2s",     | Optional       |
   | W                 | SHA-256 as the  | "p2c"      |                |
   |                   | PRF and AES Key |            |                |
   |                   | Wrap using 192  |            |                |
   |                   | bit keys for    |            |                |
   |                   | the encryption  |            |                |
   |                   | scheme          |            |                |
   +-------------------+-----------------+------------+----------------+
   | PBES2-HS512+A256K | PBES2 with HMAC | "p2s",     | Optional       |
   | W                 | SHA-256 as the  | "p2c"      |                |
   |                   | PRF and AES Key |            |                |
   |                   | Wrap using 256  |            |                |
   |                   | bit keys for    |            |                |
   |                   | the encryption  |            |                |
   |                   | scheme          |            |                |
   +-------------------+-----------------+------------+----------------+



 The :term:`Additional Header Parameters` column indicates 
what additional Header Parameters are used by the algorithm, 
beyond "alg", which all use.  
All but "dir" and "ECDH-ES" also produce a JWE Encrypted Key value.

The use of "+" in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.

.. note::
    - draft 16 , http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.1

    - RSA1_5    : :rfc:`3447`
    - RSA-OAEP  : :rfc:`3447` 
    - A128KW    : :rfc:`3394` / AES Key Wrap Algorithm (128 bit)
    - A256KW 
    - dir       : 共有キーを直接つかう(ラップしない)
    - ECDH-ES   : :rfc:`6090` , http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618
    - ECDH-ES+A128KW    : CMKをキーラップさせる 
    - ECDH-ES+A256KW    : 
