.. _jwa.jwe.alg:

4.1. "alg" (Algorithm) Header Parameter Values for JWE
------------------------------------------------------------------------------------------

.. note::
    - キー(CMK)の暗号手順

The table below is the set of "alg" (algorithm) header parameter
values that are defined by this specification for use with JWE.

These algorithms are used to encrypt the CMK, 
producing the :term:`JWE Encrypted Key`, 
or to use key agreement to agree upon the CMK.

   +----------------+---------------------------------+----------------+
   | alg Parameter  | Key Encryption or Agreement     | Implementation |
   | Value          | Algorithm                       | Requirements   |
   +----------------+---------------------------------+----------------+
   | RSA1_5         | RSAES-PKCS1-V1_5 [RFC3447]      | REQUIRED       |
   | RSA-OAEP       | RSAES using Optimal Asymmetric  | OPTIONAL       |
   |                | Encryption Padding (OAEP)       |                |
   |                | [RFC3447], with the default     |                |
   |                | parameters specified by RFC     |                |
   |                | 3447 in Section A.2.1           |                |
   | A128KW         | Advanced Encryption Standard    | RECOMMENDED    |
   |                | (AES) Key Wrap Algorithm        |                |
   |                | [RFC3394] using 128 bit keys    |                |
   | A256KW         | AES Key Wrap Algorithm using    | RECOMMENDED    |
   |                | 256 bit keys                    |                |
   | dir            | Direct use of a shared          | RECOMMENDED    |
   |                | symmetric key as the Content    |                |
   |                | Master Key (CMK) for the block  |                |
   |                | encryption step (rather than    |                |
   |                | using the symmetric key to wrap |                |
   |                | the CMK)                        |                |
   | ECDH-ES        | Elliptic Curve Diffie-Hellman   | RECOMMENDED+   |
   |                | Ephemeral Static [RFC6090] key  |                |
   |                | agreement using the Concat KDF, |                |
   |                | as defined in Section 5.8.1 of  |                |
   |                | [NIST.800-56A], with the        |                |
   |                | agreed-upon key being used      |                |
   |                | directly as the Content Master  |                |
   |                | Key (CMK) (rather than being    |                |
   |                | used to wrap the CMK), as       |                |
   |                | specified in Section 4.7        |                |
   | ECDH-ES+A128KW | Elliptic Curve Diffie-Hellman   | RECOMMENDED    |
   |                | Ephemeral Static key agreement  |                |
   |                | per "ECDH-ES" and Section 4.7,  |                |
   |                | but where the agreed-upon key   |                |
   |                | is used to wrap the Content     |                |
   |                | Master Key (CMK) with the       |                |
   |                | "A128KW" function (rather than  |                |
   |                | being used directly as the CMK) |                |
   | ECDH-ES+A256KW | Elliptic Curve Diffie-Hellman   | RECOMMENDED    |
   |                | Ephemeral Static key agreement  |                |
   |                | per "ECDH-ES" and Section 4.7,  |                |
   |                | but where the agreed-upon key   |                |
   |                | is used to wrap the Content     |                |
   |                | Master Key (CMK) with the       |                |
   |                | "A256KW" function (rather than  |                |
   |                | being used directly as the CMK) |                |
   +----------------+---------------------------------+----------------+

The use of "+" in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.

.. note::
    - draft 08 , http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.1

    - RSA1_5    : :rfc:`3447`
    - RSA-OAEP  : :rfc:`3447` 
    - A128KW    : :rfc:`3394` / AES Key Wrap Algorithm (128 bit)
    - A256KW 
    - dir       : 共有キーを直接つかう(ラップしない)
    - ECDH-ES   : :rfc:`6090` , http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618
    - ECDH-ES+A128KW    : CMKをキーラップさせる 
    - ECDH-ES+A256KW    : 
