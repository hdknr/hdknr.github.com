.. _jwa.jwe.alg:

4.1. "alg" (Algorithm) Header Parameter Values for JWE
------------------------------------------------------------------------------------------

.. note::
    - キー(CMK)の暗号手順

The table below is the set of "alg" (algorithm) 
Header Parameter values that are defined 
by this specification for use with JWE.

These algorithms are used to encrypt the CEK, 
producing the JWE Encrypted Key, 
or to use key agreement to agree upon the CEK.

+-------------------+-----------------+------------+----------------+
| alg Parameter     | Key Management  | Additional | Implementation |
| Value             | Algorithm       | Header     | Requirements   |
|                   |                 | Parameters |                |
+-------------------+-----------------+------------+----------------+
| RSA1_5            | RSAES-PKCS1-V1_ | (none)     | Required       |
|                   | 5[RFC3447]      |            |                |
+-------------------+-----------------+------------+----------------+
| RSA-OAEP          | RSAES OAEP      | (none)     | Optional       |
|                   | with            |            |                |
|                   | default         |            |                |
|                   | parameters      |            |                |
+-------------------+-----------------+------------+----------------+
| RSA-OAEP-256      | RSAES OAEP      | (none)     | Optional       |
|                   | using SHA-256   |            |                |
|                   | and MGF1 with   |            |                |
|                   | SHA-256         |            |                |
+-------------------+-----------------+------------+----------------+
| A128KW            | AES Key Wrap    | (none)     | Recommended    |
|                   | with default    |            |                |
|                   | initial value   |            |                |
|                   | using 128 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| A192KW            | AES Key Wrap    | (none)     | Optional       |
|                   | with default    |            |                |
|                   | initial value   |            |                |
|                   | using 192 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| A256KW            | AES Key Wrap    | (none)     | Recommended    |
|                   | with default    |            |                |
|                   | initial value   |            |                |
|                   | using 256 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| dir               | Direct use of a | (none)     | Recommended    |
|                   | shared          |            |                |
|                   | symmetric key   |            |                |
|                   | as CEK          |            |                |
+-------------------+-----------------+------------+----------------+
| ECDH-ES           | Elliptic Curve  | "epk",     | Recommended+   |
|                   | Diffie-Hellman  | "apu",     |                |
|                   | Ephemeral       | "apv"      |                |
|                   | Static key      |            |                |
|                   | agreement using |            |                |
|                   | Concat KDF      |            |                |
+-------------------+-----------------+------------+----------------+
| ECDH-ES+A128KW    | ECDH-ES using   | "epk",     | Recommended    |
|                   | Concat KDF and  | "apu",     |                |
|                   | CEK wrapped     | "apv"      |                |
|                   | with "A128KW"   |            |                |
+-------------------+-----------------+------------+----------------+
| ECDH-ES+A192KW    | ECDH-ES using   | "epk",     | Optional       |
|                   | Concat KDF and  | "apu",     |                |
|                   | CEK wrapped     | "apv"      |                |
|                   | with "A192KW"   |            |                |
+-------------------+-----------------+------------+----------------+
| ECDH-ES+A256KW    | ECDH-ES using   | "epk",     | Recommended    |
|                   | Concat KDF and  | "apu",     |                |
|                   | CEK wrapped     | "apv"      |                |
|                   | with "A256KW"   |            |                |
+-------------------+-----------------+------------+----------------+
| A128GCMKW         | Key wrapping    | "iv",      | Optional       |
|                   | with AES GCM    | "tag"      |                |
|                   | using 128 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| A192GCMKW         | Key wrapping    | "iv",      | Optional       |
|                   | with AES GCM    | "tag"      |                |
|                   | using 192 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| A256GCMKW         | Key wrapping    | "iv",      | Optional       |
|                   | with AES GCM    | "tag"      |                |
|                   | using 256 bit   |            |                |
|                   | key             |            |                |
+-------------------+-----------------+------------+----------------+
| PBES2-HS256+A128KW| PBES2 with HMAC | "p2s",     | Optional       |
|                   | SHA-256 and     | "p2c"      |                |
|                   | "A128KW"        |            |                |
|                   | wrapping        |            |                |
+-------------------+-----------------+------------+----------------+
| PBES2-HS384+A192KW| PBES2 with HMAC | "p2s",     | Optional       |
|                   | SHA-384 and     | "p2c"      |                |
|                   | "A192KW"        |            |                |
|                   | wrapping        |            |                |
+-------------------+-----------------+------------+----------------+
| PBES2-HS512+A256KW| PBES2 with HMAC | "p2s",     | Optional       |
|                   | SHA-512 and     | "p2c"      |                |
|                   | "A256KW"        |            |                |
|                   | wrapping        |            |                |
+-------------------+-----------------+------------+----------------+


The :term:`Additional Header Parameters` column indicates 
what additional Header Parameters are used by the algorithm, 
beyond "alg", which all use.  
All but "dir" and "ECDH-ES" also produce a JWE Encrypted Key value.

The use of "+" in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.


See :ref:`Appendix A.2 <jwk.appendix.a.2>` 
for a table cross-referencing the JWE "alg" (algorithm) values 
defined in this specification 
with the equivalent identifiers used by other standards 
and software packages.

.. note:: 
    - draft 26, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1

    - RSAでCEKを非対称暗号する ( :rfc:`3447` )

        - RSA-OAEP-256

.. note::
    - draft 21, http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1

    - RSAでCEKを非対称暗号する ( :rfc:`3447` )

        - RSA1_5    
        - RSA-OAEP 

    - CEKを共有キーを使ってAESでラッピングする(:rfc:`3394`)

        - A128KW  
        - A192KW
        - A256KW 

    - dir       : 共有キーを直接つかう(JWEでキーを交換しない

    - ECDHで共有キーを派生させる
        - ECDH-ES   : :rfc:`6090`

    - ECDHで派生させたキーをAESでラッピングする

        - ECDH-ES+A128KW    :
        - ECDH-ES+A192KW    : 
        - ECDH-ES+A256KW    : 

    - CEK を AES + GCM でラッピング

        - A128GCMKW
        - A192GCMKW
        - A256GCMKW

    - PBES2
        - PBES2-HS256+A128KW
        - PBES2-HS384+A192KW
        - PBES2-HS512+A256KW 
