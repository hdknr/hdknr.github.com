5.  JWT Header
========================

The members of the JSON object represented by the JWT Header 
describe the cryptographic operations applied to the JWT and optionally, 
additional properties of the JWT.

There are two ways of distinguishing whether the JWT is a JWS or JWE. 
The first is by examining the :term:`alg` (:term:`algorithm`) header value. 
If the value represents a signature algorithm, the JWT is a JWS; 
if it represents an encryption algorithm, the JWT is a JWE. 

A second method is determining whether an :term:`enc` (:term:`encryption method`) member exists. 
If the :term:`enc` member exists, the JWT is a JWE; 
otherwise, the JWT is a JWS. 

Both methods will yield the same result.

Implementations MUST understand the entire contents of the header; 
otherwise, the JWT MUST be rejected for processing.

:term:`JWS Header Parameters` are defined by [JWS]. 
:term:`JWE Header Parameters` are defined by [JWE]. 
This specification further specifies the use of the following header parameters 
in both the cases where the JWT is a JWS and where it is a JWE.

 +--------------+-----------+-------------------+-----------------------------------------------------------------------------------+
 | Header       | JSON      | Header            | Header Parameter Semantics                                                        |
 | Parameter    | Value     | Parameter         |                                                                                   |
 | Name         | Type      | Syntax            |                                                                                   |
 |              |           |                   |                                                                                   |
 +==============+===========+===================+===================================================================================+
 | typ          | string    | String            | The :term:`typ` (type) header parameter is used to                                |
 |              |           |                   | declare structural information  about the JWT.                                    |
 |              |           |                   |                                                                                   |
 |              |           |                   | In the normal case where nested signing or                                        |
 |              |           |                   | encryption operations are not employed,                                           |
 |              |           |                   | the use of this header parameter is OPTIONAL,                                     |
 |              |           |                   | and if present, it is RECOMMENDED that its value be either "JWT"                  |
 |              |           |                   | or "http://openid.net/specs/jwt/1.0".                                             |
 |              |           |                   |                                                                                   |
 |              |           |                   | In the case that nested signing or encryption steps are employed,                 |
 |              |           |                   | the use of this header parameter is REQUIRED;                                     |
 |              |           |                   | in this case, the value MUST either be "JWS",                                     |
 |              |           |                   | to indicate that a nested signed JWT is carried in this JWT or "JWE",             |
 |              |           |                   | to indicate that a nested encrypted JWT is carried in this JWT.                   |
 |              |           |                   |                                                                                   |
 +--------------+-----------+-------------------+-----------------------------------------------------------------------------------+

(v.06)
