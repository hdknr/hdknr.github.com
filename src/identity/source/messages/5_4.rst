5.4.  Check ID Response Verification
------------------------------------------------------------

If the Client does not directly verify the :term:`ID Token` signature, 
it MUST make a request to the :term:`Check ID Endpoint` to validate the :term:`ID Token`.


.. note::
    1.  OP server
    2.  client_id = aud = RP = Client
    3.  iss = OP 
    4.  exp
    5.  nonce
    6.  acr
    7.  auth_time 
    8.  response error
    9.  issuer identifier

To verify the validity of the :term:`Token response`, 
the :term:`Client` MUST do the following:

    1.  Check that the OP that responded was really the intended OP [#]_.

    2.  The Client MUST validate that the :term:`client_id` 
        in the :term:`aud` (audience) Claim is one 
        it has registered for the :term:`Issuer` 
        identified by the value in the :term:`iss` (issuer) Claim.  [#]_
        The :term:`ID Token` MUST be rejected if the value of :term:`aud` (audience) is not valid for the Issuer.

    3.  The value of the :term:`iss` (issuer) Claim must match the :term:`Issuer` 
        for the :term:`Check ID Endpoint`"

    4   The current time MUST be less than the value of the :term:`exp` Claim.

    5.  The value of the :term:`nonce` Claim MUST be checked to verify 
        that it is the same value as the one that was sent in the :term:`Authorization Request`. 
        The Client SHOULD check the :term:`nonce` value for :term:`replay attacks`. 
        The precise method for detecting :term:`replay attacks` is client specific.

    6.  If the :term:`acr` Claim was requested, 
        the Client SHOULD check that the asserted Claim Value is appropriate. 
        The meaning and processing of :term:`acr` Claim Values is out of scope for this specification.

    7.  If the :term:`auth_time` Claim was requested, 
        the Client SHOULD check the value and request re-authentication 
        if it determines too much time has elapsed since the last user authentication.

    8.  The :term:`Check ID Endpoint` has not returned an error 
        for the :term:`ID Token` being expired or invalid.

    9.  Check that the :term:`iss` (issuer) is equal to that of the pre-configured 
        or discovered :term:`Issuer Identifier` for the user session.

.. [#] RP(Client) is the subject of this sentense.
.. [#] iss = Issuer = OP. aud = Audience = RP = Client


(draft 07)
