4.2.1. PKIX Key Type
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

In addition to the Key Types defined in JSON Web Algorithms :term:`[JWA]` 
the :term:`jwks_uri` :term:`JWK Set` can also contain a PKIX Key Type, 
which is a key type used to enable a JWK to contain a chain of 
PKIX certificates.

[[ Note: 

The PKIX Key Type is derived from the JSON Web Key (JWK) 
for PKIX Certificates :term:`[JWK.PKIX]` specification, 
which is an early work in progress. 

In the future, 
should this functionality be incorporated into a JOSE working group specification, 
it would then no longer be replicated in this document. ]]

The PKIX Key Type defines the following JWK parameters:

.. glossary::

    kty
        REQUIRED. 

        The value of the kty parameter MUST be **PKIX**.

    x5c
        REQUIRED. 

        Contains a chain of one or more PKIX certificates [RFC5280]. 

        The certificate chain is represented as a JSON array of certificate value strings. 

        Each string in the array is a DER [ITU.X690.1994] PKIX certificate encoded as base64 [RFC4648] 
        (note: not base64url). 

        The array MUST have at least one value, 
        which MUST be the PKIX certificate of the actor (e.g., the singer of a [JWS], or a recipient of a [JWE]). 

        Each additional value of the array (if any) MUST be the PKIX certificate 
        that certifies the previous certificate.

        The PKIX key type enables the same key to be represented as an X.509 certificate 
        as well as a simple JWK formatted bare key in the same document. 
        
        When the same key is published in both formats, 
        the values of the kid (Key ID), use (Key Use) and alg (Algorithm) parameters MUST be the same for both.


        When both signing and encryption keys are made available, 
        the use (Key Use) parameter value is REQUIRED for all keys in the :term:`JWK Set` at the jwks_uri 
        to indicate each key's intended usage. 
        Although some algorithms allow the same key pair to be used for both signatures and encryption, 
        doing so is NOT RECOMMENDED, as it is less secure.

The following is a non-normative example of 
a jwks_uri document with one RSA signing key represented using both the RSA and PKIX key types:

.. code-block:: javascript

  {"keys":[
   {"kty":"RSA",
    "use":"sig",
    "kid":"1b94c",
    "n":"vrjOfz9Ccdgx5nQudyhdoR17V-IubWMeOZCwX_jj0hgAsz2J_pqYW08
    PLbK_PdiVGKPrqzmDIsLI7sA25VEnHU1uCLNwBuUiCO11_-7dYbsr4iJmG0Q
    u2j8DsVyT1azpJC_NG84Ty5KKthuCaPod7iI7w0LK9orSMhBEwwZDCxTWq4a
    YWAchc8t-emd9qOvWtVMDC2BXksRngh6X5bUYLy6AyHKvj-nUy1wgzjYQDwH
    MTplCoLtU-o-8SNnZ1tmRoGE9uJkBLdh5gFENabWnU5m1ZqZPdwS-qo-meMv
    VfJb6jJVWRpl2SUtCnYG2C32qvbWbjZ_jBPD5eunqsIo1vQ",
    "e":"AQAB"},

   {"kty":"PKIX",
    "use":"sig",
    "kid":"1b94c",
    "x5c":
     ["MIIDQjCCAiqgAwIBAgIGATz/FuLiMA0GCSqGSIb3DQEBBQUAMGIxCzAJB
     gNVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRwwGgYD
     VQQKExNQaW5nIElkZW50aXR5IENvcnAuMRcwFQYDVQQDEw5CcmlhbiBDYW1
     wYmVsbDAeFw0xMzAyMjEyMzI5MTVaFw0xODA4MTQyMjI5MTVaMGIxCzAJBg
     NVBAYTAlVTMQswCQYDVQQIEwJDTzEPMA0GA1UEBxMGRGVudmVyMRwwGgYDV
     QQKExNQaW5nIElkZW50aXR5IENvcnAuMRcwFQYDVQQDEw5CcmlhbiBDYW1w
     YmVsbDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAL64zn8/QnH
     YMeZ0LncoXaEde1fiLm1jHjmQsF/449IYALM9if6amFtPDy2yvz3YlRij66
     s5gyLCyO7ANuVRJx1NbgizcAblIgjtdf/u3WG7K+IiZhtELto/A7Fck9Ws6
     SQvzRvOE8uSirYbgmj6He4iO8NCyvaK0jIQRMMGQwsU1quGmFgHIXPLfnpn
     fajr1rVTAwtgV5LEZ4Iel+W1GC8ugMhyr4/p1MtcIM42EA8BzE6ZQqC7VPq
     PvEjZ2dbZkaBhPbiZAS3YeYBRDWm1p1OZtWamT3cEvqqPpnjL1XyW+oyVVk
     aZdklLQp2Btgt9qr21m42f4wTw+Xrp6rCKNb0CAwEAATANBgkqhkiG9w0BA
     QUFAAOCAQEAh8zGlfSlcI0o3rYDPBB07aXNswb4ECNIKG0CETTUxmXl9KUL
     +9gGlqCz5iWLOgWsnrcKcY0vXPG9J1r9AqBNTqNgHq2G03X09266X5CpOe1
     zFo+Owb1zxtp3PehFdfQJ610CDLEaS9V9Rqp17hCyybEpOGVwe8fnk+fbEL
     2Bo3UPGrpsHzUoaGpDftmWssZkhpBJKVMJyf/RuP2SmmaIzmnw9JiSlYhzo
     4tpzd5rFXhjRbg4zW9C+2qok+2+qDM1iJ684gPHMIY8aLWrdgQTxkumGmTq
     gawR+N5MDtdPTEQ0XfIBc2cJEUyMTY5MPvACWpkA6SdS4xSvdXK3IVfOWA=="]}
  ]}

(draft 17)
