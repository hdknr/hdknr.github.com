5.2.  ID Token Verification
------------------------------------

To verify the validity of :term:`ID Token` 
in the Authorization or Token Endpoint Response, 
the Client MUST do the following:

    1.  If the Client has provided an :term:`id_token_encrypted_response_algs` parameter 
        during :term:`Registration`, 
        decrypt the :term:`id_token` [:term:`JWE`], 
        using the key pair specified during :term:`Registration`.

    2.  The Client MUST validate that the :term:`client_id` in the :term:`aud` (audience) Claim 
        is one it has registered for the :term:`Issuer` identified 
        by the value in the :term:`iss` (issuer) Claim. 
        The :term:`ID Token` MUST be rejected 
        if the value of :term:`aud` (audience) is not valid for the :term:`Issuer`.

    3.  The Client MUST verify the :term:`ID Token` signature 
        according to :ref:`Section 5 of JWS <jws.5>` [:term:`JWS`] 
        using the algorithm specified in the :term:`alg` parameter of the :term:`JWT header`.

    4.  The value of :term:`alg` SHOULD be the algorithm sent by the Client 
        in the :term:`id_token_signed_response_algs` parameter during :term:`Registration`.

    5.  If the :term:`alg` parameter of the :term:`JWT header` is 
        one of :term:`HS256`, :term:`HS384`, or :term:`HS512`, 
        the :term:`client_secret` for the :term:`client_id` contained in the :term:`aud` (audience) Claim 
        is used to validate the signature.

    6.  For other :term:`Signing algorithms` 
        the Client must use the signing key provided in :term:`Discovery` 
        by the :term:`Issuer` exactly matching the value of the :term:`iss` (issuer) Claim.

    7.  The current time MUST be less than the value of the :term:`exp` Claim.

    8.  The value of the :term:`nonce` Claim MUST be checked 
        to verify that it is the same value as the one 
        that was sent in the :term:`Authorization Request`. 
        The Client SHOULD check the nonce value for :term:`replay attacks`. 
        The precise method for detecting :term:`replay attacks` is client specific.
    
    9.  If the :term:`acr` Claim was requested, 
        the Client SHOULD check that the asserted Claim Value is appropriate. 
        The meaning and processing of :term:`acr` Claim Values is out of scope for this specification.

    10. If the :term:`auth_time` Claim was requested, 
        the Client SHOULD check the value and request re-authentication 
        if it determines too much time has elapsed since the last user authentication.

(draft 07)
