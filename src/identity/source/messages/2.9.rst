.. _messages.request_object:

2.9.  Request Object
------------------------------------

The request parameter enables OpenID Connect requests to be passed in a single, 
self-contained parameter and to be signed and optionally encrypted. 
It represents the request as a JWT whose Claims are the request parameters specified in :ref:`Section 2.1.1.1 <messages.2.1.1.1>`. 
This JWT is called a Request Object.

Support for the request parameter is OPTIONAL. 
The :term:`request_parameter_supported` Discovery result indicates whether the OP supports this parameter. 
Should an OP not support this parameter and an RP uses it, 
the OP MUST return the :term:`request_not_supported` error.

When the request parameter is used, 
the OpenID Connect request parameter values contained in the JWT supersede those passed 
using the OAuth 2.0 request syntax. 
However, 
some parameters MAY be passed using the OAuth 2.0 request syntax even when a Request Object is used; 
this would typically be done to enable a cached, 
pre-signed (and possibly pre-encrypted) Request Object value to be used containing the fixed request parameters, 
while parameters that may vary with each request, such as state and nonce, are passed as OAuth 2.0 parameters.

Even if a :term:`scope` parameter is present in the Request Object value, 
a scope parameter MUST always be passed using the OAuth 2.0 request syntax 
containing the openid scope value to indicate to the underlying OAuth 2.0 logic that this is an OpenID Connect request.

.. note::
    **scope** は必ずOAuthで渡す事

The Request Object MAY be signed or unsigned (plaintext). 
When it is plaintext, 
this is indicated by use of the none algorithm [JWA] in the JWS header. 
If signed, 
the Request Object SHOULD contain the Claims :term:`iss` (issuer) and :term:`aud` (audience) as members, 
with their semantics being as defined in the :doc:`JWT <jwt>` [JWT] specification.

The Request Object MAY also be encrypted using :doc:`JWE <jwe>` [JWE], 
with nested signing and encryption performed as described in the JWT [JWT] specification.

:term:`request` and :term:`request_uri` parameters MUST NOT be included in Request Objects.

An example set of Request Object Claims before base64url encoding and JWS signing is as follows:

.. code-block:: javascript

  {
   "response_type": "code id_token",
   "client_id": "s6BhdRkqt3",
   "redirect_uri": "https://client.example.org/cb",
   "scope": "openid",
   "state": "af0ifjsldkj",
   "login_hint": "janedoe@example.org",
   "max_age": 86400,
   "claims":
    {
     "userinfo":
      {
       "given_name": {"essential": true},
       "nickname": null,
       "email": {"essential": true},
       "email_verified": {"essential": true},
       "picture": null
      },
     "id_token":
      {
       "auth_time": {"essential": true},
       "acr": { "values":["urn:mace:incommon:iap:silver"] }
      }
    }
  }

( draft 18 , http://openid.bitbucket.org/openid-connect-messages-1_0.html#RequestObject )
