5.1.3.  Parameter Verification
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

The :term:`Authorization Server` MUST construct the :term:`Authorization Request Message` 
from the :term:`OpenID Request Object` and other parameters. 
Note that 
if the same parameter exists both in the :term:`OpenID Request Object` 
and other parameters, the former takes precedence. 
Using this :term:`Authorization Request Message`, 
the :term:`Authorization Server` performs the following steps of the request verification:

    1.  The :term:`Authorization Server` MUST understand 
        all the parameters except for the unsupported claims. 
        If there is any parameters that it does not understand except 
        for the unsupported claims, it MUST return an error response.

    2.  The :term:`Authorization Server` MUST verify that all the OAuth 2.0 variables 
        according to :doc:`OAuth 2.0 <oauth>`.

    3.  The :term:`Authorization Server` MUST verify that all the required parameters are present.

    4.  If the :term:`User ID claim` as a member of :term:`id_token` claim is requested 
        with a specific value, 
        the :term:`Authorization Server` MUST only send a positive response 
        if that user has an active session with the :term:`authorization server`. 

        The Authorization server MUST not reply with an :term:`ID Token` or :term:`Access Token` 
        for a different user, 
        even if they have an active session with the :term:`Authorization Server`.

    5.  If the :term:`acr` required claim is requested as a member of :term:`id_token` member 
        with values as a paramater, 
        the :term:`Authorization Server` MUST return a :term:`acr` claim value 
        that matches one of the requested values. 
        The :term:`Authorization server` MAY ask the user to re-authenticate 
        with additional factors to meet the requirements. 
    
        If this is a required claim and the requirement cannot be met, 
        then the :term:`Authorization Server` MUST return an error. 

        The client MAY make this claim optional 
        by including "optional": true in the acr object. 

        If the claim is optional and the requested value for the user cannot be provided, 
        the :term:`Authorization server` SHOULD return the sessions current :term:`acr` 
        as the value of the :term:`acr` claim. 

        If the claim is optional the :term:`Authorization server` is not requited 
        to provide this claim in it's response.

If the :term:`Authorization Server` encounters any error, 
it MUST return the error response. 

.. todo::

    Check error response... JW*?  Connect bindings?

( draft 07)
