<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:jones-oauth-jwt-bearer" />
<meta name="DC.Description.Abstract" content="This specification defines the use of a JSON Web Token (JWT) Bearer" />
<meta name="DC.Creator" content="Campbell, Brian" />
<meta name="DC.Creator" content="Mortimore, Chuck" />
<meta name="DC.Creator" content="Jones, Michael" />
<meta name="DC.Date.Issued" content="2012-04-26" />
<meta name="DC.Title" content="JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-jones-oauth-jwt-bearer-04 - JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-jones-oauth-jwt-bearer-04.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-jones-oauth-jwt-bearer-04.txt" title="PDF version of this document">pdf</a>|<a href="/id/draft-jones-oauth-jwt-bearer-04.xml" title="XML source for this document">xml</a>|<a href="/id/draft-jones-oauth-jwt-bearer-04.html" title="HTML version of this document, from XML2RFC">html</a>] [<a href='https://datatracker.ietf.org/doc/draft-jones-oauth-jwt-bearer' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="mailto:draft-jones-oauth-jwt-bearer@tools.ietf.org?subject=draft-jones-oauth-jwt-bearer%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-jones-oauth-jwt-bearer-04.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-jones-oauth-jwt-bearer-04.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-jones-oauth-jwt-bearer-04.txt" title="Run an idnits check of this document">Nits</a>]      </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-jones-oauth-jwt-bearer-00">00</a> <a href="./draft-jones-oauth-jwt-bearer-01">01</a> <a href="./draft-jones-oauth-jwt-bearer-02">02</a> <a href="./draft-jones-oauth-jwt-bearer-03">03</a> <a href="./draft-jones-oauth-jwt-bearer-04">04</a>                                                </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                           M. Jones
Internet-Draft                                                 Microsoft
Intended status: Standards Track                             B. Campbell
Expires: October 28, 2012                                  Ping Identity
                                                            C. Mortimore
                                                              Salesforce
                                                          April 26, 2012


        <span class="h1">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</span>
                    <span class="h1">draft-jones-oauth-jwt-bearer-04</span>

Abstract

   This specification defines the use of a JSON Web Token (JWT) Bearer
   Token as a means for requesting an OAuth 2.0 access token as well as
   for use as a means of client authentication.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on October 28, 2012.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as



<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


   described in the Simplified BSD License.


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Notational Conventions . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.2">1.2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-2">2</a>.  HTTP Parameter Bindings for Transporting Assertions  . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  Using JWTs as Authorization Grants . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Using JWTs for Client Authentication . . . . . . . . . . .  <a href="#page-4">4</a>
   <a href="#section-3">3</a>.  JWT Format and Processing Requirements . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-3.1">3.1</a>.  Authorization Grant Processing . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-3.2">3.2</a>.  Client Authentication Processing . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  Authorization Grant Example  . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
   <a href="#section-5">5</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     6.1.  Sub-Namespace Registration of
           urn:ietf:params:oauth:grant-type:jwt-bearer  . . . . . . .  <a href="#page-7">7</a>
     6.2.  Sub-Namespace Registration of
           urn:ietf:params:oauth:client-assertion-type:jwt-bearer . .  <a href="#page-8">8</a>
   <a href="#section-7">7</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-7.1">7.1</a>.  Normative References . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
     <a href="#section-7.2">7.2</a>.  Informative References . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-B">Appendix B</a>.  Document History  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
























<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   JSON Web Token (JWT) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>] is a JSON-based security token encoding
   that enables identity and security information to be shared across
   security domains.  JWTs utilize JSON data structures, as defined in
   <a href="./rfc4627">RFC 4627</a> [<a href="./rfc4627" title="&quot;The application/json Media Type for JavaScript Object Notation (JSON)&quot;">RFC4627</a>].  A security token is generally issued by an
   identity provider and consumed by a relying party that relies on its
   content to identify the token's subject for security related
   purposes.

   The OAuth 2.0 Authorization Protocol [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>] provides a
   method for making authenticated HTTP requests to a resource using an
   access token.  Access tokens are issued to third-party clients by an
   authorization server (AS) with the (sometimes implicit) approval of
   the resource owner.  In OAuth, an authorization grant is an abstract
   term used to describe intermediate credentials that represent the
   resource owner authorization.  An authorization grant is used by the
   client to obtain an access token.  Several authorization grant types
   are defined to support a wide range of client types and user
   experiences.  OAuth also allows for the definition of new extension
   grant types to support additional clients or to provide a bridge
   between OAuth and other trust frameworks.  Finally, OAuth allows the
   definition of additional authentication mechanisms to be used by
   clients when interacting with the authorization server.

   The OAuth 2.0 Assertion Profile [<a href="#ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>] is an
   abstract extension to OAuth 2.0 that provides a general framework for
   the use of Assertions (a.k.a.  Security Tokens) as client credentials
   and/or authorization grants with OAuth 2.0.  This specification
   profiles the OAuth 2.0 Assertion Profile [<a href="#ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>]
   to define an extension grant type that uses a JSON Web Token (JWT)
   Bearer Token to request an OAuth 2.0 access token as well as for use
   as client credentials.  The format and processing rules for the JWT
   defined in this specification are intentionally similar, though not
   identical, to those in the closely related SAML 2.0 Bearer Assertion
   Profiles for OAuth 2.0 [<a href="#ref-I-D.ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</a>].

   This document defines how a JSON Web Token (JWT) Bearer Token can be
   used to request an access token when a client wishes to utilize an
   existing trust relationship, expressed through the semantics of (and
   digital signature calculated over) the JWT, without a direct user
   approval step at the authorization server.  It also defines how a JWT
   can be used as a client authentication mechanism.  The use of a
   security token for client authentication is orthogonal and separable
   from using a security token as an authorization grant and the two can
   be used either in combination or in isolation.

   The process by which the client obtains the JWT, prior to exchanging



<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


   it with the authorization server or using it for client
   authentication, is out of scope.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Notational Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   Unless otherwise noted, all the protocol parameter names and values
   are case sensitive.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   All terms are as defined in The OAuth 2.0 Authorization Protocol
   [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>], OAuth 2.0 Assertion Profile
   [<a href="#ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>], and JSON Web Token (JWT) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>].


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  HTTP Parameter Bindings for Transporting Assertions</span>

   The OAuth 2.0 Assertion Profile [<a href="#ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>] defines
   generic HTTP parameters for transporting Assertions (a.k.a.  Security
   Tokens) during interactions with a token endpoint.  This section
   defines the values of those parameters for use with JWT Bearer
   Tokens.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Using JWTs as Authorization Grants</span>

   To use a JWT Bearer Token as an authorization grant, use the
   following parameter values and encodings.

   The value of the "grant_type" parameter MUST be
   "urn:ietf:params:oauth:grant-type:jwt-bearer".

   The value of the "assertion" parameter MUST contain a single JWT.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Using JWTs for Client Authentication</span>

   To use a JWT Bearer Token for client authentication grant, use the
   following parameter values and encodings.

   The value of the "client_assertion_type" parameter MUST be
   "urn:ietf:params:oauth:client-assertion-type:jwt-bearer".

   The value of the "client_assertion" parameter MUST contain a single
   JWT.




<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  JWT Format and Processing Requirements</span>

   In order to issue an access token response as described in The OAuth
   2.0 Authorization Protocol [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>] or to rely on a JWT
   for client authentication, the authorization server MUST validate the
   JWT according to the criteria below.  Application of additional
   restrictions and policy are at the discretion of the authorization
   server.

   o  The JWT MUST contain an "iss" (issuer) claim that contains a
      unique identifier for the entity that issued the JWT.

   o  The JWT MUST contain a "prn" (principal) claim identifying the
      subject of the transaction.  The principal MAY identify the
      resource owner for whom the access token is being requested.  For
      client authentication, the principal MUST be the "client_id" of
      the OAuth client.  When using a JWT as an authorization grant, the
      principal SHOULD identify an authorized accessor for whom the
      access token is being requested (typically the resource owner, or
      an authorized delegate).

   o  The JWT MUST contain an "aud" (audience) claim containing a URI
      reference that identifies the authorization server, or the service
      provider principal entity of its controlling domain, as an
      intended audience.  The token endpoint URL of the authorization
      server MAY be used as an acceptable value for an "aud" element.
      The authorization server MUST verify that it is an intended
      audience for the JWT.

   o  The JWT MUST contain an "exp" (expiration) claim that limits the
      time window during which the JWT can be used.  The authorization
      server MUST verify that the expiration time has not passed,
      subject to allowable clock skew between systems.  The
      authorization server MAY reject JWTs with an "exp" claim value
      that is unreasonably far in the future.

   o  The JWT MAY contain an "nbf" (not before) claim that identifies
      the time before which the token MUST NOT be accepted for
      processing.

   o  The JWT MAY contain an "iat" (issued at) claim that identifies the
      time at which the JWT was issued.  The authorization server MAY
      reject JWTs with an "iat" claim value that is unreasonably far in
      the past.

   o  The JWT MAY contain a "jti" (JWT ID) claim that provides a unique
      identifier for the token.  The authorization server MAY ensure
      that JWTs are not replayed by maintaining the set of used "jti"



<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


      values for the length of time for which the JWT would be
      considered valid based on the applicable "exp" instant.

   o  The JWT MAY contain other claims.

   o  The JWT MUST be digitally signed by the issuer and the
      authorization server MUST verify the signature.

   o  The authorization server MUST verify that the JWT is valid in all
      other respects per JSON Web Token (JWT) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>].

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Authorization Grant Processing</span>

   If present, the authorization server MUST also validate the client
   credentials.

   If the JWT is not valid, or the current time is not within the
   token's valid time window for use, the authorization server MUST
   construct an error response as defined in OAuth 2.0
   [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>].  The value of the "error" parameter MUST be the
   "invalid_grant" error code.  The authorization server MAY include
   additional information regarding the reasons the JWT was considered
   invalid using the "error_description" or "error_uri" parameters.

   For example:
   HTTP/1.1 400 Bad Request
   Content-Type: application/json
   Cache-Control: no-store

   {
    "error":"invalid_grant",
    "error_description":"Audience validation failed"
   }

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Client Authentication Processing</span>

   If the client JWT is not valid, or its subject confirmation
   requirements cannot be met, the authorization server MUST construct
   an error response as defined in OAuth 2.0 [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>].  The
   value of the "error" parameter MUST be the "invalid_client" error
   code.  The authorization server MAY include additional information
   regarding the reasons the JWT was considered invalid using the
   "error_description" or "error_uri" parameters.


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Authorization Grant Example</span>

   Though non-normative, the following examples illustrate what a



<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


   conforming JWT and access token request would look like.

   Below is an example JSON object that could be encoded to produce the
   JWT Claims Object for a JWT:
   {"iss":"https://jwt-idp.example.com",
    "prn":"mailto:mike@example.com",
    "aud":"https://jwt-rp.example.net",
    "nbf":1300815780,
    "exp":1300819380,
    "http://claims.example.com/member":true}

   The following example JSON object, used as the header of a JWT,
   declares that the JWT is signed with the ECDSA P-256 SHA-256
   algorithm.
   {"alg":"ES256"}

   To present the JWT with the claims and header shown in the previous
   example as part of an access token request, for example, the client
   might make the following HTTPS request (with line breaks for display
   purposes only):
   POST /token.oauth2 HTTP/1.1
   Host: authz.example.net
   Content-Type: application/x-www-form-urlencoded

   grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
   &amp;assertion=eyJhbGciOiJFUzI1NiJ9.
   eyJpc3Mi[...omitted for brevity...].
   J9l-ZhwP_2n[...omitted for brevity...]


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Security Considerations</span>

   No additional security considerations apply beyond those described
   within The OAuth 2.0 Authorization Protocol [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>], the
   OAuth 2.0 Assertion Profile [<a href="#ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>], and the JSON
   Web Token (JWT) [<a href="#ref-JWT" title="&quot;JSON Web Token (JWT)&quot;">JWT</a>] specification.


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Sub-Namespace Registration of</span>
      urn:ietf:params:oauth:grant-type:jwt-bearer

   This is a request to IANA to please register the value
   "grant-type:jwt-bearer" in the registry urn:ietf:params:oauth
   established in An IETF URN Sub-Namespace for OAuth
   [<a href="#ref-I-D.ietf-oauth-urn-sub-ns">I-D.ietf-oauth-urn-sub-ns</a>].




<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


   o  URN: urn:ietf:params:oauth:grant-type:jwt-bearer

   o  Common Name: JWT Bearer Token Grant Type Profile for OAuth 2.0

   o  Change controller: IETF

   o  Description: [[this document]]

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Sub-Namespace Registration of</span>
      urn:ietf:params:oauth:client-assertion-type:jwt-bearer

   This is a request to IANA to please register the value
   "client-assertion-type:jwt-bearer" in the registry
   urn:ietf:params:oauth established in An IETF URN Sub-Namespace for
   OAuth [<a href="#ref-I-D.ietf-oauth-urn-sub-ns">I-D.ietf-oauth-urn-sub-ns</a>].

   o  URN: urn:ietf:params:oauth:client-assertion-type:jwt-bearer

   o  Common Name: JWT Bearer Token Profile for OAuth 2.0 Client
      Authentication

   o  Change controller: IETF

   o  Description: [[this document]]


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a name="ref-I-D.ietf-oauth-assertions" id="ref-I-D.ietf-oauth-assertions">I-D.ietf-oauth-assertions</a>]
              Mortimore, C., Ed., Jones, M., Campbell, B., and Y.
              Goland, "OAuth 2.0 Assertion Profile",
              <a href="./draft-ietf-oauth-assertions-02">draft-ietf-oauth-assertions-02</a> (work in progress),
              April 2012.

   [<a name="ref-I-D.ietf-oauth-urn-sub-ns" id="ref-I-D.ietf-oauth-urn-sub-ns">I-D.ietf-oauth-urn-sub-ns</a>]
              Tschofenig, H., "An IETF URN Sub-Namespace for OAuth",
              <a href="./draft-ietf-oauth-urn-sub-ns-02">draft-ietf-oauth-urn-sub-ns-02</a> (work in progress),
              January 2012.

   [<a name="ref-I-D.ietf-oauth-v2" id="ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>]
              Hammer-Lahav, E., Recordon, D., and D. Hardt, "The OAuth
              2.0 Authorization Protocol", <a href="./draft-ietf-oauth-v2-25">draft-ietf-oauth-v2-25</a> (work
              in progress), March 2012.

   [<a name="ref-JWT" id="ref-JWT">JWT</a>]      Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
              J., Sakimura, N., and P. Tarjan, "JSON Web Token (JWT)",



<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


              March 2012.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC4627" id="ref-RFC4627">RFC4627</a>]  Crockford, D., "The application/json Media Type for
              JavaScript Object Notation (JSON)", <a href="./rfc4627">RFC 4627</a>, July 2006.

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a name="ref-I-D.ietf-oauth-saml2-bearer" id="ref-I-D.ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</a>]
              Campbell, B., Ed. and C. Mortimore, "SAML 2.0 Bearer
              Assertion Profiles for OAuth 2.0",
              <a href="./draft-ietf-oauth-saml2-bearer-11">draft-ietf-oauth-saml2-bearer-11</a> (work in progress),
              April 2012.


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Acknowledgements</span>

   This profile was derived from SAML 2.0 Bearer Assertion Profiles for
   OAuth 2.0 [<a href="#ref-I-D.ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</a>] by Brian Campbell and Chuck
   Mortimore.


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Document History</span>

   [[ to be removed by RFC editor before publication as an RFC ]]

   -04

   o  Merged in changes between <a href="./draft-ietf-oauth-saml2-bearer-09">draft-ietf-oauth-saml2-bearer-09</a> and
      <a href="./draft-ietf-oauth-saml2-bearer-11">draft-ietf-oauth-saml2-bearer-11</a>.

   o  Added the optional "iat" (issued at) claim, which was already
      present in the JWT spec.

   -03

   o  Added the "jti" (JWT ID) claim to enable replay protection.

   o  Respect line length restrictions in examples.

   -02

   o  Removed remaining vestiges of normative text talking about SAML
      that remained from the SAML Profile draft.





<span class="grey">Jones, et al.           Expires October 28, 2012                [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft       OAuth JWT Bearer Token Profiles          April 2012</span>


   o  Replaced all references where the reference is used as if it were
      part of the sentence (such as "defined by [I-D.whatever]") with
      ones where the specification name is used, followed by the
      reference (such as "defined by Whatever [I-D.whatever]").

   -01

   o  Merged in changes from <a href="./draft-ietf-oauth-saml2-bearer-09">draft-ietf-oauth-saml2-bearer-09</a>.  In
      particular, this draft now uses <a href="./draft-ietf-oauth-assertions">draft-ietf-oauth-assertions</a>,
      rather than being standalone.  It also now defines how to use JWT
      bearer tokens both for Authorization Grants and for Client
      Authentication.

   -00

   o  Initial draft.


Authors' Addresses

   Michael B. Jones
   Microsoft

   Email: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>


   Brian Campbell
   Ping Identity Corp.

   Email: brian.d.campbell@gmail.com


   Chuck Mortimore
   Salesforce.com

   Email: cmortimore@salesforce.com














Jones, et al.           Expires October 28, 2012               [Page 10]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
