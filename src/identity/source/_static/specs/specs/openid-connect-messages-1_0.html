<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Draft: OpenID Connect Messages 1.0 - draft 12</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="OpenID Connect Messages 1.0 - draft 12">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Draft</td><td class="header">N. Sakimura</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NRI</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Bradley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ping Identity</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Jones</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Microsoft</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. de Medeiros</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Mortimore</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Salesforce</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">E. Jay</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Illumila</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 23, 2012</td></tr>
</table></td></tr></table>
<h1><br />OpenID Connect Messages 1.0 - draft 12</h1>

<h3>Abstract</h3>

<p>OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0
      protocol. It allows Clients to verify the identity of the End-User based
      on the authentication performed by an Authorization Server, as well as to
      obtain basic profile information about the End-User in an interoperable and 
      RESTful manner.
</p>
<p>This specification only defines the endpoints and 
      the associated message formats. 
      The actual use MUST be based on one of 
      the companion protocol bindings specifications 
      such as OpenID Connect Standard.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rnc">1.1.</a>&nbsp;
Requirements Notation and Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.2.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.3.</a>&nbsp;
Overview<br />
<a href="#anchor3">2.</a>&nbsp;
Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id_token">2.1.1.</a>&nbsp;
ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_req">2.1.2.</a>&nbsp;
Authorization Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#OpenID_Request_Object">2.1.2.1.</a>&nbsp;
OpenID Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.3.</a>&nbsp;
Authorization Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.4.</a>&nbsp;
Authorization Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token_ep">2.2.</a>&nbsp;
Token Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client_authentication">2.2.1.</a>&nbsp;
Client Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#access_token_request">2.2.2.</a>&nbsp;
Access Token Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#access_token_response">2.2.3.</a>&nbsp;
Access Token Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.2.4.</a>&nbsp;
Token Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#userinfo_ep">2.3.</a>&nbsp;
UserInfo Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.3.1.</a>&nbsp;
UserInfo Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.3.2.</a>&nbsp;
UserInfo Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#address_claim">2.3.2.1.</a>&nbsp;
Address Claim<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#claim.stability">2.3.2.2.</a>&nbsp;
Claim Stability and Uniqueness<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.3.3.</a>&nbsp;
UserInfo Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#idtype">2.4.</a>&nbsp;
User Identifier Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#idtype.pairwise.alg">2.4.1.</a>&nbsp;
Pairwise Identifier Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.5.</a>&nbsp;
Claim Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.5.1.</a>&nbsp;
Normal Claims<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.5.2.</a>&nbsp;
Aggregated and Distributed Claims<br />
<a href="#Serializations">3.</a>&nbsp;
Serializations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#js">3.1.</a>&nbsp;
JSON Serialization<br />
<a href="#sigenc">4.</a>&nbsp;
Signatures and Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigenc.alg">4.1.</a>&nbsp;
Supported Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigenc.key">4.2.</a>&nbsp;
Keys<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigs">4.3.</a>&nbsp;
Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#enc">4.4.</a>&nbsp;
Encryption<br />
<a href="#anchor14">5.</a>&nbsp;
Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.</a>&nbsp;
Authorization Request Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.1.</a>&nbsp;
Encrypted Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signed.req.obj.var">5.1.2.</a>&nbsp;
Signed Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#req.obj.veri">5.1.3.</a>&nbsp;
Parameter Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id.token.verification">5.2.</a>&nbsp;
ID Token Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.3.</a>&nbsp;
UserInfo Response Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#access.token.verification">5.4.</a>&nbsp;
Access Token Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code.verification">5.5.</a>&nbsp;
Code Verification<br />
<a href="#stringops">6.</a>&nbsp;
String Operations<br />
<a href="#related">7.</a>&nbsp;
Related Specifications<br />
<a href="#security_considerations">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request_disclosure">8.1.</a>&nbsp;
Request Disclosure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#server_masquerading">8.2.</a>&nbsp;
Server Masquerading<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token_manufacture">8.3.</a>&nbsp;
Token Manufacture/Modification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#response_disclosure">8.4.</a>&nbsp;
Server Response Disclosure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#server_response_repudiation">8.5.</a>&nbsp;
Server Response Repudiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request_repudation">8.6.</a>&nbsp;
Request Repudiation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#access_token_redirect">8.7.</a>&nbsp;
Access Token Redirect<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token_reuse">8.8.</a>&nbsp;
Token Reuse<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_code_capture">8.9.</a>&nbsp;
 Eavesdropping or leaking authorization codes (Secondary Authenticator Capture)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token_substitution">8.10.</a>&nbsp;
Token Substitution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">8.11.</a>&nbsp;
Timing Attack<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">8.12.</a>&nbsp;
Other Crypto Related Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signing_order">8.13.</a>&nbsp;
Signing and Encryption order<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#issuer_identifier">8.14.</a>&nbsp;
Issuer Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TLS_requirements">8.15.</a>&nbsp;
TLS Requirements<br />
<a href="#privacy_considerations">9.</a>&nbsp;
Privacy Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#token_lifetime">9.1.</a>&nbsp;
Refresh Token, and Access Token Lifetime<br />
<a href="#iana">10.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#anchor22">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor23">Appendix&nbsp;B.</a>&nbsp;
Notices<br />
<a href="#anchor24">Appendix&nbsp;C.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="rnc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Notation and Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
	"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
	document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<p>Throughout this document, values are quoted to indicate that they are
	to be taken literally. When using these values in protocol messages, the
	quotes MUST NOT be used as part of the value.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>This specification uses the terms "Access Token", "Refresh Token",
	"Authorization Code", "Authorization Grant", "Authorization Server",
	"Authorization Endpoint", "Client", "Client Identifier", "Client
	Secret", "Protected Resource", "Resource Owner", "Resource Server", and
	"Token Endpoint" defined by
	<a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0],
	and the terms "Claim Names" and "Claim Values" defined by
	<a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT].
	This specification also defines the following terms:
	  </p>
<blockquote class="text"><dl>
<dt>Authentication</dt>
<dd>An act of verifying End-User's possession 
	    of previously provisioned credentials.
</dd>
<dt>Authentication Context</dt>
<dd>
            Information that the Relying Party may require before it makes an 
            entitlements decision with respect to an authentication response. 
            Such context may include, but is not limited to, the actual 
            authentication method used or level of assurance such as 
            <a class='info' href='#ISO29115'>ITU-T X.1254 | ISO/IEC 29115<span> (</span><span class='info'>International Telecommunication Union and International Organization for Standardization, &ldquo;ITU-T Recommendation X.1254 | ISO/IEC DIS 29115 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; November&nbsp;2011.</span><span>)</span></a> [ISO29115] 
            entity authentication assurance level.
            
</dd>
<dt>Authentication Context Class Reference</dt>
<dd>
            Identifier that identifies the Authentication Context. 
            
</dd>
<dt>Claim</dt>
<dd>A piece of information about an Entity that a
	    Claims Provider asserts about that Entity.
</dd>
<dt>Claims Provider</dt>
<dd>A Server that can
	    return Claims about an Entity.
</dd>
<dt>End-User</dt>
<dd>A human Resource Owner.
</dd>
<dt>Entity</dt>
<dd>Something that has a separate and
	    distinct existence and that can be identified in context.
	    An End-User is one example of an Entity.
</dd>
<dt>Personally Identifiable Information (PII)</dt>
<dd>
            Any information that (a) can be used to identify the natural person 
            to whom such information relates, or 
            (b) is or might be directly or indirectly linked to a 
            natural person to whom such information relates. 
</dd>
<dt>Pairwise Pseudonymous Identifier (PPID)</dt>
<dd>
        An identifier that identifies the Entity to a Relying Party. 
        An Entity's PPID at one Relying Party cannot be correlated 
        with the Entity's PPID at another Relying Party. 
</dd>
<dt>ID Token</dt>
<dd>A token that contains Claims about the
	    authentication event.
</dd>
<dt>Issuer</dt>
<dd>An Entity that issues a set of Claims.
</dd>
<dt>Issuer Identifier</dt>
<dd>A verifiable identifier for
	    an Issuer.  An Issuer Identifier is an HTTPS URL that
	    contains scheme, host, and OPTIONALLY, port number and path
	    components.  (No query or fragment components may be present.)
</dd>
<dt>Message</dt>
<dd>A request or a response between an OpenID 
	    Relying Party and an OpenID Provider.
</dd>
<dt>OpenID Provider (OP)</dt>
<dd>
        A service capable of providing Claims to a Relying Party. 
        It is an OAuth 2.0 Authorization Server that is capable of 
        returning claims around the authentication event and 
        other Claims in <tt>id_token</tt> 
        and UserInfo Endpoint response. 
      
</dd>
<dt>OP Endpoints</dt>
<dd>Authorization Endpoint, Token
	    Endpoint, and UserInfo Endpoint.
</dd>
<dt>OpenID Request Object</dt>
<dd>A JSON object that holds the
	    OpenID request parameters.
</dd>
<dt>Relying Party (RP)</dt>
<dd>
        An application requiring Claims from an OpenID Provider. 
        It is an extended OAuth 2.0 client. 
      
</dd>
<dt>UserInfo Endpoint</dt>
<dd>A Protected Resource that, when
	    presented with an Access Token by the Client, returns Claims
	    about the End-User represented by that Access Token.
</dd>
</dl></blockquote>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Overview</h3>

<p>The OpenID Connect protocol, in abstract, follows the following
	steps.
</p>
<p></p>
<ol class="text">
<li>The RP (Client) sends a request to the OP's (Authorization Server's) 
        End-User Authorization Endpoint.
</li>
<li>The OP authenticates the End-User and obtains 
	    appropriate authorization.
</li>
<li>The OP responds with an Access Token, an Id Token, 
	    and a few other variables.
</li>
<li>The RP sends a request with the Access Token to the <a class='info' href='#userinfo_ep'>UserInfo Endpoint<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a>.
</li>
<li>UserInfo Endpoint returns the additional End-User information
	    supported by the Resource Server.
</li>
</ol><p>
	This specification
	only defines the abstract message flow and message formats. The actual
	use MUST be based on one of the companion protocol bindings
	specifications such as <a class='info' href='#OpenID.Basic'>OpenID Connect
	Basic Client<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;OpenID Connect Basic Client Profile 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Basic] or <a class='info' href='#OpenID.Standard'>OpenID Connect
	Standard<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Standard 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Standard].
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Messages</h3>

<p>In OpenID Connect protocols, in abstract, the process proceeds by the
      RP interacting with endpoints. There are a number of endpoints
      involved.
</p>
<p></p>
<ol class="text">
<li>Authorization Endpoint: The RP sends a request to the 
          OP at the Authorization Endpoint. The OP 
          then authenticates the End-User to find out if he is eligible
          to make the authorization. Then, upon the authorization action of the
          End-User, the Authorization Server returns an Authorization Response
          that includes Authorization Code, <tt>code</tt>.
          For some Clients, Implicit Grant may be used to obtain <tt>access_token</tt> without using <tt>code</tt>. In this case, <tt>response_type</tt> MUST include <tt>token</tt>. When <tt>id_token</tt>
          was specified in the <tt>response_type</tt>, 
          then the <tt>id_token</tt> is returned 
          from this endpoint as well. 
</li>
<li>Token Endpoint: The Client sends the Access Token Request to the
          Token Endpoint to obtain an Access Token Response which includes an
          <tt>access_token</tt>.
</li>
<li>UserInfo Endpoint: The <tt>access_token</tt>
          MAY be sent to the UserInfo Endpoint to obtain Claims about the
          End-User.
</li>
</ol>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Authorization Endpoint</h3>

<p>The RP sends an Authorization Request to the Authorization
        Endpoint of the OP to obtain either an Authorization Response or an 
        <a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a> or both depending on 
        <tt>response_type</tt> and 
        <tt>scope</tt>.
</p>
<a name="id_token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
ID Token</h3>

<p>The ID Token is a security token that contains Claims about the
          authentication event and other requested Claims.  
          The ID Token is represented as a <a class='info' href='#JWT'>JSON Web Token (JWT)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT].
</p>
<p>The ID Token is used to manage the authentication event and user
          identifier and is scoped to a particular Client via the <tt>aud</tt> (audience) and <tt>nonce</tt>
          Claims. 
</p>
<p>The following Claims are REQUIRED and OPTIONAL within the ID Token:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>iss</dt>
<dd>REQUIRED. The Issuer Identifier for the Issuer
              of the response.
</dd>
<dt>user_id</dt>
<dd>REQUIRED. A locally unique and never
              reassigned identifier within the Issuer for the End-User, 
              which is intended to be
              consumed by the Client. e.g. <tt>24400320</tt>
              or <tt>AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4</tt>.
              It MUST NOT exceed 255 ASCII characters in length.
</dd>
<dt>aud</dt>
<dd>REQUIRED. This member identifies the audience
              that this ID Token is intended for. It MUST be the OAuth 2.0 <tt>client_id</tt>
              of the Client.
</dd>
<dt>exp</dt>
<dd>REQUIRED. Type Integer. Identifies the
              expiration time on or after which the ID Token MUST NOT be
              accepted for processing. The processing of this parameter
              requires that the current date/time MUST be before the
              expiration date/time listed in the value. Implementers MAY
              provide for some small leeway, usually no more than a few
              minutes, to account for clock skew. The value is number of
              seconds from 1970-01-01T0:0:0Z as measured in UTC until the
              desired date/time. See <a class='info' href='#RFC3339'>RFC 3339<span> (</span><span class='info'>Klyne, G., Ed. and C. Newman, &ldquo;Date and Time on the Internet: Timestamps,&rdquo; July&nbsp;2002.</span><span>)</span></a> [RFC3339]
              for details regarding date/times in general and UTC in
              particular.
</dd>
<dt>iat</dt>
<dd>REQUIRED. Type Integer. The <tt>iat</tt> 
              (issued at) Claim identifies the time at which the JWT was issued. 
              The value is number of
              seconds from 1970-01-01T0:0:0Z as measured in UTC until the
              desired date/time. See <a class='info' href='#RFC3339'>RFC 3339<span> (</span><span class='info'>Klyne, G., Ed. and C. Newman, &ldquo;Date and Time on the Internet: Timestamps,&rdquo; July&nbsp;2002.</span><span>)</span></a> [RFC3339]
              for details regarding date/times in general and UTC in
              particular.
</dd>
<dt>acr</dt>
<dd>OPTIONAL. (Authentication Context Class Reference): 
              Specifies an Authentication Context Class Reference of the ID Token. 
              The values "1", "2", "3", and "4" map to the
              <a class='info' href='#ISO29115'>ITU-T X.1254 | ISO/IEC 29115<span> (</span><span class='info'>International Telecommunication Union and International Organization for Standardization, &ldquo;ITU-T Recommendation X.1254 | ISO/IEC DIS 29115 --           Information technology - Security techniques - Entity authentication           assurance framework,&rdquo; November&nbsp;2011.</span><span>)</span></a> [ISO29115] 
              entity authentication assurance level of the authentication performed. 
              The value "0" indicates the End User authentication
              did not meet the requirements of ISO/IEC 29115 level 1.
              Authentication using a long-lived browser cookie, for instance, is one 
              example where the use of "level 0" is appropriate. Authentications with 
              level 0 should never be used to authorize access to any resource of any 
              monetary value.  
              (This corresponds to the OpenID 2.0
              <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider             Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] 
              <tt>nist_auth_level</tt> 0.)
              An absolute URI or a <a class='info' href='#LoA.Registry'>registered short 
              name<span> (</span><span class='info'>Johansson, L., &ldquo;An IANA registry for SAML 2.0 Level            of Assurance Context Classes,&rdquo; February&nbsp;2012.</span><span>)</span></a> [LoA.Registry] MAY be used as an <tt>acr</tt> value.
              
</dd>
<dt>nonce</dt>
<dd>A string value used to associate a Client session 
              with an ID Token, and to mitigate replay attacks. 
              The value is passed through unmodified from the Authorization Request to the ID Token.
	      If present in the <a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a>,
	      clients MUST verify that
              the <tt>nonce</tt> Claim value is equal to
              the value of the <tt>nonce</tt>
              parameter sent in the Authorization Request.
	      If present in the Authorization Request, Authorization Servers
	      MUST include a <tt>nonce</tt> Claim in the
	      <a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a> with the Claim value
	      being the nonce value sent in the Authorization Request.
	      Use of the nonce is REQUIRED when using the implicit flow
	      and OPTIONAL when using the code flow.
</dd>
<dt>auth_time</dt>
<dd>OPTIONAL. If the 
                  <a class='info' href='#req.obj.id_token'>id_token<span> (</span><span class='info'>&quot;id_token&quot; member</span><span>)</span></a> member of the 
                  <a class='info' href='#OpenID_Request_Object'>OpenID Request Object<span> (</span><span class='info'>OpenID Request Object</span><span>)</span></a> 
                  contains the Claim request 
                  <tt>auth_time</tt>,
		  then this Claim is REQUIRED. The Claim Value
                  is the number of seconds from 1970-01-01T0:0:0Z as
                  measured in UTC until the date/time that the End-User
                  authentication occurred. (The <tt>auth_time</tt>
		  Claim semantically
                  corresponds to the OpenID 2.0
                  <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider             Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] 
                  <tt>auth_time</tt> response
                  parameter.)
</dd>
<dt>at_hash</dt>
<dd>OPTIONAL. 
              If the ID Token is issued with an <tt>access_token</tt>
	      in an implicit flow, this is REQUIRED.
              The value is produced by base64url encoding the left-most half of the hash 
              created by hashing the <tt>access_token</tt> 
              with the SHA-2 family hash algorithm
              of the same length as the hash used in the <tt>alg</tt>
              parameter of the <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] header.
	      For instance, if the <tt>alg</tt> is
              <tt>HS256</tt>, hash <tt>access_token</tt>
	      with SHA-256, then take the left-most 128 bits and base64url encode them.
</dd>
<dt>c_hash</dt>
<dd>OPTIONAL. 
              If the ID Token is issued with a <tt>code</tt>
	      in an implicit flow, this is REQUIRED.
              The value is produced by base64url encoding the left-most half of the hash 
              created by hashing the <tt>code</tt> 
              with the SHA-2 family hash algorithm
              of the same length as the hash used in the <tt>alg</tt>
              parameter of the JWS header. For instance, if the <tt>alg</tt> is
              <tt>HS256</tt>, hash <tt>code</tt>
	      with SHA-256, then take the left-most 128 bits and base64url encode them.
</dd>
</dl></blockquote>

<p>ID Tokens MUST be signed using <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] and OPTIONALLY both signed and
          encrypted using <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] and <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE] respectively, thereby providing
          <a class='info' href='#signing_order'>authentication, integrity,
	  non-repudiation, and optionally, confidentiality<span> (</span><span class='info'>Signing and Encryption order</span><span>)</span></a>.
</p>
<p>
            Clients MUST directly validate the ID Token per 
            <a class='info' href='#id.token.verification'>ID Token Verification<span> (</span><span class='info'>ID Token Verification</span><span>)</span></a>. 
          
</p>
<a name="auth_req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
Authorization Request</h3>

<p>
            An Authorization Request is a message sent from an RP 
            to the OP's Authorization Endpoint. 
            It is an extended <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0] 
            Authorization Request. 
            Section 4.1.1 and 4.2.1 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0] 
            defines the OAuth 2.0 Authorization Request parameters. 
            In this specification, the values to the parameters are defined as follows. 
          
</p>
<p></p>
<blockquote class="text"><dl>
<dt>response_type</dt>
<dd>
	      This parameter controls the parameters returned in the response from the
	      Authorization Endpoint.
	    
</dd>
<dt></dt>
<dd>The OAuth 2.0 specification documents two response types:

	    
<blockquote class="text"><dl>
<dt>code</dt>
<dd> When supplied as the value for the
	      <tt>response_type</tt> parameter, a
	      successful response MUST include an Authorization Code as
	      defined in the OAuth 2.0 specification. Both successful
	      and error responses MUST be added as parameters to the
	      query component of the response.  All tokens are returned
	      from the Token Endpoint. Authorization Servers MUST support
	      this <tt>response_type</tt>.
</dd>
<dt>token</dt>
<dd> When supplied as the value for the
	      <tt>response_type</tt> parameter, a
	      successful response MUST include an Access Token as
	      defined in the OAuth 2.0 specification.  Both successful
	      and error responses MUST be fragment-encoded.  No ID Token
	      is provided to the Client.
</dd>
</dl></blockquote>
	    
</dd>
<dt></dt>
<dd>OpenID Connect supports these <a class='info' href='#OAuth.Responses'>additional response types<span> (</span><span class='info'>de Medeiros, B., Scurtescu, M., and P. Tarjan, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Responses] that have
	    been registered:
</dd>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt>id_token</dt>
<dd>When supplied as the value
	      for the <tt>response_type</tt>
	      parameter, a successful response MUST include an ID Token.
	      Both successful and
	      error responses SHOULD be fragment-encoded. Authorization
	      Servers SHOULD support this <tt>response_type</tt>.
</dd>
<dt>id_token token</dt>
<dd>When supplied as the value
	      for the <tt>response_type</tt>
	      parameter, a successful response MUST include both an
	      Access Token as well as an ID Token.  Both successful and
	      error responses SHOULD be fragment-encoded. Authorization
	      Servers MUST support this <tt>response_type</tt>.
</dd>
<dt>code token</dt>
<dd>When supplied as the value for
	      the <tt>response_type</tt> parameter, a
	      successful response MUST include both an Access Token and
	      an Authorization Code as defined in the OAuth 2.0
	      specification. Both successful and error responses SHOULD
	      be fragment-encoded.
</dd>
<dt>code id_token</dt>
<dd>When supplied as the value for
	      the <tt>response_type</tt> parameter, a
	      successful response MUST include both an Authorization
	      Code as well as an ID Token.  Both successful and error
	      responses SHOULD be fragment-encoded.
</dd>
<dt>code id_token token</dt>
<dd>When supplied as the
	      value for the <tt>response_type</tt>
	      parameter, a successful response MUST include an
	      Authorization Code, an ID Token, and an Access Token.
	      Both successful and error responses SHOULD be
	      fragment-encoded.
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>The Authorization Server MUST support all three of the <tt>code</tt>, <tt>id_token</tt>, and <tt>id_token token</tt> values for <tt>response_type</tt>.
</dd>
<dt></dt>
<dd>The Client may request any OAuth 2.0 registered response
	    type supported by the Authorization Server.
</dd>
<dt>scope</dt>
<dd>A space delimited, case sensitive list of
	    ASCII string values. The values specify an additive list of
	    voluntary Claims that are returned from the UserInfo Endpoint.
	    The following scope values are defined:

	    
<blockquote class="text"><dl>
<dt>openid</dt>
<dd>REQUIRED. Informs the Authorization
	      Server that the Client is making an OpenID Connect request. If the
	      <tt>openid</tt> scope value is not present,
	      the request MUST NOT be treated as an OpenID Connect request.
	      This scope value requests access to the <tt>user_id</tt>
	      Claim at the UserInfo Endpoint.
</dd>
<dt>profile</dt>
<dd>OPTIONAL. This scope value
	      requests that access to the End-User's default <a class='info' href='#ClaimTable'>profile Claims<span> (</span><span class='info'>Reserved Member Definitions</span><span>)</span></a> at the
	      UserInfo Endpoint be granted by the issued Access
	      Token.  These claims are:
	      <tt>name</tt>,
	      <tt>family_name</tt>,
	      <tt>given_name</tt>,
	      <tt>middle_name</tt>,
	      <tt>nickname</tt>,
	      <tt>preferred_username</tt>,	      
	      <tt>profile</tt>,
	      <tt>picture</tt>,
	      <tt>website</tt>,
	      <tt>gender</tt>,
	      <tt>birthday</tt>,
	      <tt>zoneinfo</tt>,
	      <tt>locale</tt>, and
	      <tt>updated_time</tt>.
</dd>
<dt>email</dt>
<dd>OPTIONAL. This scope value requests that access to
	      the <tt>email</tt> and 
	      <tt>email_verified</tt> Claims at the UserInfo
	      Endpoint be granted by the issued Access Token.
</dd>
<dt>address</dt>
<dd>OPTIONAL. This scope value requests that access to
	      <tt>address</tt> Claim at the
	      UserInfo Endpoint be granted by the issued Access Token.
</dd>
<dt>phone</dt>
<dd>OPTIONAL. This scope value requests that access to 
	      the <tt>phone_number</tt> Claim at the 
	      UserInfo Endpoint be granted by the issued Access Token.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>

<p>Other REQUIRED OAuth 2.0 parameters in the request include:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>client_id</dt>
<dd>The OAuth 2.0 Client Identifier.
</dd>
<dt>redirect_uri</dt>
<dd>A redirection URI where the response
              will be sent.
</dd>
</dl></blockquote>

<p>The request MAY contain the following OAuth 2.0 parameters:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>state</dt>
<dd>RECOMMENDED.  An opaque value used
              to maintain state between the request and the callback;
              it can serve as a protection against XSRF attacks, among
	      other uses.
</dd>
</dl></blockquote>

<p>The following extension parameters are also defined:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>nonce</dt>
<dd>A random, unique string value used
              to mitigate replay attacks.
	      Use of the nonce is REQUIRED when using the implicit flow
	      and OPTIONAL when using the code flow.
</dd>
<dt>display</dt>
<dd>OPTIONAL. An ASCII string value that specifies
              how the Authorization Server displays the authentication and
              consent user interface pages to the End-User.
              
<blockquote class="text"><dl>
<dt>page</dt>
<dd>The Authorization Server SHOULD display
              authentication and consent UI consistent with a full user-agent page
              view. If the display parameter is not specified this is the
              default display mode.
</dd>
<dt>popup</dt>
<dd>The Authorization Server SHOULD display
              authentication and consent UI consistent with a popup user-agent
              window. The popup user-agent window SHOULD be 450 pixels wide
              and 500 pixels tall.
</dd>
<dt>touch</dt>
<dd>The Authorization Server SHOULD display
              authentication and consent UI consistent with a device that
              leverages a touch interface. The Authorization Server MAY attempt
              to detect the touch device and further customize the interface.
</dd>
<dt>wap</dt>
<dd>The Authorization Server SHOULD display
              authentication and consent UI consistent with a "feature phone"
              type display.
</dd>
</dl></blockquote>
</dd>
<dt>prompt</dt>
<dd>OPTIONAL. A space delimited, case sensitive
              list of ASCII string values that specifies whether the Authorization
              Server prompts the End-User for reauthentication and consent. The
              possible values are:
	      
<blockquote class="text"><dl>
<dt>none</dt>
<dd>The Authorization Server
                MUST NOT display any authentication or consent
                user interface pages. An error is returned if the End-User 
                is not already authenticated or the Client does not have 
                pre-configured consent for the requested
                <tt>scopes</tt>. This can be used as a
                method to check for existing authentication and/or consent.
</dd>
<dt>login</dt>
<dd>The Authorization Server MUST prompt the
                  End-User for reauthentication.
</dd>
<dt>consent</dt>
<dd>The Authorization Server MUST prompt
                  the End-User for consent before returning information to the
                  Client.
</dd>
<dt>select_account</dt>
<dd>The Authorization Server MUST
                  prompt the End-User to select a user account.  This allows 
                  a user who has multiple accounts at the Authorization Server
                  to select amongst the multiple accounts that they may have 
                  current sessions for.
</dd>
</dl></blockquote>

		The <tt>prompt</tt> parameter
                can be used by the Client to make sure that the End-User is
                still present for the current session or to bring attention to the
                request. If this parameter contains <tt>none</tt>
		with any other value, an
                error is returned.
</dd>
<dt>request</dt>
<dd>OPTIONAL. An
	      <a class='info' href='#OpenID_Request_Object'>OpenID Request Object<span> (</span><span class='info'>OpenID Request Object</span><span>)</span></a> value.
</dd>
<dt>request_uri</dt>
<dd>OPTIONAL. An URL that points to an
              OpenID Request Object. This is used to pass an OpenID Request
              Object by reference.
</dd>
<dt>id_token</dt>
<dd>OPTIONAL. An <a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a>
              passed to the Authorization server as a hint about the user's current or past
              authenticated session with the client. This SHOULD be present if 
              <tt>prompt=none</tt> is sent.
</dd>
</dl></blockquote>

<a name="OpenID_Request_Object"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2.1"></a><h3>2.1.2.1.&nbsp;
OpenID Request Object</h3>

<p>The OpenID Request Object is used to provide OpenID request
            parameters that MAY differ from the default ones. Implementing
            support for the OpenID Request Object is OPTIONAL. Supporting it
            is necessary for implementations that need to request or provide
            sets of Claims other than the default <a class='info' href='#userinfo_ep'>UserInfo<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a>, and ID Token Claim sets.
</p>
<p>The OpenID Request Object is a
	    <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] signed base64url encoded JSON object
            that is passed as the value of the "<tt>request</tt>"
            parameter in the Authorization Request.
	    The OpenID Request Object MAY also be encrypted using
	    <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE]
	    after signing, with nesting performed in the same manner as
	    specified for JWTs <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a>.
	    The OpenID Request Object
            MAY alternatively be sent by reference using 
            <tt>request_uri</tt> parameter. 
            Parameters that affect the
            information returned from the UserInfo Endpoint are in the "<tt>userinfo</tt>" member. Parameters that affect the
            information returned in the ID Token
            are in the "<tt>id_token</tt>" member.
            
</p>
<p>
	      Authorization Request parameters that are included in
	      the OAuth 2.0 Authorization Request MAY also be included
	      in the OpenID Request Object (so that they can be part
	      of the signed request).  All parameter values that are
	      present both in the OAuth 2.0 Authorization Request
	      and in the OpenID Request Object MUST exactly match.
	    
</p>
<p>
	      Authorization Request parameters that are OPTIONAL in
	      the OAuth 2.0 specification MAY be included in the
	      OpenID Request Object without also passing them as
	      OAuth 2.0 Authorization Request parameters, with one
	      exception:  The <tt>scope</tt>
	      parameter MUST always be present in OAuth 2.0
	      Authorization Request parameters (so that the
	      OAuth 2.0 implementation has access to the
	      <tt>openid</tt> scope value).
	      However, the <tt>request</tt> and
	      <tt>request_uri</tt> parameters
	      MUST NOT be included in the OpenID Request Object.
	    
</p>
<p>The OpenID Request Object 
            MAY contain other members that are not
            defined by this specification.
	    With only one exception, OpenID Request Object members
	    MUST be understood by both parties; that exception is that
	    OpenID Providers MAY ignore requests for Claims they cannot
	    provide or do not understand; however, Relying Parties
	    MAY also consider it an error condition if all requested
	    required Claims are not provided.
</p>
<p>The OpenID Request Object MAY be signed or unsigned (plaintext).
	    When it is plaintext, this is indicated by use of the
	    <tt>none</tt> algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
	    in the JWS header.  If signed, the OpenID Request Object
            SHOULD contain the Claims
	    <tt>iss</tt> (issuer)
            and <tt>aud</tt> (audience) as members,
	    with their semantics being the same as defined in the
	    <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] specification.
	    
</p>
<p>The OpenID Request Object members defined by this
            specification are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>userinfo</dt>
<dd>OPTIONAL. (UserInfo request): Requests
                affecting the values to be returned from the UserInfo
                Endpoint. If not present, the UserInfo Endpoint behaves in the
                default manner.
</dd>
<dt>id_token</dt>
<dd>OPTIONAL. (ID Token request): Requests
                affecting the values to be to be returned in the ID Token. 
                If not present, the default ID Token contents are used. 
                If present, these parameters are used
                to request additional Claims incremental to the <a class='info' href='#id_token'>default Claims of the ID Token.<span> (</span><span class='info'>ID Token</span><span>)</span></a>
</dd>
</dl></blockquote>
<p><p>An example OpenID Request Object body before
		base64url encoding and JWS signing is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "response_type": "code id_token",
 "client_id": "s6BhdRkqt3",
 "redirect_uri": "https://client.example.org/cb",
 "scope": "openid profile",
 "state": "af0ifjsldkj",
 "userinfo":
   {
     "claims":
       {
         "name": {"essential": true},
         "nickname": null,
         "email": {"essential": true},
         "email_verified": {"essential": true},
         "picture": null
       }
   },
 "id_token":
   {
     "claims":
       {
        "auth_time": {"essential": true},
        "acr": { "values":["2"] }
       },
     "max_age": 86400
   }
}</pre></div>

<a name="req.obj.userinfo"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2.1.1"></a><h3>2.1.2.1.1.&nbsp;
&quot;userinfo&quot; member</h3>

<p>The structure of the <tt>userinfo</tt>
	      (UserInfo Request) member is
              a JSON object that MAY contain the following members:
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>claims</dt>
<dd>
                    OPTIONAL. (Requested Claims): 
                    A JSON object containing a set of individual Claims 
                    being requested from the UserInfo Endpoint in 
                    addition to those requested by the 
                    <tt>scope</tt> values used.  
                    If not present, only the UserInfo Claims held by the OP 
                    that are requested by the 
                    <tt>scope</tt> values used are returned. 
                    For details about this claim, refer to 
                    <a class='info' href='#claims_member'>&quot;claims&quot; member in &quot;userinfo&quot; and &quot;id_token&quot; section.<span> (</span><span class='info'>&quot;claims&quot; member with &quot;userinfo&quot; and &quot;id_token&quot; members</span><span>)</span></a>
                  
</dd>
<dt>preferred_locales</dt>
<dd>OPTIONAL.  A list of preferred 
                  languages and scripts for the entire Claims request, 
                  represented as a JSON array of <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] language tag values,
		  ordered by preference.
</dd>
</dl></blockquote><p>
                
</p>
<p>All members of the <tt>userinfo</tt>
		 object are OPTIONAL.
              Other members MAY be present and if so, SHOULD understood by
              both parties.
</p>
<a name="req.obj.id_token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2.1.2"></a><h3>2.1.2.1.2.&nbsp;
&quot;id_token&quot; member</h3>

<p>The structure and function of the
	      <tt>id_token</tt> (ID Token
              request) member of the OpenID Request Object is similar to that
              of the <tt>userinfo</tt> member.
	      It MAY include the OPTIONAL <tt>claims</tt> and
              <tt>preferred_locales</tt> members.
	      The structure of these members is the same as
              that for the <tt>userinfo</tt> member.
	      If the <tt>claims</tt> member is
              present in the <tt>id_token</tt> object,
	      the Claims requested within it augment the Claim set that
	      would otherwise be returned in the ID Token.
</p>
<p>Following Claims, in addition to the claims described in 
                <a class='info' href='#claims_member'>&quot;claims&quot; member in &quot;userinfo&quot; and &quot;id_token&quot; section.<span> (</span><span class='info'>&quot;claims&quot; member with &quot;userinfo&quot; and &quot;id_token&quot; members</span><span>)</span></a>, 
                MAY be requested in the ID Token by specifying it in 
                the <tt>claims</tt> member:
              
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>user_id</dt>
<dd>OPTIONAL. (User Identifier): 
                    The User Identifier for which an ID Token is being requested.
                    If the specified user is not currently authenticated to the Authorization 
                    Server, they may be prompted for authenticated, unless the 
                    <tt>prompt</tt> parameter in the Authorization Request 
                    is set to <tt>none</tt>. 
                    The Claim Value in the request is an object containing the single element
                    <tt>value</tt>.  
                    <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> "user_id": {"value":"248289761001"}</pre></div>
                  
</dd>
<dt>auth_time</dt>
<dd>OPTIONAL. (authenticated at):
                    Requests that the <tt>auth_time</tt> 
                    Claim be present in the 
                    <a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a> response.
                    The Claim Value in the request is <tt>null</tt>.  
                  
</dd>
<dt>acr</dt>
<dd>OPTIONAL. 
                  (Authentication Context Class Reference): 
                  Requests the desired 
                  Authentication Context Class References. 
                  The element <tt>values</tt> is an ordered array of strings 
                  representing acceptable Authentication Context Class Reference 
                  values appearing in order of preference.
                  <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre> "acr": {"values":["2","http://id.incommon.org/assurance/bronze"]}</pre></div>
                  
</dd>
</dl></blockquote><p>In addition to the <tt>claims</tt>
		member, these additional members are defined within the
		<tt>id_token</tt> member of the OpenID
              Request Object:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>max_age</dt>
<dd>OPTIONAL. (max authentication age):
                  Specifies that the End-User must be actively authenticated if
                  any present authentication is older than the specified
                  number of seconds. (The <tt>max_age</tt> request parameter
                  corresponds to the OpenID 2.0
                  <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider             Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] <tt>max_auth_age</tt>
                  request parameter.)
</dd>
</dl></blockquote><p>It is anticipated that additional 
                <tt>id_token</tt> parameters
              MAY be defined to request that additional properties hold for
              the authentication - for instance, that certain authentication
              policies be applied (in the same spirit of the OpenID 2.0
              <a class='info' href='#OpenID.PAPE'>PAPE<span> (</span><span class='info'>Recordon, D., Jones, M., Bufu, J., Ed., Daugherty, J., Ed., and N. Sakimura, &ldquo;OpenID Provider             Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008.</span><span>)</span></a> [OpenID.PAPE] 
              <tt>auth_policies</tt> values),
              or that the authentication
              conform to the policies defined by a specified trust framework.
              These parameters MAY be defined by extension specifications.
</p>
<p>All members of the <tt>id_token</tt>
	      object are OPTIONAL. Other
              members MAY be present and if so, SHOULD be understood by both
              parties.
</p>
<a name="claims_member"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2.1.3"></a><h3>2.1.2.1.3.&nbsp;
&quot;claims&quot; member with &quot;userinfo&quot; and &quot;id_token&quot; members</h3>

<p>
                  The <tt>claims</tt> 
                  member is a JSON object with a member for
                  each requested Claim. The member names are the requested 
                  Claim names. Each Claim MAY either be an essential claim or voluntary claim. 
                  The default is voluntary. 
                
</p>
<p>
                  By requesting Claims as <tt>essential</tt>,
                  the client indicates to the user 
                  that releasing these claims will ensure a smooth authorization 
                  for the specific task requested by the user.
                  Note that even if the claims are not available because 
                  the user did not authorize their release or they are not present,
                  the Authorization Server MUST NOT generate an error when
		  essential claims are not returned.
                
</p>
<p>
                  The Client may request additional Claims on voluntary basis
                  that it requires to perform other tasks offered to the user.
                
</p>
<p>
                The member values MAY be either:
</p>
<p>
                  </p>
<blockquote class="text"><dl>
<dt>null</dt>
<dd>
                      This indicates that this Claim is being
                      requested in the default manner. In particular, this is a 
                      voluntary Claim. 
                    
</dd>
<dt>A JSON Object</dt>
<dd>
                      This is used to provide additional information about the Claim being 
                      requested. This specification defines the following member: 
                    
</dd>
<dt></dt>
<dd>
                      
<blockquote class="text"><dl>
<dt>essential</dt>
<dd>OPTIONAL. If the value is set to true, 
                          this indicates that the claim being requested is an essential claim. 
                          If the value is set to false, it indicates that 
                          it is a voluntary claim. The default is false. 
                        
</dd>
</dl></blockquote>
                    
</dd>
<dt></dt>
<dd>
                      Other members MAY be defined to provide additional 
                      information about the requested Claim.
                    
</dd>
</dl></blockquote><p>
                
</p>
<p>
                  The Claims MAY be represented in multiple languages and scripts. 
                  To specify languages and scripts for the Claim request, 
                  <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] language tags delimited by a "#" 
                  MUST be added to each requested Claim Name for which a particular 
                  language and script is requested. For example, the Claim 
                  <tt>family_name#ja-Kana-JP</tt> is used for 
                  expressing Family Name in Katakana in Japanese, which is commonly used to 
                  index and represent the phonetics of the Kanji representation of the same 
                  value represented as <tt>family_name#ja-Hani-JP</tt>.
                
</p>
<p>All members of the <tt>claims</tt> object are OPTIONAL.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.3"></a><h3>2.1.3.&nbsp;
Authorization Response</h3>

<p>An Authorization Response is a message returned from the 
            OP's Authorization Endpoint in response to the Authorization Request 
            by the RP. 
</p>
<p>When the <tt>response_type</tt> in the request
          is <tt>token</tt>, the Authorization
          Response MUST return the parameters defined in Section 4.2.2 of
          <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0]. This specification only
          supports <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer]. The
          OAuth 2.0 response parameter "<tt>token_type</tt>"
          MUST be set to "<tt>Bearer</tt>".
</p>
<p>When the <tt>response_type</tt> in the request
          is <tt>code</tt>, the Authorization
          Response MUST return the parameters defined in Section 4.1.2 of
          <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<p>When the <tt>response_type</tt>
          includes other values, they must be returned as defined by
          their registration.  The <tt>id_token</tt> return type is defined in
          <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type
          Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Scurtescu, M., and P. Tarjan, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Responses].
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.4"></a><h3>2.1.4.&nbsp;
Authorization Error Response</h3>

<p>If the End-User denies the access request or if the request
          fails, the OP (Authorization Server) informs the RP (Client) by returning
          parameters defined in sections 4.1.2.1 and 4.2.2.1 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<p>In addition to the error codes defined in Sections 4.1.2.1 and 4.2.2.1 of
	  <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0], this specification
	  defines the following error codes:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>invalid_redirect_uri</dt>
<dd>The 
	      <tt>redirect_uri</tt> in
	      the Authorization Request does not match any of the Client's 
	      pre-registered <tt>redirect_uris</tt>.
</dd>
<dt>interaction_required</dt>
<dd>The Authorization Server
	      requires End-User interaction of some form to proceed.
	      This error MAY be returned when the 
	      <tt>prompt</tt> parameter in the
	      Authorization Request is set to <tt>none</tt>
	      to request that the
	      Authorization Server should not display any user interfaces to
	      the End-User, but the Authorization Request cannot be completed
	      without displaying a user interface for End-User interaction.
</dd>
<dt>login_required</dt>
<dd>The Authorization Server requires
	      End-User authentication. This error MAY be returned when the 
	      <tt>prompt</tt> parameter in the
	      Authorization Request is set to
	      <tt>none</tt> to request that the
	      Authorization Server should not display any user interfaces to
	      the End-User, but the Authorization Request cannot be completed
	      without displaying a user interface for user authentication.
	      
</dd>
<dt>session_selection_required</dt>
<dd>The End-User is required
	      to select a session at the Authorization Server. The End-User MAY
	      be authenticated at the Authorization Server with different
	      associated accounts, but the End-User did not select a session.
	      This error MAY be returned 
	      when the <tt>prompt</tt> parameter in the
	      Authorization Request is set to <tt>none</tt>
	      to request that the
	      Authorization Server should not display any user interfaces to
	      the End-User, but the Authorization Request cannot be completed
	      without displaying a user interface to prompt for a session to
	      use.
</dd>
<dt>consent_required</dt>
<dd>The Authorization Server
	      requires End-User consent. This error MAY be returned when the 
	      <tt>prompt</tt> parameter in the
	      Authorization Request is set to <tt>none</tt>
	      to request that the
	      Authorization Server should not display any user interfaces to
	      the End-User, but the Authorization Request cannot be completed
	      without displaying a user interface for End-User consent.
</dd>
<dt>invalid_request_uri</dt>
<dd>The 
	      <tt>request_uri</tt> in
	      the Authorization Request returns an error or invalid data.
</dd>
<dt>invalid_openid_request_object</dt>
<dd>The 
	      <tt>request</tt> parameter contains an invalid 
	      OpenID Request Object.
</dd>
</dl></blockquote>

<p>Errors are returned as defined by the registered OAuth
	  2.0 <tt>response_type</tt>.
</p>
<a name="token_ep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Token Endpoint</h3>

<p>The RP (Client) sends an Access Token Request to the Token 
        Endpoint to obtain Access Token Response,  
        which MAY include Access Token, <a class='info' href='#token_lifetime'>Refresh Token<span> (</span><span class='info'>Refresh Token, and Access Token Lifetime</span><span>)</span></a>,
	<a class='info' href='#id_token'>ID Token<span> (</span><span class='info'>ID Token</span><span>)</span></a>, and other variables.
</p>
<a name="client_authentication"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Client Authentication</h3>

<p>During Client Registration, the RP (Client) MAY register an authentication method.
          If no method is registered, the default method of <tt>client_secret_basic</tt> MUST be used.
</p>
<p>The Supported options are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>client_secret_basic</dt>
<dd> 
          Clients that have received a <tt>client_secret</tt> value
          from the Authorization Server, authenticate with the Authorization Server
          in accordance with Section 3.2.1 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0] using HTTP Basic authentication scheme. 
</dd>
<dt>client_secret_post</dt>
<dd>
          Clients that have received a <tt>client_secret</tt> value 
          from the Authorization Server, authenticate with the Authorization Server
          in accordance with Section 3.2.1 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0] by including the client credentials in the request body. 
</dd>
<dt>client_secret_jwt</dt>
<dd> 
          Clients that have received a <tt>client_secret</tt> value 
          from the Authorization Server, create a JWT using an
	      HMAC SHA algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>, such as HMAC SHA-256. 
	      The HMAC (Hash-based Message Authentication Code) is calculated using the
	      value of <tt>client_secret</tt> as the shared key.
	   
          The Client Authenticates in accordance with Section 2.2 of <a class='info' href='#OAuth.JWT'>OAuth JWT Bearer Token Profiles<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.JWT] and 
          <a class='info' href='#OAuth.Assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Assertions]. 
          The JWT MUST contain the Claims:
</dd>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt>iss</dt>
<dd>REQUIRED. The <tt>iss</tt> (issuer) Claim.
	  This MUST contain the <tt>client_id</tt> of the OAuth Client.
</dd>
<dt>prn</dt>
<dd>REQUIRED. The <tt>prn</tt> (principal) Claim.
	  This MUST contain the <tt>client_id</tt> of the OAuth Client.
</dd>
<dt>aud</dt>
<dd>REQUIRED. The <tt>aud</tt> (audience) Claim.
	   A value that identifies the
      Authorization Server as the intended audience.  The Authorization
      Server MUST verify that it is an intended audience for the
      token.  The Audience SHOULD be the URL of the Authorization
      Server's Token Endpoint.
</dd>
<dt>jti</dt>
<dd>REQUIRED. The  <tt>jti</tt> (JWT ID) Claim.
	   A unique identifier for the token.  The
      JWT ID MAY be used by implementations requiring message
      de-duplication for one-time use assertions. 
</dd>
<dt>exp</dt>
<dd>REQUIRED.  The <tt>exp</tt> (expiration)
	   Claim that limits the time window during which the JWT can be used.
</dd>
<dt>iat</dt>
<dd>OPTIONAL.  The <tt>iat</tt> (issued at)
	    Claim that identifies the time at which the JWT was issued. 
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>The authentication token MUST be sent as the value of the <tt>client_assertion</tt> parameter.
</dd>
<dt></dt>
<dd>The value of the <tt>client_assertion_type</tt> parameter
	  MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer".
</dd>
<dt>private_key_jwt</dt>
<dd>
          Clients that have registered a public key sign a JWT using 
          the RSA algorithm if a RSA key was registered 
          or the ECDSA algorithm if an Elliptic Curve key was registered
	  (see <a class='info' href='#JWA'>JWA<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWA] for the algorithm identifiers).
          The Client Authenticates in accordance with Section 2.2 of <a class='info' href='#OAuth.JWT'>OAuth JWT Bearer Token Profiles<span> (</span><span class='info'>Jones, M., Campbell, B., and C. Mortimore, &ldquo;JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.JWT] and 
          <a class='info' href='#OAuth.Assertions'>OAuth 2.0 Assertion Profile<span> (</span><span class='info'>Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;OAuth 2.0 Assertion Profile,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Assertions].
          The JWT MUST contain the Claims:
</dd>
<dt></dt>
<dd>
<blockquote class="text"><dl>
<dt>iss</dt>
<dd>REQUIRED. The <tt>iss</tt> (issuer) Claim.
		    This MUST contain the <tt>client_id</tt> of the OAuth Client.
</dd>
<dt>prn</dt>
<dd>REQUIRED. The <tt>prn</tt> (principal) Claim.
	  This MUST contain the <tt>client_id</tt> of the OAuth Client.
</dd>
<dt>aud</dt>
<dd>REQUIRED. The <tt>aud</tt> (audience) Claim.
	  A value that identifies the
      Authorization Server as the intended audience.  The Authorization
      Server MUST verify that it is an intended audience for the
      assertion.  The Audience SHOULD be the URL of the Authorization
      Server's Token Endpoint.
</dd>
<dt>jti</dt>
<dd>REQUIRED. The <tt>jti</tt> (JWT ID) Claim.
	   A unique identifier for the token.  The
      token ID MAY be used by implementations requiring message
      de-duplication for one-time use assertions. 
</dd>
<dt>exp</dt>
<dd>REQUIRED.  The <tt>exp</tt> (expiration)
	   Claim that limits the time window during which the JWT can be used.
</dd>
<dt>iat</dt>
<dd>OPTIONAL.  The <tt>iat</tt> (issued at)
	    Claim that identifies the time at which the JWT was issued. 
</dd>
</dl></blockquote>
</dd>
<dt></dt>
<dd>The authentication token MUST be sent as the value of the <tt>client_assertion</tt> parameter.
</dd>
<dt></dt>
<dd>The value of the <tt>client_assertion_type</tt> parameter
	  MUST be "urn:ietf:params:oauth:client-assertion-type:jwt-bearer".

        
<p>
            For example
	    (with line wraps for display purposes only):
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=i1WsRn1uB1&amp;
client_id=s6BhdRkqt3&amp;
client_assertion_type=
    urn%3Aietf%3Aparams%3Aoauth%3Aclient-assertion-type%3Ajwt-bearer&amp;
client_assertion=PHNhbWxwOl...[omitted for brevity]...ZT
</pre></div>
        
</dd>
</dl></blockquote><p>
          
</p>
<a name="access_token_request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Access Token Request</h3>

<p>The Client obtains an Access Token by authenticating with the
          Authorization Server and presenting its access grant (in the form of
          an Authorization Code, or Refresh Token).
</p>
<p>In addition to the Client authentication parameters,
          if this is a Refresh Token Request, the Client MUST send the additional parameters 
          specified in Section 6 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
          Otherwise the Client
          MUST send the request parameter for the Access Token Endpoint as
          specified in Section 4.1.3 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<p>
</p>
<a name="access_token_response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Access Token Response</h3>

<p>After receiving and verifying a valid and authorized Access Token
          Request from the Client, the Authorization Server returns a successful
          response that includes an Access Token and an ID Token.  The
          parameters in the successful response are defined in Section 4.1.4
          of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<p>This specification further constrains that only <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer] are issued at the
          Token Endpoint. The OAuth 2.0 response parameter "<tt>token_type</tt>" MUST be set to "<tt>Bearer</tt>".
</p>
<p>In addition to the OAuth 2.0 response parameters, the following
          parameters MUST be included in the response if the 
          <tt>grant_type</tt> is 
          <tt>authorization_code</tt>
          and the Authorization Request <tt>scope</tt> parameter 
          contained <tt>openid</tt>:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>id_token</dt>
<dd>The ID Token value associated with the
            authentication session.
</dd>
</dl></blockquote>

<p>Note that <tt>id_token</tt> MUST NOT be 
          returned if the <tt>grant_type</tt> is not 
          <tt>authorization_code</tt>. 
</p>
<p>Following is a non-normative example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "access_token": "SlAV32hkKG",
 "token_type": "Bearer",
 "refresh_token": "8xLOxBtZp8",
 "expires_in": 3600,
 "id_token": "eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso"
}</pre></div>
<p>As in the <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0], Clients
          SHOULD ignore unrecognized response parameters.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.4"></a><h3>2.2.4.&nbsp;
Token Error Response</h3>

<p>If the token request is invalid or unauthorized, the
          Authorization Server constructs the error response. The parameters
          of the Token Error Response are defined as in Section 5.2 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<a name="userinfo_ep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
UserInfo Endpoint</h3>

<p>The UserInfo Endpoint is a Protected Resource that
        returns Claims about the authenticated End-User. Claims are
        represented by a JSON object that contains a collection of
        name and value pairs for the Claims.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
UserInfo Request</h3>

<p>Clients MAY send requests with the following parameters to the
          UserInfo Endpoint to obtain further information about the End-User.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>access_token</dt>
<dd>REQUIRED. The Access Token obtained
            from an OpenID Connect Authorization Request. 
</dd>
<dt>schema</dt>
<dd>REQUIRED. The schema in which the
            data is to be returned. The only defined value is <tt>openid</tt>.
</dd>
<dt>id</dt>
<dd>This identifier is reserved. It MUST be
            ignored by the endpoint when the <tt>openid</tt> schema is used.
</dd>
</dl></blockquote>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
UserInfo Response</h3>

<p>If the requested schema is <tt>openid</tt>, the response MUST return a
          JSON object that contains the full set or a
          subset of the Claims that are defined below. Additional
          Claims (not specified below) MAY also be returned.
</p>
<p>
	    If a Claim is not returned, that Claim Name SHOULD be
	    omitted from the JSON object representing the Claims; it
	    SHOULD NOT be present with a null or empty string value.
	  
</p>
<p>The members MAY be represented in multiple languages and scripts.
          To specify the languages and scripts, <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] language tags MUST be added to each
          member names delimited by a <tt>#</tt>, e.g.,
          <tt>family_name#ja-Kana-JP</tt> for expressing
          Family Name in Katakana in Japanese, which is commonly used to index
          and represent the phonetics of the Kanji representation of the same
          represented as <tt>family_name#ja-Hani-JP</tt>.
</p><br /><hr class="insert" />
<a name="ClaimTable"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Member</th><th align="left">Type</th><th align="left">Description</th></tr>
<tr>
<td align="left">user_id</td>
<td align="left">string</td>
<td align="left">REQUIRED Identifier for the End-User at the Issuer.</td>
</tr>
<tr>
<td align="left">name</td>
<td align="left">string</td>
<td align="left">End-User's full name in displayable form including all name parts,
            ordered according to End-User's locale and preferences.</td>
</tr>
<tr>
<td align="left">given_name</td>
<td align="left">string</td>
<td align="left">Given name or first name of the End-User.</td>
</tr>
<tr>
<td align="left">family_name</td>
<td align="left">string</td>
<td align="left">Surname or last name of the End-User.</td>
</tr>
<tr>
<td align="left">middle_name</td>
<td align="left">string</td>
<td align="left">Middle name of the End-User.</td>
</tr>
<tr>
<td align="left">nickname</td>
<td align="left">string</td>
<td align="left">Casual name of the End-User that MAY or MAY not be the same as the
            <tt>given_name</tt>. For instance, a <tt>nickname</tt> value of <tt>Mike</tt>
            might be returned alongside a <tt>given_name</tt>
            value of <tt>Michael</tt>.</td>
</tr>
<tr>
<td align="left">preferred_username</td>
<td align="left">string</td>
<td align="left">Shorthand name that the End-User wishes to be referred to at the RP, such as
            <tt>janedoe</tt> or <tt>j.doe</tt>. 
            This value MAY be any valid JSON string including 
            special characters such as <tt>@</tt>, 
            <tt>/</tt>, or whitespace. This value MUST NOT
            be relied upon to be unique by the RP. 
            (See <a class='info' href='#claim.stability'>Section&nbsp;2.3.2.2<span> (</span><span class='info'>Claim Stability and Uniqueness</span><span>)</span></a>.)</td>
</tr>
<tr>
<td align="left">profile</td>
<td align="left">string</td>
<td align="left">URL of the End-User's profile page.</td>
</tr>
<tr>
<td align="left">picture</td>
<td align="left">string</td>
<td align="left">URL of the End-User's profile picture.</td>
</tr>
<tr>
<td align="left">website</td>
<td align="left">string</td>
<td align="left">URL of the End-User's web page or blog.</td>
</tr>
<tr>
<td align="left">email</td>
<td align="left">string</td>
<td align="left">The End-User's preferred e-mail address. 
            This value MUST NOT be relied upon to be unique by 
            the RP. (See <a class='info' href='#claim.stability'>Section&nbsp;2.3.2.2<span> (</span><span class='info'>Claim Stability and Uniqueness</span><span>)</span></a>.)</td>
</tr>
<tr>
<td align="left">email_verified</td>
<td align="left">boolean</td>
<td align="left">True if the End-User's e-mail address has been verified; otherwise
            false.</td>
</tr>
<tr>
<td align="left">gender</td>
<td align="left">string</td>
<td align="left">The End-User's gender: Values defined by this
	    specification are <tt>female</tt> and
	    <tt>male</tt>.  Other values MAY be used
	    when neither of the defined values are applicable.</td>
</tr>
<tr>
<td align="left">birthday</td>
<td align="left">string</td>
<td align="left">The End-User's birthday, represented as a date string in MM/DD/YYYY
            format. The year MAY be <tt>0000</tt>,
            indicating that it is omitted.</td>
</tr>
<tr>
<td align="left">zoneinfo</td>
<td align="left">string</td>
<td align="left">String from zoneinfo <a class='info' href='#zoneinfo'>[zoneinfo]<span> (</span><span class='info'>Public Domain, &ldquo;The tz database,&rdquo; June&nbsp;2011.</span><span>)</span></a> time zone
            database. For example, <tt>Europe/Paris</tt> or
            <tt>America/Los_Angeles</tt>.</td>
</tr>
<tr>
<td align="left">locale</td>
<td align="left">string</td>
<td align="left">The End-User's locale, represented as a
	    <a class='info' href='#RFC5646'>BCP47<span> (</span><span class='info'>Phillips, A. and M. Davis, &ldquo;Tags for Identifying Languages,&rdquo; September&nbsp;2009.</span><span>)</span></a> [RFC5646] language tag.
	    This is typically an <a class='info' href='#ISO639-1'>ISO 639-1 Alpha-2<span> (</span><span class='info'>International Organization for             Standardization, &ldquo;ISO 639-1:2002. Codes for the representation of names of           languages -- Part 1: Alpha-2 code,&rdquo; 2002.</span><span>)</span></a> [ISO639&#8209;1] language code in
            lowercase and an <a class='info' href='#ISO3166-1'>ISO 3166-1
            Alpha-2<span> (</span><span class='info'>International Organization for             Standardization, &ldquo;ISO 3166-1:1997. Codes for the representation of names of           countries and their subdivisions -- Part 1: Country codes,&rdquo; 1997.</span><span>)</span></a> [ISO3166&#8209;1] country code in uppercase, separated by a dash. For
            example, <tt>en-US</tt> or <tt>fr-CA</tt>.
            As a compatibility note, some implementations have used an
            underscore as the separator rather than a dash, for example,
            <tt>en_US</tt>; Implementations MAY choose to
            accept this locale syntax as well.</td>
</tr>
<tr>
<td align="left">phone_number</td>
<td align="left">string</td>
<td align="left">The End-User's preferred telephone number. <a class='info' href='#E.164'>E.164<span> (</span><span class='info'>International Telecommunication Union, &ldquo;E.164 : The international public telecommunication numbering plan,&rdquo; 2010.</span><span>)</span></a> [E.164] is RECOMMENDED as the format of this Claim. 
            For example, <tt>+1 (425)
            555-1212</tt> or <tt>+56 (2) 687 2400</tt>.</td>
</tr>
<tr>
<td align="left">address</td>
<td align="left">JSON object</td>
<td align="left">The End-User's preferred address. The value of the <tt>address</tt> member is a <a class='info' href='#RFC4627'>JSON<span> (</span><span class='info'>Crockford, D., &ldquo;The application/json Media Type for JavaScript Object Notation (JSON),&rdquo; July&nbsp;2006.</span><span>)</span></a> [RFC4627] structure containing some or all of
            the members defined in <a class='info' href='#address_claim'>Section&nbsp;2.3.2.1<span> (</span><span class='info'>Address Claim</span><span>)</span></a>. </td>
</tr>
<tr>
<td align="left">updated_time</td>
<td align="left">string</td>
<td align="left">Time the End-User's information was last updated, represented as a
            <a class='info' href='#RFC3339'>RFC 3339<span> (</span><span class='info'>Klyne, G., Ed. and C. Newman, &ldquo;Date and Time on the Internet: Timestamps,&rdquo; July&nbsp;2002.</span><span>)</span></a> [RFC3339] datetime. For example,
            <tt>2011-01-03T23:58:42+0000</tt>.</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Reserved Member Definitions&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>For privacy reasons, OpenID Providers MAY elect to not provide
          values for some schema elements as part of the
	  <tt>openid</tt> scope.
</p>
<p>The <tt>user_id</tt> Claim in the UserInfo Endpoint response MUST exactly match the 
          <tt>user_id</tt> Claim in the ID Token, before using additional UserInfo Endpoint Claims.
</p>
<p>The UserInfo Endpoint MUST return Claims in JSON format unless a
          different format was specified during <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration].
	      The UserInfo Endpoint MAY return Claims in
          JWT format, which can be signed and/or encrypted.
	      The UserInfo Endpoint MUST return a content-type header to indicate
          the format that is being returned. The following are accepted content
          types:
</p><table class="all" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Content-Type</th><th align="left">Format Returned</th></tr>
<tr>
<td align="left">application/json</td>
<td align="left">plain text JSON object</td>
</tr>
<tr>
<td align="left">application/jwt</td>
<td align="left">JSON Web Token (JWT)</td>
</tr>
</table>
<br clear="all" />

<p>The following is a non-normative example of such a
          response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "user_id": "248289761001",
 "name": "Jane Doe",
 "given_name": "Jane",
 "family_name": "Doe",
 "preferred_username": "j.doe",
 "email": "janedoe@example.com",
 "picture": "http://example.com/janedoe/me.jpg"
}</pre></div>
<a name="address_claim"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.1"></a><h3>2.3.2.1.&nbsp;
Address Claim</h3>

<p>
	      The components of a physical mailing address. 
	      Implementations MAY return only a subset of the
	      fields of an <tt>address</tt>, depending upon
	      the information available and the End-User's privacy 
	      preferences. For
	      example, the <tt>country</tt> and <tt>region</tt> might be returned without returning
	      more fine-grained address information.
	    
</p>
<p>
	      Implementations MAY return just the full address 
	      as a single string in the formatted sub-field, 
	      or they MAY return just the individual component 
	      fields using the other sub-fields, 
	      or they MAY return both. 
	      If both variants are returned, 
	      they SHOULD be describing the same address, 
	      with the formatted address indicating how the 
	      component fields should be combined.
	    
</p>
<p></p>
<blockquote class="text"><dl>
<dt>formatted</dt>
<dd>The full mailing address, 
		formatted for display or use with a mailing label. 
		This field MAY contain newlines. This is the 
		Primary Sub-Field for this field, 
		for the purposes of sorting and filtering.
</dd>
<dt>street_address</dt>
<dd>
		The full street address component, 
		which may include house number, street name, 
		PO BOX, and multi-line extended street 
		address information. This field MAY contain newlines.
</dd>
<dt>locality</dt>
<dd>The city or locality component.
</dd>
<dt>region</dt>
<dd>The state, province, 
		prefecture or region component.
</dd>
<dt>postal_code</dt>
<dd>The zip code or 
		postal code component.
</dd>
<dt>country</dt>
<dd>The country name component.
</dd>
</dl></blockquote><p>
	    
</p>
<a name="claim.stability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2.2"></a><h3>2.3.2.2.&nbsp;
Claim Stability and Uniqueness</h3>

<p>The <tt>user_id</tt> claim is the only claim that a client
	    can rely upon to be stable, since the <tt>user_id</tt>
	    claim MUST be locally unique and never reassigned within the Issuer
	    for a particular End-User, as described in <a class='info' href='#id_token'>Section&nbsp;2.1.1<span> (</span><span class='info'>ID Token</span><span>)</span></a>.
</p>
<p>Therefore, the only guaranteed unique identifier for a given End-User is a 
	    combination of the Issuer's identifier and the <tt>user_id</tt>
	    claim; other fields such as <tt>preferred_username</tt>
	    and <tt>email</tt> MUST NOT be used as unique identifiers 
	    for a given End-User.
</p>
<p>All other claims carry no such guarantees across different issuers in terms of
	    stability over time or uniqueness across users, and Issuers are permitted to
	    apply local restrictions and policies. For instance, an Issuer MAY re-use a 
	    given <tt>preferred_username</tt> or 
	    <tt>email</tt> address claim across different
            End-Users at different points in time, and the claimed 
            <tt>preferred_username</tt> or 
            <tt>email</tt> address for a given End-User MAY change 
            over time.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
UserInfo Error Response</h3>

<p>When an error condition occurs, the UserInfo Endpoint returns
          an Error Response. In addition to the error codes defined in Section 3.1 of
          <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer], this specification
          defines the following error codes:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>invalid_schema</dt>
<dd>The requested schema is invalid or
            unsupported.
</dd>
</dl></blockquote>

<a name="idtype"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
User Identifier Types</h3>

<p>Provider's Discovery documents SHOULD list their supported identifier types in the 
	<tt>user_id_types_supported</tt> element.
	If there is more than one type listed in the array, the Client MAY elect to
	provide its preferred identifier type using the
	<tt>user_id_type</tt> parameter during registration.
	The types supported by this specification are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>public</dt>
<dd> This provides the same <tt>user_id</tt> value to all Clients. It is the default if
	  the provider has no <tt>user_id_types_supported</tt> element in its discovery document.
</dd>
<dt>pairwise</dt>
<dd> This provides a different <tt>user_id</tt> value to each Client, to prevent
	  correlation of the user's activities by Clients without the user's permission.
</dd>
</dl></blockquote>

<a name="idtype.pairwise.alg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Pairwise Identifier Algorithm</h3>

<p>The OpenID Provider MUST calculate a unique
	  <tt>user_id</tt> value for each
	  Sector Identifier.  The user_id MUST NOT be reversible
	  by any party other than the OpenID Provider.
</p>
<p>Providers who use pairwise <tt>user_id</tt> values SHOULD 
	  support the <tt>sector_identifier_url</tt> in 
	  <a class='info' href='#OpenID.Registration'>Dynamic Client Registration<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration].
	  It provides a way for a group of websites under common administrative 
	  control to have consistent pairwise <tt>user_id</tt> 
	  values independent of the individual domain names.
	  It also provides a way for Clients to change 
	  <tt>redirect_uri</tt> domains without having to 
	  reregister all of their users.
</p>
<p>If the Client has not provided a value for
	  <tt>sector_identifier_url</tt> in 
	  <a class='info' href='#OpenID.Registration'>Dynamic Client Registration<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration],
	  the Sector Identifier
	  used for pairwise identifier calculation is the host component 
	  of the registered <tt>redirect_uri</tt>.
	  If there are multiple hostnames in the registered
	  <tt>redirect_uris</tt>, the Client MUST register a 
	  <tt>sector_identifier_url</tt>.
</p>
<p>When a <tt>sector_identifier_url</tt>
	  is provided, the host component of that URL is used as
	  the Sector Identifier for the pairwise identifier calculation.
	  The value of the <tt>sector_identifier_url</tt>
	  must be a HTTPS URL that points to
	  a JSON file containing an array of
	  <tt>redirect_uri</tt> values.
	  The values of the registered <tt>redirect_uris</tt>
	  must be included in the elements of the array,
	  or the registration MUST fail.
</p>
<p>A number of algorithms MAY be used by OpenID Providers to
	  calculate the pairwise identifier.  This specification
	  includes three examples.
</p>
<p>1.  The Sector Identifier can be concatenated with a local account ID and a salt 
	  value that is kept secret by the Provider. The concatenated string is then 
	  hashed by an appropriate algorithm.
</p>
<p>Calculate <tt>user_id</tt> = SHA-256 ( sector_identifier | local_account_id | salt ).
</p>
<p>2.  The Sector Identifier can be concatenated with a local account ID and a salt 
	  value that is kept secret by the Provider. The concatenated string is then 
	  encrypted by an appropriate algorithm.
</p>
<p>Calculate <tt>user_id</tt> = AES-128 ( sector_identifier | local_account_id | salt ).
</p>
<p>3.  The Issuer creates a Globally Unique Identifier (GUID) for the tuple of
	  Sector Identifier and local account ID.  This is stored in a table and 
	  the value looked up each time.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Claim Types</h3>

<p>The UserInfo Endpoint MAY return the
	following three types of Claims:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Normal Claims</dt>
<dd>Claims that are directly asserted by
	  the OpenID Provider.
</dd>
<dt>Aggregated Claims</dt>
<dd>Claims that are asserted by a
	  Claims Provider other than the OpenID Provider but are returned
	  by OpenID Provider.
</dd>
<dt>Distributed Claims</dt>
<dd>Claims that are asserted by a
	  Claims Provider other than the OpenID Provider but are returned
	  as references by the OpenID Provider.
</dd>
</dl></blockquote><p>The UserInfo endpoint MUST support normal Claims.
</p>
<p>Aggregated and Distributed Claims support is OPTIONAL.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.1"></a><h3>2.5.1.&nbsp;
Normal Claims</h3>

<p>Normal Claims are represented as members in a JSON object. The
	  Claim Name is the member name and the Claim Value is the member
	  value.
</p>
<p>The following is a non-normative normal Claims response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "name": "Jane Doe"
 "given_name": "Jane",
 "family_name": "Doe",
 "email": "janedoe@example.com",
 "picture": "http://example.com/janedoe/me.jpg"
}</pre></div>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5.2"></a><h3>2.5.2.&nbsp;
Aggregated and Distributed Claims</h3>

<p>Aggregated and distributed Claims are represented by
	  using special <tt>_claim_names</tt> and <tt>_claim_sources</tt> members
	  of the JSON object containing the Claims.
</p>
<p>
	    </p>
<blockquote class="text"><dl>
<dt>_claim_names</dt>
<dd>This value is a JSON object whose member
	      names are the Claim Names for the Aggregated and Distributed
	      Claims. The member values are references to the member names
	      in the <tt>_claim_sources</tt> member from which
	      the actual Claim Values can be retrieved.
</dd>
<dt>_claim_sources</dt>
<dd>This value is a JSON object whose
	      member names are referenced by the member values of the
	      <tt>_claim_names</tt> member. The member values
	      contain sets of Aggregated Claims or reference locations for
	      Distributed Claims. The member values can have one of the
	      following formats depending on whether it is providing
	      Aggregated or Distributed Claims:

	      
<blockquote class="text"><dl>
<dt>Aggregated Claims</dt>
<dd>A JSON object that MUST
		contain the <tt>JWT</tt> member whose value is a <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] that MUST contain all the Claims
		in the <tt>_claim_names</tt> object that references the
		corresponding <tt>_claim_sources</tt> member. Other members MAY
		be present if they are understood by both parties.

		
<blockquote class="text"><dl>
<dt>JWT</dt>
<dd>REQUIRED. JWT Value.
</dd>
</dl></blockquote>
		
</dd>
<dt>Distributed Claims</dt>
<dd>A JSON object that
		contains the following members and values:

		
<blockquote class="text"><dl>
<dt>endpoint</dt>
<dd>REQUIRED. The value is the
		  OAuth 2.0 resource endpoint from which the associated
		  Claim can be retrieved. The endpoint URL MUST return
		  the Claim as a JWT.
</dd>
<dt>access_token</dt>
<dd>OPTIONAL. Access Token
		  enabling retrieval of the Claims from the endpoint URL
		  by using the <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer]
		  scheme. Claims SHOULD be requested using
		  the Authorization Request header field and Claims
		  Sources MUST support this method. If the Access Token
		  is not available, Clients MAY need to retrieve the
		  Access Token out of band or use an a priori Access
		  Token that was negotiated between the Claim Source and
		  Client, or the Claim Source MAY reauthenticate the
		  End-User and/or reauthorize the Client.
</dd>
</dl></blockquote>
</dd>
</dl></blockquote>
	      Other members MAY be present, if understood by both
	      parties.
</dd>
</dl></blockquote>

<p>The following is a non-normative response with Aggregated
	  Claims:
</p>
<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Claims Provider A contains the following Claims for Jane Doe:
{
 "address": {
   "street_address": "1234 Hollywood Blvd.",
   "locality": "Los Angeles",
   "region": "CA",
   "postal_code": "90210",
   "country": "US"},
 "phone_number": "+1 (310) 123-4567"
}

Claims Provider A signs the JSON Claims, resulting in a signed JWT:
jwt_header.jwt_part2.jwt_part3

Authorization Server returns Jane Doe's Aggregated Claims from
Claims Provider A:
{
 "name": "Jane Doe",
 "given_name": "Jane",
 "family_name": "Doe",
 "birthday": "01/01/2001",
 "eye_color": "blue",
 "email": "janedoe@example.com",
 "_claim_names": {
  "address": "src1",
  "phone_number": "src1"
 },
 "_claim_sources": {
  "src1": {"JWT": "jwt_header.jwt_part2.jwt_part3"}
 }
}</pre></div><p>

</p>
<p>The following is a non-normative response with Distributed
	  Claims:
</p>
<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Claims Provider A (Jane Doe's Bank) contains the following Claims
for Jane Doe:
{
 "shipping_address": {
   "street_address": "1234 Hollywood Blvd.",
   "locality": "Los Angeles",
   "region": "CA",
   "postal_code": "90210",
   "country": "US"},
 "payment_info": "Some_Card 1234 5678 90123 4562",
 "phone_number": "+1 (310) 123-4567"
}

A Claims Provider B (Credit Agency) contains the following Claims
for Jane Doe:
{
 "credit_score": "650"
}

Authorization Server returns Jane Doe's Claims along with the
Distributed Claims from Claims Provider A and B by sending the Access
Tokens and URL locations where the Claims may be retrieved:
{
 "name": "Jane Doe",
 "given_name": "Jane",
 "family_name": "Doe",
 "email": "janedoe@example.com",
 "birthday": "01/01/2001",
 "eye_color": "blue",
 "_claim_names": {
  "payment_info": "src1",
  "shipping_address": "src1",
  "credit_score": "src2"
 },
 "_claim_sources": {
  "src1": {"endpoint": "https://bank.example.com/claimsource"},
  "src2": {"endpoint": "https://creditagency.example.com/claimshere",
           "access_token": "ksj3n283dke"}
 }
}</pre></div><p>

</p>
<a name="Serializations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Serializations</h3>

<p>Parameter names and values MAY be JSON serialized into a JSON
      structure.
</p>
<a name="js"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
JSON Serialization</h3>

<p>The parameters are serialized into a JSON structure by adding each
        parameter at the highest structure level. Parameter names and string
        values are included as JSON strings. Numerical values are included as
        JSON numbers. Each parameter MAY have JSON Structure as its value.
</p>
<p>Following is a non-normative example of such
          serialization:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "access_token":"SlAV32hkKG",
 "expires_in":3600,
 "refresh_token":"8xLOxBtZp8"
}</pre></div>
<a name="sigenc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Signatures and Encryption</h3>

<p>Depending on the transport through which the messages are sent, the
      integrity of the message may not be guaranteed and the originator of the
      message may not be authenticated. To mitigate these risks, 
      the OpenID Request Object, token request, ID Token, and UserInfo response
      MAY utilize <a class='info' href='#JWS'>JSON Web Signature
      (JWS)<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] to sign the contents.
</p>
<p>To achieve message confidentiality, 
      the OpenID Request Object, token request, ID Token, and UserInfo response
      MAY use
      <a class='info' href='#JWE'>JSON Web Encryption (JWE)<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE] to encrypt the
      content.
</p>
<p>When the message is both signed and 
      encrypted, it MUST be
      <a class='info' href='#signing_order'>signed first and then encrypted<span> (</span><span class='info'>Signing and Encryption order</span><span>)</span></a>,
      with nesting performed in the same manner as
      specified for JWTs <a class='info' href='#JWT'>[JWT]<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a>.
      Note that all JWE encryption methods perform integrity checking.
</p>
<a name="sigenc.alg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Supported Algorithms</h3>

<p>The server advertises its supported signing and encryption algorithms
       in its discovery document.
       The algorithm identifiers are specified in <a class='info' href='#JWA'>JWA<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWA].
       The related elements are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>userinfo_algs_supported</dt>
<dd>
	    A JSON array containing a list of the JWS and JWE
	    signing and encryption algorithms <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
            supported by the UserInfo Endpoint.
</dd>
<dt>id_token_algs_supported</dt>
<dd>
	    A JSON array containing a list of the JWS and JWE
	    signing and encryption algorithms <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
	    supported by the Authorization Server for the ID Token.
</dd>
<dt>request_object_algs_supported</dt>
<dd>
	    A JSON array containing a list of the JWS and JWE
	    signing and encryption algorithms <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
	    supported by the Authorization Server for 
            the <a class='info' href='#OpenID_Request_Object'>OpenID Request Object<span> (</span><span class='info'>OpenID Request Object</span><span>)</span></a>. Servers SHOULD support 
	    <tt>HS256</tt>.
</dd>
<dt>token_endpoint_auth_algs_supported</dt>
<dd>
	    A JSON array containing a list of the <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] 
	    signing algorithms <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
	    supported by the Token Endpoint for the
	    <tt>private_key_jwt</tt> method.
            Servers SHOULD support <tt>RS256</tt>.
</dd>
</dl></blockquote>

<p>The Client registers its required algorithms for Signing and Encryption 
      using the following Registration parameters:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>require_signed_request_object</dt>
<dd>OPTIONAL.  The 
             JWS signature algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for OpenID Request Objects
             by the Authorization Server. All OpenID Request Objects from
             this <tt>client_id</tt> MUST be rejected if not signed by this algorithm.
             Servers SHOULD support <tt>RS256</tt>.
</dd>
<dt>userinfo_signed_response_alg</dt>
<dd>OPTIONAL.  The 
             JWS signature algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for UserInfo responses. 
             If this is specified the response will be 
             <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] serialized.
</dd>
<dt>userinfo_encrypted_response_alg</dt>
<dd>OPTIONAL.  
             The JWE <tt>alg</tt>
             algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for UserInfo responses.
	         If this is requested in 
             combination with signing, the response 
             MUST be <a class='info' href='#signing_order'>signed first then encrypted<span> (</span><span class='info'>Signing and Encryption order</span><span>)</span></a>.
             If this is specified, the response will be 
             <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] serialized.
</dd>
<dt>userinfo_encrypted_response_enc</dt>
<dd>OPTIONAL.  The 
             JWE <tt>enc</tt>
             algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for UserInfo responses.
             If <tt>"userinfo_encrypted_response_alg"</tt> is specified 
             the default for this value is <tt>A128CBC</tt>.
	         
</dd>
<dt>userinfo_encrypted_response_int</dt>
<dd>OPTIONAL.  The 
             JWE <tt>int</tt>
             algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for UserInfo responses.
	         If <tt>"userinfo_encrypted_response_alg"</tt> is specified 
             and the <tt>"userinfo_encrypted_response_enc"</tt> 
             is not an AEAD algorithm,
             the default for this value is <tt>HS256</tt>.
             
</dd>
<dt>id_token_signed_response_alg</dt>
<dd>OPTIONAL.  The 
             JWS signature algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required 
             for ID Tokens issued to this <tt>client_id</tt>. 
             The default if not specified is <tt>RS256</tt>.
	         The public key for verifying the signature is provided by retrieving the 
	         document from the
	         <tt>jwk_url</tt> element or the 
	         <tt>x509_url</tt> element from discovery.
</dd>
<dt>id_token_encrypted_response_alg</dt>
<dd>OPTIONAL.  
             The JWE <tt>alg</tt> algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a>
	     required for ID Tokens issued to this <tt>client_id</tt>. 
             If this is requested, the response MUST be signed then encrypted. 
             The default if not specified is no encryption.
</dd>
<dt>id_token_encrypted_response_enc</dt>
<dd>OPTIONAL.  
             The JWE <tt>enc</tt> 
             algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for 
             ID Tokens issued to this <tt>client_id</tt>.
             If <tt>"id_token_encrypted_response_alg"</tt> is specified 
             the default for this value is <tt>A128CBC</tt>.
             
</dd>
<dt>id_token_encrypted_response_int</dt>
<dd>OPTIONAL.  
             The JWE <tt>int</tt> 
             algorithm <a class='info' href='#JWA'>[JWA]<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> required for 
             ID Tokens issued to this <tt>client_id</tt>.
             If <tt>"id_token_encrypted_response_alg"</tt> is specified 
             and the <tt>"id_token_encrypted_response_enc"</tt> 
             is not an AEAD algorithm,
             the default for this value is <tt>HS256</tt>.
             
</dd>
</dl></blockquote>

<a name="sigenc.key"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Keys</h3>

<p>The Server advertises its supported signing and encryption algorithms
      in its discovery document. The related elements are:
</p>
<p>The Provider provides its public Keys during Discovery in the following elements:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>jwk_url</dt>
<dd>
          URL of the OP's <a class='info' href='#JWK'>JSON Web Key<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWK] document
	  that contains the Server's signing key
          that is used for signing the JWT. 
          It MAY also be used by the Client to encrypt the JWT
          to the Server if <tt>x509_encryption_url</tt> or 
          <tt>jwk_encryption_url</tt> is not specified, 
          but this is discouraged. A separate encryption key 
          SHOULD be used.
</dd>
<dt>jwk_encryption_url</dt>
<dd>          
          URL of the OP's <a class='info' href='#JWK'>JSON Web Key<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWK] document
	  that contains the Server's encryption key
          that is used by the Client to encrypt the JWT to the Server. 
          If it is not present, its value 
          is the same as the URL provided by <tt>jwk_url</tt>.
</dd>
<dt>x509_url</dt>
<dd>
          URL of the OP's X.509 certificates in PEM format 
          that are used by the Server for Signing the JWT. 
          It MAY also be used by the Client to JWE Encrypt the JWT
          to the Server if <tt>x509_encryption_url</tt>
          is not specified. The certificate referenced SHOULD be valid for its 
          intended use as specified by <a class='info' href='#RFC2459'>RFC 2459<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a> [RFC2459]
</dd>
<dt>x509_encryption_url</dt>
<dd> 
          URL of the OP's X.509 certificates in PEM format
          that contains the Server's encryption key
          that is used by the Client to encrypt the JWT 
          to the Server. If it is not present, the URL provided by the
          <tt>x509_url</tt> is used instead. 
          The certificate referenced SHOULD be valid for its 
          intended use as specified by <a class='info' href='#RFC2459'>RFC 2459<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a> [RFC2459]
</dd>
</dl></blockquote>

<p>The Client provides its public Keys during Registration, in the following 
      elements:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>jwk_url</dt>
<dd>OPTIONAL. URL for the Client's <a class='info' href='#JWK'>JSON Web Key<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWK] document that is used for 
            signing the Request Objects.
            If <tt>jwk_encryption_url</tt> is not 
            provided, it is also used by the Server 
            to encrypt the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] to the Client.
</dd>
<dt>jwk_encryption_url</dt>
<dd>OPTIONAL. URL for the Client's <a class='info' href='#JWK'>JSON Web Key<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Key (JWK),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWK]. 
            It is used by the Server to encrypt the response objects.
</dd>
<dt>x509_url</dt>
<dd>OPTIONAL.  URL for the Client's PEM encoded X.509
            Certificate or Certificate chain. 
            It is used by the Client for
            signing the Request Objects.
            If <tt>x509_encryption_url</tt> is not 
            present, it is also used to encrypt
	    the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] to the Client. 
            The certificate referenced SHOULD be valid for its 
            intended use as specified by <a class='info' href='#RFC2459'>RFC 2459<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a> [RFC2459].
</dd>
<dt>x509_encryption_url</dt>
<dd>
            OPTIONAL. URL for the Client's PEM encoded 
            X.509 Certificate or Certificate chain, used to encrypt
	    the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] to the Client.
            The certificate referenced SHOULD be valid for its 
            intended use as specified by <a class='info' href='#RFC2459'>RFC 2459<span> (</span><span class='info'>Housley, R., Ford, W., Polk, T., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and CRL Profile,&rdquo; January&nbsp;1999.</span><span>)</span></a> [RFC2459] 
</dd>
</dl></blockquote>

<p>If keys are specified in both X.509 and JWK formats, they MUST be the same keys.
</p>
<p>Algorithms like Elliptic Curve signing and key agreement require separate keys for 
         signing and encryption for security.  For RSA, a single key MAY be used for both,
         but it is good practice to separate them.
</p>
<a name="sigs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Signing</h3>

<p>The signing party MUST select a signature algorithm 
        based on the supported algorithms of the recipient in <a class='info' href='#sigenc.alg'>Section&nbsp;4.1<span> (</span><span class='info'>Supported Algorithms</span><span>)</span></a>.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Asymmetric Signatures</dt>
<dd>
            When using RSA or ECDSA Signatures, 
            the <tt>alg</tt>
             Claim of the JWS header MUST be set to the appropriate algorithm
             as defined in <a class='info' href='#JWA'>JSON Web Algorithms<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWA].
            The private key MUST be the one associated with the 
            Public Signing Key provided in
            <a class='info' href='#sigenc.key'>Section&nbsp;4.2<span> (</span><span class='info'>Keys</span><span>)</span></a>. 
            If there are multiple keys in the referenced JWK document, the
            <tt>kid</tt> MUST be specified in the JWS header. 
            If there are multiple certificates at the referenced certificate location,
	    then <tt>x5t</tt> MUST be specified in the JWS header.
            The key usage of the respective keys MUST support signature. 
          
</dd>
<dt>Symmetric Signatures</dt>
<dd>
            When using HMAC Signatures, the <tt>alg</tt>
	    Claim of the JWS header MUST be set to the appropriate algorithm
	    as defined in <a class='info' href='#JWA'>JSON Web Algorithms<span> (</span><span class='info'>Jones, M., &ldquo;JSON Web Algorithms (JWA),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWA]. 
	    The client and server MUST establish a shared secret out of band.
          
</dd>
</dl></blockquote>

<a name="enc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Encryption</h3>

<p>The encrypting party MUST select an encryption algorithm
        based on the supported algorithms of the recipient in <a class='info' href='#sigenc.alg'>Section&nbsp;4.1<span> (</span><span class='info'>Supported Algorithms</span><span>)</span></a>.
        All JWTs MUST be signed before encryption
        to enable verification of the Issuer.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Asymmetric Encryption RSA</dt>
<dd>
            Use the link registered/discovered in <a class='info' href='#sigenc.key'>Section&nbsp;4.2<span> (</span><span class='info'>Keys</span><span>)</span></a>
            to retrieve the relevant key.
            The 
            <tt>jwk_encryption_url</tt> 
            or 
            <tt>x509_encryption_url</tt> 
            link MUST be used if provided.
            If there are multiple keys in the referenced JWK document, the
            <tt>kid</tt> MUST be specified in the JWE header. 
            If there are multiple certificates at the referenced certificate location,
	        then <tt>x5t</tt> MUST be specified in the JWS header.
            Use the supported RSA KeyWrap algorithm to KeyWrap a random 
            <tt>Content Master Key</tt> to be used for encrypting 
            the signed JWT.
            The key usage of the respective keys MUST include encryption. 
          
</dd>
<dt>Asymmetric Encryption Elliptic Curve</dt>
<dd>
            Create an ephemeral Elliptic Curve public key for the <tt>epk</tt>
            element of the JWE header. 
            Use the link registered/discovered in <a class='info' href='#sigenc.key'>Section&nbsp;4.2<span> (</span><span class='info'>Keys</span><span>)</span></a>
            to retrieve the relevant key.
            The 
            <tt>jwk_encryption_url</tt> 
            or 
            <tt>x509_encryption_url</tt> 
            link MUST be used if provided.
            If there are multiple keys in the referenced JWK document, the
            <tt>kid</tt> MUST be specified in the JWE header. 
            If there are multiple certificates at the referenced certificate location,
            then <tt>x5t</tt> MUST be specified in the JWS header.  
            Use the ECDH-ES algorithm to KeyWrap a random 
            <tt>Content Master Key</tt> to be used for encrypting 
            the signed JWT.
            The key usage of the respective keys MUST support encryption.
          
</dd>
<dt>Symmetric Encryption</dt>
<dd>
            Use a left truncated SHA-256 hash of <tt>client_secret</tt> 
            to KeyWrap a random 
            <tt>Content Master Key</tt> to be used for encrypting 
            the signed JWT.  The SHA-256 MUST be left truncated to the appropriate bit length 
            for the AES KeyWrap algorithm used.
          
</dd>
</dl></blockquote>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Verification</h3>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Authorization Request Verification</h3>

<p>Authorization Request Verification consists of two main 
	  steps: (1) encryption and signature validation of 
	  the value of <tt>request</tt> or 
	  the content of <tt>request_uri</tt>,  
	  and (2) parameter verification.
          If an OpenID Request Object was sent in the <tt>request</tt> parameter or by reference in the
          <tt>request_uri</tt> parameter, the 
          Request Object MUST verify as 
		  <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] or <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE] 
		  objects that are encoded in the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT].
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Encrypted Request Object</h3>

<p>If the Authorization Server has advertised JWE encryption algorithms
          in the <tt>request_object_algs_supported</tt> element of its 
          Discovery Document, these are used by the Client to encrypt the JWT.
</p>
<p>The Authorization Server MUST decode the JWT in accordance with
          <a class='info' href='#JWE'>JSON Web Encryption<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE] specification. 
		  The result MAY be either OpenID Request Object or a JWS Signed JWT. 
		  In the latter case, the signature verification MUST be performed 
		  as defined in <a class='info' href='#signed.req.obj.var'>Signed Request Object<span> (</span><span class='info'>Signed Request Object</span><span>)</span></a>. 
</p>
<p>The Authorization Server MUST return the error if there is a decryption error.
</p>
<a name="signed.req.obj.var"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Signed Request Object</h3>

<p>To perform Signature Verification, 
          the <tt>alg</tt> parameter in the JWS header MUST match the value
          of the <tt>require_signed_request_object</tt> set during
          <a class='info' href='#OpenID.Registration'>Client Registration<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration] or a value that was
	   pre-registered by other means.
</p>
<p>The signature must be validated against the key registered for that <tt>client_id</tt>
          and algorithm, in accordance with the 
          <a class='info' href='#JWS'>JSON Web Signature<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] specification.
</p>
<p>The Authorization Server MUST return the error authorization 
            response if there is a signature validation error.
</p>
<a name="req.obj.veri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
Parameter Verification</h3>

<p>The Authorization Server MUST construct the Authorization Request Message 
		  from the OpenID Request Object 
		  and the OAuth 2.0 Authorization Request parameters.
		  If the same parameter exists both in 
		  the OpenID Request Object and the OAuth Authorization Request parameters,
		  the parameter values MUST exactly match.
		  Using this Authorization Request Message, the Authorization Server performs 
		  the following steps of the request verification: 
		  
</p>
<p></p>
<ol class="text">
<li>The Authorization Server MUST understand all the parameters 
		  except for the unsupported Claims. If there are any parameters that 
		  it does not understand except for the unsupported Claims, it MUST return 
		  an error response. 
</li>
<li>The Authorization Server MUST verify that all the 
		  OAuth 2.0 variables according to OAuth 2.0. 
</li>
<li>The Authorization Server MUST verify that all the required parameters 
		  are present. 
</li>
<li>If the <tt>user_id</tt> Claim
		  as a member of <tt>id_token</tt> element
                  is requested with a specific value, 
                  the Authorization Server MUST only send a positive response if that user 
                  has an active session with the authorization server. The Authorization 
                  server MUST not reply with an ID Token or Access Token for a different user, 
                  even if they have an active session with the Authorization Server. 
                  
</li>
<li>
                  If the <tt>acr</tt> Claim is requested
		  as a required Claim
                  in the <tt>id_token</tt> member 
                  with <tt>values</tt> as a parameter, 
                  the Authorization Server MUST return an <tt>acr</tt> 
                  Claim value that matches one of the requested values. 
                  The Authorization 
                  server MAY ask the user to re-authenticate with additional factors 
                  to meet the requirements. If this is a required Claim and the 
                  requirement cannot be met, then the Authorization Server MUST return an error.
                  The Client MAY make this Claim optional by including "optional": true in the 
                  <tt>acr</tt> Claim request. If the Claim is optional and the requested value for 
                  the user cannot be provided, the Authorization server SHOULD return 
                  the session's current <tt>acr</tt> as
                  the value of the <tt>acr</tt> Claim. 
                  If the Claim is optional, the Authorization server is not required to
                  provide this Claim in its response.
                  
</li>
</ol>

<p>If the Authorization Server encounters any error, 
		  it MUST return the error response.
</p>
<a name="id.token.verification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
ID Token Verification</h3>

<p>To verify the validity of ID Token in the Authorization or Token Endpoint Response, the Client
        MUST do the following:
</p>
<p></p>
<ol class="text">
<li>If the Client has provided an
            <tt>id_token_encrypted_response_alg</tt>
            parameter during Registration, decrypt the <a class='info' href='#JWE'>id_token<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE],
            using the key pair specified during Registration.
</li>
<li>The Client MUST validate that the <tt>client_id</tt> in the 
            <tt>aud</tt> (audience) Claim is one
             it has registered for the Issuer identified by the value in the 
             <tt>iss</tt> (issuer) Claim.
              The ID Token MUST be rejected if the value of 
              <tt>aud</tt> (audience) is not valid for the 
              Issuer.
</li>
<li>If the <tt>id_token</tt> is received via direct
            communication between the client and the Token Endpoint, the TLS server 
            verification MAY be used to validate the issuer in place of 
            checking the token signature.
            The Client MUST verify the signature of all other ID Tokens according to
            <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] using the algorithm specified in the 
            <tt>alg</tt> parameter of the JWT header.
</li>
<li>The <tt>alg</tt> value SHOULD be the default of
	    <tt>RS256</tt>
            or the algorithm sent by the Client 
            in the <tt>id_token_signed_response_algs</tt> parameter 
            during Registration.
</li>
<li>If the <tt>alg</tt> parameter of the JWT header is one of 
            <tt>HS256</tt>, <tt>HS384</tt>,
	        or <tt>HS512</tt>,
	        the <tt>client_secret</tt> for the 
            <tt>client_id</tt> contained in the 
            <tt>aud</tt> (audience) Claim is used as the key
	    to validate the signature.
</li>
<li>For other Signing algorithms, the Client must use the signing key provided
	    in Discovery by the Issuer.
	    The issuer must exactly match the value of the 
            <tt>iss</tt> (issuer) Claim.
</li>
<li>The current time MUST be less than the value of the 
            <tt>exp</tt> Claim.
</li>
<li>The <tt>iat</tt> Claim may be used to reject tokens that 
            were issued too far away from the current time, limiting the amount of
            time that nonces must be stored to prevent attacks. 
            The acceptable range is Client specific.
</li>
<li>If a nonce value was sent in the Authorization Request,
	    a <tt>nonce</tt> Claim MUST be present
	    and its value of the checked to verify that
            it is the same value as the one that was sent in the Authorization
            Request. The Client SHOULD check the <tt>nonce</tt> value for replay attacks.
            The precise method for detecting replay attacks is Client specific.
</li>
<li>If the <tt>acr</tt> Claim was requested, the 
            Client SHOULD check that the asserted Claim Value is appropriate.
            The meaning and processing of  
            <tt>acr</tt> Claim Values is out of scope for this specification.
</li>
<li>If the <tt>auth_time</tt> Claim was requested, the 
            Client SHOULD check the value 
            and request re-authentication if it determines too much time has elapsed 
            since the last user authentication.
</li>
</ol>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
UserInfo Response Verification</h3>

<p>To verify the validity of the UserInfo response, the Client MUST do
        the following:
</p>
<p></p>
<ol class="text">
<li>If the Client has provided a 
            <tt>userinfo_encrypted_response_alg</tt>
            parameter during Registration, decrypt the <a class='info' href='#JWE'>id_token<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE],
            using the key pair specified during Registration.
</li>
<li>If the response was signed, the Client SHOULD validate the
            signature according to <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS].
</li>
<li>Check that the OP that responded was really the intended OP
            through a TLS/SSL server certificate check, per
	    <a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125].
</li>
</ol>

<a name="access.token.verification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Access Token Verification</h3>

<p>To verify the validity of an Access Token issued with an ID Token in 
        the implicit flow, the client SHOULD do the following:
</p>
<p></p>
<ol class="text">
<li>Hash the <tt>access_token</tt> 
              with the SHA-2 family hash algorithm
              of the same length as the hash used in the <tt>alg</tt>
              parameter of the JWS header of the ID Token.
</li>
<li>Take the left-most half of the hash and base64url encode it.
</li>
<li>The value of <tt>at_hash</tt> in the ID Token MUST
            match the value produced in the previous step if <tt>at_hash</tt>
            is present in the ID Token.
</li>
</ol>

<a name="code.verification"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Code Verification</h3>

<p>To verify the validity of a <tt>code</tt> issued with an ID Token in 
        the implicit flow, the client SHOULD do the following:
</p>
<p></p>
<ol class="text">
<li>Hash the <tt>code</tt> 
              with the SHA-2 family hash algorithm
              of the same length as the hash used in the <tt>alg</tt>
              parameter of the JWS header of the ID Token.
</li>
<li>Take the left-most half of the hash and base64url encode it.
</li>
<li>The value of <tt>c_hash</tt> in the ID Token MUST
            match the value produced in the previous step if <tt>c_hash</tt>
            is present in the ID Token.
</li>
</ol>

<a name="stringops"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
String Operations</h3>

<p>
	Processing some OpenID Connect messages requires comparing
	values in the messages to known values. For example, the Claim
	Names returned by the UserInfo Endpoint might be compared to
	specific Claim Names such as <tt>user_id</tt>.  Comparing Unicode strings,
	however, has significant security implications.
      
</p>
<p>
	Therefore, comparisons between JSON strings and other Unicode
	strings MUST be performed as specified below:

	</p>
<ol class="text">
<li>
	    Remove any JSON applied escaping to produce an array of
	    Unicode code points.
	  
</li>
<li>
	    <a class='info' href='#USA15'>Unicode Normalization<span> (</span><span class='info'>Davis, M., Whistler, K., and M. D&uuml;rst, &ldquo;Unicode Normalization Forms,&rdquo; 09&nbsp;2009.</span><span>)</span></a> [USA15] MUST NOT
	    be applied at any point to either the JSON string or to
	    the string it is to be compared against.
	  
</li>
<li>
	    Comparisons between the two strings MUST be performed as a
	    Unicode code point to code point equality comparison.
	  
</li>
</ol><p>
      
</p>
<p>
	In several places, this specification uses space delimited
	lists of strings.  In all such cases, only the ASCII space
	character (0x20) MAY be used for this purpose.
      
</p>
<a name="related"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Related Specifications</h3>

<p>This specification is an abstract specification. It needs to be 
	  bound to a protocol to be used in practice. One such example of 
	  protocol binding is:
      </p>
<ul class="text">
<li><a class='info' href='#OpenID.Standard'>OpenID Connect Standard 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Standard 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Standard]
          - Protocol binding for the full set of OpenID Connect messages
</li>
</ul><p>
	   
</p>
<p>These related OpenID Connect specifications MAY OPTIONALLY be used in
      combination with this specification to provide additional functionality:
      </p>
<ul class="text">
<li><a class='info' href='#OpenID.Discovery'>OpenID Connect Discovery
          1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Discovery] - Dynamic discovery for user and Authorization Server 
          endpoints and information
</li>
<li><a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client
          Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration] - Dynamic registration of OpenID Connect
          Clients with OpenID Providers
</li>
<li><a class='info' href='#OpenID.Basic'>OpenID Connect Basic Client Profile 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;OpenID Connect Basic Client Profile 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Basic] -
          Protocol binding for a subset of the OpenID Connect Messages
          that is intended for use by basic
	  web-based Relying Parties using the OAuth code grant type.
</li>
<li><a class='info' href='#OpenID.Implicit'>OpenID Connect Implicit Client Profile 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Implicit Client Profile 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Implicit] -
          Protocol binding for a subset of the OpenID Connect Messages
          that is intended for use by basic
	  web-based Relying Parties using the OAuth implicit grant type.
</li>
<li><a class='info' href='#OpenID.Session'>OpenID Connect Session Management
          1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Session Management           1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Session] - Session management for OpenID Connect sessions
</li>
</ul>

<a name="security_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p><a class='info' href='#OAuth.Threat'>OAuth 2.0 Threat Model and 
      Security Considerations<span> (</span><span class='info'>Lodderstedt, T., Ed., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Threat] provides an extensive list of threats and controls 
	  that applies to this standard as well. In addition, this standard provides 
	  additional control measures listed below. 
</p>
<a name="request_disclosure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Request Disclosure</h3>

<p>If appropriate measures are not taken, a request may be disclosed to 
	  an attacker posing security and privacy threat.
</p>
<p>In addition to what is stated in Section 5.1.1 of <a class='info' href='#OAuth.Threat'>[OAuth.Threat]<span> (</span><span class='info'>Lodderstedt, T., Ed., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; May&nbsp;2012.</span><span>)</span></a>, 
	  this standard provides a way to provide the confidentiality of the request 
      end to end through the 
	  use of <tt>request</tt> or <tt>request_uri</tt>
	  parameters, where the content of the <tt>request</tt>
	  is an encrypted JWT with the appropriate key and cipher.  
      This works even against a compromised user-agent in the case of indirect request. 
</p>
<a name="server_masquerading"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Server Masquerading</h3>

<p>A malicious Server may masquerade as the legitimate server 
	  using various means. To detect such an attack, the Client needs to authenticate 
	  the server. 
</p>
<p>In addition to what is stated in Section 5.1.2 of <a class='info' href='#OAuth.Threat'>[OAuth.Threat]<span> (</span><span class='info'>Lodderstedt, T., Ed., McGloin, M., and P. Hunt, &ldquo;OAuth 2.0 Threat Model and Security Considerations,&rdquo; May&nbsp;2012.</span><span>)</span></a>, 
	  this standard provides a way to authenticate the Server through either the 
	  use of Signed or Encrypted JWTs 
	  with an appropriate key and cipher.
</p>
<a name="token_manufacture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Token Manufacture/Modification</h3>

<p>An Attacker may generate a bogus token or modify the token content 
		(such as the authentication or 
		attribute statements) of an existing parseable token, causing the RP to grant 
		inappropriate access to the Client. For example, an Attacker may modify 
		the parseable token to extend the validity period; a Client may modify the 
		parseable token to have access to information that they should not be able to view.
        
</p>
<p>There are two ways to mitigate this attack:
</p>
<p></p>
<ol class="text">
<li>The token can be digitally signed by the OP. The Relying
            Party SHOULD check the digital signature to verify that it was
            issued by a legitimate OP.
</li>
<li>The token can be sent over a protected channel such as
            TLS 1.2 <a class='info' href='#RFC5246'>RFC 5246<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246]
	    and/or TLS 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>. 
            In order to protect the integrity of the token from
            malicious attack, the Server MUST be authenticated, per
			<a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125]. In this
            specification, the token is always sent over TLS/SSL protected
            channel. Note however, that this measure is only applicable 
			to the third party attacker and is not applicable to the case 
			where the Client is the attacker. 
</li>
</ol>

<a name="response_disclosure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Server Response Disclosure</h3>

<p>Server response may contain authentication and attribute 
		statements that include sensitive Client information. Disclosure of the 
		response contents can make the Client vulnerable to other types of 
		attacks.
</p>
<p>The server response disclosure can be mitigated in the following two
        ways:
          </p>
<ol class="text">
<li>Using the <tt>code</tt> response type. The response is sent over a TLS/SSL protected 
            channel, where the Client is authenticated by the
	    <tt>client_id</tt> and 
            <tt>client_secret</tt>.
</li>
<li>For other response types,
	    the signed response can be encrypted with the Client's 
            public key or a shared secret as an encrypted JWT
	        with an appropriate key and cipher.
</li>
</ol>

<a name="server_response_repudiation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Server Response Repudiation</h3>

<p>A response may be repudiated by the server if the proper mechanisms are not in place. 
		For example, if a Server does not digitally sign a response, the Server can claim that it was not 
        generated through the services of the Server.
</p>
<p>To mitigate this threat, the response may be digitally signed by
        the Server using a key that supports non-repudiation. The Client SHOULD check
        the digital signature to verify that it was issued by a legitimate
        Server and the integrity is intact.
</p>
<a name="request_repudation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Request Repudiation</h3>

<p>Since it is possible for a 
		compromised or malicious Client to send request to a wrong party,  
		a Client that was authenticated 
		using only a bearer token can repudiate any transaction.
		
</p>
<p>To mitigate this threat, the Sever MAY require that the 
		request to be digitally signed by
        the Client using a key that supports non-repudiation. 
		The Server SHOULD check
        the digital signature to verify that it was issued by a legitimate
        Client and the integrity is intact.
</p>
<a name="access_token_redirect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.7"></a><h3>8.7.&nbsp;
Access Token Redirect</h3>

<p>An Attacker uses the access token generated for one resource to 
		obtain access to a second resource.
		
</p>
<p>To mitigate this threat, the access token should be audience 
	    and scope restricted. One way of implementing it is to include
        the identifier of the resource for whom it was generated as audience. 
        The resource verifies that
        incoming tokens include its identifier as the audience of the
        token.
</p>
<a name="token_reuse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.8"></a><h3>8.8.&nbsp;
Token Reuse</h3>

<p>An Attacker attempts to use a one-time use token such as
	an Authorization Code that has
        been used once with the intended Resource. 
</p>
<p>To mitigate this threat, the token SHOULD include a timestamp 
		and a short lifetime of 
        validity. The Relying Party checks the timestamp and lifetime values
        to ensure that the token is currently valid.
</p>
<p>Alternatively, the server may record the state of the use of 
		the token and check the status for each request. 
</p>
<a name="auth_code_capture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.9"></a><h3>8.9.&nbsp;
 Eavesdropping or leaking authorization codes (Secondary Authenticator Capture)</h3>

<p>In addition to the attack patterns described in 4.4.1.1 of OAuth SC, 
		it can be captured in the User-Agent where the TLS
        session is terminated if the User-Agent is infested
        by malware. 
</p>
<p>However, capturing it is not useful as long as the profile
        uses either Client authentication or the Response encryption.
</p>
<a name="token_substitution"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.10"></a><h3>8.10.&nbsp;
Token Substitution</h3>

<p>A user may attempt to impersonate a more 
        privileged user by subverting the communication channel between the 
        Token Endpoint and Client, for example by reordering the messages, 
		to convince the Token Endpoint 
        that his or her authorization grant corresponds to the grant sent on 
        behalf of the more privileged user. 
</p>
<p>Responses to token requests is bound to the corresponding
        requests by message order in HTTP, as both token and requests are
        protected by TLS that can detect and disallow malicious reordering of
        packets.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.11"></a><h3>8.11.&nbsp;
Timing Attack</h3>

<p>Timing attack is an attack that allows the attacker to 
		obtain unnecessary large amount of information through the elapse time 
		difference in the code path taken by a successful decryption and 
		unsuccessful verification of signed message. 
		It can be used to reduce the effective key length of the
        cipher used. 
</p>
<p>Implementations should not terminate the verification process 
		at the instance of the finding error but should continue 
		running until all the octets were processed to avoid this attack. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.12"></a><h3>8.12.&nbsp;
Other Crypto Related Attacks</h3>

<p>There are various crypto related attacks possible depending on the 
		method used for encryption and signature / integrity checking.
		Implementers should consult the Security Considerations
		for the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] specification and
		specifications that it references
		to avoid the vulnerabilities
		identified in these specifications. 
		
</p>
<a name="signing_order"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.13"></a><h3>8.13.&nbsp;
Signing and Encryption order</h3>

<p>Signatures over encrypted text are not considered valid
	    in many jurisdictions.
	    Therefore, for integrity and non-repudiation,
	    this specification requires signing 
	    the plain text JSON claims.
</p>
<a name="issuer_identifier"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.14"></a><h3>8.14.&nbsp;
Issuer Identifier</h3>

<p>OpenID Connect supports multiple issuers per Host and Port combination.
</p>
<p>The issuer returned by discovery MUST exactly match the value of 
	    <tt>iss</tt> in the ID Token.
</p>
<p>It is RECOMMENDED that only a single issuer per host be used. Simple Web 
	    Discovery treats the path component of any URI as part of the user identifier. 
		
</p>
<a name="TLS_requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.15"></a><h3>8.15.&nbsp;
TLS Requirements</h3>

<p>
	      Implementations MUST support TLS.
	      Which version(s) ought to be implemented will vary over
	      time, and depend on the widespread deployment and known
	      security vulnerabilities at the time of implementation.
	      At the time of this writing,
	      TLS version 1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>
	      is the most recent version, but has very limited actual
	      deployment, and might not be readily available in
	      implementation toolkits.
	      TLS version 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>
	      is the most widely deployed version, and will give the
	      broadest interoperability.
	    
</p>
<p>
	      To protect against information disclosure and tampering,
	      confidentiality protection MUST be applied using TLS
	      with a ciphersuite that provides confidentiality and
	      integrity protection.
	    
</p>
<a name="privacy_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Privacy Considerations</h3>

<p>The UserInfo response typically contains Personally Identifiable
      Information. As such, End-User consent for the release of the information
      for the specified purpose SHOULD be obtained at or prior to the
      authorization time in accordance with relevant regulations. The purpose
      of use is typically registered in association with the <tt>redirect_uris</tt>.
</p>
<p>Only necessary UserInfo data should be stored at the Client and the
      Client SHOULD associate the received data with the purpose of use
      statement.
</p>
<p>The Resource Server SHOULD make the UserInfo access log available to 
      the End-User so that the End-User can monitor who accessed his data.
</p>
<p>To protect the End-User from a possible correlation among Clients, the
      use of a Pairwise Pseudonymous Identifier (PPID) as the <tt>user_id</tt> SHOULD be considered.
</p>
<a name="token_lifetime"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Refresh Token, and Access Token Lifetime</h3>

<p>Access Token grants are not revocable by the Authorization Server. 
	    Access Token grant lifetimes SHOULD be kept to single use or 
	    very short lifetimes.
</p>
<p>If access to the User Info Endpoint or other protected resources is required,
	    a Refresh Token should be used. The Client may then exchange the Refresh Token at
	    the Token Endpoint for a fresh short lived Access Token that can be used to 
	    access the resource.
</p>
<p>The Authorization Server SHOULD clearly identify long term grants to the User
	    during Authorization.
</p>
<p>The Authorization Server MUST provide a mechanism for the user to revoke
	    Refresh Tokens granted to a Client.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This document makes no requests of IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="E.164">[E.164]</a></td>
<td class="author-text">International Telecommunication Union, &ldquo;<a href="http://www.itu.int/rec/T-REC-E.164-201011-I/en">E.164 : The international public telecommunication numbering plan</a>,&rdquo; 2010.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO29115">[ISO29115]</a></td>
<td class="author-text">International Telecommunication Union and International Organization for Standardization, &ldquo;<a href="http://www.iso.org/iso/iso_catalogue/catalogue_tc/catalogue_detail.htm?csnumber=45138">ITU-T Recommendation X.1254 | ISO/IEC DIS 29115 --
          Information technology - Security techniques - Entity authentication
          assurance framework</a>,&rdquo; ISO/IEC&nbsp;29115, November&nbsp;2011.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO3166-1">[ISO3166-1]</a></td>
<td class="author-text">International Organization for
            Standardization, &ldquo;<a href="http://www.w3.org/WAI/ER/IG/ert/iso639.htm">ISO 3166-1:1997. Codes for the representation of names of
          countries and their subdivisions -- Part 1: Country codes</a>,&rdquo; 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="ISO639-1">[ISO639-1]</a></td>
<td class="author-text">International Organization for
            Standardization, &ldquo;ISO 639-1:2002. Codes for the representation of names of
          languages -- Part 1: Alpha-2 code,&rdquo; 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWA">[JWA]</a></td>
<td class="author-text">Jones, M., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms">JSON Web Algorithms (JWA)</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWE">[JWE]</a></td>
<td class="author-text">Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption">JSON Web Encryption (JWE)</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWK">[JWK]</a></td>
<td class="author-text">Jones, M., &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-key">JSON Web Key (JWK)</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWS">[JWS]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature">JSON Web Signature</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWT">[JWT]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token">JSON Web Token</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="LoA.Registry">[LoA.Registry]</a></td>
<td class="author-text"><a href="mailto:leifj@nordu.net">Johansson, L.</a>, &ldquo;<a href="http://tools.ietf.org/html/draft-johansson-loa-registry">An IANA registry for SAML 2.0 Level
           of Assurance Context Classes</a>,&rdquo; February&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Assertions">[OAuth.Assertions]</a></td>
<td class="author-text">Mortimore, C., Ed., Campbell, B., Jones, M., and Y. Goland, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-assertions">OAuth 2.0 Assertion Profile</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Bearer">[OAuth.Bearer]</a></td>
<td class="author-text">Jones, M., Hardt, D., and D. Recordon, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.JWT">[OAuth.JWT]</a></td>
<td class="author-text">Jones, M., Campbell, B., and C. Mortimore, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Responses">[OAuth.Responses]</a></td>
<td class="author-text">de Medeiros, B., Scurtescu, M., and P. Tarjan, &ldquo;<a href="http://openid.net/specs/oauth-v2-multiple-response-types-1_0.html">OAuth 2.0 Multiple Response Type Encoding Practices</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Threat">[OAuth.Threat]</a></td>
<td class="author-text">Lodderstedt, T., Ed., McGloin, M., and P. Hunt, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-threatmodel">OAuth 2.0 Threat Model and Security Considerations</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth2.0">[OAuth2.0]</a></td>
<td class="author-text">Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2">The OAuth 2.0 Authorization Framework</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Basic">[OpenID.Basic]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., and C. Mortimore, &ldquo;<a href="http://openid.net/specs/openid-connect-basic-1_0.html">OpenID Connect Basic Client Profile 1.0</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Discovery">[OpenID.Discovery]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Implicit">[OpenID.Implicit]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-implicit-1_0.html">OpenID Connect Implicit Client Profile 1.0</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Registration">[OpenID.Registration]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., and M. Jones, &ldquo;<a href="http://openid.net/specs/openid-connect-registration-1_0.html">OpenID Connect Dynamic Client
          Registration 1.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Session">[OpenID.Session]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-session-1_0.html">OpenID Connect Session Management
          1.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Standard">[OpenID.Standard]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-standard-1_0.html">OpenID Connect Standard 1.0</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[RFC2246]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2459">[RFC2459]</a></td>
<td class="author-text"><a href="mailto:housley@spyrus.com">Housley, R.</a>, <a href="mailto:wford@verisign.com">Ford, W.</a>, <a href="mailto:wpolk@nist.gov">Polk, T.</a>, and <a href="mailto:david.solo@citicorp.com">D. Solo</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2459">Internet X.509 Public Key Infrastructure Certificate and CRL Profile</a>,&rdquo; RFC&nbsp;2459, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2459.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3339">[RFC3339]</a></td>
<td class="author-text"><a href="mailto:GK@ACM.ORG">Klyne, G., Ed.</a> and <a href="mailto:chris.newman@sun.com">C. Newman</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>,&rdquo; RFC&nbsp;3339, July&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3339.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3339.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3339.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4627">[RFC4627]</a></td>
<td class="author-text">Crockford, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>,&rdquo; RFC&nbsp;4627, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4627.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5646">[RFC5646]</a></td>
<td class="author-text">Phillips, A. and M. Davis, &ldquo;<a href="http://tools.ietf.org/html/rfc5646">Tags for Identifying Languages</a>,&rdquo; BCP&nbsp;47, RFC&nbsp;5646, September&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5646.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6125">[RFC6125]</a></td>
<td class="author-text">Saint-Andre, P. and J. Hodges, &ldquo;<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;6125, March&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6125.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="USA15">[USA15]</a></td>
<td class="author-text"><a href="mailto:markdavis@google.com">Davis, M.</a>, <a href="mailto:ken@unicode.org">Whistler, K.</a>, and M. D&uuml;rst, &ldquo;Unicode Normalization Forms,&rdquo; Unicode Standard Annex&nbsp;15, 09&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="zoneinfo">[zoneinfo]</a></td>
<td class="author-text">Public Domain, &ldquo;<a href="http://www.twinsun.com/tz/tz-link.htm">The tz database</a>,&rdquo; June&nbsp;2011.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="OpenID.2.0">[OpenID.2.0]</a></td>
<td class="author-text">specs@openid.net, &ldquo;OpenID Authentication 2.0,&rdquo; December&nbsp;2007 (<a href="http://www.openid.net/specs/openid-authentication-2_0.txt">TXT</a>, <a href="http://www.openid.net/specs/openid-authentication-2_0.html">HTML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.PAPE">[OpenID.PAPE]</a></td>
<td class="author-text"><a href="mailto:david@sixapart.com">Recordon, D.</a>, <a href="mailto:mbj@microsoft.com">Jones, M.</a>, <a href="mailto:johnny.bufu@gmail.com">Bufu, J., Ed.</a>, <a href="mailto:cygnus@janrain.com">Daugherty, J., Ed.</a>, and <a href="mailto:n-sakimura@nri.co.jp">N. Sakimura</a>, &ldquo;OpenID Provider
            Authentication Policy Extension 1.0,&rdquo; December&nbsp;2008 (<a href="http://www.openid.net/specs/openid-authentication-2_0.txt">TXT</a>, <a href="http://www.openid.net/specs/openid-authentication-2_0.html">HTML</a>).</td></tr>
</table>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<p>As a successor version of OpenID, this specification heavily relies
      on <a class='info' href='#OpenID.2.0'>OpenID Authentication 2.0<span> (</span><span class='info'>specs@openid.net, &ldquo;OpenID Authentication 2.0,&rdquo; December&nbsp;2007.</span><span>)</span></a> [OpenID.2.0]. Please
      refer to Appendix C of OpenID Authentication 2.0 for the full list of
      the contributors for that specification.
</p>
<p>This specification is largely compliant with OAuth 2.0 draft 20.
      Please refer to the OAuth 2.0 specification for the list of
      contributors.
</p>
<p>In addition, the OpenID Community would like to thank the following
      people for the work they have done in the drafting and editing of this
      specification.
</p>
<p></p>
<blockquote class="text">
<p>Anthony Nadalin (tonynad@microsoft.com), Microsoft
</p>
<p>Andreas Akre Solberg (andreas.solberg@uninett.no), UNINET
</p>
<p>Axel Nennker (axel.nennker@telekom.de), Deutsche Telekom
</p>
<p>Casper Biering (cb@peercraft.com), Peercraft
</p>
<p>Breno de Medeiros (breno@gmail.com), Google
</p>
<p>Chuck Mortimore (cmortimore@salesforce.com), Salesforce
</p>
<p>David Recordon (dr@fb.com), Facebook
</p>
<p>Edmund Jay (ejay@mgi1.com), Illumila
</p>
<p>George Fletcher (george.fletcher@corp.aol.com), AOL
</p>
<p>Hideki Nara (hideki.nara@gmail.com), Takt Communications
</p>
<p>Johnny Bufu (jbufu@janrain.com), Janrain
</p>
<p>John Bradley (ve7jtb@ve7jtb.com), Ping Identity
</p>
<p>Justin Richer (jricher@mitre.org), Mitre
</p>
<p>Luke Shepard (lshepard@fb.com), Facebook
</p>
<p>Michael B. Jones (mbj@microsoft.com), Microsoft
</p>
<p>Nat Sakimura (n-sakimura@nri.co.jp), Nomura Research Institute,
          Ltd.
</p>
<p>Nov Matake (nov@matake.jp), Independent
</p>
<p>Pamela Dingle (pdingle@pingidentity.com), Ping Identity
</p>
<p>Paul Tarjan (pt@fb.com), Facebook
</p>
<p>Roland Hedberg (roland.hedberg@adm.umu.se), Independent
</p>
<p>Ryo Ito (ryo.ito@mixi.co.jp), mixi, Inc.
</p>
<p>Torsten Lodderstedt (t.lodderstedt@telekom.de), Deutsche Telekom
</p>
</blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Notices</h3>

<p>Copyright (c) 2012 The OpenID Foundation.
</p>
<p>
	The OpenID Foundation (OIDF) grants to any Contributor, developer, 
	implementer, or other interested party a non-exclusive, royalty free, 
	worldwide copyright license to reproduce, prepare derivative works from, 
	distribute, perform and display, this Implementers Draft or 
	Final Specification solely for the purposes of (i) developing 
	specifications, and (ii) implementing Implementers Drafts and 
	Final Specifications based on such documents, provided that attribution 
	be made to the OIDF as the source of the material, but that such attribution 
	does not indicate an endorsement by the OIDF.
      
</p>
<p>
	The technology described in this specification was 
	made available from contributions from various sources, 
	including members of the OpenID Foundation and others.  
	Although the OpenID Foundation has taken steps to help ensure 
	that the technology is available for distribution, it takes 
	no position regarding the validity or scope of any intellectual 
	property or other rights that might be claimed to pertain to 
	the implementation or use of the technology described in 
	this specification or the extent to which any license under 
	such rights might or might not be available; neither does it 
	represent that it has made any independent effort to identify 
	any such rights.  The OpenID Foundation and the contributors 
	to this specification make no (and hereby expressly disclaim any) 
	warranties (express, implied, or otherwise), including implied 
	warranties of merchantability, non-infringement, fitness for 
	a particular purpose, or title, related to this specification, 
	and the entire risk as to implementing this specification is 
	assumed by the implementer.  The OpenID Intellectual 
	Property Rights policy requires contributors to offer 
	a patent promise not to assert certain patent claims against 
	other contributors and against implementers.  The OpenID Foundation invites 
	any interested party to bring to its attention any copyrights, 
	patents, patent applications, or other proprietary rights 
	that may cover technology that may be required to practice 
	this specification.
      
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Document History</h3>

<p>[[ To be removed from the final specification ]]
</p>
<p>-12
        </p>
<ul class="text">
<li>Added <tt>preferred_username</tt> claim
	under <tt>profile</tt> scope
</li>
<li>Added section on claim stability
</li>
<li>Changed <tt>request_url</tt> to
	<tt>request_uri</tt> in Section 2.1.2.1
</li>
</ul>

<p>-11
        </p>
<ul class="text">
<li>Removed <tt>claims_in_id_token</tt> scope value,
	  per decision on June 15, 2012 special working group call
</li>
</ul>

<p>-10
        </p>
<ul class="text">
<li>Changed <tt>verified</tt> to
	  <tt>email_verified</tt>, per issue #564
</li>
<li>Added scope value <tt>claims_in_id_token</tt>
	  as a switch to indicate that the UserInfo claims should be
	  returned in the ID Token, per issue #561
</li>
<li>Removed <tt>optional</tt> claim request parameter
	  and added <tt>essential</tt> claim request parameter,
	  per issue #577.  We changed terminology from "optional" to "voluntary"
	  and "required" to "essential" to better match privacy policy requirements.
</li>
<li>Removed Check ID Endpoint, per issue #570
</li>
<li>Added PAPE Reference to the Informative References, per issue #574
</li>
<li>Added "id_token" response type as being MTI for OpenID Providers
</li>
<li>Specified that parameters present in both the OpenID Request Object and the
	  OAuth 2.0 Authorization Request MUST exactly match, per issue #575
</li>
<li>Changed OpenID Request Object from being specified as a JWT
	  to being specified as a JWS signed base64url encoded JSON object, per issue #592
</li>
<li>Changed default ID Token signing algorithm to RS256, per issue #571
</li>
<li>Changed default OpenID Request Object signing algorithm to RS256, per issue #571
</li>
<li>Made use of the nonce REQUIRED when using the implicit flow
	  and OPTIONAL when using the code flow, per issue #569
</li>
<li>Changed client.example.com to client.example.org, per issue #251
</li>
<li>Listed author of ISO29115 as "International Telecommunication Union and
	  International Organization for Standardization", per issue #589
</li>
<li>Added method of calculating signing and encryption keys for
	  symmetric algorithms, per issue #578
</li>
<li>Use standards track versions of JSON Web Token (JWT) and
	  OAuth JWT Bearer Token Profiles specs
	  (draft-ietf-oauth-json-web-token and draft-ietf-oauth-oauth-jwt-bearer)
</li>
</ul><p>
      
</p>
<p>-09</p>
<ul class="text">
<li>Added error interaction_required and removed
	  user_mismatched, per issue #523
</li>
<li>Changed invalid_request_redirect_uri to invalid_redirect_uri,
	  per issue #553
</li>
<li>Removed "embedded" display type, since its semantics were
	  not well defined, per issue #514
</li>
<li>Added optional id_token to authorization request parameters, per issue #535
</li>
<li>Now requested claims add to those requested with scope values, rather than replacing them, per issue #547
</li>
<li>Make changes to allow path in the issuer_identifier, per issue #513
</li>
<li>Make changes to userinfo_encrypted_response_* and id_token_encrypted_response_* to match registration
</li>
<li>Add hash and hash check of access_token and code to id_token, per issue #510
</li>
<li>Updated Notices
</li>
<li>Updated References
</li>
</ul>

<p>-08</p>
<ul class="text">
<li>Updated the version number and date
</li>
<li>Fixed #551 Sec 2.1.2.1 to clarify the OpenID Request Object MUST NOT include "request" nor "request_uri"
</li>
<li>Fixed #540 Sec 2.2.3 id_token MUST NOT be returned for grant_type=refresh
</li>
<li>Fixed #542 Sec 2.1.2.1 required fields for request object to match Standard
</li>
<li>Fixed Sec 2.2.1 to refer to client_secret value rather than Client Password
</li>
<li>Fixed Sec 4.2, 4.3, 4.4 to replace requirement for using x.509 keyuse extension
</li>
<li>Added reference to RFC2459
</li>
<li>Fixed Sec 2.1.1.1.1 added rational for sector_identifier_url from registration
</li>
<li>Fixed Sec 2.1.1.1.1 added examples of other ways to generate PPID
</li>
<li>Added iat as a required claim in ID Tokens
</li>
<li>Enumerated claims requested by the "profile" scope value
</li>
<li>Fixed Sec 2.1.2 response_type references standard rather than repeating values that are binding specific
</li>
<li>Fixed Sec 2.1.2 remove outdated language about openid scope requiring id_token to be returned with token response_type
</li>
</ul>

<p>-07</p>
<ul class="text">
<li>Removed definition and usage for assertion and claim object
</li>
<li>Consistent use of End-User
</li>
<li>Removed 'format' from userinfo and id_token object of the OpenID Request Object
</li>
<li>email scope allows access to the 'verified' claim
</li>
<li>ID Token 'audience' claim MUST be <tt>client_id</tt>
</li>
<li>Rename artifact to authorization code
</li>
<li>Removed language pertaining to custom userinfo schemas
</li>
<li>Check ID Endpoint returns only JSON
</li>
<li>Updated Check ID Response verification
</li>
<li>Remove 'audience' parameter from Authorization Request
</li>
<li>Moved display=none to prompt=none
</li>
<li>Added additional display parameter options
</li>
<li>Moved IANA considerations to Standard
</li>
<li>Added error codes to Authorization Endpoint
</li>
<li>Added client authentication section regarding various supported client 
	    authentication schemes and their validation.
	    This includes symmetric and asymmetric authentication, JWT Bearer Token 
	    Profiles, OAuth 2.0 Assertion Profile
</li>
<li>Updated Check ID Response verification
</li>
<li>Added 'auth_time' to ID Token
</li>
<li>Added validation for request object encryption and signature
</li>
<li>Added explanation for user_id type and calculating pairwise identifiers
</li>
<li>Added steps for signature and validation and encryption and decryption
</li>
<li>Added verification of issuer identifier
</li>
<li>Redefined 'nonce' in Authorization Request. Changed to REQUIRED parameter.
</li>
<li>Changed usage of the word "approval" to "consent"
</li>
<li>Use RFC 6125 to verify TLS endpoints
</li>
<li>ID Token MUST be JWT
</li>
<li>Access Tokens should include an audience claim for the Resource Server
</li>
<li>Updated Security Considerations
</li>
<li>OpenID Request Object parameters takes precedence over the same parameters in
	    the Authorization Request
</li>
<li>Allow other gender strings in UserInfo schema
</li>
<li>Changed UserInfo claim 'locale' to 'preferred_locales' and changed it to be a 
	    list of values
</li>
<li>Changed UserInfo claim 'user_id' to REQUIRED. Added requirement to compare 
	    user_id from userinfo endpoint to id_token
</li>
<li>RECOMMENDED E.164 format for UserInfo 'phone_number' claim
</li>
<li>Changed UserInfo Error Response to augment and return OAuth 2.0 Bearer Token Error Response
</li>
<li>Expanded section regarding UserInfo 'address' claim
</li>
<li>Added Privacy considerations
</li>
<li>Added rational for signing then encrypting added to security considerations
</li>
<li>Added section about string comparison rules needed
</li>
<li>The Authorization Server MUST understand all the request parameters 
	    except for the unsupported claims.
</li>
<li>Make openid scope provide user_id from userinfo endpoint
</li>
<li>Added explanation of select_account
</li>
<li>Check ID Endpoint uses ID Token as Access Token according to Bearer Token spec
</li>
<li>Clients MUST verify <tt>client_id</tt> in ID Token
</li>
<li>Bumped version + date
</li>
<li>Update John Bradley email and affiliation for Implementer's Draft
</li>
<li>Removed invalid_authorization_code, invalid_id_token error codes
</li>
<li>Section 2.3 client MUST NOT send encrypted JWT to the Check ID Endpoint
</li>
<li>Section 2.1.2.1.2 Added user_id claim and moved iso29115 to claims element of id_token member
</li>
<li>Defined Authentication Context, Authentication Context Class Reference (acr), replaced iso29115 with acr.
</li>
<li>Corrected instances of x509_url_encryption to x509_encryption_url
	    and jwk_url_encryption to jwk_encryption_url
</li>
</ul>

<p>-06</p>
<ul class="text">
<li>Changed section 3.1.4.1 to say the errors are returned as
          defined by the response type not always as query
          parameters. per ticket #174.
</li>
<li>Bumped version + date.
</li>
<li>Fixed section 3.3.3 to refer to errors in Bearer Token.
</li>
<li>Fixed 3.1.3 to ref the other response types ticket #173.
</li>
<li>Included reference to multiple response types.
</li>
<li>Fixed 3.1.2.1 to indicate default Claims in id_token.
</li>
<li>Fixed section 3.2.2 to reference the access token response from the token endpoint 4.1.4.
</li>
<li>Fixed section 3.2.1 to include refresh tokens.
</li>
<li>Fixed section 3.1.1 to be clear on JWT being the token format per ticket #171.
</li>
</ul>

<p>-05</p>
<ul class="text">
<li>Changed check_session to check_id.
</li>
<li>schema=openid now required when requesting UserInfo.
</li>
<li>Removed issued_to, since not well defined.
</li>
<li>Removed display values popup, touch, and mobile, since not well defined.
</li>
</ul>

<p>-04 </p>
<ul class="text">
<li>Changes associated with renaming "Lite" to "Basic Client"
          and replacing "Core" and "Framework" with "Messages" and
          "Standard".
</li>
<li>Numerous cleanups, including updating references.
</li>
</ul>

<p>-03 </p>
<ul class="text">
<li>Added secret_type to the Token endpoint.
</li>
<li>Minor edits to the samples.
</li>
</ul>

<p>-02 </p>
<ul class="text">
<li>Incorporates feedback from Nat Sakimura.
</li>
</ul>

<p>-01 </p>
<ul class="text">
<li>First Draft that incorporates the merge of the Core and Framework
          specs.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nat Sakimura</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nomura Research Institute,
      Ltd.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:n-sakimura@nri.co.jp">n-sakimura@nri.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Bradley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ping Identity</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ve7jtb@ve7jtb.com">ve7jtb@ve7jtb.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michael B. Jones</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Breno de Medeiros</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:breno@google.com">breno@google.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chuck Mortimore</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salesforce</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cmortimore@salesforce.com">cmortimore@salesforce.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Edmund Jay</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Illumila</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ejay@mgi1.com">ejay@mgi1.com</a></td></tr>
</table>
</body></html>
