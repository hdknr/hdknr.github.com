<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Draft: OpenID Connect Standard 1.0 - draft 12</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="OpenID Connect Standard 1.0 - draft 12">
<meta name="generator" content="xml2rfc v1.36 (http://xml.resource.org/)">
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: small; color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: small; font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: small; font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: small; text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Draft</td><td class="header">N. Sakimura</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NRI</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Bradley</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Ping Identity</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Jones</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Microsoft</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">B. de Medeiros</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Google</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">E. Jay</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Illumila</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 23, 2012</td></tr>
</table></td></tr></table>
<h1><br />OpenID Connect Standard 1.0 - draft 12</h1>

<h3>Abstract</h3>

<p>OpenID Connect 1.0 is a simple identity layer on top of the
      OAuth 2.0 protocol. It allows Clients to verify the
      identity of the End-User based on the authentication performed by
      an Authorization Server, as well as to obtain basic profile information
      about the End-User in an interoperable and RESTful manner.
</p>
<p>OpenID Connect Standard 1.0 is an HTTP protocol binding for
      OpenID Connect Messages 1.0 request and response messages.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rnc">1.1.</a>&nbsp;
Requirements Notation and Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">1.2.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Authorization Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#openid_scopes">2.1.</a>&nbsp;
OpenID Connect Scopes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protocol_flows">2.2.</a>&nbsp;
Protocol Flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#retrieving_code_token">2.2.1.</a>&nbsp;
How to Get an Authorization Code, Access Token, and ID Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#code_flow">2.2.2.</a>&nbsp;
Authorization Code Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#implicit_flow">2.2.3.</a>&nbsp;
Implicit Flow<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_request">2.3.</a>&nbsp;
Authorization Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rf_prep">2.3.1.</a>&nbsp;
Client Prepares an Authorization Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.3.1.1.</a>&nbsp;
Simple Request Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#req_param_method">2.3.1.2.</a>&nbsp;
Request Parameter Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Request_File_Method">2.3.1.3.</a>&nbsp;
Request File Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.2.</a>&nbsp;
Authorization Server Validates Request Object<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.3.3.</a>&nbsp;
Authorization Server Authenticates the End-User<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.3.4.</a>&nbsp;
Authorization Server Obtains the End-User Consent/Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#art_res">2.3.5.</a>&nbsp;
Authorization Server Sends the End-User Back to the Client<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#art_res_ok">2.3.5.1.</a>&nbsp;
End-User Grants Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#authz_error">2.3.5.2.</a>&nbsp;
End-User Denies Authorization or Invalid Request<br />
<a href="#token_ep">3.</a>&nbsp;
Token Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.</a>&nbsp;
Requesting an Access Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.1.</a>&nbsp;
Access Token Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.2.</a>&nbsp;
Access Token Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.3.</a>&nbsp;
Access Token Error Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.</a>&nbsp;
Refreshing an Access Token<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.1.</a>&nbsp;
Refresh Token Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.2.2.</a>&nbsp;
Refresh Token Error Response<br />
<a href="#userinfo_ep">4.</a>&nbsp;
UserInfo Endpoint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.1.</a>&nbsp;
UserInfo Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id_res">4.2.</a>&nbsp;
UserInfo Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.</a>&nbsp;
UserInfo Error Response<br />
<a href="#disco_reg">5.</a>&nbsp;
Discovery and Registration<br />
<a href="#Serializations">6.</a>&nbsp;
Serializations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#qss">6.1.</a>&nbsp;
Query String Serialization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#form_serialization">6.2.</a>&nbsp;
Form Serialization<br />
<a href="#security_considerations">7.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">7.1.</a>&nbsp;
Implicit Grant Flow Threats<br />
<a href="#privacy_considerations">8.</a>&nbsp;
Privacy Considerations<br />
<a href="#IANA">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#oauth_params">9.1.</a>&nbsp;
OAuth Parameters Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">9.1.1.</a>&nbsp;
Authorization Request Parameter (display)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">9.1.2.</a>&nbsp;
Authorization Request Parameter (prompt)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">9.1.3.</a>&nbsp;
Authorization Request Parameter (nonce)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">9.1.4.</a>&nbsp;
Authorization Request Parameter (request)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">9.1.5.</a>&nbsp;
Authorization Request Parameter (request_uri)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">9.1.6.</a>&nbsp;
ID Token Response Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">9.2.</a>&nbsp;
OAuth Extensions Error Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">9.2.1.</a>&nbsp;
Authorization Endpoint Error (invalid_redirect_uri)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">9.2.2.</a>&nbsp;
Authorization Endpoint Error (interaction_required)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">9.2.3.</a>&nbsp;
Authorization Endpoint Error (login_required)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">9.2.4.</a>&nbsp;
Authorization Endpoint Error (session_selection_required)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">9.2.5.</a>&nbsp;
Authorization Endpoint Error (consent_required)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">9.2.6.</a>&nbsp;
Authorization Endpoint Error (invalid_request_uri)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">9.2.7.</a>&nbsp;
Authorization Endpoint Error (invalid_openid_request_object)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">9.2.8.</a>&nbsp;
UserInfo Endpoint Error (invalid_schema)<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#anchor35">Appendix&nbsp;A.</a>&nbsp;
Footnotes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">A.1.</a>&nbsp;
Example JWT Values<br />
<a href="#anchor37">Appendix&nbsp;B.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor38">Appendix&nbsp;C.</a>&nbsp;
Notices<br />
<a href="#anchor39">Appendix&nbsp;D.</a>&nbsp;
Document History<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This specification describes the binding of the HTTP
      protocol with the endpoints described in <a class='info' href='#OpenID.Messages'>OpenID Connect Messages 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<a name="rnc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Notation and Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
	"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
	document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> .
</p>
<p>Throughout this document, values are quoted to indicate that they are
	to be taken literally. When using these values in protocol messages, the
	quotes MUST NOT be used as part of the value.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Terminology</h3>

<p>This specification uses the terms "Access Token", "Refresh Token",
	"Authorization Code", "Authorization Grant", "Authorization Server",
	"Authorization Endpoint", "Client", "Client Identifier", "Client
	Secret", "Protected Resource", "Resource Owner", "Resource Server", and
	"Token Endpoint" defined by
	<a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0],
	and the terms defined by
	<a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
	This specification also defines the following terms:
	  </p>
<blockquote class="text"><dl>
<dt>Request File</dt>
<dd>A document whose contents
	    is an OpenID Request Object representing a set of Authorization Request
	    parameters.
</dd>
<dt>Request File URI</dt>
<dd>A URL that references a Request File.
	    The Request File contents MUST be retrievable by the
	    Authorization Server.
</dd>
</dl></blockquote>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Authorization Endpoint</h3>

<p>The Authorization Endpoint performs authentication services for the
      End-User and requests authorization from the End-User to release
      information to OpenID Connect Relying Party Clients. When an End-User 
      accesses a Relying Party Client application that requires
      the End-User's identifier and other information, it sends the End-User to
      the Authorization Server's Authorization Endpoint for authentication and
      authorization. The Authorization Server then issues an ID Token that
      asserts the End-User's identifier and an Access Token that allows the
      Client to access the End-User's information at Protected Resource
      endpoints. Protected Resource endpoints MAY perform different actions or
      return different information based on the scopes associated with the 
      presented Access Token.
      Clients MUST specify 
      how the Access Token and ID Token are to be returned using the
      <tt>response_type</tt>
      parameter in the Authorization Request.
      
</p>
<a name="openid_scopes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
OpenID Connect Scopes</h3>

<p>Clients MUST specify the desired scopes in an Authorization Request to
        obtain an Access Token with the proper permissions.
        The scope names used by OpenID Connect are defined in
	Section 2.1.2 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>The Authorization Server MAY fully or partially ignore the scope values
         requested by the Client based on the Authorization Server policy or
         the End-User's instructions.
        A Client may elect to
        only request a subset of the information available from the
        UserInfo Endpoint.
</p>
<p>
<p>The following is a non-normative example of a <tt>scope</tt>
            parameter in an Authorization Request:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>scope=openid profile email phone</pre></div>

<a name="protocol_flows"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Protocol Flows</h3>

<p>Authorization Requests follow two main paths to obtain Access Tokens
        and ID Tokens, the Implicit Flow and the Authorization Code Flow. The 
        flows determine how the Access Token and ID Token are returned to the 
        Client. Access Tokens are credentials used to access Protected 
        Resources, as defined in Section 1.4 of 
        <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0]. Access Tokens represent 
        a Resource Owner's authorization and MUST NOT be exposed to 
        unauthorized parties.
</p>
<p>The Implicit Flow is mainly used by Clients implemented in a browser
        using a scripting language. The Access Token and ID Token are returned
        directly to the Client, which MAY expose them to the Resource Owner and
        other applications that have access to the Resource Owner's User-Agent.
        The Authorization Server does not perform Client authentication before
        issuing the Access Token.
</p>
<p>The Authorization Code Flow returns an Authorization Code to the
        Client, which can then exchange it for an Access Token directly. This
        provides the added benefit of not exposing the Access Token to the 
        Resource Owner and possibly other malicious applications with access
        to the Resource Owner's User-Agent. The Authorization Server can also
        authenticate the Client before exchanging the Authorization Code for an
        Access Token. The Authorization Code flow is suitable for Clients that 
        can securely maintain a Client Secret between themselves and the
        Authorization Server whereas the Implicit flow is suitable for Clients
        that cannot.
</p>
<a name="retrieving_code_token"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
How to Get an Authorization Code, Access Token, and ID Token</h3>

<p>In OpenID Connect Standard, the Client sends authorization request 
          to the Authorization Endpoint through the User Agent to obtain the 
          Access Token and ID Token. It MAY obtain them from the Authorization 
          Endpoint or from Token Endpoint utilizing the <tt>
          code</tt> that it obtained from the Authorization Endpoint. 
          The latter is called <a class='info' href='#code_flow'>Code Flow<span> (</span><span class='info'>Authorization Code Flow</span><span>)</span></a> 
          and the former is called <a class='info' href='#implicit_flow'>Implicit Flow<span> (</span><span class='info'>Implicit Flow</span><span>)</span></a>. 
          
</p>
<a name="code_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Authorization Code Flow</h3>

<p>The Authorization Code Flow goes through the following
          steps.
</p>
<p></p>
<ol class="text">
<li>Client prepares an Authorization Request containing the desired
              request parameters.
</li>
<li>Client sends a request to the Authorization Server.
</li>
<li>Authorization Server Authenticates the End-User.
</li>
<li>Authorization Server Obtains the End-User
              Consent/Authorization.
</li>
<li>Authorization Server Sends the End-User back to the Client with
              an Authorization Code.
</li>
<li>Client requests a response using the Authorization Code at the
              <a class='info' href='#token_ep'>Token Endpoint<span> (</span><span class='info'>Token Endpoint</span><span>)</span></a>.
</li>
<li>Client receives a response that contains an Access Token and ID
              Token in the response body.
</li>
<li>Client validates ID Token to get the End-User's
              identifier.
</li>
<li>(OPTIONAL) Client accesses the <a class='info' href='#userinfo_ep'>UserInfo Endpoint<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a>  with the Access
              Token.
</li>
<li>(OPTIONAL) Client receives UserInfo Response.
</li>
</ol><p>Note that in each step, the party that receives a message
          MUST verify it according to the verification rule set in <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<a name="implicit_flow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Implicit Flow</h3>

<p>The Implicit Flow follows the following steps:
</p>
<p></p>
<ol class="text">
<li>Client prepares an Authorization Request containing the desired
              request parameters.
</li>
<li>Client sends a request to the Authorization Server.
</li>
<li>Authorization Server Authenticates the End-User.
</li>
<li>Authorization Server Obtains the End-User
              Consent/Authorization.
</li>
<li>Authorization Server Sends the End-User back to the Client with
              an Access Token and an ID Token if requested.
</li>
<li>Client validates ID Token to get the End-User's
              identifier.
</li>
<li>(OPTIONAL) Client accesses the <a class='info' href='#userinfo_ep'>UserInfo Endpoint<span> (</span><span class='info'>UserInfo Endpoint</span><span>)</span></a>  with the Access
              Token.
</li>
<li>(OPTIONAL) Client receives UserInfo Response.
</li>
</ol><p>Note that in each step, the party that receives a message
          MUST verify it according to the verification rule set in <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<a name="auth_request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Authorization Request</h3>

<p>When the End-User wishes to access a Protected Resource and the
        End-User Authorization has not yet been obtained, the Client
        prepares an Authorization Request to the Authorization Endpoint.
</p>
<p>Authorization Servers MUST require the use of a transport-layer
        security mechanism at the Authorization Endpoint. The Authorization 
        Server MUST support TLS 1.2 <a class='info' href='#RFC5246'>RFC 5246<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246]
	and/or TLS 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>
	and MAY support other transport-layer 
        mechanisms with equivalent security.
</p>
<p>Authorization Servers MUST support the use of the HTTP "GET" and 
        "POST" methods defined in <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] at the
        Authorization Endpoint. 
</p>
<p>Clients MAY use the HTTP "GET" or "POST" method to send the
        Authorization Request to the Authorization Server. If using the HTTP
        "GET" method, the request parameters are serialized using URI <a class='info' href='#qss'>query string serialization<span> (</span><span class='info'>Query String Serialization</span><span>)</span></a>. If using the HTTP "POST"
        method, the request parameters are serialized using 
        <a class='info' href='#form_serialization'>form serialization<span> (</span><span class='info'>Form Serialization</span><span>)</span></a>.
</p>
<a name="rf_prep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Client Prepares an Authorization Request</h3>

<p>The Client prepares an Authorization Request to the Authorization
          Endpoint with the request parameters using the HTTP "GET" or "POST"
          method. The scheme used in the Authorization URL MUST be HTTPS.
	  The Client MUST perform a TLS/SSL server certificate check, per
	  <a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125].
	  
</p>
<p>The required Authorization Request parameters are as follows:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>response_type</dt>
<dd>An OAuth 2.0 registered
              response type that determines how the Authorization
              Response is returned to the Client.  As described in
              <a class='info' href='#OAuth.Responses'>OAuth 2.0 Multiple Response Type Encoding Practices<span> (</span><span class='info'>de Medeiros, B., Scurtescu, M., and P. Tarjan, &ldquo;OAuth 2.0 Multiple Response Type Encoding Practices,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OAuth.Responses],
              the following registered values are supported:
                
<ul class="text">
<li><tt>code</tt>
</li>
<li><tt>code id_token</tt>
</li>
<li><tt>id_token</tt>
</li>
<li><tt>token</tt>
</li>
<li><tt>token id_token</tt>
</li>
<li><tt>code token</tt>
</li>
<li><tt>code token id_token</tt>
</li>
</ul>
</dd>
<dt>client_id</dt>
<dd>The Client identifier.
</dd>
<dt>scope</dt>
<dd>It MUST include <tt>openid</tt>
              as one of the space delimited ASCII strings. Other values that MAY be included are
              <tt>profile</tt>,
	      <tt>email</tt>,
              <tt>address</tt>, and
	      <tt>phone</tt>.
              The values specify an additive list of Claims that are returned
              by the UserInfo Endpoint.
</dd>
<dt>redirect_uri</dt>
<dd>A redirection URI where the response
              will be sent. The Scheme, Host, Path, and Query Parameter segments of this URI MUST 
              match one of the <tt>redirect_uris</tt> registered 
              for the <tt>client_id</tt> in the <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client 
	      Registration 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration] specification.
</dd>
</dl></blockquote>

<p>The request MAY contain the following OPTIONAL and sometimes REQUIRED parameters:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>nonce</dt>
<dd>A string value used to associate a Client session 
              with an ID Token, and to mitigate replay attacks. 
              The value is passed through unmodified from the Authorization Request to the ID Token.
               Use of the nonce is REQUIRED when using the implicit flow
	           and OPTIONAL when using the code flow.
</dd>
<dt>state</dt>
<dd>An opaque value used to maintain state
              between the request and the callback.
</dd>
<dt>request</dt>
<dd>An OpenID Request Object value.
</dd>
<dt>request_uri</dt>
<dd>A URL that points to an OpenID
              Request Object.
</dd>
<dt>display</dt>
<dd>An ASCII string value that specifies
              how the Authorization Server displays the authentication page to
              the End-User. Refer to
	      Section 2.1.2 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages]
	      for more information.
</dd>
<dt>prompt</dt>
<dd>A space delimited list of ASCII strings
	      that can contain the values
              <tt>login</tt>, <tt>consent</tt>,
              <tt>select_account</tt>, and
	      <tt>none</tt>. Refer to <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages] for
              more information.
</dd>
<dt>id_token</dt>
<dd>An ID Token
              passed to the Authorization server as a hint. Refer to <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages] for
              more information.
</dd>
</dl></blockquote>

<p>There are three methods to construct and send the request to the 
          Authorization Endpoint: 
          </p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Simple Request Method
</dd>
<dt>b.</dt>
<dd>Request Parameter Method
</dd>
<dt>c.</dt>
<dd>Request File Method
</dd>
</dl></blockquote>

<p>The Simple Request Method is used in simple cases when default
          UserInfo and ID Token Claims are desired.
</p>
<p>The Request Parameter Method is used by sending an OpenID Request
          Object when the Client desires to retrieve a different set of
          UserInfo and ID Token Claims. The request parameter method also
          allows requests to be signed or encrypted. 
</p>
<p>The Request File Method works similarly to the Request Parameter
          Method but differs in that it sends an URL as a reference to the
          OpenID Request Object. It enables large requests to be sent
          securely and compactly even on user agents with limited capabilities.
          Clients MAY use the Request File Method to minimize the request
          size.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.1"></a><h3>2.3.1.1.&nbsp;
Simple Request Method</h3>

<p>The Client prepares an Authorization Request to the
            Authorization Endpoint using the appropriate parameters. If using 
            the HTTP "GET" method, the request parameters are serialized using
            URI <a class='info' href='#qss'>query string serialization<span> (</span><span class='info'>Query String Serialization</span><span>)</span></a>. If using
            the HTTP "POST" method, the request parameters are serialized using 
            <a class='info' href='#form_serialization'>form serialization<span> (</span><span class='info'>Form Serialization</span><span>)</span></a>.
</p>
<p>
<p>The following is a non-normative example of an
                Authorization Request URL
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj</pre></div>

<a name="norm_req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.1.1"></a><h3>2.3.1.1.1.&nbsp;
Client sends a request to the Authorization Server</h3>

<p>Having constructed the Authorization Request, the Client sends it
              to the HTTPS End-User Authorization Endpoint. This
              MAY happen via HTTPS redirect, hyperlinking, or any other means
              of directing the User-Agent to the Authorization Endpoint URL.
</p>
<p>Following is a non-normative example using HTTP redirect
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize?
response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj</pre></div>
<a name="req_param_method"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.2"></a><h3>2.3.1.2.&nbsp;
Request Parameter Method</h3>

<p>The Client prepares an Authorization Request to the
            Authorization Endpoint using the appropriate HTTP parameter
            serialization. The Client SHOULD construct the request using the
            HTTP "POST" method, but MAY use the HTTP "GET" method.
</p>
<p>The Authorization Request MUST include the 
            <tt>request</tt> parameter defined in <a class='info' href='#rf_prep'>Section&nbsp;2.3.1<span> (</span><span class='info'>Client Prepares an Authorization Request</span><span>)</span></a>.
	    The Authorization Request MUST NOT include the 
            <tt>request_uri</tt> parameter.
</p>
<p>The <tt>request</tt> parameter is
	      an OpenID Request Object
              that contains the Authorization Request and also
              specifies the contents of
              the responses to be returned from the UserInfo 
              Endpoint. The OpenID Request Object MAY be signed or signed and encrypted via
              <a class='info' href='#JWS'>JWS<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Signature,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWS] and <a class='info' href='#JWE'>JWE<span> (</span><span class='info'>Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;JSON Web Encryption (JWE),&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWE]
              respectively, thereby providing authentication, integrity,
              non-repudiation and/or confidentiality.
</p>
<p>
<p>The following is a non-normative example of an
                OpenID Request Object before base64url encoding and signing:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>{
 "response_type": "code id_token",
 "client_id": "s6BhdRkqt3",
 "redirect_uri": "https://client.example.org/cb",
 "scope": "openid profile",
 "state": "af0ifjsldkj",
 "nonce": "n-0S6_WzA2Mj",
 "userinfo":
   {
     "claims":
       {
         "name": {"essential": true},
         "nickname": null,
         "email": {"essential": true},
         "email_verified": {"essential": true},
         "picture": null
       }
   },
 "id_token":
   {
     "max_age": 86400,
     "claims:{"acr": {"values":["2"]}}
   }
}</pre></div> 
<p>The following is a non-normative example of
		an OpenID Request Object before base64url encoding and signing
		(with line wraps within the values for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>algorithm = RS256

JSON Encoded Header =  {"alg":"RS256"}
JSON Encoded Payload =
    {
     "response_type":"code id_token",
     "client_id":"s6BhdRkqt3",
     "redirect_uri":"https://client.example.org/cb",
     "scope":"openid profile",
     "state":"af0ifjsldkj",
     "nonce":"n-0S6_WzA2Mj",
     "userinfo":{
       "claims":{
         "name":{"essential":true},
         "nickname":null,"email":{"essential":true},
         "email_verified":{"essential":true},
         "picture":null
        }
      },
     "id_token":{
       "max_age":86400,
       "claims":{
         "acr":{"values":["2"]}
        }
      }
    }
OpenID Request Object =
    eyJhbGciOiJSUzI1NiJ9.eyJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiIs
    ImNsaWVudF9pZCI6InM2QmhkUmtxdDMiLCJyZWRpcmVjdF91cmkiOiJodHRwczpcL
    1wvY2xpZW50LmV4YW1wbGUuY29tXC9jYiIsInNjb3BlIjoib3BlbmlkIHByb2ZpbG
    UiLCJzdGF0ZSI6ImFmMGlmanNsZGtqIiwibm9uY2UiOiJuLTBTNl9XekEyTWoiLCJ
    1c2VyaW5mbyI6eyJjbGFpbXMiOnsibmFtZSI6eyJlc3NlbnRpYWwiOnRydWV9LCJu
    aWNrbmFtZSI6bnVsbCwiZW1haWwiOnsiZXNzZW50aWFsIjp0cnVlfSwiZW1haWxfd
    mVyaWZpZWQiOnsiZXNzZW50aWFsIjp0cnVlfSwicGljdHVyZSI6bnVsbH19LCJpZF
    90b2tlbiI6eyJtYXhfYWdlIjo4NjQwMCwiY2xhaW1zIjp7ImFjciI6eyJ2YWx1ZXM
    iOlsiMiJdfX19fQ.krAJHvc-vo5ntIc5suj2u3gU75nZ1ICcidLEw8OCNyOlTR4Gk
    6etZDr5lozMFzhDSXAJ5TxhfUJLsp8VSum8spnmbGaqKr4bEWTirUDGE3TsJCHRQZ
    LzwuAYlLcS-ZaHVk9ue0oB7q_GeGTAIDHBncJP1x1j-MPvNxWbYXQ4wo9O6Y8Qnby
    OrrLl5LHRMrvlLFnc0uqt5QKHqcQa6l9wYQjjWJXoZirsWdJ_wmSsfbQCWMRtA6JN
    bV0q0gImbOGno75GxFKNkguW5JBU4Vj5gEafz2EPSxVsRNWf6MtFvXqOLSZMqoKK4
    0b2akbj0kGdZ8aPPSMoywaGclKlIHh0PQ

The following is the RSA public key information that can be used
to verify the OpenID Request Object signature in the above example.
The values are an array of hexadecimal digits in big endian format.

modulus:
[
 ce,11,16,4c,12,55,4d,f7,14,7a,a9,cc,cc,e4,05,30,
 21,15,41,63,b2,39,46,70,3f,c2,eb,05,68,7c,f2,d2,
 ab,67,23,c6,0a,f0,64,4c,3a,7e,13,60,73,c8,73,10,
 57,8a,4a,e7,55,32,b3,66,0e,c3,32,fd,b1,ee,53,1c,
 35,8c,75,af,6b,b6,c0,89,55,c8,f5,57,b5,9a,13,bc,
 0f,82,5f,a4,20,87,56,59,fe,28,da,0e,99,b3,33,b2,
 fc,5a,78,ab,49,c6,dc,e4,ed,0d,10,a4,06,ed,a2,10,
 fd,b5,8f,cd,a9,45,24,6b,90,20,71,9f,36,82,85,f9,
 40,ec,a6,5b,23,59,ff,ca,12,ad,c7,20,3b,15,d0,38,
 f3,42,da,49,56,72,28,0a,6f,ac,a8,98,86,87,00,09,
 2c,1f,d3,2e,82,43,ec,24,12,2e,a6,55,74,49,b7,56,
 81,4b,2c,25,2d,80,34,f2,88,e9,e6,19,19,43,7f,5e,
 08,cd,a4,d4,47,57,76,16,da,af,df,7c,43,d3,d9,4f,
 05,c0,d5,c7,ef,b8,64,d9,6c,35,b1,10,a2,e3,30,a5,
 6e,2a,b4,f5,62,fb,3e,d8,d4,d7,85,90,16,d4,a8,c5,
 4b,fd,d4,c0,b9,03,93,ec,38,75,53,7e,c7,9b,43,9f
]

exponent: [01,00,01]

</pre></div>

<p>
<p>The following is a non-normative example of an
                Authorization Request with the OpenID Request Method
                (with line wraps within the values for display purposes only):
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/authorize?
response_type=code%02id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;state=af0ifjsldkj
&amp;nonce=n-0S6_WzA2Mj
&amp;request=eyJhbGciOiJSUzI1NiJ9.eyJyZXNwb25zZV90eXBlIjoiY29kZSBpZF
90b2tlbiIsImNsaWVudF9pZCI6InM2QmhkUmtxdDMiLCJyZWRpcmVjdF91cmkiOi
JodHRwczpcL1wvY2xpZW50LmV4YW1wbGUuY29tXC9jYiIsInNjb3BlIjoib3Blbm
lkIHByb2ZpbGUiLCJzdGF0ZSI6ImFmMGlmanNsZGtqIiwibm9uY2UiOiJuLTBTNl
9XekEyTWoiLCJ1c2VyaW5mbyI6eyJjbGFpbXMiOnsibmFtZSI6eyJlc3NlbnRpYW
wiOnRydWV9LCJuaWNrbmFtZSI6bnVsbCwiZW1haWwiOnsiZXNzZW50aWFsIjp0cn
VlfSwiZW1haWxfdmVyaWZpZWQiOnsiZXNzZW50aWFsIjp0cnVlfSwicGljdHVyZS
I6bnVsbH19LCJpZF90b2tlbiI6eyJtYXhfYWdlIjo4NjQwMCwiY2xhaW1zIjp7Im
FjciI6eyJ2YWx1ZXMiOlsiMiJdfX19fQ.krAJHvc-vo5ntIc5suj2u3gU75nZ1IC
cidLEw8OCNyOlTR4Gk6etZDr5lozMFzhDSXAJ5TxhfUJLsp8VSum8spnmbGaqKr4
bEWTirUDGE3TsJCHRQZLzwuAYlLcS-ZaHVk9ue0oB7q_GeGTAIDHBncJP1x1j-MP
vNxWbYXQ4wo9O6Y8QnbyOrrLl5LHRMrvlLFnc0uqt5QKHqcQa6l9wYQjjWJXoZir
sWdJ_wmSsfbQCWMRtA6JNbV0q0gImbOGno75GxFKNkguW5JBU4Vj5gEafz2EPSxV
sRNWf6MtFvXqOLSZMqoKK40b2akbj0kGdZ8aPPSMoywaGclKlIHh0PQ</pre></div>

<a name="request_req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.2.1"></a><h3>2.3.1.2.1.&nbsp;
Client Sends a Request to the Authorization Server</h3>

<p>Having constructed the Authorization Request, the Client sends
              it to the HTTPS Authorization Endpoint. This
              MAY happen via HTTPS redirect, hyperlinking, or any other means
              of directing the User-Agent to the Authorization Endpoint.
</p>
<p>Following is a non-normative example using HTTP redirect
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize?
response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;state=af0ifjsldkj
&amp;nonce=n-0S6_WzA2Mj
&amp;request=eyJhbGciOiJSUzI1NiJ9.eyJyZXNwb25zZV90eXBlIjoiY29kZSBpZF
90b2tlbiIsImNsaWVudF9pZCI6InM2QmhkUmtxdDMiLCJyZWRpcmVjdF91cmkiOi
JodHRwczpcL1wvY2xpZW50LmV4YW1wbGUuY29tXC9jYiIsInNjb3BlIjoib3Blbm
lkIHByb2ZpbGUiLCJzdGF0ZSI6ImFmMGlmanNsZGtqIiwibm9uY2UiOiJuLTBTNl
9XekEyTWoiLCJ1c2VyaW5mbyI6eyJjbGFpbXMiOnsibmFtZSI6eyJlc3NlbnRpYW
wiOnRydWV9LCJuaWNrbmFtZSI6bnVsbCwiZW1haWwiOnsiZXNzZW50aWFsIjp0cn
VlfSwiZW1haWxfdmVyaWZpZWQiOnsiZXNzZW50aWFsIjp0cnVlfSwicGljdHVyZS
I6bnVsbH19LCJpZF90b2tlbiI6eyJtYXhfYWdlIjo4NjQwMCwiY2xhaW1zIjp7Im
FjciI6eyJ2YWx1ZXMiOlsiMiJdfX19fQ.krAJHvc-vo5ntIc5suj2u3gU75nZ1IC
cidLEw8OCNyOlTR4Gk6etZDr5lozMFzhDSXAJ5TxhfUJLsp8VSum8spnmbGaqKr4
bEWTirUDGE3TsJCHRQZLzwuAYlLcS-ZaHVk9ue0oB7q_GeGTAIDHBncJP1x1j-MP
vNxWbYXQ4wo9O6Y8QnbyOrrLl5LHRMrvlLFnc0uqt5QKHqcQa6l9wYQjjWJXoZir
sWdJ_wmSsfbQCWMRtA6JNbV0q0gImbOGno75GxFKNkguW5JBU4Vj5gEafz2EPSxV
sRNWf6MtFvXqOLSZMqoKK40b2akbj0kGdZ8aPPSMoywaGclKlIHh0PQ</pre></div>
<a name="Request_File_Method"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.3"></a><h3>2.3.1.3.&nbsp;
Request File Method</h3>

<p>The Request File Method differs from the other methods in that
            it uses a Request File that contains an
            OpenID Request Object. It then sends the Request File URL as
            part of the Authorization Request.
</p>
<p>The Client prepares an Authorization Request using the desired 
            HTTP "GET" or "POST" method. The Client SHOULD use the HTTP "GET"
            method, but MAY use the HTTP "POST" method.
	    The scheme used in the Authorization URL MUST be HTTPS.
	    The Client MUST perform a TLS/SSL server certificate check, per
	    <a class='info' href='#RFC6125'>RFC 6125<span> (</span><span class='info'>Saint-Andre, P. and J. Hodges, &ldquo;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),&rdquo; March&nbsp;2011.</span><span>)</span></a> [RFC6125].
	    
</p>
<p> The Authorization Request MUST NOT include the 
            <tt>request</tt> parameter. The Authorization
            Request MUST include the <tt>request_uri</tt>
            parameter. The contents of the target of the URL must be an
            OpenID Request Object. The scheme used in the 
            <tt>request_uri</tt> value MUST be HTTPS, 
            unless the target OpenID Request Object is signed in a way that is verifiable by the 
            Authorization Server.
            The <tt>request_uri</tt> value MUST be reachable by the
            Authorization Server, and SHOULD be reachable by the Client.
            
</p>
<p>
<p>Following is a non-normative example of a Request File
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>eyJhbGciOiJSUzI1NiJ9.eyJyZXNwb25zZV90eXBlIjoiY29kZSBpZF90b2tlbiI
sImNsaWVudF9pZCI6InM2QmhkUmtxdDMiLCJyZWRpcmVjdF91cmkiOiJodHRwczp
cL1wvY2xpZW50LmV4YW1wbGUuY29tXC9jYiIsInNjb3BlIjoib3BlbmlkIHByb2Z
pbGUiLCJzdGF0ZSI6ImFmMGlmanNsZGtqIiwibm9uY2UiOiJuLTBTNl9XekEyTWo
iLCJ1c2VyaW5mbyI6eyJjbGFpbXMiOnsibmFtZSI6eyJlc3NlbnRpYWwiOnRydWV
9LCJuaWNrbmFtZSI6bnVsbCwiZW1haWwiOnsiZXNzZW50aWFsIjp0cnVlfSwiZW1
haWxfdmVyaWZpZWQiOnsiZXNzZW50aWFsIjp0cnVlfSwicGljdHVyZSI6bnVsbH1
9LCJpZF90b2tlbiI6eyJtYXhfYWdlIjo4NjQwMCwiY2xhaW1zIjp7ImFjciI6eyJ
2YWx1ZXMiOlsiMiJdfX19fQ.krAJHvc-vo5ntIc5suj2u3gU75nZ1ICcidLEw8OC
NyOlTR4Gk6etZDr5lozMFzhDSXAJ5TxhfUJLsp8VSum8spnmbGaqKr4bEWTirUDG
E3TsJCHRQZLzwuAYlLcS-ZaHVk9ue0oB7q_GeGTAIDHBncJP1x1j-MPvNxWbYXQ4
wo9O6Y8QnbyOrrLl5LHRMrvlLFnc0uqt5QKHqcQa6l9wYQjjWJXoZirsWdJ_wmSs
fbQCWMRtA6JNbV0q0gImbOGno75GxFKNkguW5JBU4Vj5gEafz2EPSxVsRNWf6MtF
vXqOLSZMqoKK40b2akbj0kGdZ8aPPSMoywaGclKlIHh0PQ</pre></div>

<a name="rurl_create"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.3.1"></a><h3>2.3.1.3.1.&nbsp;
Client Generates the URL of the Request File</h3>

<p>The Client then stores the Request File either locally or remotely.
               This is the Request URI, <tt>"request_uri"</tt>. 
               The URI MAY be appended with the base64url encoded SHA-256 [FIPS180-2] hash of the file 
               after "#" so that the Authorization Server can detect whether the file 
               has changed. 
</p>
<p>It should be noted that if the Request File includes user's attribute 
              values, it MUST NOT be revealed to anybody but the Authorization Server. 
              As such, the <tt>"request_uri"</tt> MUST have
              appropriate entropy for its lifetime, 
              and must be removed after successful authentication or a reasonable timeout.
              
</p>
<p>The Client then records the Request File either locally or
              remotely and obtains the Request File URI, <tt>"request_uri"</tt>.
              
</p>
<p>Following is a non-normative example
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://client.example.org/rf.txt
#yhjJGgQ3UwE2Lm2i_wZNb5QxQ6XRnfzqYOretJMFTQI</pre></div>
<a name="art_req"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.3.2"></a><h3>2.3.1.3.2.&nbsp;
Client Sends a Request to Authorization Server via HTTPS Redirect</h3>

<p>The Client sends the Authorization Request to the Authorization
              Endpoint.
</p>
<p>The entire URL MUST NOT exceed 512 bytes.
</p>
<p>Following is a non-normative example
		(with line wraps for display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 302 Found
Location: https://server.example.com/authorize
?response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;request_uri=https%3A%2F%2Fclient.example.org%2Frf.txt
%23959w6lFunlMyjSaxmW0FtqvkRsmCaAIWuwl6QKeY89g
&amp;state=af0ifjsldkj&amp;nonce=n-0S6_WzA2Mj&amp;scope=openid</pre></div>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1.3.3"></a><h3>2.3.1.3.3.&nbsp;
Authorization Server Fetches the Request File</h3>

<p>Upon receipt of the Request, the Authorization Server MUST
              send a GET request to the <tt>request_uri</tt>
              to retrieve the content unless it is already cached and parse it
              to recreate the Authorization Request parameters.
</p>
<p>Note that the RP SHOULD use a unique URI for each
              request utilizing distinct parameters, or otherwise
              prevent the Authorization Server from caching the <tt>request_uri</tt>.
              
</p>
<p>Following is a non-normative example of this fetch
                process:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>GET /rf.txt HTTP/1.1
Host: client.example.org</pre></div>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Authorization Server Validates Request Object</h3>

<p>The Authorization Server validates the request according to 
	  Section 5.1 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.3"></a><h3>2.3.3.&nbsp;
Authorization Server Authenticates the End-User</h3>

<p>The Authorization Server validates the request to ensure all
          required parameters are present and valid. If the request is valid,
          the Authorization Server MUST authenticate the End-User. The way in
          which the Authorization Server authenticates the End-User (e.g.
          username and password login, session cookies) is beyond the scope of
          this specification. An authentication user interface MAY be displayed
          by the Authorization Server depending on the authentication method
          used.
</p>
<p>The Authorization Server MUST attempt to authenticate the 
          End-User in the following cases:
          </p>
<ul class="text">
<li>The End-User is not already authenticated by the Authorization
                Server.
</li>
<li>The Authorization Request contains the <tt>prompt</tt> parameter with the value
		<tt>login</tt>. The
                Authorization Server MUST reauthenticate the End-User
                even if the End-User is already authenticated.
</li>
</ul>

<p>The Authorization Server MUST NOT attempt authentication
          in the following cases:
          </p>
<ul class="text">
<li>The Authorization Request contains the <tt>"prompt"</tt> parameter with the value
		<tt>none</tt>.
                The Authorization Server MUST return an error if the End-User is 
                unauthenticated.
</li>
</ul>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.4"></a><h3>2.3.4.&nbsp;
Authorization Server Obtains the End-User Consent/Authorization</h3>

<p>Once the End-User is authenticated, the Authorization Server MUST
          obtain an authorization decision. This MAY be done by presenting the
          End-User with a dialogue that allows the End-User to recognize what he is
          consenting to and obtain his consent or by establishing consent via
          other means (for example, via previous administrative consent).
</p>
<p>The Authorization Server MUST attempt to request authorization
          from the End-User in the following cases:
          </p>
<ul class="text">
<li>The End-User has not pre-authorized the Client for the
                authorization request.
</li>
<li>The Authorization Request contains the <tt>prompt</tt> parameter with the value
		<tt>consent</tt>. The
                Authorization Server MUST request End-User authorization even if the
                End-User has previously authorized the Client.
</li>
</ul>

<p>The Authorization Server MUST NOT request End-User authorization in the
          following cases:
          </p>
<ul class="text">
<li>The Authorization Request contains the <tt>"prompt"</tt> parameter with the value
		<tt>none</tt>.
                The Authorization Server MUST return an error if the End-User has
                not pre-authorized the Client.
</li>
</ul>

<a name="art_res"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.5"></a><h3>2.3.5.&nbsp;
Authorization Server Sends the End-User Back to the Client</h3>

<p>Once the authorization is determined, the Authorization Server
          returns a successful or error response.
</p>
<a name="art_res_ok"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.5.1"></a><h3>2.3.5.1.&nbsp;
End-User Grants Authorization</h3>

<p>If the Resource Owner grants the access request, the
            Authorization Server issues an Authorization Response 
            as described in
	    Section 2.1.3 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages] 
            to the Client by adding the response parameters to <tt>redirect_uri</tt> specified in the Authorization
            Request using the "application/x-www-form-urlencoded" format.
</p>
<p>
              Note that if the <tt>response_type</tt> parameter in the 
              Authorization Request includes the string value 
              <tt>token</tt> or <tt>id_token</tt>, 
              all response parameters SHOULD be added to the fragment 
              component of the redirection URI. Otherwise, the response parameters 
              are added to the query component of the redirection URI.
            
</p>
<p>
              The following are non-normative examples of requests with 
              differing <tt>response_type</tt> values and their responses 
              (with line wraps for display purposes only):
            
</p>
<p>Case 1: response_type=code
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=code
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj


HTTP/1.1 302 Found
Location: https://client.example.org/cb?
code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
&amp;state=af0ifjsldkj</pre></div>
<p>Case 2: response_type=token id_token
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=token%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj


HTTP/1.1 302 Found
Location: https://client.example.org/cb#
access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
&amp;token_type=Bearer
&amp;id_token=eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9zZXJ2ZXIuZ
XhhbXBsZS5jb20iLCJ1c2VyX2lkIjoiMjQ4Mjg5NzYxMDAxIiwiYXVkIjoiczZCa
GRSa3F0MyIsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiZXhwIjoxMzExMjgxOTcwL
CJpYXQiOjEzMTEyODA5NzB9.RgXxzppVvn1EjUiV3LIZ19SyhdyREe_2jJjW5EC8
XjNuJfe7Dte8YxRXxssJ67N8MT9mvOI3HOHm4whNx5FCyemyCGyTLHODCeAr_id0
29-4JP0KWySoan1jmT7vbGHhu89-l9MTdaEvu7pNZO7DHGwqnMWRe8hdG7jUES4w
4ReQTygKwXVVOaiGoeUrv6cZdbyOnpGlRlHaiOsv_xMunNVJtn5dLz-0zZwVftKV
pFuc1pGaVsyZsOtkT32E4c6MDHeCvIDlR5ESC0ct8BLvGJDB5954MjCR4_X2GAEH
onKw4NF8wTmUFvhslYXmjRNFs21Byjn3jNb7lSa3MBfVsw
&amp;state=af0ifjsldkj</pre></div>
<p>Case 3: response_type=code id_token
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj


HTTP/1.1 302 Found
Location: https://client.example.org/cb#
code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
&amp;id_token=eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9zZXJ2ZXIuZ
XhhbXBsZS5jb20iLCJ1c2VyX2lkIjoiMjQ4Mjg5NzYxMDAxIiwiYXVkIjoiczZCa
GRSa3F0MyIsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiZXhwIjoxMzExMjgxOTcwL
CJpYXQiOjEzMTEyODA5NzB9.RgXxzppVvn1EjUiV3LIZ19SyhdyREe_2jJjW5EC8
XjNuJfe7Dte8YxRXxssJ67N8MT9mvOI3HOHm4whNx5FCyemyCGyTLHODCeAr_id0
29-4JP0KWySoan1jmT7vbGHhu89-l9MTdaEvu7pNZO7DHGwqnMWRe8hdG7jUES4w
4ReQTygKwXVVOaiGoeUrv6cZdbyOnpGlRlHaiOsv_xMunNVJtn5dLz-0zZwVftKV
pFuc1pGaVsyZsOtkT32E4c6MDHeCvIDlR5ESC0ct8BLvGJDB5954MjCR4_X2GAEH
onKw4NF8wTmUFvhslYXmjRNFs21Byjn3jNb7lSa3MBfVsw
&amp;state=af0ifjsldkj</pre></div>
<p>Case 4: response_type=token code
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=token%20code
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj


HTTP/1.1 302 Found
Location: https://client.example.org/cb#
code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
&amp;access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
&amp;token_type=Bearer
&amp;state=af0ifjsldkj</pre></div>
<p>Case 5: response_type=token code id_token
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>https://server.example.com/op/authorize?
response_type=token%20code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
&amp;scope=openid
&amp;nonce=n-0S6_WzA2Mj
&amp;state=af0ifjsldkj


HTTP/1.1 302 Found
Location: https://client.example.org/cb#
code=Qcb0Orv1zh30vL1MPRsbm-diHiMwcLyZvn1arpZv-Jxf_11jnpEX3Tgfvk
&amp;access_token=jHkWEdUXMU1BwAsC4vtUsZwnNvTIxEl0z9K3vx5KF0Y
&amp;token_type=Bearer
&amp;id_token=eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9zZXJ2ZXIuZ
XhhbXBsZS5jb20iLCJ1c2VyX2lkIjoiMjQ4Mjg5NzYxMDAxIiwiYXVkIjoiczZCa
GRSa3F0MyIsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiZXhwIjoxMzExMjgxOTcwL
CJpYXQiOjEzMTEyODA5NzB9.RgXxzppVvn1EjUiV3LIZ19SyhdyREe_2jJjW5EC8
XjNuJfe7Dte8YxRXxssJ67N8MT9mvOI3HOHm4whNx5FCyemyCGyTLHODCeAr_id0
29-4JP0KWySoan1jmT7vbGHhu89-l9MTdaEvu7pNZO7DHGwqnMWRe8hdG7jUES4w
4ReQTygKwXVVOaiGoeUrv6cZdbyOnpGlRlHaiOsv_xMunNVJtn5dLz-0zZwVftKV
pFuc1pGaVsyZsOtkT32E4c6MDHeCvIDlR5ESC0ct8BLvGJDB5954MjCR4_X2GAEH
onKw4NF8wTmUFvhslYXmjRNFs21Byjn3jNb7lSa3MBfVsw
&amp;state=af0ifjsldkj
</pre></div>
<p>Public Key Information used to verify the ID Token
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>The following is the RSA public key information that can be used
to verify the ID Token signatures in the above examples.
The values are an array of hexadecimal digits in big endian format.

modulus:
[
 ce,11,16,4c,12,55,4d,f7,14,7a,a9,cc,cc,e4,05,30,
 21,15,41,63,b2,39,46,70,3f,c2,eb,05,68,7c,f2,d2,
 ab,67,23,c6,0a,f0,64,4c,3a,7e,13,60,73,c8,73,10,
 57,8a,4a,e7,55,32,b3,66,0e,c3,32,fd,b1,ee,53,1c,
 35,8c,75,af,6b,b6,c0,89,55,c8,f5,57,b5,9a,13,bc,
 0f,82,5f,a4,20,87,56,59,fe,28,da,0e,99,b3,33,b2,
 fc,5a,78,ab,49,c6,dc,e4,ed,0d,10,a4,06,ed,a2,10,
 fd,b5,8f,cd,a9,45,24,6b,90,20,71,9f,36,82,85,f9,
 40,ec,a6,5b,23,59,ff,ca,12,ad,c7,20,3b,15,d0,38,
 f3,42,da,49,56,72,28,0a,6f,ac,a8,98,86,87,00,09,
 2c,1f,d3,2e,82,43,ec,24,12,2e,a6,55,74,49,b7,56,
 81,4b,2c,25,2d,80,34,f2,88,e9,e6,19,19,43,7f,5e,
 08,cd,a4,d4,47,57,76,16,da,af,df,7c,43,d3,d9,4f,
 05,c0,d5,c7,ef,b8,64,d9,6c,35,b1,10,a2,e3,30,a5,
 6e,2a,b4,f5,62,fb,3e,d8,d4,d7,85,90,16,d4,a8,c5,
 4b,fd,d4,c0,b9,03,93,ec,38,75,53,7e,c7,9b,43,9f
]

exponent: [01,00,01]</pre></div>
<a name="authz_error"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.5.2"></a><h3>2.3.5.2.&nbsp;
End-User Denies Authorization or Invalid Request</h3>

<p>If the End-User denies the authorization or the user authentication
            fails, the Authorization Server MUST return the error authorization 
            response as defined in
	    Section 2.1.4 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
	    The Authorization Server returns the Client to
            the redirection URI specified in the Authorization Request
            with the appropriate error parameters. No
            other parameters SHOULD be returned.
</p>
<p>The error response parameters are the following:
              </p>
<blockquote class="text"><dl>
<dt>error</dt>
<dd>REQUIRED. The error code.
</dd>
<dt>error_description</dt>
<dd>OPTIONAL. A human-readable UTF-8
                encoded text description of the error.
</dd>
<dt>error_uri</dt>
<dd>OPTIONAL. A URI to a web page that
                includes additional information about the error.
</dd>
<dt>state</dt>
<dd>REQUIRED if the Authorization Request
                included the <tt>state</tt> parameter. Set
                to the exact value received from the Client.
</dd>
</dl></blockquote>

<p>If the <tt>response_type</tt> parameter in the
            Authorization Request includes the string value
	    <tt>token</tt> or <tt>id_token</tt>,
	    all error response parameters SHOULD be added to the 
            fragment component of the redirection URI. Otherwise, the response
            parameters are added to the query component of the redirection URI.
            
</p>
<p>
<p>The following is a non-normative example
		(with line wraps after the second line for the display purposes only):
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 302 Found
Location: https://client.example.org/cb?
error=invalid_request
&amp;error_description=the%20request%20is%20not%20valid%20or%20malformed
&amp;state=af0ifjsldkj</pre></div>

<a name="token_ep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Token Endpoint</h3>

<p>The Token Endpoint handles requests for retrieving and refreshing
      Access Tokens as well as ID Token and other variables.
</p>
<p>Clients MUST use the HTTP "POST" method to make requests to the Token
      Endpoint. Request parameters are added using
      <a class='info' href='#form_serialization'>form serialization<span> (</span><span class='info'>Form Serialization</span><span>)</span></a>.
</p>
<p>Clients MAY provide authentication parameters in the request to the
      Token Endpoint as described in
      Section 2.2.1 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>Authorization Servers MUST support the use of the HTTP "POST"
      method defined in <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] at the
      Token Endpoint.
</p>
<p>Authorization Servers MUST require the use of a transport-layer
      security mechanism. The Authorization Server MUST support TLS 1.2
      <a class='info' href='#RFC5246'>RFC 5246<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] and/or TLS 1.0
      <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a> and MAY support
      other transport-layer mechanisms with equivalent security.
</p>
<p>All Token Endpoint responses that contain tokens, secrets, or other
      sensitive information MUST include the following HTTP response header
      fields and values:
</p><br /><hr class="insert" />
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Header Name</th><th align="left">Header Value</th></tr>
<tr>
<td align="left">Cache-Control</td>
<td align="left">no-store</td>
</tr>
<tr>
<td align="left">Pragma</td>
<td align="left">no-cache</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;HTTP Response Headers and Values&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Requesting an Access Token</h3>

<p>To retrieve an Access Token, a Client MUST have an Authorization
        Code obtained via the method as described in <a class='info' href='#code_flow'>Authorization Code Flow<span> (</span><span class='info'>Authorization Code Flow</span><span>)</span></a>.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Access Token Request</h3>

<p>To obtain an Access Token, Refresh Token or ID Token, the Client MUST
          authenticate to the Token Endpoint using the authentication method
	  registered for its <tt>client_id</tt>, as documented in
	  Section 2.2.1 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
          The Client sends the parameters via HTTPS POST to the Token Endpoint using
          <a class='info' href='#form_serialization'>form serialization<span> (</span><span class='info'>Form Serialization</span><span>)</span></a> as 
          specified in Section 4.1.3 of 
          <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<p>The following is a non-normative example of an Access Token request:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb</pre></div>
<p>
            The Authorization Server MUST:
          
</p>
<p>
            </p>
<ul class="text">
<li>
                Require client authentication for any Client issued
                client credentials (or with other authentication requirements),
              
</li>
<li>
                Authenticate the Client if client authentication is included and ensure the
                Authorization Code was issued to the authenticated Client,
              
</li>
<li>
                Verify that the Authorization Code is valid, and
              
</li>
<li>
                Ensure that the <tt>redirect_uri</tt> parameter is present if
                the <tt>redirect_uri</tt> parameter was included in the initial
                Authorization Request and that their
                values are identical for the Scheme, Host, Path, and Query Parameter segments.
              
</li>
</ul><p>
          
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
Access Token Response</h3>

<p>Upon receipt of the Token Request, the Authorization Server MUST
          return either a successful response or an error response that corresponds to
          the received Authorization Code.
</p>
<p>A successful response returns the "<tt>application/json</tt>"
	  media type and the response body is the Access Token Response documented in
	  Section 2.2.3 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>Following is a non-normative example of a
	    successful response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache

{
 "access_token": "SlAV32hkKG",
 "token_type": "Bearer",
 "refresh_token": "8xLOxBtZp8",
 "expires_in": 3600,
 "id_token": "eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwOlwvXC9zZXJ2Z
XIuZXhhbXBsZS5jb20iLCJ1c2VyX2lkIjoiMjQ4Mjg5NzYxMDAxIiwiYXVkIjoic
zZCaGRSa3F0MyIsIm5vbmNlIjoibi0wUzZfV3pBMk1qIiwiZXhwIjoxMzExMjgxO
TcwLCJpYXQiOjEzMTEyODA5NzB9.RgXxzppVvn1EjUiV3LIZ19SyhdyREe_2jJjW
5EC8XjNuJfe7Dte8YxRXxssJ67N8MT9mvOI3HOHm4whNx5FCyemyCGyTLHODCeAr
_id029-4JP0KWySoan1jmT7vbGHhu89-l9MTdaEvu7pNZO7DHGwqnMWRe8hdG7jU
ES4w4ReQTygKwXVVOaiGoeUrv6cZdbyOnpGlRlHaiOsv_xMunNVJtn5dLz-0zZwV
ftKVpFuc1pGaVsyZsOtkT32E4c6MDHeCvIDlR5ESC0ct8BLvGJDB5954MjCR4_X2
GAEHonKw4NF8wTmUFvhslYXmjRNFs21Byjn3jNb7lSa3MBfVsw"
}</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
Access Token Error Response</h3>

<p>If the Token Request is invalid or unauthorized, the
	  Authorization Server constructs the response by returning the
	  Token Error Response defined in <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages] in the
	  entity body of the HTTP response using the <tt>application/json</tt>
	  media type with HTTP response code 400.
</p>
<p>Following is a non-normative example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache

{
 "error": "invalid_request"
}</pre></div>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Refreshing an Access Token</h3>

<p>To refresh an Access Token, the Client MUST
          authenticate to the Token Endpoint using the authentication method registered
	  for its <tt>client_id</tt>, as documented in
	  Section 2.2.1 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
	  The Client sends the parameters via HTTPS POST to the Token Endpoint using
          <a class='info' href='#form_serialization'>form serialization<span> (</span><span class='info'>Form Serialization</span><span>)</span></a> as 
          specified in Section 6 of 
          <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0]:
</p>
<p>The Authorization Server MUST verify the validity of the Refresh
          Token.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Refresh Token Response</h3>

<p>Upon receipt of the Refresh Token Request, the Authorization Server MUST
          return either a successful response or an error response that corresponds to
          the received Refresh Token.
</p>
<p>Upon successful verification of the Refresh Token, a successful
          response returns the "<tt>application/json</tt>"
          media type and the response body is the Access Token Response of 
          Section 2.2.3 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages]
	  except that it MUST NOT return an <tt>id_token</tt>.
</p>
<p>Following is a non-normative example of a Refresh
            Token request and response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

client_id=s6BhdRkqt3
&amp;client_secret=some_secret12345
&amp;grant_type=refresh_token
&amp;refresh_token=8xLOxBtZp8
&amp;scope=openid%20profile


HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache

{
 "access_token": "TlBN45jURg",
 "token_type": "Bearer",
 "refresh_token": "9yNOxJtZa5",
 "expires_in": 3600
}</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Refresh Token Error Response</h3>

<p>If the Refresh Token Request is invalid or unauthorized, the
	  Authorization Server returns the 
	  Token Error Response as defined in Section 5.2 of <a class='info' href='#OAuth2.0'>OAuth 2.0<span> (</span><span class='info'>Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Authorization Framework,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth2.0].
</p>
<a name="userinfo_ep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
UserInfo Endpoint</h3>

<p>To obtain the requested Claims about the End-User, the Client
      makes a GET or POST request to the UserInfo Endpoint as in <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>Authorization Servers MUST require the use of a transport-layer
      security mechanism. The Authorization Server MUST support TLS 1.2
      <a class='info' href='#RFC5246'>RFC 5246<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> [RFC5246] and/or TLS 1.0
      <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a> and MAY support
      other transport-layer mechanisms with equivalent security.
</p>
<p>Authorization Servers MUST support the use of the HTTP "GET" and HTTP
      "POST" methods defined in <a class='info' href='#RFC2616'>RFC 2616<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> [RFC2616] at the
      UserInfo Endpoint. 
</p>
<p>Authorization Servers MUST accept Access Tokens as
      <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer].
</p>
<p>Authorization Servers SHOULD support the use of 
      <a class='info' href='#CORS'>Cross Origin Resource Sharing (CORS)<span> (</span><span class='info'>van Kestern, &ldquo;Cross-Origin Resource Sharing,&rdquo; July&nbsp;2010.</span><span>)</span></a> [CORS] and
      or other methods as appropriate to enable Java Script Clients to access the endpoint.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
UserInfo Request</h3>

<p>Client SHOULD send the UserInfo Request defined in
	Section 2.3.1 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages]
        either in HTTP GET or POST request.
</p>
<p>The Access Token obtained
            from an OpenID Connect Authorization Request MUST be sent as a Bearer Token.
            Section 2 of the <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer]
            specification documents the permissible methods of sending the Access Token.
</p>
<p>It is RECOMMENDED that the Client use the authorization header method for all 
            requests using GET.
</p>
<p>The following is a non-normative example:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>GET /userinfo?schema=openid HTTP/1.1
Host: server.example.com
Authorization: Bearer eyJhbGciOiJSUzI1NiJ9.eyJ ... fQ.8Gj_-sj ... _X</pre></div>
<a name="id_res"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
UserInfo Response</h3>

<p>The <tt>user_id</tt> Claim in the UserInfo Endpoint response MUST exactly match the 
        <tt>user_id</tt> Claim in the ID Token, before using additional UserInfo Endpoint Claims.
</p>
<p>Upon receipt of the UserInfo request, the UserInfo Endpoint MUST
        return the JSON Serialization of the UserInfo response as in <a class='info' href='#OpenID.Messages'>OpenID Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages] in the HTTP response
        body. The content-type of the HTTP response MUST be set to <tt>application/json</tt> if the response body is a text
        JSON structure. If the JSON response is
        signed or encrypted, then the
        content-type MUST be set to <tt>application/jwt</tt>.
</p>
<p>Upon receipt of the UserInfo Response, the Client MUST verify 
        the response in accordance with
	Section 5.3 (UserInfo Response Verification) of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
        
</p>
<p>Following is a non-normative example of such
          response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 200 OK
Content-Type: application/json

{
 "user_id": "248289761001",
 "name": "Jane Doe"
 "given_name": "Jane",
 "family_name": "Doe",
 "email": "janedoe@example.com",
 "picture": "http://example.com/janedoe/me.jpg"
}</pre></div>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
UserInfo Error Response</h3>

<p>When an error condition occurs, the UserInfo Endpoint returns
  an Error Response as defined in Section 3 of
  the <a class='info' href='#OAuth.Bearer'>OAuth 2.0 Bearer Tokens<span> (</span><span class='info'>Jones, M., Hardt, D., and D. Recordon, &ldquo;The OAuth 2.0 Authorization Framework: Bearer Token Usage,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OAuth.Bearer] specification
  utilizing an error code as specified in
  Section 2.3.3 of <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>Following is a non-normative example of an error
      response:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example.com",
                     error="invalid_token",
                     error_description="The access token expired"</pre></div>
<a name="disco_reg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Discovery and Registration</h3>

<p>Some OpenID Connect installations can use a pre-configured set of
      OpenID Providers and/or Relying Parties. In those cases, it may not be
      necessary to support dynamic discovery of information about identities
      or services or dynamic registration of Clients.
</p>
<p>However, if installations choose to support unanticipated
      interactions between Relying Parties and OpenID Providers that do not
      have pre-configured relationships, they SHOULD accomplish this by
      implementing the facilities defined in the <a class='info' href='#OpenID.Discovery'>OpenID Connect Discovery 1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;OpenID Connect Discovery 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Discovery] and <a class='info' href='#OpenID.Registration'>OpenID Connect Dynamic Client Registration
      1.0<span> (</span><span class='info'>Sakimura, N., Bradley, J., and M. Jones, &ldquo;OpenID Connect Dynamic Client           Registration 1.0,&rdquo; May&nbsp;2012.</span><span>)</span></a> [OpenID.Registration] specifications.
</p>
<a name="Serializations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Serializations</h3>

<p>A request message MAY be serialized using one of the following methods:
        </p>
<ol class="text">
<li>Query String Serialization
</li>
<li>Form Serialization
</li>
</ol><p>
      
</p>
<a name="qss"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Query String Serialization</h3>

<p>In order to serialize the parameters using the query string
        serialization, the Client constructs the string by adding the
        parameters and values to the query component of a URL using the <tt>application/x-www-form-urlencoded</tt> format as
        defined by <a class='info' href='#W3C.REC-html401-19991224'>[W3C.REC&#8209;html401&#8209;19991224]<span> (</span><span class='info'>Hors, A., Raggett, D., and I. Jacobs, &ldquo;HTML 4.01 Specification,&rdquo; December&nbsp;1999.</span><span>)</span></a>. Query string
        serialization is typically used in HTTP GET requests.
</p>
<p>Following is a non-normative example of such
          serialization:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>GET /authorize?scope=openid&amp;response_type=code
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb HTTP/1.1
Host: server.example.com</pre></div>
<a name="form_serialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Form Serialization</h3>

<p>Parameters and their values are form serialized by adding the 
        parameter names and values to the entity body of the HTTP request using
        the <tt>application/x-www-form-urlencoded</tt> format
        as defined by <a class='info' href='#W3C.REC-html401-19991224'>[W3C.REC&#8209;html401&#8209;19991224]<span> (</span><span class='info'>Hors, A., Raggett, D., and I. Jacobs, &ldquo;HTML 4.01 Specification,&rdquo; December&nbsp;1999.</span><span>)</span></a>. Form
        serialization is typically used in HTTP POST requests.
</p>
<p>Following is a non-normative example of such
          serialization:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>POST /authorize HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

scope=openid&amp;response_type=code
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb</pre></div>
<a name="security_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This specification references the security considerations defined in
      <a class='info' href='#OpenID.Messages'>OpenID Connect Messages<span> (</span><span class='info'>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;OpenID Connect Messages 1.0,&rdquo; June&nbsp;2012.</span><span>)</span></a> [OpenID.Messages].
</p>
<p>In addition, the following list of attack vectors and remedies are
      also considered.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Implicit Grant Flow Threats</h3>

<p>In the implicit grant flow, the Access Token is returned in the
        fragment part of the Client's <tt>redirect_uri</tt> through HTTPS, thus it is
        protected between the OP and the User-Agent, and User-Agent and the
        RP. The only the place it can be captured is the User-Agent where the
        TLS session is terminated, and is possible if the User-Agent is
        infested by malware.
</p>
<a name="privacy_considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Privacy Considerations</h3>

<p>The UserInfo response typically contains Personally Identifiable
      Information. As such, End-User consent for the release of the information
      for the specified purpose SHOULD be obtained at or prior to the
      authorization time in accordance with relevant regulations. The purpose
      of use is typically registered in association with the <tt>redirect_uri</tt>.
</p>
<p>Only necessary UserInfo data should be stored at the Client and the
      Client SHOULD associate the received data with the purpose of use
      statement.
</p>
<p>The Resource Server SHOULD make the UserInfo access log available to 
      the End-User so that the End-User can monitor who accessed his data.
</p>
<p>To protect the End-User from a possible correlation among Clients, the
      use of a Pairwise Pseudonymous Identifier (PPID) as the <tt>user_id</tt> SHOULD be considered.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="oauth_params"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
OAuth Parameters Registry</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.1"></a><h3>9.1.1.&nbsp;
Authorization Request Parameter (display)</h3>

<p>The following is a parameter registration request for the
          Authorization Request in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: display
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.2"></a><h3>9.1.2.&nbsp;
Authorization Request Parameter (prompt)</h3>

<p>The following is a parameter registration request for the
          Authorization Request in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: prompt
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.3"></a><h3>9.1.3.&nbsp;
Authorization Request Parameter (nonce)</h3>

<p>The following is a parameter registration request for the
          Authorization Request in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: nonce
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.4"></a><h3>9.1.4.&nbsp;
Authorization Request Parameter (request)</h3>

<p>The following is a parameter registration request for the
          Authorization Request in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: request
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.5"></a><h3>9.1.5.&nbsp;
Authorization Request Parameter (request_uri)</h3>

<p>The following is a parameter registration request for the
          Authorization Request in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: request_uri
</li>
<li>Parameter usage location: Authorization Request
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1.6"></a><h3>9.1.6.&nbsp;
ID Token Response Parameters</h3>

<p>The following is a parameter registration request for the
          ID Token Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Parameter name: id_token
</li>
<li>Parameter usage location: Authorization Response, Access Token
              Response
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[ this document ]]
</li>
<li>Related information: None
</li>
</ul>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
OAuth Extensions Error Registry</h3>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.1"></a><h3>9.2.1.&nbsp;
Authorization Endpoint Error (invalid_redirect_uri)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: invalid_redirect_uri 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.2"></a><h3>9.2.2.&nbsp;
Authorization Endpoint Error (interaction_required)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: interaction_required 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.3"></a><h3>9.2.3.&nbsp;
Authorization Endpoint Error (login_required)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: login_required 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.4"></a><h3>9.2.4.&nbsp;
Authorization Endpoint Error (session_selection_required)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: session_selection_required 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.5"></a><h3>9.2.5.&nbsp;
Authorization Endpoint Error (consent_required)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: consent_required 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.6"></a><h3>9.2.6.&nbsp;
Authorization Endpoint Error (invalid_request_uri)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: invalid_request_uri 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.7"></a><h3>9.2.7.&nbsp;
Authorization Endpoint Error (invalid_openid_request_object)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: invalid_openid_request_object 
</li>
<li>Error usage location: Authorization Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2.8"></a><h3>9.2.8.&nbsp;
UserInfo Endpoint Error (invalid_schema)</h3>

<p>The following is an error registration request for the
          Authorization Error Response in this specification:
</p>
<p></p>
<ul class="text">
<li>Error name: invalid_schema 
</li>
<li>Error usage location: UserInfo Endpoint
</li>
<li>Related protocol extension:
</li>
<li>Change controller: IETF
</li>
<li>Specification document(s): [[this document ]]
</li>
</ul>

<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="JWE">[JWE]</a></td>
<td class="author-text">Jones, M., Rescorla, E., and J. Hildebrand, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption">JSON Web Encryption (JWE)</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWS">[JWS]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature">JSON Web Signature</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="JWT">[JWT]</a></td>
<td class="author-text">Jones, M., Bradley, J., and N. Sakimura, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token">JSON Web Token</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Bearer">[OAuth.Bearer]</a></td>
<td class="author-text">Jones, M., Hardt, D., and D. Recordon, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth.Responses">[OAuth.Responses]</a></td>
<td class="author-text">de Medeiros, B., Scurtescu, M., and P. Tarjan, &ldquo;<a href="http://openid.net/specs/oauth-v2-multiple-response-types-1_0.html">OAuth 2.0 Multiple Response Type Encoding Practices</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth2.0">[OAuth2.0]</a></td>
<td class="author-text">Hammer, E., Ed., Recordon, D., and D. Hardt, &ldquo;<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2">The OAuth 2.0 Authorization Framework</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Discovery">[OpenID.Discovery]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Messages">[OpenID.Messages]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, &ldquo;<a href="http://openid.net/specs/openid-connect-messages-1_0.html">OpenID Connect Messages 1.0</a>,&rdquo; June&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="OpenID.Registration">[OpenID.Registration]</a></td>
<td class="author-text">Sakimura, N., Bradley, J., and M. Jones, &ldquo;<a href="http://openid.net/specs/openid-connect-registration-1_0.html">OpenID Connect Dynamic Client
          Registration 1.0</a>,&rdquo; May&nbsp;2012.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[RFC2246]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6125">[RFC6125]</a></td>
<td class="author-text">Saint-Andre, P. and J. Hodges, &ldquo;<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;6125, March&nbsp;2011 (<a href="http://www.rfc-editor.org/rfc/rfc6125.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html401-19991224">[W3C.REC-html401-19991224]</a></td>
<td class="author-text">Hors, A., Raggett, D., and I. Jacobs, &ldquo;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML 4.01 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html401-19991224, December&nbsp;1999 (<a href="http://www.w3.org/TR/1999/REC-html401-19991224">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CORS">[CORS]</a></td>
<td class="author-text">van Kestern, &ldquo;<a href="http://www.w3.org/TR/access-control/">Cross-Origin Resource Sharing</a>,&rdquo; July&nbsp;2010.</td></tr>
</table>

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Footnotes</h3>

<p>
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Example JWT Values</h3>

<p>The JWT values used in the non-normative examples of this
        specification are only place holders for actual JWT values. The
        examples use "jwt_header.jwt_part2.jwt_part3" as the place holder
        value. For an example of an actual JWT, refer to the <a class='info' href='#JWT'>JWT<span> (</span><span class='info'>Jones, M., Bradley, J., and N. Sakimura, &ldquo;JSON Web Token,&rdquo; May&nbsp;2012.</span><span>)</span></a> [JWT] specification.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgements</h3>

<p>The OpenID Community would like to thank the following people for the
      work they've done in the drafting and editing of this specification.
</p>
<p></p>
<blockquote class="text">
<p>Axel Nennker (axel.nennker@telekom.de), Deutsche Telekom
</p>
<p>Breno de Medeiros (breno@gmail.com), Google
</p>
<p>George Fletcher (gffletch@aol.com), AOL
</p>
<p>Hideki Nara (hideki.nara@gmail.com), Takt Communications
</p>
<p>John Bradley (ve7jtb@ve7jtb.com), Ping Identity
</p>
<p>Nat Sakimura (n-sakimura@nri.co.jp), Nomura Research Institute,
          Ltd.
</p>
<p>Michael B. Jones (mbj@microsoft.com), Microsoft
</p>
<p>Ryo Ito (ryo.ito@mixi.co.jp), mixi, Inc.
</p>
</blockquote>

<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Notices</h3>

<p>Copyright (c) 2012 The OpenID Foundation.
</p>
<p>
	The OpenID Foundation (OIDF) grants to any Contributor, developer, 
	implementer, or other interested party a non-exclusive, royalty free, 
	worldwide copyright license to reproduce, prepare derivative works from, 
	distribute, perform and display, this Implementers Draft or 
	Final Specification solely for the purposes of (i) developing 
	specifications, and (ii) implementing Implementers Drafts and 
	Final Specifications based on such documents, provided that attribution 
	be made to the OIDF as the source of the material, but that such attribution 
	does not indicate an endorsement by the OIDF.
      
</p>
<p>
	The technology described in this specification was 
	made available from contributions from various sources, 
	including members of the OpenID Foundation and others.  
	Although the OpenID Foundation has taken steps to help ensure 
	that the technology is available for distribution, it takes 
	no position regarding the validity or scope of any intellectual 
	property or other rights that might be claimed to pertain to 
	the implementation or use of the technology described in 
	this specification or the extent to which any license under 
	such rights might or might not be available; neither does it 
	represent that it has made any independent effort to identify 
	any such rights.  The OpenID Foundation and the contributors 
	to this specification make no (and hereby expressly disclaim any) 
	warranties (express, implied, or otherwise), including implied 
	warranties of merchantability, non-infringement, fitness for 
	a particular purpose, or title, related to this specification, 
	and the entire risk as to implementing this specification is 
	assumed by the implementer.  The OpenID Intellectual 
	Property Rights policy requires contributors to offer 
	a patent promise not to assert certain patent claims against 
	other contributors and against implementers.  The OpenID Foundation invites 
	any interested party to bring to its attention any copyrights, 
	patents, patent applications, or other proprietary rights 
	that may cover technology that may be required to practice 
	this specification.
      
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Document History</h3>

<p>[[ To be removed from the final specification ]]
</p>
<p>-12
        </p>
<ul class="text">
<li>Updated matching of redirect URI to include query parameters
	  to match Google's implementation
</li>
</ul>

<p>-11
        </p>
<ul class="text">
<li>Removed <tt>claims_in_id_token</tt> scope value,
	  per decision on June 15, 2012 special working group call
</li>
</ul>

<p>-10
        </p>
<ul class="text">
<li>Changed <tt>verified</tt> to
	  <tt>email_verified</tt>, per issue #564
</li>
<li>Added scope value  <tt>claims_in_id_token</tt> as a switch
	  to indicate that the UserInfo claims should be returned in the
	  <tt>id_token</tt>, per issue #561
</li>
<li>Changed  <tt>optional</tt> claim request parameter
	  to <tt>essential</tt>, per issue #577
</li>
<li>Removed Check ID Endpoint, per issue #570
</li>
<li>Specified that parameters present in both the OpenID Request Object and the
	  OAuth 2.0 Authorization Request MUST exactly match, per issue #575
</li>
<li>Changed OpenID Request Object from being specified as a JWT
	  to being specified as a JWS signed base64url encoded JSON object, per issue #592
</li>
<li>Made use of the nonce REQUIRED when using the implicit flow
	  and OPTIONAL when using the code flow, per issue #569
</li>
<li>Changed client.example.com to client.example.org, per issue #251
</li>
<li>Removed example text for generating a nonce via a signed session cookie,
	  per issue #562
</li>
<li>Use standards track version of JSON Web Token spec
	  (draft-ietf-oauth-json-web-token)
</li>
</ul><p>
      
</p>
<p>-09</p>
<ul class="text">
<li>Added error interaction_required and removed
	  user_mismatched, per issue #523
</li>
<li>Changed invalid_request_request_uri to invalid_request_uri and
	  invalid_request_redirect_uri to invalid_redirect_uri, per issue #553
</li>
<li>Added optional id_token to authorization request parameters, per issue #535
</li>
<li>Removed use of non-existent scope parameters registry, per issue #558
</li>
<li>Updated Notices
</li>
<li>Updated References
</li>
</ul>

<p>-08</p>
<ul class="text">
<li>Updated version number and date
</li>
<li>Fix #543 Section 2.3.1.3 Request file requiring all request params to be included is false
</li>
<li>Fix Section 5.1 to reference Messages 2.4.1 rather than 3.3
</li>
<li>Added reference to CORS for JS clients to user_info and check_id endpoints
</li>
</ul>

<p>-07</p>
<ul class="text">
<li>Removed definition and usage for assertion and claim object
</li>
<li>Removed Request File Registration Service
</li>
<li>Consistent use of End-User
</li>
<li>email scope allows access to the 'verified' claim
</li>
<li>Removed language pertaining to custom userinfo schemas
</li>
<li>Updated error section for refreshing access token
</li>
<li>Remove 'audience' parameter from Authorization Request
</li>
<li>Moved display=none to prompt=none
</li>
<li>Moved IANA considerations from Messages
</li>
<li>Check ID Endpoint returns only JSON
</li>
<li>Removed PPID scope value
</li>
<li>Reference Messages for validation of request object encryption and signature
</li>
<li>Redefined 'nonce' in Authorization Request. Changed to REQUIRED parameter.
</li>
<li>Changed usage of "approval" to "consent"
</li>
<li>Use RFC 6125 to verify TLS endpoints
</li>
<li>Added Privacy considerations
</li>
<li>Changed 'request_uri' to require HTTPS unless the referenced content is signed
	    and only needs to be reachable by AS
</li>
<li>Added hash and entropy considerations to 'request_uri'
</li>
<li>Added requirement to compare user_id from userinfo endpoint to id_token
</li>
<li>Check ID Endpoint SHOULD use POST
</li>
<li>Changed UserInfo Error Response to augment and return OAuth 2.0 Bearer Token Error Response
</li>
<li>Added section about string comparison rules needed
</li>
<li>Added Response Encoding according to Multiple Response Types spec
</li>
<li>Allows only 'id_token' for 'response_type' parameter in Authorization Request
</li>
<li>Clarified redirect_uris matching
</li>
<li>Added explanation of select_account
</li>
<li>Changed Security Considerations to refer to corresponding section in Messages
</li>
<li>Check ID Endpoint uses ID Token as Access Token according to Bearer Token spec
</li>
<li>Update John Bradley email and affiliation for Implementer's Draft
</li>
<li>Removed invalid_authorization_code, invalid_id_token error codes
</li>
</ul>

<p>-06</p>
<ul class="text">
<li>Reworked return type wording in section 4.4.1 per ticket #174.
</li>
<li>Added reference to registered return types.
</li>
<li>Bumped Version number and date.
</li>
<li>Make clear the server passes the value of nonce through untouched. Ticket #97.
</li>
<li>Prevent caching of request_uri. Ticket #148.
</li>
<li>Add nonce to request examples. Ticket #147.
</li>
<li>Fixed 4.3.1.3 per ticket #150.
</li>
<li>Fixed 4.3.2 to remove display scopes per ticket #172.
</li>
<li>Make scope optional for refresh in 5.2.
</li>
<li>Reference messages 3.2.2 for field definitions in section 5.2.1 per ticket #159.
</li>
<li>Removed scopes from display value in 4.3.1 per ticket #172.
</li>
<li>Make "code" and "id_token token" response types mandatory for Authorization Servers to support.
</li>
</ul>

<p>-05</p>
<ul class="text">
<li>Changed check_session to check_id.
</li>
<li>schema=openid now required when requesting UserInfo.
</li>
<li>Removed display values popup, touch, and mobile, since not well defined.
</li>
<li>Resolve issue #135, clarifying that the access_token MAY
          be sent in the message body.
</li>
</ul>

<p>-04 </p>
<ul class="text">
<li>Changes associated with renaming "Lite" to "Basic Client"
          and replacing "Core" and "Framework" with "Messages" and
          "Standard".
</li>
<li>Numerous cleanups, including updating references.
</li>
</ul>

<p>-03 </p>
<ul class="text">
<li>Added secret_type to the Token Endpoint.
</li>
<li>Minor edits to the samples.
</li>
</ul>

<p>-02 </p>
<ul class="text">
<li>Incorporates feedback from Nat Sakimura.
</li>
</ul>

<p>-01 </p>
<ul class="text">
<li>First Draft that incorporates the merge of the Core and Framework
          specs.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nat Sakimura</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nomura Research Institute, Ltd.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:n-sakimura@nri.co.jp">n-sakimura@nri.co.jp</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Bradley</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ping Identity</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ve7jtb@ve7jtb.com">ve7jtb@ve7jtb.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Michael B. Jones</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Microsoft</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Breno de Medeiros</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:breno@google.com">breno@google.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Edmund Jay</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Illumila</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ejay@mgi1.com">ejay@mgi1.com</a></td></tr>
</table>
</body></html>
