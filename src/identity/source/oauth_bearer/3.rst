3. The WWW-Authenticate Response Header Field
================================================

If the :term:`protected resource request` does not include 
:term:`authentication credentials` or does not contain an :term:`access token` 
that enables access to the :term:`protected resource`, 
the resource server MUST include the HTTP ":term:`WWW-Authenticate`" response header field; 
it MAY include it in response to other conditions as well.  
The ":term:`WWW-Authenticate`" header field uses the framework defined by HTTP/1.1, 
Part 7 [I-D.ietf-httpbis-p7-auth].

All challenges defined by this specification MUST 
use the auth-scheme value "**Bearer**".  
This scheme MUST be followed by one or more :term:`auth-param` values.  
The :term:`auth-param` attributes used or defined by this specification are as follows.  
Other auth-param attributes MAY be used as well.

A ":term:`realm`" attribute MAY be included 
to indicate the scope of protection 
in the manner described in HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth].  
The ":term:`realm`" attribute MUST NOT appear more than once.

The ":term:`scope`" attribute is a **space-delimited list** of :term:`scope` values
indicating the required scope of the :term:`access token` 
for accessing the :term:`requested resource`.  
In some cases, 
the ":term:`scope`" value will be used 
when requesting a new :term:`access token` with sufficient :term:`scope` of access 
to utilize the :term:`protected resource`.  
Use of the ":term:`scope`" attribute is OPTIONAL.  
The ":term:`scope`" attribute MUST NOT appear more than once.  
The ":term:`scope`" value is intended for programmatic use and 
is not meant to be displayed to end users.

If the :term:`protected resource request` included an :term:`access token` 
and failed authentication, 
the :term:`resource server` SHOULD include the ":term:`error`" attribute 
to provide the client with the reason 
why the access request was declined.  
The parameter value is described in Section 3.1.  
In addition, 
the resource server MAY include the "error_description" attribute 
to provide developers a human-readable explanation 
that is not meant to be displayed to end users.  
It also MAY include the ":term:`error_uri`" attribute 
with an absolute URI identifying 
a human-readable web page explaining the error.  
The "error", "error_description", and "error_uri" attributes MUST NOT appear more than once.

Values for the "scope" attribute MUST NOT include characters outside
the set **%x21 / %x23-5B / %x5D-7E** 
for representing scope values and **%x20** for delimiters between scope values.  
Values for the ":term:`error`" and :term:`"error_description`" attributes MUST NOT 
include characters outside the set **%x20-21 / %x23-5B / %x5D-7E**. 
Values for the ":term:`error_uri`" attribute MUST conform to the URI-Reference syntax, 
and thus MUST NOT include characters outside the set **%x21 / %x23-5B / %x5D-7E**.

For example, in response to a protected resource request without
authentication:

::

    HTTP/1.1 401 Unauthorized
    WWW-Authenticate: Bearer realm="example"

And in response to a protected resource request with an
authentication attempt using an expired access token:

::

    HTTP/1.1 401 Unauthorized
    WWW-Authenticate: Bearer realm="example",
    error="invalid_token",
    error_description="The access token expired"

(Draft 07 http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-3  ) 
