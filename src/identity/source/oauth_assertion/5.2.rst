5.2.  General Assertion Format and Processing Rules
------------------------------------------------------------

The following are general format and processing rules for the use of
assertions in OAuth:

   -  The assertion MUST contain an Issuer.  The Issuer MUST identify
      the entity that issued the assertion as recognized by the
      Authorization Server.  If an assertion is self-asserted, the
      Issuer SHOULD be the client_id.

   -  The assertion SHOULD contain a Principal.  The Principal MUST
      identify an authorized accessor for whom the access token is being
      requested ( typically the resource owner, or an authorized
      delegate ) When the client is acting on behalf of itself, the
      Principal SHOULD be the client_id.

   -  The assertion MUST contain an Audience that identifies the
      Authorization Server as the intended audience.  The Authorization
      Server MUST verify that it is an intended audience for the
      assertion.  The Audience SHOULD be the URL of the Authorization
      Server's Token Endpoint.

   -  The assertion MUST contain an Expires At entity that limits the
      time window during which the assertion can be used.  The
      authorization server MUST verify that the expiration time has not
      passed, subject to allowable clock skew between systems.  The
      authorization server SHOULD reject assertions with an Expires At
      attribute value that is unreasonably far in the future.

   -  The assertion MAY contain an Issued At entity containing the UTC
      time at which the assertion was issued.

   -  The assertion MAY contain an Assertion ID.  An Authorization
      Server MAY dictate that Assertion ID is mandatory.

   -  The Authorization Server MUST validate the assertion in order to
      establish a mapping between the Issuer and the secret used to
      generate the assertion.  The algorithm used to validate the
      assertion, and the mechanism for designating the secret used to
      generate the assertion is out-of-scope for this specification.


