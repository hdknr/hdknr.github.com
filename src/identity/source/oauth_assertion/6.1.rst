6.1.  Client authentication
---------------------------------------

When a :term:`client` authenticates to a token service using an assertion, 
it SHOULD do so according to :ref:`section 4.1 <oauth_assertion.4.1>`.  
The following format and processing rules SHOULD be applied:

   -  The :term:`client_id` HTTP parameter SHOULD identify the :term:`client` to the
      :term:`authorization server`.

   -  The :term:`client_assertion_type` HTTP parameter MUST identify the
      :term:`assertion format` being used for authentication.

   -  The :term:`client_assertion` HTTP parameter MUST contain the serialized
      assertion in a format indicated by the :term:`client_assertion_type` parameter.

   -  The :term:`Issuer` of the assertion MUST identify the entity 
      that issued the assertion as recognized by the :term:`Authorization Server`.  
      If the assertion is self-asserted, the :term:`Issuer` SHOULD be the :term:`client_id`.

   -  The :term:`Principal` MUST identify an :term:`authorized accessor`.  
      If the assertion is self-issued, the :term:`Principal` SHOULD be the :term:`client_id`.

   -  The :term:`Audience` of the assertion MUST identify the :term:`Authorization Server` 
      and SHOULD be the URL of the :term:`Token Endpoint`.

   -  The :term:`Authorization Server` MUST validate the assertion in order to
      establish a mapping between the :term:`Issuer` and the secret used to
      generate the assertion.

The following non-normative example demonstrates the use of a client authentication using an assertion 
during an :term:`Authorization Code Access Token Request` as 
defined in :ref:`Section 4.1.3 of OAuth 2.0 [I-D.ietf.oauth-v2] <oauth_4_1_3>`. 
(line breaks are for display purposes only):

:: 

    POST /token HTTP/1.1
    Host: server.example.com
    Content-Type: application/x-www-form-urlencoded
    
    grant_type=authorization_code&
    code=i1WsRn1uB1&
    client_id=s6BhdRkqt3&
    client_assertion_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&
    client_assertion=PHNhbWxwOl...[omitted for brevity]...ZT4
    

