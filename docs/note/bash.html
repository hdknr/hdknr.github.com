

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>bash &mdash; Note 1 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/theme_extras.js"></script>
    <link rel="top" title="Note 1 documentation" href="index.html" />
    <link rel="next" title="bash:compete" href="bash_complete.html" />
    <link rel="prev" title="graphviz" href="graphviz.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Note 1 documentation</span></a></h1>
        <h2 class="heading"><span>bash</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a href="/">Home</a>:
        «&#160;&#160;<a href="graphviz.html">graphviz</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="bash_complete.html">bash:compete</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="bash">
<h1><a class="toc-backref" href="#id6">bash</a><a class="headerlink" href="#bash" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="id1">
<p class="topic-title first">bash</p>
<ul class="simple">
<li><a class="reference internal" href="#bash" id="id6">bash</a><ul>
<li><a class="reference internal" href="#cookbook" id="id7">Cookbook</a><ul>
<li><a class="reference internal" href="#sourceexit" id="id8">sourceされるスクリプトからexitするには？</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2" id="id9">変数</a></li>
<li><a class="reference internal" href="#id3" id="id10">$(コマンド)</a></li>
<li><a class="reference internal" href="#id4" id="id11">配列変数</a></li>
<li><a class="reference internal" href="#seq" id="id12">seqコマンド</a></li>
<li><a class="reference internal" href="#for" id="id13">for</a></li>
<li><a class="reference internal" href="#if" id="id14">if</a></li>
<li><a class="reference internal" href="#id5" id="id15">ログインシェル変更</a><ul>
<li><a class="reference internal" href="#sudo-usermod" id="id16">sudo usermod(管理者)</a></li>
<li><a class="reference internal" href="#chsh" id="id17">chsh (自分で変える)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#link" id="id18">Link</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="cookbook">
<h2><a class="toc-backref" href="#id7">Cookbook</a><a class="headerlink" href="#cookbook" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sourceexit">
<h3><a class="toc-backref" href="#id8">sourceされるスクリプトからexitするには？</a><a class="headerlink" href="#sourceexit" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">単純にexitするとシェルが終了してしまうよ</p>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span class="k">return </span>2&gt;&amp;- <span class="o">||</span> <span class="nb">exit</span>;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id9">変数</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span class="c">#!/bin/bash</span>

<span class="c"># 全ての引数</span>
<span class="nb">echo</span> <span class="nv">$@</span>

<span class="c"># ループ</span>
<span class="k">for </span>a in <span class="nv">$@</span>; <span class="k">do</span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;ARG&quot;</span>,<span class="nv">$a</span>;
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id10">$(コマンド)</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>実行結果を変数にいれることができる。</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ P=$(ps ax|grep bash|awk '{print $1}')
(docs)hdknr@sqg:~$ echo $P
2173 2175 2185 2194 2205 2218 2235 2688 2690 2701 2712 2723 2735 2749 12770 12772 12781 12792 12803 12817 12832 15829 15881 17109 17199 17201</pre>
</div>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id11">配列変数</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>() にすると配列変数</li>
<li>配列じゃない</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ P=$(ps ax|grep bash|awk '{print $1}')
(docs)hdknr@sqg:~$ echo ${P[0]}
2173 2175 2185 2194 2205 2218 2235 2688 2690 2701 2712 2723 2735 2749 12770 12772 12781 12792 12803 12817 12832 15829 15881 17109 17218 17224 17226 17227
(docs)hdknr@sqg:~$ echo ${P[1]}</pre>
</div>
<ul class="simple">
<li>括弧に入れて配列化</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ P=($(ps ax|grep bash|awk '{print $1}') )
(docs)hdknr@sqg:~$ echo ${P[0]}
2173
(docs)hdknr@sqg:~$ echo ${P[1]}
2175</pre>
</div>
<ul class="simple">
<li>配列の全要素( * あるいは &#64; )</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ P=($(ps ax|grep bash|awk '{print $1}'))
(docs)hdknr@sqg:~$ echo ${P[*]}
2173 2175 2185 2194 2205 2218 2235 2688 2690 2701 2712 2723 2735 2749 12770 12772 12781 12792 12803 12817 12832 15829 15881 17109 17232 17235 17237

(docs)hdknr@sqg:~$ echo ${P[@]}
2173 2175 2185 2194 2205 2218 2235 2688 2690 2701 2712 2723 2735 2749 12770 12772 12781 12792 12803 12817 12832 15829 15881 17109 17232 17235 17237</pre>
</div>
<ul class="simple">
<li>要素数 ( # と * or &#64; )</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ echo ${#P[*]} ${#P[@]}
27 27</pre>
</div>
<ul class="simple">
<li>最後の値</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ echo ${P[ ${#P[@]} - 1]}
17237</pre>
</div>
<ul class="simple">
<li>スライス (スライスした物は配列ではありません )</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ echo ${P[@]:4:2}
2205 2218
(docs)hdknr@sqg:~$ Q=${P[@]:4:2}
(docs)hdknr@sqg:~$ echo ${#Q[*]}
1

(docs)hdknr@sqg:~$ Q=( ${P[@]:4:2} )
(docs)hdknr@sqg:~$ echo ${#Q[*]}
2</pre>
</div>
<ul class="simple">
<li>置換</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ echo ${X[@]#*/}
bin usr/bin usr/local/bin

(docs)hdknr@sqg:~$ echo ${X[@]##*/}
bin bin bin

(docs)hdknr@sqg:~$ echo ${X[@]%*/}
/bin /usr/bin /usr/local/bin

(docs)hdknr@sqg:~$ echo ${X[@]%[a-z]*}
/bi /usr/bi /usr/local/bi

(docs)hdknr@sqg:~$ echo ${X[@]%%[a-z]*}
/ / /</pre>
</div>
<p>拡張子の一括変換</p>
<div class="highlight-python"><pre>$ for f in *.txt; do echo $f ${f%.txt}.rst ; done</pre>
</div>
<ul class="simple">
<li>要素を抜く</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ echo ${#P[*]}
26
(docs)hdknr@sqg:~$ unset P[10]
(docs)hdknr@sqg:~$ echo ${#P[*]}
25</pre>
</div>
<ul class="simple">
<li>declare 内部コマンドでみると、P[10]がないことに注意 !!!!</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ declare -p P
declare -a P='([1]="2175" [2]="2185" [3]="2194" [4]="2205" [5]="2218"
[6]="2235" [7]="2688" [8]="2690" [9]="2701" [11]="2723" [12]="2735" [13]="2749"
[14]="12770" [15]="12772" [16]="12781" [17]="12792" [18]="12803" [19]="12817"
[20]="12832" [21]="15829" [22]="15881" [23]="17109" [24]="17232" [25]="17235"
[26]="17237")'</pre>
</div>
<ul class="simple">
<li>ちょっと気持ち悪い</li>
</ul>
<div class="highlight-python"><pre>(docs)hdknr@sqg:~$ X=(a b c )
(docs)hdknr@sqg:~$ unset X[1]
(docs)hdknr@sqg:~$ echo ${#X[*]}
2

(docs)hdknr@sqg:~$ declare -p X
declare -a X='([0]="a" [2]="c")'

(docs)hdknr@sqg:~$ X[1]='HOGE'
(docs)hdknr@sqg:~$ declare -p X
declare -a X='([0]="a" [1]="HOGE" [2]="c")'</pre>
</div>
</div>
<div class="section" id="seq">
<h2><a class="toc-backref" href="#id12">seqコマンド</a><a class="headerlink" href="#seq" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>for でループさせるとき便利よ</li>
</ul>
<div class="highlight-python"><pre>(main)hdknr@sqg:~$ for i in $(seq 1 5 ) ; do echo $i; done
1
2
3
4
5</pre>
</div>
</div>
<div class="section" id="for">
<h2><a class="toc-backref" href="#id13">for</a><a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h2>
<p>for コマンドでワイルドカード指定する場合、マッチするファイルがないとワイルドカード指定自体が対象となってしまう</p>
</div>
<div class="section" id="if">
<h2><a class="toc-backref" href="#id14">if</a><a class="headerlink" href="#if" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><ul class="simple">
<li>and</li>
</ul>
</div></blockquote>
<div class="highlight-bash"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$S&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span> -a <span class="s2">&quot;$SS&quot;</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span> <span class="o">]</span>
<span class="k">then</span>
<span class="c"># ...</span>
<span class="k">fi</span>
</pre></div>
</div>
<ul class="simple">
<li>or</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$S&quot;</span> <span class="o">=</span> <span class="s2">&quot;1&quot;</span> -o <span class="s2">&quot;$SS&quot;</span> <span class="o">=</span> <span class="s2">&quot;2&quot;</span> <span class="o">]</span>
<span class="k">then</span>
<span class="c"># ....</span>
<span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h2><a class="toc-backref" href="#id15">ログインシェル変更</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sudo-usermod">
<h3><a class="toc-backref" href="#id16">sudo usermod(管理者)</a><a class="headerlink" href="#sudo-usermod" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>system@squeeze02:~$ sudo usermod -s /bin/bash cms
[sudo] password for system:
system@squeeze02:~$ grep cms /etc/passwd
cms:x:1001:1001::/home/cms:/bin/bash</pre>
</div>
</div>
<div class="section" id="chsh">
<h3><a class="toc-backref" href="#id17">chsh (自分で変える)</a><a class="headerlink" href="#chsh" title="Permalink to this headline">¶</a></h3>
<p>パスワード聞いてきます:</p>
<div class="highlight-python"><pre>$ chsh -s /bin/bash</pre>
</div>
<p>デフォルトの設定ファイル</p>
<div class="highlight-python"><pre>$ ls -al /etc/skel

合計 20
drwxr-xr-x  2 root root 4096 2011-12-31 07:58 .
drwxr-xr-x 78 root root 4096 2013-08-02 16:23 ..
-rw-r--r--  1 root root  220 2010-04-10 19:50 .bash_logout
-rw-r--r--  1 root root 3184 2010-04-10 19:50 .bashrc
-rw-r--r--  1 root root  675 2010-04-10 19:50 .profile</pre>
</div>
</div>
</div>
<div class="section" id="link">
<h2><a class="toc-backref" href="#id18">Link</a><a class="headerlink" href="#link" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>色( <a class="reference external" href="http://spiral.world.coocan.jp/tips/computer/lscolor.html">http://spiral.world.coocan.jp/tips/computer/lscolor.html</a> )</li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a href="/">Home</a>:
        «&#160;&#160;<a href="graphviz.html">graphviz</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="bash_complete.html">bash:compete</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>