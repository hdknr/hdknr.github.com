
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft21</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft19</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft25</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft24</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#scope-and-purpose">2. Scope and Purpose</a></li>
<li><a class="reference internal" href="#definitions-symbols-and-abbreviations">3. Definitions, Symbols and Abbreviations</a><ul>
<li><a class="reference internal" href="#definitions">3.1 Definitions</a></li>
<li><a class="reference internal" href="#symbols-and-abbreviations">3.2 Symbols and Abbreviations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-establishment-schemes-overview">4. Key Establishment Schemes Overview</a><ul>
<li><a class="reference internal" href="#key-agreement-preparations-by-an-owner">4.1 Key Agreement Preparations by an Owner</a></li>
<li><a class="reference internal" href="#key-agreement-process">4.2 Key Agreement Process</a></li>
<li><a class="reference internal" href="#dlc-based-key-transport-process">4.3 DLC-based Key Transport Process</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-elements">5. Cryptographic Elements</a><ul>
<li><a class="reference internal" href="#cryptographic-hash-functions">5.1 Cryptographic Hash Functions</a></li>
<li><a class="reference internal" href="#message-authentication-code-mac-algorithm">5.2 Message Authentication Code (MAC) Algorithm</a><ul>
<li><a class="reference internal" href="#mactag-computation">5.2.1 MacTag Computation</a></li>
<li><a class="reference internal" href="#mactag-checking">5.2.2 MacTag Checking</a></li>
<li><a class="reference internal" href="#implementation-validation-message">5.2.3 Implementation Validation Message</a></li>
</ul>
</li>
<li><a class="reference internal" href="#random-number-generation">5.3 Random Number Generation</a></li>
<li><a class="reference internal" href="#nonces">5.4 Nonces</a></li>
<li><a class="reference internal" href="#domain-parameters">5.5 Domain Parameters</a><ul>
<li><a class="reference internal" href="#domain-parameter-generation">5.5.1 Domain Parameter Generation</a><ul>
<li><a class="reference internal" href="#ffc-domain-parameter-generation">5.5.1.1 FFC Domain Parameter Generation</a></li>
<li><a class="reference internal" href="#ecc-domain-parameter-generation">5.5.1.2 ECC Domain Parameter Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-domain-parameter-validity">5.5.2 Assurances of Domain Parameter Validity</a></li>
<li><a class="reference internal" href="#domain-parameter-management">5.5.3 Domain Parameter Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#private-and-public-keys">5.6 Private and Public Keys</a><ul>
<li><a class="reference internal" href="#private-public-key-pair-generation">5.6.1 Private/Public Key Pair Generation</a><ul>
<li><a class="reference internal" href="#ffc-key-pair-generation">5.6.1.1 FFC Key Pair Generation</a></li>
<li><a class="reference internal" href="#ecc-key-pair-generation">5.6.1.2 ECC Key Pair Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-the-arithmetic-validity-of-a-public-key">5.6.2 Assurances of the Arithmetic Validity of a Public Key</a><ul>
<li><a class="reference internal" href="#owner-assurances-of-static-public-key-validity">5.6.2.1 Owner Assurances of Static Public Key Validity</a></li>
<li><a class="reference internal" href="#recipientassurancesofstaticpublickeyvalidity">5.6.2.2 RecipientAssurancesofStaticPublicKeyValidity</a></li>
<li><a class="reference internal" href="#recipientassurancesofephemeralpublickeyvalidity">5.6.2.3 RecipientAssurancesofEphemeralPublicKeyValidity</a></li>
<li><a class="reference internal" href="#ffcfullpublickeyvalidationroutine">5.6.2.4 FFCFullPublicKeyValidationRoutine</a></li>
<li><a class="reference internal" href="#eccfullpublickeyvalidationroutine">5.6.2.5 ECCFullPublicKeyValidationRoutine</a></li>
<li><a class="reference internal" href="#eccpartialpublickeyvalidationroutine">5.6.2.6 ECCPartialPublicKeyValidationRoutine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-the-possession-of-a-static-private-key">5.6.3 Assurances of the Possession of a Static Private Key</a><ul>
<li><a class="reference internal" href="#ownerassurancesofpossessionofastaticprivatekey">5.6.3.1 OwnerAssurancesofPossessionofaStaticPrivateKey</a></li>
<li><a class="reference internal" href="#recipient-assurance-of-owners-possession-of-a-static-private-key">5.6.3.2 Recipient Assurance of Owner’s Possession of a Static Private Key</a><ul>
<li><a class="reference internal" href="#recipient-obtains-assurance-through-a-trusted-third-party">5.6.3.2.1 Recipient Obtains Assurance through a Trusted Third Party</a></li>
<li><a class="reference internal" href="#recipient-obtains-assurance-directly-from-the-claimed-owner">5.6.3.2.2 Recipient Obtains Assurance Directly from the Claimed Owner</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-pair-management">5.6.4 Key Pair Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-agreement">6. Key Agreement</a><ul>
<li><a class="reference internal" href="#schemes-using-one-ephemeral-key-pair-c-1">6.2 Schemes Using One Ephemeral Key Pair, C(1)</a><ul>
<li><a class="reference internal" href="#initiator-has-a-static-key-pair-and-generates-an-ephemeral-key-pair-responder-has-a-static-key-pair-c-1-2">6.2.1 Initiator Has a Static Key Pair and Generates an Ephemeral Key Pair; Responder Has a Static Key Pair, C(1, 2)</a></li>
<li><a class="reference internal" href="#initiator-generates-only-an-ephemeral-key-pair-responder-has-only-a-static-key-pair-c-1-1">6.2.2 Initiator Generates Only an Ephemeral Key Pair; Responder Has Only a Static Key Pair, C(1, 1)</a><ul>
<li><a class="reference internal" href="#one-pass-diffie-hellman-c-1-1-ecc-cdh">6.2.2.2 One-Pass Diffie-Hellman,C(1,1,ECC CDH)</a><ul>
<li><a class="reference internal" href="#actions-u-shall-derive-secret-keying-material-as-follows">Actions: U shall derive secret keying material as follows:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/nist-sp800-56a.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="recommendation-for-pair-wise-key-establishment-schemes-using-discrete-logarithm-cryptography">
<span id="nist-sp800-56a-head"></span><h1>Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography<a class="headerlink" href="#recommendation-for-pair-wise-key-establishment-schemes-using-discrete-logarithm-cryptography" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id9">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id10">1. Introduction</a></li>
<li><a class="reference internal" href="#scope-and-purpose" id="id11">2. Scope and Purpose</a></li>
<li><a class="reference internal" href="#definitions-symbols-and-abbreviations" id="id12">3. Definitions, Symbols and Abbreviations</a><ul>
<li><a class="reference internal" href="#definitions" id="id13">3.1 Definitions</a></li>
<li><a class="reference internal" href="#symbols-and-abbreviations" id="id14">3.2 Symbols and Abbreviations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-establishment-schemes-overview" id="id15">4. Key Establishment Schemes Overview</a><ul>
<li><a class="reference internal" href="#key-agreement-preparations-by-an-owner" id="id16">4.1 Key Agreement Preparations by an Owner</a></li>
<li><a class="reference internal" href="#key-agreement-process" id="id17">4.2 Key Agreement Process</a></li>
<li><a class="reference internal" href="#dlc-based-key-transport-process" id="id18">4.3 DLC-based Key Transport Process</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-elements" id="id19">5. Cryptographic Elements</a><ul>
<li><a class="reference internal" href="#cryptographic-hash-functions" id="id20">5.1 Cryptographic Hash Functions</a></li>
<li><a class="reference internal" href="#message-authentication-code-mac-algorithm" id="id21">5.2 Message Authentication Code (MAC) Algorithm</a><ul>
<li><a class="reference internal" href="#mactag-computation" id="id22">5.2.1 MacTag Computation</a></li>
<li><a class="reference internal" href="#mactag-checking" id="id23">5.2.2 MacTag Checking</a></li>
<li><a class="reference internal" href="#implementation-validation-message" id="id24">5.2.3 Implementation Validation Message</a></li>
</ul>
</li>
<li><a class="reference internal" href="#random-number-generation" id="id25">5.3 Random Number Generation</a></li>
<li><a class="reference internal" href="#nonces" id="id26">5.4 Nonces</a></li>
<li><a class="reference internal" href="#domain-parameters" id="id27">5.5 Domain Parameters</a><ul>
<li><a class="reference internal" href="#domain-parameter-generation" id="id28">5.5.1 Domain Parameter Generation</a><ul>
<li><a class="reference internal" href="#ffc-domain-parameter-generation" id="id29">5.5.1.1 FFC Domain Parameter Generation</a></li>
<li><a class="reference internal" href="#ecc-domain-parameter-generation" id="id30">5.5.1.2 ECC Domain Parameter Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-domain-parameter-validity" id="id31">5.5.2 Assurances of Domain Parameter Validity</a></li>
<li><a class="reference internal" href="#domain-parameter-management" id="id32">5.5.3 Domain Parameter Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#private-and-public-keys" id="id33">5.6 Private and Public Keys</a><ul>
<li><a class="reference internal" href="#private-public-key-pair-generation" id="id34">5.6.1 Private/Public Key Pair Generation</a><ul>
<li><a class="reference internal" href="#ffc-key-pair-generation" id="id35">5.6.1.1 FFC Key Pair Generation</a></li>
<li><a class="reference internal" href="#ecc-key-pair-generation" id="id36">5.6.1.2 ECC Key Pair Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-the-arithmetic-validity-of-a-public-key" id="id37">5.6.2 Assurances of the Arithmetic Validity of a Public Key</a><ul>
<li><a class="reference internal" href="#owner-assurances-of-static-public-key-validity" id="id38">5.6.2.1 Owner Assurances of Static Public Key Validity</a></li>
<li><a class="reference internal" href="#recipientassurancesofstaticpublickeyvalidity" id="id39">5.6.2.2 RecipientAssurancesofStaticPublicKeyValidity</a></li>
<li><a class="reference internal" href="#recipientassurancesofephemeralpublickeyvalidity" id="id40">5.6.2.3 RecipientAssurancesofEphemeralPublicKeyValidity</a></li>
<li><a class="reference internal" href="#ffcfullpublickeyvalidationroutine" id="id41">5.6.2.4 FFCFullPublicKeyValidationRoutine</a></li>
<li><a class="reference internal" href="#eccfullpublickeyvalidationroutine" id="id42">5.6.2.5 ECCFullPublicKeyValidationRoutine</a></li>
<li><a class="reference internal" href="#eccpartialpublickeyvalidationroutine" id="id43">5.6.2.6 ECCPartialPublicKeyValidationRoutine</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assurances-of-the-possession-of-a-static-private-key" id="id44">5.6.3 Assurances of the Possession of a Static Private Key</a><ul>
<li><a class="reference internal" href="#ownerassurancesofpossessionofastaticprivatekey" id="id45">5.6.3.1 OwnerAssurancesofPossessionofaStaticPrivateKey</a></li>
<li><a class="reference internal" href="#recipient-assurance-of-owners-possession-of-a-static-private-key" id="id46">5.6.3.2 Recipient Assurance of Owner’s Possession of a Static Private Key</a><ul>
<li><a class="reference internal" href="#recipient-obtains-assurance-through-a-trusted-third-party" id="id47">5.6.3.2.1 Recipient Obtains Assurance through a Trusted Third Party</a></li>
<li><a class="reference internal" href="#recipient-obtains-assurance-directly-from-the-claimed-owner" id="id48">5.6.3.2.2 Recipient Obtains Assurance Directly from the Claimed Owner</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-pair-management" id="id49">5.6.4 Key Pair Management</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-agreement" id="id50">6. Key Agreement</a><ul>
<li><a class="reference internal" href="#schemes-using-one-ephemeral-key-pair-c-1" id="id51">6.2 Schemes Using One Ephemeral Key Pair, C(1)</a><ul>
<li><a class="reference internal" href="#initiator-has-a-static-key-pair-and-generates-an-ephemeral-key-pair-responder-has-a-static-key-pair-c-1-2" id="id52">6.2.1 Initiator Has a Static Key Pair and Generates an Ephemeral Key Pair; Responder Has a Static Key Pair, C(1, 2)</a></li>
<li><a class="reference internal" href="#initiator-generates-only-an-ephemeral-key-pair-responder-has-only-a-static-key-pair-c-1-1" id="id53">6.2.2 Initiator Generates Only an Ephemeral Key Pair; Responder Has Only a Static Key Pair, C(1, 1)</a><ul>
<li><a class="reference internal" href="#one-pass-diffie-hellman-c-1-1-ecc-cdh" id="id54">6.2.2.2 One-Pass Diffie-Hellman,C(1,1,ECC CDH)</a><ul>
<li><a class="reference internal" href="#actions-u-shall-derive-secret-keying-material-as-follows" id="id55">Actions: U shall derive secret keying material as follows:</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://csrc.nist.gov/publications/nistpubs/800-56A/SP800-56A_Revision1_Mar08-2007.pdf">Rev 1.</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="nist-sp800-56a-abstract"></span><h2><a class="toc-backref" href="#id9">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>鍵共有( Key Establishment ) スキーム</li>
<li>X9.42 ( 離散対数[Descret Lograrithm] を使った共有キーの共有[Agreement] )</li>
<li>X9.63 ( EC暗号化による鍵の共有[Key Agreement] と鍵の送信 )</li>
</ul>
</div>
<p>This Recommendation specifies key establishment schemes
using discrete logarithm cryptography, based on standards developed
by the Accredited Standards Committee (ASC) X9, Inc.:
ANS X9.42 (Agreement of Symmetric Keys Using Discrete Logarithm Cryptography) and
ANS X9.63 (Key Agreement and Key Transport Using Elliptic Curve Cryptography).</p>
<dl class="docutils">
<dt>KEY WORDS:</dt>
<dd>assurances;
Diffie-Hellman;
elliptic curve cryptography;
finite field cryptography;
key agreement;
key confirmation;
key derivation;
key establishment;
key management;
key recovery;
key transport;
MQV.</dd>
</dl>
</div>
<div class="section" id="introduction">
<span id="nist-sp800-56a-1"></span><h2><a class="toc-backref" href="#id10">1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Many U.S. Government Information Technology (IT) systems need to employ well-established cryptographic schemes to protect the integrity and confidentiality of the data that they process. Algorithms such as the Advanced Encryption Standard (AES) as defined in Federal Information Processing Standard (FIPS) 197, Triple DES as specified in NIST Special Publication (SP) 800- 67, and HMAC as defined in FIPS 198 make attractive choices for the provision of these services. These algorithms have been standardized to facilitate interoperability between systems. However, the use of these algorithms requires the establishment of shared secret keying material in advance. Trusted couriers may manually distribute this secret keying material. However, as the number of entities using a system grows, the work involved in the distribution of the secret keying material could grow rapidly. Therefore, it is essential to support the cryptographic algorithms used in modern U.S. Government applications with automated key establishment schemes.</p>
</div>
<div class="section" id="scope-and-purpose">
<span id="nist-sp800-56a-2"></span><h2><a class="toc-backref" href="#id11">2. Scope and Purpose</a><a class="headerlink" href="#scope-and-purpose" title="Permalink to this headline">¶</a></h2>
<p>This Recommendation provides the specifications of key establishment schemes that are appropriate for use by the U.S. Federal Government, based on standards developed by the Accredited Standards Committee (ASC) X9, Inc.: ANS X9.42 Agreement of Symmetric Keys using Discrete Logarithm Cryptography and ANS X9.63 Key Agreement and Key Transport using Elliptic Curve Cryptography. A key establishment scheme can be characterized as either a key agreement scheme or a key transport scheme. The asymmetric-key-based key agreement schemes in this Recommendation are based on the Diffie-Hellman (DH) and Menezes-Qu- Vanstone (MQV) algorithms. In addition, an asymmetric-key-based key transport scheme is specified. It is intended that an adjunct key establishment schemes Recommendation will contain key transport scheme(s) from ANS X9.44 Key Agreement and Key Transport using Factoring- Based Cryptography, when they become available.
This Recommendation provides a description of selected schemes from ANS X9 standards. When there are differences between this Recommendation and the referenced ANS X9 standards, this key establishment schemes Recommendation shall have precedence for U.S. Government applications.
This Recommendation is intended for use in conjunction with NIST Special Publication 800-57, Recommendation for Key Management [7]. This key establishment schemes Recommendation, the Recommendation for Key Management [7], and the referenced ANS X9 standards are intended to provide sufficient information for a vendor to implement secure key establishment using asymmetric algorithms in FIPS 140-2 [1] validated modules.
A scheme may be a component of a protocol, which in turn provides additional security properties not provided by the scheme when considered by itself. Note that protocols, per se, are not specified in this Recommendation.</p>
</div>
<div class="section" id="definitions-symbols-and-abbreviations">
<span id="nist-sp800-56a-3"></span><h2><a class="toc-backref" href="#id12">3. Definitions, Symbols and Abbreviations</a><a class="headerlink" href="#definitions-symbols-and-abbreviations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="definitions">
<span id="nist-sp800-56a-3-1"></span><h3><a class="toc-backref" href="#id13">3.1 Definitions</a><a class="headerlink" href="#definitions" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Key Establishment</p>
<div class="highlight-python"><pre>Key Establishment  = Key Agreement || Key Transport</pre>
</div>
<p>Key Devivation = CreateFrom( Another Key Meterial )</p>
<p class="last">Key Warp = Protect( Key )</p>
</div>
<dl class="glossary docutils">
<dt id="term-approved">Approved</dt>
<dd><p class="first">FIPS approved or NIST Recommended.</p>
<p class="last">An algorithm or technique that is either
1) specified in a FIPS or NIST Recommendation, or
2) adopted in a FIPS or NIST Recommendation and specified either
(a) in an appendix to the FIPS or NIST Recommendation, or
(b) in a document referenced by the FIPS or NIST Recommendation.</p>
</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-assurance-of-identifier">Assurance of identifier</dt>
<dd>Confidence that identifying information (such as a name) is correctly associated with an entity.</dd>
<dt id="term-assurance-of-possession-of-a-private-key">Assurance of possession of a private key</dt>
<dd>Confidence that an entity possesses a private key associated with a public key.</dd>
<dt id="term-assurance-of-validity">Assurance of validity</dt>
<dd>Confidence that either a key or a set of domain parameters is arithmetically correct.</dd>
<dt id="term-bit-length">Bit length</dt>
<dd>The length in bits of a bit string.</dd>
<dt id="term-authority-ca">Authority (CA)</dt>
<dd>The entity in a Public Key Infrastructure (PKI)
that is responsible for issuing public key certificates
and exacting compliance to a PKI policy.</dd>
<dt id="term-cofactor">Cofactor</dt>
<dd>The order of the elliptic curve group
divided by the (prime) order of the generator point
specified in the <a class="reference internal" href="#term-domain-parameters"><em class="xref std std-term">domain parameters</em></a>.</dd>
<dt id="term-domain-parameters">Domain parameters</dt>
<dd><p class="first">The parameters used with a cryptographic algorithm
that are common to a domain of users.</p>
<p class="last">(<a class="reference internal" href="#nist-sp800-56a-5-5"><em>5.5 Domain Parameters</em></a>)</p>
</dd>
<dt id="term-entity">Entity</dt>
<dd>An individual (person), organization, device, or process. “Party” is a synonym.</dd>
<dt id="term-ephemeral-key">Ephemeral key</dt>
<dd><p class="first">A key that is intended for a very short period of use.</p>
<p>The key is ordinarily used in exactly one transaction of a cryptographic scheme;
an exception to this is
when the ephemeral key is used in multiple transactions
for a key transport broadcast.</p>
<p class="last">Contrast with static key.</p>
</dd>
<dt id="term-hash-function">Hash function</dt>
<dd><p class="first">A function that maps a bit string of arbitrary length
to a fixed length bit string.</p>
<p>Approved hash functions satisfy the following properties:</p>
<ol class="arabic">
<li><p class="first">(One-way) It is computationally infeasible
to find any input that maps to any pre-specified output, and</p>
</li>
<li><dl class="first docutils">
<dt>(Collision resistant) It is computationally infeasible</dt>
<dd><p class="first last">to find any two distinct inputs that map to the same output.</p>
</dd>
</dl>
</li>
</ol>
<p class="last">Approved hash functions are specified in FIPS 180-2 [2].</p>
</dd>
<dt id="term-identifier">Identifier</dt>
<dd><p class="first">A bit string that is associated with a person,
device or organization.</p>
<p>It may be an identifying name,
or may be something more abstract
(for example, a string consisting of an IP address and timestamp).</p>
<p>If a party owns a static key pair
that is used in a key agreement transaction,
then the identifier assigned to that party is one
that is bound to that static key pair.</p>
<p class="last">If the party does not contribute a static public key
as part of a key agreement transaction,
then the identifier of that party is a non-null identifier
selected in accordance with the protocol utilizing the scheme.</p>
</dd>
<dt id="term-initiator">Initiator</dt>
<dd>The party that begins a key agreement transaction. Contrast with responder.</dd>
<dt id="term-key-agreement">Key agreement</dt>
<dd><p class="first">A <strong>key establishment procedure</strong>
where the resultant secret keying material is
a function of information contributed by two participants,
so that no party can predetermine the value of the secret keying material
independently from the contributions of the other parties.</p>
<p>Contrast with key transport.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>鍵合意 ( <a class="reference internal" href="#nist-sp800-56a-key-agreement"><em>6. Key Agreement</em></a> )</li>
<li>キーではなくパラメータを送る(交換する)ことでキーを暗黙に共有すること</li>
<li>キーを実際の送って共有する事が Key Transport￼</li>
</ul>
</div>
</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-key-agreement-transaction">￼Key agreement transaction</dt>
<dd><p class="first">The instance that results in <strong>shared secret</strong>
keying material among different parties
using a key agreement scheme.</p>
<p>confirmation
A procedure to provide <strong>assurance</strong> to one party
(the key confirmation recipient) that
another party (the key confirmation provider) actually possesses
the correct secret keying material and/or shared secret.</p>
<p>derivation
The process by which keying material is derived
from a shared secret and other information.</p>
<p>establishment
The procedure that results in shared secret keying material
among different parties.</p>
<p class="last">establishment transaction
An instance of establishing secret keying material
using a key establishment scheme.</p>
</dd>
</dl>
<dl class="glossary docutils">
<dt id="term-key-transport">￼Key transport</dt>
<dd><p class="first">A key establishment procedure
whereby one party (the sender) selects a value
for the secret keying material
and then securely distributes that value
to another party (the receiver).</p>
<p class="last">Contrast with key agreement.</p>
</dd>
<dt id="term-key-transport-transaction">Key transport transaction</dt>
<dd>The instance that results in shared secret keying material
between different parties using a key transport scheme.</dd>
<dt id="term-key-wrap">Key wrap</dt>
<dd>A method of encrypting keying material
(along with associated integrity information)
that provides both <strong>confidentiality</strong>
and <strong>integrity</strong> protection using a symmetric key algorithm.</dd>
<dt id="term-keying-material">Keying material</dt>
<dd><p class="first">The data that is necessary to establish and maintain
a cryptographic keying relationship.</p>
<p>Some keying material may be secret,
while other keying material may be public.</p>
<p class="last">As used in this Recommendation,
secret keying material may include <strong>keys</strong>,
<strong>secret initialization vectors</strong> or other <strong>secret information</strong>;
public keying material includes any non-secret data
needed to establish a relationship.</p>
</dd>
<dt id="term-mactag">MacTag</dt>
<dd><p class="first">Data that allows an entity to verify the integrity of the information.</p>
<p class="last">Other documents sometimes refer to this data as a MAC.</p>
</dd>
<dt id="term-message-authentication-code-mac-algorithm">Message Authentication Code (MAC) algorithm</dt>
<dd><p class="first">Defines a family of one-way cryptographic functions
that is parameterized by a symmetric key and
produces a MacTag on arbitrary data.</p>
<p>A MAC algorithm can be used to provide data origin authentication
as well as data integrity.</p>
<p class="last">In this Recommendation,
a MAC algorithm is used for key confirmation and validation testing purposes.</p>
</dd>
<dt id="term-nonce">Nonce</dt>
<dd><p class="first">A time-varying value that has at most a negligible chance of repeating,
for example,
a random value that is generated anew for each use,
a timestamp, a sequence number, or some combination of these.</p>
<p class="last"><a class="reference internal" href="#nist-sp800-56a-5-4"><em>5.4 Nonces</em></a></p>
</dd>
<dt id="term-owner">Owner</dt>
<dd><p class="first">For a static key pair,
the owner is the entity that is authorized to use the static private key
associated with a public key,
whether that entity generated the static key pair itself
or a trusted party generated the key pair for the entity.</p>
<p class="last">For an <a class="reference internal" href="#term-ephemeral-key"><em class="xref std std-term">ephemeral key</em></a> pair,
the owner is the entity that generated the key pair.</p>
</dd>
<dt id="term-party">Party</dt>
<dd><p class="first">An individual (person),
organization, device, or process.</p>
<p class="last">“<em class="xref std std-term">Entity”</em> is a synonym for party.</p>
</dd>
<dt id="term-provider">Provider</dt>
<dd>The party during key confirmation that provides assurance
to the other party (the recipient)
that the two parties have indeed established a shared secret.</dd>
<dt id="term-public-key-certificate">Public key certificate</dt>
<dd>A set of data that contains an entity’s identifier(s),
the entity&#8217;s public key (including an indication of
the associated set of domain parameters, if any)
and possibly other information,
and is digitally signed by a trusted party,
thereby binding the public key to the included identifier(s).</dd>
<dt id="term-receiver">Receiver</dt>
<dd><p class="first">The party that receives secret keying material
via a key <em class="xref std std-term">transport transaction</em>.</p>
<p class="last">Contrast with <a class="reference internal" href="#term-sender"><em class="xref std std-term">sender</em></a>.</p>
</dd>
<dt id="term-recipient">Recipient</dt>
<dd><p class="first">A party that receives
(1) keying material:
such as a static public key
(e.g., in a certificate) or an ephemeral public key;
(2) assurance:
such as an assurance of the validity of a candidate public key
or assurance of possession of the private key
associated with a public key; or
(3) key confirmation.</p>
<p class="last">Contrast with <a class="reference internal" href="#term-provider"><em class="xref std std-term">provider</em></a>.</p>
</dd>
<dt id="term-responder">Responder</dt>
<dd><p class="first">The party that does not begin a key agreement transaction.</p>
<p class="last">Contrast with <a class="reference internal" href="#term-initiator"><em class="xref std std-term">initiator</em></a>.</p>
</dd>
<dt id="term-scheme">Scheme</dt>
<dd><p class="first">A (cryptographic) scheme consists of an unambiguous specification
of a set of transformations
that are capable of providing a (cryptographic) service
when properly implemented and maintained.</p>
<p class="last">A scheme is a higher level construct
than a primitive and a lower level construct than a protocol.</p>
</dd>
<dt id="term-security-strength"><span id="term-also-bits-of-security"></span>Security strength<br />(Also “Bits of security”)</dt>
<dd>A number associated with the amount of work
(that is, the number of operations)
that is required to break a cryptographic algorithm or system.</dd>
<dt id="term-security-properties">Security properties</dt>
<dd>The security features
(e.g., entity authentication, playback protection,
or key confirmation)
that a cryptographic scheme may, or may not, provide.</dd>
<dt id="term-sender">Sender</dt>
<dd>The party that sends secret keying material
to the receiver using a key transport transaction.</dd>
<dt id="term-shall">Shall</dt>
<dd><p class="first">This term is used to indicate a requirement of
a Federal Information processing Standard (FIPS)
or a requirement that needs to be fulfilled
to claim conformance to this Recommendation.</p>
<p class="last">Note that shall may be coupled with not to become shall not.</p>
</dd>
<dt id="term-shared-secret-keying-material">Shared secret keying material</dt>
<dd>The secret keying material that is either
(1) <strong>derived</strong> by applying the key derivation function
to the shared secret and other shared information
during a key agreement process, or
(2) is <strong>transported</strong> during a key transport process.</dd>
<dt id="term-shared-secret">Shared secret</dt>
<dd>A secret value that has been computed
using a key agreement scheme
and is used as input to a key derivation function.</dd>
<dt id="term-should">￼Should</dt>
<dd><p class="first">This term is used to indicate an important recommendation.</p>
<p>Ignoring the recommendation could result in undesirable results.</p>
<p class="last">Note that should may be coupled with not to become should not.</p>
</dd>
<dt id="term-static-key">Static key</dt>
<dd><p class="first">A key that is intended for use
for a <strong>relatively long period of time</strong> and
is typically intended for use in many instances
of a cryptographic key establishment scheme.</p>
<p class="last">Contrast with an <a class="reference internal" href="#term-ephemeral-key"><em class="xref std std-term">ephemeral key</em></a>.
￼</p>
</dd>
<dt id="term-symmetric-key-algorithm">Symmetric key algorithm</dt>
<dd>A cryptographic algorithm
that uses one secret key that is <strong>shared</strong>
between authorized parties.</dd>
<dt id="term-trusted-party">Trusted party</dt>
<dd><p class="first">A trusted party is a party that is trusted by an entity
to faithfully perform certain services for that entity.</p>
<p class="last">An entity may choose to act as a trusted party for itself.</p>
</dd>
<dt id="term-third-party">third party</dt>
<dd><p class="first">A third party, such as a CA,
that is trusted by its clients to perform certain services.</p>
<p class="last">(By contrast, the initiator and responder in a scheme
are considered to be the first
and second parties in a key establishment transaction.)</p>
</dd>
</dl>
</div>
<div class="section" id="symbols-and-abbreviations">
<span id="nist-sp800-56a-3-2"></span><h3><a class="toc-backref" href="#id14">3.2 Symbols and Abbreviations</a><a class="headerlink" href="#symbols-and-abbreviations" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aes">AES</dt>
<dd>Advanced Encryption Standard (as specified in FIPS 197 [4]).</dd>
<dt id="term-asc">ASC</dt>
<dd>The American National Standards Institute (ANSI) Accredited Standards Committee.</dd>
<dt id="term-ans">ANS</dt>
<dd>American National Standard.</dd>
<dt id="term-asn-1">ASN.1</dt>
<dd>Abstract Syntax Notation One.</dd>
<dt id="term-ca">CA</dt>
<dd>Certification Authority.</dd>
<dt id="term-cdh">CDH</dt>
<dd>The cofactor Diffie-Hellman key agreement primitive.</dd>
<dt id="term-"><span id="term-dh"></span>￼￼<br />DH</dt>
<dd>The (non-cofactor) Diffie-Hellman key agreement primitive.</dd>
<dt id="term-50"><span id="term-dlc"></span>￼￼<br />DLC</dt>
<dd>離散対数暗号。
Discrete Logarithm Cryptography,
which is comprised of both Finite Field Cryptography (FFC) and Elliptic Curve Cryptography (ECC).</dd>
<dt id="term-52"><span id="term-ec"></span>￼￼￼<br />EC</dt>
<dd>Elliptic Curve.</dd>
<dt id="term-54"><span id="term-55"></span><span id="term-ecc"></span>￼<br />￼￼<br />ECC</dt>
<dd><p class="first">Elliptic Curve Cryptography,
the public key cryptographic methods using an elliptic curve.</p>
<p class="last">For example, see ANS X9.63 [12].</p>
</dd>
<dt id="term-57"><span id="term-ff"></span>￼￼<br />FF</dt>
<dd>Finite Field.</dd>
<dt id="term-59"><span id="term-ffc"></span>￼￼<br />FFC</dt>
<dd><p class="first">Finite Field Cryptography,
the public key cryptographic methods using a finite field.</p>
<p class="last">For example, see ANS X9.42 [10].</p>
</dd>
<dt id="term-61"><span id="term-hmac"></span>￼￼<br />HMAC</dt>
<dd>Keyed-hash Message Authentication Code (as specified in FIPS 198 [5]).</dd>
<dt id="term-63"><span id="term-id"></span>￼<br />ID</dt>
<dd>The bit string denoting the identifier associated with an entity.</dd>
<dt id="term-65"><span id="term-h"></span>￼￼<br />H</dt>
<dd>An Approved hash function.</dd>
<dt id="term-67"><span id="term-kc"></span>￼￼<br />KC</dt>
<dd>Key Confirmation.</dd>
<dt id="term-69"><span id="term-kdf"></span>￼￼<br />KDF</dt>
<dd>Key Derivation Function.</dd>
<dt id="term-71"><span id="term-mac"></span>￼￼<br />MAC</dt>
<dd>Message Authentication Code.</dd>
<dt id="term-73"><span id="term-mqv"></span>￼￼<br />MQV</dt>
<dd>The Menezes-Qu-Vanstone key agreement primitive.</dd>
<dt id="term-75"><span id="term-null"></span>￼￼<br />Null</dt>
<dd>The empty bit string</dd>
<dt id="term-77"><span id="term-sha"></span>￼￼<br />SHA</dt>
<dd>Secure Hash Algorithm.</dd>
<dt id="term-79"><span id="term-ttp"></span>￼￼<br />TTP</dt>
<dd>A Trusted Third Party.</dd>
<dt id="term-81"><span id="term-u"></span>￼￼<br />U</dt>
<dd>The initiator of a key establishment process.</dd>
<dt id="term-83"><span id="term-v"></span>￼￼<br />V</dt>
<dd>The responder in a key establishment process.</dd>
<dt id="term-85"><span id="term-86"></span><span id="term-x"></span>￼￼<br />￼<br />{X}</dt>
<dd>Indicates that the inclusion of X is optional.</dd>
<dt id="term-x-y">X || Y</dt>
<dd>Concatenation of two strings X and Y.</dd>
<dt id="term-89"><a href="#id7"><span class="problematic" id="id8">|x|</span></a></dt>
<dd>The length of x in bits.</dd>
<dt id="term-a-b">[a, b]</dt>
<dd>The set of integers x such that a≤x≤b.</dd>
<dt id="term-91">⎡x⎤</dt>
<dd>The ceiling of x; the smallest integer ≥ x. For example, ⎡5⎤ = 5, ⎡5.3⎤ = 6.</dd>
</dl>
<ul class="simple">
<li>FCC</li>
<li>ECC</li>
</ul>
</div>
</div>
<div class="section" id="key-establishment-schemes-overview">
<span id="nist-sp800-56a-4"></span><h2><a class="toc-backref" href="#id15">4. Key Establishment Schemes Overview</a><a class="headerlink" href="#key-establishment-schemes-overview" title="Permalink to this headline">¶</a></h2>
<p>Secret cryptographic keying material may be electronically established
between parties by using a key establishment scheme,
that is,
by using either a <a class="reference internal" href="#term-key-agreement"><em class="xref std std-term">key agreement</em></a> scheme or a <em class="xref std std-term">key transport</em> scheme.</p>
<p>During <a class="reference internal" href="#term-key-agreement"><em class="xref std std-term">key agreement</em></a>
(where both parties contribute to the <a class="reference internal" href="#term-shared-secret"><em class="xref std std-term">shared secret</em></a> and, therefore,
the derived <em class="xref std std-term">secret keying material</em>),
the secret keying material to be established is not sent directly;
rather,
information is exchanged between both parties that
allows each party to <strong>derive</strong> the secret keying material.</p>
<p>Key agreement schemes may use either symmetric key
or asymmetric key (public key) techniques.</p>
<p>The key agreement schemes described
in this Recommendation use public key techniques.</p>
<p>The party that begins a key agreement scheme is called the <a class="reference internal" href="#term-initiator"><em class="xref std std-term">initiator</em></a>,
and the other party is called the <a class="reference internal" href="#term-responder"><em class="xref std std-term">responder</em></a>.</p>
<p>During <em class="xref std std-term">key transport</em>
(where one party selects the secret keying material),
<strong>wrapped</strong> (that is, <strong>encrypted</strong>) secret keying material is transported
from the sender to the receiver.</p>
<p>Key transport schemes may use either symmetric key or public key techniques;
only key transport schemes based on <em class="xref std std-term">Discrete Logarithm Cryptography</em> (DLC) cryptography
are described in this Recommendation.</p>
<p>The party that sends the secret keying material is called the <a class="reference internal" href="#term-sender"><em class="xref std std-term">sender</em></a>,
and the other party is called the <a class="reference internal" href="#term-receiver"><em class="xref std std-term">receiver</em></a>.</p>
<p>The security of the DLC schemes in this Recommendation
is based on the intractability of the discrete logarithm problem.</p>
<p>The schemes calculated over a finite field (FF) are based on ANS X9.42.</p>
<p>The schemes calculated using elliptic curves (EC) are based on ANS X9.63.</p>
<div class="section" id="key-agreement-preparations-by-an-owner">
<span id="nist-sp800-56a-4-1"></span><h3><a class="toc-backref" href="#id16">4.1 Key Agreement Preparations by an Owner</a><a class="headerlink" href="#key-agreement-preparations-by-an-owner" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">キーオーナーの準備</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first"><a class="reference internal" href="#nist-sp800-56a-5-5-1"><em>ドメインパラメータを選ぶ</em></a></p>
</li>
<li><p class="first"><a class="reference internal" href="#nist-sp800-56a-5-5-2"><em>ドメインパラメータの検証</em></a></p>
</li>
<li><p class="first">キーペアの取得</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>キーペアの生成</em></a></li>
<li><a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>信頼できる相手から生成してもらう</em></a></li>
</ul>
</div></blockquote>
</li>
<li><p class="first">キーペアの検証</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#nist-sp800-56a-5-6-2-1"><em>ただしパブリックキーか?</em></a></li>
<li><a class="reference internal" href="#nist-sp800-56a-5-6-3-1"><em>プライベートキーの正式な所持者か？</em></a>.</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
</ul>
</div>
<p>The owner of a private/public key pair is the entity
that is authorized to use the private key of that key pair.</p>
<p>Figure 1 depicts the steps
that may be required of that entity when preparing for a key agreement process.</p>
<p>The first step is to obtain appropriate <a class="reference internal" href="#term-domain-parameters"><em class="xref std std-term">domain parameters</em></a>
that are generated as specified in <a class="reference internal" href="#nist-sp800-56a-5-5-1"><em>Section 5.5.1</em></a>;
either the entity itself generates the domain parameters,
or the entity obtains domain parameters that another entity has generated.</p>
<p>Having obtained the domain parameters,
the entity obtains assurance of the validity of those domain parameters;
approved methods for obtaining this assurance are provided in Section <a class="reference internal" href="#nist-sp800-56a-5-5-2"><em>5.5.2</em></a>.</p>
<p>If the entity will be using a key establishment scheme
that requires that the entity have a <em class="xref std std-term">static key pair</em>,
the entity obtains this key pair.</p>
<p>Either the entity generates the key pair
as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>Section 5.6.1</em></a>
or a trusted party generates the key pair
as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>Section 5.6.1</em></a>
and provides it to the entity.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assuranceについて</p>
</div>
<p>The <a class="reference internal" href="oauth_regtoken.html#term-entity"><em class="xref std std-term">entity</em></a> (i.e., the <a class="reference internal" href="#term-owner"><em class="xref std std-term">owner</em></a>) obtains
assurance of the validity of its static public key and
also obtains assurance
that it actually possesses the (correct) static private key.</p>
<p>Approved methods for obtaining assurance of public key validity
by the owner are addressed in <a class="reference internal" href="#nist-sp800-56a-5-6-2-1"><em>Section 5.6.2.1</em></a>;
approved methods for an owner to obtain
assurance of the actual possession of the private key
are provided in <a class="reference internal" href="#nist-sp800-56a-5-6-3-1"><em>Section 5.6.3.1</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>識別子</li>
</ul>
</div>
<p>An <a class="reference internal" href="session.html#term-identifier"><em class="xref std std-term">identifier</em></a> (see <a class="reference internal" href="#nist-sp800-56a-3-1"><em>Section 3.1</em></a>)
is used to label the <a class="reference internal" href="oauth_regtoken.html#term-entity"><em class="xref std std-term">entity</em></a> that is authorized
to use the <em class="xref std std-term">static private key</em>
corresponding to a particular <em class="xref std std-term">static public key</em>
(i.e., the identifier labels the key pair’s owner).</p>
<p>This label may uniquely distinguish the entity from all others,
in which case it could rightfully be considered an identity.</p>
<p>However,
the label may be something less specific –
an organization, nickname, etc. – hence,
the term identifier is used in this Recommendation,
rather than the term identity.</p>
<p>A key pair’s owner is responsible for ensuring that the identifier
associated with its static public key is appropriate
for the applications in which it will be used.</p>
</div>
<div class="section" id="key-agreement-process">
<span id="nist-sp800-56a-4-2"></span><h3><a class="toc-backref" href="#id17">4.2 Key Agreement Process</a><a class="headerlink" href="#key-agreement-process" title="Permalink to this headline">¶</a></h3>
<p>Figure 2 depicts the steps
that may be required of an <a class="reference internal" href="oauth_regtoken.html#term-entity"><em class="xref std std-term">entity</em></a> when establishing secret keying material
with another entity
using one of the key agreement schemes
described in this Recommendation;
however,
some discrepancies in order may occur,
depending on the communication protocol in which the key agreement process is performed.</p>
<p>Depending on the key agreement scheme
and the available keys,
either entity could be the key agreement <a class="reference internal" href="#term-initiator"><em class="xref std std-term">initiator</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>スキームとキーの準備情況に応じてどっちが起点かは異なる</li>
</ul>
</div>
<p>Note that some of the shown actions may not be a part of some schemes.</p>
<p>For example,
key confirmation is optional (see <em class="xref std std-ref">Section 8</em>).</p>
<p>The specifications of this recommendation indicate
when a particular action is required.</p>
<p>Each entity obtains the identifier associated with the other entity,
and verifies that the identifier of the other entity
corresponds to the entity with
whom the participant wishes to establish secret keying material.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>スタティックキーが欲しいとき</li>
</ul>
</div>
<p>Each entity that requires the other entity’s static public key for use
in the key establishment scheme obtains that
public key and obtains assurance of its validity.</p>
<p>Approved methods for obtaining assurance of
the validity of a static public key are provided in <a class="reference internal" href="#nist-sp800-56a-5-6-2-2"><em>Section 5.6.2.2</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>一時キーが欲しいとき</li>
</ul>
</div>
<p>Each entity that requires the other entity’s ephemeral public key for use
in the key establishment scheme obtains
that public key and obtains assurance of its validity.</p>
<p>Ephemeral key pairs are generated as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>Section 5.6.1</em></a>;
the ephemeral private key is not provided to the other entity.</p>
<p>Approved methods for obtaining assurance of the validity of an ephemeral public key
are provided in <a class="reference internal" href="#nist-sp800-56a-5-6-2-3"><em>Section 5.6.2.3</em></a>.</p>
<p>If the key agreement scheme requires that
an entity provide a <a class="reference internal" href="standard.html#term-nonce"><em class="xref std std-term">nonce</em></a>,
the nonce is generated as specified in <em class="xref std std-term">Section 5.4</em>
and provided to the other entity.</p>
<p>If one or both of the participants wish to confirm
that the other entity has computed the same <a class="reference internal" href="#term-shared-secret"><em class="xref std std-term">shared secret</em></a>
or the same <em class="xref std std-term">secret keying material</em>
as part of the key agreement process,
<em class="xref std std-term">key confirmation</em> is performed as specified in <em class="xref std std-ref">Section 8.4</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>永続プライベートキーの所有の妥当性はスペックの範囲外</li>
</ul>
</div>
<p>Assurance of static private key possession is obtained
prior to using the derived keying material for purposes
beyond those of the key agreement transaction itself
(see <a class="reference internal" href="#nist-sp800-56a-5-6-3-2"><em>Section 5.6.3.2</em></a>).</p>
</div>
<div class="section" id="dlc-based-key-transport-process">
<span id="nist-sp800-56a-4-3"></span><h3><a class="toc-backref" href="#id18">4.3 DLC-based Key Transport Process</a><a class="headerlink" href="#dlc-based-key-transport-process" title="Permalink to this headline">¶</a></h3>
<p>Figure 3 depicts the steps that are performed when transporting secret keying material from one entity to another using a key transport scheme. Depending on the available keys, either entity could be the key transport sender. Prior to performing key transport, a key-wrapping key is established by using a key agreement process as specified in Section 7. Key confirmation may be performed to obtain assurance that both parties possess the same key-wrapping key. The sender selects secret keying material to be sent to the other entity, wraps the keying material using the key-wrapping key and sends the wrapped keying material to the other entity. The receiving entity
receives the wrapped keying material and unwraps it using the previously established key- wrapping key.</p>
</div>
</div>
<div class="section" id="cryptographic-elements">
<span id="nist-sp800-56a-5"></span><h2><a class="toc-backref" href="#id19">5. Cryptographic Elements</a><a class="headerlink" href="#cryptographic-elements" title="Permalink to this headline">¶</a></h2>
<p>This section describes the basic computations that are performed and the assurances that need to be obtained when performing DLC based key establishment. The schemes described in Section 6 are based upon the correct implementation of these computations and assurances.
Tables 1 and 2 of Section 5.5 list parameter size sets to be used in the selection of cryptographic elements. All cryptographic elements used together shall be selected in accordance with the same parameter size set.</p>
<div class="section" id="cryptographic-hash-functions">
<span id="nist-sp800-56a-5-1"></span><h3><a class="toc-backref" href="#id20">5.1 Cryptographic Hash Functions</a><a class="headerlink" href="#cryptographic-hash-functions" title="Permalink to this headline">¶</a></h3>
<p>An Approved hash function shall be used when a hash function is required (for example, for the key derivation function or to compute a MAC when HMAC, as specified in FIPS 198, is used). FIPS 180-2 [2] specifies Approved hash functions. The hash function shall be selected in accordance with the parameter lists in Tables 1 and 2 of Section 5.5.</p>
</div>
<div class="section" id="message-authentication-code-mac-algorithm">
<span id="nist-sp800-56a-5-2"></span><h3><a class="toc-backref" href="#id21">5.2 Message Authentication Code (MAC) Algorithm</a><a class="headerlink" href="#message-authentication-code-mac-algorithm" title="Permalink to this headline">¶</a></h3>
<p>A Message Authentication Code (MAC) algorithm defines a family of one-way (MAC) functions that is parameterized by a symmetric key. In key establishment schemes, an entity is sometimes required to compute a MacTag on received or derived data using the MAC function determined by a symmetric key derived from a shared secret. The MacTag is sent to another entity in order to confirm that the shared secret was correctly computed. An Approved MAC algorithm shall be used to compute a MacTag, for example, HMAC [5].</p>
<p>The MAC algorithm is used to provide key confirmation as specified in this Recommendation when key confirmation is desired, and is used to validate implementations of the key establishment schemes specified in this Recommendation (see Section 5.2.3). MacTag computation and checking are defined in Sections 5.2.1 and 5.2.2 of this Recommendation.</p>
<div class="section" id="mactag-computation">
<span id="nist-sp800-56a-5-2-1"></span><h4><a class="toc-backref" href="#id22">5.2.1 MacTag Computation</a><a class="headerlink" href="#mactag-computation" title="Permalink to this headline">¶</a></h4>
<p>The computation of the MacTag is represented as follows:</p>
<div class="highlight-python"><pre>MacTag = MAC(MacKey, MacLen, MacData).</pre>
</div>
<p>The MacTag computation shall be performed using an Approved MAC algorithm. In the above equation, MAC represents an Approved MAC algorithm; MacKey represents a symmetric key obtained from the DerivedKeyingMaterial (see Section 5.8); MacLen represents the length of MacTag; and MacData represents the data on which the MacTag is computed. The minimum for MacLen is specified in Tables 1 and 2 of Section 5.5. The minimum size for MacKey is also specified in Tables 1 and 2. See [5] and [6].</p>
</div>
<div class="section" id="mactag-checking">
<span id="nist-sp800-56a-5-2-2"></span><h4><a class="toc-backref" href="#id23">5.2.2 MacTag Checking</a><a class="headerlink" href="#mactag-checking" title="Permalink to this headline">¶</a></h4>
<p>To check a received MacTag (e.g., received during key confirmation and/or implementation validation), a new MacTag is computed—using the values of MacKey, MacLen, and MacData possessed by the recipient (as specified in Section 5.2.1). The new MacTag is compared with the received MacTag. If their values are equal, then it may be inferred that the same MacKey, MacLen, and MacData values were used in the two MacTag computations.</p>
</div>
<div class="section" id="implementation-validation-message">
<span id="nist-sp800-56a-5-2-3"></span><h4><a class="toc-backref" href="#id24">5.2.3 Implementation Validation Message</a><a class="headerlink" href="#implementation-validation-message" title="Permalink to this headline">¶</a></h4>
<p>For purposes of validating an implementation of the schemes in this Recommendation during an implementation validation test (under the NIST Cryptographic Validation Program), the value of MacData shall be the string “Standard Test Message”, followed by a 16-byte field for a nonce. The default value for this field is all binary zeros. Different values for this field will be specified during testing. This is for the purposes of testing when no key confirmation capability exists (see Section 10).
Note: ANS X9.42 defines MacData as “ANSI X9.42 Testing Message”. ANS X9.63 does not address implementation validation at this level of detail. The implementation test message used for NIST validation is a different text string from the implementation test message for ANS X9.42 validation.</p>
</div>
</div>
<div class="section" id="random-number-generation">
<span id="nist-sp800-56a-5-3"></span><h3><a class="toc-backref" href="#id25">5.3 Random Number Generation</a><a class="headerlink" href="#random-number-generation" title="Permalink to this headline">¶</a></h3>
<p>Whenever this Recommendation requires the use of a randomly generated value (for example, for keys or nonces), the values shall be generated using an Approved random bit generator (RBG) providing an appropriate security strength.</p>
</div>
<div class="section" id="nonces">
<span id="nist-sp800-56a-5-4"></span><h3><a class="toc-backref" href="#id26">5.4 Nonces</a><a class="headerlink" href="#nonces" title="Permalink to this headline">¶</a></h3>
<p>A nonce is a time-varying value that has (at most) a negligible chance of repeating. For example, a nonce may be composed of one (or more) of the following components:</p>
<ol class="arabic simple">
<li>A random value that is generated anew for each nonce, using an Approved random bit generator. The security strength of the random bit generator and the entropy of the nonce shall be at least one half of the minimum required bit length of the subgroup order (as specified in Tables 1 and 2 of Section 5.5). A nonce containing a component of this type is called a random nonce.</li>
<li>A timestamp of sufficient resolution (detail) so that it is different each time it is used.</li>
<li>A monotonically increasing sequence number, or</li>
<li>A combination of a timestamp and a monotonically increasing sequence number such that the sequence number is reset only when the timestamp changes. (For example, a timestamp may show the date but not the time of day, so a sequence number is appended that will not repeat during a particular day.)</li>
</ol>
<p>Nonces are used, for example, in implementation validation testing (Section 5.2.3), in C(0, 2) schemes (Section 6.3), and in key confirmation (Section 8).
When using a nonce, a random nonce should be used.</p>
</div>
<div class="section" id="domain-parameters">
<span id="nist-sp800-56a-5-5"></span><h3><a class="toc-backref" href="#id27">5.5 Domain Parameters</a><a class="headerlink" href="#domain-parameters" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ドメインパラメータで 公開鍵秘密鍵ペアを作る</p>
</div>
<p>Discrete Logarithm Cryptography (DLC),
which includes Finite Field Cryptography (FFC)
and Elliptic Curve Cryptography (ECC),
requires that the public and private key pairs be generated
with respect to a particular set of domain parameters.</p>
<p>A candidate set of domain parameters is said to be valid
when it conforms to all the requirements specified in this Recommendation.</p>
<p>A user of a candidate set of domain parameters
(for example, either an initiator or a responder)
shall have assurance of domain parameter validity
prior to using them.</p>
<p>Although domain parameters are public information,
they shall be managed so that the correct correspondence
between a given key pair and its set of domain parameters is maintained
for all parties that use the key pair.</p>
<p>Domain parameters may remain fixed for an extended time period,
and one set of domain parameters may be used
with multiple key pairs and with multiple key establishment schemes.</p>
<p>Some schemes in ANS X9.42 and X9.63 allow the set of domain parameters used and associated with static keys to be different from the set of domain parameters used and associated with ephemeral keys.</p>
<p>For this Recommendation, however, only one set of domain parameters shall be used during any key establishment transaction using a given run of a scheme (that is, the static- key domain parameters and the ephemeral-key domain parameters used in one scheme shall be the same).</p>
<div class="section" id="domain-parameter-generation">
<span id="nist-sp800-56a-5-5-1"></span><h4><a class="toc-backref" href="#id28">5.5.1 Domain Parameter Generation</a><a class="headerlink" href="#domain-parameter-generation" title="Permalink to this headline">¶</a></h4>
<div class="section" id="ffc-domain-parameter-generation">
<span id="nist-sp800-56a-5-5-1-1"></span><h5><a class="toc-backref" href="#id29">5.5.1.1 FFC Domain Parameter Generation</a><a class="headerlink" href="#ffc-domain-parameter-generation" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>p :おおきな素数フィールドオーダー</li>
<li>q :小さな素数(かけ算用)サブグループオーダー</li>
<li>g :q-orderのGF(p)のサイクルサブグループ</li>
</ul>
</div>
<p>Domain parameters for FFC schemes are of the form
(p, q, g{, SEED, pgenCounter}), where
p is the (larger) prime field order,
q is the (smaller) prime (multiplicative) subgroup order,
g is a generator of the q-order cyclic subgroup of GF(p)*,
and SEED and pgenCounter are optional values used in the canonical process
of generating and validating p and q, and possibly g,
depending on the method of generation.</p>
<p>FFC Domain parameters shall be generated
using a method specified in FIPS 186-3 [3]
based on a parameter size set selected from Table 1.</p>
<p>As shown in Table 1, there are three parameter size sets (named FA through FC) for FFC; all the parameters of a particular set shall be used together. For U.S. government applications, one or more sets shall be selected based on the solution requirements. See the comparable security table in the Recommendation for Key Management [7] to assess the comparable security of any particular parameter size set. The Recommendation for Key Management [7] provides guidance on selecting an appropriate security strength and an appropriate FFC parameter set. If the appropriate security strength does not have an FFC parameter set, then Elliptic Curve Cryptography should be used (see Section 5.5.1.2).
For this Recommendation, the size of p (public key size) is a multiple of 1024 bits; the exact length depends on the FFC parameter set selected. For this Recommendation, the size of q is a specific bit length depending on the FFC parameter set selected.</p>
</div>
<div class="section" id="ecc-domain-parameter-generation">
<span id="nist-sp800-56a-5-5-1-2"></span><h5><a class="toc-backref" href="#id30">5.5.1.2 ECC Domain Parameter Generation</a><a class="headerlink" href="#ecc-domain-parameter-generation" title="Permalink to this headline">¶</a></h5>
<p>Domain parameters for ECC schemes are of the form (q, FR, a, b{, SEED}, G, n, h), where q is the field size; FR is an indication of the basis used; a and b are two field elements that define the equation of the curve; SEED is an optional bit string that is included if the elliptic curve was randomly generated in a verifiable fashion; G is a generating point (possibly generated from the SEED) consisting of (xG, yG) of prime order on the curve; n is the order of the point G; and h is the cofactor (which is equal to the order of the curve divided by n). Note that the field size q may be either an odd prime p or 2m, where m is a prime.</p>
<p>As shown in Table 2, there are five parameter size sets (named EA, EB, EC, ED and EE) for ECC; all the members of a particular set shall be used together. For U.S. government applications, one or more sets shall be selected based on the solution requirements. See the comparable security table in the Recommendation for Key Management [7] to assess the comparable security of any particular parameter size set. The Recommendation for Key Management [7] provides guidance on selecting the appropriate security strength and an appropriate ECC key size.
The five different cofactor maximums each ensure that the subgroup of order n is unique and that cofactor multiplication is reasonably efficient. The ECC domain parameters shall either be generated as specified in ANS X9.62 [13] or selected from the recommended elliptic curve domain parameters specified in FIPS 186-3 [3]. (Note: ANS X9.62, rather than ANS X9.63, specifies the most current method of generating ECC domain parameters at the time of writing this Recommendation.)</p>
</div>
</div>
<div class="section" id="assurances-of-domain-parameter-validity">
<span id="nist-sp800-56a-5-5-2"></span><h4><a class="toc-backref" href="#id31">5.5.2 Assurances of Domain Parameter Validity</a><a class="headerlink" href="#assurances-of-domain-parameter-validity" title="Permalink to this headline">¶</a></h4>
<p>Secure key establishment depends on the arithmetic validity of the set of domain parameters used by the parties. Each party shall have assurance of the validity of a candidate set of domain parameters. Each party shall obtain assurance that the candidate set of domain parameters is valid in at least one of the following three ways:</p>
<ol class="arabic simple">
<li>The party itself generates the set of domain parameters according to the requirements specified in Section 5.5.1.</li>
</ol>
<p>2. The party performs an explicit domain parameter validation as specified in:
a. FIPS 186-3 for FFC based on a parameter size set selected from Table 1.
b. ANS X9.62-2 for ECC.
3. The party has received assurance from a trusted third party (for example, a CA or NIST2) that the set of domain parameters was valid at the time that they were generated by reason of either method 1 or 2 above.</p>
<p>Note: Some domain parameters have been generated using SHA-1, and SHA-1 will be required during their validation. At some time in the future, it is expected that SHA-1 will no longer be an Approved hash function. However, if a set of domain parameters was successfully validated with SHA-1 while it was still an Approved hash function, then those domain parameters will continue to qualify as valid even after the use of SHA-1 is no longer Approved. In particular, this is true of the NIST Recommended Elliptic Curves.
The application performing the key establishment on behalf of the party should determine whether or not to allow key establishment based upon the method(s) of assurance that was used. Such knowledge may be explicitly provided to the application in some manner, or may be implicitly provided by the operation of the application itself.</p>
</div>
<div class="section" id="domain-parameter-management">
<span id="nist-sp800-56a-5-5-3"></span><h4><a class="toc-backref" href="#id32">5.5.3 Domain Parameter Management</a><a class="headerlink" href="#domain-parameter-management" title="Permalink to this headline">¶</a></h4>
<p>A particular set of domain parameters shall be protected against modification or substitution until the set is deactivated (if and when it is no longer needed).</p>
<p>Each private/public key pair shall be correctly associated with its specific set of domain parameters.</p>
</div>
</div>
<div class="section" id="private-and-public-keys">
<span id="nist-sp800-56a-5-6"></span><h3><a class="toc-backref" href="#id33">5.6 Private and Public Keys</a><a class="headerlink" href="#private-and-public-keys" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">キーペアの生成、公開鍵妥当性、秘密鍵の所有確認、管理</p>
</div>
<p>This section specifies
requirements for the generation of key pairs,
assurances of public key validity,
assurances of private key possession, and
key pair management.</p>
<div class="section" id="private-public-key-pair-generation">
<span id="nist-sp800-56a-5-6-1"></span><h4><a class="toc-backref" href="#id34">5.6.1 Private/Public Key Pair Generation</a><a class="headerlink" href="#private-public-key-pair-generation" title="Permalink to this headline">¶</a></h4>
<div class="section" id="ffc-key-pair-generation">
<span id="nist-sp800-56a-5-6-1-1"></span><h5><a class="toc-backref" href="#id35">5.6.1.1 FFC Key Pair Generation</a><a class="headerlink" href="#ffc-key-pair-generation" title="Permalink to this headline">¶</a></h5>
<p>For the FFC schemes, each static and ephemeral private key and public key shall be generated using an Approved method and the selected valid domain parameters (p, q, g{, SEED, pgenCounter}) (see Appendix B of FIPS 186-3). Each private key shall be unpredictable and shall be generated in the range [1, q-1] using an Approved random bit generator. The static public key y is computed from the static private key x by using the following formula: y = gx mod p. Similarly the ephemeral public key t is computed from the ephemeral private key r by using the following formula: t = gr mod p.</p>
</div>
<div class="section" id="ecc-key-pair-generation">
<span id="nist-sp800-56a-5-6-1-2"></span><h5><a class="toc-backref" href="#id36">5.6.1.2 ECC Key Pair Generation</a><a class="headerlink" href="#ecc-key-pair-generation" title="Permalink to this headline">¶</a></h5>
<p>For the ECC schemes,
each static and ephemeral private key <strong>d</strong> and public key <strong>Q</strong>
shall be generated using an Approved method and the selected domain parameters
(q, FR, a, b{, SEED}, G, n, h)
(see Appendix B of FIPS 186-3).</p>
<p>Each private key, <strong>d</strong>, shall be unpredictable
and shall be generated in the range [1, n-1]
using an Approved random bit generator.</p>
<p>The public key <strong>Q</strong> is computed by
using the following formula: Q = (xQ, yQ) = dG.</p>
</div>
</div>
<div class="section" id="assurances-of-the-arithmetic-validity-of-a-public-key">
<span id="nist-sp800-56a-5-6-2"></span><h4><a class="toc-backref" href="#id37">5.6.2 Assurances of the Arithmetic Validity of a Public Key</a><a class="headerlink" href="#assurances-of-the-arithmetic-validity-of-a-public-key" title="Permalink to this headline">¶</a></h4>
<p>Secure key establishment depends on the arithmetic validity of the public key. To explain the assurance requirements, some terminology needs to be defined. The owner of a static key pair is defined as the entity that is authorized to use the private key that corresponds to the public key; this is independent of whether or not the owner generated the key pair. The recipient of a static public key is defined as the entity that is participating in a key establishment transaction with the owner and obtains the key before or during the current transaction. The owner of an ephemeral public key is the entity that generated the key as part of a key establishment transaction. The recipient of an ephemeral public key is the entity that receives the key during a key establishment transaction with the owner.
Both the owner and a recipient of a candidate public key shall have assurance of its arithmetic validity before using it, as specified below. The application performing the key establishment on behalf of the owner and recipient should determine whether or not to allow key establishment based upon the method(s) of assurance that was used. Such knowledge may be explicitly provided to the application in some manner, or may be implicitly provided by the operation of the application itself. Prior to obtaining this assurance of arithmetic validity, the owner and recipient of the public key shall have assurance of the validity of the domain parameters. The procedures presented for obtaining public key validity assume that the domain parameters have been validated.</p>
<div class="section" id="owner-assurances-of-static-public-key-validity">
<span id="nist-sp800-56a-5-6-2-1"></span><h5><a class="toc-backref" href="#id38">5.6.2.1 Owner Assurances of Static Public Key Validity</a><a class="headerlink" href="#owner-assurances-of-static-public-key-validity" title="Permalink to this headline">¶</a></h5>
<p>The owner of a static public key shall obtain assurance of its validity in one or more of the following ways:</p>
<ol class="arabic simple">
<li>Owner Full Validation - The owner performs a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5). For example, a key generation routine may perform full public key validation as part of its processing.</li>
<li>TTP Full Validation – The owner receives assurance that a trusted third party (trusted by the owner) has performed a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5).</li>
<li>Owner Generation – The owner has generated the public key from the private key (see Section 5.6.1).</li>
<li>TTP Generation – The owner has received assurance that a trusted third party (trusted by the owner) has generated the public/private key pair and has provided the key pair to the owner (see Section 5.6.1).</li>
</ol>
<p>The application performing the key establishment on behalf of the owner should determine whether or not to allow key establishment based upon the method(s) of assurance that was used. Such knowledge may be explicitly provided to the application in some manner, or may be implicitly provided by the operation of the application itself. Note that the use of a TTP to generate a key pair for an owner means that the TTP is trusted (by both the owner and any recipient) to not use the owner’s private key to masquerade as the owner.</p>
</div>
<div class="section" id="recipientassurancesofstaticpublickeyvalidity">
<span id="nist-sp800-56a-5-6-2-2"></span><h5><a class="toc-backref" href="#id39">5.6.2.2 RecipientAssurancesofStaticPublicKeyValidity</a><a class="headerlink" href="#recipientassurancesofstaticpublickeyvalidity" title="Permalink to this headline">¶</a></h5>
<p>The recipient of a static public key shall obtain assurance of its validity in one or more of the following ways:</p>
<ol class="arabic simple">
<li>Recipient Full Validation - The recipient performs a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5).</li>
<li>TTP Full Validation – The recipient receives assurance that a trusted third party (trusted by the recipient) has performed a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5).</li>
<li>TTP Generation – The recipient receives assurance that a trusted third party (trusted by the recipient) has generated the public/private key pair in accordance with Section 5.6.1 and has provided the key pair to the owner.</li>
</ol>
<p>The application performing the key establishment on behalf of the recipient should determine whether or not to allow key establishment based upon the method(s) of assurance that was used. Such knowledge may be explicitly provided to the application in some manner, or may be implicitly provided by the operation of the application itself. Note that the use of a TTP to generate a key means that the TTP is trusted (by both the recipient and the owner) to not use the owner’s private key to masquerade as the owner.</p>
</div>
<div class="section" id="recipientassurancesofephemeralpublickeyvalidity">
<span id="nist-sp800-56a-5-6-2-3"></span><h5><a class="toc-backref" href="#id40">5.6.2.3 RecipientAssurancesofEphemeralPublicKeyValidity</a><a class="headerlink" href="#recipientassurancesofephemeralpublickeyvalidity" title="Permalink to this headline">¶</a></h5>
<p>The recipient of an ephemeral public key shall obtain assurance of its validity in one or more of the following ways:</p>
<ol class="arabic simple">
<li>Recipient Full Validation - The recipient performs a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5).</li>
<li>TTP Full Validation – The recipient receives assurance that a trusted third party (trusted by the recipient) has performed a successful full public key validation (see Sections 5.6.2.4 and 5.6.2.5). For example, a trusted processor may only forward an ephemeral public key to the recipient if the public key passes a full public key validation.</li>
<li>Recipient ECC Partial Validation - If using an ECC method (only), the recipient performs a successful partial public key validation (see Section 5.6.2.6).</li>
<li>TTP ECC Partial Validation – If using an ECC method (only), the recipient receives assurance that a trusted third party (trusted by the recipient) has performed a successful partial public key validation (see Section 5.6.2.6). For example, a trusted processor may only forward an ECC ephemeral public key to the recipient if it passes a partial public key validation.</li>
</ol>
<p>The application performing the key establishment on behalf of the recipient should determine whether or not to allow key establishment based upon the method(s) of assurance that was used. Such knowledge may be explicitly provided to the application in some manner, or may be implicitly provided by the operation of the application itself.</p>
</div>
<div class="section" id="ffcfullpublickeyvalidationroutine">
<span id="nist-sp800-56a-5-6-2-4"></span><h5><a class="toc-backref" href="#id41">5.6.2.4 FFCFullPublicKeyValidationRoutine</a><a class="headerlink" href="#ffcfullpublickeyvalidationroutine" title="Permalink to this headline">¶</a></h5>
<p>FFC full public key validation refers to the process of checking all the arithmetic properties of a candidate FFC public key to ensure that it has the unique correct representation in the correct subgroup (and therefore is also in the correct multiplicative group) of the finite field specified by the associated FFC domain parameters. FFC full public key validation does not require knowledge of the associated private key and so may be done at any time by anyone. This method shall be used with static and ephemeral FFC public keys when assurance of the validity of the keys is obtained by method 1 or method 2 of Sections 5.6.2.1, 5.6.2.2, and 5.6.2.3.</p>
<p>Input:
1. (p, q, g{, SEED, pgenCounter}): A valid set of FFC domain parameters, and
2. y: A candidate FFC public key.</p>
<p>Process:
1. Verify that 2 ≤ y ≤ p-2.
(Ensures that the key has the unique correct representation and range in the field.)
2. Verify that yq = 1 (mod p).
(Ensures that the key has the correct order and is in the correct subgroup.)
Output: If any of the above checks fail, then output an error indicator. Otherwise, output an indication of successful full validation.</p>
</div>
<div class="section" id="eccfullpublickeyvalidationroutine">
<span id="nist-sp800-56a-5-6-2-5"></span><h5><a class="toc-backref" href="#id42">5.6.2.5 ECCFullPublicKeyValidationRoutine</a><a class="headerlink" href="#eccfullpublickeyvalidationroutine" title="Permalink to this headline">¶</a></h5>
<p>ECC full public key validation refers to the process of checking all the arithmetic properties of a candidate ECC public key to ensure that it has the unique correct representation in the correct (additive) subgroup (and therefore is also in the correct EC group) specified by the associated ECC domain parameters. ECC full public key validation does not require knowledge of the associated private key and so may be done at any time by anyone. This method may be used for a static ECC public key, or an ephemeral ECC public key, when assurance of the validity of the key is obtained by method 1 or method 2 of Sections 5.6.2.1, 5.6.2.2, and 5.6.2.3.
Input:
1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
2. Q=(xQ, yQ ): A candidate ECC public key.
Process:
1.
2.
3.
4.
Verify that Q is not the point at infinity O. This can be done by inspection if the point is entered in the standard affine representation.
(Partial check of the public key for an invalid range in the EC group.)
Verify that xQ and yQ are integers in the interval [0, p-1] in the case that q is an odd prime
p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
(Ensures that each coordinate of the public key has the unique correct representation of
an element in the underlying field.) Ifqisanoddprimep,verifythat(yQ)2≡(xQ)3+axQ +b(modp). Ifq=2m,verifythat(yQ)2+xQ yQ =(xQ)3+a(xQ)2+binthefinitefieldofsize2m. (Ensures that the public key is on the correct elliptic curve.)
V erify that nQ = O.
(Ensures that the public key has the correct order. Along with check 1, ensures that the public key is in the correct range in the correct EC subgroup, that is, it is in the correct EC subgroup and is not the identity element.)
Output: If any of the above checks fail, then output an error indicator. Otherwise, output an indication of successful validation.</p>
</div>
<div class="section" id="eccpartialpublickeyvalidationroutine">
<span id="nist-sp800-56a-5-6-2-6"></span><h5><a class="toc-backref" href="#id43">5.6.2.6 ECCPartialPublicKeyValidationRoutine</a><a class="headerlink" href="#eccpartialpublickeyvalidationroutine" title="Permalink to this headline">¶</a></h5>
<p>ECC partial public key validation refers to the process of checking some (but not all) of the arithmetic properties of a candidate ECC public key to ensure that it is in the correct group (but not necessarily the correct subgroup) specified by the associated ECC domain parameters. ECC Partial Public Key Validation omits the validation of subgroup membership, and therefore is usually faster than ECC Full Public Key Validation. ECC partial public key validation does not require knowledge of the associated private key and so may be done at any time by anyone. This method may only be used for an ephemeral ECC public key when assurance of the validity of the key is obtained by method 3 or 4 of Section 5.6.2.3.
Input:
1. (q, FR, a, b{, SEED}, G, n, h): A valid set of ECC domain parameters, and
2. Q = (xQ, yQ): A candidate ECC public key.
Process:
1. Verify that Q is not the point at infinity O. This can be done by inspection if the point is entered in the standard affine representation.
(Partial check of the public key for an invalid range in the EC group.)
2. Verify that xQ and yQ are integers in the interval [0, p-1] in the case that q is an odd prime
p, or that xQ and yQ are bit strings of length m bits in the case that q = 2m.
(Ensures that each coordinate of the public key has the unique correct representation of
an element in the underlying field.)
3. Ifqisanoddprimep,verifythat(yQ)2≡(xQ)3+axQ +b(modp).
Ifq=2m,verifythat(yQ)2+xQ yQ =(xQ)3+a(xQ)2+binthefinitefieldofsize2m. (Ensures that the public key is on the correct elliptic curve.)
(Note: Since its order is not verified, there is no check that the public key is in the correct EC subgroup.)
Output: If any of the above checks fail, then output an error indicator. Otherwise, output an indication of validation success.</p>
</div>
</div>
<div class="section" id="assurances-of-the-possession-of-a-static-private-key">
<span id="nist-sp800-56a-5-6-3"></span><h4><a class="toc-backref" href="#id44">5.6.3 Assurances of the Possession of a Static Private Key</a><a class="headerlink" href="#assurances-of-the-possession-of-a-static-private-key" title="Permalink to this headline">¶</a></h4>
<p>The security of key agreement schemes that use static key pairs depends on limiting knowledge of the static private keys to those who have been authorized to use them (i.e., their respective owners). In addition to preventing unauthorized entities from gaining access to private keys, it is also important to obtain assurance that authorized users do have access to their correct static private keys.</p>
<p>Assurance of possession requirements for the owner of a static private key are specified in Section 5.6.3.1. Assurance of possession requirements for recipients of a static public key are specified in Section 5.6.3.2.
When assurance of possession of a static private key is obtained, the assurance of the validity of the associated public key shall be obtained either prior to or concurrently with obtaining assurance of possession. Note that as time passes, an owner may lose possession of the associated private key, either by choice or due to an error; for this reason, current assurance of possession can be of more value for some applications. See Section 5.6.3.2.2 and Section 8.1 for ways to obtain more current assurance of possession.</p>
<div class="section" id="ownerassurancesofpossessionofastaticprivatekey">
<span id="nist-sp800-56a-5-6-3-1"></span><h5><a class="toc-backref" href="#id45">5.6.3.1 OwnerAssurancesofPossessionofaStaticPrivateKey</a><a class="headerlink" href="#ownerassurancesofpossessionofastaticprivatekey" title="Permalink to this headline">¶</a></h5>
<p>The owner of a static public key shall have assurance that the owner actually possesses the correct associated private key in one or more of the following ways:</p>
<ol class="arabic simple">
<li>Owner Receives Assurance via Explicit Key Confirmation – The owner employs the static key pair to successfully engage another party in a key agreement transaction incorporating explicit key confirmation. The key confirmation shall be performed with the owner as key confirmation recipient in order to obtain assurance that the private key functions correctly. See Section 8 for further explanation.</li>
<li>Owner Receives Assurance via Use of an Encrypted Certificate - The owner uses the static private key while engaging in a key agreement transaction with a Certificate Authority (trusted by the owner), providing the CA with the corresponding static public key. As part of this transaction, the CA generates a certificate containing the owner’s static public key and encrypts the certificate using a symmetric key derived from the shared secret they have (allegedly) established. Only the encrypted form of the certificate is provided to the owner. By successfully decrypting the certificate, the owner obtains assurance of possession of the correct private key (at the time of the key agreement transaction).</li>
<li>Owner Receives Assurance via Key Regeneration – The owner regenerates a public key from the static private key and verifies that the regenerated public key is equal to the original static public key. Note that this method may be useful if the static private key has been generated by a party other than the owner or as an integrity check on a key pair that has been stored for a long period of time.</li>
<li>Owner Receives Assurance via Trusted Provision - A trusted party (trusted by the owner) provides the static private key and static public key to the owner using a trusted distribution method. Reliance upon this method assumes (1) that the trusted party will provide a private key that is consistent with the public key and (2) that the trusted party will not use the private key to masquerade as the owner.</li>
</ol>
<p>5. Owner Receives Assurance via Key Generation - The act of generating a key pair, with the public key being computed from the private key, is a way for the owner to obtain assurance of possession of the correct private key. This method allows an owner who
protects his/her own keys to have assurance of possession without additional computation. Note that this method may not detect algorithm implementation errors, hardware errors, random bit flips, etc. Further assurance may be obtained through the use of one or more of the above methods.
The owner of a static public key (or agents trusted to act on the owner’s behalf) should determine that the method used for obtaining assurance of the owner’s possession of the correct static private key is sufficient and appropriate to meet the security requirements of the owner’s intended application(s).</p>
</div>
<div class="section" id="recipient-assurance-of-owners-possession-of-a-static-private-key">
<span id="nist-sp800-56a-5-6-3-2"></span><h5><a class="toc-backref" href="#id46">5.6.3.2 Recipient Assurance of Owner’s Possession of a Static Private Key</a><a class="headerlink" href="#recipient-assurance-of-owners-possession-of-a-static-private-key" title="Permalink to this headline">¶</a></h5>
<p>At the time of binding an identifier to the owner’s static public key, the binding authority shall obtain assurance that the owner is in possession of the correct static private key. This assurance shall either be obtained using one of the methods specified in Section 5.6.3.2.2 or by using an Approved alternative.
Recipients other than binding authorities shall obtain this assurance – either through a trusted third party (see Section 5.6.3.2.1) or directly – before using the derived keying material for purposes beyond those required during the key agreement transaction itself. If the recipient chooses to obtain this assurance directly, then to comply with this Recommendation the parties shall use one of the methods specified in Section 5.6.3.2.2.</p>
<div class="section" id="recipient-obtains-assurance-through-a-trusted-third-party">
<span id="nist-sp800-56a-5-6-3-2-1"></span><h6><a class="toc-backref" href="#id47">5.6.3.2.1 Recipient Obtains Assurance through a Trusted Third Party</a><a class="headerlink" href="#recipient-obtains-assurance-through-a-trusted-third-party" title="Permalink to this headline">¶</a></h6>
<p>The recipient of a static public key may receive assurance that its owner is in possession of the correct static private key from a trusted third party, either before or during a key agreement transaction that makes use of that static public key. The methods used by a third party trusted by the recipient to obtain that assurance are beyond the scope of this Recommendation (see however, Section 8.1.5.1.1.2 of SP 800-57 [7]). The recipient of a static public key (or agents trusted to act on behalf of the recipient) should know the method(s) used by the third party, in order to determine that the assurance obtained on behalf of the recipient is sufficient and appropriate to meet the security requirements of the recipient’s intended application(s).</p>
</div>
<div class="section" id="recipient-obtains-assurance-directly-from-the-claimed-owner">
<span id="nist-sp800-56a-5-6-3-2-2"></span><h6><a class="toc-backref" href="#id48">5.6.3.2.2 Recipient Obtains Assurance Directly from the Claimed Owner</a><a class="headerlink" href="#recipient-obtains-assurance-directly-from-the-claimed-owner" title="Permalink to this headline">¶</a></h6>
<p>When two parties engage in a key agreement transaction, there is (at least) an implicit claim of ownership made whenever a static public key is provided on behalf of a particular party. That party is considered to be a claimed owner of the corresponding static key pair – as opposed to being a true owner – until adequate assurance can be provided that the party is actually the one authorized to use the static private key.
The recipient of a static public key can directly obtain assurance of the claimed owner’s current possession of the corresponding private key by successfully completing a key agreement transaction that explicitly incorporates key confirmation, with the claimed owner serving as the key confirmation provider (see Section 8). Note that the recipient of the static public key in question is also the key confirmation recipient. When assurance of possession is obtained
through key confirmation performed in compliance with this Recommendation, the underlying key agreement scheme used shall be one of the following, and the recipient seeking assurance shall serve as the key agreement initiator:
• dhHybridOneFlow or (Cofactor) One-Pass Unified Model,
• MQV1 or One-Pass MQV,
• dhOneFlow or (Cofactor) One-Pass Diffie-Hellman.
(See Sections 6 and 8 for details.) The recipient of a static public key (or agents trusted to act on the recipient’s behalf) shall determine that the key agreement scheme employed to obtain assurance of possession in this manner is sufficient and appropriate to meet the security requirements of the recipient’s intended application(s).
In each of the permitted scenarios, the key confirmation recipient contributes (at least) an ephemeral public key that must be arithmetically combined with the static private key claimed by the key confirmation provider during the provider&#8217;s computation of the shared secret. Successful key confirmation (performed in the context described here) demonstrates that the correct static private key has been used in the key confirmation provider’s calculations, and thus also provides assurance that the claimed owner is the true owner (see Section 8.1).
Key confirmation may be requested by the recipient even when the recipient has obtained independent assurance that the claimed owner of a static public key is indeed its true owner. This is appropriate in situations where the recipient desires assurance that the owner is currently in possession of the correct static private key (and that the owner is currently able to use it correctly), or in situations where there is no access to a trusted party who can provide assurance of the owner’s (previous) demonstration of private key possession.
Note that the recommendation that assurance of possession be obtained before using derived keying material for purposes beyond those of the key agreement transaction itself does not prohibit the parties to a key agreement transaction from using derived keying material during the transaction, for purposes required by the key agreement scheme. For example, in a transaction involving a key agreement scheme that incorporates key confirmation, the parties establish a (purportedly) shared secret, derive keying material, and — as part of that same transaction — use a portion of the derived keying material as the MacKey in their key confirmation computations.</p>
</div>
</div>
</div>
<div class="section" id="key-pair-management">
<span id="nist-sp800-56a-5-6-4"></span><h4><a class="toc-backref" href="#id49">5.6.4 Key Pair Management</a><a class="headerlink" href="#key-pair-management" title="Permalink to this headline">¶</a></h4>
</div>
</div>
</div>
<div class="section" id="key-agreement">
<span id="nist-sp800-56a-key-agreement"></span><span id="nist-sp800-56a-6"></span><h2><a class="toc-backref" href="#id50">6. Key Agreement</a><a class="headerlink" href="#key-agreement" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">「鍵合意」</p>
</div>
<p>This Recommendation provides three categories of key agreement schemes (see Table 3).</p>
<p>The classification of the categories is based on the number of ephemeral keys
used by the two parties to the key agreement process, parties U and V.</p>
<p>In category C(i),
parties U and V have a total of i ephemeral key pairs.</p>
<p>The first category, C(2),
consists of schemes requiring the generation of ephemeral key pairs by both parties;
a C(2) scheme is suitable for an <strong>interactive key establishment protocol</strong>.</p>
<p>The second category, C(1),
consists of schemes requiring the generation of an ephemeral key pair by only one party;
a C(1) scheme is suitable for a <strong>store and forward scenario</strong>,
but may also be used in an interactive key establishment protocol.</p>
<p>The third category, C(0),
consists of schemes that do not use ephemeral keys.</p>
<p>Key confirmation may be added to many of these schemes
to provide assurance that the participants share the same keying material;
see <em class="xref std std-ref">Section 8</em> for details on key confirmation.</p>
<p>Each party should have such assurance.</p>
<p>Although other methods are often used to provide this assurance,
this Recommendation makes no statement
as to the adequacy of these other methods.</p>
<table border="1" class="docutils">
<caption>Table 3: Key Agreement Scheme Categories</caption>
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Category</td>
<td>Comment</td>
</tr>
<tr class="row-even"><td>C(2): Two ephemeral key pairs</td>
<td>Each party generates an ephemeral key pair.</td>
</tr>
<tr class="row-odd"><td>C(1): One ephemeral key pair</td>
<td>Only the initiator generates an ephemeral key pair.
<a class="footnote-reference" href="#id2" id="id1">[1]</a></td>
</tr>
<tr class="row-even"><td>C(0): Zero ephemeral key pairs</td>
<td>No ephemeral keys are used.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table class="last docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Jose ECDH-ES</td></tr>
</tbody>
</table>
</div>
<p>Each category is comprised of one or more subcategories
that are classified by the use of <em class="xref std std-term">static keys</em> by the parties (see Table 4).</p>
<p>In subcategory C(i, j),
parties U and V have a total of i <a class="reference internal" href="#term-ephemeral-key"><em class="xref std std-term">ephemeral key</em></a> pairs and j <a class="reference internal" href="#term-static-key"><em class="xref std std-term">static key</em></a> pairs.</p>
<table border="1" class="docutils">
<caption>Table 4: Key Agreement Scheme Subcategories</caption>
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Category</td>
<td>Subcategory</td>
</tr>
<tr class="row-even"><td rowspan="2">C(2): Two ephemeral key pairs</td>
<td>C(2, 2): Each party generates an ephemeral key pair
and has a static key pair.</td>
</tr>
<tr class="row-odd"><td>C(2, 0): Each party generates an ephemeral key pair;
no static key pairs are used.</td>
</tr>
<tr class="row-even"><td rowspan="2">C(1): One ephemeral key pair</td>
<td>C(1, 2): The initiator generates an ephemeral key pair
and has a static key pair;
the responder has only a static key pair.  <a class="footnote-reference" href="#id4" id="id3">[2]</a></td>
</tr>
<tr class="row-odd"><td>C(1, 1): The initiator generates an ephemeral key pair,
but has no static key pair;
the responder has only a static key pair.</td>
</tr>
<tr class="row-even"><td>C(0): Zero ephemeral key pairs</td>
<td>C(0, 2): Each party has only a static key pairk</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table class="last docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>Jose ECDH-ES</td></tr>
</tbody>
</table>
</div>
<p>The schemes may be further classified by
whether they use finite field cryptography (FFC)
or elliptic curve cryptography (ECC).</p>
<p>A scheme may use either <em class="xref std std-term">Diffie-Hellman</em> or <a class="reference internal" href="#term-mqv"><em class="xref std std-term">MQV</em></a> primitives (see <em class="xref std std-ref">Section 5.7</em>).</p>
<p>Thus, for example,
C(2, 2, FFC DH) completely classifies the dhHybrid1 scheme of <em class="xref std std-ref">Section 6.1.1.1</em>
as a scheme with two ephemeral keys and two static keys
that uses finite field cryptography and a Diffie-Hellman primitive (see Table 5).</p>
<table border="1" class="docutils">
<caption>Table 5: Key Agreement Schemes</caption>
<colgroup>
<col width="16%" />
<col width="16%" />
<col width="16%" />
<col width="24%" />
<col width="28%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Category</td>
<td>Subcategory</td>
<td>Primitive</td>
<td>Scheme</td>
<td>Full Classification</td>
</tr>
<tr class="row-even"><td>C(2)</td>
<td>C(2, 2)</td>
<td>FFC DH</td>
<td>dhHybrid1</td>
<td>C(2, 2, FFC DH)</td>
</tr>
<tr class="row-odd"><td>C(2)</td>
<td>C(2, 2)</td>
<td>ECC CDH</td>
<td>(Cofactor)
Full Unified Model</td>
<td>C(2, 2, ECC CDH)</td>
</tr>
<tr class="row-even"><td>C(2)</td>
<td>C(2, 2)</td>
<td>FFC MQV</td>
<td>MQV2</td>
<td>C(2, 2, FFC MQV)</td>
</tr>
<tr class="row-odd"><td>C(2)</td>
<td>C(2, 2)</td>
<td>ECC MQV</td>
<td>Full MQV</td>
<td>C(2, 2, ECC MQV)</td>
</tr>
<tr class="row-even"><td>C(2)</td>
<td>C(2, 0)</td>
<td>FFC DH</td>
<td>dhEphem</td>
<td>C(2, 0, FFC DH)</td>
</tr>
<tr class="row-odd"><td>C(2)</td>
<td>C(2, 0)</td>
<td>ECC CDH</td>
<td>(Cofactor)
Ephemeral Unified
Model</td>
<td>C(2, 0, ECC CDH)</td>
</tr>
<tr class="row-even"><td>C(1)</td>
<td>C(1, 2)</td>
<td>FFC DH</td>
<td>dhHybridOneFlow</td>
<td>C(1, 2, FFC DH)</td>
</tr>
<tr class="row-odd"><td>C(1)</td>
<td>C(1, 2)</td>
<td>ECC CDH</td>
<td>(Cofactor)
One-Pass Unified
Model</td>
<td>C(1, 2, ECC CDH)</td>
</tr>
<tr class="row-even"><td>C(1)</td>
<td>C(1, 2)</td>
<td>FFC MQV</td>
<td>MQV1</td>
<td>C(1, 2, FFC MQV)</td>
</tr>
<tr class="row-odd"><td>C(1)</td>
<td>C(1, 2)</td>
<td>ECC MQV</td>
<td>One-Pass MQV</td>
<td>C(1, 2, ECC MQV)</td>
</tr>
<tr class="row-even"><td>C(1)</td>
<td>C(1, 1)</td>
<td>FFC DH</td>
<td>dhOneFlow</td>
<td>C(1, 1, FFC DH)</td>
</tr>
<tr class="row-odd"><td>C(1)</td>
<td>C(1, 1)</td>
<td>ECC CDH</td>
<td>(Cofactor)
One-Pass Diffie-
Hellman</td>
<td>C(1, 1, ECC CDH) <a class="footnote-reference" href="#id6" id="id5">[3]</a></td>
</tr>
<tr class="row-even"><td>C(0)</td>
<td>C(0, 2)</td>
<td>FFC DH</td>
<td>dhStatic</td>
<td>C(0, 2, FFC DH)</td>
</tr>
<tr class="row-odd"><td>C(0)</td>
<td>C(0, 2)</td>
<td>ECC CDH</td>
<td>Cofactor
Static   Unified
Model</td>
<td>C(0, 2, ECC CDH)</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table class="last docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[3]</a></td><td>Jose ECDH-ES</td></tr>
</tbody>
</table>
</div>
<p>Each party in a key agreement process shall use the same set of valid domain parameters.</p>
<p>These parameters shall be established and validated
prior to the initiation of the key agreement process.</p>
<p>See <em class="xref std std-ref">Section 5.5</em> for a discussion of domain parameters.</p>
<p><em class="xref std std-term">Party U</em> shall have an identifier <em class="xref std std-term">IDU</em>.
If Party U owns a static key pair that is used in a given key agreement transaction,
then IDU shall be the identifier that is bound to that key pair.</p>
<p>If Party U does not contribute a static public key as part of a given key agreement transaction,
then IDU shall be a non-null identifier selected in accordance
with the protocol utilizing the scheme.</p>
<p>Similar rules apply for the selection of Party V’s identifier, IDV.</p>
<p>A general flow diagram is provided for each subcategory of schemes.</p>
<p>The dotted-line arrows represent the distribution of static public keys
that may be distributed by the parties themselves or by a third party,
such as a Certification Authority (CA).</p>
<p>The solid-line arrows represent the distribution of ephemeral public keys
or nonces that occur during the key agreement or key confirmation process.</p>
<p>Note that the flow diagrams in this Recommendation
omit explicit mention of various validation checks that are required.</p>
<p>The flow diagrams and descriptions in this Recommendation
assume a successful completion of the key establishment process.</p>
<p>Rationale for selecting schemes for each subcategory,
C(i, j), is included.</p>
<p>These rationale sections will provide the user or developer with additional information
to help make a choice as to which key establishment scheme to use.</p>
<p>The rationale includes discussions of the security properties for the schemes.</p>
<p>In general,
the security properties for each scheme within a subcategory are the same;
when this is not the case,
the exceptions are identified.</p>
<p>See Section 6.1.1.5 specifically.</p>
<p>These rationale sections do not contain an in-depth discussion
of all possible security properties of all schemes.</p>
<p>For further discussion,
see ANS X9.42 and ANS X9.63. Note that the specific security properties achieved
depend on whether a static key is used, whether an ephemeral key is used,
the specific method of calculating the shared secret, and the key confirmation method used, if any.</p>
<p>It is important that a scheme not be chosen based solely on the number of security properties it possesses.</p>
<p>Rather,
a scheme should be selected based on how well the scheme fulfills the system requirements.</p>
<p>For instance,
in a bandwidth-constrained system,
a scheme with fewer passes per exchange might be preferable to a scheme with more passes and more security properties.</p>
<p>It is also important to understand that
a scheme may be a component of a protocol,
which in turn provides additional security properties not provided by the scheme
when considered by itself.</p>
<p>Note that protocols, per se, are not specified in this Recommendation.</p>
<div class="section" id="schemes-using-one-ephemeral-key-pair-c-1">
<span id="nist-sp800-56a-6-2"></span><h3><a class="toc-backref" href="#id51">6.2 Schemes Using One Ephemeral Key Pair, C(1)</a><a class="headerlink" href="#schemes-using-one-ephemeral-key-pair-c-1" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Jose <a class="reference internal" href="jwa.html"><em>JSON Web Algorithms (JWA) : draft21</em></a> はこのスキームです。</li>
<li>暗号化ということでは、スタティックキーは受信者(responder)だけが持っているだけで良い。</li>
</ul>
</div>
<p>This category consists of two subcategories
that are determined by the possession (or non- possession)
of a static key pair by each of the parties.</p>
<p>Let <em class="xref std std-term">party U</em> serve as the <a class="reference internal" href="#term-initiator"><em class="xref std std-term">initiator</em></a>,
and <em class="xref std std-term">party V</em> serve as the <a class="reference internal" href="#term-responder"><em class="xref std std-term">responder</em></a>.</p>
<p>Only the initiator (party U) generates
an ephemeral key pair.</p>
<p>In the first subcategory,
both the initiator and the responder have a static key pair,
and the initiator also generates an ephemeral key pair
(see <a class="reference internal" href="#nist-sp800-56a-6-2-1"><em>Section 6.2.1</em></a>).</p>
<p>In the second subcategory,
the initiator generates an ephemeral key pair,
but has no static key pair; the responder has only a static key pair
(see <a class="reference internal" href="#nist-sp800-56a-6-2-2"><em>Section 6.2.2</em></a>).</p>
<div class="section" id="initiator-has-a-static-key-pair-and-generates-an-ephemeral-key-pair-responder-has-a-static-key-pair-c-1-2">
<span id="nist-sp800-56a-6-2-1"></span><h4><a class="toc-backref" href="#id52">6.2.1 Initiator Has a Static Key Pair and Generates an Ephemeral Key Pair; Responder Has a Static Key Pair, C(1, 2)</a><a class="headerlink" href="#initiator-has-a-static-key-pair-and-generates-an-ephemeral-key-pair-responder-has-a-static-key-pair-c-1-2" title="Permalink to this headline">¶</a></h4>
<p>For these schemes,
party U (the initiator) uses both static and ephemeral private/public key pairs.</p>
<p>Party V (the responder) uses only a static private/public key pair.</p>
<p>Party U and party V obtain each other’s static public keys in a trusted manner.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>パブリックキーなので、 <a class="reference internal" href="jwe.html#jwe-jku"><em>4.1.4. &#8220;jku&#8221; (JWK Set URL) Header Parameter</em></a> でダウンロード化、でもよい</li>
</ul>
</div>
<p>Party U also sends its ephemeral public key to party V.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="jwa.html#jwa-epk"><em>4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</em></a></li>
</ul>
</div>
<p>A <strong>shared secret</strong> is generated by both parties
using the available static and ephemeral keys.</p>
<p>The shared secret keying material is derived
using the shared secret (see Figure 6).</p>
<p>Prerequisites:
The following are prerequisites for the use of all C(1, 2) schemes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>ドメインパラメータを会わせる</li>
<li>共にスタティックキーペアのオーナーであること。互いにそればわかる事。</li>
<li>認証済みキー派生関数、 認証済みハッシュ関数を使う事</li>
<li>識別子とパブリックキーが結びついている事 (jku, kid)</li>
</ol>
</div>
<ol class="arabic">
<li><p class="first">Each party shall have an authentic copy of the same set of domain parameters, D.
These parameters shall have been generated as specified in <em class="xref std std-ref">Section 5.5.1</em>.</p>
<p>For FFC schemes,
D = (p, q, g{, SEED, pgenCounter}); for
ECC schemes, D = (q, FR, a, b{, SEED}, G, n, h).</p>
<p>Furthermore,
each party shall have assurance of the validity of these domain parameters
as specified in <em class="xref std std-ref">Section 5.5.2</em>.</p>
</li>
<li><p class="first">Each party shall have been designated as the owner of a static key pair
that was generated as specified in <em class="xref std std-ref">Section 5.6.1</em>
using the set of domain parameters, D.</p>
<p>For FFC schemes,
the static key pair is (x, y);
for ECC schemes, the static key pair is (ds, Qs).</p>
<p>Each party shall obtain assurance of the validity of its own static public key
as specified in <em class="xref std std-ref">Section 5.6.2.1</em>.</p>
<p>Each party shall obtain assurance of its possession
of the correct value for its own private key as specified in <em class="xref std std-ref">Section 5.6.3.1</em>.</p>
</li>
<li><p class="first">The parties shall have agreed upon an <em class="xref std std-term">Approved key derivation function</em>
(see <em class="xref std std-ref">Section 5.8</em>)
as well as an <em class="xref std std-term">Approved hash function</em> appropriate for use
with the <em class="xref std std-term">key derivation function</em> and associated parameters
(see <a class="reference internal" href="#nist-sp800-56a-5-5"><em>Section 5.5</em></a>).</p>
<p>If <em class="xref std std-term">key confirmation</em> is used,
the parties shall have agreed upon an Approved MAC
and associated parameters (see Tables 1 and 2).</p>
</li>
<li><p class="first">Prior to or during the key agreement process,
each party shall obtain the <a class="reference internal" href="session.html#term-identifier"><em class="xref std std-term">identifier</em></a> associated with the other party
during the key agreement scheme
and the static public key that is bound to that identifier.</p>
<p>These static public keys shall be obtained in a trusted manner
(e.g., from a certificate signed by a trusted CA).</p>
<p>Each party shall obtain assurance of the validity
of the other party’s static public key as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-2-2"><em>Section 5.6.2.2</em></a>.</p>
</li>
</ol>
<p>The recipient of a static public key shall obtain assurance
that its (claimed) owner is (or was) in possession of the corresponding static private key,
as specified in Section <a class="reference internal" href="#nist-sp800-56a-5-6-3-2"><em>5.6.3.2</em></a>.</p>
</div>
<div class="section" id="initiator-generates-only-an-ephemeral-key-pair-responder-has-only-a-static-key-pair-c-1-1">
<span id="nist-sp800-56a-6-2-2"></span><h4><a class="toc-backref" href="#id53">6.2.2 Initiator Generates Only an Ephemeral Key Pair; Responder Has Only a Static Key Pair, C(1, 1)</a><a class="headerlink" href="#initiator-generates-only-an-ephemeral-key-pair-responder-has-only-a-static-key-pair-c-1-1" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first"><a class="reference internal" href="jwa.html#jwa-4-6-2"><em>4.6.2. Key Derivation for ECDH Key Agreement</em></a></p>
</li>
<li><p class="first">OpenID Connnct の ID TokenだとPartyU  = OP, PartyV = RP</p>
<blockquote>
<div><ul class="simple">
<li>OPが一時キーペア作成します。 が、スタティックキーペアは無くていいです。</li>
<li>RPがだけが永続キーペアを持つ</li>
<li><em class="xref std std-ref">&lt;reg.2&gt;</em> の jwk_uris(もしくはjwk)を参照する。</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>For these schemes,
<em class="xref std std-ref">Party U</em> generates an <em class="xref std std-term">ephemeral key pair</em>,
but has no static key pair;
<em class="xref std std-ref">party V</em> has only a static key pair.</p>
<p>Party U obtains party V’s <em class="xref std std-term">static public key</em> in a trusted manner
(for example, from a certificate signed by a trusted CA)
and sends its ephemeral public key to Party V.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Connectの場合、 RPの Trusted Manner は <a class="reference internal" href="reg.html"><em>OpenID Connect Dynamic Client Registration 1.0</em></a></li>
</ul>
</div>
<p>The parties compute a <a class="reference internal" href="#term-shared-secret"><em class="xref std std-term">shared secret</em></a>
using their private keys and the other party’s public key.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Connectの ID Tokenであれば、</p>
<blockquote>
<div><ul class="simple">
<li>OP : OPの一時プライベートキー  &amp;&amp; RPの永続パブリックキー</li>
<li>RP : OPの一時パブリックキー &amp;&amp; RPの永続プライベートキー</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>Each party uses the <a class="reference internal" href="#term-shared-secret"><em class="xref std std-term">shared secret</em></a> to derive secret keying material
(see Figure 7).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">どちらも計算された共有シークレットをつかって、シークレットのキーマテリアルを派生させる。</p>
</div>
<p>Prerequisites: The following are prerequisites for the use of all C(1, 1) schemes.</p>
<ol class="arabic">
<li><p class="first">Each party shall have an authentic copy of the same set of domain parameters, D.</p>
<p>These parameters shall have been generated
as specified in <a class="reference internal" href="#nist-sp800-56a-5-5-1"><em>Section 5.5.1</em></a>.</p>
<p>For FFC schemes,
D = (p, q, g{, SEED, pgenCounter});
for ECC schemes, D = (q, FR, a, b{, SEED}, G, n, h).</p>
<p>Furthermore,
each party shall have assurance of the validity of these domain parameters
as specified in <a class="reference internal" href="#nist-sp800-56a-5-5-2"><em>Section 5.5.2</em></a>.</p>
</li>
<li><p class="first">The responder shall have been designated as the owner of a static key pair
that was generated as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>Section 5.6.1</em></a>
using the set of domain parameters, D.</p>
<p>For FFC schemes,
the static key pair is (x, y);
for ECC schemes, the static key pair is (ds, Qs).</p>
<p>The responder shall obtain assurance of the validity
of its own static public key
as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-2-1"><em>Section 5.6.2.1</em></a>.</p>
<p>The responder shall obtain assurance of its possession of
the correct value of its own private key
as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-3-1"><em>Section 5.6.3.1</em></a>.</p>
</li>
<li><p class="first">The parties shall have agreed upon an Approved key derivation function
(see <em class="xref std std-ref">Section 5.8</em>)
as well as an Approved hash function appropriate
for use with the key derivation function and
associated parameters (see Section 5.5).</p>
<p>If key confirmation is used,
the parties shall have agreed upon an
Approved MAC and associated parameters (see Tables 1 and 2).</p>
</li>
<li><p class="first">Prior to or during the key agreement process,
each party shall obtain the <a class="reference internal" href="session.html#term-identifier"><em class="xref std std-term">identifier</em></a> associated
with the other party during the key agreement scheme.</p>
<p>The initiator shall obtain the static public key
that is bound to the responder’s identifier.</p>
<p>This static public key shall be obtained in a trusted manner
(e.g., from a certificate signed by a trusted CA).</p>
<p>The initiator shall obtain assurance of the validity of
the responder’s static public key as specified in <em class="xref std std-ref">Section 5.6.2.2</em></p>
</li>
</ol>
<p>The following is a prerequisite for
using the derived keying material
for purposes beyond the C(1,1) scheme itself.</p>
<blockquote>
<div>The initiator shall obtain assurance that the responder is (or was)
in possession of the appropriate static private key,
as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-3-2"><em>Section 5.6.3.2</em></a>.</div></blockquote>
<div class="section" id="one-pass-diffie-hellman-c-1-1-ecc-cdh">
<span id="nist-sp800-56a-6-2-2-2"></span><h5><a class="toc-backref" href="#id54">6.2.2.2 One-Pass Diffie-Hellman,C(1,1,ECC CDH)</a><a class="headerlink" href="#one-pass-diffie-hellman-c-1-1-ecc-cdh" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="jwa.html#jwa-4-6-2"><em>4.6.2. Key Derivation for ECDH Key Agreement</em></a></li>
</ul>
</div>
<p>This section describes the One-Pass Diffie-Hellman scheme
from <em class="xref std std-term">ANS X9.63</em>.</p>
<p>The prerequisites for this scheme
shall be satisfied as specified in <a class="reference internal" href="#nist-sp800-56a-6-2-2"><em>Section 6.2.2</em></a>.</p>
<p>In particular,
<em class="xref std std-term">party U</em> shall obtain the static public key Qs,V of party V.</p>
<p>Note that U and V must use identical orderings of the bit strings
that are input to the key derivation function.</p>
<p>Party U shall execute the following key agreement transformation
in order to a) establish a <a class="reference internal" href="#term-shared-secret"><em class="xref std std-term">shared secret</em></a> value Z with party V,
and b) derive shared secret keying material from Z.</p>
<div class="section" id="actions-u-shall-derive-secret-keying-material-as-follows">
<h6><a class="toc-backref" href="#id55">Actions: U shall derive secret keying material as follows:</a><a class="headerlink" href="#actions-u-shall-derive-secret-keying-material-as-follows" title="Permalink to this headline">¶</a></h6>
<ol class="arabic">
<li><p class="first">Generate an ephemeral key pair (de,U, Qe,U)
from the domain parameters D as specified in <a class="reference internal" href="#nist-sp800-56a-5-6-1"><em>Section 5.6.1</em></a>.</p>
<p>Send the public key Qe,U to V.</p>
</li>
<li><p class="first">Use the ECC CDH primitive in <em class="xref std std-ref">Section 5.7.1.2</em>
to derive a shared secret Z –
an element of the finite field of size q –
from the set of domain parameters D, U’s ephemeral private key de,U, and V’s static public key Qs,V.</p>
<p>If this call to the ECC CDH primitive outputs
an error indicator,
zeroize the results of all intermediate calculations used
in the attempted computation of Z,
output an error indicator, and stop.</p>
</li>
<li><p class="first">Convert Z to a byte string
(which is also denoted by Z)
using the Field-element-to-Byte- String Conversion
specified in Appendix C.2, and
then zeroize the results of all intermediate calculations
used in the computation of Z.</p>
</li>
<li><p class="first">Use the <em class="xref std std-ref">agreed-upon key derivation function</em>
to derive secret keying material DerivedKeyingMaterial
of length keydatalen bits from the shared secret value Z and OtherInput
(including the identifiers IDU and IDV).
(See <em class="xref std std-ref">Section 5.8</em>.)</p>
<p>If the key derivation function outputs an error indicator,
zeroize all copies of Z, output an error indicator, and stop.</p>
</li>
<li><p class="first">Zeroize all copies of the shared secret Z and output DerivedKeyingMaterial.</p>
</li>
</ol>
<dl class="docutils">
<dt>Output:</dt>
<dd>The bit string DerivedKeyingMaterial of length keydatalen bits
or an error indicator.</dd>
</dl>
</div>
</div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>