
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenID Connect Native Application Token Provisioning Profile 1.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OpenID Connect Native Application Token Agent API Bindings 1.0" href="napps_api.html" />
    <link rel="prev" title="OpenID Connect Session Management 1.0" href="session.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">OpenID Connect Native Application Token Provisioning Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="napps_api.html">OpenID Connect Native Application Token Agent API Bindings 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="napps_core.html">OpenID Connect Native Application Token Agent Core 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft22</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft28</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)(draft30)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">RFC7165:Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">OpenID Connect Native Application Token Provisioning Profile 1.0</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a><ul>
<li><a class="reference internal" href="#status-of-this-memo">Status of this Memo</a></li>
<li><a class="reference internal" href="#copyright-notice">Copyright Notice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introduction">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-notation-and-conventions">1.1.  Requirements Notation and Conventions</a></li>
<li><a class="reference internal" href="#terminology">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview">2.  Overview</a></li>
<li><a class="reference internal" href="#deployment-models">3.  Deployment Models</a></li>
<li><a class="reference internal" href="#token-agent-authentication">4.  Token Agent Authentication</a></li>
<li><a class="reference internal" href="#token-agent-registration">5.  Token Agent Registration</a></li>
<li><a class="reference internal" href="#id-token">6.  ID Token</a></li>
<li><a class="reference internal" href="#protocol-flows">7.  Protocol Flows</a><ul>
<li><a class="reference internal" href="#primary-token-retrieval">7.1.  Primary Token Retrieval</a><ul>
<li><a class="reference internal" href="#token-agent-prepares-authorization-request">7.1.1.  Token Agent Prepares Authorization Request</a></li>
<li><a class="reference internal" href="#token-agent-sends-request-to-authorization-server">7.1.2.  Token Agent Sends Request to Authorization Server</a></li>
<li><a class="reference internal" href="#authorization-server-authenticates-end-user">7.1.3.  Authorization Server Authenticates End-User</a></li>
<li><a class="reference internal" href="#authorization-server-obtains-end-user-consent-authorization">7.1.4.  Authorization Server Obtains End-User Consent/Authorization</a></li>
<li><a class="reference internal" href="#authorization-server-sends-end-user-back-to-trust-agent">7.1.5.  Authorization Server Sends End-User Back to Trust Agent</a></li>
<li><a class="reference internal" href="#success-case-end-user-granted-authorization">7.1.5.1.  Success Case - End-User Granted Authorization</a></li>
<li><a class="reference internal" href="#error-case-end-user-denied-authorization-or-invalid-request">7.1.5.2.  Error Case - End-User Denied Authorization or Invalid Request</a></li>
<li><a class="reference internal" href="#token-agent-obtains-primary-id-token-access-token-and-refresh-token">7.1.6.  Token Agent Obtains Primary ID Token, Access Token and Refresh Token</a></li>
<li><a class="reference internal" href="#token-agent-sends-code">7.1.6.1.  Token Agent Sends Code</a></li>
<li><a class="reference internal" href="#token-agent-receives-tokens">7.1.6.2.  Token Agent Receives Tokens</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appinfo-endpoint">7.2.  AppInfo Endpoint</a><ul>
<li><a class="reference internal" href="#appinfo-request">7.2.1.  AppInfo Request</a></li>
<li><a class="reference internal" href="#appinfo-response">7.2.2.  AppInfo Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#primary-access-token-refresh">7.3.  Primary access token refresh</a></li>
<li><a class="reference internal" href="#secondary-access-token-retrieval">7.4.  Secondary Access Token Retrieval</a><ul>
<li><a class="reference internal" href="#secondary-access-token-request">7.4.1.  Secondary access token request</a></li>
<li><a class="reference internal" href="#response">7.4.2.  Response</a></li>
<li><a class="reference internal" href="#secondary-access-token-retrieval-from-remote-as">7.4.3.  Secondary access token retrieval from remote AS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validation">7.5.  Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#native-application-interactions">8.  Native Application Interactions</a><ul>
<li><a class="reference internal" href="#token-agent-passes-secondary-access-token-to-application">8.1.  Token Agent passes secondary access token to Application</a></li>
<li><a class="reference internal" href="#application-requests-secondary-access-token-of-token-agent">8.2.  Application requests secondary access token of Token Agent</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations">9.  Security Considerations</a></li>
<li><a class="reference internal" href="#privacy-considerations">10.  Privacy Considerations</a></li>
<li><a class="reference internal" href="#iana-considerations">11.  IANA Considerations</a></li>
<li><a class="reference internal" href="#normative-references">12.  Normative References</a></li>
<li><a class="reference internal" href="#appendix-a-acknowledgements">Appendix A.  Acknowledgements</a></li>
<li><a class="reference internal" href="#appendix-b-notices">Appendix B.  Notices</a></li>
<li><a class="reference internal" href="#appendix-c-document-history">Appendix C.  Document History</a></li>
<li><a class="reference internal" href="#authors-addresses">Authors&#8217; Addresses</a></li>
<li><a class="reference internal" href="#full-copyright-statement">Full Copyright Statement</a></li>
<li><a class="reference internal" href="#intellectual-property">Intellectual Property</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="session.html"
         title="Previous Chapter: OpenID Connect Session Management 1.0">&laquo; OpenID Connect S...</a></li>
  <li><a href="napps_api.html"
         title="Next Chapter: OpenID Connect Native Application Token Agent API Bindings 1.0">OpenID Connect N... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/napps.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="openid-connect-native-application-token-provisioning-profile-1-0">
<h1>OpenID Connect Native Application Token Provisioning Profile 1.0<a class="headerlink" href="#openid-connect-native-application-token-provisioning-profile-1-0" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a><ul>
<li><a class="reference internal" href="#status-of-this-memo" id="id2">Status of this Memo</a></li>
<li><a class="reference internal" href="#copyright-notice" id="id3">Copyright Notice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introduction" id="id4">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-notation-and-conventions" id="id5">1.1.  Requirements Notation and Conventions</a></li>
<li><a class="reference internal" href="#terminology" id="id6">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#overview" id="id7">2.  Overview</a></li>
<li><a class="reference internal" href="#deployment-models" id="id8">3.  Deployment Models</a></li>
<li><a class="reference internal" href="#token-agent-authentication" id="id9">4.  Token Agent Authentication</a></li>
<li><a class="reference internal" href="#token-agent-registration" id="id10">5.  Token Agent Registration</a></li>
<li><a class="reference internal" href="#id-token" id="id11">6.  ID Token</a></li>
<li><a class="reference internal" href="#protocol-flows" id="id12">7.  Protocol Flows</a><ul>
<li><a class="reference internal" href="#primary-token-retrieval" id="id13">7.1.  Primary Token Retrieval</a><ul>
<li><a class="reference internal" href="#token-agent-prepares-authorization-request" id="id14">7.1.1.  Token Agent Prepares Authorization Request</a></li>
<li><a class="reference internal" href="#token-agent-sends-request-to-authorization-server" id="id15">7.1.2.  Token Agent Sends Request to Authorization Server</a></li>
<li><a class="reference internal" href="#authorization-server-authenticates-end-user" id="id16">7.1.3.  Authorization Server Authenticates End-User</a></li>
<li><a class="reference internal" href="#authorization-server-obtains-end-user-consent-authorization" id="id17">7.1.4.  Authorization Server Obtains End-User Consent/Authorization</a></li>
<li><a class="reference internal" href="#authorization-server-sends-end-user-back-to-trust-agent" id="id18">7.1.5.  Authorization Server Sends End-User Back to Trust Agent</a></li>
<li><a class="reference internal" href="#success-case-end-user-granted-authorization" id="id19">7.1.5.1.  Success Case - End-User Granted Authorization</a></li>
<li><a class="reference internal" href="#error-case-end-user-denied-authorization-or-invalid-request" id="id20">7.1.5.2.  Error Case - End-User Denied Authorization or Invalid Request</a></li>
<li><a class="reference internal" href="#token-agent-obtains-primary-id-token-access-token-and-refresh-token" id="id21">7.1.6.  Token Agent Obtains Primary ID Token, Access Token and Refresh Token</a></li>
<li><a class="reference internal" href="#token-agent-sends-code" id="id22">7.1.6.1.  Token Agent Sends Code</a></li>
<li><a class="reference internal" href="#token-agent-receives-tokens" id="id23">7.1.6.2.  Token Agent Receives Tokens</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appinfo-endpoint" id="id24">7.2.  AppInfo Endpoint</a><ul>
<li><a class="reference internal" href="#appinfo-request" id="id25">7.2.1.  AppInfo Request</a></li>
<li><a class="reference internal" href="#appinfo-response" id="id26">7.2.2.  AppInfo Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#primary-access-token-refresh" id="id27">7.3.  Primary access token refresh</a></li>
<li><a class="reference internal" href="#secondary-access-token-retrieval" id="id28">7.4.  Secondary Access Token Retrieval</a><ul>
<li><a class="reference internal" href="#secondary-access-token-request" id="id29">7.4.1.  Secondary access token request</a></li>
<li><a class="reference internal" href="#response" id="id30">7.4.2.  Response</a></li>
<li><a class="reference internal" href="#secondary-access-token-retrieval-from-remote-as" id="id31">7.4.3.  Secondary access token retrieval from remote AS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#validation" id="id32">7.5.  Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#native-application-interactions" id="id33">8.  Native Application Interactions</a><ul>
<li><a class="reference internal" href="#token-agent-passes-secondary-access-token-to-application" id="id34">8.1.  Token Agent passes secondary access token to Application</a></li>
<li><a class="reference internal" href="#application-requests-secondary-access-token-of-token-agent" id="id35">8.2.  Application requests secondary access token of Token Agent</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id36">9.  Security Considerations</a></li>
<li><a class="reference internal" href="#privacy-considerations" id="id37">10.  Privacy Considerations</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id38">11.  IANA Considerations</a></li>
<li><a class="reference internal" href="#normative-references" id="id39">12.  Normative References</a></li>
<li><a class="reference internal" href="#appendix-a-acknowledgements" id="id40">Appendix A.  Acknowledgements</a></li>
<li><a class="reference internal" href="#appendix-b-notices" id="id41">Appendix B.  Notices</a></li>
<li><a class="reference internal" href="#appendix-c-document-history" id="id42">Appendix C.  Document History</a></li>
<li><a class="reference internal" href="#authors-addresses" id="id43">Authors&#8217; Addresses</a></li>
<li><a class="reference internal" href="#full-copyright-statement" id="id44">Full Copyright Statement</a></li>
<li><a class="reference internal" href="#intellectual-property" id="id45">Intellectual Property</a></li>
</ul>
</div>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id1">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>OpenID Connect 1.0 is a simple identity layer
on top of the OAuth 2.0 protocol.</p>
<p>It allows Clients to verify the identity of the End-User
based on the authentication performed by an Authorization Server,
as well as to obtain basic profile information
about the End-User in an interoperable and RESTful manner.</p>
<p>The OpenID Connect Native Application Token Provisioning Profile 1.0
is a profile of the OpenID Connect Standard 1.0 specification
designed to enable &#8216;authorization agents&#8217; on devices, ie native
applications that obtain OAuth access tokens on behalf of other
native applications.</p>
<div class="section" id="status-of-this-memo">
<h3><a class="toc-backref" href="#id2">Status of this Memo</a><a class="headerlink" href="#status-of-this-memo" title="Permalink to this headline">¶</a></h3>
<p>OIDF-Drafts are working documents of the OpenID Foundation (OIDF).</p>
<p>OIDF-Drafts are draft documents valid for a maximum of six months and
may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use OIDF-Drafts as reference material
or to cite them other than as &#8220;work in progress.&#8221;</p>
<p>This OIDF-Draft will expire on May 29, 2014.</p>
</div>
<div class="section" id="copyright-notice">
<h3><a class="toc-backref" href="#id3">Copyright Notice</a><a class="headerlink" href="#copyright-notice" title="Permalink to this headline">¶</a></h3>
<p>Copyright (C) OpenID Foundation (2013).  All Rights Reserved.</p>
</div>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id4">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>OpenID Connect Native Application Token Provisioning Profile 1.0
is a profile of the OpenID Connect Core 1.0 [OpenID.Core] specification
that stipulates how a specialized OpenID Connect Client
called an <a class="reference internal" href="napps_core.html#term-token-agent"><em class="xref std std-term">Token Agent</em></a> can obtain tokens
on behalf of other installed native applications
- thereby provisioning tokens to those applications and
so enabling a Single SignOn experience for End-Users.</p>
<div class="section" id="requirements-notation-and-conventions">
<h3><a class="toc-backref" href="#id5">1.1.  Requirements Notation and Conventions</a><a class="headerlink" href="#requirements-notation-and-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in [RFC2119].</p>
<p>Throughout this document, values are quoted to indicate that they are
to be taken literally.  When using these values in protocol messages,
the quotes MUST NOT be used as part of the value.</p>
</div>
<div class="section" id="terminology">
<h3><a class="toc-backref" href="#id6">1.2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>This specification uses the terms &#8220;Access Token&#8221;, &#8220;Refresh Token&#8221;,
&#8220;Authorization Code&#8221;, &#8220;Authorization Grant&#8221;, &#8220;Authorization Server&#8221;,
&#8220;Authorization Endpoint&#8221;, &#8220;Client&#8221;, &#8220;Client Identifier&#8221;, &#8220;Client
Secret&#8221;, &#8220;Protected Resource&#8221;, &#8220;Resource Owner&#8221;, &#8220;Resource Server&#8221;,
and &#8220;Token Endpoint&#8221; defined by OAuth 2.0 [RFC6749].  This
specification also defines the following terms:</p>
<dl class="glossary docutils">
<dt id="term-token-agent"><span id="term-ta"></span>Token Agent<br />TA</dt>
<dd>A native application that obtains access tokens
on behalf of other native applications
- thereby enabling a Single SignOn experience
for Native Application end users
because the End-Users need only explicitly
authenticate the _TA_ once per Authorization Server.</dd>
<dt id="term-appinfo-endpoint">AppInfo Endpoint</dt>
<dd><p class="first">A protected resource that the _TA_ can call
(using its primary access token)
to obtain metadata corresponding to a set of applications
- both web &amp; native.</p>
<p class="last">The _TA_ uses the application metadata
in order to obtain secondary access tokens for those applications.</p>
</dd>
<dt id="term-primary-token">Primary Token</dt>
<dd>An OAuth token
(access, refresh, and id_token)
obtained by the _TA_ for its own uses.</dd>
<dt id="term-secondary-token">Secondary Token</dt>
<dd>An OAuth access token
obtained by the _TA_ on behalf of another native application.</dd>
</dl>
</div>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id7">2.  Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>More and more applications,
both enterprise on-prem and cloud-based,
are accessed through REST APIs in addition to,
or instead of, browser-based access.</p>
<p>Mobile clients will be a key consumer of such APIs.</p>
<p>Native installed applications
(e.g for iOS , Android, BlackBerry, etc devices)
offer an important alternative to web or browser-based applications.</p>
<p>Both models have their pros/cons.</p>
<p>OAuth 2.0 is an authentication &amp; authorization framework
for such REST APIs.</p>
<p>Critically,
OAuth 2.0 is explicitly designed to support the variety of different client types
that will be accessing REST APIs
- both applications running on web servers
within the enterprise calling out to the cloud/partners etc,
as well as applications running on mobile phones
belonging to employees and customers.</p>
<p>OAuth supports this variety of client types
by defining multiple mechanisms for &#8216;getting a token&#8217;,
the different mechanisms acknowledging the constraints of particular client types.</p>
<p>For accessing protected resources behind an API using OAuth for authentication,
the mobile application requires an access token
- this to be presented on the HTTP calls to the API.</p>
<p>The high-level sequence
by which the client obtains and uses an access token is:</p>
<ul class="simple">
<li>Get the User authenticated
at the corresponding Authorization Server (AS)</li>
<li>(OPT) Get the AS to obtain the User&#8217;s consent
for the client&#8217;s access of the API</li>
<li>Accept the token(s) delivered back by the AS</li>
<li>Attach the access token to REST API calls</li>
</ul>
<p>The presumption is that each native application client
will perform the above steps.</p>
<p>When a User has multiple native applications
on their device (as is more and more the case)
this may be an unacceptable usability burden.</p>
<p>This burden can be reduced
by introducing an &#8216;authorization agent&#8217; (TA) onto the device.</p>
<p>Rather than each native application directly obtaining its own OAuth tokens,
the direct token retrieval is assumed by the authorization agent,
with the tokens then handed over to the native applications for their normal use.</p>
<p>Rather than the user individually authenticating
and authorizing each native application,
they do so only for the authorization agent
- this then bootstrapping subsequently obtaining tokens
for the other native applications.</p>
<p>Because the User only authenticates
and authorizes the authorization agent,
the usability burden is significantly reduced.</p>
<p>The _TA_ model is shown below:</p>
<div class="highlight-python"><pre>+-------------+
| Device      |
| +--------+  |                                          +---------------+
| |        |-------- Login &amp; Authorization (1)----------&gt;|               |
| |        |  |                                          |               |
| |  Token |&lt;------ Primary Tokens for TA - (2)----------|               |
| |  Agent |  |                                          |     AS        |
| |        |---- Request Secondary tokens for apps (3)--&gt;|               |
| |        |  |                                          |               |
| |        |&lt;-------Secondary Tokens for apps (4)--------|               |
| |        |  |                                          +---------------+
| +--------+  |                                             /\    /\
|    /\       |                                              |    |
|    | Pass   |                                        Validate tokens (7)
|    |Tokens  |                                              |    |
|    \/ (5)   |                                             \/    |
| +--------+  |                                           +-----+ |
| |  App1  | -|--------- API Call with token (6)--------&gt; | RS1 | |
| +--------+  |                                           +-----+ \/
| +--------+  |                                           +---------+
| |  App2  | -|--------- API Call with token (6)--------&gt; |  RS2    |
| +--------+  |                                           +---------+
| +--------+  |                                           +---------------+
| |  App3  | -|--------- API Call with token (6)--------&gt; |    RS3        |
| +--------+  |                                           +---------------+
+-------------+


                                Figure 1</pre>
</div>
<p>Note:</p>
<blockquote>
<div>the token validation of Step 7 may require a call
to the issuing AS (as shown)
or may be achieved locally via a digital signarture verification.</div></blockquote>
<p>A _TA_ must be able to obtain tokens (both primary &amp; secondary)
from Authorization Servers.</p>
<p>This specification profiles
the OpenID Connect Standard 1.0 specification for those interactions.</p>
<p>The _TA_ engages in messaging with the relevant Authorization Servers
according to this profile in order to obtain the secondary OAuth
access tokens on behalf of other native applications.</p>
</div>
<div class="section" id="deployment-models">
<h2><a class="toc-backref" href="#id8">3.  Deployment Models</a><a class="headerlink" href="#deployment-models" title="Permalink to this headline">¶</a></h2>
<p>The authorization agent model can be applied for two different
categories of native applications</p>
<ol class="arabic simple">
<li>multiple native applications that call APIs associated with a
single policy domain, e.g. multiple native applications created
by a consumer retailer or SaaS provider.</li>
<li>multiple native applications that call APIs associated with
different policy domains, e.g. multiple applications used by an
enterprise employee to access SaaS services relevant to their
role.</li>
</ol>
<p>While both scenarios imply the User authenticating and authorizing
each native application individually, in the first case the User
would interact with the same AS each time.  In the latter, it would
be different ASs.</p>
</div>
<div class="section" id="token-agent-authentication">
<h2><a class="toc-backref" href="#id9">4.  Token Agent Authentication</a><a class="headerlink" href="#token-agent-authentication" title="Permalink to this headline">¶</a></h2>
<p>A _TA_ MUST authenticate to the AS both when obtaining primary or
secondary tokens.</p>
</div>
<div class="section" id="token-agent-registration">
<h2><a class="toc-backref" href="#id10">5.  Token Agent Registration</a><a class="headerlink" href="#token-agent-registration" title="Permalink to this headline">¶</a></h2>
<p>A _TA_ is a specialized OpenID Connect Client and, as such, MUST be
registered with an AS.</p>
<p>This profile does not dictate a particular registration model but
registration MUST result in the _TA_ having client credentials to be
used on the subsequent protocol flows defined here, ie. to obtain
both primary &amp; secondary tokens.</p>
<p>OpenID Connect Dynamic Client Registration 1.0 [OpenID.Registration]
MAY be used to provide individual client_id and credentials for each
instance of a TA.</p>
</div>
<div class="section" id="id-token">
<h2><a class="toc-backref" href="#id11">6.  ID Token</a><a class="headerlink" href="#id-token" title="Permalink to this headline">¶</a></h2>
<p>The ID Token is a security token that contains Claims
about the authentication event and other requested Claims.</p>
<p>The ID Token is represented as a JSON Web Token (JWT) [JWT].</p>
<p>The ID Token is used to manage the authentication event.
The user is passed as the value of &#8220;sub&#8221; is scoped to the &#8220;iss&#8221;.</p>
<p>The ID Token is audience restricted to either the _TA_ or a remote AS
via the &#8220;aud&#8221; (audience) Claim.</p>
<p>In the _TA_ model,
&#8220;id_token&#8221; may have two different types of &#8220;aud&#8221; (audience).</p>
<ol class="arabic">
<li><p class="first">one targeted at the _TA_,
returned to it in exchange for the authz code.</p>
</li>
<li><p class="first">one targeted at a remote AS,
returned to the _TA_ in exchange for a refresh token.</p>
<p>The _TA_ exchanges such an id_token
at the corresponding remote AS
using an assertion flow for a secondary access token.</p>
</li>
</ol>
<p>The following is a non-normative example of a base64url decoded ID
Token with the _TA_ as the value of &#8220;aud&#8221; (with line wraps for
display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;iss&quot;</span><span class="o">:</span> <span class="s2">&quot;https://server.example.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;sub&quot;</span><span class="o">:</span> <span class="s2">&quot;24400320&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aud&quot;</span><span class="o">:</span> <span class="s2">&quot;TA-client-ID&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span> <span class="mi">1311281970</span><span class="p">,</span>
 <span class="s2">&quot;iat&quot;</span><span class="o">:</span> <span class="mi">1311280970</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The following is a non-normative example of
a base64url decoded ID Token with the remote AS
as the value of &#8220;aud&#8221; and the _TA_
as the value of &#8220;azp&#8221; (with line wraps for display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;iss&quot;</span><span class="o">:</span> <span class="s2">&quot;https://server.example.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;sub&quot;</span><span class="o">:</span> <span class="s2">&quot;24400320&quot;</span><span class="p">,</span>
 <span class="s2">&quot;azp&quot;</span><span class="o">:</span> <span class="s2">&quot;TA-client-ID&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aud&quot;</span><span class="o">:</span> <span class="s2">&quot;https://server.partner.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span> <span class="mi">1311281970</span><span class="p">,</span>
 <span class="s2">&quot;iat&quot;</span><span class="o">:</span> <span class="mi">1311280970</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="protocol-flows">
<h2><a class="toc-backref" href="#id12">7.  Protocol Flows</a><a class="headerlink" href="#protocol-flows" title="Permalink to this headline">¶</a></h2>
<p>This section details the various protocol flows
that the _TA_ and other actors engage in.</p>
<div class="section" id="primary-token-retrieval">
<h3><a class="toc-backref" href="#id13">7.1.  Primary Token Retrieval</a><a class="headerlink" href="#primary-token-retrieval" title="Permalink to this headline">¶</a></h3>
<p>The _TA_ first performs an OpenID Connect flow to obtain its own
primary tokens.  The _TA_ MUST use the code flow, which consists of
the following steps:</p>
<ol class="arabic simple">
<li>_TA_ prepares an Authorization Request containing the desired
request parameters.</li>
<li>_TA_ sends a request to the Authorization Server.</li>
<li>Authorization Server authenticates the End-User.</li>
<li>Authorization Server obtains the End-User Consent/Authorization.</li>
<li>Authorization Server sends the End-User back to the _TA_ with a
&#8220;code&#8221;.</li>
<li>_TA_ sends the &#8220;code&#8221; to the Token Endpoint to receive primary
Access Token, Refresh Token and ID Token in the response.</li>
</ol>
<div class="section" id="token-agent-prepares-authorization-request">
<h4><a class="toc-backref" href="#id14">7.1.1.  Token Agent Prepares Authorization Request</a><a class="headerlink" href="#token-agent-prepares-authorization-request" title="Permalink to this headline">¶</a></h4>
<p>To initiate obtaining primary tokens,
the _TA_ prepares an Authorization Request
to the Authorization Endpoint.</p>
<p>The scheme used in the Authorization Endpoint URL MUST be HTTPS.</p>
<p>Clients MAY construct the request using the HTTP &#8220;GET&#8221; or the HTTP
&#8220;POST&#8221; method.</p>
<p>This profile further constrains the following request parameters:</p>
<dl class="glossary docutils">
<dt id="term-response-type">response_type</dt>
<dd>This value MUST be &#8220;code&#8221;.</dd>
</dl>
<p>Other REQUIRED parameters in the request include the following:</p>
<dl class="glossary docutils">
<dt id="term-client-id">client_id</dt>
<dd>OAuth 2.0 Client Identifier for the _TA_.</dd>
<dt id="term-scope">scope</dt>
<dd><p class="first">OAuth 2.0 &#8220;scope&#8221; value.</p>
<p>It MUST include &#8220;openid&#8221; as one of the space delimited ASCII strings.</p>
<p class="last">It MUST also include &#8220;aza&#8221;.</p>
</dd>
<dt id="term-redirect-uri">redirect_uri</dt>
<dd><p class="first">Redirection URI to which the response will be sent.</p>
<p class="last">This MUST be pre-registered with the provider.</p>
</dd>
</dl>
<p>The following is a non-normative example of an Authorization Request
URL (with line wraps for display purposes only):</p>
<div class="highlight-python"><pre>https://server.example.com/authorize?
  response_type=code
  &amp;client_id=s6BhdRkqt3
  &amp;redirect_uri=https%3A%2F%2Fclient.example.org%2Fcb
  &amp;scope=openid%20aza</pre>
</div>
</div>
<div class="section" id="token-agent-sends-request-to-authorization-server">
<h4><a class="toc-backref" href="#id15">7.1.2.  Token Agent Sends Request to Authorization Server</a><a class="headerlink" href="#token-agent-sends-request-to-authorization-server" title="Permalink to this headline">¶</a></h4>
<p>Having constructed the Authorization Request,
the _TA_ sends it to the Authorization Endpoint.</p>
<p>This MAY happen via HTTPS redirect, hyperlinking,
or any other secure means of directing the User-Agent to the URL.</p>
</div>
<div class="section" id="authorization-server-authenticates-end-user">
<h4><a class="toc-backref" href="#id16">7.1.3.  Authorization Server Authenticates End-User</a><a class="headerlink" href="#authorization-server-authenticates-end-user" title="Permalink to this headline">¶</a></h4>
<p>The authorization server authenticates the resource owner
to make sure that the consent is obtained from the right party.</p>
<p>The exact method of how the authentication is performed
is out of scope of this specification.</p>
</div>
<div class="section" id="authorization-server-obtains-end-user-consent-authorization">
<h4><a class="toc-backref" href="#id17">7.1.4.  Authorization Server Obtains End-User Consent/Authorization</a><a class="headerlink" href="#authorization-server-obtains-end-user-consent-authorization" title="Permalink to this headline">¶</a></h4>
<p>The Authorization Server MAY obtain an authorization decision.</p>
<p>This can done by presenting the End-User with a dialogue
that allows the End-User to recognize what he is consenting
to and obtain his consent or by establishing consent via other means
(for example, via previous administrative consent).</p>
<p>The &#8220;openid&#8221; scope value declares
that this OAuth 2.0 request is an OpenID Connect request.</p>
<p>The &#8220;aza&#8221; scope value declares that the _TA_ is requesting tokens
that can be used to obtain other secondary tokens for those
applications relevant to the End-User.</p>
</div>
<div class="section" id="authorization-server-sends-end-user-back-to-trust-agent">
<h4><a class="toc-backref" href="#id18">7.1.5.  Authorization Server Sends End-User Back to Trust Agent</a><a class="headerlink" href="#authorization-server-sends-end-user-back-to-trust-agent" title="Permalink to this headline">¶</a></h4>
<p>Once the authorization is determined,
the Authorization Server returns a successful response or an error response.</p>
</div>
<div class="section" id="success-case-end-user-granted-authorization">
<h4><a class="toc-backref" href="#id19">7.1.5.1.  Success Case - End-User Granted Authorization</a><a class="headerlink" href="#success-case-end-user-granted-authorization" title="Permalink to this headline">¶</a></h4>
<p>If the Resource Owner grants the authorization request initiated
by the _TA_,
the Authorization Server issues a &#8220;code&#8221; and delivers it to the _TA_ by
adding the following query parameters
to the query component of the redirection URI
using the &#8220;application/x-www-form-urlencoded&#8221; format
as defined in Section 4.1.2 of OAuth 2.0 [RFC6749].</p>
<dl class="glossary docutils">
<dt id="term-code">code</dt>
<dd>REQUIRED.  OAuth 2.0 authorization code.</dd>
<dt id="term-state">state</dt>
<dd><p class="first">OAuth 2.0 state value.</p>
<p>REQUIRED if the &#8220;state&#8221; parameter is present
in the Authorization Request from the _TA_.</p>
<p class="last">The _TA_ MUST verify that the &#8220;state&#8221; value
is equal to the exact value of &#8220;state&#8221; parameter
in the Authorization Request.</p>
</dd>
</dl>
</div>
<div class="section" id="error-case-end-user-denied-authorization-or-invalid-request">
<h4><a class="toc-backref" href="#id20">7.1.5.2.  Error Case - End-User Denied Authorization or Invalid Request</a><a class="headerlink" href="#error-case-end-user-denied-authorization-or-invalid-request" title="Permalink to this headline">¶</a></h4>
<p>If the End-User denies the authorization or the End-User
authentication fails,
the Authorization Server MUST return the error
authorization response as defined
in 4.1.2.1 of OAuth 2.0 [RFC6749].</p>
<p>No other parameters SHOULD be returned.</p>
</div>
<div class="section" id="token-agent-obtains-primary-id-token-access-token-and-refresh-token">
<h4><a class="toc-backref" href="#id21">7.1.6.  Token Agent Obtains Primary ID Token, Access Token and Refresh Token</a><a class="headerlink" href="#token-agent-obtains-primary-id-token-access-token-and-refresh-token" title="Permalink to this headline">¶</a></h4>
<p>Once having obtained the &#8220;code&#8221;,
the _TA_ requests the corresponding primary tokens at the Token Endpoint as follows:</p>
</div>
<div class="section" id="token-agent-sends-code">
<h4><a class="toc-backref" href="#id22">7.1.6.1.  Token Agent Sends Code</a><a class="headerlink" href="#token-agent-sends-code" title="Permalink to this headline">¶</a></h4>
<p>The _TA_ makes a request to the token endpoint as described
in Section 4.1.3 of OAuth 2.0 [RFC6749].</p>
<p>The _TA_ MUST authenticate to the Token Endpoint as described
in Section 2.3 of OAuth 2.0 [RFC6749].</p>
</div>
<div class="section" id="token-agent-receives-tokens">
<h4><a class="toc-backref" href="#id23">7.1.6.2.  Token Agent Receives Tokens</a><a class="headerlink" href="#token-agent-receives-tokens" title="Permalink to this headline">¶</a></h4>
<p>The _TA_ receives a response with the following parameters as
described in Section 4.1.4 of OAuth 2.0 [RFC6749].  The response
should be encoded using UTF-8.</p>
<dl class="glossary docutils">
<dt id="term-access-token">access_token</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">Primary Access Token for the AppInfo Endpoint.</p>
</dd>
<dt id="term-token-type">token_type</dt>
<dd><p class="first">REQUIRED.</p>
<p>OAuth 2.0 token type value.</p>
<p>The value MUST be &#8220;bearer&#8221;.
_TA_ implementing this profile MUST support the OAuth 2.0 Bearer Token Usage [RFC6750] specification.</p>
<p class="last">This profile only describes the use of bearer tokens.</p>
</dd>
<dt id="term-id-token">id_token</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">Primary ID Token.</p>
</dd>
<dt id="term-expires-in">expires_in</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Expiration time of the Access Token in seconds.</p>
</dd>
<dt id="term-refresh-token">refresh_token</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">Primary Refresh Token.</p>
</dd>
</dl>
<p>The following is a non-normative example (with line wraps for the
display purposes only):</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
Pragma: no-cache
{
 "access_token":"SlAV32hkKG",
 "token_type":"bearer",
 "expires_in":3600,
 "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
 "id_token":"eyJ0 ... NiJ9.eyJ1c ... I6IjIifX0.DeWt4Qu ... ZXso"
}</pre>
</div>
</div>
</div>
<div class="section" id="appinfo-endpoint">
<h3><a class="toc-backref" href="#id24">7.2.  AppInfo Endpoint</a><a class="headerlink" href="#appinfo-endpoint" title="Permalink to this headline">¶</a></h3>
<p>To obtain application metadata information, the _TA_ MAY make a GET
or POST request to the AppInfo Endpoint.</p>
<p>AppInfo Endpoint Servers MUST require the use of a transport-layer
security mechanism.  The AppInfo Endpoint Server MUST support TLS 1.2
RFC 5246 [RFC5246] and/or TLS 1.0 [RFC2246] and MAY support other
transport-layer mechanisms with equivalent security.</p>
<div class="section" id="appinfo-request">
<h4><a class="toc-backref" href="#id25">7.2.1.  AppInfo Request</a><a class="headerlink" href="#appinfo-request" title="Permalink to this headline">¶</a></h4>
<p>_TA_ MAY send requests with the following parameters
to the AppInfo Endpoint to obtain further information
about the applications for which the TA can obtain secondary tokens.</p>
<p>The AppInfo Endpoint is an OAuth 2.0 [RFC6749] Protected Resource
that complies with the OAuth 2.0 Bearer Token Usage [RFC6750] specification.</p>
<p>As such,
the Access Token SHOULD be specified via the HTTP Authorization header.</p>
<dl class="glossary docutils">
<dt id="term-16">access_token</dt>
<dd><p class="first">REQUIRED.</p>
<p>Access Token obtained from an OpenID Connect Authorization Request.</p>
<p class="last">This parameter MUST only be sent using one method
through either the HTTP Authorization header
or a form- encoded HTTP POST body parameter.</p>
</dd>
<dt id="term-schema">schema</dt>
<dd><p class="first">REQUIRED.</p>
<p>Schema in which the data is to be returned.</p>
<p class="last">The only defined &#8220;schema&#8221; value is &#8220;aza&#8221;.</p>
</dd>
</dl>
</div>
<div class="section" id="appinfo-response">
<h4><a class="toc-backref" href="#id26">7.2.2.  AppInfo Response</a><a class="headerlink" href="#appinfo-response" title="Permalink to this headline">¶</a></h4>
<p>The AS MUST determine the authorizations attached to the primary
refresh token sent by the _TA_ and respond accordingly.</p>
<p>The AS MUST NOT include metadata for an application that the End-User
is not authorized to use.</p>
<p>The AS returns the application metadata information to the _TA_ in
the form of JSON, an example of which is shown below</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;schema&quot;</span><span class="o">:</span> <span class="s2">&quot;urn:aza:schemas:core:1.0&quot;</span><span class="p">,</span>
    <span class="s2">&quot;branding&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;companyname&quot;</span><span class="o">:</span> <span class="s2">&quot;ABS&quot;</span><span class="p">,</span>
        <span class="s2">&quot;companyiconurl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.ABS.com/logo.gif&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;apps&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;appcount&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;app&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Boxx&quot;</span><span class="p">,</span>
                <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;native&quot;</span><span class="p">,</span>
                <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;urn:oauth:boxx&quot;</span><span class="p">,</span>
                <span class="s2">&quot;iconurl&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/pic.png&quot;</span><span class="p">,</span>
                <span class="s2">&quot;customurl&quot;</span><span class="o">:</span> <span class="s2">&quot;boxxnative&quot;</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The _TA_ MAY use the information from the AppInfo endpoint
to build a user interface for the user,
displaying the applications they are authorized to use.</p>
<p>The _TA_ MUST use the value of the &#8220;scope&#8221; parameter to indicate the
desired targeted application when subsequently requesting a secondary
access token for that application.</p>
<p>If using the custom URL scheme mechanism to pass the secondary access
token to the relevant application, the _TA_ MUST use the value of the
&#8220;customurl&#8221; parameter when constructing the URL.</p>
</div>
</div>
<div class="section" id="primary-access-token-refresh">
<h3><a class="toc-backref" href="#id27">7.3.  Primary access token refresh</a><a class="headerlink" href="#primary-access-token-refresh" title="Permalink to this headline">¶</a></h3>
<p>The _TA_ MAY use its primary refresh token to obtain fresh primary
access tokens for its own use on calls to the AppInfo endpoint.</p>
<p>If the _TA_ does not specify a scope of any native application on its
refresh call, it is requesting a fresh primary access token.</p>
<p>The _TA_ MUST NOT share its primary access or refresh tokens with
other native applications.</p>
</div>
<div class="section" id="secondary-access-token-retrieval">
<h3><a class="toc-backref" href="#id28">7.4.  Secondary Access Token Retrieval</a><a class="headerlink" href="#secondary-access-token-retrieval" title="Permalink to this headline">¶</a></h3>
<p>The _TA_ can use its primary refresh token to obtain secondary access
tokens for native applications.  Depending on the requirements of the
targeted application, a secondary access token is either directly
returned for the refresh token, or an id_token that csn be
subsequently exchanged at an AS hosted by the application provider.
The second scenario supports deployments where some native
applications are already associated withnan AS, and the application
RS is preconfigured to only validate tokens against that AS.</p>
<p>The _TA_ can be prompted to obtain an secondary access token for an
application either due to a user clicking on an icon displayed by the
_TA_ (a launcher model) , or by the native application asking the
_TA_ for a token (presumably after being launched through the OS
native UI).</p>
<div class="section" id="secondary-access-token-request">
<h4><a class="toc-backref" href="#id29">7.4.1.  Secondary access token request</a><a class="headerlink" href="#secondary-access-token-request" title="Permalink to this headline">¶</a></h4>
<p>The _TA_ MUST use its primary refresh token to request of the AS a
secondary access token - specifying as a scope the relevant native
application to be targeted (rather than itself).  The _TA_ MAY obtain
the relevant scope parameter for a particular native application via
the AppInfo endpoint or through some other mechanism.</p>
<p>Example of a refresh call where the _TA_ is asking for a secondary
access token for a native application with a specified scope of
&#8220;<a class="reference external" href="urn:oauth:boxx">urn:oauth:boxx</a>&#8221;.</p>
<div class="highlight-python"><pre>POST /as/token.oauth2 HTTP/1.1
Host: as.example.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=refresh_token&amp;refresh_token=qANLTbu17rk17lPszecHRi7rqJt46pG1qx0nTAqXWH&amp;scope=urn:oauth:boxx</pre>
</div>
</div>
<div class="section" id="response">
<h4><a class="toc-backref" href="#id30">7.4.2.  Response</a><a class="headerlink" href="#response" title="Permalink to this headline">¶</a></h4>
<p>The AS MUST verify that the End-User is authorized to use the
particular native application for which the secondary access token
was requested.</p>
<p>The AS MAY check local policy, or MAY call out to an external policy
store.</p>
<p>If authorized, the AS returns the secondary access token or id_token,
depending on the policy configured for that application.</p>
<p>The AS MAY bind the secondary access token to the specific native
application through cryptographic or other means.</p>
</div>
<div class="section" id="secondary-access-token-retrieval-from-remote-as">
<h4><a class="toc-backref" href="#id31">7.4.3.  Secondary access token retrieval from remote AS</a><a class="headerlink" href="#secondary-access-token-retrieval-from-remote-as" title="Permalink to this headline">¶</a></h4>
<p>TBD - show how the TA 1) obtains an id_token using the refresh token
and 2) uses that id_token to request of a secondary AS an access
token.</p>
</div>
</div>
<div class="section" id="validation">
<h3><a class="toc-backref" href="#id32">7.5.  Validation</a><a class="headerlink" href="#validation" title="Permalink to this headline">¶</a></h3>
<p>When an RS receives a secondary access token on an API call from a
native application, it will need to validate that access token to
determine whether to approve the request or not.</p>
<p>This profile does not dictate a particular validation model.</p>
<p>Depending on the nature of the secondary access token, the RS MAY
call back to the issuing AS for validation.  Alternatively the RS MAY
validate the token <em>locally</em>, ie through verification of a signature
over that token.</p>
</div>
</div>
<div class="section" id="native-application-interactions">
<h2><a class="toc-backref" href="#id33">8.  Native Application Interactions</a><a class="headerlink" href="#native-application-interactions" title="Permalink to this headline">¶</a></h2>
<p>This section outlines how an _TA_ might pass secondary access tokens
to corresponding native applications, or how the native application
might request of the _TA_ such a secondary access token.</p>
<div class="section" id="token-agent-passes-secondary-access-token-to-application">
<h3><a class="toc-backref" href="#id34">8.1.  Token Agent passes secondary access token to Application</a><a class="headerlink" href="#token-agent-passes-secondary-access-token-to-application" title="Permalink to this headline">¶</a></h3>
<p>Once it has obtained a secondary access token for a particular native
application, the _TA_ MUST deliver that secondary access token to
that application.</p>
<p>The _TA_ MUST NOT deliver a secondary access token to an application
for which it was not issued.</p>
<p>This profile does not stipulate a particular mechanism for the
delivery of the secondary access token, depending as it does on the
mobile OS support for inter-app messaging.</p>
<p>One mechanism supported by both iOS and Android is the use of custom
URL schemes.  In this model, a native appliction registers itself
with the mobile OS as the handler for URLs in a given scheme - when
the OS subsequently sees URLs in this scheme, it hands them over to
the native application.</p>
<p>To use this model, each native application that wants _TA_
integration must register itself as the handler for a unique URL
scheme.</p>
<p>Follows is the Android mechanism</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.MyAppRegisterAccount&quot;</span> <span class="na">android:label=</span><span class="s">&quot;@string/addAccount&quot;</span> <span class="nt">&gt;</span>
        <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.VIEW&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.DEFAULT&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.BROWSABLE&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:scheme=</span><span class="s">&quot;nativeapp&quot;</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/intent-filter&gt;</span>
<span class="nt">&lt;/activity&gt;</span>
</pre></div>
</div>
<p>The same URL scheme identifier must be configured into the AS and
AppInfo endpoint when the native application is configured so that
access tokens can be appropriately targeted.</p>
<p>After obtaining an access token for a particular native application,
the _TA_ builds a URL in the corresponding custom scheme that
includes the token.</p>
<p>The URL MUST</p>
<ul class="simple">
<li>have a scheme corresponding to the appropriate native application</li>
<li>have an &#8216;access_token&#8217; parameter with the token value to be passed</li>
</ul>
<p>For instance</p>
<div class="highlight-python"><pre>nativeapp://new_token?access_token=PeRTSD9RQrbiuoaHVPxV41MzW1qS</pre>
</div>
</div>
<div class="section" id="application-requests-secondary-access-token-of-token-agent">
<h3><a class="toc-backref" href="#id35">8.2.  Application requests secondary access token of Token Agent</a><a class="headerlink" href="#application-requests-secondary-access-token-of-token-agent" title="Permalink to this headline">¶</a></h3>
<p>A _TA_ SHOULD support an native application being able to request of
the _TA_ an access token, as compared to the _TA_ handing an
unsolicited access token to an application.</p>
<p>One mechanism to achive this is that, upon installation, the _TA_
register itself as the handler for URLs with a particular scheme.A
native applicaton can construct URLs in that scheme as a means of
requesting of the _TA_ that an access token be obtained.</p>
</div>
</div>
<div class="section" id="security-considerations">
<h2><a class="toc-backref" href="#id36">9.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</div>
<div class="section" id="privacy-considerations">
<h2><a class="toc-backref" href="#id37">10.  Privacy Considerations</a><a class="headerlink" href="#privacy-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</div>
<div class="section" id="iana-considerations">
<h2><a class="toc-backref" href="#id38">11.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This document makes no requests of IANA.</p>
</div>
<div class="section" id="normative-references">
<h2><a class="toc-backref" href="#id39">12.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="appendix-a-acknowledgements">
<h2><a class="toc-backref" href="#id40">Appendix A.  Acknowledgements</a><a class="headerlink" href="#appendix-a-acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>The following have contributed to the development of this
specification.</p>
<blockquote>
<div><p>Chuck Mortimore</p>
<p>Brian Campbell</p>
<p>Scott Tomilson</p>
<p>John Bradley</p>
</div></blockquote>
</div>
<div class="section" id="appendix-b-notices">
<h2><a class="toc-backref" href="#id41">Appendix B.  Notices</a><a class="headerlink" href="#appendix-b-notices" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>Copyright (c) 2013 The OpenID Foundation.</div></blockquote>
<p>The OpenID Foundation (OIDF) grants to any Contributor, developer,
implementer, or other interested party a non-exclusive, royalty free,
worldwide copyright license to reproduce, prepare derivative works
from, distribute, perform and display, this Implementers Draft or
Final Specification solely for the purposes of (i) developing
specifications, and (ii) implementing Implementers Drafts and Final
Specifications based on such documents, provided that attribution be
made to the OIDF as the source of the material, but that such
attribution does not indicate an endorsement by the OIDF.</p>
<p>The technology described in this specification was made available
from contributions from various sources, including members of the
OpenID Foundation and others.  Although the OpenID Foundation has
taken steps to help ensure that the technology is available for
distribution, it takes no position regarding the validity or scope of
any intellectual property or other rights that might be claimed to
pertain to the implementation or use of the technology described in
this specification or the extent to which any license under such
rights might or might not be available; neither does it represent
that it has made any independent effort to identify any such rights.
The OpenID Foundation and the contributors to this specification make
no (and hereby expressly disclaim any) warranties (express, implied,
or otherwise), including implied warranties of merchantability, non-
infringement, fitness for a particular purpose, or title, related to
this specification, and the entire risk as to implementing this
specification is assumed by the implementer.  The OpenID Intellectual
Property Rights policy requires contributors to offer a patent
promise not to assert certain patent claims against other
contributors and against implementers.  The OpenID Foundation invites
any interested party to bring to its attention any copyrights,
patents, patent applications, or other proprietary rights that may
cover technology that may be required to practice this specification.</p>
</div>
<div class="section" id="appendix-c-document-history">
<h2><a class="toc-backref" href="#id42">Appendix C.  Document History</a><a class="headerlink" href="#appendix-c-document-history" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>[[ To be removed from the final specification ]]</p>
<p>-01</p>
<p>o  Initial draft</p>
<p>o  Added OIDF Standard Notice</p>
<p>o  Changed reference to Core from Standard</p>
<p>o  Changed diagam step 2 tokens, made 5 and 7 bidirectional arrows</p>
<p>-02</p>
<p>o  Second draft</p>
</div></blockquote>
</div>
<div class="section" id="authors-addresses">
<h2><a class="toc-backref" href="#id43">Authors&#8217; Addresses</a><a class="headerlink" href="#authors-addresses" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Paul Madsen
Ping Identity</p>
<p>Email: <a class="reference external" href="mailto:paul&#46;madsen&#37;&#52;&#48;gmail&#46;com">paul<span>&#46;</span>madsen<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>Ashish Jain
VMware</p>
<p>Email: <a class="reference external" href="mailto:itickr&#37;&#52;&#48;gmail&#46;com">itickr<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<p>Andy Zmolek
Enterproid</p>
<p>Email: <a class="reference external" href="mailto:andy&#46;zmolek&#37;&#52;&#48;enterproid&#46;com">andy<span>&#46;</span>zmolek<span>&#64;</span>enterproid<span>&#46;</span>com</a></p>
<p>John Bradley
Ping Identity</p>
<p>Email: <a class="reference external" href="mailto:jbradley&#37;&#52;&#48;pingidentity&#46;com">jbradley<span>&#64;</span>pingidentity<span>&#46;</span>com</a></p>
</div></blockquote>
</div>
<div class="section" id="full-copyright-statement">
<h2><a class="toc-backref" href="#id44">Full Copyright Statement</a><a class="headerlink" href="#full-copyright-statement" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Copyright (C) OpenID Foundation (2013).  All Rights Reserved.</p>
<p>The OpenID Foundation (OIDF) grants to any Contributor, developer,
implementer, or other interested party a non-exclusive, royalty free,
worldwide copyright license to reproduce, prepare derivative works
from, distribute, perform and display, this Implementers Draft or
Final Specification solely for the purposes of (i) developing
specifications, and (ii) implementing Implementers Drafts and Final
Specifications based on such documents, provided that attribution be
made to the OIDF as the source of the material, but that such
attribution does not indicate an endorsement by the OIDF.</p>
<p>The technology described in this specification was made available
from contributions from various sources, including members of the
OpenID Foundation and others.  Although the OpenID Foundation has
taken steps to help ensure that the technology is available for
distribution, it takes no position regarding the validity or scope of
any intellectual property or other rights that might be claimed to
pertain to the implementation or use of the technology described in
this specification or the extent to which any license under such
rights might or might not be available; neither does it represent
that it has made any independent effort to identify any such rights.
The OpenID Foundation and the contributors to this specification make
no (and hereby expressly disclaim any) warranties (express, implied,
or otherwise), including implied warranties of merchantability, non-
infringement, fitness for a particular purpose, or title, related to
this specification, and the entire risk as to implementing this
specification is assumed by the implementer.  The OpenID Intellectual
Property Rights policy requires contributors to offer a patent
promise not to assert certain patent claims against other
contributors and against implementers.  The OpenID Foundation invites
any interested party to bring to its attention any copyrights,
patents, patent applications, or other proprietary rights that may
cover technology that may be required to practice this specification.</p>
</div></blockquote>
</div>
<div class="section" id="intellectual-property">
<h2><a class="toc-backref" href="#id45">Intellectual Property</a><a class="headerlink" href="#intellectual-property" title="Permalink to this headline">¶</a></h2>
<p>For OpenID Foundation&#8217;s IPR Policy, refer to
<a class="reference external" href="http://openid.net/ipr/OpenID_IPR_Policy_(Final_Clean_20071221).pdf">http://openid.net/ipr/OpenID_IPR_Policy_(Final_Clean_20071221).pdf</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>