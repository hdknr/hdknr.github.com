

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenID Connect Session Management 1.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="User-Managed Access (UMA) Core Protocol" href="uma_core.html" />
    <link rel="prev" title="OpenID Connect Discovery 1.0" href="discovery.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>OpenID Connect Session Management 1.0</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="discovery.html">OpenID Connect Discovery 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="uma_core.html">User-Managed Access (UMA) Core Protocol</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="openid-connect-session-management-1-0">
<h1><a class="toc-backref" href="#id1">OpenID Connect Session Management 1.0</a><a class="headerlink" href="#openid-connect-session-management-1-0" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://openid.net/specs/openid-connect-session-1_0.html">OpenID Connect Session Management 1.0 - draft 03</a> .</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Now Draft 05</p>
</div>
<div class="section" id="abstract">
<span id="session-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>OpenID Connect 1.0 is a simple identity layer on top of the OAuth 2.0 protocol. It allows Clients to verify the identity of the End-User based on the authentication performed by an Authorization Server, as well as to obtain basic profile information about the End-User in an interoperable and RESTful manner.</p>
<p>This document describes how to manage sessions for OpenID Connect.</p>
<p>(Draft 05)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="glossary.html#term-session-management-endpoint"><em class="xref std std-term">Session Management Endpoint</em></a> controlls  the session</li>
<li>So What is the session ?</li>
</ul>
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#openid-connect-session-management-1-0" id="id1">OpenID Connect Session Management 1.0</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-notation-and-conventions" id="id4">1.1.  Requirements Notation and Conventions</a></li>
<li><a class="reference internal" href="#terminology" id="id5">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-management" id="id6">2.  Session Management</a><ul>
<li><a class="reference internal" href="#creating-sessions" id="id7">2.1.  Creating Sessions</a><ul>
<li><a class="reference internal" href="#authorization-request" id="id8">2.1.2.  Authorization Request</a></li>
<li><a class="reference internal" href="#token-endpoint" id="id9">2.1.3.  Token Endpoint</a><ul>
<li><a class="reference internal" href="#access-token-response" id="id10">2.1.3.1.  Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implicit-user-agent-flow" id="id11">2.1.4.  Implicit (User-Agent) Flow</a><ul>
<li><a class="reference internal" href="#implicit-flow-request" id="id12">2.1.4.1.  Implicit Flow Request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implicit-flow-response" id="id13">2.1.4.2.  Implicit Flow Response</a></li>
<li><a class="reference internal" href="#authorization-code-web-server-flow" id="id14">2.1.5.  Authorization Code (Web Server) Flow</a><ul>
<li><a class="reference internal" href="#authorization-code-flow-request" id="id15">2.1.5.1.  Authorization Code Flow Request</a></li>
<li><a class="reference internal" href="#authorization-code-flow-response" id="id16">2.1.5.2.  Authorization Code Flow Response</a></li>
<li><a class="reference internal" href="#token-access-request" id="id17">2.1.5.3.  Token Access Request</a></li>
<li><a class="reference internal" href="#token-access-response" id="id18">2.1.5.4.  Token Access Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fourth-party-native-applications" id="id19">2.1.6.  Fourth Party Native Applications</a><ul>
<li><a class="reference internal" href="#browser-load" id="id20">2.1.6.1.  Browser Load</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#session-management-endpoints" id="id21">2.2.  Session Management Endpoints</a><ul>
<li><a class="reference internal" href="#refresh-session" id="id22">2.2.1.  Refresh Session</a></li>
<li><a class="reference internal" href="#end-session" id="id23">2.2.2.  End Session</a></li>
</ul>
</li>
<li><a class="reference internal" href="#session-synchronization" id="id24">2.3.  Session Synchronization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id25">3.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations" id="id26">4.  Security Considerations</a></li>
<li><a class="reference internal" href="#normative-references" id="id27">5. Normative References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="session-1"></span><h2><a class="toc-backref" href="#id3">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Sessions are used to keep track of information and interactions for users
across multiple pages.
This creates a sense of continuity, customization,
and a more pleasant experience for the users.
Visitors to an OpenID Relying Party site accessing <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">Protected Resources</em></a>
will be asked for authentication and authorization.
Upon user authorization,
the user will be granted access to the <a class="reference internal" href="glossary.html#term-requested-resources"><em class="xref std std-term">requested resources</em></a>.</p>
<p>The site may perform other background tasks for the user using the same authenticated session.
This allows the user to have a simplified experience without being asked for authorization
each time and may even allow the user to go off-line while the tasks are being performed.
This specification describes how OpenID Connect sessions can be created, used, and terminated.</p>
<p>(Draft 05)</p>
<div class="section" id="requirements-notation-and-conventions">
<span id="session-1-1"></span><h3><a class="toc-backref" href="#id4">1.1.  Requirements Notation and Conventions</a><a class="headerlink" href="#requirements-notation-and-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119 [RFC2119].</p>
<p>Throughout this document, values are quoted to indicate that they are to be taken literally. When using these values in protocol messages, the quotes MUST NOT be used as part of the value.</p>
</div>
<div class="section" id="terminology">
<span id="session-1-2"></span><h3><a class="toc-backref" href="#id5">1.2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>This specification uses the terms &#8220;Access Token&#8221;, &#8220;Refresh Token&#8221;, &#8220;Authorization Code&#8221;, &#8220;Authorization Grant&#8221;, &#8220;Authorization Server&#8221;, &#8220;Authorization Endpoint&#8221;, &#8220;Client&#8221;, &#8220;Client Identifier&#8221;, &#8220;Client Secret&#8221;, &#8220;Protected Resource&#8221;, &#8220;Resource Owner&#8221;, &#8220;Resource Server&#8221;, and &#8220;Token Endpoint&#8221; defined by OAuth 2.0 [OAuth2.0], and the terms defined by OpenID Connect Messages 1.0 [OpenID.Messages]. This specification also defines the following terms:</p>
<dl class="glossary docutils">
<dt id="term-client">Client</dt>
<dd>An application obtaining authorization and making Protected Resource requests.</dd>
<dt id="term-client-identifier">Client Identifier</dt>
<dd>A unique identifier that the Client uses to identify itself to the OP.</dd>
<dt id="term-identifier">Identifier</dt>
<dd><p class="first">An Identifier is either an http or https URI
(commonly referred to as a &#8220;URL&#8221; within this document),
or an account URI.</p>
<p class="last">This document defines various kinds of Identifiers, designed for use in different contexts.</p>
</dd>
<dt id="term-base64url">Base64url</dt>
<dd>Base 64 Encoding [RFC3548] with URL and Filename Safe Alphabet without padding.</dd>
<dt id="term-client-servlet">Client Servlet</dt>
<dd>A web application that is also an OAuth 2.0 Client.</dd>
</dl>
<p>(draft 05)</p>
</div>
</div>
<div class="section" id="session-management">
<span id="session-2"></span><h2><a class="toc-backref" href="#id6">2.  Session Management</a><a class="headerlink" href="#session-management" title="Permalink to this headline">¶</a></h2>
<p>OpenID Connect supports <strong>life-cycle session management</strong>
and <strong>synchronization</strong> for third parties that support authentication with an <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.</p>
<p>In addition,
session management for fourth parties such as <strong>desktop</strong>, <strong>native or mobile applications</strong>
that utilize <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> credentials at <a class="reference internal" href="glossary.html#term-fourth-party-web-sites"><em class="xref std std-term">fourth party web sites</em></a> is also supported.</p>
<p>(Draft 05)</p>
<div class="section" id="creating-sessions">
<span id="session-2-1"></span><h3><a class="toc-backref" href="#id7">2.1.  Creating Sessions</a><a class="headerlink" href="#creating-sessions" title="Permalink to this headline">¶</a></h3>
<p>To create a session,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> sends an <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a>
to the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> with <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a> as one of the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> values.</p>
<p>If the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> includes the value <a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a>,
then an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID token</em></a> is returned in the response of the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>
when the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">Access Token</em></a> is retrieved.</p>
<p>If the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> includes the value <a class="reference internal" href="standard.html#term-token"><em class="xref std std-term">token</em></a>,
then an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is returned as a <a class="reference internal" href="glossary.html#term-fragment-parameter"><em class="xref std std-term">fragment parameter</em></a>
in the <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a> specified in the request.</p>
<p>In either case,
an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> will also be returned along with the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">Access Token</em></a>
when submitting a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">Refresh Token</em></a> to the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>
if the initial <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> included <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a>
in the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> parameter.</p>
<p>The <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> serves as a <strong>key</strong> to an <a class="reference internal" href="glossary.html#term-authenticated-user-session"><em class="xref std std-term">authenticated user session</em></a>
and contains <a class="reference internal" href="messages.html#term-claims"><em class="xref std std-term">Claims</em></a> for the user.</p>
<p>(Draft 05)</p>
<p id="session-2-1-1">2.1.1.  ID Token</p>
<p>This specification defines an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> as a signed JWT [<a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>]
that minimally contains the following Claims:</p>
<dl class="glossary docutils">
<dt id="term-iss">iss</dt>
<dd>REQUIRED.
The <a class="reference internal" href="messages.html#term-issuer-identifier"><em class="xref std std-term">Issuer Identifier</em></a> for the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> of the response.</dd>
<dt id="term-aud">aud</dt>
<dd>REQUIRED.
This member identifies the audience that this <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is intended for.
It MUST be the OAuth 2.0 <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> of the Client.</dd>
<dt id="term-user-id">user_id</dt>
<dd>REQUIRED.
A locally unique and never reassigned identifier
within the Issuer for the End-User that is intended to be consumed by the Client.
e.g. 24400320 or AItOawmwtWwcT0k51BayewNvutrJUqsvl6qs7A4.
It MUST NOT exceed <strong>255</strong> ASCII characters in length.</dd>
<dt id="term-8">aud</dt>
<dd>REQUIRED.
This member identifies the audience that this ID Token is intended for.
It MUST be the OAuth 2.0 client_id of the Client.</dd>
<dt id="term-exp">exp</dt>
<dd><p class="first">REQUIRED.
Type Integer.
Identifies the expiration time on or
after which the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> MUST NOT be accepted for processing.
The processing of this parameter requires that the current date/time MUST be
before the expiration date/time listed in the value.</p>
<p>Implementers MAY provide for some small leeway,
usually no more than a few minutes, to account for clock skew.</p>
<p>The value is number of seconds from 1970-01-01T0:0:0Z
as measured in UTC until the desired date/time.</p>
<p class="last">See RFC 3339 [RFC3339] for details regarding date/times in general and UTC in particular.</p>
</dd>
<dt id="term-acr">acr</dt>
<dd><p class="first">OPTIONAL.
(<a class="reference internal" href="glossary.html#term-authentication-context-class-reference"><em class="xref std std-term">Authentication Context Class Reference</em></a>):
Specifies an <a class="reference internal" href="glossary.html#term-authentication-context-class-reference"><em class="xref std std-term">Authentication Context Class Reference</em></a> of the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.
The values &#8220;1&#8221;, &#8220;2&#8221;, &#8220;3&#8221;, and &#8220;4&#8221; map to the ITU-T X.1254 | ISO/IEC 29115 [<a class="reference internal" href="#term-iso29115"><em class="xref std std-term">ISO29115</em></a>]
<a class="reference internal" href="glossary.html#term-entity-authentication-assurance-level"><em class="xref std std-term">entity authentication assurance level</em></a> of the authentication performed.</p>
<p>The value &#8220;0&#8221; indicates the End User authentication did not meet the requirements of ISO/IEC 29115 level 1.
Authentication using a long-lived browser cookie, for instance, is one example
where the use of &#8220;level 0&#8221; is appropriate.</p>
<p class="last">Authentications with level 0 should never be used to authorize access to any resource of any monetary value.
(This corresponds to the OpenID 2.0 PAPE nist_auth_level 0.)
An absolute URI or a registered short name [<a class="reference internal" href="#term-loa-registry"><em class="xref std std-term">LoA.Registry</em></a>] MAY be used as an acr value.</p>
</dd>
<dt id="term-nonce">nonce</dt>
<dd>REQUIRED.
Clients MUST verify that the nonce value is equal to the value of the nonce parameter in the Authorization Request.</dd>
</dl>
<p>The <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> MAY contain other Claims.
The <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> can be used to access session information
from an authenticated session or to pass a session to other applications.</p>
<p>(Draft 05)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ID Toke is an <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a> .</p>
</div>
<div class="section" id="authorization-request">
<span id="session-2-1-2"></span><h4><a class="toc-backref" href="#id8">2.1.2.  Authorization Request</a><a class="headerlink" href="#authorization-request" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="oauth.html#oauth-4-1-1"><em>Section 4.1.1</em></a> and <em class="xref std std-ref">4.2.1</em> of OAuth 2.0 [<a class="reference internal" href="standard.html#term-oauth2-0"><em class="xref std std-term">OAuth2.0</em></a>]
defines OAuth <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">Authorization Request</em></a> parameters.
In this specification, the values to the parameters are defined as follows.</p>
<dl class="glossary docutils">
<dt id="term-response-type">response_type</dt>
<dd>A space delimited,
<strong>case sensitive list</strong> of string values
(Pending OAuth 2.0 changes).
The value MUST include id_token for requesting an ID Token from a session.</dd>
</dl>
<p>In addition, this specification defines the following extension parameters.</p>
<dl class="glossary docutils">
<dt id="term-13">nonce</dt>
<dd>OPTIONAL. A random, unique string. The nonce value is returned in the ID Token.</dd>
<dt id="term-id-token-audience">id_token_audience</dt>
<dd>OPTIONAL. The Identifier of the target audience for an ID Token.</dd>
</dl>
<p>Following is a non-normative example when they are sent in the query parameters serialization:</p>
<div class="highlight-python"><pre>GET /authorize?scope=openid&amp;response_type=token%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
Host: server.example.com</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="token-endpoint">
<span id="session-2-1-3"></span><h4><a class="toc-backref" href="#id9">2.1.3.  Token Endpoint</a><a class="headerlink" href="#token-endpoint" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a> MUST return an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>
if <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a> is included in the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> parameter
of the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Access Token</li>
<li>Refesh Token</li>
<li>ID Token</li>
</ul>
</div>
<p>(Draft 05)</p>
<div class="section" id="access-token-response">
<span id="session-2-1-3-1"></span><h5><a class="toc-backref" href="#id10">2.1.3.1.  Access Token Response</a><a class="headerlink" href="#access-token-response" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Tile should be &#8220;Token Endpoint Response&#8221; ?</p>
</div>
<p>After receiving and verifying a valid and authorized Access Token Request from the Client,
the Authorization Server returns a successful response that includes an Access Token.
The parameters in the successful response are defined in <a class="reference internal" href="oauth.html#oauth-4-2-2"><em>Section 4.2.2</em></a> of OAuth 2.0 [OAuth2.0].</p>
<p>In addition,
this specification defines the following additional return parameters:</p>
<dl class="glossary docutils">
<dt id="term-id-token">id_token</dt>
<dd>REQUIRED if it was requested in the authorization request.</dd>
</dl>
<p>Following is a non-normative example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="s2">&quot;access_token&quot;</span><span class="o">:</span> <span class="s2">&quot;SlAV32hkKG&quot;</span><span class="p">,</span>
    <span class="s2">&quot;token_type&quot;</span><span class="o">:</span> <span class="s2">&quot;JWT&quot;</span><span class="p">,</span>
    <span class="s2">&quot;refresh_token&quot;</span><span class="o">:</span> <span class="s2">&quot;8xLOxBtZp8&quot;</span><span class="p">,</span>
    <span class="s2">&quot;expires_in&quot;</span><span class="o">:</span> <span class="mi">3600</span><span class="p">,</span>
    <span class="s2">&quot;id_token&quot;</span><span class="o">:</span><span class="s2">&quot;jwt_header.jwt_part2.jwt_part3&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>As in the OAuth 2.0 [OAuth2.0],
Clients SHOULD ignore unrecognized response parameters.</p>
<p>(Draft 05)</p>
</div>
</div>
<div class="section" id="implicit-user-agent-flow">
<span id="session-2-1-4"></span><h4><a class="toc-backref" href="#id11">2.1.4.  Implicit (User-Agent) Flow</a><a class="headerlink" href="#implicit-user-agent-flow" title="Permalink to this headline">¶</a></h4>
<p>User-Agents can use the OAuth 2.0 <a class="reference internal" href="glossary.html#term-implicit-grant-flow"><em class="xref std std-term">implicit grant flow</em></a>
by including token and <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a>
in the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> of the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> to get an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> makes an <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> to the <a class="reference internal" href="oauth_responses.html#term-authorization-endpoint"><em class="xref std std-term">Authorization Endpoint</em></a>.</li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> <strong>authenticates</strong> the <a class="reference internal" href="glossary.html#term-user"><em class="xref std std-term">user</em></a></li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> returns an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access</em></a> and <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.</li>
<li>The <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> and <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a> can
then use the <a class="reference internal" href="glossary.html#term-session-management-endpoints"><em class="xref std std-term">session management endpoints</em></a> by presenting the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> to the endpoints.</li>
</ol>
</div></blockquote>
<div class="highlight-python"><pre>                                 +----------------------------------+
+----------+                     |                                  |
|          |                     |      +----------------------+    |
|          |                     |      |    Authorization     |    |
|          |                     |      |         server       |    |
|User-Agent|                     |      +----------------------+    |
|          |                     |      |   +---------------+  |    |
|          |&gt;----(1)-------------|------|--&gt;| Authorization |  |    |
|          |&lt;----(3)-------------|------|--&lt;| Endpoint  (2) |  |    |
+----------+                     |      |   +---------------+  |    |
    ^                 +----------|------|--&gt;| Check_Session |  |    |
    |                 | +--------|------|--&lt;| Endpoint      |  |    |
    |                 | |        |      |   +---------------+  |    |
    v                 | |        |      +----------------------+    |
+----------+       (4)| |        |                                  |
|          |          | |        |                                  |
|Client    |&gt;---------+ |        |      +----------------------+    |
|Servlet   |&lt;-----------+        |      |                      |    |
|          |                     |      | UserInfo Endpoint    |    |
|          |                     |      |                      |    |
|          |&gt;--------------------|-----&gt;|                      |    |
|          |&lt;--------------------|-----&lt;|                      |    |
|          |                     |      |                      |    |
|          |                     |      |                      |    |
+----------+                     |      +----------------------+    |
                                 |                                  |
                                 |                                  |
                                 +-----------------------------------+</pre>
</div>
<div class="highlight-python"><pre>                             +-----------------------------+
                             |                             |
                             |      Authorization          |
                             |         Server              |
+-------------+              |                             |
|             |              |     +--------------------+  |
| User-Agent  |              |     |  Refresh Session   |  |
|             |    (4)       |     |    Endpoint        |  |
|             |&gt;-------------|----&gt;|                    |  |
|             |&lt;-------------|----&lt;|                    |  |
|             |              |     |                    |  |
|             |              |     +--------------------+  |
|             |    (4)       |     |  End Session       |  |
|             |&gt;-------------|----&gt;|    Endpoint        |  |
|             |&lt;-------------|----&lt;|                    |  |
|             |              |     |                    |  |
|             |              |     +--------------------+  |
+-------------+              +-----------------------------+</pre>
</div>
<p>(Draft 05)</p>
<div class="section" id="implicit-flow-request">
<span id="session-2-1-4-1"></span><h5><a class="toc-backref" href="#id12">2.1.4.1.  Implicit Flow Request</a><a class="headerlink" href="#implicit-flow-request" title="Permalink to this headline">¶</a></h5>
<p>The authorization request parameter values are constrained as follows.</p>
<dl class="glossary docutils">
<dt id="term-16">response_type</dt>
<dd>A space delimited,
case sensitive list of string values (Pending OAuth 2.0 changes).
The value MUST include token and <em class="xref std std-term">id_token `and to request an access and :term:`ID Token</em> from the session.</dd>
</dl>
<p>Following is a non-normative example of a request using query parameters serialization:</p>
<div class="highlight-python"><pre>GET /authorize?scope=openid&amp;response_type=token%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
Host: server.example.com</pre>
</div>
<p>(Draft 05)</p>
</div>
</div>
<div class="section" id="implicit-flow-response">
<span id="session-2-1-4-2"></span><h4><a class="toc-backref" href="#id13">2.1.4.2.  Implicit Flow Response</a><a class="headerlink" href="#implicit-flow-response" title="Permalink to this headline">¶</a></h4>
<p>When the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> in the request includes <a class="reference internal" href="standard.html#term-token"><em class="xref std std-term">token</em></a>,
the <a class="reference internal" href="glossary.html#term-authorization-response"><em class="xref std std-term">Authorization Response</em></a> MUST return the parameters defined
in <a class="reference internal" href="oauth.html#oauth-4-2-2"><em>section 4.2.2 of OAuth 2.0</em></a> [<a class="reference internal" href="standard.html#term-oauth2-0"><em class="xref std std-term">OAuth2.0</em></a>]
in the <a class="reference internal" href="glossary.html#term-query-fragment"><em class="xref std std-term">query fragment</em></a> of the response.</p>
<p>In addition,
when <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> includes <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a>,
an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> MUST be returned in the <a class="reference internal" href="glossary.html#term-query-fragment"><em class="xref std std-term">query fragment</em></a> of the response.</p>
<p>Following is a non-normative example of a response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb#access_token=i1WsRn1uB1&amp;token_type=JWT&amp;id_token=jwt_header.jwt_part2.jwt_part3</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="authorization-code-web-server-flow">
<span id="session-2-1-5"></span><h4><a class="toc-backref" href="#id14">2.1.5.  Authorization Code (Web Server) Flow</a><a class="headerlink" href="#authorization-code-web-server-flow" title="Permalink to this headline">¶</a></h4>
<p>Web server Clients can use the OAuth 2.0 <a class="reference internal" href="glossary.html#term-authorization-code-flow"><em class="xref std std-term">Authorization Code flow</em></a>
by including <a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a> and <a class="reference internal" href="standard.html#term-24"><em class="xref std std-term">id_token</em></a> in the <a class="reference internal" href="standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> parameter
of the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> to obtain an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.</p>
<p>The <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is returned along with the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">Access Token</em></a>
after the Client submits the Authorization Code to the Access Token Endpoint.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The User-Agent makes an authorization request to the Authorization Endpoint.</li>
<li>The Authorization Server authenticates the End-User.</li>
<li>The Authorization Server returns an Authorization Code.</li>
<li>The Client sends Authorization Code to the Token Endpoint.</li>
<li>The Authorization Server verifies the authorization token and returns an access and ID Token.</li>
<li>The User-Agent and Client servlet can then use the session management endpoints by presenting the ID Token to the endpoints.</li>
</ol>
</div></blockquote>
<div class="highlight-python"><pre>                                 +----------------------------------+
+----------+                     |                                  |
|          |                     |      +----------------------+    |
|          |                     |      |    Authorization     |    |
|          |                     |      |         server       |    |
|User-Agent|                     |      +----------------------+    |
|          |                     |      |   +---------------+  |    |
|          |&gt;-----(1)------------|------|--&gt;| Authorization |  |    |
|          |&lt;-----(3)------------|------|--&lt;| Endpoint (2)  |  |    |
+----------+                     |      |   +---------------+  |    |
    ^                 +----------|------|--&gt;| Access Token  |  |    |
    |                 | +--------|------|--&lt;| Endpoint      |  |    |
    |                 | |        |      |   +---------------+  |    |
    v                 | |        |      |   | Session       |  |    |
+----------+          | |        |      |   | Management    |  |    |
|          |          | |        |      |   | Endpoints     |  +    |
|Client    |&gt;-----(4)-+ |        |      |   +---------------+  |    |
|Servlet   |&lt;-----(5)---+        |      +----------------------+    |
|          |                     |                                  |
|          |                     |      +----------------------+    |
|          |                     |      |                      |    |
|          |                     |      | UserInfo Endpoint    |    |
|          |&gt;--------------------|-----&gt;|                      |    |
|          |&lt;--------------------|-----&lt;|                      |    |
+----------+                     |      +----------------------+    |
                                 |                                  |
                                 |                                  |
                                 +----------------------------------+</pre>
</div>
<p>(Draft 05)</p>
<div class="section" id="authorization-code-flow-request">
<span id="session-2-1-5-1"></span><h5><a class="toc-backref" href="#id15">2.1.5.1.  Authorization Code Flow Request</a><a class="headerlink" href="#authorization-code-flow-request" title="Permalink to this headline">¶</a></h5>
<p>The authorization request parameter values are constrained as follows.</p>
<dl class="glossary docutils">
<dt id="term-17">response_type</dt>
<dd>A space delimited, case sensitive list of string values (Pending OAuth 2.0 changes). The value MUST include code and id_token and to request an access and ID Token from the session.</dd>
</dl>
<p>Following is a non-normative example of a request using query parameters serialization:</p>
<div class="highlight-python"><pre>GET /authorize?scope=openid&amp;response_type=code%20id_token
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
Host: server.example.com</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="authorization-code-flow-response">
<span id="session-2-1-5-2"></span><h5><a class="toc-backref" href="#id16">2.1.5.2.  Authorization Code Flow Response</a><a class="headerlink" href="#authorization-code-flow-response" title="Permalink to this headline">¶</a></h5>
<p>When the response_type in the request includes code,
the Authorization Response MUST return the parameters defined in <a class="reference internal" href="oauth.html#oauth-4-1-1"><em>section 4.1.2 of OAuth 2.0</em></a>
[<a class="reference internal" href="standard.html#term-oauth2-0"><em class="xref std std-term">OAuth2.0</em></a>] in the query of the response.</p>
<p>In addition, when response_type includes id_token, the ID Token is retrieved from the Token Endpoint.</p>
<p>Following is a non-normative example of a response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=i1WsRn1uB1</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="token-access-request">
<span id="session-2-1-5-3"></span><h5><a class="toc-backref" href="#id17">2.1.5.3.  Token Access Request</a><a class="headerlink" href="#token-access-request" title="Permalink to this headline">¶</a></h5>
<p>The Client uses the Authorization Code to make a request to the Token Endpoint to retrieve an access and ID Token.</p>
<p>The request format is defined in <a class="reference internal" href="oauth.html#oauth-4-1-3"><em>section 4.1.3 of the OAuth 2.0</em></a> [OAuth2.0] specification.</p>
<p>Following is a non-normative example of a token access endpoint request:</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;client_id=s6BhdRkqt3&amp;
code=i1WsRn1uB1&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="token-access-response">
<span id="session-2-1-5-4"></span><h5><a class="toc-backref" href="#id18">2.1.5.4.  Token Access Response</a><a class="headerlink" href="#token-access-response" title="Permalink to this headline">¶</a></h5>
<p>The access and ID Token is returned in the response.</p>
<p>The response format is defined in <a class="reference internal" href="oauth.html#oauth-4-1-4"><em>section 4.1.4 of the OAuth 2.0</em></a> [OAuth2.0] specification.</p>
<p>Following is a non-normative example of a token access endpoint response:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store
{
  "access_token":"SlAV32hkKG",
  "token_type":"JWT",
  "expires_in":3600,
  "refresh_token":"8xLOxBtZp8",
  "id_token":"jwt_header.jwt_part2.jwt_part3"
}</pre>
</div>
<p>(Draft 05)</p>
</div>
</div>
<div class="section" id="fourth-party-native-applications">
<span id="session-2-1-6"></span><h4><a class="toc-backref" href="#id19">2.1.6.  Fourth Party Native Applications</a><a class="headerlink" href="#fourth-party-native-applications" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Serinario ?</p>
<blockquote>
<div><ul class="simple">
<li>Cient Servlet is also OpenID RP.</li>
<li>User has already signed up at the Client Servlet for user_id.</li>
<li>User has some data (Protected Resource)  which can be shared to a native application whith the User installed in his device.</li>
<li>ID Token to the natie appliation can be worked as and identity assertion between native application and web application.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>Fourth party native applications involve four parties:</p>
<blockquote>
<div><ol class="arabic simple">
<li>the <a class="reference internal" href="glossary.html#term-user"><em class="xref std std-term">user</em></a>,</li>
<li>the native (desktop) application,</li>
<li>the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>, and</li>
<li>the <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a> web application.</li>
</ol>
</div></blockquote>
<p>The <a class="reference internal" href="oauth.html#term-native-application"><em class="xref std std-term">native application</em></a> uses <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">Protected Resources</em></a> from a <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a>
but it integrates with authentication services from the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> <strong>directly</strong>.
The <a class="reference internal" href="oauth.html#term-native-application"><em class="xref std std-term">native application</em></a> directs the <a class="reference internal" href="glossary.html#term-user"><em class="xref std std-term">user</em></a> to perform authentication
at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> to obtain <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access</em></a> and <a class="reference internal" href="glossary.html#term-id-tokens"><em class="xref std std-term">ID tokens</em></a>.</p>
<p>The tokens can then be used to access <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">Protected Resources</em></a> at the web servlet Client.
The process of obtaining an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> for the <a class="reference internal" href="oauth.html#term-native-application"><em class="xref std std-term">native application</em></a> is very similar to that of
using the <a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a> authorization (web server) flow method.</p>
<p>However,
the <strong>target audience</strong> of the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is not the native application,
but that of the <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a>.
The <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> needs to indicate the target audience for the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>
by setting the <a class="reference internal" href="#term-id-token-audience"><em class="xref std std-term">id_token_audience</em></a> parameter
in the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> to that of the Identifier of the <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>?</p>
<blockquote class="last">
<div><ul class="simple">
<li>id_token.aud =  native apolpliation client_id</li>
<li>authz_request.id_token_audience = client servlet client_id</li>
</ul>
</div></blockquote>
</div>
<div class="highlight-python"><pre>                                     +-----------------------------+
+----------------+                   |                             |
|                |                   |   Authorization             |
|   Native App   |                   |      Server                 |
|                |                   |                             |
|                |                   |      +--------------------+ |
|                |&gt;------------------|-----&gt;| Authorization      | |
|                |&lt;------------------|-----&lt;|   Endpoint         | |
|                |                   |      |                    | |
|                |                   |      |                    | |
|                |                   |      +--------------------+ |
|                |                   |      | Access Token       | |
|                |&gt;------------------|-----&gt;|   Endpoint         | |
|                |&lt;------------------|-----&lt;|                    | |
|                |                   |      |                    | |
|                |                   |      +--------------------+ |
|                |&gt;------------------|-----&gt;| Session Mgmt       | |
|                |&lt;------------------|-----&lt;|   Endpoints        | |
|                |                   |      |                    | |
+----------------+                   |      |                    | |
        ^                            |      |                    | |
        |                            |      +--------------------+ |
        v                            |                             |
+----------------+                   |                             |
| Client         |                   +-----------------------------+
| Servlet        |
|                |
+----------------+</pre>
</div>
<p>When accessing <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">Protected Resources</em></a> at the <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a>,
the native application sends the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> as an <a class="reference internal" href="glossary.html#term-authorization-http-header"><em class="xref std std-term">Authorization HTTP header</em></a> in the request.
The <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a> can check the validity of the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>
by verifying the cryptographic information or
by sending the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> to the <a class="reference internal" href="messages.html#term-check-id-endpoint"><em class="xref std std-term">Check ID Endpoint</em></a> OpenID Connect Messages 1.0 [<a class="reference internal" href="standard.html#term-openid-messages"><em class="xref std std-term">OpenID.Messages</em></a>].</p>
<div class="highlight-python"><pre>GET /resource1
Auth: jwt_header.jwt_part2.jwt_part3
Host: servlet.example.com</pre>
</div>
<p>(Draft 05)</p>
<div class="section" id="browser-load">
<span id="session-2-1-6-1"></span><h5><a class="toc-backref" href="#id20">2.1.6.1.  Browser Load</a><a class="headerlink" href="#browser-load" title="Permalink to this headline">¶</a></h5>
<p>Some native applications may wish to start an authenticated browser session for the same user.
The native application starts a browser with the location of the <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a>
and passing an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> as a <a class="reference internal" href="glossary.html#term-query-parameter"><em class="xref std std-term">query parameter</em></a>.
The <a class="reference internal" href="#term-client-servlet"><em class="xref std std-term">Client servlet</em></a> immediately initiates a request to the <a class="reference internal" href="glossary.html#term-refresh-session-endpoint"><em class="xref std std-term">Refresh Session Endpoint</em></a> with the <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.
The user may need to reauthenticate at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The Client servlet then gets an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> that is session synchronized with the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.</p>
<div class="highlight-python"><pre>                                        +--------------------------+
+------------+      +-----------+       |                          |
|            |      |           |       |   Authorization Server   |
| Native App |&gt;----&gt;|User-Agent |       |                          |
|            |      |           |       |    +------------------+  |
|            |      |           |&gt;------|---&gt;| Session Refresh  |  |
|            |      |           |&lt;------|---&lt;|    Endpoint      |  |
+------------+      +-----------+       |    |                  |  |
      ^                   ^             |    +------------------+  |
      |                   |             |                          |
      v                   v             |                          |
+--------------------------------+      |                          |
|                                |      |                          |
|       Client Servlet           |      |                          |
|                                |      |                          |
+--------------------------------+      +--------------------------+</pre>
</div>
<div class="highlight-python"><pre>GET
/refesh_token?state=bar&amp;redirect_uri=https://foo.com/oauth2callback&amp;id_token=$id_token // never uses immediate mode here, to allow login
Host: www.example.com</pre>
</div>
<p>Response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://foo.com/oauth2callback?state=bar&amp;session=$new_id_token</pre>
</div>
<p>(Draft 05)</p>
</div>
</div>
</div>
<div class="section" id="session-management-endpoints">
<span id="session-2-2"></span><h3><a class="toc-backref" href="#id21">2.2.  Session Management Endpoints</a><a class="headerlink" href="#session-management-endpoints" title="Permalink to this headline">¶</a></h3>
<p>To manage a session,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> sends a request to the <a class="reference internal" href="glossary.html#term-session-management-endpoints"><em class="xref std std-term">session management endpoints</em></a> at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
The <a class="reference internal" href="glossary.html#term-session-management-endpoints"><em class="xref std std-term">session management endpoints</em></a> at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> are:</p>
<dl class="glossary docutils">
<dt id="term-refresh-session">Refresh Session</dt>
<dd>Refreshes an expired ID Token</dd>
<dt id="term-end-session">End Session</dt>
<dd>Ends a session</dd>
</dl>
<p><a class="reference internal" href="glossary.html#term-authorization-servers"><em class="xref std std-term">Authorization Servers</em></a> MUST support the use of the HTTP &#8220;GET&#8221; method as define in RFC 2616 [<a class="reference internal" href="standard.html#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>]
and MAY support the &#8220;POST&#8221; method for all <a class="reference internal" href="glossary.html#term-session-management-endpoints"><em class="xref std std-term">session management endpoints</em></a>.</p>
<p>(Draft 05)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>No client authentication ? ID Token is hard to guess and signed by Authz Server and client_id.</li>
</ul>
</div>
<div class="section" id="refresh-session">
<span id="session-2-2-1"></span><h4><a class="toc-backref" href="#id22">2.2.1.  Refresh Session</a><a class="headerlink" href="#refresh-session" title="Permalink to this headline">¶</a></h4>
<p>To refresh an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> that has expired,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> sends a request to the <a class="reference internal" href="glossary.html#term-refresh-session-endpoint"><em class="xref std std-term">Refresh Session Endpoint</em></a> with an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">With the help of user agent?</p>
</div>
<p>A new <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is returned.</p>
<p>Request Parameters:</p>
<dl class="glossary docutils">
<dt id="term-20">id_token</dt>
<dd>REQUIRED.
A previously issued <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> from an <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a>.
The <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> MAY be expired.</dd>
<dt id="term-redirect-uri">redirect_uri</dt>
<dd>REQUIRED.
An absolute URI to which the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> will redirect
the <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> to with the new <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a>.</dd>
<dt id="term-state">state</dt>
<dd>REQUIRED.
An opaque value used by the Client to maintain state between the request and callback.
If provided,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST include this value
when redirecting the <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> back to the <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a>.
Clients are strongly advised to use this variable to relate the request and response.</dd>
</dl>
<p>Response:</p>
<p>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> returns the following parameters in the <em class="xref std std-term">query</em> of
the <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a> URI specified in the request:</p>
<dl class="glossary docutils">
<dt id="term-23">id_token</dt>
<dd>REQUIRED.A new ID Token.</dd>
<dt id="term-24">state</dt>
<dd>REQUIRED. The value of the state parameter in the request.</dd>
</dl>
<p>In a typical HTTP binding,
an HTTP 302 is returned to redirect the <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> to the specified <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a>
in the request with a new <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> in the <a class="reference internal" href="glossary.html#term-query-fragment"><em class="xref std std-term">query fragment</em></a>.</p>
<p>The following is a non-normative session refresh request:</p>
<p>Request:</p>
<div class="highlight-python"><pre>GET /op/refresh_session?id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6
ImNsaWVudC5leGFtcGxlLmNvbSJ9.eyJpc3N1ZXIiOiJodHRwOlwvXC9zZXJ2ZXIuZXhhbXBs
ZS5jb20iLCJjbGllbnRfaWQiOiJjbGllbnQuZXhhbXBsZS5jb20iLCJhdWRpZW5jZSI6ImNsa
WVudC5leGFtcGxlLmNvbSIsImlkIjoidXNlcl8yMzQyMzQiLCJleHAiOjEzMDM4NTI4ODB9.a
JwagC6501Da-zK-X8Az9B-Y625aSEfxVuBpFEDjOxQ
&amp;state=bar&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fidtoken_cb
Host: server.example.com</pre>
</div>
<p>Response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 OK
Location: http://client.example.com/idtoken_cb#id_token=eyJ0eXAiOiJKV1QiLCJh
bGciOiJIUzI1NiIsImtpZCI6ImNsaWVudC5leGFtcGxlLmNvbSJ9.eyJpc3N1ZXIiOiJodHRwO
lwvXC9zZXJ2ZXIuZXhhbXBsZS5jb20iLCJjbGllbnRfaWQiOiJjbGllbnQuZXhhbXBsZS5jb20
iLCJhdWRpZW5jZSI6ImNsaWVudC5leGFtcGxlLmNvbSIsImlkIjoidXNlcl8yMzQyMzQiLCJle
HAiOjEzMDM4NTI4ODB9.aJwagC6501Da-zK-X8Az9B-Y625aSEfxVuBpFEDjOxQ&amp;state=bar&amp;
expires_in=3600</pre>
</div>
<p>(Draft 05)</p>
</div>
<div class="section" id="end-session">
<span id="session-2-2-2"></span><h4><a class="toc-backref" href="#id23">2.2.2.  End Session</a><a class="headerlink" href="#end-session" title="Permalink to this headline">¶</a></h4>
<p>To end the session,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> sends an <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> to the <em class="xref std std-term">End Session Endpoint</em>.
Upon receiving the request,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> performs the <strong>logout flow</strong> for the user
and then redirects the <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">User-Agent</em></a> to the specified <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a>.</p>
<p>Request Parameters:</p>
<dl class="glossary docutils">
<dt id="term-25">id_token</dt>
<dd>REQUIRED.
A previously issued ID Token</dd>
<dt id="term-26">state</dt>
<dd><p class="first">REQUIRED.
An opaque value used by the Client
to maintain state between the request and callback.</p>
<p class="last">If provided,
the Authorization Server MUST include this value
when redirecting the User-Agent back to the Client.
Clients are strongly advised to use this variable to relate the request and response.</p>
</dd>
<dt id="term-27">redirect_uri</dt>
<dd>REQUIRED.
An absolute URI to which the Authorization Server will redirect the User-Agent.</dd>
</dl>
<p>Response:</p>
<p>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> returns the following parameters
in the <em class="xref std std-term">query</em> of the <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a> URI specified in the request:</p>
<dl class="glossary docutils">
<dt id="term-28">state</dt>
<dd>REQUIRED. The value of the state parameter in the request.</dd>
</dl>
<p>In HTTP binding,
the response is a HTTP 302 redirect response to the <a class="reference internal" href="standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a> specified in the request.</p>
<p>The following is a non-normative session refresh request:</p>
<p>Request:</p>
<div class="highlight-python"><pre>GET /op/end_session?id_token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiIsImtpZCI6
ImNsaWVudC5leGFtcGxlLmNvbSJ9.eyJpc3N1ZXIiOiJodHRwOlwvXC9zZXJ2ZXIuZXhhbX
BsZS5jb20iLCJjbGllbnRfaWQiOiJjbGllbnQuZXhhbXBsZS5jb20iLCJhdWRpZW5jZSI6I
mNsaWVudC5leGFtcGxlLmNvbSIsImlkIjoidXNlcl8yMzQyMzQiLCJleHAiOjEzMDM4NTI4
ODB9.aJwagC6501Da-zK-X8Az9B-Y625aSEfxVuBpFEDjOxQ
&amp;state=bar
&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fendtoken_cb
Host: server.example.com
...
   Authorization Server performs logout flow
...</pre>
</div>
<p>Response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 OK
Location: http://client.example.com/endtoken_cb?state=bar</pre>
</div>
<p>(Draft 05)</p>
</div>
</div>
<div class="section" id="session-synchronization">
<span id="session-2-3"></span><h3><a class="toc-backref" href="#id24">2.3.  Session Synchronization</a><a class="headerlink" href="#session-synchronization" title="Permalink to this headline">¶</a></h3>
<p>An <a class="reference internal" href="messages.html#term-id-token"><em class="xref std std-term">ID Token</em></a> is usually bound to a user&#8217;s <a class="reference internal" href="glossary.html#term-sign-in-session"><em class="xref std std-term">sign in session</em></a>
at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>,
but in some cases,
such as offline access by a web server or native application, it may not be.
ID Tokens obtained in the following scenarios are bound to a user&#8217;s signed-in state at the Authorization Server:</p>
<blockquote>
<div><ul class="simple">
<li>Redeeming a <a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a> for an Access Token and ID Token by way of indirect communication through the browser</li>
<li>Obtaining an Access Token and ID Token in the authorization response through the browser</li>
<li>Obtaining an ID Token at the Refresh Session Endpoint by submitting a previously issued ID Token</li>
</ul>
</div></blockquote>
<p>ID Tokens obtained in the above manner are session synchronized.</p>
<p>If an ID Token is obtained by submitting a Refresh Token at the Access Token Endpoint,
then the resulting ID Token is not bound to a user&#8217;s sign in state at the Authorization Server.
The Client may be in offline mode or the user has logged out from the Authorization Server.
If a session bound ID Token is desired,
the Client should obtain a new ID Token by sending a request to the Refresh Session Endpoint.</p>
<p>(Draft 05)</p>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="session-3"></span><h2><a class="toc-backref" href="#id25">3.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This document makes no requests of IANA.</p>
</div>
<div class="section" id="security-considerations">
<span id="session-4"></span><h2><a class="toc-backref" href="#id26">4.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD</p>
</div>
<div class="section" id="normative-references">
<span id="session-5"></span><h2><a class="toc-backref" href="#id27">5. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-iso29115">ISO29115</dt>
<dd>McCallister, E., “ITU-T Recommendation X.1254 | ISO/IEC DIS 29115 &#8211; Information technology - Security techniques - Entity authentication assurance framework,” ISO/IEC 29115, November 2011.</dd>
<dt id="term-jwt">JWT</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Token,” December 2011.</dd>
<dt id="term-loa-registry">LoA.Registry</dt>
<dd>Johansson, L., “An IANA registry for SAML 2.0 Level of Assurance Context Classes,” June 2011.</dd>
<dt id="term-oauth2-0">OAuth2.0</dt>
<dd>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, “OAuth 2.0 Authorization Protocol,” September 2011.</dd>
<dt id="term-openid-messages">OpenID.Messages</dt>
<dd>Sakimura, N., Recordon, D., Bradley, J., de Medeiros, B., Jones, M., and E. Jay, “OpenID Connect Messages 1.0,” December 2011.</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt id="term-rfc2616">RFC2616</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, “Hypertext Transfer Protocol &#8211; HTTP/1.1,” RFC 2616, June 1999 (TXT, PS, PDF, HTML, XML).</dd>
<dt id="term-rfc3339">RFC3339</dt>
<dd>Klyne, G., Ed. and C. Newman, “Date and Time on the Internet: Timestamps,” RFC 3339, July 2002 (TXT, HTML, XML).</dd>
<dt id="term-rfc3548">RFC3548</dt>
<dd>Josefsson, S., “The Base16, Base32, and Base64 Data Encodings,” RFC 3548, July 2003 (TXT).</dd>
</dl>
<p>(Draft 05)</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="discovery.html">OpenID Connect Discovery 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="uma_core.html">User-Managed Access (UMA) Core Protocol</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>