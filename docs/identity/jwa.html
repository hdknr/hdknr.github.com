

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Algorithms (JWA) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Signature JSON Serialization (JWS-JS)" href="jws_js.html" />
    <link rel="prev" title="JSON Web Key (JWK)" href="jwk.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Algorithms (JWA)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-algorithms-jwa">
<span id="jwa-head"></span><h1>JSON Web Algorithms (JWA)<a class="headerlink" href="#json-web-algorithms-jwa" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id43">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id44">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions" id="id45">1.1.  Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#terminology" id="id46">2.  Terminology</a><ul>
<li><a class="reference internal" href="#terms-incorporated-from-the-jws-specification" id="id47">2.1. Terms Incorporated from the JWS Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwe-specification" id="id48">2.2. Terms Incorporated from the JWE Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwk-specification" id="id49">2.3. Terms Incorporated from the JWK Specification</a></li>
<li><a class="reference internal" href="#defined-terms" id="id50">2.4. Defined Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-digital-signatures-and-macs" id="id51">3.  Cryptographic Algorithms for Digital Signatures and MACs</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jws" id="id52">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a></li>
<li><a class="reference internal" href="#hmac-with-sha-2-functions" id="id53">3.2.  HMAC with SHA-2 Functions</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pkcs1-v1-5" id="id54">3.3.  Digital Signature with RSASSA-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#digital-signature-with-ecdsa" id="id55">3.4.  Digital Signature with ECDSA</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pss" id="id56">3.5.  Digital Signature with RSASSA-PSS</a></li>
<li><a class="reference internal" href="#using-the-algorithm-none" id="id57">3.6.  Using the Algorithm &#8220;none&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-key-management" id="id58">4.  Cryptographic Algorithms for Key Management</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jwe" id="id59">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-pkcs1-v1-5" id="id60">4.2. Key Encryption with RSAES-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-oaep" id="id61">4.3. Key Encryption with RSAES OAEP</a></li>
<li><a class="reference internal" href="#key-wrapping-with-aes-key-wrap" id="id62">4.4. Key Wrapping with AES Key Wrap</a></li>
<li><a class="reference internal" href="#direct-encryption-with-a-shared-symmetric-key" id="id63">4.5. Direct Encryption with a Shared Symmetric Key</a></li>
<li><a class="reference internal" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" id="id64">4.6. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-ecdh-key-agreement" id="id65">4.6.1. Header Parameters Used for ECDH Key Agreement</a><ul>
<li><a class="reference internal" href="#epk-ephemeral-public-key-header-parameter" id="id66">4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a></li>
<li><a class="reference internal" href="#apu-agreement-partyuinfo-header-parameter" id="id67">4.6.1.2. &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a></li>
<li><a class="reference internal" href="#apv-agreement-partyvinfo-header-parameter" id="id68">4.6.1.3. &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation-for-ecdh-key-agreement" id="id69">4.6.2. Key Derivation for ECDH Key Agreement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-aes-gcm" id="id70">4.7. Key Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-aes-gcm-key-encryption" id="id71">4.7.1. Header Parameters Used for AES GCM Key Encryption</a><ul>
<li><a class="reference internal" href="#iv-initialization-vector-header-parameter" id="id72">4.7.1.1. &#8220;iv&#8221; (Initialization Vector) Header Parameter</a></li>
<li><a class="reference internal" href="#tag-authentication-tag-header-parameter" id="id73">4.7.1.2. &#8220;tag&#8221; (Authentication Tag) Header Parameter</a></li>
<li><a class="reference internal" href="#jwa-4-7-1-3" id="id74">4.7.1.3.  &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-4-7-2" id="id75">4.7.2.  Key Derivation for ECDH Key Agreement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-pbes2" id="id76">4.8. Key Encryption with PBES2</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-pbes2-key-encryption" id="id77">4.8.1. Header Parameters Used for PBES2 Key Encryption</a><ul>
<li><a class="reference internal" href="#p2s-pbes2-salt-parameter" id="id78">4.8.1.1. &#8220;p2s&#8221; (PBES2 salt) Parameter</a></li>
<li><a class="reference internal" href="#p2c-pbes2-count-parameter" id="id79">4.8.1.2. &#8220;p2c&#8221; (PBES2 count) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id80">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
<li><a class="reference internal" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id81">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plaintext-encryption-with-aes-gcm" id="id82">4.9. Plaintext Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#jwa-4-9-1" id="id83">4.9.1.  Header Parameters Used for PBES2 Key Encryption</a><ul>
<li><a class="reference internal" href="#jwa-4-9-1-1" id="id84">4.9.1.1.  &#8220;p2s&#8221; (PBES2 salt) Parameter</a></li>
<li><a class="reference internal" href="#jwa-4-9-1-2" id="id85">4.9.1.2.  &#8220;p2c&#8221; (PBES2 count) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-algorithms" id="id86">4.10. AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" id="id87">4.10.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a></li>
<li><a class="reference internal" href="#generic-aes-cbc-hmac-sha2-algorithm" id="id88">4.10.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><ul>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-encryption" id="id89">4.10.2.1. AES_CBC_HMAC_SHA2 Encryption</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-decryption" id="id90">4.10.2.2. AES_CBC_HMAC_SHA2 Decryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aes-128-cbc-hmac-sha-256" id="id91">4.10.3. AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#aes-192-cbc-hmac-sha-384" id="id92">4.10.4.  AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#aes-256-cbc-hmac-sha-512" id="id93">4.10.5.  AES_256_CBC_HMAC_SHA_512</a></li>
<li><a class="reference internal" href="#plaintext-encryption-with-aes-cbc-hmac-sha2" id="id94">4.10.6.  Plaintext Encryption with AES_CBC_HMAC_SHA2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-4-11" id="id95">4.11.  Plaintext Encryption with AES GCM</a></li>
<li><a class="reference internal" href="#additional-encryption-algorithms-and-parameters" id="id96">4.12.  Additional Encryption Algorithms and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-content-encryption" id="id97">5. Cryptographic Algorithms for Content Encryption</a><ul>
<li><a class="reference internal" href="#enc-encryption-algorithm-header-parameter-values-for-jwe" id="id98">5.1. &#8220;enc&#8221; (Encryption Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#jwa-5-2" id="id99">5.2. AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#jwa-5-2-1" id="id100">5.2.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a><ul>
<li><a class="reference internal" href="#crv-curve-parameter" id="id101">5.2.1.1.  &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#x-x-coordinate-parameter" id="id102">5.2.1.2.  &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#y-y-coordinate-parameter" id="id103">5.2.1.3.  &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-5-2-2" id="id104">5.2.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><ul>
<li><a class="reference internal" href="#jwa-5-2-2-1" id="id105">5.2.2.1. AES_CBC_HMAC_SHA2 Encryption</a></li>
<li><a class="reference internal" href="#jwa-5-2-2-2" id="id106">5.2.2.2. AES_CBC_HMAC_SHA2 Decryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id12" id="id107">5.2.3. AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#jwa-5-2-4" id="id108">5.2.4. AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#id15" id="id109">5.2.5. AES_256_CBC_HMAC_SHA_512</a></li>
<li><a class="reference internal" href="#content-encryption-with-aes-cbc-hmac-sha2" id="id110">5.2.6. Content Encryption with AES_CBC_HMAC_SHA2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#content-encryption-with-aes-gcm" id="id111">5.3. Content Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-public-keys" id="id112">5.3.1.  JWK Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#n-modulus-parameter" id="id113">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#e-exponent-parameter" id="id114">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-private-keys" id="id115">5.3.2.  JWK Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#d-private-exponent-parameter" id="id116">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#p-first-prime-factor-parameter" id="id117">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#q-second-prime-factor-parameter" id="id118">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#dp-first-factor-crt-exponent-parameter" id="id119">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#dq-second-factor-crt-exponent-parameter" id="id120">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#qi-first-crt-coefficient-parameter" id="id121">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#oth-other-primes-info-parameter" id="id122">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#r-prime-factor" id="id123">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#d-factor-crt-exponent" id="id124">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#t-factor-crt-coefficient" id="id125">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#additional-key-algorithm-families-and-parameters" id="id126">5.4. Additional Key Algorithm Families and Parameters</a></li>
<li><a class="reference internal" href="#additional-key-types-and-parameters" id="id127">5.4.  Additional Key Types and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-keys" id="id128">6. Cryptographic Algorithms for Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-keys" id="id129">6.2. Parameters for Elliptic Curve Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-public-keys" id="id130">6.2.1. Parameters for Elliptic Curve Public Keys</a><ul>
<li><a class="reference internal" href="#jwa-6-2-1-1" id="id131">6.2.1.1. &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-2-1-2" id="id132">6.2.1.2. &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-2-1-3" id="id133">6.2.1.3. &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-private-keys" id="id134">6.2.2. Parameters for Elliptic Curve Private Keys</a><ul>
<li><a class="reference internal" href="#d-ecc-private-key-parameter" id="id135">6.2.2.1. &#8220;d&#8221; (ECC Private Key) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-keys" id="id136">6.3. Parameters for RSA Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-rsa-public-keys" id="id137">6.3.1. Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#jwa-6-3-1-1" id="id138">6.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-1-2" id="id139">6.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-private-keys" id="id140">6.3.2. Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#jwa-6-3-2-1" id="id141">6.3.2.1. &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-2" id="id142">6.3.2.2. &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-3" id="id143">6.3.2.3. &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-5" id="id144">6.3.2.5. &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-6" id="id145">6.3.2.6. &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-7" id="id146">6.3.2.7. &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#jwa-6-3-2-7-1" id="id147">6.3.2.7.1. &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-7-2" id="id148">6.3.2.7.2. &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#jwa-6-3-2-7-3" id="id149">6.3.2.7.3. &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-symmetric-keys" id="id150">6.4. Parameters for Symmetric Keys</a><ul>
<li><a class="reference internal" href="#k-key-value-parameter" id="id151">6.4.1. &#8220;k&#8221; (Key Value) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id152">7. IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-algorithms-registry" id="id153">7.1. JSON Web Signature and Encryption Algorithms Registry</a><ul>
<li><a class="reference internal" href="#registration-template" id="id154">7.1.1. Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents" id="id155">7.1.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwe-header-parameter-names-registration" id="id156">7.2. JWE Header Parameter Names Registration</a><ul>
<li><a class="reference internal" href="#registry-contents" id="id157">7.2.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-encryption-compression-algorithms-registry" id="id158">7.3. JSON Web Encryption Compression Algorithms Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-3-1" id="id159">7.3.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-3-2" id="id160">7.3.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-types-registry" id="id161">7.4. JSON Web Key Types Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-4-1" id="id162">7.4.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-4-2" id="id163">7.4.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-parameters-registration" id="id164">7.5. JSON Web Key Parameters Registration</a><ul>
<li><a class="reference internal" href="#jwa-7-5-1" id="id165">7.5.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-elliptic-curve-registry" id="id166">7.6. JSON Web Key Elliptic Curve Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-6-1" id="id167">7.6.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-6-2" id="id168">7.6.2. Initial Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id169">8. Security Considerations</a><ul>
<li><a class="reference internal" href="#algorithms-and-key-sizes-will-be-deprecated" id="id170">8.1. Algorithms and Key Sizes will be Deprecated</a></li>
<li><a class="reference internal" href="#key-lifetimes" id="id171">8.2. Key Lifetimes</a></li>
<li><a class="reference internal" href="#rsaes-pkcs1-v1-5-security-considerations" id="id172">8.3. RSAES-PKCS1-v1_5 Security Considerations</a></li>
<li><a class="reference internal" href="#aes-gcm-security-considerations" id="id173">8.4. AES GCM Security Considerations</a></li>
<li><a class="reference internal" href="#plaintext-jws-security-considerations" id="id174">8.5. Plaintext JWS Security Considerations</a></li>
<li><a class="reference internal" href="#differences-between-digital-signatures-and-macs" id="id175">8.6. Differences between Digital Signatures and MACs</a></li>
<li><a class="reference internal" href="#denial-of-service-attacks" id="id176">8.7. Denial of Service Attacks</a></li>
<li><a class="reference internal" href="#reusing-key-material-when-encrypting-keys" id="id177">8.8. Reusing Key Material when Encrypting Keys</a></li>
<li><a class="reference internal" href="#password-considerations" id="id178">8.9. Password Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#internationalization-considerations" id="id179">9. Internationalization Considerations</a><ul>
<li><a class="reference internal" href="#normative-references" id="id180">9.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id181">9.2.  Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id182">10. References</a><ul>
<li><a class="reference internal" href="#jwa-10-1" id="id183">10.1. Normative References</a></li>
<li><a class="reference internal" href="#jwa-10-2" id="id184">10.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-algorithm-identifier-cross-reference" id="id185">Appendix A. Algorithm Identifier Cross-Reference</a><ul>
<li><a class="reference internal" href="#a-1-digital-signature-mac-algorithm-identifier-cross-reference" id="id186">A.1. Digital Signature/MAC Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-2-key-management-algorithm-identifier-cross-reference" id="id187">A.2. Key Management Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-3-content-encryption-algorithm-identifier-cross-reference" id="id188">A.3. Content Encryption Algorithm Identifier Cross-Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms" id="id189">Appendix B. Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#b-1-test-cases-for-aes-128-cbc-hmac-sha-256" id="id190">B.1. Test Cases for AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#b-2-test-cases-for-aes-192-cbc-hmac-sha-384" id="id191">B.2. Test Cases for AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#b-3-test-cases-for-aes-256-cbc-hmac-sha-512" id="id192">B.3. Test Cases for AES_256_CBC_HMAC_SHA_512</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-c-example-ecdh-es-key-agreement-computation" id="id193">Appendix C. Example ECDH-ES Key Agreement Computation</a></li>
<li><a class="reference internal" href="#id40" id="id194">用語</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Draft 20 : <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>電子署名(alg)  <a class="reference internal" href="#jwa-3"><em>Section.3</em></a></li>
<li>暗号化キーの取り扱い(暗号化とか,alg)  <a class="reference internal" href="#jwa-4"><em>Section.4</em></a></li>
<li>コンテンツ暗号化(enc) <a class="reference internal" href="#jwa-5"><em>Section.5</em></a></li>
<li>キー(kty ...) <a class="reference internal" href="#jwa-6"><em>Section.6</em></a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwa-abstract"></span><h2><a class="toc-backref" href="#id43">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification registers cryptographic
algorithms and identifiers to be used
with the JSON Web Signature (<a class="reference internal" href="jws.html"><em>JWS</em></a>),
JSON Web Encryption (<a class="reference internal" href="jwe.html"><em>JWE</em></a>),
and JSON Web Key (<a class="reference internal" href="jwk.html"><em>JWK</em></a>) specifications.
It defines several IANA registries for these identifiers.</p>
<p>( draft20 )</p>
</div>
<div class="section" id="introduction">
<span id="jwa-1"></span><h2><a class="toc-backref" href="#id44">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification
enumerates cryptographic algorithms and identifiers
to be used with
the JSON Web Signature (JWS) [JWS],
JSON Web Encryption (JWE) [JWE],
and JSON Web Key (JWK) [JWK] specifications.
All these specifications utilize
JavaScript Object Notation (JSON) [RFC4627] based data structures.
This specification also describes the semantics and operations
that are specific to these algorithms and algorithm families.</p>
<p>Enumerating the algorithms and identifiers for them in this specification,
rather than in the JWS, JWE, and JWK specifications,
is intended to allow them to remain unchanged in the face of changes
in the set of required, recommended, optional, and deprecated algorithms over time.</p>
<p>(draft 04 : <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1</a> )</p>
<div class="section" id="notational-conventions">
<span id="jwa-1-1"></span><h3><a class="toc-backref" href="#id45">1.1.  Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in Key words for use in
RFCs to Indicate Requirement Levels [RFC2119].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1</a> )</p>
</div>
</div>
<div class="section" id="terminology">
<span id="jwa-2"></span><h2><a class="toc-backref" href="#id46">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>These terms defined by the JSON Web Signature (JWS) [JWS] specification
are incorporated into this specification:
&#8220;JSON Web Signature (JWS)&#8221;,
&#8220;JWS Header&#8221;,
&#8220;JWS Payload&#8221;,
&#8220;JWS Signature&#8221;,
&#8220;JWS Protected Header&#8221;,
&#8220;Base64url Encoding&#8221;, and
&#8220;JWS Signing Input&#8221;.</p>
<p>These terms defined by the JSON Web Encryption (JWE) [JWE]
specification are incorporated into this specification:
&#8220;JSON Web Encryption (JWE)&#8221;,
&#8220;Authenticated Encryption&#8221;,
&#8220;Plaintext&#8221;,
&#8220;Ciphertext&#8221;,
&#8220;Additional Authenticated Data (AAD)&#8221;,
&#8220;Authentication Tag&#8221;,
&#8220;Content Encryption Key (CEK)&#8221;,
&#8220;JWE Header&#8221;, &#8220;JWE Encrypted Key&#8221;,
&#8220;JWE Initialization Vector&#8221;,
&#8220;JWE Ciphertext&#8221;,
&#8220;JWE Authentication Tag&#8221;,
&#8220;JWE Protected Header&#8221;,
&#8220;Key Management Mode&#8221;,
&#8220;Key Encryption&#8221;,
&#8220;Key Wrapping&#8221;,
&#8220;Direct Key Agreement&#8221;,
&#8220;Key Agreement with Key Wrapping&#8221;, and
&#8220;Direct Encryption&#8221;.</p>
<p>These terms defined by the JSON Web Key (JWK) [JWK] specification are
incorporated into this specification:
&#8220;JSON Web Key (JWK)&#8221; and
&#8220;JSON Web Key Set (JWK Set)&#8221;.</p>
<p>These terms are defined for use by this specification:</p>
<dl class="glossary docutils">
<dt id="term-header-parameter">Header Parameter</dt>
<dd>A name/value pair that is member of a JWS Header or JWE Header.</dd>
</dl>
<p>(draft 20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-2</a>)</p>
<div class="section" id="terms-incorporated-from-the-jws-specification">
<span id="jwa-2-1"></span><h3><a class="toc-backref" href="#id47">2.1. Terms Incorporated from the JWS Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jws-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Signature (JWS) <a class="reference internal" href="#term-102"><em class="xref std std-term">[JWS]</em></a>
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jws"><span id="term-json-web-signature"></span><span id="term-json-web-signature-jws"></span>JWS<br />JSON Web Signature<br />JSON Web Signature (JWS)</dt>
<dd>A data structure cryptographically securing
a JWS Header and a JWS Payload with a JWS Signature value.</dd>
<dt id="term-jws-header">JWS Header</dt>
<dd>A string representing a JavaScript Object Notation (JSON)
<a class="reference internal" href="oauth_meta.html#term-rfc4627"><em class="xref std std-term">[RFC4627]</em></a> object that describes the <em class="xref std std-term">digital signature</em>
or <a class="reference internal" href="#term-mac"><em class="xref std std-term">MAC</em></a> operation applied to create the JWS Signature value.</dd>
<dt id="term-jws-payload">JWS Payload</dt>
<dd>The bytes to be secured &#8211; a.k.a., the message.  The
payload can contain an arbitrary sequence of bytes.</dd>
<dt id="term-jws-signature">JWS Signature</dt>
<dd>A byte array containing the cryptographic material
that secures the contents of the JWS Header and the JWS Payload.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>The URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5, with the (non URL-
safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of <a class="reference internal" href="#term-102"><em class="xref std std-term">[JWS]</em></a> for notes on implementing base64url
encoding without padding.)</dd>
<dt id="term-encoded-jws-header">Encoded JWS Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
<a class="reference internal" href="#term-110"><em class="xref std std-term">[RFC3629]</em></a> representation of the JWS Header.</dd>
<dt id="term-encoded-jws-payload">Encoded JWS Payload</dt>
<dd>Base64url encoding of the JWS Payload.</dd>
<dt id="term-encoded-jws-signature">Encoded JWS Signature</dt>
<dd>Base64url encoding of the JWS Signature.</dd>
<dt id="term-jws-secured-input">JWS Secured Input</dt>
<dd>The concatenation of the Encoded JWS Header, a
period (&#8216;.&#8217;) character, and the Encoded JWS Payload.</dd>
<dt id="term-collision-resistant-namespace">Collision Resistant Namespace</dt>
<dd><p class="first">A namespace that allows names to be
allocated in a manner such that they are highly unlikely to
collide with other names.  For instance, collision resistance can
be achieved through administrative delegation of portions of the
namespace or through use of collision-resistant name allocation
functions.</p>
<p>Examples of Collision Resistant Namespaces include:
Domain Names, Object Identifiers (OIDs) as defined in the ITU-T
<em class="xref std std-term">X.660</em> and <em class="xref std std-term">X.670</em> Recommendation series, and Universally Unique
IDentifiers (UUIDs) <a class="reference internal" href="#term-rfc4122"><em class="xref std std-term">[RFC4122]</em></a>.</p>
<p class="last">When using an administratively
delegated namespace, the definer of a name needs to take
reasonable precautions to ensure they are in control of the
portion of the namespace they use to define the name.</p>
</dd>
</dl>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwe-specification">
<span id="jwa-2-2"></span><h3><a class="toc-backref" href="#id48">2.2. Terms Incorporated from the JWE Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwe-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Encryption (JWE) [JWE]
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwe"><span id="term-json-web-encryption"></span><span id="term-json-web-encryption-jwe"></span>JWE<br />JSON Web Encryption<br />JSON Web Encryption (JWE)</dt>
<dd>A data structure representing an encrypted
version of a Plaintext.  The structure consists of four parts: the
JWE Header, the JWE Encrypted Key, the JWE Ciphertext, and the JWE
Integrity Value.</dd>
<dt id="term-plaintext">Plaintext</dt>
<dd>The bytes to be encrypted &#8211; a.k.a., the message.  The
plaintext can contain an arbitrary sequence of bytes.</dd>
<dt id="term-ciphertext">Ciphertext</dt>
<dd>The encrypted version of the Plaintext.</dd>
<dt id="term-cek"><span id="term-content-encryption-key"></span><span id="term-content-encryption-key-cek"></span>CEK<br />Content Encryption Key<br />Content Encryption Key (CEK)</dt>
<dd>A symmetric key used to encrypt the
Plaintext for the recipient to produce the Ciphertext.</dd>
<dt id="term-cik"><span id="term-content-integrity-key"></span><span id="term-content-integrity-key-cik"></span>CIK<br />Content Integrity Key<br />Content Integrity Key (CIK)</dt>
<dd>A key used with a MAC function to ensure
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-cmk"><span id="term-content-master-key"></span><span id="term-content-master-key-cmk"></span>CMK<br />Content Master Key<br />Content Master Key (CMK)</dt>
<dd>A key from which the CEK and CIK are
derived.  When key wrapping or key encryption are employed, the
CMK is randomly generated and encrypted to the recipient as the
JWE Encrypted Key. When key agreement is employed, the CMK is the
result of the key agreement algorithm.</dd>
<dt id="term-jwe-header">JWE Header</dt>
<dd>A string representing a JSON object that describes the
encryption operations applied to create the JWE Encrypted Key, the
JWE Ciphertext, and the JWE Integrity Value.</dd>
<dt id="term-jwe-encrypted-key">JWE Encrypted Key</dt>
<dd>When key wrapping or key encryption are employed,
the Content Master Key (CMK) is encrypted with the intended
recipient&#8217;s key and the resulting encrypted content is recorded as
a byte array, which is referred to as the JWE Encrypted Key.
Otherwise, when key agreement is employed, the JWE Encrypted Key
is the empty byte array.</dd>
<dt id="term-jwe-ciphertext">JWE Ciphertext</dt>
<dd>A byte array containing the Ciphertext.</dd>
<dt id="term-jwe-integrity-value">JWE Integrity Value</dt>
<dd>A byte array containing a MAC value that ensures
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-encoded-jwe-header">Encoded JWE Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
[RFC3629] representation of the JWE Header.</dd>
<dt id="term-encoded-jwe-encrypted-key">Encoded JWE Encrypted Key</dt>
<dd>Base64url encoding of the JWE Encrypted
Key.</dd>
<dt id="term-encoded-jwe-ciphertext">Encoded JWE Ciphertext</dt>
<dd>Base64url encoding of the JWE Ciphertext.</dd>
<dt id="term-encoded-jwe-integrity-value">Encoded JWE Integrity Value</dt>
<dd>Base64url encoding of the JWE Integrity
Value.</dd>
<dt id="term-aead-algorithm">AEAD Algorithm</dt>
<dd>An Authenticated Encryption with Associated Data
(AEAD) [RFC5116] encryption algorithm is one that provides an
integrated content integrity check.  AES Galois/Counter Mode (GCM)
is one such algorithm.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwk-specification">
<span id="jwa-2-3"></span><h3><a class="toc-backref" href="#id49">2.3. Terms Incorporated from the JWK Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwk-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Key (JWK) [JWK] specification are
incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwk"><span id="term-json-web-key"></span><span id="term-json-web-key-jwk"></span>JWK<br />JSON Web Key<br />JSON Web Key (JWK)</dt>
<dd>A JSON data structure that represents a public
key.</dd>
<dt id="term-jwk-set"><span id="term-json-web-key-set-jwk-set"></span>JWK Set<br />JSON Web Key Set (JWK Set)</dt>
<dd>A JSON object that contains an array of
JWKs as a member.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3</a> )</p>
</div>
<div class="section" id="defined-terms">
<span id="jwa-2-4"></span><h3><a class="toc-backref" href="#id50">2.4. Defined Terms</a><a class="headerlink" href="#defined-terms" title="Permalink to this headline">¶</a></h3>
<p>These terms are defined for use by this specification:</p>
<dl class="glossary docutils">
<dt id="term-header-parameter-name">Header Parameter Name</dt>
<dd>The name of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
<dt id="term-header-parameter-value">Header Parameter Value</dt>
<dd>The value of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-digital-signatures-and-macs">
<span id="jwa-3"></span><h2><a class="toc-backref" href="#id51">3.  Cryptographic Algorithms for Digital Signatures and MACs</a><a class="headerlink" href="#cryptographic-algorithms-for-digital-signatures-and-macs" title="Permalink to this headline">¶</a></h2>
<p>JWS uses cryptographic algorithms to digitally sign
or create a Message Authentication Codes (MAC)
of the contents of the JWS Header and the JWS Payload.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3</a>)</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jws">
<span id="jwa-3-1"></span><h3><a class="toc-backref" href="#id52">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jws" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values defined by this specification for use with JWS,
each of which is explained in more detail in the following sections:</p>
<blockquote>
<div></div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PSnnn シリーズ増えてる</li>
</ul>
</div>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates
that the requirement strength is likely to be increased
in a future version of the specification.</p>
<p>See <a class="reference internal" href="#jwa-appendix-a-1"><em>Appendix A.1</em></a>
for a table cross-referencing the JWS digital signature
and MAC &#8220;alg&#8221; (algorithm) values defined in this specification
with the equivalent identifiers
used by other standards and software packages.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.1</a>)</p>
</div>
<div class="section" id="hmac-with-sha-2-functions">
<span id="jwa-3-2"></span><h3><a class="toc-backref" href="#id53">3.2.  HMAC with SHA-2 Functions</a><a class="headerlink" href="#hmac-with-sha-2-functions" title="Permalink to this headline">¶</a></h3>
<p>Hash-based Message Authentication Codes (HMACs) enable one
to use a <strong>secret</strong> plus a <strong>cryptographic hash function</strong>
to generate a Message Authentication Code (MAC).</p>
<p>This can be used to demonstrate that
whoever generated the MAC was in possession of the MAC key.
The algorithm for implementing and validating HMACs is
provided in <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2104.html"><strong>RFC 2104</strong></a> <a class="reference internal" href="#term-106"><em class="xref std std-term">[RFC2104]</em></a>.</p>
<p>A key of the same size as the hash output
(for instance, 256 bits for &#8220;HS256&#8221;)
or larger MUST be used with this algorithm.</p>
<p>The HMAC SHA-256 MAC is generated per RFC 2104,
using SHA-256 as the hash algorithm &#8220;<strong>H</strong>&#8221;,
using the <a class="reference internal" href="jws.html#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> as the &#8220;<strong>text</strong>&#8221; value,
and using the <a class="reference internal" href="glossary.html#term-shared-key"><em class="xref std std-term">shared key</em></a>.
The HMAC output value is the JWS Signature.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is an HMAC value computed
using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>MAC Algorithm</td>
</tr>
<tr class="row-even"><td>HS256
HS384
HS512</td>
<td>HMAC using SHA-256
HMAC using SHA-384
HMAC using SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The HMAC SHA-256 MAC for a JWS is validated
by computing an HMAC value per RFC 2104,
using SHA-256 as the hash algorithm &#8220;H&#8221;,
using the received JWS Signing Input as the &#8220;text&#8221; value,
and using the shared key.</p>
<p>This computed HMAC value is then compared
to the result of <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> decoding
the received encoded JWS Signature value.</p>
<p>Alternatively,
the computed HMAC value can be base64url encoded and
compared to the received encoded JWS Signature value,
as this comparison produces the same result
as comparing the unencoded values.</p>
<p>In either case,
if the values match,
the HMAC has been validated.</p>
<p>Securing content and validation with the HMAC SHA-384
and HMAC SHA-512 algorithms is performed
identically to the procedure for HMAC SHA-256 &#8211;
just using the corresponding hash algorithms
with correspondingly larger minimum key sizes
and result values:
384 bits each for HMAC SHA-384
and 512 bits each for HMAC SHA-512.</p>
<p>An example using this algorithm is shown
in <a class="reference internal" href="jws.html#jws-appendix-a-1"><em>Appendix A.1</em></a> of <a class="reference internal" href="#term-102"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.2</a>)</p>
</div>
<div class="section" id="digital-signature-with-rsassa-pkcs1-v1-5">
<span id="jwa-3-3"></span><h3><a class="toc-backref" href="#id54">3.3.  Digital Signature with RSASSA-PKCS1-V1_5</a><a class="headerlink" href="#digital-signature-with-rsassa-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the RSASSA-PKCS1-V1_5
digital signature algorithm
as defined in Section 8.2 of <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> <a class="reference internal" href="#term-130"><em class="xref std std-term">[RFC3447]</em></a>
(commonly known as PKCS #1),
using SHA-2 [SHS] hash functions.</p>
<p>A key of size 2048 bits or larger MUST be used
with these algorithms.</p>
<p>The RSASSA-PKCS1-V1_5 SHA-256 digital signature is generated
as follows:
Generate a digital signature of the JWS Signing Input
using RSASSA-PKCS1-V1_5-SIGN
and the SHA-256 hash function
with the desired private key.
This is the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a> value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is a digital signature value computed
using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td>RS256
RS384
RS512</td>
<td>RSASSA-PKCS-v1_5 using SHA-256
RSASSA-PKCS-v1_5 using SHA-384
RSASSA-PKCS-v1_5 using SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The RSASSA-PKCS1-V1_5 SHA-256 digital signature for a JWS
is validated as follows:
Submit the JWS Signing Input,
the JWS Signature,
and the public key corresponding to the private key
used by the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm
using SHA-256 as the hash function.</p>
<p>Signing and validation with the RSASSA-PKCS1-V1_5 SHA-384
and RSASSA- PKCS1-V1_5 SHA-512 algorithms
is performed identically to the procedure
for RSASSA-PKCS1-V1_5 SHA-256 &#8211; just using the
corresponding hash algorithms instead of SHA-256.</p>
<p>An example using this algorithm is shown
in <a class="reference internal" href="jws.html#jws-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="#term-102"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.3</a>)</p>
</div>
<div class="section" id="digital-signature-with-ecdsa">
<span id="jwa-3-4"></span><h3><a class="toc-backref" href="#id55">3.4.  Digital Signature with ECDSA</a><a class="headerlink" href="#digital-signature-with-ecdsa" title="Permalink to this headline">¶</a></h3>
<p>The Elliptic Curve Digital Signature Algorithm (ECDSA) [DSS]
provides for the use of Elliptic Curve cryptography,
which is able to provide equivalent security
to RSA cryptography
but using shorter key sizes and with greater processing speed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>ECDSAの方がRSAと同等の強度の場合、キーが短くて速い</li>
</ul>
</div>
<p>This means that ECDSA digital signatures
will be substantially smaller
in terms of length than equivalently strong RSA digital signatures.</p>
<p>This specification defines
the use of ECDSA with the P-256 curve and
the SHA-256 cryptographic hash function,
ECDSA with the P-384 curve and the SHA-384 hash function,
and ECDSA with the P-521 curve and the SHA-512 hash function.</p>
<p>The P-256, P-384, and P-521 curves are defined in <a class="reference internal" href="#term-97"><em class="xref std std-term">[DSS]</em></a>.</p>
<p>The ECDSA P-256 SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Generate a digital signature of the JWS Signing Input
using ECDSA P-256 SHA-256 with the desired private key.</p>
<p>The output will be the pair (R, S),
where R and S are 256 bit unsigned integers.</p>
</li>
<li><p class="first">Turn R and S into octet sequences in <em class="xref std std-term">big endian order</em>,
with each array being be 32 octets long.</p>
<p>The octet sequence representations MUST NOT be shortened
to omit any leading zero octets contained in the values.</p>
</li>
<li><p class="first">Concatenate the two octet sequences in the order R and then S.
(Note that many ECDSA implementations will directly produce this
concatenation as their output.)</p>
</li>
<li><p class="first">The resulting 64 octet sequence is the JWS Signature value.</p>
</li>
</ol>
</div></blockquote>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that the JWS Signature is a digital signature value
computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td>ES256
ES384
ES512</td>
<td>ECDSA using P-256 and SHA-256
ECDSA using P-384 and SHA-384
ECDSA using P-521 and SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The ECDSA P-256 SHA-256 digital signature for a JWS is validated as
follows:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The JWS Signature value MUST be a 64 octet sequence.</p>
<p>If it is not a 64 octet sequence, the validation has failed.</p>
</li>
<li><p class="first">Split the 64 octet sequence into two 32 octet sequences.</p>
<p>The first array will be R and the second S
(with both being in big endian octet order).</p>
</li>
<li><p class="first">Submit the JWS Signing Input R, S and the public key (x, y) to
the ECDSA P-256 SHA-256 validator.</p>
</li>
</ol>
</div></blockquote>
<p>Signing and validation with the ECDSA P-384 SHA-384
and ECDSA P-521 SHA-512 algorithms is performed
identically to the procedure for ECDSA P-256 SHA-256 &#8211;
just using the corresponding hash algorithms
with correspondingly larger result values.</p>
<p>For ECDSA P-384 SHA-384,
R and S will be 384 bits each, resulting in a 96 octet sequence.</p>
<p>For ECDSA P-521 SHA-512,
R and S will be 521 bits each, resulting in a 132 octet sequence.</p>
<p>Examples using these algorithms are shown in Appendices A.3 and A.4
of [JWS].</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.4</a>)</p>
</div>
<div class="section" id="digital-signature-with-rsassa-pss">
<span id="jwa-3-5"></span><h3><a class="toc-backref" href="#id56">3.5.  Digital Signature with RSASSA-PSS</a><a class="headerlink" href="#digital-signature-with-rsassa-pss" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the RSASSA-PSS
digital signature algorithm
as defined in Section 8.1 of <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> <a class="reference internal" href="#term-130"><em class="xref std std-term">[RFC3447]</em></a>
with the <em class="xref std std-term">MGF1 mask generation function</em>
and SHA-2 hash functions,
always using the same hash function
for both the RSASSA-PSS hash function and the
<em class="xref std std-term">MGF1 hash function</em>.</p>
<p>The size of the salt value is the same size
as the hash function output.
All other algorithm parameters use
the defaults specified in Section A.2.3 of RFC 3447.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>The RSASSA-PSS SHA-256 digital signature is generated as follows:
Generate a digital signature of the JWS Signing Input
using RSASSA- PSS-SIGN,
the SHA-256 hash function,
and the <em class="xref std std-term">MGF1 mask generation function</em>
with SHA-256 with the desired private key.
This is the JWS signature value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is a digital signature value
computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td><p class="first">PS256</p>
<p>PS384</p>
<p class="last">PS512</p>
</td>
<td>RSASSA-PSS using SHA-256 and MGF1 with
SHA-256
RSASSA-PSS using SHA-384 and MGF1 with
SHA-384
RSASSA-PSS using SHA-512 and MGF1 with
SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The RSASSA-PSS SHA-256 digital signature for a JWS
is validated as follows:
Submit the JWS Signing Input,
the JWS Signature,
and the public key corresponding to the private key
used by the signer to the RSASSA-PSS-VERIFY algorithm
using SHA-256 as the hash function and
using MGF1 as the mask generation function with SHA-256.</p>
<p>Signing and validation with the RSASSA-PSS SHA-384
and RSASSA-PSS SHA-512 algorithms is performed identically
to the procedure for RSASSA-PSS SHA-256 &#8211;
just using the alternative hash algorithm in both roles.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.5</a>)</p>
</div>
<div class="section" id="using-the-algorithm-none">
<span id="jwa-3-6"></span><h3><a class="toc-backref" href="#id57">3.6.  Using the Algorithm &#8220;none&#8221;</a><a class="headerlink" href="#using-the-algorithm-none" title="Permalink to this headline">¶</a></h3>
<p>JWSs MAY also be created that do not provide integrity protection.</p>
<p>Such a JWS is called a &#8220;Plaintext JWS&#8221;.</p>
<p>A Plaintext JWS MUST use the &#8220;alg&#8221; value &#8220;none&#8221;,
and is formatted identically to other JWSs,
but MUST use the empty octet sequence as its JWS Signature value.</p>
<p>Receivers MUST verify that the JWS Signature value is
the empty octet sequence.</p>
<p>See Section 8.5 for security considerations associated with
using this algorithm.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.6</a>)</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-key-management">
<span id="jwa-4"></span><h2><a class="toc-backref" href="#id58">4.  Cryptographic Algorithms for Key Management</a><a class="headerlink" href="#cryptographic-algorithms-for-key-management" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms to encrypt or determine
the Content Encryption Key (CEK).</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4</a>)</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jwe">
<span id="jwa-jwe-alg"></span><span id="jwa-4-1"></span><h3><a class="toc-backref" href="#id59">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>キー(CMK)の暗号手順</li>
</ul>
</div>
<p>The table below is the set of &#8220;alg&#8221; (algorithm)
Header Parameter values that are defined
by this specification for use with JWE.</p>
<p>These algorithms are used to encrypt the CEK,
producing the JWE Encrypted Key,
or to use key agreement to agree upon the CEK.</p>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="27%" />
<col width="19%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>RSA1_5</td>
<td><a href="#id195"><span class="problematic" id="id196">RSAES-PKCS1-V1_</span></a>
5[RFC3447]</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>RSA-OAEP</td>
<td>RSAES using
OAEP with
default
parameters</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A128KW</td>
<td>AES Key Wrap
with default
initial value
using 128 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>A192KW</td>
<td>AES Key Wrap
with default
initial value
using 192 bit
key</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256KW</td>
<td>AES Key Wrap
with default
initial value
using 256 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>dir</td>
<td>Direct use of a
shared
symmetric key
as CEK</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>ECDH-ES</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static key
agreement using
Concat KDF</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended+</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A128KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A128KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A192KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A192KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A256KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A256KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A128GCMKW</td>
<td>Key wrapping
with AES GCM
using 128 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A192GCMKW</td>
<td>Key wrapping
with AES GCM
using 192 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256GCMKW</td>
<td>Key wrapping
with AES GCM
using 256 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>PBES2-HS256+A128K
W</td>
<td>PBES2 with HMAC
SHA-256 and
&#8220;A128KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>PBES2-HS384+A192K
W</td>
<td>PBES2 with HMAC
SHA-384 and
&#8220;A192KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>PBES2-HS512+A256K
W</td>
<td>PBES2 with HMAC
SHA-512 and
&#8220;A256KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The <em class="xref std std-term">Additional Header Parameters</em> column indicates</p>
</div></blockquote>
<p>what additional Header Parameters are used by the algorithm,
beyond &#8220;alg&#8221;, which all use.
All but &#8220;dir&#8221; and &#8220;ECDH-ES&#8221; also produce a JWE Encrypted Key value.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>See <a class="reference internal" href="jwk.html#jwk-appendix-a-2"><em>Appendix A.2</em></a>
for a table cross-referencing the JWE &#8220;alg&#8221; (algorithm) values
defined in this specification
with the equivalent identifiers used by other standards
and software packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 16 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.1</a></li>
<li>RSA1_5    : <span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>RSA-OAEP  : <span class="target" id="index-4"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>A128KW    : <span class="target" id="index-5"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3394.html"><strong>RFC 3394</strong></a> / AES Key Wrap Algorithm (128 bit)</li>
<li>A256KW</li>
<li>dir       : 共有キーを直接つかう(ラップしない)</li>
<li>ECDH-ES   : <span class="target" id="index-6"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6090.html"><strong>RFC 6090</strong></a> , <a class="reference external" href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618">http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618</a></li>
<li>ECDH-ES+A128KW    : CMKをキーラップさせる</li>
<li>ECDH-ES+A256KW    :</li>
</ul>
</div>
<p>(draft20)</p>
<p>(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.1</a>)</p>
</div>
<div class="section" id="key-encryption-with-rsaes-pkcs1-v1-5">
<span id="jwa-4-2"></span><h3><a class="toc-backref" href="#id60">4.2. Key Encryption with RSAES-PKCS1-V1_5</a><a class="headerlink" href="#key-encryption-with-rsaes-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CEK
with RSAES-PKCS1-V1_5 [RFC3447].</p>
<p>The &#8220;alg&#8221; Header Parameter value &#8220;RSA1_5&#8221; is used for this algorithm.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.2 of [JWE].</p>
<p>(draft20)</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.2</a>)</p>
</div>
<div class="section" id="key-encryption-with-rsaes-oaep">
<span id="jwa-4-3"></span><h3><a class="toc-backref" href="#id61">4.3. Key Encryption with RSAES OAEP</a><a class="headerlink" href="#key-encryption-with-rsaes-oaep" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CEK with RSAES
using Optimal Asymmetric Encryption Padding (OAEP) [RFC3447], with
the default parameters specified by RFC 3447 in Section A.2.1.
(Those default parameters are using a hash function of SHA-1 and a
mask generation function of MGF1 with SHA-1.)  The &#8220;alg&#8221; Header
Parameter value &#8220;RSA-OAEP&#8221; is used for this algorithm.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.3</a>)</p>
</div>
<div class="section" id="key-wrapping-with-aes-key-wrap">
<span id="jwa-4-4"></span><h3><a class="toc-backref" href="#id62">4.4. Key Wrapping with AES Key Wrap</a><a class="headerlink" href="#key-wrapping-with-aes-key-wrap" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CEK with the
Advanced Encryption Standard (AES) Key Wrap Algorithm [RFC3394] using
the default initial value specified in Section 2.2.3.1.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the corresponding algorithm and key size:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>A128KW</td>
<td>AES Key Wrap with default initial value using
128 bit key</td>
</tr>
<tr class="row-odd"><td>A192KW</td>
<td>AES Key Wrap with default initial value using
192 bit key</td>
</tr>
<tr class="row-even"><td>A256KW</td>
<td>AES Key Wrap with default initial value using
256 bit key</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>An example using this algorithm is shown in Appendix A.3 of [JWE].</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.4</a>)</p>
</div>
<div class="section" id="direct-encryption-with-a-shared-symmetric-key">
<span id="jwa-4-5"></span><h3><a class="toc-backref" href="#id63">4.5. Direct Encryption with a Shared Symmetric Key</a><a class="headerlink" href="#direct-encryption-with-a-shared-symmetric-key" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of directly performing symmetric
key encryption without performing a key wrapping step.  In this case,
the shared symmetric key is used directly as the Content Encryption
Key (CEK) value for the &#8220;enc&#8221; algorithm.  An empty octet sequence is
used as the JWE Encrypted Key value.  The &#8220;alg&#8221; Header Parameter
value &#8220;dir&#8221; is used in this case.</p>
<p>Refer to the security considerations on key lifetimes in Section 8.2
and AES GCM in Section 8.4 when considering utilizing direct
encryption.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.5</a>)</p>
</div>
<div class="section" id="key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es">
<span id="jwa-4-6"></span><h3><a class="toc-backref" href="#id64">4.6. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><a class="headerlink" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of key agreement with Elliptic
Curve Diffie-Hellman Ephemeral Static [RFC6090], in combination with
the Concat KDF, as defined in Section 5.8.1 of [NIST.800-56A].  The
key agreement result can be used in one of two ways:</p>
<blockquote>
<div><ol class="arabic simple">
<li>directly as the Content Encryption Key (CEK) for the &#8220;enc&#8221;
algorithm, in the Direct Key Agreement mode, or</li>
<li>as a symmetric key used to wrap the CEK with the &#8220;A128KW&#8221;,
&#8220;A192KW&#8221;, or &#8220;A256KW&#8221; algorithms, in the Key Agreement with Key
Wrapping mode.</li>
</ol>
</div></blockquote>
<p>A new ephemeral public key value MUST be generated for each key
agreement operation.</p>
<p>In Direct Key Agreement mode, the output of the Concat KDF MUST be a
key of the same length as that used by the &#8220;enc&#8221; algorithm.  In this
case, the empty octet sequence is used as the JWE Encrypted Key
value.  The &#8220;alg&#8221; Header Parameter value &#8220;ECDH-ES&#8221; is used in the
Direct Key Agreement mode.</p>
<p>In Key Agreement with Key Wrapping mode, the output of the Concat KDF
MUST be a key of the length needed for the specified key wrapping
algorithm.  In this case, the JWE Encrypted Key is the CEK wrapped
with the agreed upon key.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the result of the key agreement algorithm as the key
encryption key for the corresponding key wrapping algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A128KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A128KW&#8221;</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A192KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A192KW&#8221;</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A256KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A256KW&#8221;</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6</a>)</p>
<div class="section" id="header-parameters-used-for-ecdh-key-agreement">
<span id="jwa-4-6-1"></span><h4><a class="toc-backref" href="#id65">4.6.1. Header Parameters Used for ECDH Key Agreement</a><a class="headerlink" href="#header-parameters-used-for-ecdh-key-agreement" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameter names are used for key agreement as
defined below.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1</a>)</p>
<div class="section" id="epk-ephemeral-public-key-header-parameter">
<span id="jwa-4-6-1-1"></span><h5><a class="toc-backref" href="#id66">4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a><a class="headerlink" href="#epk-ephemeral-public-key-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;epk&#8221; (ephemeral public key) value created by the originator for
the use in key agreement algorithms.  This key is represented as a
JSON Web Key [JWK] public key value.  It MUST contain only public key
parameters and SHOULD contain only the minimum JWK parameters
necessary to represent the key; other JWK parameters included can be
checked for consistency and honored or can be ignored.  This Header
Parameter MUST be present and MUST be understood and processed by
implementations when these algorithms are used.</p>
<p>(draft20)
( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1</a>)</p>
</div>
<div class="section" id="apu-agreement-partyuinfo-header-parameter">
<span id="jwa-4-6-1-2"></span><h5><a class="toc-backref" href="#id67">4.6.1.2. &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a><a class="headerlink" href="#apu-agreement-partyuinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apu&#8221; (agreement PartyUInfo) value for key agreement algorithms
using it (such as &#8220;ECDH-ES&#8221;), represented as a base64url encoded
string.  When used, the PartyUInfo value contains information about
the sender.  Use of this Header Parameter is OPTIONAL.  This Header
Parameter MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1.2</a>)</p>
</div>
<div class="section" id="apv-agreement-partyvinfo-header-parameter">
<span id="jwa-4-6-1-3"></span><h5><a class="toc-backref" href="#id68">4.6.1.3. &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a><a class="headerlink" href="#apv-agreement-partyvinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apv&#8221; (agreement PartyVInfo) value for key agreement algorithms
using it (such as &#8220;ECDH-ES&#8221;), represented as a base64url encoded
string.  When used, the PartyVInfo value contains information about
the receiver.  Use of this Header Parameter is OPTIONAL.  This Header
Parameter MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.1.3</a>)</p>
</div>
</div>
<div class="section" id="key-derivation-for-ecdh-key-agreement">
<span id="jwa-4-6-2"></span><h4><a class="toc-backref" href="#id69">4.6.2. Key Derivation for ECDH Key Agreement</a><a class="headerlink" href="#key-derivation-for-ecdh-key-agreement" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-z">Z</dt>
<dd>This is set to the representation of the shared secret Z as an
octet sequence.</dd>
<dt id="term-keydatalen">keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.  For &#8220;ECDH-ES&#8221;, this is length of the key used by the &#8220;enc&#8221;
algorithm.  For &#8220;ECDH-ES+A128KW&#8221;, &#8220;ECDH-ES+A192KW&#8221;, and
&#8220;ECDH-ES+A256KW&#8221;, this is 128, 192, and 256, respectively.</dd>
<dt id="term-algorithmid">AlgorithmID</dt>
<dd>The AlgorithmID value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.  In the Direct Key
Agreement case, Data is set to the octets of the UTF-8
representation of the &#8220;enc&#8221; Header Parameter value.  In the Key
Agreement with Key Wrapping case, Data is set to the octets of the
UTF-8 representation of the &#8220;alg&#8221; Header Parameter value.</dd>
<dt id="term-partyuinfo">PartyUInfo</dt>
<dd>The PartyUInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.  If an &#8220;apu&#8221; (agreement
PartyUInfo) Header Parameter is present, Data is set to the result
of base64url decoding the &#8220;apu&#8221; value and Datalen is set to the
number of octets in Data.  Otherwise, Datalen is set to 0 and Data
is set to the empty octet sequence.</dd>
<dt id="term-partyvinfo">PartyVInfo</dt>
<dd>The PartyVInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.  If an &#8220;apv&#8221; (agreement
PartyVInfo) Header Parameter is present, Data is set to the result
of base64url decoding the &#8220;apv&#8221; value and Datalen is set to the
number of octets in Data.  Otherwise, Datalen is set to 0 and Data
is set to the empty octet sequence.</dd>
<dt id="term-supppubinfo">SuppPubInfo</dt>
<dd>This is set to the keydatalen represented as a 32 bit
big endian integer.</dd>
<dt id="term-suppprivinfo">SuppPrivInfo</dt>
<dd>This is set to the empty octet sequence.</dd>
</dl>
<p>Applications need to specify how the &#8220;apu&#8221; and &#8220;apv&#8221; parameters are
used for that application.  The &#8220;apu&#8221; and &#8220;apv&#8221; values MUST be
distinct, when used.  Applications wishing to conform to
[NIST.800-56A] need to provide values that meet the requirements of
that document, e.g., by using values that identify the sender and
recipient.  Alternatively, applications MAY conduct key derivation in
a manner similar to The Diffie-Hellman Key Agreement Method
[RFC2631]: In that case, the &#8220;apu&#8221; field MAY either be omitted or
represent a random 512-bit value (analogous to PartyAInfo in
Ephemeral-Static mode in [RFC2631]) and the &#8220;apv&#8221; field should not be
present.</p>
<p>See Appendix C for an example key agreement computation using this
method.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.6.2</a>)</p>
</div>
</div>
<div class="section" id="key-encryption-with-aes-gcm">
<span id="jwa-4-7"></span><h3><a class="toc-backref" href="#id70">4.7. Key Encryption with AES GCM</a><a class="headerlink" href="#key-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE Content
Encryption Key (CEK) with Advanced Encryption Standard (AES) in
Galois/Counter Mode (GCM) [AES] [NIST.800-38D].</p>
<p>Use of an Initialization Vector of size 96 bits is REQUIRED with this
algorithm.  The Initialization Vector is represented in base64url
encoded form as the &#8220;iv&#8221; (initialization vector) Header Parameter
value.</p>
<p>The Additional Authenticated Data value used is the empty octet
string.</p>
<p>The requested size of the Authentication Tag output MUST be 128 bits,
regardless of the key size.</p>
<p>The JWE Encrypted Key value is the Ciphertext output.</p>
<p>The Authentication Tag output is represented in base64url encoded
form as the &#8220;tag&#8221; (authentication tag) Header Parameter value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the corresponding algorithm and key size:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>A128GCMKW</td>
<td>Key wrapping with AES GCM using 128 bit key</td>
</tr>
<tr class="row-odd"><td>A192GCMKW</td>
<td>Key wrapping with AES GCM using 192 bit key</td>
</tr>
<tr class="row-even"><td>A256GCMKW</td>
<td>Key wrapping with AES GCM using 256 bit key</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7</a>)</p>
<div class="section" id="header-parameters-used-for-aes-gcm-key-encryption">
<span id="jwa-4-7-1"></span><h4><a class="toc-backref" href="#id71">4.7.1. Header Parameters Used for AES GCM Key Encryption</a><a class="headerlink" href="#header-parameters-used-for-aes-gcm-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameters are used for AES GCM key encryption.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7.1</a>)</p>
<div class="section" id="iv-initialization-vector-header-parameter">
<span id="jwa-4-7-1-1"></span><h5><a class="toc-backref" href="#id72">4.7.1.1. &#8220;iv&#8221; (Initialization Vector) Header Parameter</a><a class="headerlink" href="#iv-initialization-vector-header-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;iv&#8221; (initialization vector) Header Parameter value is the
base64url encoded representation of the Initialization Vector value
used for the key encryption operation.  This Header Parameter MUST be
present and MUST be understood and processed by implementations when
these algorithms are used.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="tag-authentication-tag-header-parameter">
<span id="jwa-4-7-1-2"></span><h5><a class="toc-backref" href="#id73">4.7.1.2. &#8220;tag&#8221; (Authentication Tag) Header Parameter</a><a class="headerlink" href="#tag-authentication-tag-header-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;tag&#8221; (authentication tag) Header Parameter value is the
base64url encoded representation of the Authentication Tag value
resulting from the key encryption operation.  This Header Parameter
MUST be present and MUST be understood and processed by
implementations when these algorithms are used.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-4-7-1-3">
<span id="id1"></span><h5><a class="toc-backref" href="#id74">4.7.1.3.  &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a><a class="headerlink" href="#jwa-4-7-1-3" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apv&#8221; (agreement PartyVInfo) value for key agreement algorithms
using it (such as &#8220;ECDH-ES&#8221;),
represented as a base64url encoded string.
When used,
the PartyVInfo value contains information about the receiver.
Use of this Header Parameter is OPTIONAL.
This Header Parameter MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.3</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography ( NIST Special Publication 800-56A  )</p>
</div>
</div>
</div>
<div class="section" id="jwa-4-7-2">
<span id="id2"></span><h4><a class="toc-backref" href="#id75">4.7.2.  Key Derivation for ECDH Key Agreement</a><a class="headerlink" href="#jwa-4-7-2" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-50">Z</dt>
<dd>This is set to the representation of the shared secret Z as an
octet sequence.</dd>
<dt id="term-51">keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.  For &#8220;ECDH-ES&#8221;, this is length of the key used by the &#8220;enc&#8221;
algorithm.  For &#8220;ECDH-ES+A128KW&#8221;, &#8220;ECDH-ES+A192KW&#8221;, and
&#8220;ECDH-ES+A256KW&#8221;, this is 128, 192, and 256, respectively.</dd>
<dt id="term-52">AlgorithmID</dt>
<dd>In the Direct Key Agreement case, this is set to the
octets of the UTF-8 representation of the &#8220;enc&#8221; header parameter
value.  In the Key Agreement with Key Wrapping case, this is set
to the octets of the UTF-8 representation of the &#8220;alg&#8221; header
parameter value.</dd>
<dt id="term-53">PartyUInfo</dt>
<dd>The PartyUInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data, with || being
concatenation.  If an &#8220;apu&#8221; (agreement PartyUInfo) header
parameter is present, Data is set to the result of base64url
decoding the &#8220;apu&#8221; value and Datalen is set to the number of
octets in Data.  Otherwise, Datalen is set to 0 and Data is set to
the empty octet sequence.</dd>
<dt id="term-54">PartyVInfo</dt>
<dd>The PartyVInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data, with || being
concatenation.  If an &#8220;apv&#8221; (agreement PartyVInfo) header
parameter is present, Data is set to the result of base64url
decoding the &#8220;apv&#8221; value and Datalen is set to the number of
octets in Data.  Otherwise, Datalen is set to 0 and Data is set to
the empty octet sequence.</dd>
<dt id="term-55">SuppPubInfo</dt>
<dd>This is set to the keydatalen represented as a 32 bit
big endian integer.</dd>
<dt id="term-56">SuppPrivInfo</dt>
<dd>This is set to the empty octet sequence.</dd>
</dl>
<p>See Appendix D for an example key agreement computation using this
method.</p>
<p>Note: The Diffie-Hellman Key Agreement Method [RFC2631] uses a key
derivation function similar to the Concat KDF, but with fewer
parameters.  Rather than having separate PartyUInfo and PartyVInfo
parameters, it uses a single PartyAInfo parameter, which is a random
string provided by the sender, that contains 512 bits of information,
when provided.  It has no SuppPrivInfo parameter.  Should it be
appropriate for the application, key agreement can be performed in a
manner akin to RFC 2631 by using the PartyAInfo value as the &#8220;apu&#8221;
(Agreement PartyUInfo) header parameter value, when provided, and by
using no &#8220;apv&#8221; (Agreement PartyVInfo) header parameter.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.2</a> )</p>
</div>
</div>
<div class="section" id="key-encryption-with-pbes2">
<span id="jwa-4-8"></span><h3><a class="toc-backref" href="#id76">4.8. Key Encryption with PBES2</a><a class="headerlink" href="#key-encryption-with-pbes2" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This section defines the specifies of performing password-based
encryption of a JWE CEK, by first deriving a key encryption key from
a user-supplied password using PBES2 schemes as specified in Section
6.2 of [RFC2898], then by encrypting the JWE CEK using the derived
key.</p>
<p>These algorithms use HMAC SHA-2 algorithms as the Pseudo-Random
Function (PRF) for the PBKDF2 key derivation and AES Key Wrap
[RFC3394] for the encryption scheme.  The PBES2 password input is an
octet sequence; if the password to be used is represented as a text
string rather than an octet sequence, the UTF-8 encoding of the text
string MUST be used as the octet sequence.  The salt MUST be provided
as the &#8220;p2s&#8221; Header Parameter value, and MUST be base64url decoded to
obtain the value.  The iteration count parameter MUST be provided as
the &#8220;p2c&#8221; Header Parameter value.  The algorithms respectively use
HMAC SHA-256, HMAC SHA-384, and HMAC SHA-512 as the PRF and use 128,
192, and 256 bit AES Key Wrap keys.  Their derived-key lengths
respectively are 16, 24, and 32 octets.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the result of the corresponding password-based encryption
algorithm as the key encryption key for the corresponding key
wrapping algorithm:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td><p class="first">PBES2-HS256+A128KW</p>
<p>PBES2-HS384+A192KW</p>
<p class="last">PBES2-HS512+A256KW</p>
</td>
<td>PBES2 with HMAC SHA-256 and &#8220;A128KW&#8221;
wrapping
PBES2 with HMAC SHA-384 and &#8220;A192KW&#8221;
wrapping
PBES2 with HMAC SHA-512 and &#8220;A256KW&#8221;
wrapping</td>
</tr>
</tbody>
</table>
<p>See Appendix C of JSON Web Key (JWK) [JWK] for an example key
encryption computation using &#8220;PBES2-HS256+A128KW&#8221;.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="header-parameters-used-for-pbes2-key-encryption">
<span id="jwa-4-8-1"></span><h4><a class="toc-backref" href="#id77">4.8.1. Header Parameters Used for PBES2 Key Encryption</a><a class="headerlink" href="#header-parameters-used-for-pbes2-key-encryption" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>The following Header Parameters are used for Key Encryption with
PBES2.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="p2s-pbes2-salt-parameter">
<span id="jwa-4-8-1-1"></span><h5><a class="toc-backref" href="#id78">4.8.1.1. &#8220;p2s&#8221; (PBES2 salt) Parameter</a><a class="headerlink" href="#p2s-pbes2-salt-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div><p>The &#8220;p2s&#8221; (PBES2 salt) Header Parameter contains the PBKDF2 salt
value, encoded using base64url.  This Header Parameter MUST be
present and MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>The salt expands the possible keys that can be derived from a given
password.  A salt value containing 8 or more octets MUST be used.  A
new salt value MUST be generated randomly for every encryption
operation; see [RFC4086] for considerations on generating random
values.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="p2c-pbes2-count-parameter">
<span id="jwa-4-8-1-2"></span><h5><a class="toc-backref" href="#id79">4.8.1.2. &#8220;p2c&#8221; (PBES2 count) Parameter</a><a class="headerlink" href="#p2c-pbes2-count-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div><p>The &#8220;p2c&#8221; (PBES2 count) Header Parameter contains the PBKDF2
iteration count, represented as a positive integer.  This Header
Parameter MUST be present and MUST be understood and processed by
implementations when these algorithms are used.</p>
<p>The iteration count adds computational expense, ideally compounded by
the possible range of keys introduced by the salt.  A minimum
iteration count of 1000 is RECOMMENDED.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-2"></span><h4><a class="toc-backref" href="#id80">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Cipher Block Chaining
(CBC) mode with PKCS #5 padding [AES] [NIST.800-38A] using 128 or 256
bit keys.  The &#8220;enc&#8221; header parameter values &#8220;A128CBC+HS256&#8221; or
&#8220;A256CBC+HS512&#8221; are respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 128 bits is REQUIRED with
these algorithms.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2</a> )</p>
</div>
<div class="section" id="integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-3"></span><h4><a class="toc-backref" href="#id81">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of computing the JWE Integrity
Value for the &#8220;enc&#8221; algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;.
This value is computed as a MAC of the JWE parameters to be secured.</p>
<p>The MAC input value is the bytes of the ASCII representation of the
concatenation of the Encoded JWE Header, a period (&#8216;.&#8217;) character,
the Encoded JWE Encrypted Key, a second period character (&#8216;.&#8217;), the
Encoded JWE Initialization Vector, a third period (&#8216;.&#8217;) character,
and the Encoded JWE Ciphertext.</p>
<p>The CIK is used as the MAC key.</p>
<p>For &#8220;A128CBC+HS256&#8221;, HMAC SHA-256 is used as the MAC algorithm.  For
&#8220;A256CBC+HS512&#8221;, HMAC SHA-512 is used as the MAC algorithm.</p>
<p>The resulting MAC value is used as the JWE Integrity Value.  The same
integrity calculation is performed during decryption.  During
decryption, the computed integrity value must match the received JWE
Integrity Value.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3</a> )</p>
</div>
</div>
<div class="section" id="plaintext-encryption-with-aes-gcm">
<span id="jwa-4-9"></span><h3><a class="toc-backref" href="#id82">4.9. Plaintext Encryption with AES GCM</a><a class="headerlink" href="#plaintext-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128 or 256 bit keys.  The &#8220;enc&#8221; header
parameter values &#8220;A128GCM&#8221; or &#8220;A256GCM&#8221; are used in this case.</p>
<p>The CMK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this algorithm.</p>
<p>The &#8220;additional authenticated data&#8221; parameter is used to secure the
header and key values.  The &#8220;additional authenticated data&#8221; value
used is the bytes of the ASCII representation of the concatenation of
the Encoded JWE Header, a period (&#8216;.&#8217;) character, the Encoded JWE
Encrypted Key, a second period character (&#8216;.&#8217;), and the Encoded JWE
Initialization Vector.  This same &#8220;additional authenticated data&#8221;
value is used when decrypting as well.</p>
<p>The requested size of the &#8220;authentication tag&#8221; output MUST be 128
bits, regardless of the key size.</p>
<p>As GCM is an AEAD algorithm, the JWE Integrity Value is set to be the
&#8220;authentication tag&#8221; value produced by the encryption.  During
decryption, the received JWE Integrity Value is used as the
&#8220;authentication tag&#8221; value.</p>
<p>Examples using this algorithm are shown in Appendices <a class="reference internal" href="jwe.html#jwe-appendix-a-1"><em>A.1</em></a>
and <em class="xref std std-ref">A.3</em> of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9</a>)</p>
<div class="section" id="jwa-4-9-1">
<span id="id3"></span><h4><a class="toc-backref" href="#id83">4.9.1.  Header Parameters Used for PBES2 Key Encryption</a><a class="headerlink" href="#jwa-4-9-1" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameters are used for Key Encryption with PBES2.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1</a> )</p>
<div class="section" id="jwa-4-9-1-1">
<span id="id4"></span><h5><a class="toc-backref" href="#id84">4.9.1.1.  &#8220;p2s&#8221; (PBES2 salt) Parameter</a><a class="headerlink" href="#jwa-4-9-1-1" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2s&#8221; (PBES2 salt) header parameter contains the PBKDF2 salt
value (s) as a base64url encoded string.  This value MUST NOT be the
empty string.  This Header Parameter is REQUIRED and MUST be
understood and processed by implementations when these algorithms are
used.</p>
<p>The salt expands the possible keys that can be derived from a given
password.  [RFC2898] originally recommended a minimum salt length of
8 octets (since there is no concern here of a derived key being re-
used for different purposes).  The salt MUST be generated randomly;
see [RFC4086] for considerations on generating random values.
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.1</a> )</p>
</div>
<div class="section" id="jwa-4-9-1-2">
<span id="id5"></span><h5><a class="toc-backref" href="#id85">4.9.1.2.  &#8220;p2c&#8221; (PBES2 count) Parameter</a><a class="headerlink" href="#jwa-4-9-1-2" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2c&#8221; (PBES2 count) header parameter contains the PBKDF2
iteration count (c), as an integer.  This value MUST NOT be less than
1, as per [RFC2898].  This Header Parameter is REQUIRED and MUST be
understood and processed by implementations when these algorithms are
used.</p>
<p>The iteration count adds computational expense, ideally compounded by
the possible range of keys introduced by the salt.  [RFC2898]
originally recommended a minimum iteration count of 1000.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.2</a> )</p>
</div>
</div>
</div>
<div class="section" id="aes-cbc-hmac-sha2-algorithms">
<span id="jwa-4-10"></span><h3><a class="toc-backref" href="#id86">4.10. AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h3>
<p>This section defines a family of authenticated encryption algorithms
built using a composition of Advanced Encryption Standard (AES)
in Cipher Block Chaining (CBC) mode with PKCS #5 padding [AES]
[NIST.800-38A] operations and HMAC [RFC2104] [SHS] operations.</p>
<p>This algorithm family is called AES_CBC_HMAC_SHA2.
It also defines two instances of this family,
one using 128 bit CBC keys and HMAC SHA-256
and the other using 256 bit CBC keys and HMAC SHA-512.</p>
<p>Test cases for these algorithms can be found in Appendix C.</p>
<p>These algorithms are based upon Authenticated Encryption
with AES-CBC and HMAC-SHA [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
performing the same cryptographic computations,
but with the <em class="xref std std-term">Initialization Vector</em> and <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">Authentication Tag</em></a> values
remaining separate,
rather than being concatenated with the Ciphertext value in the output representation.</p>
<p>This algorithm family is a generalization of the algorithm family
in [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
and can be used to implement those algorithms.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10</a> )</p>
<div class="section" id="conventions-used-in-defining-aes-cbc-hmac-sha2">
<span id="jwa-4-10-1"></span><h4><a class="toc-backref" href="#id87">4.10.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>We use the following notational conventions.</p>
<p>CBC-PKCS5-ENC(X, P) denotes the AES CBC encryption of P
using PKCS #5 padding using the cipher with the key X.</p>
<p>MAC(Y, M) denotes the application of
the Message Authentication Code (MAC) to the message M,
using the key Y.</p>
<p>The concatenation of two octet strings A and B is denoted as A || B.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.1</a> )</p>
</div>
<div class="section" id="generic-aes-cbc-hmac-sha2-algorithm">
<span id="jwa-4-10-2"></span><h4><a class="toc-backref" href="#id88">4.10.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><a class="headerlink" href="#generic-aes-cbc-hmac-sha2-algorithm" title="Permalink to this headline">¶</a></h4>
<p>This section defines AES_CBC_HMAC_SHA2 in a manner
that is independent of the AES CBC key size
or hash function to be used.</p>
<p>Section 4.10.2.1 and Section 4.10.2.2 define the generic encryption
and decryption algorithms.</p>
<p>Section 4.10.3 and Section 4.10.4 define instances of AES_CBC_HMAC_SHA2 t
hat specify those details.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2</a> )</p>
<div class="section" id="aes-cbc-hmac-sha2-encryption">
<span id="jwa-4-10-2-1"></span><h5><a class="toc-backref" href="#id89">4.10.2.1. AES_CBC_HMAC_SHA2 Encryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-encryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated encryption algorithm takes as input four octet strings:
a secret key K,
a plaintext P,
associated data A,
and an initialization vector IV.</p>
<p>The <em class="xref std std-term">authenticated ciphertext</em> value E and the <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">authentication tag</em></a> value T
are provided as outputs.</p>
<p>The data in the plaintext are encrypted and authenticated,
and the associated data are authenticated, but not encrypted.</p>
<p>The encryption process is as follows,
or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as follows.</p>
<p>Each of these two keys is an octet string.</p>
<blockquote>
<div><p>MAC_KEY consists of the initial MAC_KEY_LEN octets of K, in order.</p>
<p>ENC_KEY consists of the final ENC_KEY_LEN octets of K, in order.</p>
</div></blockquote>
<p>Here we denote the number of octets in the MAC_KEY as MAC_KEY_LEN,
and the number of octets in ENC_KEY as ENC_KEY_LEN;
the values of these parameters are specified by the AEAD algorithms
(in Section 4.10.3 and Section 4.10.4).</p>
<p>The number of octets in the input key K is the sum of MAC_KEY_LEN and
ENC_KEY_LEN.
When generating the secondary keys from K,
MAC_KEY and ENC_KEY MUST NOT overlap.</p>
<p>Note that the MAC key comes before
the encryption key in the input key K;
this is in the opposite order of the algorithm names in the identifier
&#8220;AES_CBC_HMAC_SHA2&#8221;.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>K (Secret Key ) = MAC_KEY + ENC_KEY</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>MAC_KEY</td>
<td>ENC_KEY</td>
</tr>
</tbody>
</table>
<p>&lt;&#8212; MAC_KEY_LEN  &#8211;&gt; &lt;&#8211; ENC_KEY_LEN   &#8211;&gt;</p>
<p class="last">IV = 128 bit (16 octet )</p>
</div>
</li>
<li><p class="first">The Initialization Vector (IV) used is a 128 bit value generated
randomly or pseudorandomly for use in the cipher.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IVは固定で128bit(16octet)</p>
</div>
</li>
<li><p class="first">The plaintext is CBC encrypted using PKCS #5 padding using
ENC_KEY as the key, and the IV.
We denote the ciphertext output from this step as E.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>プレーンテキストを ENC_KEYとIVを使って PKCS#5 パディングでCBC暗号化。</li>
</ul>
</div>
</li>
<li><p class="first">The octet string AL is equal to the number of bits in A expressed
as a 64-bit unsigned integer in network byte order.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>AL は 関連データ(A)のビット長。のオクテット数。</li>
</ul>
</div>
</li>
<li><p class="first">A <em class="xref std std-term">message authentication tag</em> T is computed by applying HMAC
[RFC2104] to the following data, in order:</p>
<blockquote>
<div><p>the associated data A,</p>
<p>the initialization vector IV,</p>
<p>the ciphertext E computed in the previous step, and</p>
<p>the octet string AL defined above.</p>
</div></blockquote>
<p>The string MAC_KEY is used as the MAC key.
We denote the output of the MAC computed in this step as M.</p>
<p>The first T_LEN bits of M are used as T.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>T_LENは実際のアルゴリズムで異なります。</li>
</ul>
</div>
</li>
<li><p class="first">The Ciphertext E and the Authentication Tag T are returned as the
outputs of the authenticated encryption.</p>
</li>
</ol>
</div></blockquote>
<p>The encryption process can be illustrated as follows.</p>
<p>Here K, P, A,
IV, and E denote the key, plaintext, associated data, initialization
vector, and ciphertext, respectively.</p>
<div class="highlight-python"><pre>MAC_KEY = initial MAC_KEY_LEN bytes of K,

ENC_KEY = final ENC_KEY_LEN bytes of K,

E = CBC-PKCS5-ENC(ENC_KEY, P),

M = MAC(MAC_KEY, A || IV || E || AL),

T = initial T_LEN bytes of M.</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.1</a> )</p>
</div>
<div class="section" id="aes-cbc-hmac-sha2-decryption">
<span id="jwa-4-10-2-2"></span><h5><a class="toc-backref" href="#id90">4.10.2.2. AES_CBC_HMAC_SHA2 Decryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-decryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated decryption operation has four inputs:
K, A, E, and T as defined above.</p>
<p>It has only a single output, either a plaintext value P or a special symbol FAIL
that indicates that the inputs are not authentic.</p>
<p>The authenticated decryption algorithm is as follows, or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as in Step 1 of Section 4.10.2.1.</li>
<li>The integrity and authenticity of A and E are checked by
computing an HMAC with the inputs as in Step 5 of
Section 4.10.2.1.  The value T, from the previous step, is
compared to the first MAC_KEY length bits of the HMAC output.  If
those values are identical, then A and E are considered valid,
and processing is continued.  Otherwise, all of the data used in
the MAC validation are discarded, and the AEAD decryption
operation returns an indication that it failed, and the operation
halts.  (But see Section 10 of [JWE] for security considerations
on thwarting timing attacks.)</li>
<li>The value E is decrypted and the PKCS #5 padding is removed.  The
value IV is used as the initialization vector.  The value ENC_KEY
is used as the decryption key.</li>
<li>The plaintext value is returned.</li>
</ol>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.2</a> )</p>
</div>
</div>
<div class="section" id="aes-128-cbc-hmac-sha-256">
<span id="jwa-4-10-3"></span><h4><a class="toc-backref" href="#id91">4.10.3. AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h4>
<p>This algorithm is a concrete instantiation of
the generic AES_CBC_HMAC_SHA2 algorithm above.</p>
<p>It uses the HMAC message authentication code [RFC2104]
with the SHA-256 hash function [SHS]
to provide message authentication,
with the HMAC output truncated to 128 bits,
corresponding to the HMAC-SHA-256-128 algorithm defined in [RFC4868].</p>
<p>For encryption,
it uses AES in the Cipher Block Chaining (CBC) mode of operation
as defined in Section 6.2 of [NIST.800-38A], with PKCS #5 padding.</p>
<p>The input key K is 32 octets long.</p>
<p>The AES CBC IV is 16 octets long.  ENC_KEY_LEN is 16 octets.</p>
<p>The SHA-256 hash algorithm is used in HMAC.
MAC_KEY_LEN is 16 octets.</p>
<p>The HMAC-SHA-256 output is truncated to T_LEN=16 octets,
by stripping off the final 16 octets.</p>
<div class="highlight-python"><pre>K (Secret Key ) = MAC_KEY + ENC_KEY (32 octet )

+----------------------+----------------------+
| MAC_KEY              | ENC_KEY              |
+----------------------+----------------------+

&lt;--- MAC_KEY_LEN(16)--&gt; &lt;-- ENC_KEY_LEN(16) --&gt;

IV = 128 bit (16 octet )</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.3</a> )</p>
</div>
<div class="section" id="aes-192-cbc-hmac-sha-384">
<span id="jwa-4-10-4"></span><h4><a class="toc-backref" href="#id92">4.10.4.  AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h4>
<p>AES_192_CBC_HMAC_SHA_384 is based on AES_128_CBC_HMAC_SHA_256, but
with the following differences:</p>
<blockquote>
<div><p>A 192 bit AES CBC key is used instead of 128.</p>
<p>SHA-384 is used in HMAC instead of SHA-256.</p>
<p>ENC_KEY_LEN is 24 octets instead of 16.</p>
<p>MAC_KEY_LEN is 24 octets instead of 16.</p>
<p>The length of the input key K is 48 octets instead of 32.</p>
<p>The HMAC SHA-384 value is truncated to T_LEN=24 octets instead of
16.</p>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.4</a> )</p>
</div>
<div class="section" id="aes-256-cbc-hmac-sha-512">
<span id="jwa-4-10-5"></span><h4><a class="toc-backref" href="#id93">4.10.5.  AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h4>
<p>AES_256_CBC_HMAC_SHA_512 is based on AES_128_CBC_HMAC_SHA_256, but
with the following differences:</p>
<blockquote>
<div><p>A 256 bit AES CBC key is used instead of 128.</p>
<p>SHA-512 is used in HMAC instead of SHA-256.</p>
<p>ENC_KEY_LEN is 32 octets instead of 16.</p>
<p>MAC_KEY_LEN is 32 octets instead of 16.</p>
<p>The length of the input key K is 64 octets instead of 32.</p>
<p>The HMAC SHA-512 value is truncated to T_LEN=32 octets instead of
16.</p>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.5</a> )</p>
</div>
<div class="section" id="plaintext-encryption-with-aes-cbc-hmac-sha2">
<span id="jwa-4-10-6"></span><h4><a class="toc-backref" href="#id94">4.10.6.  Plaintext Encryption with AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#plaintext-encryption-with-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>The algorithm value &#8220;A128CBC-HS256&#8221; is used as the &#8220;alg&#8221; value when
using AES_128_CBC_HMAC_SHA_256 with JWE.  The algorithm value
&#8220;A192CBC-HS384&#8221; is used as the &#8220;alg&#8221; value when using
AES_192_CBC_HMAC_SHA_384 with JWE.  The algorithm value
&#8220;A256CBC-HS512&#8221; is used as the &#8220;alg&#8221; value when using
AES_256_CBC_HMAC_SHA_512 with JWE.  The Additional Authenticated Data
value used is the octets of the ASCII representation of the Encoded
JWE Header value.  The JWE Initialization Vector value used is the IV
value.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.6</a> )</p>
</div>
</div>
<div class="section" id="jwa-4-11">
<span id="id6"></span><h3><a class="toc-backref" href="#id95">4.11.  Plaintext Encryption with AES GCM</a><a class="headerlink" href="#jwa-4-11" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128, 192, or 256 bit keys.  The &#8220;enc&#8221;
header parameter values &#8220;A128GCM&#8221;, &#8220;A192GCM&#8221;, or &#8220;A256GCM&#8221; are
respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this
algorithm.</p>
<p>The Additional Authenticated Data value used is the octets of the
ASCII representation of the Encoded JWE Header value.</p>
<p>The requested size of the Authentication Tag output MUST be 128 bits,
regardless of the key size.</p>
<p>The JWE Authentication Tag is set to be the Authentication Tag value
produced by the encryption.  During decryption, the received JWE
Authentication Tag is used as the Authentication Tag value.</p>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.11">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.11</a> )</p>
</div>
<div class="section" id="additional-encryption-algorithms-and-parameters">
<span id="jwa-4-12"></span><h3><a class="toc-backref" href="#id96">4.12.  Additional Encryption Algorithms and Parameters</a><a class="headerlink" href="#additional-encryption-algorithms-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWEs with corresponding
&#8220;alg&#8221; (algorithm) and &#8220;enc&#8221; (encryption method) header parameter
values being defined to refer to them.  New &#8220;alg&#8221; and &#8220;enc&#8221; header
parameter values SHOULD either be registered in the IANA JSON Web
Signature and Encryption Algorithms registry Section 6.1 or be a
value that contains a Collision Resistant Namespace.  In particular,
it is permissible to use the algorithm identifiers defined in XML
Encryption [W3C.REC-xmlenc-core-20021210], XML Encryption 1.1
[W3C.CR-xmlenc-core1-20120313], and related specifications as &#8220;alg&#8221;
and &#8220;enc&#8221; values.</p>
<p>As indicated by the common registry, JWSs and JWEs share a common
&#8220;alg&#8221; value space.  The values used by the two specifications MUST be
distinct, as the &#8220;alg&#8221; value can be used to determine whether the
object is a JWS or JWE.</p>
<p>Likewise, additional reserved Header Parameter Names can be defined
via the IANA JSON Web Signature and Encryption Header Parameters
registry [JWS].  As indicated by the common registry, JWSs and JWEs
share a common header parameter space; when a parameter is used by
both specifications, its usage must be compatible between the
specifications.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.12">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.12</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-content-encryption">
<span id="jwa-5"></span><h2><a class="toc-backref" href="#id97">5. Cryptographic Algorithms for Content Encryption</a><a class="headerlink" href="#cryptographic-algorithms-for-content-encryption" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>JWE uses cryptographic algorithms to encrypt the Plaintext.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="enc-encryption-algorithm-header-parameter-values-for-jwe">
<span id="jwa-5-1"></span><h3><a class="toc-backref" href="#id98">5.1. &#8220;enc&#8221; (Encryption Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#enc-encryption-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;enc&#8221; (encryption algorithm) Header
Parameter values that are defined by this specification for use with
JWE.  These algorithms are used to encrypt the Plaintext, which
produces the Ciphertext.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="38%" />
<col width="19%" />
<col width="23%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc
Parameter
Value</td>
<td>Content Encryption
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementatio
nRequirements</td>
</tr>
<tr class="row-even"><td>A128CBC-HS2
56</td>
<td><p class="first">AES_128_CBC_HMAC_SHA_2
56 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.3</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A192CBC-HS3
84</td>
<td><p class="first">AES_192_CBC_HMAC_SHA_3
84 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.4</div></blockquote>
</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256CBC-HS5
12</td>
<td><p class="first">AES_256_CBC_HMAC_SHA_5
12 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.5</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td>AES GCM using 128 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A192GCM</td>
<td>AES GCM using 192 bit
key</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td>AES GCM using 256 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The Additional Header Parameters column indicates what additional
Header Parameters are used by the algorithm, beyond &#8220;enc&#8221;, which all
use.  All also use a JWE Initialization Vector value and produce JWE
Ciphertext and JWE Authentication Tag values.</p>
<p>See Appendix A.3 for a table cross-referencing the JWE &#8220;enc&#8221;
(encryption algorithm) values defined in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-5-2">
<span id="id7"></span><h3><a class="toc-backref" href="#id99">5.2. AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#jwa-5-2" title="Permalink to this headline">¶</a></h3>
<p>This section defines a family of authenticated encryption algorithms
built using a composition of Advanced Encryption Standard (AES) in
Cipher Block Chaining (CBC) mode with PKCS #5 padding [AES]
[NIST.800-38A] operations and HMAC [RFC2104] [SHS] operations.  This
algorithm family is called AES_CBC_HMAC_SHA2.  It also defines three
instances of this family, the first using 128 bit CBC keys and HMAC
SHA-256, the second using 192 bit CBC keys and HMAC SHA-384, and the
third using 256 bit CBC keys and HMAC SHA-512.  Test cases for these
algorithms can be found in Appendix B.</p>
<p>These algorithms are based upon Authenticated Encryption with AES-CBC
and HMAC-SHA [I-D.mcgrew-aead-aes-cbc-hmac-sha2], performing the same
cryptographic computations, but with the Initialization Vector and
Authentication Tag values remaining separate, rather than being
concatenated with the Ciphertext value in the output representation.
This option is discussed in Appendix B of that specification.  This
algorithm family is a generalization of the algorithm family in
[I-D.mcgrew-aead-aes-cbc-hmac-sha2], and can be used to implement
those algorithms.</p>
<p>(draft20)</p>
<div class="section" id="jwa-5-2-1">
<span id="id8"></span><h4><a class="toc-backref" href="#id100">5.2.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#jwa-5-2-1" title="Permalink to this headline">¶</a></h4>
<p>We use the following notational conventions.</p>
<blockquote>
<div><p>CBC-PKCS5-ENC(X, P) denotes the AES CBC encryption of P using PKCS
#5 padding using the cipher with the key X.</p>
<p>MAC(Y, M) denotes the application of the Message Authentication
Code (MAC) to the message M, using the key Y.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="crv-curve-parameter">
<span id="jwa-5-2-1-1"></span><h5><a class="toc-backref" href="#id101">5.2.1.1.  &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#crv-curve-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;crv&#8221; (curve) member identifies the cryptographic curve used with
the key.  Curve values from [DSS] used by this specification are:</p>
<blockquote>
<div><p>o  &#8220;P-256&#8221;</p>
<p>o  &#8220;P-384&#8221;</p>
<p>o  &#8220;P-521&#8221;</p>
</div></blockquote>
<p>Additional &#8220;crv&#8221; values MAY be used, provided they are understood by
implementations using that Elliptic Curve key.  The &#8220;crv&#8221; value is a
case sensitive string.
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.1</a>)</p>
</div>
<div class="section" id="x-x-coordinate-parameter">
<span id="jwa-5-2-1-2"></span><h5><a class="toc-backref" href="#id102">5.2.1.2.  &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#x-x-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as an octet sequence.  The
array representation MUST NOT be shortened to omit any leading zero
octets contained in the value.  For instance, when representing 521
bit integers, the octet sequence to be base64url encoded MUST contain
66 octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.2</a>  )</p>
</div>
<div class="section" id="y-y-coordinate-parameter">
<span id="jwa-5-2-1-3"></span><h5><a class="toc-backref" href="#id103">5.2.1.3.  &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#y-y-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as an octet sequence.  The
array representation MUST NOT be shortened to omit any leading zero
octets contained in the value.  For instance, when representing 521
bit integers, the octet sequence to be base64url encoded MUST contain
66 octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.3</a> )</p>
</div>
</div>
<div class="section" id="jwa-5-2-2">
<span id="id9"></span><h4><a class="toc-backref" href="#id104">5.2.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><a class="headerlink" href="#jwa-5-2-2" title="Permalink to this headline">¶</a></h4>
<p>This section defines AES_CBC_HMAC_SHA2 in a manner that is
independent of the AES CBC key size or hash function to be used.
Section 5.2.2.1 and Section 5.2.2.2 define the generic encryption and
decryption algorithms.  Section 5.2.3 and Section 5.2.5 define
instances of AES_CBC_HMAC_SHA2 that specify those details.</p>
<p>(draft20)</p>
<div class="section" id="jwa-5-2-2-1">
<span id="id10"></span><h5><a class="toc-backref" href="#id105">5.2.2.1. AES_CBC_HMAC_SHA2 Encryption</a><a class="headerlink" href="#jwa-5-2-2-1" title="Permalink to this headline">¶</a></h5>
<p>The authenticated encryption algorithm takes as input four octet
strings: a secret key K, a plaintext P, associated data A, and an
initialization vector IV.  The authenticated ciphertext value E and
the authentication tag value T are provided as outputs.  The data in
the plaintext are encrypted and authenticated, and the associated
data are authenticated, but not encrypted.</p>
<p>The encryption process is as follows, or uses an equivalent set of
steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as follows.  Each of these two keys is an octet
string.</p>
<blockquote>
<div><p>MAC_KEY consists of the initial MAC_KEY_LEN octets of K, in
order.</p>
<p>ENC_KEY consists of the final ENC_KEY_LEN octets of K, in
order.</p>
</div></blockquote>
<p>Here we denote the number of octets in the MAC_KEY as
MAC_KEY_LEN, and the number of octets in ENC_KEY as ENC_KEY_LEN;
the values of these parameters are specified by the AEAD
algorithms (in Section 5.2.3 and Section 5.2.5).  The number of
octets in the input key K is the sum of MAC_KEY_LEN and
ENC_KEY_LEN.  When generating the secondary keys from K, MAC_KEY
and ENC_KEY MUST NOT overlap.  Note that the MAC key comes before
the encryption key in the input key K; this is in the opposite
order of the algorithm names in the identifier
&#8220;AES_CBC_HMAC_SHA2&#8221;.</p>
</li>
<li><p class="first">The Initialization Vector (IV) used is a 128 bit value generated
randomly or pseudorandomly for use in the cipher.</p>
</li>
<li><p class="first">The plaintext is CBC encrypted using PKCS #5 padding using
ENC_KEY as the key, and the IV.  We denote the ciphertext output
from this step as E.</p>
</li>
<li><p class="first">The octet string AL is equal to the number of bits in A expressed
as a 64-bit unsigned integer in network byte order.</p>
</li>
<li><p class="first">A message authentication tag T is computed by applying HMAC
[RFC2104] to the following data, in order:</p>
<blockquote>
<div><p>the associated data A,</p>
<p>the initialization vector IV,</p>
<p>the ciphertext E computed in the previous step, and</p>
<p>the octet string AL defined above.</p>
</div></blockquote>
<p>The string MAC_KEY is used as the MAC key.  We denote the output
of the MAC computed in this step as M. The first T_LEN bits of M
are used as T.</p>
</li>
<li><p class="first">The Ciphertext E and the Authentication Tag T are returned as the
outputs of the authenticated encryption.</p>
</li>
</ol>
</div></blockquote>
<p>The encryption process can be illustrated as follows.  Here K, P, A,
IV, and E denote the key, plaintext, associated data, initialization
vector, and ciphertext, respectively.</p>
<blockquote>
<div><p>MAC_KEY = initial MAC_KEY_LEN bytes of K,</p>
<p>ENC_KEY = final ENC_KEY_LEN bytes of K,</p>
<p>E = CBC-PKCS5-ENC(ENC_KEY, P),</p>
<p>M = MAC(MAC_KEY, A || IV || E || AL),</p>
<p>T = initial T_LEN bytes of M.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-5-2-2-2">
<span id="id11"></span><h5><a class="toc-backref" href="#id106">5.2.2.2. AES_CBC_HMAC_SHA2 Decryption</a><a class="headerlink" href="#jwa-5-2-2-2" title="Permalink to this headline">¶</a></h5>
<p>The authenticated decryption operation has four inputs: K, A, E, and
T as defined above.  It has only a single output, either a plaintext
value P or a special symbol FAIL that indicates that the inputs are
not authentic.  The authenticated decryption algorithm is as follows,
or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as in Step 1 of Section 5.2.2.1.</li>
<li>The integrity and authenticity of A and E are checked by
computing an HMAC with the inputs as in Step 5 of
Section 5.2.2.1.  The value T, from the previous step, is
compared to the first MAC_KEY length bits of the HMAC output.  If
those values are identical, then A and E are considered valid,
and processing is continued.  Otherwise, all of the data used in
the MAC validation are discarded, and the AEAD decryption
operation returns an indication that it failed, and the operation
halts.  (But see Section 10 of [JWE] for security considerations
on thwarting timing attacks.)</li>
<li>The value E is decrypted and the PKCS #5 padding is removed.  The
value IV is used as the initialization vector.  The value ENC_KEY
is used as the decryption key.</li>
<li>The plaintext value is returned.</li>
</ol>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="id12">
<span id="jwa-5-2-3"></span><span id="id13"></span><h4><a class="toc-backref" href="#id107">5.2.3. AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>This algorithm is a concrete instantiation of the generic
AES_CBC_HMAC_SHA2 algorithm above.  It uses the HMAC message
authentication code [RFC2104] with the SHA-256 hash function [SHS] to
provide message authentication, with the HMAC output truncated to 128
bits, corresponding to the HMAC-SHA-256-128 algorithm defined in
[RFC4868].  For encryption, it uses AES in the Cipher Block Chaining
(CBC) mode of operation as defined in Section 6.2 of [NIST.800-38A],
with PKCS #5 padding and a 128 bit initialization vector (IV) value.</p>
<p>The AES_CBC_HMAC_SHA2 parameters specific to AES_128_CBC_HMAC_SHA_256
are:</p>
<blockquote>
<div><p>The input key K is 32 octets long.</p>
<p>ENC_KEY_LEN is 16 octets.</p>
<p>MAC_KEY_LEN is 16 octets.</p>
<p>The SHA-256 hash algorithm is used for the HMAC.</p>
<p>The HMAC-SHA-256 output is truncated to T_LEN=16 octets, by
stripping off the final 16 octets.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-5-2-4">
<span id="id14"></span><h4><a class="toc-backref" href="#id108">5.2.4. AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#jwa-5-2-4" title="Permalink to this headline">¶</a></h4>
<p>AES_192_CBC_HMAC_SHA_384 is based on <a class="reference internal" href="#id12"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a>,
but with the following differences:</p>
<blockquote>
<div><p>The input key K is 48 octets long instead of 32.</p>
<p>ENC_KEY_LEN is 24 octets instead of 16.</p>
<p>MAC_KEY_LEN is 24 octets instead of 16.</p>
<p>SHA-384 is used for the HMAC instead of SHA-256.</p>
<p>The HMAC SHA-384 value is truncated to T_LEN=24 octets instead of
16.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="id15">
<span id="jwa-5-2-5"></span><span id="id16"></span><h4><a class="toc-backref" href="#id109">5.2.5. AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>AES_256_CBC_HMAC_SHA_512 is based on <a class="reference internal" href="#id12"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a>, but
with the following differences:</p>
<blockquote>
<div>The input key K is 64 octets long instead of 32.</div></blockquote>
<p>Jones                     Expires July 24, 2014                [Page 25]</p>
<p>Internet-Draft          JSON Web Algorithms (JWA)           January 2014</p>
<blockquote>
<div><p>ENC_KEY_LEN is 32 octets instead of 16.</p>
<p>MAC_KEY_LEN is 32 octets instead of 16.</p>
<p>SHA-512 is used for the HMAC instead of SHA-256.</p>
<p>The HMAC SHA-512 value is truncated to T_LEN=32 octets instead of
16.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="content-encryption-with-aes-cbc-hmac-sha2">
<span id="jwa-5-2-6"></span><h4><a class="toc-backref" href="#id110">5.2.6. Content Encryption with AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#content-encryption-with-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>The following &#8220;enc&#8221; (encryption algorithm) Header Parameter values
are used to indicate that the JWE Ciphertext and JWE Authentication
Tag values have been computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc Parameter
Value</td>
<td>Content Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>A128CBC-HS256</td>
<td><a class="reference internal" href="#id12"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a> authenticated encryption
algorithm, as defined in Section 5.2.3</td>
</tr>
<tr class="row-odd"><td>A192CBC-HS384</td>
<td><em class="xref std std-ref">AES_192_CBC_HMAC_SHA_384</em> authenticated encryption
algorithm, as defined in Section 5.2.4</td>
</tr>
<tr class="row-even"><td>A256CBC-HS512</td>
<td><a class="reference internal" href="#id15"><em>5.2.5. AES_256_CBC_HMAC_SHA_512</em></a> authenticated encryption
algorithm, as defined in Section 5.2.5</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="content-encryption-with-aes-gcm">
<span id="jwa-5-3"></span><h3><a class="toc-backref" href="#id111">5.3. Content Encryption with AES GCM</a><a class="headerlink" href="#content-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D].  The &#8220;enc&#8221; Header Parameter values &#8220;A128GCM&#8221;,
&#8220;A192GCM&#8221;, or &#8220;A256GCM&#8221; are respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this
algorithm.</p>
<p>The requested size of the Authentication Tag output MUST be 128 bits,
regardless of the key size.</p>
<p>The JWE Authentication Tag is set to be the Authentication Tag value
produced by the encryption.  During decryption, the received JWE
Authentication Tag is used as the Authentication Tag value.</p>
<p>The following &#8220;enc&#8221; (encryption algorithm) Header Parameter values
are used to indicate that the JWE Ciphertext and JWE Authentication
Tag values have been computed using the corresponding algorithm and
key size:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc Parameter Value</td>
<td>Content Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>A128GCM</td>
<td>AES GCM using 128 bit key</td>
</tr>
<tr class="row-odd"><td>A192GCM</td>
<td>AES GCM using 192 bit key</td>
</tr>
<tr class="row-even"><td>A256GCM</td>
<td>AES GCM using 256 bit key</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(draft20)</p>
<div class="section" id="jwk-parameters-for-rsa-public-keys">
<span id="jwa-jwk-rsa-public"></span><span id="jwa-5-3-1"></span><h4><a class="toc-backref" href="#id112">5.3.1.  JWK Parameters for RSA Public Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-public-keys" title="Permalink to this headline">¶</a></h4>
<p>These members MUST be present for RSA public keys:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1</a> )</p>
<div class="section" id="n-modulus-parameter">
<span id="jwa-n"></span><span id="jwa-mod"></span><span id="jwa-5-3-1-1"></span><h5><a class="toc-backref" href="#id113">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a><a class="headerlink" href="#n-modulus-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;n&#8221; (modulus) member contains the modulus value</div></blockquote>
<p>for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a>
of the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST NOT be shortened to omit any leading zero octets.
For instance,
when representing 2048 bit integers,
the octet sequence to be base64url encoded MUST contain 256 octets,
including any leading zero octets.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>mod -&gt; n に変更</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1</a> )</p>
</div>
<div class="section" id="e-exponent-parameter">
<span id="jwa-e"></span><span id="jwa-xpo"></span><span id="jwa-5-3-1-2"></span><h5><a class="toc-backref" href="#id114">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a><a class="headerlink" href="#e-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;e&#8221; (exponent) member contains the exponent value
for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of
the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST utilize the minimum number of octets to
represent the value.</p>
<p>For instance,
when representing the value 65537,
the octet sequence to be base64url encoded MUST consist of the three octets [1, 0, 1].</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2</a> )</p>
</div>
</div>
<div class="section" id="jwk-parameters-for-rsa-private-keys">
<span id="jwa-5-3-2"></span><h4><a class="toc-backref" href="#id115">5.3.2.  JWK Parameters for RSA Private Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent RSA public keys,
the following members are used to represent RSA private keys.</p>
<p>All are REQUIRED for RSA private keys except for &#8220;oth&#8221;,
which is sometimes REQUIRED and sometimes MUST NOT be present,
as described below.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2</a> )</p>
<div class="section" id="d-private-exponent-parameter">
<span id="jwa-5-3-2-1"></span><h5><a class="toc-backref" href="#id116">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a><a class="headerlink" href="#d-private-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (<strong>private exponent</strong>) member contains
the private exponent value for the RSA <strong>private key</strong>.</p>
<p>It is represented as the base64url encoding
of the value&#8217;s unsigned big endian representation as an octet
sequence.
The array representation MUST NOT be shortened to omit any
leading zero octets.  For instance, when representing 2048 bit
integers, the octet sequence to be base64url encoded MUST contain 256
octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1</a> )</p>
</div>
<div class="section" id="p-first-prime-factor-parameter">
<span id="jwa-5-3-2-2"></span><h5><a class="toc-backref" href="#id117">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a><a class="headerlink" href="#p-first-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p&#8221; (<strong>first prime factor</strong>) member contains the first prime factor,
a <strong>positive integer</strong>.
It is represented as the base64url encoding of
the value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2</a> )</p>
</div>
<div class="section" id="q-second-prime-factor-parameter">
<span id="jwa-5-3-2-3"></span><h5><a class="toc-backref" href="#id118">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a><a class="headerlink" href="#q-second-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;q&#8221; (<strong>second prime factor</strong>) member contains the second prime
factor, a <strong>positive integer</strong>.</p>
<p>It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3</a> )</p>
</div>
<div class="section" id="dp-first-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-4"></span><h5><a class="toc-backref" href="#id119">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dp-first-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (<strong>first factor CRT exponent</strong>) member contains
the Chinese Remainder Theorem (CRT) exponent of the first factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4</a> )</p>
</div>
<div class="section" id="dq-second-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-5"></span><h5><a class="toc-backref" href="#id120">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dq-second-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dq&#8221; (second factor CRT exponent) member contains
the Chinese Remainder Theorem (CRT) exponent of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5</a> )</p>
</div>
<div class="section" id="qi-first-crt-coefficient-parameter">
<span id="jwa-5-3-2-6"></span><h5><a class="toc-backref" href="#id121">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a><a class="headerlink" href="#qi-first-crt-coefficient-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first CRT coefficient) member contains
the Chinese Remainder Theorem (CRT) coefficient of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6</a> )</p>
</div>
<div class="section" id="oth-other-primes-info-parameter">
<span id="jwa-5-3-2-7"></span><h5><a class="toc-backref" href="#id122">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><a class="headerlink" href="#oth-other-primes-info-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;oth&#8221; (other primes info) member contains an array of information
about any third and subsequent primes, should they exist.  When only
two primes have been used (the normal case), this parameter MUST be
omitted.  When three or more primes have been used, the number of
array elements MUST be the number of primes used minus two.  Each
array element MUST be an object with the following members:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7</a> )</p>
<div class="section" id="r-prime-factor">
<span id="jwa-5-3-2-7-1"></span><h6><a class="toc-backref" href="#id123">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a><a class="headerlink" href="#r-prime-factor" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;r&#8221; (prime factor) parameter within an &#8220;oth&#8221; array member
represents the value of a subsequent prime factor, a positive
integer.  It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1</a> )</p>
</div>
<div class="section" id="d-factor-crt-exponent">
<span id="jwa-5-3-2-7-2"></span><h6><a class="toc-backref" href="#id124">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a><a class="headerlink" href="#d-factor-crt-exponent" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;d&#8221; (Factor CRT Exponent) parameter within an &#8220;oth&#8221; array member
represents the CRT exponent of the corresponding prime factor, a
positive integer.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2</a> )</p>
</div>
<div class="section" id="t-factor-crt-coefficient">
<span id="jwa-5-3-2-7-3"></span><h6><a class="toc-backref" href="#id125">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a><a class="headerlink" href="#t-factor-crt-coefficient" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;t&#8221; (factor CRT coefficient) parameter within an &#8220;oth&#8221; array
member represents the CRT coefficient of the corresponding prime
factor, a positive integer.  It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3</a> )</p>
</div>
</div>
</div>
</div>
<div class="section" id="additional-key-algorithm-families-and-parameters">
<span id="jwa-5-3-3"></span><h3><a class="toc-backref" href="#id126">5.4. Additional Key Algorithm Families and Parameters</a><a class="headerlink" href="#additional-key-algorithm-families-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Public keys using additional algorithm families MAY be represented
using JWK data structures with corresponding &#8220;alg&#8221; (algorithm family)
parameter values being defined to refer to them.  New &#8220;alg&#8221; parameter
values SHOULD either be registered in the IANA JSON Web Key Algorithm
Families registry Section 6.2 or be a URI that contains a Collision
Resistant Namespace.</p>
<p>Likewise, parameters for representing keys for additional algorithm
families or additional key properties SHOULD either be registered in
the IANA JSON Web Key Parameters registry [JWK] or be a URI that
contains a Collision Resistant Namespace.</p>
<p>(draft 05 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-05#section-5.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-05#section-5.4</a> )</p>
<p>The &#8220;k&#8221; (key value) member contains the value of the symmetric (or
other single-valued) key.  It is represented as the base64url
encoding of the octet sequence containing the key value.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.3.3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.3.3.1</a> )</p>
</div>
<div class="section" id="additional-key-types-and-parameters">
<span id="jwa-5-4"></span><h3><a class="toc-backref" href="#id127">5.4.  Additional Key Types and Parameters</a><a class="headerlink" href="#additional-key-types-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Keys using additional key types can be represented using JWK data
structures with corresponding &#8220;kty&#8221; (key type) parameter values being
defined to refer to them.  New &#8220;kty&#8221; parameter values SHOULD either
be registered in the IANA JSON Web Key Types registry Section 6.2 or
be a value that contains a Collision Resistant Namespace.</p>
<p>Likewise, parameters for representing keys for additional key types
or additional key properties SHOULD either be registered in the IANA
JSON Web Key Parameters registry [JWK] or be a value that contains a
Collision Resistant Namespace.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.4</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-keys">
<span id="jwa-6"></span><h2><a class="toc-backref" href="#id128">6. Cryptographic Algorithms for Keys</a><a class="headerlink" href="#cryptographic-algorithms-for-keys" title="Permalink to this headline">¶</a></h2>
<p>A JSON Web Key (JWK) [JWK] is a JSON data structure that represents a
cryptographic key.  These keys can be either asymmetric or symmetric.
They can hold both public and private information about the key.
This section defines the parameters for keys using the algorithms
specified by this document.</p>
<p>(draft20)</p>
<p id="jwa-6-1">6.1. &#8220;kty&#8221; (Key Type) Parameter Values</p>
<p>The table below is the set of &#8220;kty&#8221; (key type) parameter values that
are defined by this specification for use in JWKs.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="49%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>kty
Parameter
Value</td>
<td>Key Type</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>EC</td>
<td>Elliptic Curve [DSS]</td>
<td>Recommended+</td>
</tr>
<tr class="row-odd"><td>RSA</td>
<td>RSA [RFC3447]</td>
<td>Required</td>
</tr>
<tr class="row-even"><td>oct</td>
<td>Octet sequence (used to
represent symmetric keys)</td>
<td>Required</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>(draft20)</p>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  This name is case
sensitive.  Names that match other registered names in a case
insensitive manner SHOULD NOT be accepted.</dd>
<dt>Algorithm Usage Location(s):</dt>
<dd>The algorithm usage, which must be one or more of the values &#8220;alg&#8221;
or &#8220;enc&#8221;.</dd>
<dt>Implementation Requirements:</dt>
<dd>The algorithm implementation requirements, which must be one the
words REQUIRED, RECOMMENDED, OPTIONAL, or DEPRECATED.  Optionally,
the word can be followed by a &#8220;+&#8221; or &#8220;-&#8221;.  The use of &#8220;+&#8221;
indicates that the requirement strength is likely to be increased
in a future version of the specification.  The use of &#8220;-&#8221;
indicates that the requirement strength is likely to be decreased
in a future version of the specification.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IETF&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.1</a> )</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Name: &#8220;HS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;HS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;HS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;none&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RSA1_5&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RSA-OAEP&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;dir&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128CBC-HS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192CBC-HS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256CBC-HS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
</ul>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.2</a> )</p>
<div class="section" id="parameters-for-elliptic-curve-keys">
<span id="jwa-6-2"></span><h3><a class="toc-backref" href="#id129">6.2. Parameters for Elliptic Curve Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent Elliptic Curve [DSS] keys.  In this case, the
&#8220;kty&#8221; member value MUST be &#8220;EC&#8221;.</p>
<p>(draft20)</p>
<div class="section" id="parameters-for-elliptic-curve-public-keys">
<span id="jwa-6-2-1"></span><h4><a class="toc-backref" href="#id130">6.2.1. Parameters for Elliptic Curve Public Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-public-keys" title="Permalink to this headline">¶</a></h4>
<p>An elliptic curve public key is represented by a pair of coordinates
drawn from a finite field, which together define a point on an
elliptic curve.  The following members MUST be present for elliptic
curve public keys:</p>
<blockquote>
<div><p>o  &#8220;crv&#8221;</p>
<p>o  &#8220;x&#8221;</p>
<p>o  &#8220;y&#8221;</p>
</div></blockquote>
<p>SEC1 [SEC1] point compression is not supported for any values.</p>
<p>(draft20)</p>
<div class="section" id="jwa-6-2-1-1">
<span id="id17"></span><h5><a class="toc-backref" href="#id131">6.2.1.1. &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#jwa-6-2-1-1" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;crv&#8221; (curve) member identifies the cryptographic curve used with
the key.  Curve values from [DSS] used by this specification are:</p>
<blockquote>
<div><p>o  &#8220;P-256&#8221;</p>
<p>o  &#8220;P-384&#8221;</p>
<p>o  &#8220;P-521&#8221;</p>
</div></blockquote>
<p>These values are registered in the IANA JSON Web Key Elliptic Curve
registry defined in Section 7.6.  Additional &#8220;crv&#8221; values MAY be
used, provided they are understood by implementations using that
Elliptic Curve key.  The &#8220;crv&#8221; value is a case-sensitive string.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-2-1-2">
<span id="id18"></span><h5><a class="toc-backref" href="#id132">6.2.1.2. &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#jwa-6-2-1-2" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the octet string representation of the coordinate, as defined in
Section 2.3.5 of SEC1 [SEC1].  The length of this octet string MUST
be the full size of a coordinate for the curve specified in the &#8220;crv&#8221;
parameter.  For example, if the value of &#8220;crv&#8221; is &#8220;P-521&#8221;, the octet
string must be 66 octets long.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-2-1-3">
<span id="id19"></span><h5><a class="toc-backref" href="#id133">6.2.1.3. &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#jwa-6-2-1-3" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the octet string representation of the coordinate, as defined in
Section 2.3.5 of SEC1 [SEC1].  The length of this octet string MUST
be the full size of a coordinate for the curve specified in the &#8220;crv&#8221;
parameter.</p>
<p>For example, if the value of &#8220;crv&#8221; is &#8220;P-521&#8221;, the octet
string must be 66 octets long.</p>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="parameters-for-elliptic-curve-private-keys">
<span id="jwa-6-2-2"></span><h4><a class="toc-backref" href="#id134">6.2.2. Parameters for Elliptic Curve Private Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent Elliptic Curve public
keys, the following member MUST be present to represent Elliptic
Curve private keys.</p>
<p>(draft20)</p>
<div class="section" id="d-ecc-private-key-parameter">
<span id="jwa-6-2-2-1"></span><h5><a class="toc-backref" href="#id135">6.2.2.1. &#8220;d&#8221; (ECC Private Key) Parameter</a><a class="headerlink" href="#d-ecc-private-key-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (ECC private key) member contains the Elliptic Curve private
key value.  It is represented as the base64url encoding of the octet
string representation of the private key value, as defined in
Sections C.4 and 2.3.7 of SEC1 [SEC1].  The length of this octet
string MUST be ceiling(log-base-2(n)/8) octets (where n is the order
of the curve).</p>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="parameters-for-rsa-keys">
<span id="jwa-6-3"></span><h3><a class="toc-backref" href="#id136">6.3. Parameters for RSA Keys</a><a class="headerlink" href="#parameters-for-rsa-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent RSA [RFC3447] keys.
In this case, the &#8220;kty&#8221; member value MUST be &#8220;RSA&#8221;.</p>
<p>(draft20)</p>
<div class="section" id="parameters-for-rsa-public-keys">
<span id="jwa-6-3-1"></span><h4><a class="toc-backref" href="#id137">6.3.1. Parameters for RSA Public Keys</a><a class="headerlink" href="#parameters-for-rsa-public-keys" title="Permalink to this headline">¶</a></h4>
<p>The following members MUST be present for RSA public keys.</p>
<p>(draft20)</p>
<div class="section" id="jwa-6-3-1-1">
<span id="id20"></span><h5><a class="toc-backref" href="#id138">6.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a><a class="headerlink" href="#jwa-6-3-1-1" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;n&#8221; (<a class="reference internal" href="#term-modulus"><em class="xref std std-term">modulus</em></a>) member contains the modulus value for the RSA
public key.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-1-2">
<span id="id21"></span><h5><a class="toc-backref" href="#id139">6.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a><a class="headerlink" href="#jwa-6-3-1-2" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;e&#8221; (<a class="reference internal" href="#term-exponent"><em class="xref std std-term">exponent</em></a>) member contains the exponent value for the RSA
public key.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</p>
<p>For instance, when representing the value 65537, the
octet sequence to be base64url encoded MUST consist of the three
octets [1, 0, 1].</p>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="parameters-for-rsa-private-keys">
<span id="jwa-6-3-2"></span><h4><a class="toc-backref" href="#id140">6.3.2. Parameters for RSA Private Keys</a><a class="headerlink" href="#parameters-for-rsa-private-keys" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>In addition to the members used to represent RSA public keys, the
following members are used to represent RSA private keys.  The
parameter &#8220;d&#8221; is REQUIRED for RSA private keys.  The others enable
optimizations and SHOULD be included by producers of JWKs
representing RSA private keys.  If the producer includes any of the
other private key parameters, then all of the others MUST be present,
with the exception of &#8220;oth&#8221;, which MUST only be present when more
than two prime factors were used.  The consumer of a JWK MAY choose
to accept an RSA private key that does not contain a complete set of
the private key parameters other than &#8220;d&#8221;, including JWKs in which
&#8220;d&#8221; is the only RSA private key parameter included.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-6-3-2-1">
<span id="id22"></span><h5><a class="toc-backref" href="#id141">6.3.2.1. &#8220;d&#8221; (Private Exponent) Parameter</a><a class="headerlink" href="#jwa-6-3-2-1" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;d&#8221; (private exponent) member contains the private exponent value
for the RSA private key.  It is represented as the base64url encoding
of the value&#8217;s unsigned big endian representation as an octet
sequence.  The octet sequence MUST utilize the minimum number of
octets to represent the value.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-2">
<span id="id23"></span><h5><a class="toc-backref" href="#id142">6.3.2.2. &#8220;p&#8221; (First Prime Factor) Parameter</a><a class="headerlink" href="#jwa-6-3-2-2" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;p&#8221; (first prime factor) member contains the first prime factor,
a positive integer.  It is represented as the base64url encoding of
the value&#8217;s unsigned big endian representation as an octet sequence.
The octet sequence MUST utilize the minimum number of octets to
represent the value.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-3">
<span id="id24"></span><h5><a class="toc-backref" href="#id143">6.3.2.3. &#8220;q&#8221; (Second Prime Factor) Parameter</a><a class="headerlink" href="#jwa-6-3-2-3" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;q&#8221; (second prime factor) member contains the second prime
factor, a positive integer.  It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.  The octet sequence MUST utilize the minimum number
of octets to represent the value.</p>
<p>(draft20)</p>
<p id="jwa-6-3-2-4">6.3.2.4. &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</p>
<p>The &#8220;dp&#8221; (first factor CRT exponent) member contains
the <a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) exponent of the first factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.
The octet sequence MUST utilize the minimum number of octets
to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-5">
<span id="id25"></span><h5><a class="toc-backref" href="#id144">6.3.2.5. &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a><a class="headerlink" href="#jwa-6-3-2-5" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dq&#8221; (second factor CRT exponent) member contains
the <a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) exponent of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>The octet sequence MUST utilize the minimum number of octets
to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-6">
<span id="id26"></span><h5><a class="toc-backref" href="#id145">6.3.2.6. &#8220;qi&#8221; (First CRT Coefficient) Parameter</a><a class="headerlink" href="#jwa-6-3-2-6" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first CRT coefficient) member contains the
<a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) <a class="reference internal" href="#term-coefficient"><em class="xref std std-term">coefficient</em></a> of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.  The octet
sequence MUST utilize the minimum number of octets to represent the
value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-7">
<span id="id27"></span><h5><a class="toc-backref" href="#id146">6.3.2.7. &#8220;oth&#8221; (Other Primes Info) Parameter</a><a class="headerlink" href="#jwa-6-3-2-7" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;oth&#8221; (other primes info) member contains an array of information
about any third and subsequent primes, should they exist.  When only
two primes have been used (the normal case), this parameter MUST be
omitted.  When three or more primes have been used, the number of
array elements MUST be the number of primes used minus two.  Each
array element MUST be an object with the following members:</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-6-3-2-7-1">
<span id="id28"></span><h6><a class="toc-backref" href="#id147">6.3.2.7.1. &#8220;r&#8221; (Prime Factor)</a><a class="headerlink" href="#jwa-6-3-2-7-1" title="Permalink to this headline">¶</a></h6>
<blockquote>
<div>The &#8220;r&#8221; (<a class="reference internal" href="#term-prime-factor"><em class="xref std std-term">prime factor</em></a>) parameter within an &#8220;oth&#8221; array member
represents the value of a subsequent prime factor, a positive
integer.  It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.  The octet
sequence MUST utilize the minimum number of octets to represent the
value.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-7-2">
<span id="id29"></span><h6><a class="toc-backref" href="#id148">6.3.2.7.2. &#8220;d&#8221; (Factor CRT Exponent)</a><a class="headerlink" href="#jwa-6-3-2-7-2" title="Permalink to this headline">¶</a></h6>
<blockquote>
<div>The &#8220;d&#8221; (Factor CRT Exponent) parameter within an &#8220;oth&#8221; array member
represents the CRT exponent of the corresponding prime factor, a
positive integer.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-6-3-2-7-3">
<span id="id30"></span><h6><a class="toc-backref" href="#id149">6.3.2.7.3. &#8220;t&#8221; (Factor CRT Coefficient)</a><a class="headerlink" href="#jwa-6-3-2-7-3" title="Permalink to this headline">¶</a></h6>
<blockquote>
<div>The &#8220;t&#8221; (factor CRT coefficient) parameter within an &#8220;oth&#8221; array
member represents the CRT coefficient of the corresponding prime
factor, a positive integer.  It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.  The octet sequence MUST utilize the minimum number
of octets to represent the value.</div></blockquote>
<p>(draft20)</p>
</div>
</div>
</div>
</div>
<div class="section" id="parameters-for-symmetric-keys">
<span id="jwa-6-4"></span><h3><a class="toc-backref" href="#id150">6.4. Parameters for Symmetric Keys</a><a class="headerlink" href="#parameters-for-symmetric-keys" title="Permalink to this headline">¶</a></h3>
<p>When the JWK &#8220;kty&#8221; member value is &#8220;oct&#8221; (octet sequence),
the member &#8220;k&#8221; is used to represent a symmetric key
(or another key whose value is a single octet sequence).</p>
<p>An &#8220;alg&#8221; member SHOULD also be present
to identify the algorithm intended to be used with the key,
unless the application uses another means
or convention to determine the algorithm used.</p>
<p>(draft20)</p>
<div class="section" id="k-key-value-parameter">
<span id="jwa-6-4-1"></span><h4><a class="toc-backref" href="#id151">6.4.1. &#8220;k&#8221; (Key Value) Parameter</a><a class="headerlink" href="#k-key-value-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;k&#8221; (key value) member contains the value of the symmetric (or
other single-valued) key.  It is represented as the base64url
encoding of the octet sequence containing the key value.</p>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jwa-7"></span><h2><a class="toc-backref" href="#id152">7. IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The following registration procedure is used for all the registries
established by this specification.</p>
<p>Values are registered with a Specification Required [RFC5226] after a
two-week review period on the [TBD]&#64;ietf.org mailing list, on the
advice of one or more Designated Experts.  However, to allow for the
allocation of values prior to publication, the Designated Expert(s)
may approve registration once they are satisfied that such a
specification will be published.</p>
<p>Registration requests must be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject (e.g., &#8220;Request
for access token type: example&#8221;). [[ Note to the RFC Editor: The name
of the mailing list should be determined in consultation with the
IESG and IANA.  Suggested name: jose-reg-review. ]]</p>
<p>Within the review period, the Designated Expert(s) will either
approve or deny the registration request, communicating this decision
to the review list and IANA.  Denials should include an explanation
and, if applicable, suggestions as to how to make the request
successful.  Registration requests that are undetermined for a period
longer than 21 days can be brought to the IESG&#8217;s attention (using the
<a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list) for resolution.</p>
<p>Criteria that should be applied by the Designated Expert(s) includes
determining whether the proposed registration duplicates existing
functionality, determining whether it is likely to be of general
applicability or whether it is useful only for a single application,
and whether the registration makes sense.</p>
<p>IANA must only accept registry updates from the Designated Expert(s)
and should direct all requests for registration to the review mailing
list.</p>
<p>It is suggested that multiple Designated Experts be appointed who are
able to represent the perspectives of different applications using
this specification, in order to enable broadly-informed review of
registration decisions.  In cases where a registration decision could
be perceived as creating a conflict of interest for a particular
Expert, that Expert should defer to the judgment of the other</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="json-web-signature-and-encryption-algorithms-registry">
<span id="jwa-7-1"></span><h3><a class="toc-backref" href="#id153">7.1. JSON Web Signature and Encryption Algorithms Registry</a><a class="headerlink" href="#json-web-signature-and-encryption-algorithms-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This specification establishes the IANA JSON Web Signature and
Encryption Algorithms registry for values of the JWS and JWE &#8220;alg&#8221;
(algorithm) and &#8220;enc&#8221; (encryption algorithm) Header Parameters.  The
registry records the algorithm name, the algorithm usage locations,
implementation requirements, and a reference to the specification
that defines it.  The same algorithm name can be registered multiple
times, provided that the sets of usage locations are disjoint.</p>
<p>It is suggested that when algorithms can use keys of different
lengths, that the length of the key be included in the algorithm
name.  This allows readers of the JSON text to easily make security
consideration decisions.</p>
<p>The implementation requirements of an algorithm MAY be changed over
time by the Designated Experts(s) as the cryptographic landscape
evolves, for instance, to change the status of an algorithm to
Deprecated, or to change the status of an algorithm from Optional to
Recommended+ or Required.  Changes of implementation requirements are
only permitted on a Specification Required basis, with the new
specification defining the revised implementation requirements level.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="registration-template">
<span id="jwa-7-1-1"></span><h4><a class="toc-backref" href="#id154">7.1.1. Registration Template</a><a class="headerlink" href="#registration-template" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  This name is case-
sensitive.  Names may not match other registered names in a case-
insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Algorithm Description:</dt>
<dd>Brief description of the Algorithm (e.g., &#8220;Example description&#8221;).</dd>
<dt>Algorithm Usage Location(s):</dt>
<dd>The algorithm usage location.  This must be one or more of the
values &#8220;alg&#8221; or &#8220;enc&#8221; if the algorithm is to be used with JWS or
JWE.  The value &#8220;JWK&#8221; is used if the algorithm identifier will be
used as a JWK &#8220;alg&#8221; member value, but will not be used with JWS or
JWE; this could be the case, for instance, for non-authenticated
encryption algorithms.  Other values may be used with the approval
of a Designated Expert.</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The algorithm implementation requirements for JWS and JWE, which
must be one the words Required, Recommended, Optional, Deprecated,
or Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or
&#8220;-&#8221;.  The use of &#8220;+&#8221; indicates that the requirement strength is
likely to be increased in a future version of the specification.
The use of &#8220;-&#8221; indicates that the requirement strength is likely
to be decreased in a future version of the specification.  Any
identifiers registered for non-authenticated encryption algorithms
or other algorithms that are otherwise unsuitable for direct use
as JWS or JWE algorithms must be registered as &#8220;Prohibited&#8221;.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="initial-registry-contents">
<span id="jwa-7-1-2"></span><h4><a class="toc-backref" href="#id155">7.1.2. Initial Registry Contents</a><a class="headerlink" href="#initial-registry-contents" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Algorithm Name: &#8220;HS256&#8221;
o  Algorithm Description: HMAC using SHA-256
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;HS384&#8221;
o  Algorithm Description: HMAC using SHA-384
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;HS512&#8221;
o  Algorithm Description: HMAC using SHA-512
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;RS256&#8221;
o  Algorithm Description: RSASSA-PKCS-v1_5 using SHA-256
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;RS384&#8221;
o  Algorithm Description: RSASSA-PKCS-v1_5 using SHA-384
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;RS512&#8221;
o  Algorithm Description: RSASSA-PKCS-v1_5 using SHA-512
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ES256&#8221;
o  Algorithm Description: ECDSA using P-256 and SHA-256
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ES384&#8221;
o  Algorithm Description: ECDSA using P-384 and SHA-384
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ES512&#8221;
o  Algorithm Description: ECDSA using P-521 and SHA-512
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PS256&#8221;
o  Algorithm Description: RSASSA-PSS using SHA-256 and MGF1 with SHA-</p>
<blockquote>
<div>256</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PS384&#8221;
o  Algorithm Description: RSASSA-PSS using SHA-384 and MGF1 with SHA-</p>
<blockquote>
<div>384</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PS512&#8221;
o  Algorithm Description: RSASSA-PSS using SHA-512 and MGF1 with SHA-</p>
<blockquote>
<div>512</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;none&#8221;
o  Algorithm Description: No digital signature or MAC performed
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 3.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;RSA1_5&#8221;
o  Algorithm Description: RSAES-PKCS1-V1_5
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;RSA-OAEP&#8221;
o  Algorithm Description: RSAES using OAEP with default parameters
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A128KW&#8221;
o  Algorithm Description: AES Key Wrap using 128 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A192KW&#8221;
o  Algorithm Description: AES Key Wrap using 192 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A256KW&#8221;
o  Algorithm Description: AES Key Wrap using 256 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;dir&#8221;
o  Algorithm Description: Direct use of a shared symmetric key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ECDH-ES&#8221;
o  Algorithm Description: ECDH-ES using Concat KDF
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ECDH-ES+A128KW&#8221;
o  Algorithm Description: ECDH-ES using Concat KDF and &#8220;A128KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ECDH-ES+A192KW&#8221;
o  Algorithm Description: ECDH-ES using Concat KDF and &#8220;A192KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;ECDH-ES+A256KW&#8221;
o  Algorithm Description: ECDH-ES using Concat KDF and &#8220;A256KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 4.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A128GCMKW&#8221;
o  Algorithm Description: Key wrapping with AES GCM using 128 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.7 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A192GCMKW&#8221;
o  Algorithm Description: Key wrapping with AES GCM using 192 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.7 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A256GCMKW&#8221;
o  Algorithm Description: Key wrapping with AES GCM using 256 bit key
o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.7 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PBES2-HS256+A128KW&#8221;
o  Algorithm Description: PBES2 with HMAC SHA-256 and &#8220;A128KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.8 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PBES2-HS384+A192KW&#8221;
o  Algorithm Description: PBES2 with HMAC SHA-384 and &#8220;A192KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.8 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;PBES2-HS512+A256KW&#8221;
o  Algorithm Description: PBES2 with HMAC SHA-512 and &#8220;A256KW&#8221;</p>
<blockquote>
<div>wrapping</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;alg&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 4.8 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A128CBC-HS256&#8221;
o  Algorithm Description: AES_128_CBC_HMAC_SHA_256 authenticated</p>
<blockquote>
<div>encryption algorithm</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A192CBC-HS384&#8221;
o  Algorithm Description: AES_192_CBC_HMAC_SHA_384 authenticated</p>
<blockquote>
<div>encryption algorithm</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A256CBC-HS512&#8221;
o  Algorithm Description: AES_256_CBC_HMAC_SHA_512 authenticated</p>
<blockquote>
<div>encryption algorithm</div></blockquote>
<p>o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A128GCM&#8221;
o  Algorithm Description: AES GCM using 128 bit key
o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A192GCM&#8221;
o  Algorithm Description: AES GCM using 192 bit key
o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
<p>o  Algorithm Name: &#8220;A256GCM&#8221;
o  Algorithm Description: AES GCM using 256 bit key
o  Algorithm Usage Location(s): &#8220;enc&#8221;
o  JOSE Implementation Requirements: Recommended
o  Change Controller: IESG
o  Specification Document(s): Section 5.1 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="jwe-header-parameter-names-registration">
<span id="jwa-7-2"></span><h3><a class="toc-backref" href="#id156">7.2. JWE Header Parameter Names Registration</a><a class="headerlink" href="#jwe-header-parameter-names-registration" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This specification registers the Header Parameter names defined in
Section 4.6.1, Section 4.7.1, and Section 4.8.1 in the IANA JSON Web
Signature and Encryption Header Parameters registry defined in [JWS].</div></blockquote>
<p>(draft20)</p>
<div class="section" id="registry-contents">
<span id="jwa-7-2-1"></span><h4><a class="toc-backref" href="#id157">7.2.1. Registry Contents</a><a class="headerlink" href="#registry-contents" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Header Parameter Name: &#8220;epk&#8221;
o  Header Parameter Description: Ephemeral Public Key
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;apu&#8221;
o  Header Parameter Description: Agreement PartyUInfo
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.2 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;apv&#8221;
o  Header Parameter Description: Agreement PartyVInfo
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.3 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;iv&#8221;
o  Header Parameter Description: Initialization Vector
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.7.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;tag&#8221;
o  Header Parameter Description: Authentication Tag
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.7.1.2 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;p2s&#8221;
o  Header Parameter Description: PBES2 salt
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.8.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;p2c&#8221;
o  Header Parameter Description: PBES2 count
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.8.1.2 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-encryption-compression-algorithms-registry">
<span id="jwa-7-3"></span><h3><a class="toc-backref" href="#id158">7.3. JSON Web Encryption Compression Algorithms Registry</a><a class="headerlink" href="#json-web-encryption-compression-algorithms-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This specification establishes the IANA JSON Web Encryption
Compression Algorithms registry for JWE &#8220;zip&#8221; member values.  The
registry records the compression algorithm value and a reference to
the specification that defines it.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-3-1">
<span id="id31"></span><h4><a class="toc-backref" href="#id159">7.3.1. Registration Template</a><a class="headerlink" href="#jwa-7-3-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Compression Algorithm Value:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Compression Algorithm Description:</dt>
<dd>Brief description of the compression algorithm (e.g., &#8220;Example
description&#8221;).</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-3-2">
<span id="id32"></span><h4><a class="toc-backref" href="#id160">7.3.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-3-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>o  Compression Algorithm Value: &#8220;DEF&#8221;
o  Compression Algorithm Description: DEFLATE
o  Change Controller: IESG
o  Specification Document(s): JSON Web Encryption (JWE) [JWE]</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-types-registry">
<span id="jwa-7-4"></span><h3><a class="toc-backref" href="#id161">7.4. JSON Web Key Types Registry</a><a class="headerlink" href="#json-web-key-types-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This specification establishes the IANA JSON Web Key Types registry
for values of the JWK &#8220;kty&#8221; (key type) parameter.  The registry
records the &#8220;kty&#8221; value, implementation requirements, and a reference
to the specification that defines it.</p>
<p>The implementation requirements of a key type MAY be changed over
time by the Designated Experts(s) as the cryptographic landscape
evolves, for instance, to change the status of a key type to
Deprecated, or to change the status of a key type from Optional to
Recommended+ or Required.  Changes of implementation requirements are
only permitted on a Specification Required basis, with the new
specification defining the revised implementation requirements level.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-4-1">
<span id="id33"></span><h4><a class="toc-backref" href="#id162">7.4.1. Registration Template</a><a class="headerlink" href="#jwa-7-4-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;kty&#8221; Parameter Value:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Key Type Description:</dt>
<dd>Brief description of the Key Type (e.g., &#8220;Example description&#8221;).</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The key type implementation requirements for JWS and JWE, which
must be one the words Required, Recommended, Optional, Deprecated,
or Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or
&#8220;-&#8221;.  The use of &#8220;+&#8221; indicates that the requirement strength is
likely to be increased in a future version of the specification.
The use of &#8220;-&#8221; indicates that the requirement strength is likely
to be decreased in a future version of the specification.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-4-2">
<span id="id34"></span><h4><a class="toc-backref" href="#id163">7.4.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-4-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>This specification registers the values defined in Section 6.1.</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;EC&#8221;
o  Key Type Description: Elliptic Curve
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 6.2 of [[ this document ]]</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;RSA&#8221;
o  Key Type Description: RSA
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 6.3 of [[ this document ]]</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;oct&#8221;
o  Key Type Description: Octet sequence
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 6.4 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-parameters-registration">
<span id="jwa-7-5"></span><h3><a class="toc-backref" href="#id164">7.5. JSON Web Key Parameters Registration</a><a class="headerlink" href="#json-web-key-parameters-registration" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This specification registers the parameter names defined in Sections
6.2, 6.3, and 6.4 in the IANA JSON Web Key Parameters registry
defined in [JWK].</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-5-1">
<span id="id35"></span><h4><a class="toc-backref" href="#id165">7.5.1. Registry Contents</a><a class="headerlink" href="#jwa-7-5-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Parameter Name: &#8220;crv&#8221;
o  Parameter Description: Curve
o  Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;
o  Parameter Information Class: Public
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;x&#8221;
o  Parameter Description: X Coordinate
o  Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;
o  Parameter Information Class: Public
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.2 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;y&#8221;
o  Parameter Description: Y Coordinate
o  Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;
o  Parameter Information Class: Public
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.3 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;d&#8221;
o  Parameter Description: ECC Private Key
o  Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.2.1 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;n&#8221;
o  Parameter Description: Modulus
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Public
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.1.1 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;e&#8221;
o  Parameter Description: Exponent
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</p>
</div></blockquote>
<p>Jones                     Expires July 24, 2014                [Page 44]</p>
<p>Internet-Draft          JSON Web Algorithms (JWA)           January 2014</p>
<blockquote>
<div><p>o  Parameter Information Class: Public
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.1.2 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;d&#8221;
o  Parameter Description: Private Exponent
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.1 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;p&#8221;
o  Parameter Description: First Prime Factor
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.2 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;q&#8221;
o  Parameter Description: Second Prime Factor
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.3 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;dp&#8221;
o  Parameter Description: First Factor CRT Exponent
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.4 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;dq&#8221;
o  Parameter Description: Second Factor CRT Exponent
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.5 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;qi&#8221;
o  Parameter Description: First CRT Coefficient
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.6 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;oth&#8221;
o  Parameter Description: Other Primes Info
o  Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.3.2.7 of [[ this document ]]</p>
<p>o  Parameter Name: &#8220;k&#8221;
o  Parameter Description: Key Value
o  Used with &#8220;kty&#8221; Value(s): &#8220;oct&#8221;
o  Parameter Information Class: Private
o  Change Controller: IESG
o  Specification Document(s): Section 6.4.1 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-elliptic-curve-registry">
<span id="jwa-7-6"></span><h3><a class="toc-backref" href="#id166">7.6. JSON Web Key Elliptic Curve Registry</a><a class="headerlink" href="#json-web-key-elliptic-curve-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This specification establishes the IANA JSON Web Key Elliptic Curve
registry for JWK &#8220;crv&#8221; member values.  The registry records the curve
name, implementation requirements, and a reference to the
specification that defines it.  This specification registers the
parameter names defined in Section 6.2.1.1.</p>
<p>The implementation requirements of a curve MAY be changed over time
by the Designated Experts(s) as the cryptographic landscape evolves,
for instance, to change the status of a curve to Deprecated, or to
change the status of a curve from Optional to Recommended+ or
Required.  Changes of implementation requirements are only permitted
on a Specification Required basis, with the new specification
defining the revised implementation requirements level.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-6-1">
<span id="id36"></span><h4><a class="toc-backref" href="#id167">7.6.1. Registration Template</a><a class="headerlink" href="#jwa-7-6-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Curve Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Curve Description:</dt>
<dd>Brief description of the curve (e.g., &#8220;Example description&#8221;).</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The curve implementation requirements for JWS and JWE, which must
be one the words Required, Recommended, Optional, Deprecated, or
Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or &#8220;-&#8221;.
The use of &#8220;+&#8221; indicates that the requirement strength is likely
to be increased in a future version of the specification.  The use
of &#8220;-&#8221; indicates that the requirement strength is likely to be
decreased in a future version of the specification.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-6-2">
<span id="id37"></span><h4><a class="toc-backref" href="#id168">7.6.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-6-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Curve Name: &#8220;P-256&#8221;
o  Curve Description: P-256 curve
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
<p>o  Curve Name: &#8220;P-384&#8221;
o  Curve Description: P-384 curve
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
<p>o  Curve Name: &#8220;P-521&#8221;
o  Curve Description: P-521 curve
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="security-considerations">
<span id="jwa-8"></span><h2><a class="toc-backref" href="#id169">8. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>All of the security issues faced by any cryptographic application
must be faced by a JWS/JWE/JWK agent.  Among these issues are
protecting the user&#8217;s private and symmetric keys, preventing various
attacks, and helping the user avoid mistakes such as inadvertently
encrypting a message for the wrong recipient.  The entire list of
security considerations is beyond the scope of this document, but
some significant considerations are listed here.</p>
<p>The security considerations in [AES], [DSS], [JWE], [JWK], [JWS],
[NIST.800-38A], [NIST.800-38D], [NIST.800-56A], [RFC2104], [RFC3394],
[RFC3447], [RFC5116], [RFC6090], and [SHS] apply to this
specification.</p>
<p>Algorithms of matching strengths should be used together whenever
possible.  For instance, when AES Key Wrap is used with a given key
size, using the same key size is recommended when AES GCM is also
used.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="algorithms-and-key-sizes-will-be-deprecated">
<span id="jwa-8-1"></span><h3><a class="toc-backref" href="#id170">8.1. Algorithms and Key Sizes will be Deprecated</a><a class="headerlink" href="#algorithms-and-key-sizes-will-be-deprecated" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Eventually the algorithms and/or key sizes currently described in
this specification will no longer be considered sufficiently secure
and will be deprecated.  Therefore, implementers and deployments must
be prepared for this eventuality.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="key-lifetimes">
<span id="jwa-8-2"></span><h3><a class="toc-backref" href="#id171">8.2. Key Lifetimes</a><a class="headerlink" href="#key-lifetimes" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Many algorithms have associated security considerations related to
key lifetimes and/or the number of times that a key may be used.
Those security considerations continue to apply when using those
algorithms with JOSE data structures.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="rsaes-pkcs1-v1-5-security-considerations">
<span id="jwa-8-3"></span><h3><a class="toc-backref" href="#id172">8.3. RSAES-PKCS1-v1_5 Security Considerations</a><a class="headerlink" href="#rsaes-pkcs1-v1-5-security-considerations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>While Section 8 of RFC 3447 [RFC3447] explicitly calls for people not
to adopt RSASSA-PKCS-v1_5 for new applications and instead requests
that people transition to RSASSA-PSS, this specification does include
RSASSA-PKCS-v1_5, for interoperability reasons, because it commonly
implemented.</p>
<p>Keys used with RSAES-PKCS1-v1_5 must follow the constraints in
Section 7.2 of RFC 3447 [RFC3447].  In particular, keys with a low
public key exponent value must not be used.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="aes-gcm-security-considerations">
<span id="jwa-8-4"></span><h3><a class="toc-backref" href="#id173">8.4. AES GCM Security Considerations</a><a class="headerlink" href="#aes-gcm-security-considerations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Keys used with AES GCM must follow the constraints in Section 8.3 of
[NIST.800-38D], which states: &#8220;The total number of invocations of the
authenticated encryption function shall not exceed 2^32, including
all IV lengths and all instances of the authenticated encryption
function with the given key&#8221;.  In accordance with this rule, AES GCM
MUST NOT be used with the same key value more than 2^32 times.</p>
<p>An Initialization Vector value MUST never be used multiple times with
the same AES GCM key.  One way to prevent this is to store a counter
with the key and increment it with every use.  The counter can also
be used to prevent exceeding the 2^32 limit above.</p>
<p>This security consideration does not apply to the composite AES-CBC
HMAC SHA-2 or AES Key Wrap algorithms.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="plaintext-jws-security-considerations">
<span id="jwa-8-5"></span><h3><a class="toc-backref" href="#id174">8.5. Plaintext JWS Security Considerations</a><a class="headerlink" href="#plaintext-jws-security-considerations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Plaintext JWSs (JWSs that use the &#8220;alg&#8221; value &#8220;none&#8221;) provide no
integrity protection.  Thus, they must only be used in contexts where
the payload is secured by means other than a digital signature or MAC
value, or need not be secured.</p>
<p>Implementations that support plaintext JWS objects MUST NOT accept
such objects as valid unless the application specifies that it is
acceptable for a specific object to not be integrity-protected.
Implementations MUST NOT accept plaintext JWS objects by default.
For example, the &#8220;verify&#8221; method of a hypothetical JWS software
library might have a Boolean &#8220;acceptUnsigned&#8221; parameter that
indicates &#8220;none&#8221; is an acceptable &#8220;alg&#8221; value.  As another example,
the &#8220;verify&#8221; method might take a list of algorithms that are
acceptable to the application as a parameter and would reject
plaintext JWS values if &#8220;none&#8221; is not in that list.</p>
<p>In order to mitigate downgrade attacks, applications MUST NOT signal
acceptance of plaintext JWS objects at a global level, and SHOULD
signal acceptance on a per-object basis.  For example, suppose an
application accepts JWS objects over two channels, (1) HTTP and (2)
HTTPS with client authentication.  It requires a JWS signature on
objects received over HTTP, but accepts plaintext JWS objects over
HTTPS.  If the application were to globally indicate that &#8220;none&#8221; is
acceptable, then an attacker could provide it with an unsigned object
over HTTP and still have that object successfully validate.  Instead,
the application needs to indicate acceptance of &#8220;none&#8221; for each
object received over HTTPS (e.g., by setting &#8220;acceptUnsigned&#8221; to
&#8220;true&#8221; for the first hypothetical JWS software library above), but
not for each object received over HTTP.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="differences-between-digital-signatures-and-macs">
<span id="jwa-8-6"></span><h3><a class="toc-backref" href="#id175">8.6. Differences between Digital Signatures and MACs</a><a class="headerlink" href="#differences-between-digital-signatures-and-macs" title="Permalink to this headline">¶</a></h3>
<p>While in many cases, MACs and digital signatures can be used for
integrity checking, there are some significant differences between
the security properties that each of them provides.  These need to be
taken into consideration when designing protocols and selecting the
algorithms to be used in protocols.</p>
<p>Both signatures and MACs provide for integrity checking &#8211;
verifying that the message has not been modified
since the integrity value was computed.</p>
<p>However,
MACs provide for origination identification only under specific circumstances.
It can normally be assumed
that a private key used for a signature is only in the hands of a single entity
(although perhaps a distributed entity, in the case of replicated servers);
however,
a MAC key needs to be in the hands of all the entities
that use it for integrity computation and checking.</p>
<p>This means that origination can only be determined
if a MAC key is known only to two entities
and the receiver knows that it did not create the message.
MAC validation cannot be used to prove origination to a third party.</p>
<p>(draft20)</p>
</div>
<div class="section" id="denial-of-service-attacks">
<span id="jwa-8-7"></span><h3><a class="toc-backref" href="#id176">8.7. Denial of Service Attacks</a><a class="headerlink" href="#denial-of-service-attacks" title="Permalink to this headline">¶</a></h3>
<p><strong>Receiving agents</strong> that validate signatures and
<strong>sending agents</strong> that encrypt messages need to be cautious
of cryptographic processing usage
when validating signatures and encrypting messages
using keys larger than those mandated in this specification.</p>
<p>An attacker could send certificates with keys that
would result in excessive cryptographic processing,
for example,
keys larger than those mandated in this specification,
which could swamp the processing element.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>大きすぎるキーをつかうとか</li>
<li>swamp = 謀殺される</li>
</ul>
</div>
<p>Agents that use such keys without first validating
the certificate to a trust anchor are advised
to have some sort of cryptographic resource management system
to prevent such attacks.</p>
<p>(draft20)</p>
</div>
<div class="section" id="reusing-key-material-when-encrypting-keys">
<span id="jwa-8-8"></span><h3><a class="toc-backref" href="#id177">8.8. Reusing Key Material when Encrypting Keys</a><a class="headerlink" href="#reusing-key-material-when-encrypting-keys" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>It is NOT RECOMMENDED to reuse the same key material (Key Encryption
Key, Content Encryption Key, Initialization Vector, etc.) to encrypt
multiple JWK or JWK Set objects, or to encrypt the same JWK or JWK
Set object multiple times.  One suggestion for preventing re-use is
to always generate a new set key material for each encryption
operation, based on the considerations noted in this document as well
as from [RFC4086].</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="password-considerations">
<span id="jwa-8-9"></span><h3><a class="toc-backref" href="#id178">8.9. Password Considerations</a><a class="headerlink" href="#password-considerations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Passwords are vulnerable to a number of attacks.  To help mitigate
some of these limitations, this document applies principles from
[RFC2898] to derive cryptographic keys from user-supplied passwords.</p>
<p>However, the strength of the password still has a significant impact.
A high-entropy password has greater resistance to dictionary attacks.
[NIST-800-63-1] contains guidelines for estimating password entropy,
which can help applications and users generate stronger passwords.</p>
<p>An ideal password is one that is as large as (or larger than) the
derived key length.  However, passwords larger than a certain
algorithm-specific size are first hashed, which reduces an attacker&#8217;s
effective search space to the length of the hash algorithm.  It is
RECOMMENDED that a password used for &#8220;PBES2-HS256+A128KW&#8221; be no
shorter than 16 octets and no longer than 128 octets and a password
used for &#8220;PBES2-HS512+A256KW&#8221; be no shorter than 32 octets and no
longer than 128 octets long.</p>
<p>Still, care needs to be taken in where and how password-based
encryption is used.  These algorithms can still be susceptible to
dictionary-based attacks if the iteration count is too small; this is
of particular concern if these algorithms are used to protect data
that an attacker can have indefinite number of attempts to circumvent
the protection, such as protected data stored on a file system.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="internationalization-considerations">
<span id="jwa-9"></span><h2><a class="toc-backref" href="#id179">9. Internationalization Considerations</a><a class="headerlink" href="#internationalization-considerations" title="Permalink to this headline">¶</a></h2>
<p>Passwords obtained from users are likely to require preparation and
normalization to account for differences of octet sequences generated
by different input devices, locales, etc.</p>
<p>It is RECOMMENDED that applications to perform the steps outlined in
[I-D.melnikov-precis-saslprepbis] to prepare a password supplied
directly by a user before performing key derivation and encryption.</p>
<p>(draft20)</p>
<div class="section" id="normative-references">
<span id="jwa-9-1"></span><h3><a class="toc-backref" href="#id180">9.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aes">[AES]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-dss">[DSS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Digital
Signature Standard (DSS)&#8221;, FIPS PUB 186-3, June 2009.</dd>
<dt id="term-i-d-melnikov-precis-saslprepbis">[I-D.melnikov-precis-saslprepbis]</dt>
<dd>Saint-Andre, P. and A. Melnikov, &#8220;Preparation and
Comparison of Internationalized Strings Representing
Simple User Names and Passwords&#8221;,
draft-melnikov-precis-saslprepbis-04 (work in progress),
September 2012.</dd>
<dt id="term-60">[JWE]</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, &#8220;JSON Web
Encryption (JWE)&#8221;, draft-ietf-jose-json-web-encryption
(work in progress), July 2013.</dd>
<dt id="term-61">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;,
draft-ietf-jose-json-web-key (work in progress),
July 2013.</dd>
<dt id="term-62">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, draft-ietf-jose-json-web-signature (work
in progress), July 2013.</dd>
<dt id="term-nist-800-38a">[NIST.800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST.800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST.800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography&#8221;, NIST Special
Publication 800-56A, Revision 2, May 2013.</dd>
<dt id="term-rfc2104">[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, &#8220;HMAC: Keyed-
Hashing for Message Authentication&#8221;, RFC 2104,
February 1997.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2898">[RFC2898]</dt>
<dd>Kaliski, B., &#8220;PKCS #5: Password-Based Cryptography
Specification Version 2.0&#8221;, RFC 2898, September 2000.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc4086">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc4868">[RFC4868]</dt>
<dd>Kelly, S. and S. Frankel, &#8220;Using HMAC-SHA-256, HMAC-SHA-
384, and HMAC-SHA-512 with IPsec&#8221;, RFC 4868, May 2007.</dd>
<dt id="term-rfc5116">[RFC5116]</dt>
<dd>McGrew, D., &#8220;An Interface and Algorithms for Authenticated
Encryption&#8221;, RFC 5116, January 2008.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-shs">[SHS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Secure
Hash Standard (SHS)&#8221;, FIPS PUB 180-3, October 2008.</dd>
<dt id="term-usascii">[USASCII]</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.1</a> )</p>
</div>
<div class="section" id="informative-references">
<span id="jwa-9-2"></span><h3><a class="toc-backref" href="#id181">9.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt id="term-i-d-mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</dt>
<dd>McGrew, D., Foley, J., and K. Paterson, &#8220;Authenticated
Encryption with AES-CBC and HMAC-SHA&#8221;,
draft-mcgrew-aead-aes-cbc-hmac-sha2-02 (work in progress),
July 2013.</dd>
<dt id="term-i-d-miller-jose-jwe-protected-jwk">[I-D.miller-jose-jwe-protected-jwk]</dt>
<dd>Miller, M., &#8220;Using JavaScript Object Notation (JSON) Web
Encryption (JWE) for Protecting JSON Web Key (JWK)
Objects&#8221;, draft-miller-jose-jwe-protected-jwk-02 (work in
progress), June 2013.</dd>
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2011.</dd>
<dt id="term-jse">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-magicsignatures">[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt id="term-nist-800-63-1">[NIST-800-63-1]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Electronic Authentication Guideline&#8221;, NIST 800-63-1,
December 2011.</dd>
<dt id="term-rfc2631">[RFC2631]</dt>
<dd>Rescorla, E., &#8220;Diffie-Hellman Key Agreement Method&#8221;,
RFC 2631, June 1999.</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-rfc4122">[RFC4122]</dt>
<dd>Leach, P., Mealling, M., and R. Salz, &#8220;A Universally
Unique IDentifier (UUID) URN Namespace&#8221;, RFC 4122,
July 2005.</dd>
<dt id="term-w3c-cr-xmldsig-core2-20120124">[W3C.CR-xmldsig-core2-20120124]</dt>
<dd>Eastlake, D., Reagle, J., Yiu, K., Solo, D., Datta, P.,
Hirsch, F., Cantor, S., and T. Roessler, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium CR CR-xmldsig-core2-20120124, January 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124">http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124</a>&gt;.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20120313">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Roessler, T., and F. Hirsch,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.2</a> )</p>
</div>
</div>
<div class="section" id="references">
<span id="jwa-10"></span><h2><a class="toc-backref" href="#id182">10. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="jwa-10-1">
<span id="id38"></span><h3><a class="toc-backref" href="#id183">10.1. Normative References</a><a class="headerlink" href="#jwa-10-1" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-96">[AES]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-97">[DSS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Digital
Signature Standard (DSS)&#8221;, FIPS PUB 186-4, July 2013.</dd>
<dt id="term-i-d-ietf-json-rfc4627bis">[I-D.ietf-json-rfc4627bis]</dt>
<dd>Bray, T., &#8220;The JSON Data Interchange Format&#8221;,
draft-ietf-json-rfc4627bis-10 (work in progress),
December 2013.</dd>
<dt id="term-99">[I-D.melnikov-precis-saslprepbis]</dt>
<dd>Saint-Andre, P. and A. Melnikov, &#8220;Preparation and
Comparison of Internationalized Strings Representing
Simple User Names and Passwords&#8221;,
draft-melnikov-precis-saslprepbis-04 (work in progress),
September 2012.</dd>
<dt id="term-100">[JWE]</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, &#8220;JSON Web
Encryption (JWE)&#8221;, draft-ietf-jose-json-web-encryption
(work in progress), January 2014.</dd>
<dt id="term-101">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;,
draft-ietf-jose-json-web-key (work in progress),
January 2014.</dd>
<dt id="term-102">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, draft-ietf-jose-json-web-signature (work
in progress), January 2014.</dd>
<dt id="term-103">[NIST.800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-104">[NIST.800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-105">[NIST.800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography&#8221;, NIST Special
Publication 800-56A, Revision 2, May 2013.</dd>
<dt id="term-106">[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, &#8220;HMAC: Keyed-
Hashing for Message Authentication&#8221;, RFC 2104,
February 1997.</dd>
<dt id="term-107">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-108">[RFC2898]</dt>
<dd>Kaliski, B., &#8220;PKCS #5: Password-Based Cryptography
Specification Version 2.0&#8221;, RFC 2898, September 2000.</dd>
<dt id="term-109">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-110">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-111">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-112">[RFC4868]</dt>
<dd>Kelly, S. and S. Frankel, &#8220;Using HMAC-SHA-256, HMAC-SHA-
384, and HMAC-SHA-512 with IPsec&#8221;, RFC 4868, May 2007.</dd>
<dt id="term-113">[RFC5116]</dt>
<dd>McGrew, D., &#8220;An Interface and Algorithms for Authenticated
Encryption&#8221;, RFC 5116, January 2008.</dd>
<dt id="term-114">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-115">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-sec1">[SEC1]</dt>
<dd>Standards for Efficient Cryptography Group, &#8220;SEC 1:
Elliptic Curve Cryptography&#8221;, May 2009.</dd>
<dt id="term-117">[SHS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Secure
Hash Standard (SHS)&#8221;, FIPS PUB 180-3, October 2008.</dd>
<dt id="term-118">[USASCII]</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-10-2">
<span id="id39"></span><h3><a class="toc-backref" href="#id184">10.2. Informative References</a><a class="headerlink" href="#jwa-10-2" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-119">[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt id="term-120">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</dt>
<dd>McGrew, D., Foley, J., and K. Paterson, &#8220;Authenticated
Encryption with AES-CBC and HMAC-SHA&#8221;,
draft-mcgrew-aead-aes-cbc-hmac-sha2-02 (work in progress),
July 2013.</dd>
<dt id="term-121">[I-D.miller-jose-jwe-protected-jwk]</dt>
<dd>Miller, M., &#8220;Using JavaScript Object Notation (JSON) Web
Encryption (JWE) for Protecting JSON Web Key (JWK)
Objects&#8221;, draft-miller-jose-jwe-protected-jwk-02 (work in
progress), June 2013.</dd>
<dt id="term-122">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-123">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2013.</dd>
<dt id="term-124">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-125">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-126">[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt id="term-127">[NIST-800-63-1]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Electronic Authentication Guideline&#8221;, NIST 800-63-1,
December 2011.</dd>
<dt id="term-128">[RFC2631]</dt>
<dd>Rescorla, E., &#8220;Diffie-Hellman Key Agreement Method&#8221;,
RFC 2631, June 1999.</dd>
<dt id="term-129">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-130">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-131">[W3C.CR-xmldsig-core2-20120124]</dt>
<dd>Cantor, S., Roessler, T., Eastlake, D., Yiu, K., Reagle,
J., Solo, D., Datta, P., and F. Hirsch, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium CR CR-xmldsig-core2-20120124, January 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124">http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124</a>&gt;.</dd>
<dt id="term-132">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Roessler, T., and F. Hirsch,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
<dt id="term-133">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="appendix-a-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a"></span><h2><a class="toc-backref" href="#id185">Appendix A. Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-a-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>This appendix contains tables cross-referencing the cryptographic
algorithm identifier values defined in this specification with the
equivalent identifiers used by other standards and software packages.
See XML DSIG [RFC3275], XML DSIG 2.0 [W3C.CR-xmldsig-core2-20120124],
XML Encryption [W3C.REC-xmlenc-core-20021210], XML Encryption 1.1
[W3C.CR-xmlenc-core1-20120313], and Java Cryptography Architecture
[JCA] for more information about the names defined by those
documents.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="a-1-digital-signature-mac-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-1"></span><h3><a class="toc-backref" href="#id186">A.1. Digital Signature/MAC Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-1-digital-signature-mac-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWS digital
signature and MAC &#8220;alg&#8221; (algorithm) values
defined in this specification with the equivalent identifiers
used by other standards and software packages.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="48%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWS</td>
<td>XML DSIG</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td>HS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha256</td>
<td>HmacSHA256</td>
<td>1.2.840.1135
49.2.9</td>
</tr>
<tr class="row-odd"><td>HS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha384</td>
<td>HmacSHA384</td>
<td>1.2.840.1135
49.2.10</td>
</tr>
<tr class="row-even"><td>HS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha512</td>
<td>HmacSHA512</td>
<td>1.2.840.1135
49.2.11</td>
</tr>
<tr class="row-odd"><td>RS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha256</td>
<td>SHA256withRS
A</td>
<td>1.2.840.1135
49.1.1.11</td>
</tr>
<tr class="row-even"><td>RS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha384</td>
<td>SHA384withRS
A</td>
<td>1.2.840.1135
49.1.1.12</td>
</tr>
<tr class="row-odd"><td>RS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha512</td>
<td>SHA512withRS
A</td>
<td>1.2.840.1135
49.1.1.13</td>
</tr>
<tr class="row-even"><td>ES2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha256</td>
<td>SHA256withEC
DSA</td>
<td>1.2.840.1004
5.4.3.2</td>
</tr>
<tr class="row-odd"><td>ES3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha384</td>
<td>SHA384withEC
DSA</td>
<td>1.2.840.1004
5.4.3.3</td>
</tr>
<tr class="row-even"><td>ES5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha512</td>
<td>SHA512withEC
DSA</td>
<td>1.2.840.1004
5.4.3.4</td>
</tr>
<tr class="row-odd"><td>PS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha256-rsa-MGF1</td>
<td>SHA256withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
<tr class="row-even"><td>PS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha384-rsa-MGF1</td>
<td>SHA384withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
<tr class="row-odd"><td>PS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha512-rsa-MGF1</td>
<td>SHA512withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="a-2-key-management-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-2"></span><h3><a class="toc-backref" href="#id187">A.2. Key Management Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-2-key-management-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWE &#8220;alg&#8221;
(algorithm) values defined in this specification with the equivalent
identifiers used by other standards and software packages.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="38%" />
<col width="31%" />
<col width="22%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td>RSA1
_5</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#rsa-1_5</td>
<td>RSA/ECB/PKCS1Paddi
ng</td>
<td>1.2.840.1135
49.1.1.1</td>
</tr>
<tr class="row-odd"><td>RSA-
OAEP</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#rsa-oaep-mg
f1p</td>
<td>RSA/ECB/OAEPWithSH
A-1AndMGF1Padding</td>
<td>1.2.840.1135
49.1.1.7</td>
</tr>
<tr class="row-even"><td>ECDH
-ES</td>
<td><a class="reference external" href="http://www.w3.org/2009">http://www.w3.org/2009</a>
/xmlenc11#ECDH-ES</td>
<td>&nbsp;</td>
<td>1.3.132.1.12</td>
</tr>
<tr class="row-odd"><td>A128
KW</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes128</td>
<td>&nbsp;</td>
<td>2.16.840.1.1
01.3.4.1.5</td>
</tr>
<tr class="row-even"><td>A192
KW</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes192</td>
<td>&nbsp;</td>
<td>2.16.840.1.1
01.3.4.1.25</td>
</tr>
<tr class="row-odd"><td>A256
KW</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes256</td>
<td>&nbsp;</td>
<td>2.16.840.1.1
01.3.4.1.45</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="a-3-content-encryption-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-3"></span><h3><a class="toc-backref" href="#id188">A.3. Content Encryption Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-3-content-encryption-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWE &#8220;enc&#8221;
(encryption algorithm) values defined in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>For the composite algorithms &#8220;A128CBC-HS256&#8221;, &#8220;A192CBC-HS384&#8221;, and
&#8220;A256CBC-HS512&#8221;, the corresponding AES CBC algorithm identifiers are listed.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="39%" />
<col width="22%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td>A128CBC
-HS256</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes128-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.2</td>
</tr>
<tr class="row-odd"><td>A192CBC
-HS384</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes192-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.22</td>
</tr>
<tr class="row-even"><td>A256CBC
-HS512</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes256-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.42</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes128-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.6</td>
</tr>
<tr class="row-even"><td>A192GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes192-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.26</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes256-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.46</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms">
<span id="jwa-appendix-b"></span><h2><a class="toc-backref" href="#id189">Appendix B. Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The following test cases can be used to validate implementations of
the <em class="xref std std-term">AES_CBC_HMAC_SHA2</em> algorithms defined in Section 5.2.  They are
also intended to correspond to test cases that may appear in a future
version of [I-D.mcgrew-aead-aes-cbc-hmac-sha2], demonstrating that
the cryptographic computations performed are the same.</p>
<p>The variable names are those defined in Section 5.2.  All values are
hexadecimal.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="b-1-test-cases-for-aes-128-cbc-hmac-sha-256">
<span id="jwa-appendix-b-1"></span><h3><a class="toc-backref" href="#id190">B.1. Test Cases for AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#b-1-test-cases-for-aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<p>AES_128_CBC_HMAC_SHA_256</p>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f

ENC_KEY = 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       c8 0e df a3 2d df 39 d5 ef 00 c0 b4 68 83 42 79
          a2 e4 6a 1b 80 49 f7 92 f7 6b fe 54 b9 03 a9 c9
          a9 4a c9 b4 7a d2 65 5c 5f 10 f9 ae f7 14 27 e2
          fc 6f 9b 3f 39 9a 22 14 89 f1 63 62 c7 03 23 36
          09 d4 5a c6 98 64 e3 32 1c f8 29 35 ac 40 96 c8
          6e 13 33 14 c5 40 19 e8 ca 79 80 df a4 b9 cf 1b
          38 4c 48 6f 3a 54 c5 10 78 15 8e e5 d7 9d e5 9f
          bd 34 d8 48 b3 d6 95 50 a6 76 46 34 44 27 ad e5
          4b 88 51 ff b5 98 f7 f8 00 74 b9 47 3c 82 e2 db

M =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4
          e6 e5 45 82 47 65 15 f0 ad 9f 75 a2 b7 1c 73 ef

T =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4</pre>
</div>
<p>(draft20)</p>
</div>
<div class="section" id="b-2-test-cases-for-aes-192-cbc-hmac-sha-384">
<span id="jwa-appendix-b-2"></span><h3><a class="toc-backref" href="#id191">B.2. Test Cases for AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#b-2-test-cases-for-aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17

ENC_KEY = 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27
          28 29 2a 2b 2c 2d 2e 2f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       ea 65 da 6b 59 e6 1e db 41 9b e6 2d 19 71 2a e5
          d3 03 ee b5 00 52 d0 df d6 69 7f 77 22 4c 8e db
          00 0d 27 9b dc 14 c1 07 26 54 bd 30 94 42 30 c6
          57 be d4 ca 0c 9f 4a 84 66 f2 2b 22 6d 17 46 21
          4b f8 cf c2 40 0a dd 9f 51 26 e4 79 66 3f c9 0b
          3b ed 78 7a 2f 0f fc bf 39 04 be 2a 64 1d 5c 21
          05 bf e5 91 ba e2 3b 1d 74 49 e5 32 ee f6 0a 9a
          c8 bb 6c 6b 01 d3 5d 49 78 7b cd 57 ef 48 49 27
          f2 80 ad c9 1a c0 c4 e7 9c 7b 11 ef c6 00 54 e3

M =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7 45 94 f8 86 b3 fa af d4
          86 f2 5c 71 31 e3 28 1e 36 c7 a2 d1 30 af de 57

T =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7</pre>
</div>
<p>(draft20)</p>
</div>
<div class="section" id="b-3-test-cases-for-aes-256-cbc-hmac-sha-512">
<span id="jwa-appendix-b-3"></span><h3><a class="toc-backref" href="#id192">B.3. Test Cases for AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#b-3-test-cases-for-aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

ENC_KEY = 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       4a ff aa ad b7 8c 31 c5 da 4b 1b 59 0d 10 ff bd
          3d d8 d5 d3 02 42 35 26 91 2d a0 37 ec bc c7 bd
          82 2c 30 1d d6 7c 37 3b cc b5 84 ad 3e 92 79 c2
          e6 d1 2a 13 74 b7 7f 07 75 53 df 82 94 10 44 6b
          36 eb d9 70 66 29 6a e6 42 7e a7 5c 2e 08 46 a1
          1a 09 cc f5 37 0d c8 0b fe cb ad 28 c7 3f 09 b3
          a3 b7 5e 66 2a 25 94 41 0a e4 96 b2 e2 e6 60 9e
          31 e6 e0 2c c8 37 f0 53 d2 1f 37 ff 4f 51 95 0b
          be 26 38 d0 9d d7 a4 93 09 30 80 6d 07 03 b1 f6

M =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5
          fd 30 a5 65 c6 16 ff b2 f3 64 ba ec e6 8f c4 07
          53 bc fc 02 5d de 36 93 75 4a a1 f5 c3 37 3b 9c

T =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5</pre>
</div>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="appendix-c-example-ecdh-es-key-agreement-computation">
<span id="jwa-appendix-c"></span><h2><a class="toc-backref" href="#id193">Appendix C. Example ECDH-ES Key Agreement Computation</a><a class="headerlink" href="#appendix-c-example-ecdh-es-key-agreement-computation" title="Permalink to this headline">¶</a></h2>
<p>This example uses ECDH-ES Key Agreement and the Concat KDF to derive
the Content Encryption Key (CEK) in the manner described in
Section 4.6.  In this example, the ECDH-ES Direct Key Agreement mode
(&#8220;alg&#8221; value &#8220;ECDH-ES&#8221;) is used to produce an agreed upon key for AES
GCM with a 128 bit key (&#8220;enc&#8221; value &#8220;A128GCM&#8221;).</p>
<p>In this example, a sender Alice is encrypting content to a recipient
Bob. The sender (Alice) generates an ephemeral key for the key
agreement computation.</p>
<p>Alice&#8217;s <a class="reference internal" href="#term-ephemeral-key"><em class="xref std std-term">ephemeral key</em></a> (in JWK format) used
for the key agreement computation in this example (including the
private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;0_NxaRPUMQoAJt50Gz8YiTr8gRTwyEaCumd-MToTmIo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The recipient&#8217;s (Bob&#8217;s) key (in JWK format) used for the key
agreement computation in this example (including the private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;weNJy2HscCSM6AEDTDg04biOvhFhyyWvOHQfeF_PxMQ&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;e8lnCO-AlStT-NJVX-crhB7QRYhiix03illJOVAOyck&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;VEmDZpDXXK8p8N0Cndsxs924q6nS1RXFASRl6BfUqdw&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Header Parameter values used in this example are as follows.
In this example,
the &#8220;apu&#8221; (agreement PartyUInfo) parameter value is the
base64url encoding of the UTF-8 string &#8220;Alice&#8221; and
the &#8220;apv&#8221; (agreement PartyVInfo) parameter value is
the base64url encoding of the UTF-8 string &#8220;Bob&#8221;.</p>
<div class="highlight-python"><pre>$ python -c "import base64;print base64.urlsafe_b64encode('Bob').replace('=','');"
Qm9i

$ python -c "import base64;print base64.urlsafe_b64encode('Alice').replace('=','');"
QWxpY2U</pre>
</div>
<p>The &#8220;epk&#8221; parameter is used to communicate
the sender&#8217;s (Alice&#8217;s) ephemeral public key value
to the recipient (Bob).</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ECDH-ES&quot;</span><span class="p">,</span>
 <span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A128GCM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apu&quot;</span><span class="o">:</span><span class="s2">&quot;QWxpY2U&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apv&quot;</span><span class="o">:</span><span class="s2">&quot;Qm9i&quot;</span><span class="p">,</span>
 <span class="s2">&quot;epk&quot;</span><span class="o">:</span>
  <span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
   <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
   <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The resulting Concat KDF [NIST.800-56A] parameter values are:</p>
<blockquote>
<div><dl class="docutils">
<dt>Z</dt>
<dd>This is set to the ECDH-ES key agreement output.  (This value is
often not directly exposed by libraries, due to NIST security
requirements, and only serves as an input to a KDF.)  In this
example, Z is the octet sequence:
[158, 86, 217, 29, 129, 113, 53, 211, 114, 131, 66, 131, 191, 132,
38, 156, 251, 49, 110, 163, 218, 128, 106, 72, 246, 218, 167, 121,
140, 254, 144, 196].</dd>
<dt>keydatalen</dt>
<dd>This value is 128 - the number of bits in the desired
output key (because &#8220;A128GCM&#8221; uses a 128 bit key).</dd>
<dt>AlgorithmID</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 7 - [0, 0, 0, 7] - the number of octets in the
AlgorithmID content &#8220;A128GCM&#8221;, followed, by the octets
representing the UTF-8 string &#8220;A128GCM&#8221; - [65, 49, 50, 56, 71, 67,
77].</dd>
<dt>PartyUInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 5 - [0, 0, 0, 5] - the number of octets in the
PartyUInfo content &#8220;Alice&#8221;, followed, by the octets representing
the UTF-8 string &#8220;Alice&#8221; - [65, 108, 105, 99, 101].</dd>
<dt>PartyVInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 3 - [0, 0, 0, 3] - the number of octets in the
PartyUInfo content &#8220;Bob&#8221;, followed, by the octets representing the
UTF-8 string &#8220;Bob&#8221; - [66, 111, 98].</dd>
<dt>SuppPubInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 128 - [0, 0, 0, 128] - the keydatalen value.</dd>
<dt>SuppPrivInfo</dt>
<dd>This is set to the empty octet sequence.</dd>
</dl>
</div></blockquote>
<p>Concatenating the parameters AlgorithmID through SuppPubInfo results
in an OtherInfo value of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">99</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
</pre></div>
</div>
<p>Concatenating the round number 1 ([0, 0, 0, 1]), Z, and the OtherInfo
value results in the Concat KDF round 1 hash input of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="mi">158</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span>
<span class="mi">156</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span>
<span class="mi">254</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span>
<span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>
<span class="mi">101</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
</pre></div>
</div>
<p>The resulting derived key, which is the first 128 bits of the round 1
hash output is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">86</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
<span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
<p>The base64url encoded representation of this derived key is:</p>
<dl class="docutils">
<dt>::</dt>
<dd>VqqN6vgjbSBcIijNcacQGg</dd>
</dl>
<p>(draft20)</p>
</div>
<div class="section" id="id40">
<span id="id41"></span><h2><a class="toc-backref" href="#id194">用語</a><a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-modulus">Modulus</dt>
<dd>係数</dd>
<dt id="term-exponent">Exponent</dt>
<dd>指数</dd>
<dt id="term-chinese-remainder-theorem"><span id="term-crt"></span>Chinese Remainder Theorem<br />CRT</dt>
<dd><a class="reference external" href="https://ja.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E3%81%AE%E5%89%B0%E4%BD%99%E5%AE%9A%E7%90%86">中国人剰余定理</a> 。
孫子の定理（そんしのていり）とも呼ばれる。 (Wikipedia)
CRT を使うと復号演算が高速できる。</dd>
<dt id="term-coefficient">coefficient</dt>
<dd>係数</dd>
<dt id="term-term">term</dt>
<dd>項</dd>
<dt id="term-prime-factor">Prime Factor</dt>
<dd>素因数</dd>
<dt id="term-message-authentication-code"><span id="term-mac"></span>Message Authentication Code<br />MAC</dt>
<dd>メッセージ認証符号/メッセージ認証コード。</dd>
<dt id="term-ephemeral-key">ephemeral key</dt>
<dd>短期鍵</dd>
</dl>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>