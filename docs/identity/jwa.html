

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Algorithms (JWA) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Signature JSON Serialization (JWS-JS)" href="jws_js.html" />
    <link rel="prev" title="JSON Web Key (JWK)" href="jwk.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Algorithms (JWA)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-algorithms-jwa">
<h1>JSON Web Algorithms (JWA)<a class="headerlink" href="#json-web-algorithms-jwa" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id2">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id3">2.  Terminology</a><ul>
<li><a class="reference internal" href="#terms-incorporated-from-the-jws-specification" id="id4">2.1. Terms Incorporated from the JWS Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwe-specification" id="id5">2.2. Terms Incorporated from the JWE Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwk-specification" id="id6">2.3. Terms Incorporated from the JWK Specification</a></li>
<li><a class="reference internal" href="#defined-terms" id="id7">2.4. Defined Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jws" id="id8">3.  Cryptographic Algorithms for JWS</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jws" id="id9">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a></li>
<li><a class="reference internal" href="#mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" id="id10">3.2. MAC with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" id="id11">3.3. Digital Signature with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a></li>
<li><a class="reference internal" href="#digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" id="id12">3.4. Digital Signature with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a></li>
<li><a class="reference internal" href="#using-the-algorithm-none" id="id13">3.5. Using the Algorithm &#8220;none&#8221;</a></li>
<li><a class="reference internal" href="#additional-digital-signature-mac-algorithms-and-parameters" id="id14">3.6. Additional Digital Signature/MAC Algorithms and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jwe" id="id15">4. Cryptographic Algorithms for JWE</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jwe" id="id16">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#enc-encryption-method-header-parameter-values-for-jwe" id="id17">4.2. &#8220;enc&#8221; (Encryption Method) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-pkcs1-v1-5" id="id18">4.3. Key Encryption with RSAES-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-oaep" id="id19">4.4. Key Encryption with RSAES OAEP</a></li>
<li><a class="reference internal" href="#key-encryption-with-aes-key-wrap" id="id20">4.5. Key Encryption with AES Key Wrap</a></li>
<li><a class="reference internal" href="#direct-encryption-with-a-shared-symmetric-key" id="id21">4.6. Direct Encryption with a Shared Symmetric Key</a></li>
<li><a class="reference internal" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" id="id22">4.7. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><ul>
<li><a class="reference internal" href="#key-derivation-for-ecdh-es" id="id23">4.7.1. Key Derivation for &#8220;ECDH-ES&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512" id="id24">4.8. Composite Plaintext Encryption Algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><ul>
<li><a class="reference internal" href="#key-derivation-for-a128cbc-hs256-and-a256cbc-hs512" id="id25">4.8.1. Key Derivation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
<li><a class="reference internal" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id26">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
<li><a class="reference internal" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id27">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plaintext-encryption-with-aes-gcm" id="id28">4.9. Plaintext Encryption with AES GCM</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-algorithms" id="id29">4.10. AES_CBC_HMAC_SHA2 Algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jwk" id="id30">5. Cryptographic Algorithms for JWK</a><ul>
<li><a class="reference internal" href="#kty-key-type-parameter-values-for-jwk" id="id31">5.1. &#8220;kty&#8221; (Key Type) Parameter Values for JWK</a></li>
<li><a class="reference internal" href="#jwk-parameters-for-elliptic-curve-keys" id="id32">5.2. JWK Parameters for Elliptic Curve Keys</a><ul>
<li><a class="reference internal" href="#crv-curve-parameter" id="id33">5.2.1. &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#x-x-coordinate-parameter" id="id34">5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#y-y-coordinate-parameter" id="id35">5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-keys" id="id36">5.3. JWK Parameters for RSA Keys</a><ul>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-public-keys" id="id37">5.3.1.  JWK Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#n-modulus-parameter" id="id38">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#e-exponent-parameter" id="id39">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-private-keys" id="id40">5.3.2.  JWK Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#d-private-exponent-parameter" id="id41">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#p-first-prime-factor-parameter" id="id42">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#q-second-prime-factor-parameter" id="id43">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#dp-first-factor-crt-exponent-parameter" id="id44">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#dq-second-factor-crt-exponent-parameter" id="id45">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#qi-first-crt-coefficient-parameter" id="id46">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#oth-other-primes-info-parameter" id="id47">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#r-prime-factor" id="id48">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#d-factor-crt-exponent" id="id49">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#t-factor-crt-coefficient" id="id50">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id51">6. IANA Considerations</a></li>
<li><a class="reference internal" href="#open-issues-and-things-to-be-done-tbd" id="id52">7.  Open Issues and Things To Be Done (TBD)</a></li>
<li><a class="reference internal" href="#references" id="id53">8.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id54">8.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id55">8.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-digital-signature-mac-algorithm-identifier-cross-reference" id="id56">Appendix A. Digital Signature/MAC Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#appendix-b-encryption-algorithm-identifier-cross-reference" id="id57">Appendix B. Encryption Algorithm Identifier Cross-Reference</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Draft 13 <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwa-abstract"></span><h2><a class="toc-backref" href="#id1">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification enumerates cryptographic algorithms and identifiers to be used with the JSON Web Signature (JWS) and JSON Web Encryption (JWE) specifications.</p>
</div>
<div class="section" id="introduction">
<span id="jwa-1"></span><h2><a class="toc-backref" href="#id2">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification
enumerates cryptographic algorithms and identifiers
to be used with
the JSON Web Signature (JWS) [JWS],
JSON Web Encryption (JWE) [JWE],
and JSON Web Key (JWK) [JWK] specifications.
All these specifications utilize
JavaScript Object Notation (JSON) [RFC4627] based data structures.
This specification also describes the semantics and operations
that are specific to these algorithms and algorithm families.</p>
<p>Enumerating the algorithms and identifiers for them in this specification,
rather than in the JWS, JWE, and JWK specifications,
is intended to allow them to remain unchanged in the face of changes
in the set of required, recommended, optional, and deprecated algorithms over time.</p>
<p>(draft 04 : <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1</a> )</p>
</div>
<div class="section" id="terminology">
<span id="jwa-2"></span><h2><a class="toc-backref" href="#id3">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>(draft 02)</p>
<div class="section" id="terms-incorporated-from-the-jws-specification">
<span id="jwa-2-1"></span><h3><a class="toc-backref" href="#id4">2.1. Terms Incorporated from the JWS Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jws-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Signature (JWS) <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jws"><span id="term-json-web-signature"></span><span id="term-json-web-signature-jws"></span>JWS<br />JSON Web Signature<br />JSON Web Signature (JWS)</dt>
<dd>A data structure cryptographically securing
a JWS Header and a JWS Payload with a JWS Signature value.</dd>
<dt id="term-jws-header">JWS Header</dt>
<dd>A string representing a JavaScript Object Notation (JSON)
<a class="reference internal" href="oauth_meta.html#term-rfc4627"><em class="xref std std-term">[RFC4627]</em></a> object that describes the <em class="xref std std-term">digital signature</em>
or <a class="reference internal" href="glossary.html#term-mac"><em class="xref std std-term">MAC</em></a> operation applied to create the JWS Signature value.</dd>
<dt id="term-jws-payload">JWS Payload</dt>
<dd>The bytes to be secured &#8211; a.k.a., the message.  The
payload can contain an arbitrary sequence of bytes.</dd>
<dt id="term-jws-signature">JWS Signature</dt>
<dd>A byte array containing the cryptographic material
that secures the contents of the JWS Header and the JWS Payload.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>The URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5, with the (non URL-
safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a> for notes on implementing base64url
encoding without padding.)</dd>
<dt id="term-encoded-jws-header">Encoded JWS Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
<a class="reference internal" href="jws.html#term-rfc3629"><em class="xref std std-term">[RFC3629]</em></a> representation of the JWS Header.</dd>
<dt id="term-encoded-jws-payload">Encoded JWS Payload</dt>
<dd>Base64url encoding of the JWS Payload.</dd>
<dt id="term-encoded-jws-signature">Encoded JWS Signature</dt>
<dd>Base64url encoding of the JWS Signature.</dd>
<dt id="term-jws-secured-input">JWS Secured Input</dt>
<dd>The concatenation of the Encoded JWS Header, a
period (&#8216;.&#8217;) character, and the Encoded JWS Payload.</dd>
<dt id="term-collision-resistant-namespace">Collision Resistant Namespace</dt>
<dd><p class="first">A namespace that allows names to be
allocated in a manner such that they are highly unlikely to
collide with other names.  For instance, collision resistance can
be achieved through administrative delegation of portions of the
namespace or through use of collision-resistant name allocation
functions.</p>
<p>Examples of Collision Resistant Namespaces include:
Domain Names, Object Identifiers (OIDs) as defined in the ITU-T
<em class="xref std std-term">X.660</em> and <em class="xref std std-term">X.670</em> Recommendation series, and Universally Unique
IDentifiers (UUIDs) <a class="reference internal" href="jws.html#term-rfc4122"><em class="xref std std-term">[RFC4122]</em></a>.</p>
<p class="last">When using an administratively
delegated namespace, the definer of a name needs to take
reasonable precautions to ensure they are in control of the
portion of the namespace they use to define the name.</p>
</dd>
</dl>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwe-specification">
<span id="jwa-2-2"></span><h3><a class="toc-backref" href="#id5">2.2. Terms Incorporated from the JWE Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwe-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Encryption (JWE) [JWE]
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwe"><span id="term-json-web-encryption"></span><span id="term-json-web-encryption-jwe"></span>JWE<br />JSON Web Encryption<br />JSON Web Encryption (JWE)</dt>
<dd>A data structure representing an encrypted
version of a Plaintext.  The structure consists of four parts: the
JWE Header, the JWE Encrypted Key, the JWE Ciphertext, and the JWE
Integrity Value.</dd>
<dt id="term-plaintext">Plaintext</dt>
<dd>The bytes to be encrypted &#8211; a.k.a., the message.  The
plaintext can contain an arbitrary sequence of bytes.</dd>
<dt id="term-ciphertext">Ciphertext</dt>
<dd>The encrypted version of the Plaintext.</dd>
<dt id="term-cek"><span id="term-content-encryption-key"></span><span id="term-content-encryption-key-cek"></span>CEK<br />Content Encryption Key<br />Content Encryption Key (CEK)</dt>
<dd>A symmetric key used to encrypt the
Plaintext for the recipient to produce the Ciphertext.</dd>
<dt id="term-cik"><span id="term-content-integrity-key"></span><span id="term-content-integrity-key-cik"></span>CIK<br />Content Integrity Key<br />Content Integrity Key (CIK)</dt>
<dd>A key used with a MAC function to ensure
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-cmk"><span id="term-content-master-key"></span><span id="term-content-master-key-cmk"></span>CMK<br />Content Master Key<br />Content Master Key (CMK)</dt>
<dd>A key from which the CEK and CIK are
derived.  When key wrapping or key encryption are employed, the
CMK is randomly generated and encrypted to the recipient as the
JWE Encrypted Key. When key agreement is employed, the CMK is the
result of the key agreement algorithm.</dd>
<dt id="term-jwe-header">JWE Header</dt>
<dd>A string representing a JSON object that describes the
encryption operations applied to create the JWE Encrypted Key, the
JWE Ciphertext, and the JWE Integrity Value.</dd>
<dt id="term-jwe-encrypted-key">JWE Encrypted Key</dt>
<dd>When key wrapping or key encryption are employed,
the Content Master Key (CMK) is encrypted with the intended
recipient&#8217;s key and the resulting encrypted content is recorded as
a byte array, which is referred to as the JWE Encrypted Key.
Otherwise, when key agreement is employed, the JWE Encrypted Key
is the empty byte array.</dd>
<dt id="term-jwe-ciphertext">JWE Ciphertext</dt>
<dd>A byte array containing the Ciphertext.</dd>
<dt id="term-jwe-integrity-value">JWE Integrity Value</dt>
<dd>A byte array containing a MAC value that ensures
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-encoded-jwe-header">Encoded JWE Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
[RFC3629] representation of the JWE Header.</dd>
<dt id="term-encoded-jwe-encrypted-key">Encoded JWE Encrypted Key</dt>
<dd>Base64url encoding of the JWE Encrypted
Key.</dd>
<dt id="term-encoded-jwe-ciphertext">Encoded JWE Ciphertext</dt>
<dd>Base64url encoding of the JWE Ciphertext.</dd>
<dt id="term-encoded-jwe-integrity-value">Encoded JWE Integrity Value</dt>
<dd>Base64url encoding of the JWE Integrity
Value.</dd>
<dt id="term-aead-algorithm">AEAD Algorithm</dt>
<dd>An Authenticated Encryption with Associated Data
(AEAD) [RFC5116] encryption algorithm is one that provides an
integrated content integrity check.  AES Galois/Counter Mode (GCM)
is one such algorithm.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwk-specification">
<span id="jwa-2-3"></span><h3><a class="toc-backref" href="#id6">2.3. Terms Incorporated from the JWK Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwk-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Key (JWK) [JWK] specification are
incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwk"><span id="term-json-web-key"></span><span id="term-json-web-key-jwk"></span>JWK<br />JSON Web Key<br />JSON Web Key (JWK)</dt>
<dd>A JSON data structure that represents a public
key.</dd>
<dt id="term-jwk-set"><span id="term-json-web-key-set-jwk-set"></span>JWK Set<br />JSON Web Key Set (JWK Set)</dt>
<dd>A JSON object that contains an array of
JWKs as a member.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3</a> )</p>
</div>
<div class="section" id="defined-terms">
<span id="jwa-2-4"></span><h3><a class="toc-backref" href="#id7">2.4. Defined Terms</a><a class="headerlink" href="#defined-terms" title="Permalink to this headline">¶</a></h3>
<p>These terms are defined for use by this specification:</p>
<dl class="glossary docutils">
<dt id="term-header-parameter-name">Header Parameter Name</dt>
<dd>The name of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
<dt id="term-header-parameter-value">Header Parameter Value</dt>
<dd>The value of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jws">
<span id="jwa-3"></span><h2><a class="toc-backref" href="#id8">3.  Cryptographic Algorithms for JWS</a><a class="headerlink" href="#cryptographic-algorithms-for-jws" title="Permalink to this headline">¶</a></h2>
<p>JWS uses cryptographic algorithms to digitally sign
or create a Message Authentication Codes (<a class="reference internal" href="glossary.html#term-mac"><em class="xref std std-term">MAC</em></a>)
of the contents of the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a> and the <a class="reference internal" href="jws.html#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>.
The use of the following algorithms for producing JWSs is defined in this section.</p>
<p>(draft 04, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3</a> )</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jws">
<span id="jwa-3-1"></span><h3><a class="toc-backref" href="#id9">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jws" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values defined by this specification for use with JWS, each of which
is explained in more detail in the following sections:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="49%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg
Parameter
Value</td>
<td>Digital Signature or MAC
Algorithm</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>HS256</td>
<td>HMAC using SHA-256 hash
algorithm</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>HS384</td>
<td>HMAC using SHA-384 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>HS512</td>
<td>HMAC using SHA-512 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS256</td>
<td>RSASSA using SHA-256 hash
algorithm</td>
<td>RECOMMENDED</td>
</tr>
<tr class="row-even"><td>RS384</td>
<td>RSASSA using SHA-384 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS512</td>
<td>RSASSA using SHA-512 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES256</td>
<td>ECDSA using P-256 curve and
SHA-256 hash algorithm</td>
<td>RECOMMENDED+</td>
</tr>
<tr class="row-odd"><td>ES384</td>
<td>ECDSA using P-384 curve and
SHA-384 hash algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES512</td>
<td>ECDSA using P-521 curve and
SHA-512 hash algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>none</td>
<td>No digital signature or MAC
value included</td>
<td>REQUIRED</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All the names are short because a core goal of JWS is for the
representations to be compact.  However, there is no a priori length
restriction on &#8220;alg&#8221; values.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>See Appendix A for a table cross-referencing the digital signature
and MAC &#8220;alg&#8221; (algorithm) values used in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.1</a> )</p>
</div>
<div class="section" id="mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512">
<span id="jwa-3-2"></span><h3><a class="toc-backref" href="#id10">3.2. MAC with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a><a class="headerlink" href="#mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<p>Hash-based Message Authentication Codes (HMACs) enable one to use a
secret plus a cryptographic hash function to generate a Message
Authentication Code (MAC).  This can be used to demonstrate that the
MAC matches the hashed content, in this case the JWS Secured Input,
which therefore demonstrates that whoever generated the MAC was in
possession of the secret.  The means of exchanging the shared key is
outside the scope of this specification.</p>
<p>The algorithm for implementing and validating HMACs is provided in
RFC 2104 [RFC2104].  This section defines the use of the HMAC SHA-
256, HMAC SHA-384, and HMAC SHA-512 functions [SHS].  The &#8220;alg&#8221;
(algorithm) header parameter values &#8220;HS256&#8221;, &#8220;HS384&#8221;, and &#8220;HS512&#8221; are
used in the JWS Header to indicate that the Encoded JWS Signature
contains a base64url encoded HMAC value using the respective hash
function.</p>
<p>A key of the same size as the hash output (for instance, 256 bits for
&#8220;HS256&#8221;) or larger MUST be used with this algorithm.</p>
<p>The HMAC SHA-256 MAC is generated per RFC 2104, using SHA-256 as the
hash algorithm &#8220;H&#8221;, using the bytes of the ASCII [USASCII]
representation of the JWS Secured Input as the &#8220;text&#8221; value, and
using the shared key.  The HMAC output value is the JWS Signature.
The JWS signature is base64url encoded to produce the Encoded JWS
Signature.</p>
<p>The HMAC SHA-256 MAC for a JWS is validated by computing an HMAC
value per RFC 2104, using SHA-256 as the hash algorithm &#8220;H&#8221;, using
the bytes of the ASCII representation of the received JWS Secured
input as the &#8220;text&#8221; value, and using the shared key.  This computed
HMAC value is then compared to the result of base64url decoding the
received Encoded JWS signature.  Alternatively, the computed HMAC
value can be base64url encoded and compared to the received Encoded
JWS Signature, as this comparison produces the same result as
comparing the unencoded values.  In either case, if the values match,
the HMAC has been validated.  If the validation fails, the JWS MUST
be rejected.</p>
<p>Securing content with the HMAC SHA-384 and HMAC SHA-512 algorithms is
performed identically to the procedure for HMAC SHA-256 - just using
the corresponding hash algorithm with correspondingly larger minimum
key sizes and result values: 384 bits each for HMAC SHA-384 and 512
bits each for HMAC SHA-512.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jws.html#jws-appendix-a-1"><em>Appendix A.1</em></a> of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft 06 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.2</a> )</p>
</div>
<div class="section" id="digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512">
<span id="jwa-3-3"></span><h3><a class="toc-backref" href="#id11">3.3. Digital Signature with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a><a class="headerlink" href="#digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the <a class="reference internal" href="glossary.html#term-rsassa-pkcs1-v1-5"><em class="xref std std-term">RSASSA-PKCS1-V1_5</em></a> digital
signature algorithm as defined
in <a class="reference external" href="http://tools.ietf.org/html/rfc3447.html#section-8.2">Section 8.2 of RFC 3447</a>
<a class="reference internal" href="#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>, (commonly known as <em class="xref std std-term">PKCS #1</em>),
using SHA-256, SHA-384, or SHA-512 <a class="reference internal" href="#term-shs"><em class="xref std std-term">[SHS]</em></a>
as the hash functions.
The &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221; (algorithm) header parameter values
&#8220;RS256&#8221;, &#8220;RS384&#8221;, and &#8220;RS512&#8221; are used in the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a> to indicate
that the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> contains a <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded RSA
digital signature using the respective hash function.</p>
<p>A key of size 2048 bits or larger MUST be used with these algorithms.</p>
<p>The RSA SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the bytes of the ASCII
representation of the <a class="reference internal" href="#term-jws-secured-input"><em class="xref std std-term">JWS Secured Input</em></a> using RSASSA-PKCS1-V1_5-SIGN
and the SHA-256 hash function with the desired private key.
The output will be a byte array.</li>
<li>Base64url encode the resulting byte array.</li>
</ol>
</div></blockquote>
<p>The output is the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> for that JWS.</p>
<p>The RSA SHA-256 digital signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> and base64url decode it into a
byte array.  If decoding fails, the JWS MUST be rejected.</li>
<li>Submit the bytes of the ASCII representation of the JWS Secured
Input and the public key corresponding to the private key used by
the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm using SHA-
256 as the hash function.</li>
<li>If the validation fails, the JWS MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Signing with the RSA SHA-384 and RSA SHA-512 algorithms is performed
identically to the procedure for RSA SHA-256 - just using the
corresponding hash algorithm with correspondingly larger result
values: 384 bits for RSA SHA-384 and 512 bits for RSA SHA-512.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jws.html#jws-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.3</a> )</p>
</div>
<div class="section" id="digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512">
<span id="jwa-3-4"></span><h3><a class="toc-backref" href="#id12">3.4. Digital Signature with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a><a class="headerlink" href="#digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" title="Permalink to this headline">¶</a></h3>
<p>The Elliptic Curve Digital Signature Algorithm (<a class="reference internal" href="glossary.html#term-ecdsa"><em class="xref std std-term">ECDSA</em></a>) <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a> provides
for the use of Elliptic Curve cryptography, which is able to provide
equivalent security to RSA cryptography but using <strong>shorter key sizes</strong>
and with <strong>greater processing speed</strong>.
This means that ECDSA digital signatures will be substantially smaller
in terms of length than equivalently strong RSA digital signatures.</p>
<p>This specification defines the use of ECDSA with the P-256 curve and
the SHA-256 cryptographic hash function, ECDSA with the P-384 curve
and the SHA-384 hash function, and ECDSA with the P-521 curve and the
SHA-512 hash function.  The P-256, P-384, and P-521 curves are
defined in [DSS].  The &#8220;alg&#8221; (algorithm) header parameter values
&#8220;ES256&#8221;, &#8220;ES384&#8221;, and &#8220;ES512&#8221; are used in the JWS Header to indicate
that the Encoded JWS Signature contains a base64url encoded ECDSA
P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512 digital
signature, respectively.</p>
<p>The ECDSA P-256 SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the bytes of the ASCII
representation of the JWS Secured Input using ECDSA P-256 SHA-256
with the desired private key.  The output will be the pair (R,
S), where R and S are 256 bit unsigned integers.</li>
<li>Turn R and S into byte arrays in big endian order, with each
array being be 32 bytes long.  The array representations MUST not
be shortened to omit any leading zero bytes contained in the
values.</li>
<li>Concatenate the two byte arrays in the order R and then S. (Note
that many ECDSA implementations will directly produce this
concatenation as their output.)</li>
<li>Base64url encode the resulting 64 byte array.</li>
</ol>
</div></blockquote>
<p>The output is the Encoded JWS Signature for the JWS.</p>
<p>The ECDSA P-256 SHA-256 digital signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the Encoded JWS Signature and base64url decode it into a
byte array.  If decoding fails, the JWS MUST be rejected.</li>
<li>The output of the base64url decoding MUST be a 64 byte array.  If
decoding does not result in a 64 byte array, the JWS MUST be
rejected.</li>
<li>Split the 64 byte array into two 32 byte arrays.  The first array
will be R and the second S (with both being in big endian byte
order).</li>
<li>Submit the bytes of the ASCII representation of the JWS Secured
Input R, S and the public key (x, y) to the ECDSA P-256 SHA-256
validator.</li>
<li>If the validation fails, the JWS MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Note that ECDSA digital signature contains a value referred to as K,
which is a random number generated for each digital signature
instance.  This means that two ECDSA digital signatures using exactly
the same input parameters will output different signature values
because their K values will be different.  A consequence of this is
that one cannot validate an ECDSA signature by recomputing the
signature and comparing the results.</p>
<p>Signing with the ECDSA P-384 SHA-384 and ECDSA P-521 SHA-512
algorithms is performed identically to the procedure for ECDSA P-256
SHA-256 - just using the corresponding hash algorithm with
correspondingly larger result values.  For ECDSA P-384 SHA-384, R and
S will be 384 bits each, resulting in a 96 byte array.  For ECDSA
P-521 SHA-512, R and S will be 521 bits each, resulting in a 132 byte
array.</p>
<p>Examples using these algorithms are shown in Appendices A.3 and A.4
of [JWS].</p>
<p>(draft 06 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.4</a> )</p>
</div>
<div class="section" id="using-the-algorithm-none">
<span id="jwa-3-5"></span><h3><a class="toc-backref" href="#id13">3.5. Using the Algorithm &#8220;none&#8221;</a><a class="headerlink" href="#using-the-algorithm-none" title="Permalink to this headline">¶</a></h3>
<p>JWSs MAY also be created that do not provide integrity protection.
Such a JWS is called a &#8220;Plaintext JWS&#8221;.  Plaintext JWSs MUST use the
&#8220;alg&#8221; value &#8220;none&#8221;, and are formatted identically to other JWSs, but
with an empty JWS Signature value.</p>
<p>(draft04 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.5</a> )</p>
</div>
<div class="section" id="additional-digital-signature-mac-algorithms-and-parameters">
<span id="jwa-3-6"></span><h3><a class="toc-backref" href="#id14">3.6. Additional Digital Signature/MAC Algorithms and Parameters</a><a class="headerlink" href="#additional-digital-signature-mac-algorithms-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWSs with corresponding
&#8220;alg&#8221; (algorithm) header parameter values being defined to refer to them.
New &#8220;alg&#8221; header parameter values SHOULD either be registered
in the <em class="xref std std-term">IANA JSON Web Signature and Encryption Algorithms registry</em>
<em class="xref std std-ref">Section 6.1</em>
or be a URI that contains a <a class="reference internal" href="jwt.html#term-collision-resistant-namespace"><em class="xref std std-term">Collision Resistant Namespace</em></a>.
In particular, it is permissible to use the algorithm
identifiers defined in XML DSIG [RFC3275], XML DSIG 2.0
[W3C.CR-xmldsig-core2-20120124], and related specifications as &#8220;alg&#8221; values.</p>
<p>As indicated by the common registry, JWSs and JWEs share a common
&#8220;alg&#8221; value space.  The values used by the two specifications MUST be
distinct, as the &#8220;alg&#8221; value MAY be used to determine whether the
object is a JWS or JWE.</p>
<p>Likewise, additional reserved header parameter names MAY be defined
via the IANA JSON Web Signature and Encryption Header Parameters
registry [JWS].  As indicated by the common registry, JWSs and JWEs
share a common header parameter space; when a parameter is used by
both specifications, its usage must be compatible between the
specifications.</p>
<p>(draft 04 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.6</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jwe">
<span id="jwa-jwe"></span><span id="jwa-4"></span><h2><a class="toc-backref" href="#id15">4. Cryptographic Algorithms for JWE</a><a class="headerlink" href="#cryptographic-algorithms-for-jwe" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms
to encrypt the <a class="reference internal" href="#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a> (CMK) and the Plaintext.
This section specifies a set of specific algorithms for these purposes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4</a></li>
</ul>
</div>
<div class="section" id="alg-algorithm-header-parameter-values-for-jwe">
<span id="jwa-jwe-alg"></span><span id="jwa-4-1"></span><h3><a class="toc-backref" href="#id16">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>キー(CMK)の暗号手順</li>
</ul>
</div>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values that are defined by this specification for use with JWE.</p>
<p>These algorithms are used to encrypt the CMK,
producing the <a class="reference internal" href="jwe.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>,
or to use key agreement to agree upon the CMK.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="51%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Encryption or Agreement
Algorithm</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td><p class="first">RSA1_5
RSA-OAEP</p>
<p>A128KW</p>
<p>A256KW</p>
<p>dir</p>
<p>ECDH-ES</p>
<p>ECDH-ES+A128KW</p>
<p class="last">ECDH-ES+A256KW</p>
</td>
<td>RSAES-PKCS1-V1_5 [RFC3447]
RSAES using Optimal Asymmetric
Encryption Padding (OAEP)
[RFC3447], with the default
parameters specified by RFC
3447 in Section A.2.1
Advanced Encryption Standard
(AES) Key Wrap Algorithm
[RFC3394] using 128 bit keys
AES Key Wrap Algorithm using
256 bit keys
Direct use of a shared
symmetric key as the Content
Master Key (CMK) for the block
encryption step (rather than
using the symmetric key to wrap
the CMK)
Elliptic Curve Diffie-Hellman
Ephemeral Static [RFC6090] key
agreement using the Concat KDF,
as defined in Section 5.8.1 of
[NIST.800-56A], with the
agreed-upon key being used
directly as the Content Master
Key (CMK) (rather than being
used to wrap the CMK), as
specified in Section 4.7
Elliptic Curve Diffie-Hellman
Ephemeral Static key agreement
per &#8220;ECDH-ES&#8221; and Section 4.7,
but where the agreed-upon key
is used to wrap the Content
Master Key (CMK) with the
&#8220;A128KW&#8221; function (rather than
being used directly as the CMK)
Elliptic Curve Diffie-Hellman
Ephemeral Static key agreement
per &#8220;ECDH-ES&#8221; and Section 4.7,
but where the agreed-upon key
is used to wrap the Content
Master Key (CMK) with the
&#8220;A256KW&#8221; function (rather than
being used directly as the CMK)</td>
<td><p class="first">REQUIRED
OPTIONAL</p>
<p>RECOMMENDED</p>
<p>RECOMMENDED</p>
<p>RECOMMENDED</p>
<p>RECOMMENDED+</p>
<p>RECOMMENDED</p>
<p class="last">RECOMMENDED</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.1</a></li>
<li>RSA1_5    : <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>RSA-OAEP  : <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>A128KW    : <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3394.html"><strong>RFC 3394</strong></a> / AES Key Wrap Algorithm (128 bit)</li>
<li>A256KW</li>
<li>dir       : 共有キーを直接つかう(ラップしない)</li>
<li>ECDH-ES   : <span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6090.html"><strong>RFC 6090</strong></a> , <a class="reference external" href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618">http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618</a></li>
<li>ECDH-ES+A128KW    : CMKをキーラップさせる</li>
<li>ECDH-ES+A256KW    :</li>
</ul>
</div>
</div>
<div class="section" id="enc-encryption-method-header-parameter-values-for-jwe">
<span id="jwa-jwe-enc"></span><span id="jwa-4-2"></span><h3><a class="toc-backref" href="#id17">4.2. &#8220;enc&#8221; (Encryption Method) Header Parameter Values for JWE</a><a class="headerlink" href="#enc-encryption-method-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>本文の暗号手順</li>
</ul>
</div>
<p>The table below is the set of &#8220;enc&#8221; (encryption method) header
parameter values that are defined by this specification for use with JWE.
These algorithms are used to encrypt the Plaintext, which produces the Ciphertext.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="23%" />
<col width="52%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc Parameter
Value</td>
<td>Block Encryption Algorithm</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td><p class="first">A128CBC+HS256</p>
<p>A256CBC+HS512</p>
<p>A128GCM</p>
<p class="last">A256GCM</p>
</td>
<td>Composite Authenticated
Encryption algorithm using
Advanced Encryption Standard
(AES) in Cipher Block Chaining
(CBC) mode with PKCS #5 padding
[AES] [NIST.800-38A] with an
integrity calculation using HMAC
SHA-256, using a 256 bit CMK
(and 128 bit CEK) as specified
in Section 4.8
Composite Authenticated
Encryption algorithm using AES
in CBC mode with PKCS #5 padding
with an integrity calculation
using HMAC SHA-512, using a 512
bit CMK (and 256 bit CEK) as
specified in Section 4.8
AES in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128
bit keys
AES GCM using 256 bit keys</td>
<td><p class="first">REQUIRED</p>
<p>REQUIRED</p>
<p>RECOMMENDED</p>
<p class="last">RECOMMENDED</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All the names are short because a core goal of JWE is for the representations to be compact.
However, there is no a priori length restriction on &#8220;<a class="reference internal" href="#jwa-jwe-alg"><em>alg</em></a>&#8221; values.</p>
<p>See <a class="reference internal" href="#jwa-appendix-b"><em>Appendix B</em></a> for a table cross-referencing the encryption &#8220;alg&#8221;
(algorithm) and &#8220;enc&#8221; (encryption method) values
used in this specification with the equivalent identifiers
used by other standards and software packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.2</a></li>
</ul>
</div>
</div>
<div class="section" id="key-encryption-with-rsaes-pkcs1-v1-5">
<span id="jwa-4-3"></span><h3><a class="toc-backref" href="#id18">4.3. Key Encryption with RSAES-PKCS1-V1_5</a><a class="headerlink" href="#key-encryption-with-rsaes-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with RSAES-PKCS1-V1_5 <a class="reference internal" href="#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>.
The &#8220;<a class="reference internal" href="#jwa-jwe-alg"><em>alg</em></a>&#8221; header parameter value &#8220;<strong>RSA1_5</strong>&#8221; is used in this case.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jwe.html#jwe-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="jws.html#term-jwe"><em class="xref std std-term">[JWE]</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.3</a></li>
</ul>
</div>
</div>
<div class="section" id="key-encryption-with-rsaes-oaep">
<span id="jwa-4-4"></span><h3><a class="toc-backref" href="#id19">4.4. Key Encryption with RSAES OAEP</a><a class="headerlink" href="#key-encryption-with-rsaes-oaep" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with RSAES
using Optimal Asymmetric Encryption Padding (OAEP) <em class="xref std std-ref">[RFC3447]</em>, with
the default parameters specified by RFC 3447 in Section A.2.1.  The
&#8220;alg&#8221; header parameter value &#8220;RSA-OAEP&#8221; is used in this case.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.4</a> )</p>
</div>
<div class="section" id="key-encryption-with-aes-key-wrap">
<span id="jwa-4-5"></span><h3><a class="toc-backref" href="#id20">4.5. Key Encryption with AES Key Wrap</a><a class="headerlink" href="#key-encryption-with-aes-key-wrap" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with the
Advanced Encryption Standard (AES) Key Wrap Algorithm <a class="reference internal" href="#term-rfc3394"><em class="xref std std-term">[RFC3394]</em></a>
using 128 or 256 bit keys.
The &#8220;alg&#8221; header parameter values &#8220;A128KW&#8221; or &#8220;A256KW&#8221; are used in this case.</p>
<p>An example using this algorithm is shown in Appendix A.3 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.5</a> )</p>
</div>
<div class="section" id="direct-encryption-with-a-shared-symmetric-key">
<span id="jwa-4-6"></span><h3><a class="toc-backref" href="#id21">4.6. Direct Encryption with a Shared Symmetric Key</a><a class="headerlink" href="#direct-encryption-with-a-shared-symmetric-key" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of directly performing symmetric
key encryption without performing a key wrapping step.
In this case,
the shared symmetric key is used directly as the Content Master Key (CMK) value
for the &#8220;enc&#8221; algorithm.
An empty byte array is used as the JWE Encrypted Key value.
The &#8220;alg&#8221; header parameter value &#8220;dir&#8221; is used in this case.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.6</a> )</p>
</div>
<div class="section" id="key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es">
<span id="jwa-4-7"></span><h3><a class="toc-backref" href="#id22">4.7. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><a class="headerlink" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of key agreement with Elliptic
Curve Diffie-Hellman Ephemeral Static [RFC6090], and using the Concat
KDF, as defined in Section 5.8.1 of <a class="reference internal" href="#term-nist-800-56a"><em class="xref std std-term">[NIST.800-56A]</em></a>.
The key agreement result can be used in one of two ways: (1) directly as the
Content Master Key (CMK) for the &#8220;enc&#8221; algorithm, or (2) as a
symmetric key used to wrap the CMK with either the &#8220;A128KW&#8221; or
&#8220;A256KW&#8221; algorithms.  The &#8220;alg&#8221; header parameter values &#8220;ECDH-ES&#8221;,
&#8220;ECDH-ES+A128KW&#8221;, and &#8220;ECDH-ES+A256KW&#8221; are respectively used in this
case.</p>
<p>In the direct case, the output of the Concat KDF MUST be a key of the
same length as that used by the &#8220;enc&#8221; algorithm; in this case, the
empty byte array is used as the JWE Encrypted Key value.  In the key
wrap case, the output of the Concat KDF MUST be a key of the length
needed for the specified key wrap algorithm, either 128 or 256 bits
respectively.</p>
<p>A new &#8220;epk&#8221; (ephemeral public key) value MUST be generated for each
key agreement transaction.</p>
<p>(draft 06 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7</a> )</p>
<div class="section" id="key-derivation-for-ecdh-es">
<span id="jwa-4-7-1"></span><h4><a class="toc-backref" href="#id23">4.7.1. Key Derivation for &#8220;ECDH-ES&#8221;</a><a class="headerlink" href="#key-derivation-for-ecdh-es" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-z">Z</dt>
<dd>This is set to the representation of the shared secret Z as a byte
array.</dd>
<dt id="term-keydatalen">keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.  For &#8220;ECDH-ES&#8221;, this is length of the key used by the &#8220;enc&#8221;
algorithm.  For &#8220;ECDH-ES+A128KW&#8221;, and &#8220;ECDH-ES+A256KW&#8221;, this is
128 and 256, respectively.</dd>
<dt id="term-algorithmid">AlgorithmID</dt>
<dd>This is set to the concatenation of keydatalen
represented as a 32 bit big endian integer and the bytes of the
UTF-8 representation of the &#8220;alg&#8221; header parameter value.</dd>
<dt id="term-partyuinfo">PartyUInfo</dt>
<dd>If an &#8220;apu&#8221; (agreement PartyUInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;apu&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt id="term-partyvinfo">PartyVInfo</dt>
<dd>If an &#8220;apv&#8221; (agreement PartyVInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;apv&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt id="term-supppubinfo">SuppPubInfo</dt>
<dd>This is set to the empty byte string.</dd>
<dt id="term-suppprivinfo">SuppPrivInfo</dt>
<dd>This is set to the empty byte string.</dd>
</dl>
<p>For all three &#8220;alg&#8221; values, the digest function used is SHA-256.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7.1</a> )</p>
</div>
</div>
<div class="section" id="composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8"></span><h3><a class="toc-backref" href="#id24">4.8. Composite Plaintext Encryption Algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h3>
<p>This section defines two composite &#8220;<a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a>&#8221; algorithms that perform
plaintext encryption using non-AEAD algorithms and add an integrity
check calculation, so that the resulting composite algorithms are
AEAD.
These composite algorithms derive a Content Encryption Key (CEK)
and a Content Integrity Key (CIK) from a Content Master Key,
per Section 4.8.1.  They perform block encryption with AES CBC, per
Section 4.8.2.  Finally, they add an integrity check using HMAC SHA-2
algorithms of matching strength, per Section 4.8.3.</p>
<p>A 256 bit Content Master Key (CMK) value is used with the
&#8220;A128CBC+HS256&#8221; algorithm.  A 512 bit Content Master Key (CMK) value
is used with the &#8220;A256CBC+HS512&#8221; algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.2 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8</a> )</p>
<div class="section" id="key-derivation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-1"></span><h4><a class="toc-backref" href="#id25">4.8.1. Key Derivation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#key-derivation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives CEK and CIK values from the CMK.
This section defines the specifics of deriving keys for the &#8220;enc&#8221;
algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;.</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256
or SHA-512, respectively.  The Concat KDF parameters are set as
follows:</p>
<blockquote>
<div><dl class="docutils">
<dt>Z</dt>
<dd>This is set to the Content Master Key (CMK).</dd>
<dt>keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.</dd>
<dt>AlgorithmID</dt>
<dd>This is set to the concatenation of keydatalen
represented as a 32 bit big endian integer and the bytes of the
UTF-8 representation of the &#8220;enc&#8221; header parameter value.</dd>
<dt>PartyUInfo</dt>
<dd>If an &#8220;epu&#8221; (encryption PartyUInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;epu&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt>PartyVInfo</dt>
<dd>If an &#8220;epv&#8221; (encryption PartyVInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;epv&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt>SuppPubInfo</dt>
<dd>This is set to the bytes of one of the ASCII strings
&#8220;Encryption&#8221; ([69, 110, 99, 114, 121, 112, 116, 105, 111, 110]) or
&#8220;Integrity&#8221; ([73, 110, 116, 101, 103, 114, 105, 116, 121])
respectively, depending upon whether the CEK or CIK is being
generated.</dd>
<dt>SuppPrivInfo</dt>
<dd>This is set to the empty byte string.</dd>
</dl>
</div></blockquote>
<p>To compute the CEK from the CMK, the ASCII label &#8220;Encryption&#8221; is used
for the SuppPubInfo value.  For &#8220;A128CBC+HS256&#8221;, the keydatalen is
128 and the digest function used is SHA-256.  For &#8220;A256CBC+HS512&#8221;,
the keydatalen is 256 and the digest function used is SHA-512.</p>
<p>To compute the CIK from the CMK, the ASCII label &#8220;Integrity&#8221; is used
for the SuppPubInfo value.  For &#8220;A128CBC+HS256&#8221;, the keydatalen is
256 and the digest function used is SHA-256.  For &#8220;A256CBC+HS512&#8221;,
the keydatalen is 512 and the digest function used is SHA-512.</p>
<p>Example derivation computations are shown in Appendices A.4 and A.5
of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.1</a>)</p>
</div>
<div class="section" id="encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-2"></span><h4><a class="toc-backref" href="#id26">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Cipher Block Chaining
(CBC) mode with PKCS #5 padding [AES] [NIST.800-38A] using 128 or 256
bit keys.  The &#8220;enc&#8221; header parameter values &#8220;A128CBC+HS256&#8221; or
&#8220;A256CBC+HS512&#8221; are respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 128 bits is REQUIRED with
these algorithms.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2</a> )</p>
</div>
<div class="section" id="integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-3"></span><h4><a class="toc-backref" href="#id27">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of computing the JWE Integrity
Value for the &#8220;enc&#8221; algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;.
This value is computed as a MAC of the JWE parameters to be secured.</p>
<p>The MAC input value is the bytes of the ASCII representation of the
concatenation of the Encoded JWE Header, a period (&#8216;.&#8217;) character,
the Encoded JWE Encrypted Key, a second period character (&#8216;.&#8217;), the
Encoded JWE Initialization Vector, a third period (&#8216;.&#8217;) character,
and the Encoded JWE Ciphertext.</p>
<p>The CIK is used as the MAC key.</p>
<p>For &#8220;A128CBC+HS256&#8221;, HMAC SHA-256 is used as the MAC algorithm.  For
&#8220;A256CBC+HS512&#8221;, HMAC SHA-512 is used as the MAC algorithm.</p>
<p>The resulting MAC value is used as the JWE Integrity Value.  The same
integrity calculation is performed during decryption.  During
decryption, the computed integrity value must match the received JWE
Integrity Value.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3</a> )</p>
</div>
</div>
<div class="section" id="plaintext-encryption-with-aes-gcm">
<span id="jwa-4-9"></span><h3><a class="toc-backref" href="#id28">4.9. Plaintext Encryption with AES GCM</a><a class="headerlink" href="#plaintext-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128 or 256 bit keys.  The &#8220;enc&#8221; header
parameter values &#8220;A128GCM&#8221; or &#8220;A256GCM&#8221; are used in this case.</p>
<p>The CMK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this algorithm.</p>
<p>The &#8220;additional authenticated data&#8221; parameter is used to secure the
header and key values.  The &#8220;additional authenticated data&#8221; value
used is the bytes of the ASCII representation of the concatenation of
the Encoded JWE Header, a period (&#8216;.&#8217;) character, the Encoded JWE
Encrypted Key, a second period character (&#8216;.&#8217;), and the Encoded JWE
Initialization Vector.  This same &#8220;additional authenticated data&#8221;
value is used when decrypting as well.</p>
<p>The requested size of the &#8220;authentication tag&#8221; output MUST be 128
bits, regardless of the key size.</p>
<p>As GCM is an AEAD algorithm, the JWE Integrity Value is set to be the
&#8220;authentication tag&#8221; value produced by the encryption.  During
decryption, the received JWE Integrity Value is used as the
&#8220;authentication tag&#8221; value.</p>
<p>Examples using this algorithm are shown in Appendices <a class="reference internal" href="jwe.html#jwe-appendix-a-1"><em>A.1</em></a>
and <em class="xref std std-ref">A.3</em> of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9</a>)</p>
</div>
<div class="section" id="aes-cbc-hmac-sha2-algorithms">
<span id="jwa-4-10"></span><h3><a class="toc-backref" href="#id29">4.10. AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h3>
<p>This section defines a family of authenticated encryption algorithms
built using a composition of Advanced Encryption Standard (AES)
in Cipher Block Chaining (CBC) mode with PKCS #5 padding [AES]
[NIST.800-38A] operations and HMAC [RFC2104] [SHS] operations.</p>
<p>This algorithm family is called AES_CBC_HMAC_SHA2.
It also defines two instances of this family,
one using 128 bit CBC keys and HMAC SHA-256
and the other using 256 bit CBC keys and HMAC SHA-512.</p>
<p>Test cases for these algorithms can be found in Appendix C.</p>
<p>These algorithms are based upon Authenticated Encryption
with AES-CBC and HMAC-SHA [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
performing the same cryptographic computations,
but with the <em class="xref std std-term">Initialization Vector</em> and <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">Authentication Tag</em></a> values
remaining separate,
rather than being concatenated with the Ciphertext value in the output representation.</p>
<p>This algorithm family is a generalization of the algorithm family
in [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
and can be used to implement those algorithms.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jwk">
<span id="jwa-5"></span><h2><a class="toc-backref" href="#id30">5. Cryptographic Algorithms for JWK</a><a class="headerlink" href="#cryptographic-algorithms-for-jwk" title="Permalink to this headline">¶</a></h2>
<p>A JSON Web Key (JWK) [JWK] is a JavaScript Object Notation (JSON)
[RFC4627] data structure that represents a cryptographic key.</p>
<p>A JSON Web Key Set (JWK Set) is a JSON data structure for representing a set
of JWKs.  This section specifies a set of key types to be used for
those keys and the key type specific parameters for representing
those keys.</p>
<p>Parameters are defined for public, private, and symmetric keys.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5</a> )</p>
<div class="section" id="kty-key-type-parameter-values-for-jwk">
<span id="jwa-5-1"></span><h3><a class="toc-backref" href="#id31">5.1. &#8220;kty&#8221; (Key Type) Parameter Values for JWK</a><a class="headerlink" href="#kty-key-type-parameter-values-for-jwk" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;kty&#8221; (key type) parameter values
that are defined by this specification for use in JWKs.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="52%" />
<col width="28%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>kty
Parameter
Value</td>
<td>Key Type</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>EC</td>
<td>Elliptic Curve [DSS] key type</td>
<td>RECOMMENDED+</td>
</tr>
<tr class="row-odd"><td>RSA</td>
<td>RSA [RFC3447] key type</td>
<td>REQUIRED</td>
</tr>
<tr class="row-even"><td>oct</td>
<td>Octet sequence key type (used to
represent symmetric keys)</td>
<td>RECOMMENDED+</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All the names are short because a core goal of JWK is for the
representations to be compact.
However, there is no a priori length restriction on &#8220;kty&#8221; values.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.1</a> )</p>
</div>
<div class="section" id="jwk-parameters-for-elliptic-curve-keys">
<span id="jwa-5-2"></span><h3><a class="toc-backref" href="#id32">5.2. JWK Parameters for Elliptic Curve Keys</a><a class="headerlink" href="#jwk-parameters-for-elliptic-curve-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent Elliptic Curve [DSS] keys.
In this case,
the &#8220;kty&#8221; member value MUST be &#8220;EC&#8221;.
Furthermore, these additional members MUST be present:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="#jwa-5-2-1"><em>5.2.1. &#8220;crv&#8221; (Curve) Parameter</em></a></li>
<li><a class="reference internal" href="#jwa-5-2-2"><em>5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</em></a></li>
<li><a class="reference internal" href="#jwa-5-2-3"><em>5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</em></a></li>
<li>agl -&gt; kty</li>
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2</a></li>
</ul>
</div>
<div class="section" id="crv-curve-parameter">
<span id="jwa-5-2-1"></span><h4><a class="toc-backref" href="#id33">5.2.1. &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#crv-curve-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;crv&#8221; (curve) member identifies the cryptographic curve used with the key.
Curve values from <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a> used by this specification are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;P-256&#8221;</li>
<li>&#8220;P-384&#8221;</li>
<li>&#8220;P-521&#8221;</li>
</ul>
</div></blockquote>
<p>Additional &#8220;crv&#8221; values MAY be used, provided they are understood by
implementations using that Elliptic Curve key.
The &#8220;crv&#8221; value is a <strong>case sensitive string</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.1</a></li>
<li>05 から変わらず</li>
</ul>
</div>
</div>
<div class="section" id="x-x-coordinate-parameter">
<span id="jwa-5-2-2"></span><h4><a class="toc-backref" href="#id34">5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#x-x-coordinate-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the elliptic curve point.
It is represented as the base64url encoding of the coordinate&#8217;s <strong>big endian representation</strong>
as a byte array.
The array representation MUST not be shortened
to omit any leading zero bytes contained in the value.
For instance,
when representing 521 bit integers,
the byte array to be base64url encoded MUST contain 66 bytes,
including any leading zero bytes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.2</a></li>
<li>05 と変わらず</li>
</ul>
</div>
</div>
<div class="section" id="y-y-coordinate-parameter">
<span id="jwa-5-2-3"></span><h4><a class="toc-backref" href="#id35">5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#y-y-coordinate-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as a byte array.  The
array representation MUST not be shortened to omit any leading zero
bytes contained in the value.  For instance, when representing 521
bit integers, the byte array to be base64url encoded MUST contain 66
bytes, including any leading zero bytes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.3</a></li>
<li>05 と変わらず</li>
</ul>
</div>
</div>
</div>
<div class="section" id="jwk-parameters-for-rsa-keys">
<span id="jwa-5-3"></span><h3><a class="toc-backref" href="#id36">5.3. JWK Parameters for RSA Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent RSA <a class="reference internal" href="#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a> keys.
In this case,
the &#8220;<em class="xref std std-term">kty</em>&#8221; member value MUST be &#8220;<strong>RSA</strong>&#8221;.</p>
<p>Furthermore, these additional members MUST be present:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="#jwa-5-3-1"><em>5.3.1.  JWK Parameters for RSA Public Keys</em></a></li>
<li><a class="reference internal" href="#jwa-5-3-2"><em>5.3.2.  JWK Parameters for RSA Private Keys</em></a></li>
<li>alg -&gt; kty</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3</a> )</p>
<div class="section" id="jwk-parameters-for-rsa-public-keys">
<span id="jwa-jwk-rsa-public"></span><span id="jwa-5-3-1"></span><h4><a class="toc-backref" href="#id37">5.3.1.  JWK Parameters for RSA Public Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-public-keys" title="Permalink to this headline">¶</a></h4>
<p>These members MUST be present for RSA public keys:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1</a> )</p>
<div class="section" id="n-modulus-parameter">
<span id="jwa-n"></span><span id="jwa-mod"></span><span id="jwa-5-3-1-1"></span><h5><a class="toc-backref" href="#id38">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a><a class="headerlink" href="#n-modulus-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;n&#8221; (modulus) member contains the modulus value</div></blockquote>
<p>for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a>
of the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST NOT be shortened to omit any leading zero octets.
For instance,
when representing 2048 bit integers,
the octet sequence to be base64url encoded MUST contain 256 octets,
including any leading zero octets.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>mod -&gt; n に変更</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1</a> )</p>
</div>
<div class="section" id="e-exponent-parameter">
<span id="jwa-e"></span><span id="jwa-xpo"></span><span id="jwa-5-3-1-2"></span><h5><a class="toc-backref" href="#id39">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a><a class="headerlink" href="#e-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;e&#8221; (exponent) member contains the exponent value
for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of
the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST utilize the minimum number of octets to
represent the value.</p>
<p>For instance,
when representing the value 65537,
the octet sequence to be base64url encoded MUST consist of the three octets [1, 0, 1].</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2</a> )</p>
</div>
</div>
<div class="section" id="jwk-parameters-for-rsa-private-keys">
<span id="jwa-5-3-2"></span><h4><a class="toc-backref" href="#id40">5.3.2.  JWK Parameters for RSA Private Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent RSA public keys,
the following members are used to represent RSA private keys.</p>
<p>All are REQUIRED for RSA private keys except for &#8220;oth&#8221;,
which is sometimes REQUIRED and sometimes MUST NOT be present,
as described below.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2</a> )</p>
<div class="section" id="d-private-exponent-parameter">
<span id="jwa-5-3-2-1"></span><h5><a class="toc-backref" href="#id41">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a><a class="headerlink" href="#d-private-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (<strong>private exponent</strong>) member contains
the private exponent value for the RSA <strong>private key</strong>.</p>
<p>It is represented as the base64url encoding
of the value&#8217;s unsigned big endian representation as an octet
sequence.
The array representation MUST NOT be shortened to omit any
leading zero octets.  For instance, when representing 2048 bit
integers, the octet sequence to be base64url encoded MUST contain 256
octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1</a> )</p>
</div>
<div class="section" id="p-first-prime-factor-parameter">
<span id="jwa-5-3-2-2"></span><h5><a class="toc-backref" href="#id42">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a><a class="headerlink" href="#p-first-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p&#8221; (<strong>first prime factor</strong>) member contains the first prime factor,
a <strong>positive integer</strong>.
It is represented as the base64url encoding of
the value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2</a> )</p>
</div>
<div class="section" id="q-second-prime-factor-parameter">
<span id="jwa-5-3-2-3"></span><h5><a class="toc-backref" href="#id43">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a><a class="headerlink" href="#q-second-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;q&#8221; (<strong>second prime factor</strong>) member contains the second prime
factor, a <strong>positive integer</strong>.</p>
<p>It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3</a> )</p>
</div>
<div class="section" id="dp-first-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-4"></span><h5><a class="toc-backref" href="#id44">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dp-first-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (<strong>first factor CRT exponent</strong>) member contains
the Chinese Remainder Theorem (CRT) exponent of the first factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4</a> )</p>
</div>
<div class="section" id="dq-second-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-5"></span><h5><a class="toc-backref" href="#id45">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dq-second-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dq&#8221; (second factor CRT exponent) member contains
the Chinese Remainder Theorem (CRT) exponent of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5</a> )</p>
</div>
<div class="section" id="qi-first-crt-coefficient-parameter">
<span id="jwa-5-3-2-6"></span><h5><a class="toc-backref" href="#id46">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a><a class="headerlink" href="#qi-first-crt-coefficient-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first CRT coefficient) member contains
the Chinese Remainder Theorem (CRT) coefficient of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6</a> )</p>
</div>
<div class="section" id="oth-other-primes-info-parameter">
<span id="jwa-5-3-2-7"></span><h5><a class="toc-backref" href="#id47">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><a class="headerlink" href="#oth-other-primes-info-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;oth&#8221; (other primes info) member contains an array of information
about any third and subsequent primes, should they exist.  When only
two primes have been used (the normal case), this parameter MUST be
omitted.  When three or more primes have been used, the number of
array elements MUST be the number of primes used minus two.  Each
array element MUST be an object with the following members:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7</a> )</p>
<div class="section" id="r-prime-factor">
<span id="jwa-5-3-2-7-1"></span><h6><a class="toc-backref" href="#id48">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a><a class="headerlink" href="#r-prime-factor" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;r&#8221; (prime factor) parameter within an &#8220;oth&#8221; array member
represents the value of a subsequent prime factor, a positive
integer.  It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1</a> )</p>
</div>
<div class="section" id="d-factor-crt-exponent">
<span id="jwa-5-3-2-7-2"></span><h6><a class="toc-backref" href="#id49">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a><a class="headerlink" href="#d-factor-crt-exponent" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;d&#8221; (Factor CRT Exponent) parameter within an &#8220;oth&#8221; array member
represents the CRT exponent of the corresponding prime factor, a
positive integer.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2</a> )</p>
</div>
<div class="section" id="t-factor-crt-coefficient">
<span id="jwa-5-3-2-7-3"></span><h6><a class="toc-backref" href="#id50">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a><a class="headerlink" href="#t-factor-crt-coefficient" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;t&#8221; (factor CRT coefficient) parameter within an &#8220;oth&#8221; array
member represents the CRT coefficient of the corresponding prime
factor, a positive integer.  It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3</a> )</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jwa-6"></span><h2><a class="toc-backref" href="#id51">6. IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>The following registration procedure is used for all the registries
established by this specification.</p>
<p>Values are registered with a Specification Required [RFC5226] after a
two-week review period on the [TBD]&#64;ietf.org mailing list, on the
advice of one or more Designated Experts.  However, to allow for the
allocation of values prior to publication, the Designated Expert(s)
may approve registration once they are satisfied that such a
specification will be published.</p>
<p>Registration requests must be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject (e.g., &#8220;Request
for access token type: example&#8221;). [[ Note to RFC-EDITOR: The name of
the mailing list should be determined in consultation with the IESG
and IANA.  Suggested name: jose-reg-review. ]]</p>
<p>Within the review period, the Designated Expert(s) will either
approve or deny the registration request, communicating this decision
to the review list and IANA.  Denials should include an explanation
and, if applicable, suggestions as to how to make the request
successful.</p>
<p>IANA must only accept registry updates from the Designated Expert(s)
and should direct all requests for registration to the review mailing
list.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-6</a> )</p>
</div>
<div class="section" id="open-issues-and-things-to-be-done-tbd">
<span id="jwa-7"></span><h2><a class="toc-backref" href="#id52">7.  Open Issues and Things To Be Done (TBD)</a><a class="headerlink" href="#open-issues-and-things-to-be-done-tbd" title="Permalink to this headline">¶</a></h2>
<p>The following items remain to be done in this draft:</p>
<ul class="simple">
<li>Specify minimum required key sizes for all algorithms.</li>
<li>Specify which algorithms require Initialization Vectors (IVs) and minimum required lengths for those IVs.</li>
<li>Since RFC 3447 Section 8 explicitly calls for people NOT to adopt RSASSA-PKCS1 for new applications and instead requests that people transition to RSASSA-PSS, we probably need some Security Considerations text explaining why RSASSA-PKCS1 is being used (it&#8217;s what&#8217;s commonly implemented) and what the potential consequences are.</li>
<li>Should we define the use of RFC 5649 key wrapping functions, which allow arbitrary key sizes, in addition to the current use of RFC 3394 key wrapping functions, which require that keys be multiples of 64 bits? Is this needed in practice?</li>
<li>Decide whether to move the JWK algorithm family definitions &#8220;EC&#8221; and &#8220;RSA&#8221; here. This would likely result in all the family-specific parameter definitions also moving here (&#8220;crv&#8221;, &#8220;x&#8221;, &#8220;y&#8221;, &#8220;mod&#8221;, &#8220;exp&#8221;), leaving very little normative text in the JWK spec itself. This seems like it would reduce spec readability and so was not done.</li>
<li>It would be good to say somewhere, in normative language, that eventually the algorithms and/or key sizes currently specified will no longer be considered sufficiently secure and will be removed. Therefore, implementers MUST be prepared for this eventuality.</li>
<li>Write the Security Considerations section.</li>
</ul>
<ol class="arabic simple">
<li></li>
</ol>
</div>
<div class="section" id="references">
<span id="jwa-8"></span><h2><a class="toc-backref" href="#id53">8.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="jwa-8-1"></span><h3><a class="toc-backref" href="#id54">8.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aes">[AES]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-dss">[DSS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Digital
Signature Standard (DSS)&#8221;, FIPS PUB 186-3, June 2009.</dd>
<dt id="term-51">[JWE]</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, &#8220;JSON Web
Encryption (JWE)&#8221;, October 2012.</dd>
<dt id="term-52">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;, October 2012.</dd>
<dt id="term-53">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, October 2012.</dd>
<dt id="term-nist-800-38a">[NIST.800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST.800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST.800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography (Revised)&#8221;, NIST PUB
800-56A, March 2007.</dd>
<dt id="term-rfc2104">[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, &#8220;HMAC: Keyed-
Hashing for Message Authentication&#8221;, RFC 2104,
February 1997.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc5116">[RFC5116]</dt>
<dd>McGrew, D., &#8220;An Interface and Algorithms for Authenticated
Encryption&#8221;, RFC 5116, January 2008.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-shs">[SHS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Secure
Hash Standard (SHS)&#8221;, FIPS PUB 180-3, October 2008.</dd>
<dt id="term-usascii">[USASCII]</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-8.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-8.1</a> )</p>
</div>
<div class="section" id="informative-references">
<span id="jwa-8-2"></span><h3><a class="toc-backref" href="#id55">8.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2011.</dd>
<dt id="term-jse">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,</dd>
<dt id="term-magicsignatures">[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-rfc4122">[RFC4122]</dt>
<dd>Leach, P., Mealling, M., and R. Salz, &#8220;A Universally
Unique IDentifier (UUID) URN Namespace&#8221;, RFC 4122,
July 2005.</dd>
<dt id="term-w3c-cr-xmldsig-core2-20120124">[W3C.CR-xmldsig-core2-20120124]</dt>
<dd>Roessler, T., Yiu, K., Solo, D., Reagle, J., Datta, P.,
Eastlake, D., Hirsch, F., and S. Cantor, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium CR CR-xmldsig-core2-20120124, January 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124">http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124</a>&gt;.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20120313">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Hirsch, F., and T. Roessler,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
<p>(draft 06,  <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-8.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-8.2</a> )</p>
</div>
</div>
<div class="section" id="appendix-a-digital-signature-mac-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a"></span><h2><a class="toc-backref" href="#id56">Appendix A. Digital Signature/MAC Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-a-digital-signature-mac-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<p>This appendix contains a table cross-referencing the digital
signature and MAC &#8220;alg&#8221; (algorithm) values used in this specification
with the equivalent identifiers used by other standards and software
packages.  See XML DSIG [RFC3275], XML DSIG 2.0
[W3C.CR-xmldsig-core2-20120124], and Java Cryptography Architecture
[JCA] for more information about the names defined by those documents.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="8%" />
<col width="44%" />
<col width="16%" />
<col width="21%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Algor
ithm</td>
<td>JWS</td>
<td>XML DSIG</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td><p class="first">HMAC
using
SHA-2
56</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha256</td>
<td>HmacSHA2
56</td>
<td>1.2.840.113
549.2.9</td>
</tr>
<tr class="row-odd"><td><p class="first">HMAC
using
SHA-3
84</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha384</td>
<td>HmacSHA3
84</td>
<td>1.2.840.113
549.2.10</td>
</tr>
<tr class="row-even"><td><p class="first">HMAC
using
SHA-5
12</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha512</td>
<td>HmacSHA5
12</td>
<td>1.2.840.113
549.2.11</td>
</tr>
<tr class="row-odd"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
256</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha256</td>
<td>SHA256wi
thRSA</td>
<td>1.2.840.113
549.1.1.11</td>
</tr>
<tr class="row-even"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
384</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha384</td>
<td>SHA384wi
thRSA</td>
<td>1.2.840.113
549.1.1.12</td>
</tr>
<tr class="row-odd"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
512</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha512</td>
<td>SHA512wi
thRSA</td>
<td>1.2.840.113
549.1.1.13</td>
</tr>
<tr class="row-even"><td><p class="first">ECDSA
using
P-256
curve
and
SHA-2
56</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha256</td>
<td>SHA256wi
thECDSA</td>
<td>1.2.840.100
45.4.3.2</td>
</tr>
<tr class="row-odd"><td><p class="first">ECDSA
using
P-384
curve
and
SHA-3
84</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha384</td>
<td>SHA384wi
thECDSA</td>
<td>1.2.840.100
45.4.3.3</td>
</tr>
<tr class="row-even"><td><p class="first">ECDSA
using
P-521
curve
and
SHA-5
12</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha512</td>
<td>SHA512wi
thECDSA</td>
<td>1.2.840.100
45.4.3.4</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-A">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-A</a> )</p>
</div>
<div class="section" id="appendix-b-encryption-algorithm-identifier-cross-reference">
<span id="jwa-appendix-b"></span><h2><a class="toc-backref" href="#id57">Appendix B. Encryption Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-b-encryption-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<p>This appendix contains a table cross-referencing the &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221;
(algorithm) and &#8220;<a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a>&#8221; (encryption method) values used in this
specification with the equivalent identifiers used by other standards
and software packages.
See XML Encryption <a class="reference internal" href="#term-w3c-rec-xmlenc-core-20021210"><em class="xref std std-term">[W3C.REC-xmlenc-core-20021210]</em></a>,
XML Encryption 1.1 <a class="reference internal" href="jwe.html#term-w3c-cr-xmlenc-core1-20120313"><em class="xref std std-term">[W3C.CR-xmlenc-core1-20120313]</em></a>, and
Java Cryptography Architecture <a class="reference internal" href="#term-jca"><em class="xref std std-term">[JCA]</em></a>
for more information about the names defined by those
documents.</p>
<p>For the composite algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;, the
corresponding AES CBC algorithm identifiers are listed.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="41%" />
<col width="31%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Algorith
m</td>
<td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
</tr>
<tr class="row-even"><td>RSAES-PK
CS1-V1_5</td>
<td>RSA1_5</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#rsa-1_5</td>
<td>RSA/ECB/PKCS1Paddi
ng</td>
</tr>
<tr class="row-odd"><td><p class="first">RSAES
using
Optimal
Asymmetr
ic</p>
<blockquote>
<div>Encrypt</div></blockquote>
<dl class="docutils">
<dt>ion</dt>
<dd>Paddin</dd>
</dl>
<p class="last">g (OAEP)</p>
</td>
<td>RSA-OA
EP</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#rsa-oaep-mgf1p</td>
<td>RSA/ECB/OAEPWithSH
A-1AndMGF1Padding</td>
</tr>
<tr class="row-even"><td><p class="first">Elliptic
Curve
Diffie-H
ellman</p>
<blockquote>
<div>Ephemer</div></blockquote>
<p class="last">alStatic</p>
</td>
<td>ECDH-E
S</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#ECDH-ES</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><p class="first">Advanced
Encrypti
on</p>
<blockquote>
<div>Standar</div></blockquote>
<dl class="docutils">
<dt>d(AES)</dt>
<dd>Key Wra</dd>
</dl>
<p>pAlgorit
hmusing</p>
<blockquote>
<div>128 bi</div></blockquote>
<p class="last">t keys</p>
</td>
<td>A128KW</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#kw-aes128</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><p class="first">AES Key
Wrap
Algorith
musing</p>
<blockquote class="last">
<div>256 bit
keys</div></blockquote>
</td>
<td>A256KW</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#kw-aes256</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>AES in
Cipher
Block
Chaining
(CBC)
mode
with
PKCS #5
padding
using
128 bit
keys</td>
<td>A128CB
C+HS25
6</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#aes128-cbc</td>
<td>AES/CBC/PKCS5Paddi
ng</td>
</tr>
<tr class="row-even"><td>AES in
CBC mode
with
PKCS #5
padding
using
256 bit
keys</td>
<td>A256CB
C+HS51
2</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#aes256-cbc</td>
<td>AES/CBC/PKCS5Paddi
ng</td>
</tr>
<tr class="row-odd"><td><p class="first">AES in
Galois/C
ounter</p>
<blockquote class="last">
<div>Mode
(GCM)
using
128 bit
keys</div></blockquote>
</td>
<td>A128GC
M</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#aes128-gcm</td>
<td>AES/GCM/NoPadding</td>
</tr>
<tr class="row-even"><td>AES GCM
using
256 bit
keys</td>
<td>A256GC
M</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#aes256-gcm</td>
<td>AES/GCM/NoPadding</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-B">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-B</a> )</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>