

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Algorithms (JWA) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Signature JSON Serialization (JWS-JS)" href="jws_js.html" />
    <link rel="prev" title="JSON Web Key (JWK)" href="jwk.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Algorithms (JWA)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-algorithms-jwa">
<span id="jwa-head"></span><h1>JSON Web Algorithms (JWA)<a class="headerlink" href="#json-web-algorithms-jwa" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id8">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id9">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions" id="id10">1.1.  Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#terminology" id="id11">2.  Terminology</a><ul>
<li><a class="reference internal" href="#terms-incorporated-from-the-jws-specification" id="id12">2.1. Terms Incorporated from the JWS Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwe-specification" id="id13">2.2. Terms Incorporated from the JWE Specification</a></li>
<li><a class="reference internal" href="#terms-incorporated-from-the-jwk-specification" id="id14">2.3. Terms Incorporated from the JWK Specification</a></li>
<li><a class="reference internal" href="#defined-terms" id="id15">2.4. Defined Terms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jws" id="id16">3.  Cryptographic Algorithms for JWS</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jws" id="id17">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a></li>
<li><a class="reference internal" href="#mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" id="id18">3.2. MAC with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" id="id19">3.3. Digital Signature with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a></li>
<li><a class="reference internal" href="#digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" id="id20">3.4. Digital Signature with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a></li>
<li><a class="reference internal" href="#using-the-algorithm-none" id="id21">3.5. Using the Algorithm &#8220;none&#8221;</a></li>
<li><a class="reference internal" href="#additional-digital-signature-mac-algorithms-and-parameters" id="id22">3.6. Additional Digital Signature/MAC Algorithms and Parameters</a></li>
<li><a class="reference internal" href="#jwa-3-7" id="id23">3.7.  Additional Digital Signature/MAC Algorithms and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jwe" id="id24">4. Cryptographic Algorithms for JWE</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jwe" id="id25">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#enc-encryption-method-header-parameter-values-for-jwe" id="id26">4.2.  &#8220;enc&#8221; (Encryption Method) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-pkcs1-v1-5" id="id27">4.3. Key Encryption with RSAES-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-oaep" id="id28">4.4. Key Encryption with RSAES OAEP</a></li>
<li><a class="reference internal" href="#key-encryption-with-aes-key-wrap" id="id29">4.5. Key Encryption with AES Key Wrap</a></li>
<li><a class="reference internal" href="#direct-encryption-with-a-shared-symmetric-key" id="id30">4.6. Direct Encryption with a Shared Symmetric Key</a></li>
<li><a class="reference internal" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" id="id31">4.7. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><ul>
<li><a class="reference internal" href="#key-derivation-for-ecdh-es" id="id32">4.7.1. Key Derivation for &#8220;ECDH-ES&#8221;</a><ul>
<li><a class="reference internal" href="#epk-ephemeral-public-key-header-parameter" id="id33">4.7.1.1.  &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a></li>
<li><a class="reference internal" href="#apu-agreement-partyuinfo-header-parameter" id="id34">4.7.1.2.  &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a></li>
<li><a class="reference internal" href="#apv-agreement-partyvinfo-header-parameter" id="id35">4.7.1.3.  &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation-for-ecdh-key-agreement" id="id36">4.7.2.  Key Derivation for ECDH Key Agreement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512" id="id37">4.8. Composite Plaintext Encryption Algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><ul>
<li><a class="reference internal" href="#key-derivation-for-a128cbc-hs256-and-a256cbc-hs512" id="id38">4.8.1. Key Derivation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><ul>
<li><a class="reference internal" href="#iv-initialization-vector-header-parameter" id="id39">4.8.1.1.  &#8220;iv&#8221; (Initialization Vector) Header Parameter</a></li>
<li><a class="reference internal" href="#tag-authentication-tag-header-parameter" id="id40">4.8.1.2.  &#8220;tag&#8221; (Authentication Tag) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id41">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
<li><a class="reference internal" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" id="id42">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#plaintext-encryption-with-aes-gcm" id="id43">4.9. Plaintext Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-pbes2-key-encryption" id="id44">4.9.1.  Header Parameters Used for PBES2 Key Encryption</a><ul>
<li><a class="reference internal" href="#p2s-pbes2-salt-parameter" id="id45">4.9.1.1.  &#8220;p2s&#8221; (PBES2 salt) Parameter</a></li>
<li><a class="reference internal" href="#p2c-pbes2-count-parameter" id="id46">4.9.1.2.  &#8220;p2c&#8221; (PBES2 count) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-algorithms" id="id47">4.10. AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" id="id48">4.10.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a></li>
<li><a class="reference internal" href="#generic-aes-cbc-hmac-sha2-algorithm" id="id49">4.10.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><ul>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-encryption" id="id50">4.10.2.1. AES_CBC_HMAC_SHA2 Encryption</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-decryption" id="id51">4.10.2.2. AES_CBC_HMAC_SHA2 Decryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aes-128-cbc-hmac-sha-256" id="id52">4.10.3. AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#aes-192-cbc-hmac-sha-384" id="id53">4.10.4.  AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#aes-256-cbc-hmac-sha-512" id="id54">4.10.5.  AES_256_CBC_HMAC_SHA_512</a></li>
<li><a class="reference internal" href="#plaintext-encryption-with-aes-cbc-hmac-sha2" id="id55">4.10.6.  Plaintext Encryption with AES_CBC_HMAC_SHA2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-4-11" id="id56">4.11.  Plaintext Encryption with AES GCM</a></li>
<li><a class="reference internal" href="#additional-encryption-algorithms-and-parameters" id="id57">4.12.  Additional Encryption Algorithms and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-jwk" id="id58">5. Cryptographic Algorithms for JWK</a><ul>
<li><a class="reference internal" href="#kty-key-type-parameter-values-for-jwk" id="id59">5.1. &#8220;kty&#8221; (Key Type) Parameter Values for JWK</a></li>
<li><a class="reference internal" href="#jwk-parameters-for-elliptic-curve-keys" id="id60">5.2. JWK Parameters for Elliptic Curve Keys</a><ul>
<li><a class="reference internal" href="#crv-curve-parameter" id="id61">5.2.1. &#8220;crv&#8221; (Curve) Parameter</a><ul>
<li><a class="reference internal" href="#jwa-5-2-1-1" id="id62">5.2.1.1.  &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#x-x-coordinate-parameter" id="id63">5.2.1.2.  &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#y-y-coordinate-parameter" id="id64">5.2.1.3.  &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-5-2-2" id="id65">5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</a><ul>
<li><a class="reference internal" href="#d-ecc-private-key-parameter" id="id66">5.2.2.1.  &#8220;d&#8221; (ECC Private Key) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwa-5-2-3" id="id67">5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-keys" id="id68">5.3. JWK Parameters for RSA Keys</a><ul>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-public-keys" id="id69">5.3.1.  JWK Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#n-modulus-parameter" id="id70">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#e-exponent-parameter" id="id71">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwk-parameters-for-rsa-private-keys" id="id72">5.3.2.  JWK Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#d-private-exponent-parameter" id="id73">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#p-first-prime-factor-parameter" id="id74">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#q-second-prime-factor-parameter" id="id75">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#dp-first-factor-crt-exponent-parameter" id="id76">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#dq-second-factor-crt-exponent-parameter" id="id77">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#qi-first-crt-coefficient-parameter" id="id78">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#oth-other-primes-info-parameter" id="id79">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#r-prime-factor" id="id80">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#d-factor-crt-exponent" id="id81">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#t-factor-crt-coefficient" id="id82">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#additional-key-algorithm-families-and-parameters" id="id83">5.4. Additional Key Algorithm Families and Parameters</a></li>
<li><a class="reference internal" href="#additional-key-types-and-parameters" id="id84">5.4.  Additional Key Types and Parameters</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id85">6. IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-algorithms-registry" id="id86">6.1.  JSON Web Signature and Encryption Algorithms Registry</a><ul>
<li><a class="reference internal" href="#template" id="id87">6.1.1.  Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents" id="id88">6.1.2.  Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-types-registry" id="id89">6.2.  JSON Web Key Types Registry</a><ul>
<li><a class="reference internal" href="#registration-template" id="id90">6.2.1.  Registration Template</a></li>
<li><a class="reference internal" href="#jwa-6-2-2" id="id91">6.2.2.  Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-parameters-registration" id="id92">6.3.  JSON Web Key Parameters Registration</a><ul>
<li><a class="reference internal" href="#registry-contents" id="id93">6.3.1.  Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#registration-of-jwe-header-parameter-names" id="id94">6.4.  Registration of JWE Header Parameter Names</a><ul>
<li><a class="reference internal" href="#jwa-6-4-1" id="id95">6.4.1.  Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id96">7.  Security Considerations</a><ul>
<li><a class="reference internal" href="#reusing-key-material-when-encrypting-keys" id="id97">7.1.  Reusing Key Material when Encrypting Keys</a></li>
<li><a class="reference internal" href="#password-considerations" id="id98">7.2.  Password Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#internationalization-considerations" id="id99">8.  Internationalization Considerations</a></li>
<li><a class="reference internal" href="#references" id="id100">9.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id101">9.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id102">9.2.  Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-digital-signature-mac-algorithm-identifier-cross-reference" id="id103">Appendix A. Digital Signature/MAC Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#appendix-b-encryption-algorithm-identifier-cross-reference" id="id104">Appendix B. Encryption Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#appendix-c-test-cases-for-aes-cbc-hmac-sha2-algorithms" id="id105">Appendix C.  Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#c-1-test-cases-for-aes-128-cbc-hmac-sha-256" id="id106">C.1.  Test Cases for AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#c-2-test-cases-for-aes-192-cbc-hmac-sha-384" id="id107">C.2.  Test Cases for AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#c-3-test-cases-for-aes-256-cbc-hmac-sha-512" id="id108">C.3.  Test Cases for AES_256_CBC_HMAC_SHA_512</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-d-example-ecdh-es-key-agreement-computation" id="id109">Appendix D.  Example ECDH-ES Key Agreement Computation</a></li>
<li><a class="reference internal" href="#appendix-e-acknowledgements" id="id110">Appendix E.  Acknowledgements</a></li>
<li><a class="reference internal" href="#appendix-f-document-history" id="id111">Appendix F.  Document History</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Draft 16 : <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwa-abstract"></span><h2><a class="toc-backref" href="#id8">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification enumerates cryptographic algorithms
and identifiers to be used with
the JSON Web Signature (<a class="reference internal" href="jws.html"><em>JWS</em></a>),
JSON Web Encryption (<a class="reference internal" href="jwe.html"><em>JWE</em></a>),
and JSON Web Key (<a class="reference internal" href="jwk.html"><em>JWK</em></a>) specifications.</p>
<p>(draft 16)</p>
</div>
<div class="section" id="introduction">
<span id="jwa-1"></span><h2><a class="toc-backref" href="#id9">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification
enumerates cryptographic algorithms and identifiers
to be used with
the JSON Web Signature (JWS) [JWS],
JSON Web Encryption (JWE) [JWE],
and JSON Web Key (JWK) [JWK] specifications.
All these specifications utilize
JavaScript Object Notation (JSON) [RFC4627] based data structures.
This specification also describes the semantics and operations
that are specific to these algorithms and algorithm families.</p>
<p>Enumerating the algorithms and identifiers for them in this specification,
rather than in the JWS, JWE, and JWK specifications,
is intended to allow them to remain unchanged in the face of changes
in the set of required, recommended, optional, and deprecated algorithms over time.</p>
<p>(draft 04 : <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1</a> )</p>
<div class="section" id="notational-conventions">
<span id="jwa-1-1"></span><h3><a class="toc-backref" href="#id10">1.1.  Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in Key words for use in
RFCs to Indicate Requirement Levels [RFC2119].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1</a> )</p>
</div>
</div>
<div class="section" id="terminology">
<span id="jwa-2"></span><h2><a class="toc-backref" href="#id11">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>(draft 02)</p>
<div class="section" id="terms-incorporated-from-the-jws-specification">
<span id="jwa-2-1"></span><h3><a class="toc-backref" href="#id12">2.1. Terms Incorporated from the JWS Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jws-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Signature (JWS) <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jws"><span id="term-json-web-signature"></span><span id="term-json-web-signature-jws"></span>JWS<br />JSON Web Signature<br />JSON Web Signature (JWS)</dt>
<dd>A data structure cryptographically securing
a JWS Header and a JWS Payload with a JWS Signature value.</dd>
<dt id="term-jws-header">JWS Header</dt>
<dd>A string representing a JavaScript Object Notation (JSON)
<a class="reference internal" href="uma_core.html#term-79"><em class="xref std std-term">[RFC4627]</em></a> object that describes the <em class="xref std std-term">digital signature</em>
or <a class="reference internal" href="glossary.html#term-mac"><em class="xref std std-term">MAC</em></a> operation applied to create the JWS Signature value.</dd>
<dt id="term-jws-payload">JWS Payload</dt>
<dd>The bytes to be secured &#8211; a.k.a., the message.  The
payload can contain an arbitrary sequence of bytes.</dd>
<dt id="term-jws-signature">JWS Signature</dt>
<dd>A byte array containing the cryptographic material
that secures the contents of the JWS Header and the JWS Payload.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>The URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5, with the (non URL-
safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a> for notes on implementing base64url
encoding without padding.)</dd>
<dt id="term-encoded-jws-header">Encoded JWS Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
<a class="reference internal" href="oauth.html#term-rfc3629"><em class="xref std std-term">[RFC3629]</em></a> representation of the JWS Header.</dd>
<dt id="term-encoded-jws-payload">Encoded JWS Payload</dt>
<dd>Base64url encoding of the JWS Payload.</dd>
<dt id="term-encoded-jws-signature">Encoded JWS Signature</dt>
<dd>Base64url encoding of the JWS Signature.</dd>
<dt id="term-jws-secured-input">JWS Secured Input</dt>
<dd>The concatenation of the Encoded JWS Header, a
period (&#8216;.&#8217;) character, and the Encoded JWS Payload.</dd>
<dt id="term-collision-resistant-namespace">Collision Resistant Namespace</dt>
<dd><p class="first">A namespace that allows names to be
allocated in a manner such that they are highly unlikely to
collide with other names.  For instance, collision resistance can
be achieved through administrative delegation of portions of the
namespace or through use of collision-resistant name allocation
functions.</p>
<p>Examples of Collision Resistant Namespaces include:
Domain Names, Object Identifiers (OIDs) as defined in the ITU-T
<em class="xref std std-term">X.660</em> and <em class="xref std std-term">X.670</em> Recommendation series, and Universally Unique
IDentifiers (UUIDs) <a class="reference internal" href="jws.html#term-rfc4122"><em class="xref std std-term">[RFC4122]</em></a>.</p>
<p class="last">When using an administratively
delegated namespace, the definer of a name needs to take
reasonable precautions to ensure they are in control of the
portion of the namespace they use to define the name.</p>
</dd>
</dl>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-2.1</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwe-specification">
<span id="jwa-2-2"></span><h3><a class="toc-backref" href="#id13">2.2. Terms Incorporated from the JWE Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwe-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Encryption (JWE) [JWE]
specification are incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwe"><span id="term-json-web-encryption"></span><span id="term-json-web-encryption-jwe"></span>JWE<br />JSON Web Encryption<br />JSON Web Encryption (JWE)</dt>
<dd>A data structure representing an encrypted
version of a Plaintext.  The structure consists of four parts: the
JWE Header, the JWE Encrypted Key, the JWE Ciphertext, and the JWE
Integrity Value.</dd>
<dt id="term-plaintext">Plaintext</dt>
<dd>The bytes to be encrypted &#8211; a.k.a., the message.  The
plaintext can contain an arbitrary sequence of bytes.</dd>
<dt id="term-ciphertext">Ciphertext</dt>
<dd>The encrypted version of the Plaintext.</dd>
<dt id="term-cek"><span id="term-content-encryption-key"></span><span id="term-content-encryption-key-cek"></span>CEK<br />Content Encryption Key<br />Content Encryption Key (CEK)</dt>
<dd>A symmetric key used to encrypt the
Plaintext for the recipient to produce the Ciphertext.</dd>
<dt id="term-cik"><span id="term-content-integrity-key"></span><span id="term-content-integrity-key-cik"></span>CIK<br />Content Integrity Key<br />Content Integrity Key (CIK)</dt>
<dd>A key used with a MAC function to ensure
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-cmk"><span id="term-content-master-key"></span><span id="term-content-master-key-cmk"></span>CMK<br />Content Master Key<br />Content Master Key (CMK)</dt>
<dd>A key from which the CEK and CIK are
derived.  When key wrapping or key encryption are employed, the
CMK is randomly generated and encrypted to the recipient as the
JWE Encrypted Key. When key agreement is employed, the CMK is the
result of the key agreement algorithm.</dd>
<dt id="term-jwe-header">JWE Header</dt>
<dd>A string representing a JSON object that describes the
encryption operations applied to create the JWE Encrypted Key, the
JWE Ciphertext, and the JWE Integrity Value.</dd>
<dt id="term-jwe-encrypted-key">JWE Encrypted Key</dt>
<dd>When key wrapping or key encryption are employed,
the Content Master Key (CMK) is encrypted with the intended
recipient&#8217;s key and the resulting encrypted content is recorded as
a byte array, which is referred to as the JWE Encrypted Key.
Otherwise, when key agreement is employed, the JWE Encrypted Key
is the empty byte array.</dd>
<dt id="term-jwe-ciphertext">JWE Ciphertext</dt>
<dd>A byte array containing the Ciphertext.</dd>
<dt id="term-jwe-integrity-value">JWE Integrity Value</dt>
<dd>A byte array containing a MAC value that ensures
the integrity of the Ciphertext and the parameters used to create
it.</dd>
<dt id="term-encoded-jwe-header">Encoded JWE Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
[RFC3629] representation of the JWE Header.</dd>
<dt id="term-encoded-jwe-encrypted-key">Encoded JWE Encrypted Key</dt>
<dd>Base64url encoding of the JWE Encrypted
Key.</dd>
<dt id="term-encoded-jwe-ciphertext">Encoded JWE Ciphertext</dt>
<dd>Base64url encoding of the JWE Ciphertext.</dd>
<dt id="term-encoded-jwe-integrity-value">Encoded JWE Integrity Value</dt>
<dd>Base64url encoding of the JWE Integrity
Value.</dd>
<dt id="term-aead-algorithm">AEAD Algorithm</dt>
<dd>An Authenticated Encryption with Associated Data
(AEAD) [RFC5116] encryption algorithm is one that provides an
integrated content integrity check.  AES Galois/Counter Mode (GCM)
is one such algorithm.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.2</a> )</p>
</div>
<div class="section" id="terms-incorporated-from-the-jwk-specification">
<span id="jwa-2-3"></span><h3><a class="toc-backref" href="#id14">2.3. Terms Incorporated from the JWK Specification</a><a class="headerlink" href="#terms-incorporated-from-the-jwk-specification" title="Permalink to this headline">¶</a></h3>
<p>These terms defined by the JSON Web Key (JWK) [JWK] specification are
incorporated into this specification:</p>
<dl class="glossary docutils">
<dt id="term-jwk"><span id="term-json-web-key"></span><span id="term-json-web-key-jwk"></span>JWK<br />JSON Web Key<br />JSON Web Key (JWK)</dt>
<dd>A JSON data structure that represents a public
key.</dd>
<dt id="term-jwk-set"><span id="term-json-web-key-set-jwk-set"></span>JWK Set<br />JSON Web Key Set (JWK Set)</dt>
<dd>A JSON object that contains an array of
JWKs as a member.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.3</a> )</p>
</div>
<div class="section" id="defined-terms">
<span id="jwa-2-4"></span><h3><a class="toc-backref" href="#id15">2.4. Defined Terms</a><a class="headerlink" href="#defined-terms" title="Permalink to this headline">¶</a></h3>
<p>These terms are defined for use by this specification:</p>
<dl class="glossary docutils">
<dt id="term-header-parameter-name">Header Parameter Name</dt>
<dd>The name of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
<dt id="term-header-parameter-value">Header Parameter Value</dt>
<dd>The value of a member of the JSON object
representing a JWS Header or JWE Header.</dd>
</dl>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-2.4</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jws">
<span id="jwa-3"></span><h2><a class="toc-backref" href="#id16">3.  Cryptographic Algorithms for JWS</a><a class="headerlink" href="#cryptographic-algorithms-for-jws" title="Permalink to this headline">¶</a></h2>
<p>JWS uses cryptographic algorithms to digitally sign
or create a Message Authentication Codes (<a class="reference internal" href="glossary.html#term-mac"><em class="xref std std-term">MAC</em></a>)
of the contents of the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a> and the <a class="reference internal" href="jws.html#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>.
The use of the following algorithms for producing JWSs is defined in this section.</p>
<p>(draft 04, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3</a> )</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jws">
<span id="jwa-3-1"></span><h3><a class="toc-backref" href="#id17">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jws" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values defined by this specification for use with JWS, each of which
is explained in more detail in the following sections:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="49%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg
Parameter
Value</td>
<td>Digital Signature or MAC
Algorithm</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>HS256</td>
<td>HMAC using SHA-256 hash
algorithm</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>HS384</td>
<td>HMAC using SHA-384 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>HS512</td>
<td>HMAC using SHA-512 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS256</td>
<td>RSASSA using SHA-256 hash
algorithm</td>
<td>RECOMMENDED</td>
</tr>
<tr class="row-even"><td>RS384</td>
<td>RSASSA using SHA-384 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS512</td>
<td>RSASSA using SHA-512 hash
algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES256</td>
<td>ECDSA using P-256 curve and
SHA-256 hash algorithm</td>
<td>RECOMMENDED+</td>
</tr>
<tr class="row-odd"><td>ES384</td>
<td>ECDSA using P-384 curve and
SHA-384 hash algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES512</td>
<td>ECDSA using P-521 curve and
SHA-512 hash algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>none</td>
<td>No digital signature or MAC
value included</td>
<td>REQUIRED</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All the names are short because a core goal of JWS is for the
representations to be compact.  However, there is no a priori length
restriction on &#8220;alg&#8221; values.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>See Appendix A for a table cross-referencing the digital signature
and MAC &#8220;alg&#8221; (algorithm) values used in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>(draft 04 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.1</a> )</p>
</div>
<div class="section" id="mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512">
<span id="jwa-3-2"></span><h3><a class="toc-backref" href="#id18">3.2. MAC with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a><a class="headerlink" href="#mac-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<p>Hash-based Message Authentication Codes (HMACs) enable one to use a
secret plus a cryptographic hash function to generate a Message
Authentication Code (MAC).  This can be used to demonstrate that the
MAC matches the hashed content, in this case the JWS Secured Input,
which therefore demonstrates that whoever generated the MAC was in
possession of the secret.  The means of exchanging the shared key is
outside the scope of this specification.</p>
<p>The algorithm for implementing and validating HMACs is provided in
RFC 2104 [RFC2104].  This section defines the use of the HMAC SHA-
256, HMAC SHA-384, and HMAC SHA-512 functions [SHS].  The &#8220;alg&#8221;
(algorithm) header parameter values &#8220;HS256&#8221;, &#8220;HS384&#8221;, and &#8220;HS512&#8221; are
used in the JWS Header to indicate that the Encoded JWS Signature
contains a base64url encoded HMAC value using the respective hash
function.</p>
<p>A key of the same size as the hash output (for instance, 256 bits for
&#8220;HS256&#8221;) or larger MUST be used with this algorithm.</p>
<p>The HMAC SHA-256 MAC is generated per RFC 2104, using SHA-256 as the
hash algorithm &#8220;H&#8221;, using the bytes of the ASCII [USASCII]
representation of the JWS Secured Input as the &#8220;text&#8221; value, and
using the shared key.  The HMAC output value is the JWS Signature.
The JWS signature is base64url encoded to produce the Encoded JWS
Signature.</p>
<p>The HMAC SHA-256 MAC for a JWS is validated by computing an HMAC
value per RFC 2104, using SHA-256 as the hash algorithm &#8220;H&#8221;, using
the bytes of the ASCII representation of the received JWS Secured
input as the &#8220;text&#8221; value, and using the shared key.  This computed
HMAC value is then compared to the result of base64url decoding the
received Encoded JWS signature.  Alternatively, the computed HMAC
value can be base64url encoded and compared to the received Encoded
JWS Signature, as this comparison produces the same result as
comparing the unencoded values.  In either case, if the values match,
the HMAC has been validated.  If the validation fails, the JWS MUST
be rejected.</p>
<p>Securing content with the HMAC SHA-384 and HMAC SHA-512 algorithms is
performed identically to the procedure for HMAC SHA-256 - just using
the corresponding hash algorithm with correspondingly larger minimum
key sizes and result values: 384 bits each for HMAC SHA-384 and 512
bits each for HMAC SHA-512.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jws.html#jws-appendix-a-1"><em>Appendix A.1</em></a> of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft 06 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.2</a> )</p>
</div>
<div class="section" id="digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512">
<span id="jwa-3-3"></span><h3><a class="toc-backref" href="#id19">3.3. Digital Signature with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a><a class="headerlink" href="#digital-signature-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the <a class="reference internal" href="glossary.html#term-rsassa-pkcs1-v1-5"><em class="xref std std-term">RSASSA-PKCS1-V1_5</em></a> digital
signature algorithm as defined
in <a class="reference external" href="http://tools.ietf.org/html/rfc3447.html#section-8.2">Section 8.2 of RFC 3447</a>
<a class="reference internal" href="jwe.html#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>, (commonly known as <em class="xref std std-term">PKCS #1</em>),
using SHA-256, SHA-384, or SHA-512 <a class="reference internal" href="#term-shs"><em class="xref std std-term">[SHS]</em></a>
as the hash functions.
The &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221; (algorithm) header parameter values
&#8220;RS256&#8221;, &#8220;RS384&#8221;, and &#8220;RS512&#8221; are used in the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a> to indicate
that the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> contains a <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded RSA
digital signature using the respective hash function.</p>
<p>A key of size 2048 bits or larger MUST be used with these algorithms.</p>
<p>The RSA SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the bytes of the ASCII
representation of the <a class="reference internal" href="#term-jws-secured-input"><em class="xref std std-term">JWS Secured Input</em></a> using RSASSA-PKCS1-V1_5-SIGN
and the SHA-256 hash function with the desired private key.
The output will be a byte array.</li>
<li>Base64url encode the resulting byte array.</li>
</ol>
</div></blockquote>
<p>The output is the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> for that JWS.</p>
<p>The RSA SHA-256 digital signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> and base64url decode it into a
byte array.  If decoding fails, the JWS MUST be rejected.</li>
<li>Submit the bytes of the ASCII representation of the JWS Secured
Input and the public key corresponding to the private key used by
the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm using SHA-
256 as the hash function.</li>
<li>If the validation fails, the JWS MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Signing with the RSA SHA-384 and RSA SHA-512 algorithms is performed
identically to the procedure for RSA SHA-256 - just using the
corresponding hash algorithm with correspondingly larger result
values: 384 bits for RSA SHA-384 and 512 bits for RSA SHA-512.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jws.html#jws-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.3</a> )</p>
</div>
<div class="section" id="digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512">
<span id="jwa-3-4"></span><h3><a class="toc-backref" href="#id20">3.4. Digital Signature with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a><a class="headerlink" href="#digital-signature-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" title="Permalink to this headline">¶</a></h3>
<p>The Elliptic Curve Digital Signature Algorithm (<a class="reference internal" href="glossary.html#term-ecdsa"><em class="xref std std-term">ECDSA</em></a>) <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a> provides
for the use of Elliptic Curve cryptography, which is able to provide
equivalent security to RSA cryptography but using <strong>shorter key sizes</strong>
and with <strong>greater processing speed</strong>.
This means that ECDSA digital signatures will be substantially smaller
in terms of length than equivalently strong RSA digital signatures.</p>
<p>This specification defines the use of ECDSA with the P-256 curve and
the SHA-256 cryptographic hash function, ECDSA with the P-384 curve
and the SHA-384 hash function, and ECDSA with the P-521 curve and the
SHA-512 hash function.  The P-256, P-384, and P-521 curves are
defined in [DSS].  The &#8220;alg&#8221; (algorithm) header parameter values
&#8220;ES256&#8221;, &#8220;ES384&#8221;, and &#8220;ES512&#8221; are used in the JWS Header to indicate
that the Encoded JWS Signature contains a base64url encoded ECDSA
P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512 digital
signature, respectively.</p>
<p>The ECDSA P-256 SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the bytes of the ASCII
representation of the JWS Secured Input using ECDSA P-256 SHA-256
with the desired private key.  The output will be the pair (R,
S), where R and S are 256 bit unsigned integers.</li>
<li>Turn R and S into byte arrays in big endian order, with each
array being be 32 bytes long.  The array representations MUST not
be shortened to omit any leading zero bytes contained in the
values.</li>
<li>Concatenate the two byte arrays in the order R and then S. (Note
that many ECDSA implementations will directly produce this
concatenation as their output.)</li>
<li>Base64url encode the resulting 64 byte array.</li>
</ol>
</div></blockquote>
<p>The output is the Encoded JWS Signature for the JWS.</p>
<p>The ECDSA P-256 SHA-256 digital signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the Encoded JWS Signature and base64url decode it into a
byte array.  If decoding fails, the JWS MUST be rejected.</li>
<li>The output of the base64url decoding MUST be a 64 byte array.  If
decoding does not result in a 64 byte array, the JWS MUST be
rejected.</li>
<li>Split the 64 byte array into two 32 byte arrays.  The first array
will be R and the second S (with both being in big endian byte
order).</li>
<li>Submit the bytes of the ASCII representation of the JWS Secured
Input R, S and the public key (x, y) to the ECDSA P-256 SHA-256
validator.</li>
<li>If the validation fails, the JWS MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Note that ECDSA digital signature contains a value referred to as K,
which is a random number generated for each digital signature
instance.  This means that two ECDSA digital signatures using exactly
the same input parameters will output different signature values
because their K values will be different.  A consequence of this is
that one cannot validate an ECDSA signature by recomputing the
signature and comparing the results.</p>
<p>Signing with the ECDSA P-384 SHA-384 and ECDSA P-521 SHA-512
algorithms is performed identically to the procedure for ECDSA P-256
SHA-256 - just using the corresponding hash algorithm with
correspondingly larger result values.  For ECDSA P-384 SHA-384, R and
S will be 384 bits each, resulting in a 96 byte array.  For ECDSA
P-521 SHA-512, R and S will be 521 bits each, resulting in a 132 byte
array.</p>
<p>Examples using these algorithms are shown in Appendices A.3 and A.4
of [JWS].</p>
<p>(draft 06 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-3.4</a> )</p>
</div>
<div class="section" id="using-the-algorithm-none">
<span id="jwa-3-5"></span><h3><a class="toc-backref" href="#id21">3.5. Using the Algorithm &#8220;none&#8221;</a><a class="headerlink" href="#using-the-algorithm-none" title="Permalink to this headline">¶</a></h3>
<p>JWSs MAY also be created that do not provide integrity protection.
Such a JWS is called a &#8220;Plaintext JWS&#8221;.  Plaintext JWSs MUST use the
&#8220;alg&#8221; value &#8220;none&#8221;, and are formatted identically to other JWSs, but
with an empty JWS Signature value.</p>
<p>(draft04 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.5</a> )</p>
</div>
<div class="section" id="additional-digital-signature-mac-algorithms-and-parameters">
<span id="jwa-3-6"></span><h3><a class="toc-backref" href="#id22">3.6. Additional Digital Signature/MAC Algorithms and Parameters</a><a class="headerlink" href="#additional-digital-signature-mac-algorithms-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWSs with corresponding
&#8220;alg&#8221; (algorithm) header parameter values being defined to refer to them.
New &#8220;alg&#8221; header parameter values SHOULD either be registered
in the <em class="xref std std-term">IANA JSON Web Signature and Encryption Algorithms registry</em>
<a class="reference internal" href="#jwa-6-1"><em>Section 6.1</em></a>
or be a URI that contains a <a class="reference internal" href="jwt.html#term-collision-resistant-namespace"><em class="xref std std-term">Collision Resistant Namespace</em></a>.
In particular, it is permissible to use the algorithm
identifiers defined in XML DSIG [RFC3275], XML DSIG 2.0
[W3C.CR-xmldsig-core2-20120124], and related specifications as &#8220;alg&#8221; values.</p>
<p>As indicated by the common registry, JWSs and JWEs share a common
&#8220;alg&#8221; value space.  The values used by the two specifications MUST be
distinct, as the &#8220;alg&#8221; value MAY be used to determine whether the
object is a JWS or JWE.</p>
<p>Likewise, additional reserved header parameter names MAY be defined
via the IANA JSON Web Signature and Encryption Header Parameters
registry [JWS].  As indicated by the common registry, JWSs and JWEs
share a common header parameter space; when a parameter is used by
both specifications, its usage must be compatible between the
specifications.</p>
<p>(draft 04 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-3.6</a> )</p>
</div>
<div class="section" id="jwa-3-7">
<span id="id1"></span><h3><a class="toc-backref" href="#id23">3.7.  Additional Digital Signature/MAC Algorithms and Parameters</a><a class="headerlink" href="#jwa-3-7" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWSs with corresponding
&#8220;<em class="xref std std-term">alg&#8221;</em> (algorithm) header parameter values being defined to refer to them.</p>
<p>New &#8220;alg&#8221; header parameter values SHOULD either be registered
in the <a class="reference internal" href="#jwa-6-1"><em>IANA JSON Web Signature and Encryption Algorithms registry Section 6.1</em></a>
or be a value that contains a <a class="reference internal" href="jwt.html#term-collision-resistant-namespace"><em class="xref std std-term">Collision Resistant Namespace</em></a>.
In particular,
it is permissible to use the algorithm identifiers defined in XML DSIG [RFC3275],
XML DSIG 2.0 [W3C.CR-xmldsig-core2-20120124],
and related specifications as &#8220;alg&#8221; values.</p>
<p>As indicated by the common registry,
JWSs and JWEs share a common &#8220;alg&#8221; value space.
The values used by the two specifications MUST be distinct,
as the &#8220;alg&#8221; value can be used to determine whether the object is a JWS or JWE.</p>
<p>Likewise, additional reserved Header Parameter Names can be defined
via the IANA JSON Web Signature and Encryption Header Parameters
registry [JWS].  As indicated by the common registry, JWSs and JWEs
share a common header parameter space; when a parameter is used by
both specifications, its usage must be compatible between the
specifications.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-3.7">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-3.7</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jwe">
<span id="jwa-jwe"></span><span id="jwa-4"></span><h2><a class="toc-backref" href="#id24">4. Cryptographic Algorithms for JWE</a><a class="headerlink" href="#cryptographic-algorithms-for-jwe" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms
to encrypt the <a class="reference internal" href="#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a> (CMK) and the Plaintext.
This section specifies a set of specific algorithms for these purposes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4</a></li>
</ul>
</div>
<div class="section" id="alg-algorithm-header-parameter-values-for-jwe">
<span id="jwa-jwe-alg"></span><span id="jwa-4-1"></span><h3><a class="toc-backref" href="#id25">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>キー(CMK)の暗号手順</li>
</ul>
</div>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values that are defined by this specification for use with JWE.</p>
<p>These algorithms are used to encrypt the CMK,
producing the <a class="reference internal" href="jwe.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>,
or to use key agreement to agree upon the CMK.</p>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="27%" />
<col width="19%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>RSA1_5</td>
<td><a href="#id112"><span class="problematic" id="id113">RSAES-PKCS1-V1_</span></a>
5[RFC3447]</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>RSA-OAEP</td>
<td>RSAES using
Optimal
Asymmetric
Encryption
Padding (OAEP)
[RFC3447], with
the default
parameters
specified by
RFC 3447 in
Section A.2.1</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A128KW</td>
<td>Advanced
Encryption
Standard (AES)
Key Wrap
Algorithm
[RFC3394] using
the default
initial value
specified in
Section 2.2.3.1
and using 128
bit keys</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>A192KW</td>
<td>AES Key Wrap
Algorithm using
the default
initial value
specified in
Section 2.2.3.1
and using 192
bit keys</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256KW</td>
<td>AES Key Wrap
Algorithm using
the default
initial value
specified in
Section 2.2.3.1
and using 256
bit keys</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>dir</td>
<td>Direct use of a
shared
symmetric key
as the Content
Encryption Key
(CEK) for the
content
encryption step
(rather than
using the
symmetric key
to wrap the
CEK)</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>ECDH-ES</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static
[RFC6090] key
agreement using
the Concat KDF,
as defined in
Section 5.8.1
of
[NIST.800-56A],
with the
agreed-upon key
being used
directly as the
Content
Encryption Key
(CEK) (rather
than being used
to wrap the
CEK), as
specified in
Section 4.7</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended+</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A128KW</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static key
agreement per
&#8220;ECDH-ES&#8221; and
Section 4.7,
where the
agreed-upon key
is used to wrap
the Content
Encryption Key
(CEK) with the
&#8220;A128KW&#8221;
function
(rather than
being used
directly as the
CEK)</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A192KW</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static key
agreement,
where the
agreed-upon key
is used to wrap
the Content
Encryption Key
(CEK) with the
&#8220;A192KW&#8221;
function
(rather than
being used
directly as the
CEK)</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A256KW</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static key
agreement,
where the
agreed-upon key
is used to wrap
the Content
Encryption Key
(CEK) with the
&#8220;A256KW&#8221;
function
(rather than
being used
directly as the
CEK)</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A128GCMKW</td>
<td>AES in
Galois/Counter
Mode (GCM)
[AES]
[NIST.800-38D]
using 128 bit
keys</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A192GCMKW</td>
<td>AES GCM using
192 bit keys</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256GCMKW</td>
<td>AES GCM using
256 bit keys</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>PBES2-HS256+A128K
W</td>
<td>PBES2 [RFC2898]
with HMAC
SHA-256 as the
PRF and AES Key
Wrap [RFC3394]
using 128 bit
keys for the
encryption
scheme</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>PBES2-HS384+A192K
W</td>
<td>PBES2 with HMAC
SHA-256 as the
PRF and AES Key
Wrap using 192
bit keys for
the encryption
scheme</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>PBES2-HS512+A256K
W</td>
<td>PBES2 with HMAC
SHA-256 as the
PRF and AES Key
Wrap using 256
bit keys for
the encryption
scheme</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The <em class="xref std std-term">Additional Header Parameters</em> column indicates</p>
</div></blockquote>
<p>what additional Header Parameters are used by the algorithm,
beyond &#8220;alg&#8221;, which all use.
All but &#8220;dir&#8221; and &#8220;ECDH-ES&#8221; also produce a JWE Encrypted Key value.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 16 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.1</a></li>
<li>RSA1_5    : <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>RSA-OAEP  : <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a></li>
<li>A128KW    : <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3394.html"><strong>RFC 3394</strong></a> / AES Key Wrap Algorithm (128 bit)</li>
<li>A256KW</li>
<li>dir       : 共有キーを直接つかう(ラップしない)</li>
<li>ECDH-ES   : <span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6090.html"><strong>RFC 6090</strong></a> , <a class="reference external" href="http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618">http://www.nist.gov/manuscript-publication-search.cfm?pub_id=150618</a></li>
<li>ECDH-ES+A128KW    : CMKをキーラップさせる</li>
<li>ECDH-ES+A256KW    :</li>
</ul>
</div>
</div>
<div class="section" id="enc-encryption-method-header-parameter-values-for-jwe">
<span id="jwa-jwe-enc"></span><span id="jwa-4-2"></span><h3><a class="toc-backref" href="#id26">4.2.  &#8220;enc&#8221; (Encryption Method) Header Parameter Values for JWE</a><a class="headerlink" href="#enc-encryption-method-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;enc&#8221; (encryption method) header
parameter values that are defined by this specification for use with JWE.</p>
<p>These algorithms are used to encrypt the Plaintext, which produces the Ciphertext.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="38%" />
<col width="19%" />
<col width="23%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc
Parameter
Value</td>
<td>Content Encryption
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementatio
nRequirements</td>
</tr>
<tr class="row-even"><td>A128CBC-HS2
56</td>
<td><p class="first">The
AES_128_CBC_HMAC_SHA_2
56 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 4.10.3.  This
algorithm uses a 256
bit key.</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A192CBC-HS3
84</td>
<td><p class="first">The
AES_192_CBC_HMAC_SHA_3
84 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 4.10.4.  This
algorithm uses a 384
bit key.</div></blockquote>
</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256CBC-HS5
12</td>
<td><p class="first">The
AES_256_CBC_HMAC_SHA_5
12 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 4.10.5.  This
algorithm uses a 512
bit key.</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td>AES in Galois/Counter
Mode (GCM) [AES]
[NIST.800-38D] using
128 bit keys</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A192GCM</td>
<td>AES GCM using 192 bit
keys</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td>AES GCM using 256 bit
keys</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The Additional Header Parameters column indicates what additional
Header Parameters are used by the algorithm, beyond &#8220;enc&#8221;, which all use.
All also use a JWE Initialization Vector value and produce JWE Ciphertext and JWE Authentication Tag values.</p>
<p>See Appendix B for a table cross-referencing the encryption &#8220;alg&#8221;
(algorithm) and &#8220;enc&#8221; (encryption method) values used in this
specification with the equivalent identifiers used by other standards
and software packages.</p>
<p>( draft 16 , <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-16#section-4.2</a> )</p>
</div>
<div class="section" id="key-encryption-with-rsaes-pkcs1-v1-5">
<span id="jwa-4-3"></span><h3><a class="toc-backref" href="#id27">4.3. Key Encryption with RSAES-PKCS1-V1_5</a><a class="headerlink" href="#key-encryption-with-rsaes-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with RSAES-PKCS1-V1_5 <a class="reference internal" href="jwe.html#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>.
The &#8220;<a class="reference internal" href="#jwa-jwe-alg"><em>alg</em></a>&#8221; header parameter value &#8220;<strong>RSA1_5</strong>&#8221; is used in this case.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in <a class="reference internal" href="jwe.html#jwe-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="jws.html#term-jwe"><em class="xref std std-term">[JWE]</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-4.3</a></li>
</ul>
</div>
</div>
<div class="section" id="key-encryption-with-rsaes-oaep">
<span id="jwa-4-4"></span><h3><a class="toc-backref" href="#id28">4.4. Key Encryption with RSAES OAEP</a><a class="headerlink" href="#key-encryption-with-rsaes-oaep" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with RSAES
using Optimal Asymmetric Encryption Padding (OAEP) <em class="xref std std-ref">[RFC3447]</em>, with
the default parameters specified by RFC 3447 in Section A.2.1.  The
&#8220;alg&#8221; header parameter value &#8220;RSA-OAEP&#8221; is used in this case.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.4</a> )</p>
</div>
<div class="section" id="key-encryption-with-aes-key-wrap">
<span id="jwa-4-5"></span><h3><a class="toc-backref" href="#id29">4.5. Key Encryption with AES Key Wrap</a><a class="headerlink" href="#key-encryption-with-aes-key-wrap" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CMK with the
Advanced Encryption Standard (AES) Key Wrap Algorithm <a class="reference internal" href="jwe.html#term-rfc3394"><em class="xref std std-term">[RFC3394]</em></a>
using 128 or 256 bit keys.
The &#8220;alg&#8221; header parameter values &#8220;A128KW&#8221; or &#8220;A256KW&#8221; are used in this case.</p>
<p>An example using this algorithm is shown in Appendix A.3 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.5</a> )</p>
</div>
<div class="section" id="direct-encryption-with-a-shared-symmetric-key">
<span id="jwa-4-6"></span><h3><a class="toc-backref" href="#id30">4.6. Direct Encryption with a Shared Symmetric Key</a><a class="headerlink" href="#direct-encryption-with-a-shared-symmetric-key" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of directly performing symmetric
key encryption without performing a key wrapping step.
In this case,
the shared symmetric key is used directly as the Content Master Key (CMK) value
for the &#8220;enc&#8221; algorithm.
An empty byte array is used as the JWE Encrypted Key value.
The &#8220;alg&#8221; header parameter value &#8220;dir&#8221; is used in this case.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.6</a> )</p>
</div>
<div class="section" id="key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es">
<span id="jwa-4-7"></span><h3><a class="toc-backref" href="#id31">4.7. Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><a class="headerlink" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of key agreement with Elliptic
Curve Diffie-Hellman Ephemeral Static [RFC6090], and using the Concat
KDF, as defined in Section 5.8.1 of <a class="reference internal" href="#term-nist-800-56a"><em class="xref std std-term">[NIST.800-56A]</em></a>.
The key agreement result can be used in one of two ways: (1) directly as the
Content Master Key (CMK) for the &#8220;enc&#8221; algorithm, or (2) as a
symmetric key used to wrap the CMK with either the &#8220;A128KW&#8221; or
&#8220;A256KW&#8221; algorithms.  The &#8220;alg&#8221; header parameter values &#8220;ECDH-ES&#8221;,
&#8220;ECDH-ES+A128KW&#8221;, and &#8220;ECDH-ES+A256KW&#8221; are respectively used in this
case.</p>
<p>In the direct case, the output of the Concat KDF MUST be a key of the
same length as that used by the &#8220;enc&#8221; algorithm; in this case, the
empty byte array is used as the JWE Encrypted Key value.  In the key
wrap case, the output of the Concat KDF MUST be a key of the length
needed for the specified key wrap algorithm, either 128 or 256 bits
respectively.</p>
<p>A new &#8220;epk&#8221; (ephemeral public key) value MUST be generated for each
key agreement transaction.</p>
<p>(draft 06 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7</a> )</p>
<div class="section" id="key-derivation-for-ecdh-es">
<span id="jwa-4-7-1"></span><h4><a class="toc-backref" href="#id32">4.7.1. Key Derivation for &#8220;ECDH-ES&#8221;</a><a class="headerlink" href="#key-derivation-for-ecdh-es" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-z">Z</dt>
<dd>This is set to the representation of the shared secret Z as a byte
array.</dd>
<dt id="term-keydatalen">keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.  For &#8220;ECDH-ES&#8221;, this is length of the key used by the &#8220;enc&#8221;
algorithm.  For &#8220;ECDH-ES+A128KW&#8221;, and &#8220;ECDH-ES+A256KW&#8221;, this is
128 and 256, respectively.</dd>
<dt id="term-algorithmid">AlgorithmID</dt>
<dd>This is set to the concatenation of keydatalen
represented as a 32 bit big endian integer and the bytes of the
UTF-8 representation of the &#8220;alg&#8221; header parameter value.</dd>
<dt id="term-partyuinfo">PartyUInfo</dt>
<dd>If an &#8220;apu&#8221; (agreement PartyUInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;apu&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt id="term-partyvinfo">PartyVInfo</dt>
<dd>If an &#8220;apv&#8221; (agreement PartyVInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;apv&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt id="term-supppubinfo">SuppPubInfo</dt>
<dd>This is set to the empty byte string.</dd>
<dt id="term-suppprivinfo">SuppPrivInfo</dt>
<dd>This is set to the empty byte string.</dd>
</dl>
<p>For all three &#8220;alg&#8221; values, the digest function used is SHA-256.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.7.1</a> )</p>
<div class="section" id="epk-ephemeral-public-key-header-parameter">
<span id="jwa-4-7-1-1"></span><h5><a class="toc-backref" href="#id33">4.7.1.1.  &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a><a class="headerlink" href="#epk-ephemeral-public-key-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;epk&#8221; (ephemeral public key) value created by the originator for
the use in key agreement algorithms.  This key is represented as a
JSON Web Key [JWK] bare public key value.  This Header Parameter is
REQUIRED and MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.1</a> )</p>
</div>
<div class="section" id="apu-agreement-partyuinfo-header-parameter">
<span id="jwa-4-7-1-2"></span><h5><a class="toc-backref" href="#id34">4.7.1.2.  &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a><a class="headerlink" href="#apu-agreement-partyuinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apu&#8221; (agreement PartyUInfo) value for key agreement algorithms
using it (such as &#8220;ECDH-ES&#8221;), represented as a base64url encoded
string.  When used, the PartyUInfo value contains information about
the sender.  Use of this Header Parameter is OPTIONAL.  This Header
Parameter MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.2</a> )</p>
</div>
<div class="section" id="apv-agreement-partyvinfo-header-parameter">
<span id="jwa-4-7-1-3"></span><h5><a class="toc-backref" href="#id35">4.7.1.3.  &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a><a class="headerlink" href="#apv-agreement-partyvinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apv&#8221; (agreement PartyVInfo) value for key agreement algorithms
using it (such as &#8220;ECDH-ES&#8221;),
represented as a base64url encoded string.
When used,
the PartyVInfo value contains information about the receiver.
Use of this Header Parameter is OPTIONAL.
This Header Parameter MUST be understood and processed by implementations when
these algorithms are used.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.1.3</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography ( NIST Special Publication 800-56A  )</p>
</div>
</div>
</div>
<div class="section" id="key-derivation-for-ecdh-key-agreement">
<span id="jwa-4-7-2"></span><h4><a class="toc-backref" href="#id36">4.7.2.  Key Derivation for ECDH Key Agreement</a><a class="headerlink" href="#key-derivation-for-ecdh-key-agreement" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives the agreed upon key from the
shared secret Z established through the ECDH algorithm, per Section
6.2.2.2 of [NIST.800-56A].</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256.
The Concat KDF parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-49">Z</dt>
<dd>This is set to the representation of the shared secret Z as an
octet sequence.</dd>
<dt id="term-50">keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.  For &#8220;ECDH-ES&#8221;, this is length of the key used by the &#8220;enc&#8221;
algorithm.  For &#8220;ECDH-ES+A128KW&#8221;, &#8220;ECDH-ES+A192KW&#8221;, and
&#8220;ECDH-ES+A256KW&#8221;, this is 128, 192, and 256, respectively.</dd>
<dt id="term-51">AlgorithmID</dt>
<dd>In the Direct Key Agreement case, this is set to the
octets of the UTF-8 representation of the &#8220;enc&#8221; header parameter
value.  In the Key Agreement with Key Wrapping case, this is set
to the octets of the UTF-8 representation of the &#8220;alg&#8221; header
parameter value.</dd>
<dt id="term-52">PartyUInfo</dt>
<dd>The PartyUInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data, with || being
concatenation.  If an &#8220;apu&#8221; (agreement PartyUInfo) header
parameter is present, Data is set to the result of base64url
decoding the &#8220;apu&#8221; value and Datalen is set to the number of
octets in Data.  Otherwise, Datalen is set to 0 and Data is set to
the empty octet sequence.</dd>
<dt id="term-53">PartyVInfo</dt>
<dd>The PartyVInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets, and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data, with || being
concatenation.  If an &#8220;apv&#8221; (agreement PartyVInfo) header
parameter is present, Data is set to the result of base64url
decoding the &#8220;apv&#8221; value and Datalen is set to the number of
octets in Data.  Otherwise, Datalen is set to 0 and Data is set to
the empty octet sequence.</dd>
<dt id="term-54">SuppPubInfo</dt>
<dd>This is set to the keydatalen represented as a 32 bit
big endian integer.</dd>
<dt id="term-55">SuppPrivInfo</dt>
<dd>This is set to the empty octet sequence.</dd>
</dl>
<p>See Appendix D for an example key agreement computation using this
method.</p>
<p>Note: The Diffie-Hellman Key Agreement Method [RFC2631] uses a key
derivation function similar to the Concat KDF, but with fewer
parameters.  Rather than having separate PartyUInfo and PartyVInfo
parameters, it uses a single PartyAInfo parameter, which is a random
string provided by the sender, that contains 512 bits of information,
when provided.  It has no SuppPrivInfo parameter.  Should it be
appropriate for the application, key agreement can be performed in a
manner akin to RFC 2631 by using the PartyAInfo value as the &#8220;apu&#8221;
(Agreement PartyUInfo) header parameter value, when provided, and by
using no &#8220;apv&#8221; (Agreement PartyVInfo) header parameter.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.7.2</a> )</p>
</div>
</div>
<div class="section" id="composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8"></span><h3><a class="toc-backref" href="#id37">4.8. Composite Plaintext Encryption Algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#composite-plaintext-encryption-algorithms-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h3>
<p>This section defines two composite &#8220;<a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a>&#8221; algorithms that perform
plaintext encryption using non-AEAD algorithms and add an integrity
check calculation, so that the resulting composite algorithms are
AEAD.
These composite algorithms derive a Content Encryption Key (CEK)
and a Content Integrity Key (CIK) from a Content Master Key,
per Section 4.8.1.  They perform block encryption with AES CBC, per
Section 4.8.2.  Finally, they add an integrity check using HMAC SHA-2
algorithms of matching strength, per Section 4.8.3.</p>
<p>A 256 bit Content Master Key (CMK) value is used with the
&#8220;A128CBC+HS256&#8221; algorithm.  A 512 bit Content Master Key (CMK) value
is used with the &#8220;A256CBC+HS512&#8221; algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.2 of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8</a> )</p>
<div class="section" id="key-derivation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-1"></span><h4><a class="toc-backref" href="#id38">4.8.1. Key Derivation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#key-derivation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>The key derivation process derives CEK and CIK values from the CMK.
This section defines the specifics of deriving keys for the &#8220;enc&#8221;
algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;.</p>
<p>Key derivation is performed using the Concat KDF, as defined in
Section 5.8.1 of [NIST.800-56A], where the Digest Method is SHA-256
or SHA-512, respectively.  The Concat KDF parameters are set as
follows:</p>
<blockquote>
<div><dl class="docutils">
<dt>Z</dt>
<dd>This is set to the Content Master Key (CMK).</dd>
<dt>keydatalen</dt>
<dd>This is set to the number of bits in the desired output
key.</dd>
<dt>AlgorithmID</dt>
<dd>This is set to the concatenation of keydatalen
represented as a 32 bit big endian integer and the bytes of the
UTF-8 representation of the &#8220;enc&#8221; header parameter value.</dd>
<dt>PartyUInfo</dt>
<dd>If an &#8220;epu&#8221; (encryption PartyUInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;epu&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt>PartyVInfo</dt>
<dd>If an &#8220;epv&#8221; (encryption PartyVInfo) header parameter is
present, this is set to the result of base64url decoding the &#8220;epv&#8221;
value; otherwise, it is set to the empty byte string.</dd>
<dt>SuppPubInfo</dt>
<dd>This is set to the bytes of one of the ASCII strings
&#8220;Encryption&#8221; ([69, 110, 99, 114, 121, 112, 116, 105, 111, 110]) or
&#8220;Integrity&#8221; ([73, 110, 116, 101, 103, 114, 105, 116, 121])
respectively, depending upon whether the CEK or CIK is being
generated.</dd>
<dt>SuppPrivInfo</dt>
<dd>This is set to the empty byte string.</dd>
</dl>
</div></blockquote>
<p>To compute the CEK from the CMK, the ASCII label &#8220;Encryption&#8221; is used
for the SuppPubInfo value.  For &#8220;A128CBC+HS256&#8221;, the keydatalen is
128 and the digest function used is SHA-256.  For &#8220;A256CBC+HS512&#8221;,
the keydatalen is 256 and the digest function used is SHA-512.</p>
<p>To compute the CIK from the CMK, the ASCII label &#8220;Integrity&#8221; is used
for the SuppPubInfo value.  For &#8220;A128CBC+HS256&#8221;, the keydatalen is
256 and the digest function used is SHA-256.  For &#8220;A256CBC+HS512&#8221;,
the keydatalen is 512 and the digest function used is SHA-512.</p>
<p>Example derivation computations are shown in Appendices A.4 and A.5
of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.1</a>)</p>
<div class="section" id="iv-initialization-vector-header-parameter">
<span id="jwa-4-8-1-1"></span><h5><a class="toc-backref" href="#id39">4.8.1.1.  &#8220;iv&#8221; (Initialization Vector) Header Parameter</a><a class="headerlink" href="#iv-initialization-vector-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;iv&#8221; (initialization vector) header parameter value is the
base64url encoded representation of the Initialization Vector value
used for the key encryption operation.  This Header Parameter is
REQUIRED and MUST be understood and processed by implementations when
these algorithms are used.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">初期化ベクタ</p>
</div>
</div>
<div class="section" id="tag-authentication-tag-header-parameter">
<span id="jwa-4-8-1-2"></span><h5><a class="toc-backref" href="#id40">4.8.1.2.  &#8220;tag&#8221; (Authentication Tag) Header Parameter</a><a class="headerlink" href="#tag-authentication-tag-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;tag&#8221; (authentication tag) header parameter value is the
base64url encoded representation of the Authentication Tag value
resulting from the key encryption operation.  This Header Parameter
is REQUIRED and MUST be understood and processed by implementations
when these algorithms are used.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.8.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.8.1.2</a> )</p>
</div>
</div>
<div class="section" id="encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-2"></span><h4><a class="toc-backref" href="#id41">4.8.2. Encryption Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#encryption-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Cipher Block Chaining
(CBC) mode with PKCS #5 padding [AES] [NIST.800-38A] using 128 or 256
bit keys.  The &#8220;enc&#8221; header parameter values &#8220;A128CBC+HS256&#8221; or
&#8220;A256CBC+HS512&#8221; are respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 128 bits is REQUIRED with
these algorithms.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.2</a> )</p>
</div>
<div class="section" id="integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512">
<span id="jwa-4-8-3"></span><h4><a class="toc-backref" href="#id42">4.8.3. Integrity Calculation for &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;</a><a class="headerlink" href="#integrity-calculation-for-a128cbc-hs256-and-a256cbc-hs512" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of computing the JWE Integrity
Value for the &#8220;enc&#8221; algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;.
This value is computed as a MAC of the JWE parameters to be secured.</p>
<p>The MAC input value is the bytes of the ASCII representation of the
concatenation of the Encoded JWE Header, a period (&#8216;.&#8217;) character,
the Encoded JWE Encrypted Key, a second period character (&#8216;.&#8217;), the
Encoded JWE Initialization Vector, a third period (&#8216;.&#8217;) character,
and the Encoded JWE Ciphertext.</p>
<p>The CIK is used as the MAC key.</p>
<p>For &#8220;A128CBC+HS256&#8221;, HMAC SHA-256 is used as the MAC algorithm.  For
&#8220;A256CBC+HS512&#8221;, HMAC SHA-512 is used as the MAC algorithm.</p>
<p>The resulting MAC value is used as the JWE Integrity Value.  The same
integrity calculation is performed during decryption.  During
decryption, the computed integrity value must match the received JWE
Integrity Value.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.8.3</a> )</p>
</div>
</div>
<div class="section" id="plaintext-encryption-with-aes-gcm">
<span id="jwa-4-9"></span><h3><a class="toc-backref" href="#id43">4.9. Plaintext Encryption with AES GCM</a><a class="headerlink" href="#plaintext-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128 or 256 bit keys.  The &#8220;enc&#8221; header
parameter values &#8220;A128GCM&#8221; or &#8220;A256GCM&#8221; are used in this case.</p>
<p>The CMK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this algorithm.</p>
<p>The &#8220;additional authenticated data&#8221; parameter is used to secure the
header and key values.  The &#8220;additional authenticated data&#8221; value
used is the bytes of the ASCII representation of the concatenation of
the Encoded JWE Header, a period (&#8216;.&#8217;) character, the Encoded JWE
Encrypted Key, a second period character (&#8216;.&#8217;), and the Encoded JWE
Initialization Vector.  This same &#8220;additional authenticated data&#8221;
value is used when decrypting as well.</p>
<p>The requested size of the &#8220;authentication tag&#8221; output MUST be 128
bits, regardless of the key size.</p>
<p>As GCM is an AEAD algorithm, the JWE Integrity Value is set to be the
&#8220;authentication tag&#8221; value produced by the encryption.  During
decryption, the received JWE Integrity Value is used as the
&#8220;authentication tag&#8221; value.</p>
<p>Examples using this algorithm are shown in Appendices <a class="reference internal" href="jwe.html#jwe-appendix-a-1"><em>A.1</em></a>
and <em class="xref std std-ref">A.3</em> of [JWE].</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-4.9</a>)</p>
<div class="section" id="header-parameters-used-for-pbes2-key-encryption">
<span id="jwa-4-9-1"></span><h4><a class="toc-backref" href="#id44">4.9.1.  Header Parameters Used for PBES2 Key Encryption</a><a class="headerlink" href="#header-parameters-used-for-pbes2-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameters are used for Key Encryption with PBES2.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1</a> )</p>
<div class="section" id="p2s-pbes2-salt-parameter">
<span id="jwa-4-9-1-1"></span><h5><a class="toc-backref" href="#id45">4.9.1.1.  &#8220;p2s&#8221; (PBES2 salt) Parameter</a><a class="headerlink" href="#p2s-pbes2-salt-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2s&#8221; (PBES2 salt) header parameter contains the PBKDF2 salt
value (s) as a base64url encoded string.  This value MUST NOT be the
empty string.  This Header Parameter is REQUIRED and MUST be
understood and processed by implementations when these algorithms are
used.</p>
<p>The salt expands the possible keys that can be derived from a given
password.  [RFC2898] originally recommended a minimum salt length of
8 octets (since there is no concern here of a derived key being re-
used for different purposes).  The salt MUST be generated randomly;
see [RFC4086] for considerations on generating random values.
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.1</a> )</p>
</div>
<div class="section" id="p2c-pbes2-count-parameter">
<span id="jwa-4-9-1-2"></span><h5><a class="toc-backref" href="#id46">4.9.1.2.  &#8220;p2c&#8221; (PBES2 count) Parameter</a><a class="headerlink" href="#p2c-pbes2-count-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2c&#8221; (PBES2 count) header parameter contains the PBKDF2
iteration count (c), as an integer.  This value MUST NOT be less than
1, as per [RFC2898].  This Header Parameter is REQUIRED and MUST be
understood and processed by implementations when these algorithms are
used.</p>
<p>The iteration count adds computational expense, ideally compounded by
the possible range of keys introduced by the salt.  [RFC2898]
originally recommended a minimum iteration count of 1000.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.9.1.2</a> )</p>
</div>
</div>
</div>
<div class="section" id="aes-cbc-hmac-sha2-algorithms">
<span id="jwa-4-10"></span><h3><a class="toc-backref" href="#id47">4.10. AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h3>
<p>This section defines a family of authenticated encryption algorithms
built using a composition of Advanced Encryption Standard (AES)
in Cipher Block Chaining (CBC) mode with PKCS #5 padding [AES]
[NIST.800-38A] operations and HMAC [RFC2104] [SHS] operations.</p>
<p>This algorithm family is called AES_CBC_HMAC_SHA2.
It also defines two instances of this family,
one using 128 bit CBC keys and HMAC SHA-256
and the other using 256 bit CBC keys and HMAC SHA-512.</p>
<p>Test cases for these algorithms can be found in Appendix C.</p>
<p>These algorithms are based upon Authenticated Encryption
with AES-CBC and HMAC-SHA [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
performing the same cryptographic computations,
but with the <em class="xref std std-term">Initialization Vector</em> and <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">Authentication Tag</em></a> values
remaining separate,
rather than being concatenated with the Ciphertext value in the output representation.</p>
<p>This algorithm family is a generalization of the algorithm family
in [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
and can be used to implement those algorithms.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10</a> )</p>
<div class="section" id="conventions-used-in-defining-aes-cbc-hmac-sha2">
<span id="jwa-4-10-1"></span><h4><a class="toc-backref" href="#id48">4.10.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>We use the following notational conventions.</p>
<p>CBC-PKCS5-ENC(X, P) denotes the AES CBC encryption of P
using PKCS #5 padding using the cipher with the key X.</p>
<p>MAC(Y, M) denotes the application of
the Message Authentication Code (MAC) to the message M,
using the key Y.</p>
<p>The concatenation of two octet strings A and B is denoted as A || B.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.1</a> )</p>
</div>
<div class="section" id="generic-aes-cbc-hmac-sha2-algorithm">
<span id="jwa-4-10-2"></span><h4><a class="toc-backref" href="#id49">4.10.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><a class="headerlink" href="#generic-aes-cbc-hmac-sha2-algorithm" title="Permalink to this headline">¶</a></h4>
<p>This section defines AES_CBC_HMAC_SHA2 in a manner
that is independent of the AES CBC key size
or hash function to be used.</p>
<p>Section 4.10.2.1 and Section 4.10.2.2 define the generic encryption
and decryption algorithms.</p>
<p>Section 4.10.3 and Section 4.10.4 define instances of AES_CBC_HMAC_SHA2 t
hat specify those details.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2</a> )</p>
<div class="section" id="aes-cbc-hmac-sha2-encryption">
<span id="jwa-4-10-2-1"></span><h5><a class="toc-backref" href="#id50">4.10.2.1. AES_CBC_HMAC_SHA2 Encryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-encryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated encryption algorithm takes as input four octet strings:
a secret key K,
a plaintext P,
associated data A,
and an initialization vector IV.</p>
<p>The <em class="xref std std-term">authenticated ciphertext</em> value E and the <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">authentication tag</em></a> value T
are provided as outputs.</p>
<p>The data in the plaintext are encrypted and authenticated,
and the associated data are authenticated, but not encrypted.</p>
<p>The encryption process is as follows,
or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as follows.</p>
<p>Each of these two keys is an octet string.</p>
<blockquote>
<div><p>MAC_KEY consists of the initial MAC_KEY_LEN octets of K, in order.</p>
<p>ENC_KEY consists of the final ENC_KEY_LEN octets of K, in order.</p>
</div></blockquote>
<p>Here we denote the number of octets in the MAC_KEY as MAC_KEY_LEN,
and the number of octets in ENC_KEY as ENC_KEY_LEN;
the values of these parameters are specified by the AEAD algorithms
(in Section 4.10.3 and Section 4.10.4).</p>
<p>The number of octets in the input key K is the sum of MAC_KEY_LEN and
ENC_KEY_LEN.
When generating the secondary keys from K,
MAC_KEY and ENC_KEY MUST NOT overlap.</p>
<p>Note that the MAC key comes before
the encryption key in the input key K;
this is in the opposite order of the algorithm names in the identifier
&#8220;AES_CBC_HMAC_SHA2&#8221;.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>K (Secret Key ) = MAC_KEY + ENC_KEY</p>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>MAC_KEY</td>
<td>ENC_KEY</td>
</tr>
</tbody>
</table>
<p>&lt;&#8212; MAC_KEY_LEN  &#8211;&gt; &lt;&#8211; ENC_KEY_LEN   &#8211;&gt;</p>
<p class="last">IV = 128 bit (16 octet )</p>
</div>
</li>
<li><p class="first">The Initialization Vector (IV) used is a 128 bit value generated
randomly or pseudorandomly for use in the cipher.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IVは固定で128bit(16octet)</p>
</div>
</li>
<li><p class="first">The plaintext is CBC encrypted using PKCS #5 padding using
ENC_KEY as the key, and the IV.
We denote the ciphertext output from this step as E.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>プレーンテキストを ENC_KEYとIVを使って PKCS#5 パディングでCBC暗号化。</li>
</ul>
</div>
</li>
<li><p class="first">The octet string AL is equal to the number of bits in A expressed
as a 64-bit unsigned integer in network byte order.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>AL は 関連データ(A)のビット長。のオクテット数。</li>
</ul>
</div>
</li>
<li><p class="first">A <em class="xref std std-term">message authentication tag</em> T is computed by applying HMAC
[RFC2104] to the following data, in order:</p>
<blockquote>
<div><p>the associated data A,</p>
<p>the initialization vector IV,</p>
<p>the ciphertext E computed in the previous step, and</p>
<p>the octet string AL defined above.</p>
</div></blockquote>
<p>The string MAC_KEY is used as the MAC key.
We denote the output of the MAC computed in this step as M.</p>
<p>The first T_LEN bits of M are used as T.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>T_LENは実際のアルゴリズムで異なります。</li>
</ul>
</div>
</li>
<li><p class="first">The Ciphertext E and the Authentication Tag T are returned as the
outputs of the authenticated encryption.</p>
</li>
</ol>
</div></blockquote>
<p>The encryption process can be illustrated as follows.</p>
<p>Here K, P, A,
IV, and E denote the key, plaintext, associated data, initialization
vector, and ciphertext, respectively.</p>
<div class="highlight-python"><pre>MAC_KEY = initial MAC_KEY_LEN bytes of K,

ENC_KEY = final ENC_KEY_LEN bytes of K,

E = CBC-PKCS5-ENC(ENC_KEY, P),

M = MAC(MAC_KEY, A || IV || E || AL),

T = initial T_LEN bytes of M.</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.1</a> )</p>
</div>
<div class="section" id="aes-cbc-hmac-sha2-decryption">
<span id="jwa-4-10-2-2"></span><h5><a class="toc-backref" href="#id51">4.10.2.2. AES_CBC_HMAC_SHA2 Decryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-decryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated decryption operation has four inputs:
K, A, E, and T as defined above.</p>
<p>It has only a single output, either a plaintext value P or a special symbol FAIL
that indicates that the inputs are not authentic.</p>
<p>The authenticated decryption algorithm is as follows, or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as in Step 1 of Section 4.10.2.1.</li>
<li>The integrity and authenticity of A and E are checked by
computing an HMAC with the inputs as in Step 5 of
Section 4.10.2.1.  The value T, from the previous step, is
compared to the first MAC_KEY length bits of the HMAC output.  If
those values are identical, then A and E are considered valid,
and processing is continued.  Otherwise, all of the data used in
the MAC validation are discarded, and the AEAD decryption
operation returns an indication that it failed, and the operation
halts.  (But see Section 10 of [JWE] for security considerations
on thwarting timing attacks.)</li>
<li>The value E is decrypted and the PKCS #5 padding is removed.  The
value IV is used as the initialization vector.  The value ENC_KEY
is used as the decryption key.</li>
<li>The plaintext value is returned.</li>
</ol>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.2.2</a> )</p>
</div>
</div>
<div class="section" id="aes-128-cbc-hmac-sha-256">
<span id="jwa-4-10-3"></span><h4><a class="toc-backref" href="#id52">4.10.3. AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h4>
<p>This algorithm is a concrete instantiation of
the generic AES_CBC_HMAC_SHA2 algorithm above.</p>
<p>It uses the HMAC message authentication code [RFC2104]
with the SHA-256 hash function [SHS]
to provide message authentication,
with the HMAC output truncated to 128 bits,
corresponding to the HMAC-SHA-256-128 algorithm defined in [RFC4868].</p>
<p>For encryption,
it uses AES in the Cipher Block Chaining (CBC) mode of operation
as defined in Section 6.2 of [NIST.800-38A], with PKCS #5 padding.</p>
<p>The input key K is 32 octets long.</p>
<p>The AES CBC IV is 16 octets long.  ENC_KEY_LEN is 16 octets.</p>
<p>The SHA-256 hash algorithm is used in HMAC.
MAC_KEY_LEN is 16 octets.</p>
<p>The HMAC-SHA-256 output is truncated to T_LEN=16 octets,
by stripping off the final 16 octets.</p>
<div class="highlight-python"><pre>K (Secret Key ) = MAC_KEY + ENC_KEY (32 octet )

+----------------------+----------------------+
| MAC_KEY              | ENC_KEY              |
+----------------------+----------------------+

&lt;--- MAC_KEY_LEN(16)--&gt; &lt;-- ENC_KEY_LEN(16) --&gt;

IV = 128 bit (16 octet )</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-4.10.3</a> )</p>
</div>
<div class="section" id="aes-192-cbc-hmac-sha-384">
<span id="jwa-4-10-4"></span><h4><a class="toc-backref" href="#id53">4.10.4.  AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h4>
<p>AES_192_CBC_HMAC_SHA_384 is based on AES_128_CBC_HMAC_SHA_256, but
with the following differences:</p>
<blockquote>
<div><p>A 192 bit AES CBC key is used instead of 128.</p>
<p>SHA-384 is used in HMAC instead of SHA-256.</p>
<p>ENC_KEY_LEN is 24 octets instead of 16.</p>
<p>MAC_KEY_LEN is 24 octets instead of 16.</p>
<p>The length of the input key K is 48 octets instead of 32.</p>
<p>The HMAC SHA-384 value is truncated to T_LEN=24 octets instead of
16.</p>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.4</a> )</p>
</div>
<div class="section" id="aes-256-cbc-hmac-sha-512">
<span id="jwa-4-10-5"></span><h4><a class="toc-backref" href="#id54">4.10.5.  AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h4>
<p>AES_256_CBC_HMAC_SHA_512 is based on AES_128_CBC_HMAC_SHA_256, but
with the following differences:</p>
<blockquote>
<div><p>A 256 bit AES CBC key is used instead of 128.</p>
<p>SHA-512 is used in HMAC instead of SHA-256.</p>
<p>ENC_KEY_LEN is 32 octets instead of 16.</p>
<p>MAC_KEY_LEN is 32 octets instead of 16.</p>
<p>The length of the input key K is 64 octets instead of 32.</p>
<p>The HMAC SHA-512 value is truncated to T_LEN=32 octets instead of
16.</p>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.5</a> )</p>
</div>
<div class="section" id="plaintext-encryption-with-aes-cbc-hmac-sha2">
<span id="jwa-4-10-6"></span><h4><a class="toc-backref" href="#id55">4.10.6.  Plaintext Encryption with AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#plaintext-encryption-with-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>The algorithm value &#8220;A128CBC-HS256&#8221; is used as the &#8220;alg&#8221; value when
using AES_128_CBC_HMAC_SHA_256 with JWE.  The algorithm value
&#8220;A192CBC-HS384&#8221; is used as the &#8220;alg&#8221; value when using
AES_192_CBC_HMAC_SHA_384 with JWE.  The algorithm value
&#8220;A256CBC-HS512&#8221; is used as the &#8220;alg&#8221; value when using
AES_256_CBC_HMAC_SHA_512 with JWE.  The Additional Authenticated Data
value used is the octets of the ASCII representation of the Encoded
JWE Header value.  The JWE Initialization Vector value used is the IV
value.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.10.6</a> )</p>
</div>
</div>
<div class="section" id="jwa-4-11">
<span id="id2"></span><h3><a class="toc-backref" href="#id56">4.11.  Plaintext Encryption with AES GCM</a><a class="headerlink" href="#jwa-4-11" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting the JWE Plaintext
with Advanced Encryption Standard (AES) in Galois/Counter Mode (GCM)
[AES] [NIST.800-38D] using 128, 192, or 256 bit keys.  The &#8220;enc&#8221;
header parameter values &#8220;A128GCM&#8221;, &#8220;A192GCM&#8221;, or &#8220;A256GCM&#8221; are
respectively used in this case.</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is REQUIRED with this
algorithm.</p>
<p>The Additional Authenticated Data value used is the octets of the
ASCII representation of the Encoded JWE Header value.</p>
<p>The requested size of the Authentication Tag output MUST be 128 bits,
regardless of the key size.</p>
<p>The JWE Authentication Tag is set to be the Authentication Tag value
produced by the encryption.  During decryption, the received JWE
Authentication Tag is used as the Authentication Tag value.</p>
<p>An example using this algorithm is shown in Appendix A.1 of [JWE].</p>
<p>(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.11">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.11</a> )</p>
</div>
<div class="section" id="additional-encryption-algorithms-and-parameters">
<span id="jwa-4-12"></span><h3><a class="toc-backref" href="#id57">4.12.  Additional Encryption Algorithms and Parameters</a><a class="headerlink" href="#additional-encryption-algorithms-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWEs with corresponding
&#8220;alg&#8221; (algorithm) and &#8220;enc&#8221; (encryption method) header parameter
values being defined to refer to them.  New &#8220;alg&#8221; and &#8220;enc&#8221; header
parameter values SHOULD either be registered in the IANA JSON Web
Signature and Encryption Algorithms registry Section 6.1 or be a
value that contains a Collision Resistant Namespace.  In particular,
it is permissible to use the algorithm identifiers defined in XML
Encryption [W3C.REC-xmlenc-core-20021210], XML Encryption 1.1
[W3C.CR-xmlenc-core1-20120313], and related specifications as &#8220;alg&#8221;
and &#8220;enc&#8221; values.</p>
<p>As indicated by the common registry, JWSs and JWEs share a common
&#8220;alg&#8221; value space.  The values used by the two specifications MUST be
distinct, as the &#8220;alg&#8221; value can be used to determine whether the
object is a JWS or JWE.</p>
<p>Likewise, additional reserved Header Parameter Names can be defined
via the IANA JSON Web Signature and Encryption Header Parameters
registry [JWS].  As indicated by the common registry, JWSs and JWEs
share a common header parameter space; when a parameter is used by
both specifications, its usage must be compatible between the
specifications.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.12">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-4.12</a> )</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-jwk">
<span id="jwa-5"></span><h2><a class="toc-backref" href="#id58">5. Cryptographic Algorithms for JWK</a><a class="headerlink" href="#cryptographic-algorithms-for-jwk" title="Permalink to this headline">¶</a></h2>
<p>A JSON Web Key (JWK) [JWK] is a JavaScript Object Notation (JSON)
[RFC4627] data structure that represents a cryptographic key.</p>
<p>A JSON Web Key Set (JWK Set) is a JSON data structure for representing a set
of JWKs.  This section specifies a set of key types to be used for
those keys and the key type specific parameters for representing
those keys.</p>
<p>Parameters are defined for public, private, and symmetric keys.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5</a> )</p>
<div class="section" id="kty-key-type-parameter-values-for-jwk">
<span id="jwa-5-1"></span><h3><a class="toc-backref" href="#id59">5.1. &#8220;kty&#8221; (Key Type) Parameter Values for JWK</a><a class="headerlink" href="#kty-key-type-parameter-values-for-jwk" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;kty&#8221; (key type) parameter values
that are defined by this specification for use in JWKs.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="52%" />
<col width="28%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>kty
Parameter
Value</td>
<td>Key Type</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>EC</td>
<td>Elliptic Curve [DSS] key type</td>
<td>RECOMMENDED+</td>
</tr>
<tr class="row-odd"><td>RSA</td>
<td>RSA [RFC3447] key type</td>
<td>REQUIRED</td>
</tr>
<tr class="row-even"><td>oct</td>
<td>Octet sequence key type (used to
represent symmetric keys)</td>
<td>RECOMMENDED+</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>All the names are short because a core goal of JWK is for the
representations to be compact.
However, there is no a priori length restriction on &#8220;kty&#8221; values.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.1</a> )</p>
</div>
<div class="section" id="jwk-parameters-for-elliptic-curve-keys">
<span id="jwa-5-2"></span><h3><a class="toc-backref" href="#id60">5.2. JWK Parameters for Elliptic Curve Keys</a><a class="headerlink" href="#jwk-parameters-for-elliptic-curve-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent Elliptic Curve [DSS] keys.
In this case,
the &#8220;kty&#8221; member value MUST be &#8220;EC&#8221;.
Furthermore, these additional members MUST be present:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="#jwa-5-2-1"><em>5.2.1. &#8220;crv&#8221; (Curve) Parameter</em></a></li>
<li><a class="reference internal" href="#jwa-5-2-2"><em>5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</em></a></li>
<li><a class="reference internal" href="#jwa-5-2-3"><em>5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</em></a></li>
<li>agl -&gt; kty</li>
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2</a></li>
</ul>
</div>
<div class="section" id="crv-curve-parameter">
<span id="jwa-5-2-1"></span><h4><a class="toc-backref" href="#id61">5.2.1. &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#crv-curve-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;crv&#8221; (curve) member identifies the cryptographic curve used with the key.
Curve values from <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a> used by this specification are:</p>
<blockquote>
<div><ul class="simple">
<li>&#8220;P-256&#8221;</li>
<li>&#8220;P-384&#8221;</li>
<li>&#8220;P-521&#8221;</li>
</ul>
</div></blockquote>
<p>Additional &#8220;crv&#8221; values MAY be used, provided they are understood by
implementations using that Elliptic Curve key.
The &#8220;crv&#8221; value is a <strong>case sensitive string</strong>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.1</a></li>
<li>05 から変わらず</li>
</ul>
</div>
<div class="section" id="jwa-5-2-1-1">
<span id="id3"></span><h5><a class="toc-backref" href="#id62">5.2.1.1.  &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#jwa-5-2-1-1" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;crv&#8221; (curve) member identifies the cryptographic curve used with
the key.  Curve values from [DSS] used by this specification are:</p>
<blockquote>
<div><p>o  &#8220;P-256&#8221;</p>
<p>o  &#8220;P-384&#8221;</p>
<p>o  &#8220;P-521&#8221;</p>
</div></blockquote>
<p>Additional &#8220;crv&#8221; values MAY be used, provided they are understood by
implementations using that Elliptic Curve key.  The &#8220;crv&#8221; value is a
case sensitive string.
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.1</a>)</p>
</div>
<div class="section" id="x-x-coordinate-parameter">
<span id="jwa-5-2-1-2"></span><h5><a class="toc-backref" href="#id63">5.2.1.2.  &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#x-x-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as an octet sequence.  The
array representation MUST NOT be shortened to omit any leading zero
octets contained in the value.  For instance, when representing 521
bit integers, the octet sequence to be base64url encoded MUST contain
66 octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.2</a>  )</p>
</div>
<div class="section" id="y-y-coordinate-parameter">
<span id="jwa-5-2-1-3"></span><h5><a class="toc-backref" href="#id64">5.2.1.3.  &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#y-y-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as an octet sequence.  The
array representation MUST NOT be shortened to omit any leading zero
octets contained in the value.  For instance, when representing 521
bit integers, the octet sequence to be base64url encoded MUST contain
66 octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.1.3</a> )</p>
</div>
</div>
<div class="section" id="jwa-5-2-2">
<span id="id4"></span><h4><a class="toc-backref" href="#id65">5.2.2. &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#jwa-5-2-2" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the elliptic curve point.
It is represented as the base64url encoding of the coordinate&#8217;s <strong>big endian representation</strong>
as a byte array.
The array representation MUST not be shortened
to omit any leading zero bytes contained in the value.
For instance,
when representing 521 bit integers,
the byte array to be base64url encoded MUST contain 66 bytes,
including any leading zero bytes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.2</a></li>
<li>05 と変わらず</li>
</ul>
</div>
<div class="section" id="d-ecc-private-key-parameter">
<span id="jwa-5-2-2-1"></span><h5><a class="toc-backref" href="#id66">5.2.2.1.  &#8220;d&#8221; (ECC Private Key) Parameter</a><a class="headerlink" href="#d-ecc-private-key-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (ECC private key) member contains the Elliptic Curve private
key value.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
array representation MUST NOT be shortened to omit any leading zero
octets.  For instance, when representing 521 bit integers, the octet
sequence to be base64url encoded MUST contain 66 octets, including
any leading zero octets.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.2.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.2.2.1</a> )</p>
</div>
</div>
<div class="section" id="jwa-5-2-3">
<span id="id5"></span><h4><a class="toc-backref" href="#id67">5.2.3. &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#jwa-5-2-3" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the coordinate&#8217;s big endian representation as a byte array.  The
array representation MUST not be shortened to omit any leading zero
bytes contained in the value.  For instance, when representing 521
bit integers, the byte array to be base64url encoded MUST contain 66
bytes, including any leading zero bytes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-08#section-5.2.3</a></li>
<li>05 と変わらず</li>
</ul>
</div>
</div>
</div>
<div class="section" id="jwk-parameters-for-rsa-keys">
<span id="jwa-5-3"></span><h3><a class="toc-backref" href="#id68">5.3. JWK Parameters for RSA Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent RSA <a class="reference internal" href="jwe.html#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a> keys.
In this case,
the &#8220;<em class="xref std std-term">kty</em>&#8221; member value MUST be &#8220;<strong>RSA</strong>&#8221;.</p>
<p>Furthermore, these additional members MUST be present:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="#jwa-5-3-1"><em>5.3.1.  JWK Parameters for RSA Public Keys</em></a></li>
<li><a class="reference internal" href="#jwa-5-3-2"><em>5.3.2.  JWK Parameters for RSA Private Keys</em></a></li>
<li>alg -&gt; kty</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3</a> )</p>
<div class="section" id="jwk-parameters-for-rsa-public-keys">
<span id="jwa-jwk-rsa-public"></span><span id="jwa-5-3-1"></span><h4><a class="toc-backref" href="#id69">5.3.1.  JWK Parameters for RSA Public Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-public-keys" title="Permalink to this headline">¶</a></h4>
<p>These members MUST be present for RSA public keys:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1</a> )</p>
<div class="section" id="n-modulus-parameter">
<span id="jwa-n"></span><span id="jwa-mod"></span><span id="jwa-5-3-1-1"></span><h5><a class="toc-backref" href="#id70">5.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a><a class="headerlink" href="#n-modulus-parameter" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>The &#8220;n&#8221; (modulus) member contains the modulus value</div></blockquote>
<p>for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a>
of the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST NOT be shortened to omit any leading zero octets.
For instance,
when representing 2048 bit integers,
the octet sequence to be base64url encoded MUST contain 256 octets,
including any leading zero octets.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>mod -&gt; n に変更</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.1</a> )</p>
</div>
<div class="section" id="e-exponent-parameter">
<span id="jwa-e"></span><span id="jwa-xpo"></span><span id="jwa-5-3-1-2"></span><h5><a class="toc-backref" href="#id71">5.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a><a class="headerlink" href="#e-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;e&#8221; (exponent) member contains the exponent value
for the RSA <strong>public key</strong>.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of
the value&#8217;s <strong>unsigned big endian</strong> representation as an octet sequence.</p>
<p>The array representation MUST utilize the minimum number of octets to
represent the value.</p>
<p>For instance,
when representing the value 65537,
the octet sequence to be base64url encoded MUST consist of the three octets [1, 0, 1].</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.1.2</a> )</p>
</div>
</div>
<div class="section" id="jwk-parameters-for-rsa-private-keys">
<span id="jwa-5-3-2"></span><h4><a class="toc-backref" href="#id72">5.3.2.  JWK Parameters for RSA Private Keys</a><a class="headerlink" href="#jwk-parameters-for-rsa-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent RSA public keys,
the following members are used to represent RSA private keys.</p>
<p>All are REQUIRED for RSA private keys except for &#8220;oth&#8221;,
which is sometimes REQUIRED and sometimes MUST NOT be present,
as described below.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2</a> )</p>
<div class="section" id="d-private-exponent-parameter">
<span id="jwa-5-3-2-1"></span><h5><a class="toc-backref" href="#id73">5.3.2.1.  &#8220;d&#8221; (Private Exponent) Parameter</a><a class="headerlink" href="#d-private-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (<strong>private exponent</strong>) member contains
the private exponent value for the RSA <strong>private key</strong>.</p>
<p>It is represented as the base64url encoding
of the value&#8217;s unsigned big endian representation as an octet
sequence.
The array representation MUST NOT be shortened to omit any
leading zero octets.  For instance, when representing 2048 bit
integers, the octet sequence to be base64url encoded MUST contain 256
octets, including any leading zero octets.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.1</a> )</p>
</div>
<div class="section" id="p-first-prime-factor-parameter">
<span id="jwa-5-3-2-2"></span><h5><a class="toc-backref" href="#id74">5.3.2.2.  &#8220;p&#8221; (First Prime Factor) Parameter</a><a class="headerlink" href="#p-first-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p&#8221; (<strong>first prime factor</strong>) member contains the first prime factor,
a <strong>positive integer</strong>.
It is represented as the base64url encoding of
the value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.2</a> )</p>
</div>
<div class="section" id="q-second-prime-factor-parameter">
<span id="jwa-5-3-2-3"></span><h5><a class="toc-backref" href="#id75">5.3.2.3.  &#8220;q&#8221; (Second Prime Factor) Parameter</a><a class="headerlink" href="#q-second-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;q&#8221; (<strong>second prime factor</strong>) member contains the second prime
factor, a <strong>positive integer</strong>.</p>
<p>It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.3</a> )</p>
</div>
<div class="section" id="dp-first-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-4"></span><h5><a class="toc-backref" href="#id76">5.3.2.4.  &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dp-first-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (<strong>first factor CRT exponent</strong>) member contains
the Chinese Remainder Theorem (CRT) exponent of the first factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.4</a> )</p>
</div>
<div class="section" id="dq-second-factor-crt-exponent-parameter">
<span id="jwa-5-3-2-5"></span><h5><a class="toc-backref" href="#id77">5.3.2.5.  &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dq-second-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dq&#8221; (second factor CRT exponent) member contains
the Chinese Remainder Theorem (CRT) exponent of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.5</a> )</p>
</div>
<div class="section" id="qi-first-crt-coefficient-parameter">
<span id="jwa-5-3-2-6"></span><h5><a class="toc-backref" href="#id78">5.3.2.6.  &#8220;qi&#8221; (First CRT Coefficient) Parameter</a><a class="headerlink" href="#qi-first-crt-coefficient-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first CRT coefficient) member contains
the Chinese Remainder Theorem (CRT) coefficient of the second factor,
a positive integer.</p>
<p>It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.6</a> )</p>
</div>
<div class="section" id="oth-other-primes-info-parameter">
<span id="jwa-5-3-2-7"></span><h5><a class="toc-backref" href="#id79">5.3.2.7.  &#8220;oth&#8221; (Other Primes Info) Parameter</a><a class="headerlink" href="#oth-other-primes-info-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;oth&#8221; (other primes info) member contains an array of information
about any third and subsequent primes, should they exist.  When only
two primes have been used (the normal case), this parameter MUST be
omitted.  When three or more primes have been used, the number of
array elements MUST be the number of primes used minus two.  Each
array element MUST be an object with the following members:</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7</a> )</p>
<div class="section" id="r-prime-factor">
<span id="jwa-5-3-2-7-1"></span><h6><a class="toc-backref" href="#id80">5.3.2.7.1.  &#8220;r&#8221; (Prime Factor)</a><a class="headerlink" href="#r-prime-factor" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;r&#8221; (prime factor) parameter within an &#8220;oth&#8221; array member
represents the value of a subsequent prime factor, a positive
integer.  It is represented as the base64url encoding of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.1</a> )</p>
</div>
<div class="section" id="d-factor-crt-exponent">
<span id="jwa-5-3-2-7-2"></span><h6><a class="toc-backref" href="#id81">5.3.2.7.2.  &#8220;d&#8221; (Factor CRT Exponent)</a><a class="headerlink" href="#d-factor-crt-exponent" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;d&#8221; (Factor CRT Exponent) parameter within an &#8220;oth&#8221; array member
represents the CRT exponent of the corresponding prime factor, a
positive integer.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.2</a> )</p>
</div>
<div class="section" id="t-factor-crt-coefficient">
<span id="jwa-5-3-2-7-3"></span><h6><a class="toc-backref" href="#id82">5.3.2.7.3.  &#8220;t&#8221; (Factor CRT Coefficient)</a><a class="headerlink" href="#t-factor-crt-coefficient" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;t&#8221; (factor CRT coefficient) parameter within an &#8220;oth&#8221; array
member represents the CRT coefficient of the corresponding prime
factor, a positive integer.  It is represented as the base64url
encoding of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-11#section-5.3.2.7.3</a> )</p>
</div>
</div>
</div>
</div>
<div class="section" id="additional-key-algorithm-families-and-parameters">
<span id="jwa-5-3-3"></span><h3><a class="toc-backref" href="#id83">5.4. Additional Key Algorithm Families and Parameters</a><a class="headerlink" href="#additional-key-algorithm-families-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Public keys using additional algorithm families MAY be represented
using JWK data structures with corresponding &#8220;alg&#8221; (algorithm family)
parameter values being defined to refer to them.  New &#8220;alg&#8221; parameter
values SHOULD either be registered in the IANA JSON Web Key Algorithm
Families registry Section 6.2 or be a URI that contains a Collision
Resistant Namespace.</p>
<p>Likewise, parameters for representing keys for additional algorithm
families or additional key properties SHOULD either be registered in
the IANA JSON Web Key Parameters registry [JWK] or be a URI that
contains a Collision Resistant Namespace.</p>
<p>(draft 05 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-05#section-5.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-05#section-5.4</a> )</p>
<p>The &#8220;k&#8221; (key value) member contains the value of the symmetric (or
other single-valued) key.  It is represented as the base64url
encoding of the octet sequence containing the key value.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.3.3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.3.3.1</a> )</p>
</div>
<div class="section" id="additional-key-types-and-parameters">
<span id="jwa-5-4"></span><h3><a class="toc-backref" href="#id84">5.4.  Additional Key Types and Parameters</a><a class="headerlink" href="#additional-key-types-and-parameters" title="Permalink to this headline">¶</a></h3>
<p>Keys using additional key types can be represented using JWK data
structures with corresponding &#8220;kty&#8221; (key type) parameter values being
defined to refer to them.  New &#8220;kty&#8221; parameter values SHOULD either
be registered in the IANA JSON Web Key Types registry Section 6.2 or
be a value that contains a Collision Resistant Namespace.</p>
<p>Likewise, parameters for representing keys for additional key types
or additional key properties SHOULD either be registered in the IANA
JSON Web Key Parameters registry [JWK] or be a value that contains a
Collision Resistant Namespace.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-5.4</a> )</p>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jwa-6"></span><h2><a class="toc-backref" href="#id85">6. IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>The following registration procedure is used for all the registries
established by this specification.</p>
<p>Values are registered with a Specification Required [RFC5226] after a
two-week review period on the [TBD]&#64;ietf.org mailing list, on the
advice of one or more Designated Experts.  However, to allow for the
allocation of values prior to publication, the Designated Expert(s)
may approve registration once they are satisfied that such a
specification will be published.</p>
<p>Registration requests must be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject (e.g., &#8220;Request
for access token type: example&#8221;). [[ Note to RFC-EDITOR: The name of
the mailing list should be determined in consultation with the IESG
and IANA.  Suggested name: jose-reg-review. ]]</p>
<p>Within the review period, the Designated Expert(s) will either
approve or deny the registration request, communicating this decision
to the review list and IANA.  Denials should include an explanation
and, if applicable, suggestions as to how to make the request
successful.</p>
<p>IANA must only accept registry updates from the Designated Expert(s)
and should direct all requests for registration to the review mailing
list.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-6">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#section-6</a> )</p>
<div class="section" id="json-web-signature-and-encryption-algorithms-registry">
<span id="jwa-6-1"></span><h3><a class="toc-backref" href="#id86">6.1.  JSON Web Signature and Encryption Algorithms Registry</a><a class="headerlink" href="#json-web-signature-and-encryption-algorithms-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the IANA JSON Web Signature and
Encryption Algorithms registry for values of the JWS and JWE &#8220;alg&#8221;
(algorithm) and &#8220;enc&#8221; (encryption method) header parameters.  The
registry records the algorithm name, the algorithm usage locations
from the set &#8220;alg&#8221; and &#8220;enc&#8221;, implementation requirements, and a
reference to the specification that defines it.  The same algorithm
name MAY be registered multiple times, provided that the sets of
usage locations are disjoint.  The implementation requirements of an
algorithm MAY be changed over time by the Designated Experts(s) as
the cryptographic landscape evolves, for instance, to change the
status of an algorithm to DEPRECATED, or to change the status of an
algorithm from OPTIONAL to RECOMMENDED or REQUIRED.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1</a> )</p>
<div class="section" id="template">
<span id="jwa-6-1-1"></span><h4><a class="toc-backref" href="#id87">6.1.1.  Template</a><a class="headerlink" href="#template" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  This name is case
sensitive.  Names that match other registered names in a case
insensitive manner SHOULD NOT be accepted.</dd>
<dt>Algorithm Usage Location(s):</dt>
<dd>The algorithm usage, which must be one or more of the values &#8220;alg&#8221;
or &#8220;enc&#8221;.</dd>
<dt>Implementation Requirements:</dt>
<dd>The algorithm implementation requirements, which must be one the
words REQUIRED, RECOMMENDED, OPTIONAL, or DEPRECATED.  Optionally,
the word can be followed by a &#8220;+&#8221; or &#8220;-&#8221;.  The use of &#8220;+&#8221;
indicates that the requirement strength is likely to be increased
in a future version of the specification.  The use of &#8220;-&#8221;
indicates that the requirement strength is likely to be decreased
in a future version of the specification.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IETF&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.1</a> )</p>
</div>
<div class="section" id="initial-registry-contents">
<span id="jwa-6-1-2"></span><h4><a class="toc-backref" href="#id88">6.1.2.  Initial Registry Contents</a><a class="headerlink" href="#initial-registry-contents" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Algorithm Name: &#8220;HS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;HS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;HS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ES512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;none&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RSA1_5&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;RSA-OAEP&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;dir&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;ECDH-ES+A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.1 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256GCMKW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A128KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A192KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;PBES2-HS256+A256KW&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128CBC-HS256&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192CBC-HS384&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256CBC-HS512&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A128GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A192GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: OPTIONAL</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
<li>Algorithm Name: &#8220;A256GCM&#8221;</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>Implementation Requirements: RECOMMENDED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.2 of [[ this document ]]</li>
</ul>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.1.2</a> )</p>
</div>
</div>
<div class="section" id="json-web-key-types-registry">
<span id="jwa-6-2"></span><h3><a class="toc-backref" href="#id89">6.2.  JSON Web Key Types Registry</a><a class="headerlink" href="#json-web-key-types-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the IANA JSON Web Key Types registry
for values of the JWK &#8220;kty&#8221; (key type) parameter.  The registry
records the &#8220;kty&#8221; value and a reference to the specification that
defines it.  This specification registers the values defined in
Section 5.1.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2</a> )</p>
<div class="section" id="registration-template">
<span id="jwa-6-2-1"></span><h4><a class="toc-backref" href="#id90">6.2.1.  Registration Template</a><a class="headerlink" href="#registration-template" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;kty&#8221; Parameter Value:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  This name is case
sensitive.  Names that match other registered names in a case
insensitive manner SHOULD NOT be accepted.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IETF&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Implementation Requirements:</dt>
<dd>The algorithm implementation requirements, which must be one the
words REQUIRED, RECOMMENDED, OPTIONAL, or DEPRECATED.  Optionally,
the word can be followed by a &#8220;+&#8221; or &#8220;-&#8221;.  The use of &#8220;+&#8221;
indicates that the requirement strength is likely to be increased
in a future version of the specification.  The use of &#8220;-&#8221;
indicates that the requirement strength is likely to be decreased
in a future version of the specification.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2.1</a> )</p>
</div>
<div class="section" id="jwa-6-2-2">
<span id="id6"></span><h4><a class="toc-backref" href="#id91">6.2.2.  Initial Registry Contents</a><a class="headerlink" href="#jwa-6-2-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>&#8220;kty&#8221; Parameter Value: &#8220;EC&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.2 of [[ this document ]]</li>
<li>&#8220;kty&#8221; Parameter Value: &#8220;RSA&#8221;</li>
<li>Implementation Requirements: REQUIRED</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3 of [[ this document ]]</li>
<li>&#8220;kty&#8221; Parameter Value: &#8220;oct&#8221;</li>
<li>Implementation Requirements: RECOMMENDED+</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.3 of [[ this document ]]</li>
</ul>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.2.2</a> )</p>
</div>
</div>
<div class="section" id="json-web-key-parameters-registration">
<span id="jwa-6-3"></span><h3><a class="toc-backref" href="#id92">6.3.  JSON Web Key Parameters Registration</a><a class="headerlink" href="#json-web-key-parameters-registration" title="Permalink to this headline">¶</a></h3>
<p>This specification registers the parameter names defined in Sections
5.2, 5.3, and 5.3.3 in the IANA JSON Web Key Parameters registry
[JWK].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.3</a> )</p>
<div class="section" id="registry-contents">
<span id="jwa-6-3-1"></span><h4><a class="toc-backref" href="#id93">6.3.1.  Registry Contents</a><a class="headerlink" href="#registry-contents" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Parameter Name: &#8220;crv&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.2.1.1 of [[ this document ]]</li>
<li>Parameter Name: &#8220;x&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.2.1.2 of [[ this document ]]</li>
<li>Parameter Name: &#8220;y&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.2.1.3 of [[ this document ]]</li>
<li>Parameter Name: &#8220;d&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.2.2.1 of [[ this document ]]</li>
<li>Parameter Name: &#8220;n&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.1.1 of [[ this document ]]</li>
<li>Parameter Name: &#8220;e&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.1.2 of [[ this document ]]</li>
<li>Parameter Name: &#8220;d&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.1 of [[ this document ]]</li>
<li>Parameter Name: &#8220;p&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.2 of [[ this document ]]</li>
<li>Parameter Name: &#8220;q&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.3 of [[ this document ]]</li>
<li>Parameter Name: &#8220;dp&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.4 of [[ this document ]]</li>
<li>Parameter Name: &#8220;dq&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.5 of [[ this document ]]</li>
<li>Parameter Name: &#8220;qi&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.6 of [[ this document ]]</li>
<li>Parameter Name: &#8220;oth&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.2.7 of [[ this document ]]</li>
<li>Parameter Name: &#8220;k&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 5.3.3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.3.1</a> )</p>
</div>
</div>
<div class="section" id="registration-of-jwe-header-parameter-names">
<span id="jwa-6-4"></span><h3><a class="toc-backref" href="#id94">6.4.  Registration of JWE Header Parameter Names</a><a class="headerlink" href="#registration-of-jwe-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>This specification registers the Header Parameter Names defined in
Section 4.7.1, Section 4.8.1, and Section 4.9.1 in the IANA JSON Web
Signature and Encryption Header Parameters registry [JWS].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.4</a> )</p>
<div class="section" id="jwa-6-4-1">
<span id="id7"></span><h4><a class="toc-backref" href="#id95">6.4.1.  Registry Contents</a><a class="headerlink" href="#jwa-6-4-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Header Parameter Name: &#8220;epk&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.7.1.1 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;apu&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.7.1.2 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;apv&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.7.1.3 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;iv&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8.1.1 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;tag&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.8.1.2 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;p2s&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9.1.1 of [[ this document ]]</li>
<li>Header Parameter Name: &#8220;p2c&#8221;</li>
<li>Header Parameter Usage Location(s): JWE</li>
<li>Change Controller: IETF</li>
<li>Specification Document(s): Section 4.9.1.2 of [[ this document ]]</li>
</ul>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.4.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-6.4.1</a> )</p>
</div>
</div>
</div>
<div class="section" id="security-considerations">
<span id="jwa-7"></span><h2><a class="toc-backref" href="#id96">7.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>All of the security issues faced by any cryptographic application
must be faced by a <a class="reference internal" href="jws.html"><em>JWS</em></a>/<a class="reference internal" href="jwe.html"><em>JWE</em></a>/<a class="reference internal" href="jwk.html"><em>JWK</em></a> agent.
Among these issues are protecting the user&#8217;s private and symmetric keys, preventing various
attacks, and helping the user avoid mistakes such as inadvertently
encrypting a message for the wrong recipient.
The entire list of security considerations is beyond the scope of this document,
but some significant considerations are listed here.</p>
<p>The security considerations in
[AES], [DSS], [JWE], [JWK], [JWS],
[NIST.800-38A], [NIST.800-38D], [NIST.800-56A], [RFC2104], [RFC3394],
[RFC3447], [RFC5116], [RFC6090], and [SHS] apply to this specification.</p>
<p>Eventually the algorithms and/or key sizes currently described in
this specification will no longer be considered sufficiently secure
and will be removed.
Therefore,
implementers and deployments must be prepared for this eventuality.</p>
<p>Many algorithms have associated security considerations related to
key lifetimes and/or the number of times that a key may be used.
Those security considerations continue to apply when using those
algorithms with JOSE data structures.</p>
<p>Algorithms of matching strengths should be used together whenever
possible.
For instance, when AES Key Wrap is used with a given key size,
using the same key size is recommended when AES GCM is also used.</p>
<p>While Section 8 of RFC 3447 [RFC3447] explicitly calls for people not
to adopt <em class="xref std std-term">RSASSA-PKCS-v1_5</em> for new applications and instead requests
that people transition to <em class="xref std std-term">RSASSA-PSS</em>,
this specification does include RSASSA-PKCS-v1_5,
for interoperability reasons, because it commonly implemented.</p>
<p>Keys used with RSAES-PKCS1-v1_5 must follow the constraints in
Section 7.2 of RFC 3447 [RFC3447].  In particular, keys with a low
public key exponent value must not be used.</p>
<p>Keys used with AES GCM must follow the constraints in Section 8.3 of
[NIST.800-38D], which states: &#8220;The total number of invocations of the
authenticated encryption function shall not exceed 2^32, including
all IV lengths and all instances of the authenticated encryption
function with the given key&#8221;.  In accordance with this rule, AES GCM
MUST NOT be used with the same key encryption key or with the same
direct encryption key more than 2^32 times.</p>
<p>Plaintext JWSs (JWSs that use the &#8220;alg&#8221; value &#8220;none&#8221;) provide no
integrity protection.  Thus, they must only be used in contexts where
the payload is secured by means other than a digital signature or MAC
value, or need not be secured.</p>
<p>Receiving agents that validate signatures and sending agents that
encrypt messages need to be cautious of cryptographic processing
usage when validating signatures and encrypting messages using keys
larger than those mandated in this specification.  An attacker could
send certificates with keys that would result in excessive
cryptographic processing, for example, keys larger than those
mandated in this specification, which could swamp the processing
element.  Agents that use such keys without first validating the
certificate to a trust anchor are advised to have some sort of
cryptographic resource management system to prevent such attacks.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7</a> )</p>
<div class="section" id="reusing-key-material-when-encrypting-keys">
<span id="jwa-7-1"></span><h3><a class="toc-backref" href="#id97">7.1.  Reusing Key Material when Encrypting Keys</a><a class="headerlink" href="#reusing-key-material-when-encrypting-keys" title="Permalink to this headline">¶</a></h3>
<p>It is NOT RECOMMENDED to reuse the same key material
( <em class="xref std std-term">Key Encryption Key</em>, <a class="reference internal" href="#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a>, <em class="xref std std-term">Initialization Vector</em>, etc.)
to encrypt multiple JWK or JWK Set objects, or to encrypt the same JWK or JWK
Set object multiple times.</p>
<p>One suggestion for preventing re-use is to always generate a new set key material
for each encryption operation,
based on the considerations noted in this document as well as from [RFC4086].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7.1</a> )</p>
</div>
<div class="section" id="password-considerations">
<span id="jwa-7-2"></span><h3><a class="toc-backref" href="#id98">7.2.  Password Considerations</a><a class="headerlink" href="#password-considerations" title="Permalink to this headline">¶</a></h3>
<p>While convenient for end users, passwords are vulnerable to a number
of attacks.  To help mitigate some of these limitations, this
document applies principles from [RFC2898] to derive cryptographic
keys from user-supplied passwords.</p>
<p>However, the strength of the password still has a significant impact.
A high-entry password has greater resistance to dictionary attacks.
[NIST-800-63-1] contains guidelines for estimating password entropy,
which can help applications and users generate stronger passwords.</p>
<p>An ideal password is one that is as large (or larger) than the
derived key length but less than the PRF&#8217;s block size.  Passwords
larger than the PRF&#8217;s block size are first hashed, which reduces an
attacker&#8217;s effective search space to the length of the hash algorithm
(32 octets for HMAC SHA-256).  It is RECOMMENDED that the password be
no longer than 64 octets long for &#8220;PBES2-HS256+A256KW&#8221;.</p>
<p>Still, care needs to be taken in where and how password-based
encryption is used.  Such algorithms MUST NOT be used where the
attacker can make an indefinite number of attempts to circumvent the
protection.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-7.2</a>)</p>
</div>
</div>
<div class="section" id="internationalization-considerations">
<span id="jwa-8"></span><h2><a class="toc-backref" href="#id99">8.  Internationalization Considerations</a><a class="headerlink" href="#internationalization-considerations" title="Permalink to this headline">¶</a></h2>
<p>Passwords obtained from users are likely to require preparation and
normalization to account for differences of octet sequences generated
by different input devices, locales, etc.  It is RECOMMENDED that
applications to perform the steps outlined in
[I-D.melnikov-precis-saslprepbis] to prepare a password supplied
directly by a user before performing key derivation and encryption.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-8">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-8</a> )</p>
</div>
<div class="section" id="references">
<span id="jwa-9"></span><h2><a class="toc-backref" href="#id100">9.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9</a> )</p>
<div class="section" id="normative-references">
<span id="jwa-9-1"></span><h3><a class="toc-backref" href="#id101">9.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aes">[AES]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-dss">[DSS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Digital
Signature Standard (DSS)&#8221;, FIPS PUB 186-3, June 2009.</dd>
<dt id="term-i-d-melnikov-precis-saslprepbis">[I-D.melnikov-precis-saslprepbis]</dt>
<dd>Saint-Andre, P. and A. Melnikov, &#8220;Preparation and
Comparison of Internationalized Strings Representing
Simple User Names and Passwords&#8221;,
draft-melnikov-precis-saslprepbis-04 (work in progress),
September 2012.</dd>
<dt id="term-59">[JWE]</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, &#8220;JSON Web
Encryption (JWE)&#8221;, draft-ietf-jose-json-web-encryption
(work in progress), July 2013.</dd>
<dt id="term-60">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;,
draft-ietf-jose-json-web-key (work in progress),
July 2013.</dd>
<dt id="term-61">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, draft-ietf-jose-json-web-signature (work
in progress), July 2013.</dd>
<dt id="term-nist-800-38a">[NIST.800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST.800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST.800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography&#8221;, NIST Special
Publication 800-56A, Revision 2, May 2013.</dd>
<dt id="term-rfc2104">[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, &#8220;HMAC: Keyed-
Hashing for Message Authentication&#8221;, RFC 2104,
February 1997.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2898">[RFC2898]</dt>
<dd>Kaliski, B., &#8220;PKCS #5: Password-Based Cryptography
Specification Version 2.0&#8221;, RFC 2898, September 2000.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc4086">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc4868">[RFC4868]</dt>
<dd>Kelly, S. and S. Frankel, &#8220;Using HMAC-SHA-256, HMAC-SHA-
384, and HMAC-SHA-512 with IPsec&#8221;, RFC 4868, May 2007.</dd>
<dt id="term-rfc5116">[RFC5116]</dt>
<dd>McGrew, D., &#8220;An Interface and Algorithms for Authenticated
Encryption&#8221;, RFC 5116, January 2008.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-shs">[SHS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Secure
Hash Standard (SHS)&#8221;, FIPS PUB 180-3, October 2008.</dd>
<dt id="term-usascii">[USASCII]</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.1</a> )</p>
</div>
<div class="section" id="informative-references">
<span id="jwa-9-2"></span><h3><a class="toc-backref" href="#id102">9.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt id="term-i-d-mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</dt>
<dd>McGrew, D., Foley, J., and K. Paterson, &#8220;Authenticated
Encryption with AES-CBC and HMAC-SHA&#8221;,
draft-mcgrew-aead-aes-cbc-hmac-sha2-02 (work in progress),
July 2013.</dd>
<dt id="term-i-d-miller-jose-jwe-protected-jwk">[I-D.miller-jose-jwe-protected-jwk]</dt>
<dd>Miller, M., &#8220;Using JavaScript Object Notation (JSON) Web
Encryption (JWE) for Protecting JSON Web Key (JWK)
Objects&#8221;, draft-miller-jose-jwe-protected-jwk-02 (work in
progress), June 2013.</dd>
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2011.</dd>
<dt id="term-jse">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-magicsignatures">[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt id="term-nist-800-63-1">[NIST-800-63-1]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Electronic Authentication Guideline&#8221;, NIST 800-63-1,
December 2011.</dd>
<dt id="term-rfc2631">[RFC2631]</dt>
<dd>Rescorla, E., &#8220;Diffie-Hellman Key Agreement Method&#8221;,
RFC 2631, June 1999.</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-rfc4122">[RFC4122]</dt>
<dd>Leach, P., Mealling, M., and R. Salz, &#8220;A Universally
Unique IDentifier (UUID) URN Namespace&#8221;, RFC 4122,
July 2005.</dd>
<dt id="term-w3c-cr-xmldsig-core2-20120124">[W3C.CR-xmldsig-core2-20120124]</dt>
<dd>Eastlake, D., Reagle, J., Yiu, K., Solo, D., Datta, P.,
Hirsch, F., Cantor, S., and T. Roessler, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium CR CR-xmldsig-core2-20120124, January 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124">http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124</a>&gt;.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20120313">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Roessler, T., and F. Hirsch,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-9.2</a> )</p>
</div>
</div>
<div class="section" id="appendix-a-digital-signature-mac-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a"></span><h2><a class="toc-backref" href="#id103">Appendix A. Digital Signature/MAC Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-a-digital-signature-mac-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<p>This appendix contains a table cross-referencing the digital
signature and MAC &#8220;alg&#8221; (algorithm) values used in this specification
with the equivalent identifiers used by other standards and software
packages.  See XML DSIG [RFC3275], XML DSIG 2.0
[W3C.CR-xmldsig-core2-20120124], and Java Cryptography Architecture
[JCA] for more information about the names defined by those documents.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="8%" />
<col width="44%" />
<col width="16%" />
<col width="21%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Algor
ithm</td>
<td>JWS</td>
<td>XML DSIG</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td><p class="first">HMAC
using
SHA-2
56</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha256</td>
<td>HmacSHA2
56</td>
<td>1.2.840.113
549.2.9</td>
</tr>
<tr class="row-odd"><td><p class="first">HMAC
using
SHA-3
84</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha384</td>
<td>HmacSHA3
84</td>
<td>1.2.840.113
549.2.10</td>
</tr>
<tr class="row-even"><td><p class="first">HMAC
using
SHA-5
12</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>HS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#hmac-sha512</td>
<td>HmacSHA5
12</td>
<td>1.2.840.113
549.2.11</td>
</tr>
<tr class="row-odd"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
256</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha256</td>
<td>SHA256wi
thRSA</td>
<td>1.2.840.113
549.1.1.11</td>
</tr>
<tr class="row-even"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
384</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha384</td>
<td>SHA384wi
thRSA</td>
<td>1.2.840.113
549.1.1.12</td>
</tr>
<tr class="row-odd"><td><p class="first">RSASS
A</p>
<blockquote>
<div>usin</div></blockquote>
<p>gSHA-
512</p>
<blockquote>
<div>has</div></blockquote>
<p class="last">h alg
orith
m</p>
</td>
<td>RS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#rsa-sha512</td>
<td>SHA512wi
thRSA</td>
<td>1.2.840.113
549.1.1.13</td>
</tr>
<tr class="row-even"><td><p class="first">ECDSA
using
P-256
curve
and
SHA-2
56</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha256</td>
<td>SHA256wi
thECDSA</td>
<td>1.2.840.100
45.4.3.2</td>
</tr>
<tr class="row-odd"><td><p class="first">ECDSA
using
P-384
curve
and
SHA-3
84</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha384</td>
<td>SHA384wi
thECDSA</td>
<td>1.2.840.100
45.4.3.3</td>
</tr>
<tr class="row-even"><td><p class="first">ECDSA
using
P-521
curve
and
SHA-5
12</p>
<blockquote>
<div>hash
algo</div></blockquote>
<p class="last">rithm</p>
</td>
<td>ES5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/">http://www.w3.org/2001/04/</a>
xmldsig-more#ecdsa-sha512</td>
<td>SHA512wi
thECDSA</td>
<td>1.2.840.100
45.4.3.4</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-A">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-A</a> )</p>
</div>
<div class="section" id="appendix-b-encryption-algorithm-identifier-cross-reference">
<span id="jwa-appendix-b"></span><h2><a class="toc-backref" href="#id104">Appendix B. Encryption Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-b-encryption-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<p>This appendix contains a table cross-referencing the &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221;
(algorithm) and &#8220;<a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a>&#8221; (encryption method) values used in this
specification with the equivalent identifiers used by other standards
and software packages.
See XML Encryption <a class="reference internal" href="jwe.html#term-w3c-rec-xmlenc-core-20021210"><em class="xref std std-term">[W3C.REC-xmlenc-core-20021210]</em></a>,
XML Encryption 1.1 <a class="reference internal" href="jwe.html#term-w3c-cr-xmlenc-core1-20120313"><em class="xref std std-term">[W3C.CR-xmlenc-core1-20120313]</em></a>, and
Java Cryptography Architecture <a class="reference internal" href="jwe.html#term-jca"><em class="xref std std-term">[JCA]</em></a>
for more information about the names defined by those
documents.</p>
<p>For the composite algorithms &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221;, the
corresponding AES CBC algorithm identifiers are listed.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="13%" />
<col width="41%" />
<col width="31%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Algorith
m</td>
<td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
</tr>
<tr class="row-even"><td>RSAES-PK
CS1-V1_5</td>
<td>RSA1_5</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#rsa-1_5</td>
<td>RSA/ECB/PKCS1Paddi
ng</td>
</tr>
<tr class="row-odd"><td><p class="first">RSAES
using
Optimal
Asymmetr
ic</p>
<blockquote>
<div>Encrypt</div></blockquote>
<dl class="docutils">
<dt>ion</dt>
<dd>Paddin</dd>
</dl>
<p class="last">g (OAEP)</p>
</td>
<td>RSA-OA
EP</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#rsa-oaep-mgf1p</td>
<td>RSA/ECB/OAEPWithSH
A-1AndMGF1Padding</td>
</tr>
<tr class="row-even"><td><p class="first">Elliptic
Curve
Diffie-H
ellman</p>
<blockquote>
<div>Ephemer</div></blockquote>
<p class="last">alStatic</p>
</td>
<td>ECDH-E
S</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#ECDH-ES</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><p class="first">Advanced
Encrypti
on</p>
<blockquote>
<div>Standar</div></blockquote>
<dl class="docutils">
<dt>d(AES)</dt>
<dd>Key Wra</dd>
</dl>
<p>pAlgorit
hmusing</p>
<blockquote>
<div>128 bi</div></blockquote>
<p class="last">t keys</p>
</td>
<td>A128KW</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#kw-aes128</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td><p class="first">AES Key
Wrap
Algorith
musing</p>
<blockquote class="last">
<div>256 bit
keys</div></blockquote>
</td>
<td>A256KW</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#kw-aes256</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>AES in
Cipher
Block
Chaining
(CBC)
mode
with
PKCS #5
padding
using
128 bit
keys</td>
<td>A128CB
C+HS25
6</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#aes128-cbc</td>
<td>AES/CBC/PKCS5Paddi
ng</td>
</tr>
<tr class="row-even"><td>AES in
CBC mode
with
PKCS #5
padding
using
256 bit
keys</td>
<td>A256CB
C+HS51
2</td>
<td><a class="reference external" href="http://www.w3.org/2001/0">http://www.w3.org/2001/0</a>
4/xmlenc#aes256-cbc</td>
<td>AES/CBC/PKCS5Paddi
ng</td>
</tr>
<tr class="row-odd"><td><p class="first">AES in
Galois/C
ounter</p>
<blockquote class="last">
<div>Mode
(GCM)
using
128 bit
keys</div></blockquote>
</td>
<td>A128GC
M</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#aes128-gcm</td>
<td>AES/GCM/NoPadding</td>
</tr>
<tr class="row-even"><td>AES GCM
using
256 bit
keys</td>
<td>A256GC
M</td>
<td><a class="reference external" href="http://www.w3.org/2009/x">http://www.w3.org/2009/x</a>
mlenc11#aes256-gcm</td>
<td>AES/GCM/NoPadding</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-B">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-06#appendix-B</a> )</p>
</div>
<div class="section" id="appendix-c-test-cases-for-aes-cbc-hmac-sha2-algorithms">
<span id="jwa-appendix-c"></span><h2><a class="toc-backref" href="#id105">Appendix C.  Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#appendix-c-test-cases-for-aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h2>
<p>The following test cases can be used to validate implementations of
the AES_CBC_HMAC_SHA2 algorithms defined in Section 4.10.  They are
also intended to correspond to test cases that may appear in a future
version of [I-D.mcgrew-aead-aes-cbc-hmac-sha2], demonstrating that
the cryptographic computations performed are the same.</p>
<p>The variable names are those defined in Section 4.10.  All values are
hexadecimal.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C</a> )</p>
<div class="section" id="c-1-test-cases-for-aes-128-cbc-hmac-sha-256">
<span id="jwa-appendix-c-1"></span><h3><a class="toc-backref" href="#id106">C.1.  Test Cases for AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#c-1-test-cases-for-aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>AES_128_CBC_HMAC_SHA_256

  K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
            10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

  MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f

  ENC_KEY = 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

  P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
            6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
            69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
            74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
            65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
            6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
            20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
            75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

  IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

  A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
            69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
            4b 65 72 63 6b 68 6f 66 66 73

  AL =      00 00 00 00 00 00 01 50

  E =       c8 0e df a3 2d df 39 d5 ef 00 c0 b4 68 83 42 79
            a2 e4 6a 1b 80 49 f7 92 f7 6b fe 54 b9 03 a9 c9
            a9 4a c9 b4 7a d2 65 5c 5f 10 f9 ae f7 14 27 e2
            fc 6f 9b 3f 39 9a 22 14 89 f1 63 62 c7 03 23 36
            09 d4 5a c6 98 64 e3 32 1c f8 29 35 ac 40 96 c8
            6e 13 33 14 c5 40 19 e8 ca 79 80 df a4 b9 cf 1b
            38 4c 48 6f 3a 54 c5 10 78 15 8e e5 d7 9d e5 9f
            bd 34 d8 48 b3 d6 95 50 a6 76 46 34 44 27 ad e5
            4b 88 51 ff b5 98 f7 f8 00 74 b9 47 3c 82 e2 db

  M =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4
            e6 e5 45 82 47 65 15 f0 ad 9f 75 a2 b7 1c 73 ef

  T =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.1</a> )</p>
</div>
<div class="section" id="c-2-test-cases-for-aes-192-cbc-hmac-sha-384">
<span id="jwa-appendix-c-2"></span><h3><a class="toc-backref" href="#id107">C.2.  Test Cases for AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#c-2-test-cases-for-aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17

ENC_KEY = 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27
          28 29 2a 2b 2c 2d 2e 2f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       ea 65 da 6b 59 e6 1e db 41 9b e6 2d 19 71 2a e5
          d3 03 ee b5 00 52 d0 df d6 69 7f 77 22 4c 8e db
          00 0d 27 9b dc 14 c1 07 26 54 bd 30 94 42 30 c6
          57 be d4 ca 0c 9f 4a 84 66 f2 2b 22 6d 17 46 21
          4b f8 cf c2 40 0a dd 9f 51 26 e4 79 66 3f c9 0b
          3b ed 78 7a 2f 0f fc bf 39 04 be 2a 64 1d 5c 21
          05 bf e5 91 ba e2 3b 1d 74 49 e5 32 ee f6 0a 9a
          c8 bb 6c 6b 01 d3 5d 49 78 7b cd 57 ef 48 49 27
          f2 80 ad c9 1a c0 c4 e7 9c 7b 11 ef c6 00 54 e3

M =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7 45 94 f8 86 b3 fa af d4
          86 f2 5c 71 31 e3 28 1e 36 c7 a2 d1 30 af de 57

T =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.2</a> )</p>
</div>
<div class="section" id="c-3-test-cases-for-aes-256-cbc-hmac-sha-512">
<span id="jwa-appendix-c-3"></span><h3><a class="toc-backref" href="#id108">C.3.  Test Cases for AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#c-3-test-cases-for-aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

ENC_KEY = 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       4a ff aa ad b7 8c 31 c5 da 4b 1b 59 0d 10 ff bd
          3d d8 d5 d3 02 42 35 26 91 2d a0 37 ec bc c7 bd
          82 2c 30 1d d6 7c 37 3b cc b5 84 ad 3e 92 79 c2
          e6 d1 2a 13 74 b7 7f 07 75 53 df 82 94 10 44 6b
          36 eb d9 70 66 29 6a e6 42 7e a7 5c 2e 08 46 a1
          1a 09 cc f5 37 0d c8 0b fe cb ad 28 c7 3f 09 b3
          a3 b7 5e 66 2a 25 94 41 0a e4 96 b2 e2 e6 60 9e
          31 e6 e0 2c c8 37 f0 53 d2 1f 37 ff 4f 51 95 0b
          be 26 38 d0 9d d7 a4 93 09 30 80 6d 07 03 b1 f6

M =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5
          fd 30 a5 65 c6 16 ff b2 f3 64 ba ec e6 8f c4 07
          53 bc fc 02 5d de 36 93 75 4a a1 f5 c3 37 3b 9c

T =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-C.3</a> )</p>
</div>
</div>
<div class="section" id="appendix-d-example-ecdh-es-key-agreement-computation">
<span id="jwa-appendix-d"></span><h2><a class="toc-backref" href="#id109">Appendix D.  Example ECDH-ES Key Agreement Computation</a><a class="headerlink" href="#appendix-d-example-ecdh-es-key-agreement-computation" title="Permalink to this headline">¶</a></h2>
<p>This example uses ECDH-ES Key Agreement and the Concat KDF to derive
the Content Encryption Key (CEK) in the manner described in
Section 4.7.  In this example, the ECDH-ES Direct Key Agreement mode
(&#8220;alg&#8221; value &#8220;ECDH-ES&#8221;) is used to produce an agreed upon key for AES
GCM with 128 bit keys (&#8220;enc&#8221; value &#8220;A128GCM&#8221;).</p>
<p>In this example, a sender Alice is encrypting content to a recipient
Bob. The sender (Alice) generates an ephemeral key for the key
agreement computation.  Alice&#8217;s ephemeral key (in JWK format) used
for the key agreement computation in this example (including the
private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;0_NxaRPUMQoAJt50Gz8YiTr8gRTwyEaCumd-MToTmIo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The recipient&#8217;s (Bob&#8217;s) key (in JWK format) used for the key
agreement computation in this example (including the private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;weNJy2HscCSM6AEDTDg04biOvhFhyyWvOHQfeF_PxMQ&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;e8lnCO-AlStT-NJVX-crhB7QRYhiix03illJOVAOyck&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;VEmDZpDXXK8p8N0Cndsxs924q6nS1RXFASRl6BfUqdw&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Header parameter values used in this example are as follows.  In this
example, the &#8220;apu&#8221; (agreement PartyUInfo) parameter value is the
base64url encoding of the UTF-8 string &#8220;Alice&#8221; and the &#8220;apv&#8221;
(agreement PartyVInfo) parameter value is the base64url encoding of
the UTF-8 string &#8220;Bob&#8221;.  The &#8220;epk&#8221; parameter is used to communicate
the sender&#8217;s (Alice&#8217;s) ephemeral public key value to the recipient
(Bob).</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ECDH-ES&quot;</span><span class="p">,</span>
 <span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A128GCM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apu&quot;</span><span class="o">:</span><span class="s2">&quot;QWxpY2U&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apv&quot;</span><span class="o">:</span><span class="s2">&quot;Qm9i&quot;</span><span class="p">,</span>
 <span class="s2">&quot;epk&quot;</span><span class="o">:</span>
  <span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
   <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
   <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The resulting Concat KDF [NIST.800-56A] parameter values are:</p>
<blockquote>
<div><dl class="docutils">
<dt>Z  This is set to the ECDH-ES key agreement output.  (This value is</dt>
<dd>often not directly exposed by libraries, due to NIST security
requirements, and only serves as an input to a KDF.)</dd>
<dt>keydatalen  This value is 128 - the number of bits in the desired</dt>
<dd>output key (because &#8220;A128GCM&#8221; uses a 128 bit key).</dd>
<dt>AlgorithmID  This is set to the octets representing the UTF-8 string</dt>
<dd>&#8220;A128GCM&#8221; - [65, 49, 50, 56, 71, 67, 77].</dd>
<dt>PartyUInfo  This is set to the octets representing the 32 bit big</dt>
<dd>endian value 5 - [0, 0, 0, 5] - the number of octets in the
PartyUInfo content &#8220;Alice&#8221;, followed, by the octets representing
the UTF-8 string &#8220;Alice&#8221; - [65, 108, 105, 99, 101].</dd>
<dt>PartyVInfo  This is set to the octets representing the 32 bit big</dt>
<dd>endian value 3 - [0, 0, 0, 3] - the number of octets in the
PartyUInfo content &#8220;Bob&#8221;, followed, by the octets representing the
UTF-8 string &#8220;Bob&#8221; - [66, 111, 98].</dd>
<dt>SuppPubInfo  This is set to the octets representing the 32 bit big</dt>
<dd>endian value 128 - [0, 0, 0, 128] - the keydatalen value.</dd>
</dl>
<p>SuppPrivInfo  This is set to the empty octet sequence.</p>
</div></blockquote>
<p>The resulting derived key, represented as a base64url encoded value is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">jSNmj9QK9ZGQJ2xg5_TJpA</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-D">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-D</a> )</p>
</div>
<div class="section" id="appendix-e-acknowledgements">
<span id="jwa-appendix-e"></span><h2><a class="toc-backref" href="#id110">Appendix E.  Acknowledgements</a><a class="headerlink" href="#appendix-e-acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Solutions for signing and encrypting JSON content were previously
explored by Magic Signatures [MagicSignatures], JSON Simple Sign
[JSS], Canvas Applications [CanvasApp], JSON Simple Encryption [JSE],
and JavaScript Message Security Format [I-D.rescorla-jsms], all of
which influenced this draft.</p>
<p>The Authenticated Encryption with AES-CBC and HMAC-SHA
[I-D.mcgrew-aead-aes-cbc-hmac-sha2] specification, upon which the
AES_CBC_HMAC_SHA2 algorithms are based, was written by David A.
McGrew and Kenny Paterson.  The test cases for AES_CBC_HMAC_SHA2 are
based upon those for [I-D.mcgrew-aead-aes-cbc-hmac-sha2] by John
Foley.</p>
<p>Matt Miller wrote Using JavaScript Object Notation (JSON) Web
Encryption (JWE) for Protecting JSON Web Key (JWK) Objects
[I-D.miller-jose-jwe-protected-jwk], which the password-based
encryption content of this draft is based upon.</p>
<p>This specification is the work of the JOSE Working Group, which
includes dozens of active and dedicated participants.  In particular,
the following individuals contributed ideas, feedback, and wording
that influenced this specification:</p>
<p>Dirk Balfanz, Richard Barnes, John Bradley, Brian Campbell, Breno de
Medeiros, Yaron Y. Goland, Dick Hardt, Jeff Hodges, Edmund Jay, James
Manger, Matt Miller, Tony Nadalin, Axel Nennker, John Panzer,
Emmanuel Raviart, Nat Sakimura, Jim Schaad, Hannes Tschofenig, and
Sean Turner.</p>
<p>Jim Schaad and Karen O&#8217;Donoghue chaired the JOSE working group and
Sean Turner and Stephen Farrell served as Security area directors
during the creation of this specification.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-E">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-E</a> )</p>
</div>
<div class="section" id="appendix-f-document-history">
<span id="jwa-appendix-f"></span><h2><a class="toc-backref" href="#id111">Appendix F.  Document History</a><a class="headerlink" href="#appendix-f-document-history" title="Permalink to this headline">¶</a></h2>
<p>[[ to be removed by the RFC editor before publication as an RFC ]]</p>
<blockquote>
<div><p>-14</p>
<dl class="docutils">
<dt>o  Removed &#8220;PBKDF2&#8221; key type and added &#8220;p2s&#8221; and &#8220;p2c&#8221; header</dt>
<dd>parameters for use with the PBES2 algorithms.</dd>
<dt>o  Made the RSA private key parameters that are there to enable</dt>
<dd>optimizations be RECOMMENDED rather than REQUIRED.</dd>
<dt>o  Added algorithm identifiers for AES algorithms using 192 bit keys</dt>
<dd>and for RSASSA-PSS using HMAC SHA-384.</dd>
<dt>o  Added security considerations about key lifetimes, addressing</dt>
<dd>issue #18.</dd>
</dl>
<p>o  Added an example ECDH-ES key agreement computation.</p>
<p>-13</p>
<dl class="docutils">
<dt>o  Added key encryption with AES GCM as specified in</dt>
<dd>draft-jones-jose-aes-gcm-key-wrap-01, addressing issue #13.</dd>
<dt>o  Added security considerations text limiting the number of times</dt>
<dd>that an AES GCM key can be used for key encryption or direct
encryption, per Section 8.3 of NIST SP 800-38D, addressing issue
#28.</dd>
<dt>o  Added password-based key encryption as specified in</dt>
<dd>draft-miller-jose-jwe-protected-jwk-02.</dd>
</dl>
<p>-12</p>
<dl class="docutils">
<dt>o  In the Direct Key Agreement case, the Concat KDF AlgorithmID is</dt>
<dd>set to the octets of the UTF-8 representation of the &#8220;enc&#8221; header
parameter value.</dd>
</dl>
<p>o  Restored the &#8220;apv&#8221; (agreement PartyVInfo) parameter.</p>
<dl class="docutils">
<dt>o  Moved the &#8220;epk&#8221;, &#8220;apu&#8221;, and &#8220;apv&#8221; Header Parameter definitions to</dt>
<dd>be with the algorithm descriptions that use them.</dd>
<dt>o  Changed terminology from &#8220;block encryption&#8221; to &#8220;content</dt>
<dd>encryption&#8221;.</dd>
</dl>
<p>-11</p>
<dl class="docutils">
<dt>o  Removed the Encrypted Key value from the AAD computation since it</dt>
<dd>is already effectively integrity protected by the encryption
process.  The AAD value now only contains the representation of
the JWE Encrypted Header.</dd>
</dl>
<p>o  Removed &#8220;apv&#8221; (agreement PartyVInfo) since it is no longer used.</p>
<dl class="docutils">
<dt>o  Added more information about the use of PartyUInfo during key</dt>
<dd>agreement.</dd>
<dt>o  Use the keydatalen as the SuppPubInfo value for the Concat KDF</dt>
<dd>when doing key agreement, as RFC 2631 does.</dd>
<dt>o  Added algorithm identifiers for RSASSA-PSS with SHA-256 and SHA-</dt>
<dd><ol class="first last arabic simple" start="512">
<li></li>
</ol>
</dd>
<dt>o  Added a Parameter Information Class value to the JSON Web Key</dt>
<dd>Parameters registry, which registers whether the parameter conveys
public or private information.</dd>
</dl>
<p>-10</p>
<dl class="docutils">
<dt>o  Changed the JWE processing rules for multiple recipients so that a</dt>
<dd>single AAD value contains the header parameters and encrypted key
values for all the recipients, enabling AES GCM to be safely used
for multiple recipients.</dd>
</dl>
<p>-09</p>
<dl class="docutils">
<dt>o  Expanded the scope of the JWK parameters to include private and</dt>
<dd>symmetric key representations, as specified by
draft-jones-jose-json-private-and-symmetric-key-00.</dd>
</dl>
<p>o  Changed term &#8220;JWS Secured Input&#8221; to &#8220;JWS Signing Input&#8221;.</p>
<dl class="docutils">
<dt>o  Changed from using the term &#8220;byte&#8221; to &#8220;octet&#8221; when referring to 8</dt>
<dd>bit values.</dd>
<dt>o  Specified that AES Key Wrap uses the default initial value</dt>
<dd>specified in Section 2.2.3.1 of RFC 3394.  This addressed issue
#19.</dd>
<dt>o  Added Key Management Mode definitions to terminology section and</dt>
<dd>used the defined terms to provide clearer key management
instructions.  This addressed issue #5.</dd>
<dt>o  Replaced &#8220;A128CBC+HS256&#8221; and &#8220;A256CBC+HS512&#8221; with &#8220;A128CBC-HS256&#8221;</dt>
<dd>and &#8220;A256CBC-HS512&#8221;.  The new algorithms perform the same
cryptographic computations as [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
but with the Initialization Vector and Authentication Tag values
remaining separate from the Ciphertext value in the output
representation.  Also deleted the header parameters &#8220;epu&#8221;
(encryption PartyUInfo) and &#8220;epv&#8221; (encryption PartyVInfo), since
they are no longer used.</dd>
<dt>o  Changed from using the term &#8220;Integrity Value&#8221; to &#8220;Authentication</dt>
<dd>Tag&#8221;.</dd>
</dl>
<p>-08</p>
<dl class="docutils">
<dt>o  Changed the name of the JWK key type parameter from &#8220;alg&#8221; to</dt>
<dd>&#8220;kty&#8221;.</dd>
<dt>o  Replaced uses of the term &#8220;AEAD&#8221; with &#8220;Authenticated Encryption&#8221;,</dt>
<dd>since the term AEAD in the RFC 5116 sense implied the use of a
particular data representation, rather than just referring to the
class of algorithms that perform authenticated encryption with
associated data.</dd>
<dt>o  Applied editorial improvements suggested by Jeff Hodges.  Many of</dt>
<dd>these simplified the terminology used.</dd>
</dl>
<p>o  Added seriesInfo information to Internet Draft references.</p>
<p>-07</p>
<p>o  Added a data length prefix to PartyUInfo and PartyVInfo values.</p>
<dl class="docutils">
<dt>o  Changed the name of the JWK RSA modulus parameter from &#8220;mod&#8221; to</dt>
<dd>&#8220;n&#8221; and the name of the JWK RSA exponent parameter from &#8220;xpo&#8221; to
&#8220;e&#8221;, so that the identifiers are the same as those used in RFC
3447.</dd>
<dt>o  Made several local editorial changes to clean up loose ends left</dt>
<dd>over from to the decision to only support block encryption methods
providing integrity.</dd>
</dl>
<p>-06</p>
<dl class="docutils">
<dt>o  Removed the &#8220;int&#8221; and &#8220;kdf&#8221; parameters and defined the new</dt>
<dd>composite Authenticated Encryption algorithms &#8220;A128CBC+HS256&#8221; and
&#8220;A256CBC+HS512&#8221; to replace the former uses of AES CBC, which
required the use of separate integrity and key derivation
functions.</dd>
<dt>o  Included additional values in the Concat KDF calculation &#8211; the</dt>
<dd>desired output size and the algorithm value, and optionally
PartyUInfo and PartyVInfo values.  Added the optional header
parameters &#8220;apu&#8221; (agreement PartyUInfo), &#8220;apv&#8221; (agreement
PartyVInfo), &#8220;epu&#8221; (encryption PartyUInfo), and &#8220;epv&#8221; (encryption
PartyVInfo).</dd>
<dt>o  Changed the name of the JWK RSA exponent parameter from &#8220;exp&#8221; to</dt>
<dd>&#8220;xpo&#8221; so as to allow the potential use of the name &#8220;exp&#8221; for a
future extension that might define an expiration parameter for
keys.  (The &#8220;exp&#8221; name is already used for this purpose in the JWT
specification.)</dd>
<dt>o  Applied changes made by the RFC Editor to RFC 6749&#8217;s registry</dt>
<dd>language to this specification.</dd>
</dl>
<p>-05</p>
<dl class="docutils">
<dt>o  Support both direct encryption using a shared or agreed upon</dt>
<dd>symmetric key, and the use of a shared or agreed upon symmetric
key to key wrap the CMK.  Specifically, added the &#8220;alg&#8221; values
&#8220;dir&#8221;, &#8220;ECDH-ES+A128KW&#8221;, and &#8220;ECDH-ES+A256KW&#8221; to finish filling in
this set of capabilities.</dd>
</dl>
<p>o  Updated open issues.</p>
<p>-04</p>
<dl class="docutils">
<dt>o  Added text requiring that any leading zero bytes be retained in</dt>
<dd>base64url encoded key value representations for fixed-length
values.</dd>
<dt>o  Added this language to Registration Templates: &#8220;This name is case</dt>
<dd>sensitive.  Names that match other registered names in a case
insensitive manner SHOULD NOT be accepted.&#8221;</dd>
</dl>
<p>o  Described additional open issues.</p>
<p>o  Applied editorial suggestions.</p>
<p>-03</p>
<dl class="docutils">
<dt>o  Always use a 128 bit &#8220;authentication tag&#8221; size for AES GCM,</dt>
<dd>regardless of the key size.</dd>
<dt>o  Specified that use of a 128 bit IV is REQUIRED with AES CBC.  It</dt>
<dd>was previously RECOMMENDED.</dd>
<dt>o  Removed key size language for ECDSA algorithms, since the key size</dt>
<dd>is implied by the algorithm being used.</dd>
<dt>o  Stated that the &#8220;int&#8221; key size must be the same as the hash output</dt>
<dd>size (and not larger, as was previously allowed) so that its size
is defined for key generation purposes.</dd>
<dt>o  Added the &#8220;kdf&#8221; (key derivation function) header parameter to</dt>
<dd>provide crypto agility for key derivation.  The default KDF
remains the Concat KDF with the SHA-256 digest function.</dd>
</dl>
<p>o  Clarified that the &#8220;mod&#8221; and &#8220;exp&#8221; values are unsigned.</p>
<dl class="docutils">
<dt>o  Added Implementation Requirements columns to algorithm tables and</dt>
<dd>Implementation Requirements entries to algorithm registries.</dd>
</dl>
<p>o  Changed AES Key Wrap to RECOMMENDED.</p>
<dl class="docutils">
<dt>o  Moved registries JSON Web Signature and Encryption Header</dt>
<dd>Parameters and JSON Web Signature and Encryption Type Values to
the JWS specification.</dd>
</dl>
<p>o  Moved JSON Web Key Parameters registry to the JWK specification.</p>
<dl class="docutils">
<dt>o  Changed registration requirements from RFC Required to</dt>
<dd>Specification Required with Expert Review.</dd>
</dl>
<p>o  Added Registration Template sections for defined registries.</p>
<p>o  Added Registry Contents sections to populate registry values.</p>
<dl class="docutils">
<dt>o  No longer say &#8220;the UTF-8 representation of the JWS Secured Input</dt>
<dd>(which is the same as the ASCII representation)&#8221;.  Just call it
&#8220;the ASCII representation of the JWS Secured Input&#8221;.</dd>
</dl>
<p>o  Added &#8220;Collision Resistant Namespace&#8221; to the terminology section.</p>
<p>o  Numerous editorial improvements.</p>
<p>-02</p>
<dl class="docutils">
<dt>o  For AES GCM, use the &#8220;additional authenticated data&#8221; parameter to</dt>
<dd>provide integrity for the header, encrypted key, and ciphertext
and use the resulting &#8220;authentication tag&#8221; value as the JWE
Authentication Tag.</dd>
<dt>o  Defined minimum required key sizes for algorithms without</dt>
<dd>specified key sizes.</dd>
</dl>
<p>o  Defined KDF output key sizes.</p>
<p>o  Specified the use of PKCS #5 padding with AES CBC.</p>
<dl class="docutils">
<dt>o  Generalized text to allow key agreement to be employed as an</dt>
<dd>alternative to key wrapping or key encryption.</dd>
</dl>
<p>o  Clarified that ECDH-ES is a key agreement algorithm.</p>
<p>o  Required implementation of AES-128-KW and AES-256-KW.</p>
<p>o  Removed the use of &#8220;A128GCM&#8221; and &#8220;A256GCM&#8221; for key wrapping.</p>
<dl class="docutils">
<dt>o  Removed &#8220;A512KW&#8221; since it turns out that it&#8217;s not a standard</dt>
<dd>algorithm.</dd>
<dt>o  Clarified the relationship between &#8220;typ&#8221; header parameter values</dt>
<dd>and MIME types.</dd>
<dt>o  Generalized language to refer to Message Authentication Codes</dt>
<dd>(MACs) rather than Hash-based Message Authentication Codes (HMACs)
unless in a context specific to HMAC algorithms.</dd>
<dt>o  Established registries: JSON Web Signature and Encryption Header</dt>
<dd>Parameters, JSON Web Signature and Encryption Algorithms, JSON Web
Signature and Encryption &#8220;typ&#8221; Values, JSON Web Key Parameters,
and JSON Web Key Algorithm Families.</dd>
</dl>
<p>o  Moved algorithm-specific definitions from JWK to JWA.</p>
<dl class="docutils">
<dt>o  Reformatted to give each member definition its own section</dt>
<dd>heading.</dd>
</dl>
<p>-01</p>
<dl class="docutils">
<dt>o  Moved definition of &#8220;alg&#8221;:&#8221;none&#8221; for JWSs here from the JWT</dt>
<dd>specification since this functionality is likely to be useful in
more contexts that just for JWTs.</dd>
<dt>o  Added Advanced Encryption Standard (AES) Key Wrap Algorithm using</dt>
<dd>512 bit keys (&#8220;A512KW&#8221;).</dd>
<dt>o  Added text &#8220;Alternatively, the Encoded JWS Signature MAY be</dt>
<dd>base64url decoded to produce the JWS Signature and this value can
be compared with the computed HMAC value, as this comparison
produces the same result as comparing the encoded values&#8221;.</dd>
</dl>
<p>o  Corrected the Magic Signatures reference.</p>
<dl class="docutils">
<dt>o  Made other editorial improvements suggested by JOSE working group</dt>
<dd>participants.</dd>
</dl>
<p>-00</p>
<dl class="docutils">
<dt>o  Created the initial IETF draft based upon</dt>
<dd>draft-jones-json-web-signature-04 and
draft-jones-json-web-encryption-02 with no normative changes.</dd>
<dt>o  Changed terminology to no longer call both digital signatures and</dt>
<dd>HMACs &#8220;signatures&#8221;.</dd>
</dl>
</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-F">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#appendix-F</a> )</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jwk.html">JSON Web Key (JWK)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>