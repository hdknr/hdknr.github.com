
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Algorithms (JWA) : draft30 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Token (JWT) : draft22" href="jwt.html" />
    <link rel="prev" title="Terms" href="jose.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">JSON Web Algorithms (JWA) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft22</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft28</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)(draft30)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">JSON Web Algorithms (JWA) : draft30</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions">1.1.  Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#terminology">2.  Terminology</a></li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-digital-signatures-and-macs">3.  Cryptographic Algorithms for Digital Signatures and MACs</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jws">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a></li>
<li><a class="reference internal" href="#hmac-with-sha-2-functions">3.2.  HMAC with SHA-2 Functions</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pkcs1-v1-5">3.3.  Digital Signature with RSASSA-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#digital-signature-with-ecdsa">3.4.  Digital Signature with ECDSA</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pss">3.5.  Digital Signature with RSASSA-PSS</a></li>
<li><a class="reference internal" href="#using-the-algorithm-none">3.6.  Using the Algorithm &#8220;none&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-key-management">4.  Cryptographic Algorithms for Key Management</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jwe">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-pkcs1-v1-5">4.2. Key Encryption with RSAES-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-oaep">4.3. Key Encryption with RSAES OAEP</a></li>
<li><a class="reference internal" href="#key-wrapping-with-aes-key-wrap">4.4. Key Wrapping with AES Key Wrap</a></li>
<li><a class="reference internal" href="#direct-encryption-with-a-shared-symmetric-key">4.5. Direct Encryption with a Shared Symmetric Key</a></li>
<li><a class="reference internal" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es">4.6.  Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-ecdh-key-agreement">4.6.1. Header Parameters Used for ECDH Key Agreement</a><ul>
<li><a class="reference internal" href="#epk-ephemeral-public-key-header-parameter">4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a></li>
<li><a class="reference internal" href="#apu-agreement-partyuinfo-header-parameter">4.6.1.2. &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a></li>
<li><a class="reference internal" href="#apv-agreement-partyvinfo-header-parameter">4.6.1.3. &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation-for-ecdh-key-agreement">4.6.2. Key Derivation for ECDH Key Agreement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-aes-gcm">4.7. Key Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-aes-gcm-key-encryption">4.7.1. Header Parameters Used for AES GCM Key Encryption</a><ul>
<li><a class="reference internal" href="#iv-initialization-vector-header-parameter">4.7.1.1. &#8220;iv&#8221; (Initialization Vector) Header Parameter</a></li>
<li><a class="reference internal" href="#tag-authentication-tag-header-parameter">4.7.1.2. &#8220;tag&#8221; (Authentication Tag) Header Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-pbes2">4.8. Key Encryption with PBES2</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-pbes2-key-encryption">4.8.1. Header Parameters Used for PBES2 Key Encryption</a><ul>
<li><a class="reference internal" href="#p2s-pbes2-salt-parameter">4.8.1.1. &#8220;p2s&#8221; (PBES2 salt) Parameter</a></li>
<li><a class="reference internal" href="#p2c-pbes2-count-parameter">4.8.1.2. &#8220;p2c&#8221; (PBES2 count) Parameter</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-content-encryption">5. Cryptographic Algorithms for Content Encryption</a><ul>
<li><a class="reference internal" href="#enc-encryption-algorithm-header-parameter-values-for-jwe">5.1. &#8220;enc&#8221; (Encryption Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-algorithms">5.2. AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#conventions-used-in-defining-aes-cbc-hmac-sha2">5.2.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a></li>
<li><a class="reference internal" href="#generic-aes-cbc-hmac-sha2-algorithm">5.2.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><ul>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-encryption">5.2.2.1. AES_CBC_HMAC_SHA2 Encryption</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-decryption">5.2.2.2. AES_CBC_HMAC_SHA2 Decryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aes-128-cbc-hmac-sha-256">5.2.3. AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#aes-192-cbc-hmac-sha-384">5.2.4. AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#aes-256-cbc-hmac-sha-512">5.2.5. AES_256_CBC_HMAC_SHA_512</a></li>
<li><a class="reference internal" href="#content-encryption-with-aes-cbc-hmac-sha2">5.2.6. Content Encryption with AES_CBC_HMAC_SHA2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#content-encryption-with-aes-gcm">5.3. Content Encryption with AES GCM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-keys">6. Cryptographic Algorithms for Keys</a><ul>
<li><a class="reference internal" href="#kty-key-type-parameter-values">6.1. &#8220;kty&#8221; (Key Type) Parameter Values</a></li>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-keys">6.2. Parameters for Elliptic Curve Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-public-keys">6.2.1. Parameters for Elliptic Curve Public Keys</a><ul>
<li><a class="reference internal" href="#crv-curve-parameter">6.2.1.1. &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#x-x-coordinate-parameter">6.2.1.2. &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#y-y-coordinate-parameter">6.2.1.3. &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-private-keys">6.2.2. Parameters for Elliptic Curve Private Keys</a><ul>
<li><a class="reference internal" href="#d-ecc-private-key-parameter">6.2.2.1. &#8220;d&#8221; (ECC Private Key) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-keys">6.3. Parameters for RSA Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-rsa-public-keys">6.3.1. Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#n-modulus-parameter">6.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#e-exponent-parameter">6.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-private-keys">6.3.2. Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#d-private-exponent-parameter">6.3.2.1. &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#p-first-prime-factor-parameter">6.3.2.2. &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#q-second-prime-factor-parameter">6.3.2.3. &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#dp-first-factor-crt-exponent-parameter">6.3.2.4. &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#dq-second-factor-crt-exponent-parameter">6.3.2.5. &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#qi-first-crt-coefficient-parameter">6.3.2.6. &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#oth-other-primes-info-parameter">6.3.2.7. &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#r-prime-factor">6.3.2.7.1. &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#d-factor-crt-exponent">6.3.2.7.2. &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#t-factor-crt-coefficient">6.3.2.7.3. &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-symmetric-keys">6.4. Parameters for Symmetric Keys</a><ul>
<li><a class="reference internal" href="#k-key-value-parameter">6.4.1. &#8220;k&#8221; (Key Value) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations">7. IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-algorithms-registry">7.1. JSON Web Signature and Encryption Algorithms Registry</a><ul>
<li><a class="reference internal" href="#registration-template">7.1.1. Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents">7.1.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#header-parameter-names-registration">7.2. Header Parameter Names Registration</a><ul>
<li><a class="reference internal" href="#registry-contents">7.2.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-encryption-compression-algorithms-registry">7.3. JSON Web Encryption Compression Algorithms Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-3-1">7.3.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-3-2">7.3.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-types-registry">7.4. JSON Web Key Types Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-4-1">7.4.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-4-2">7.4.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-parameters-registration">7.5. JSON Web Key Parameters Registration</a><ul>
<li><a class="reference internal" href="#jwa-7-5-1">7.5.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-elliptic-curve-registry">7.6. JSON Web Key Elliptic Curve Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-6-1">7.6.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-6-2">7.6.2. Initial Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations">8. Security Considerations</a><ul>
<li><a class="reference internal" href="#algorithms-and-key-sizes-will-be-deprecated">8.1. Algorithms and Key Sizes will be Deprecated</a></li>
<li><a class="reference internal" href="#key-lifetimes">8.2. Key Lifetimes</a></li>
<li><a class="reference internal" href="#rsaes-pkcs1-v1-5-security-considerations">8.3. RSAES-PKCS1-v1_5 Security Considerations</a></li>
<li><a class="reference internal" href="#aes-gcm-security-considerations">8.4. AES GCM Security Considerations</a></li>
<li><a class="reference internal" href="#plaintext-jws-security-considerations">8.5.  Plaintext JWS Security Considerations</a></li>
<li><a class="reference internal" href="#denial-of-service-attacks">8.6.  Denial of Service Attacks</a></li>
<li><a class="reference internal" href="#reusing-key-material-when-encrypting-keys">8.7.  Reusing Key Material when Encrypting Keys</a></li>
<li><a class="reference internal" href="#password-considerations">8.8.  Password Considerations</a></li>
<li><a class="reference internal" href="#key-entropy">8.9.  Key Entropy</a></li>
<li><a class="reference internal" href="#differences-between-digital-signatures-and-macs">8.10.  Differences between Digital Signatures and MACs</a></li>
<li><a class="reference internal" href="#adaptive-chosen-ciphertext-attacks">8.12.  Adaptive Chosen-Ciphertext Attacks</a></li>
<li><a class="reference internal" href="#timing-attacks">8.13.  Timing Attacks</a></li>
<li><a class="reference internal" href="#rsa-private-key-representations-and-blinding">8.14.  RSA Private Key Representations and Blinding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#internationalization-considerations">9. Internationalization Considerations</a></li>
<li><a class="reference internal" href="#references">10. References</a><ul>
<li><a class="reference internal" href="#normative-references">10.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references">10.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-algorithm-identifier-cross-reference">Appendix A. Algorithm Identifier Cross-Reference</a><ul>
<li><a class="reference internal" href="#a-1-digital-signature-mac-algorithm-identifier-cross-reference">A.1. Digital Signature/MAC Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-2-key-management-algorithm-identifier-cross-reference">A.2. Key Management Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-3-content-encryption-algorithm-identifier-cross-reference">A.3. Content Encryption Algorithm Identifier Cross-Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms">Appendix B. Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#b-1-test-cases-for-aes-128-cbc-hmac-sha-256">B.1. Test Cases for AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#b-2-test-cases-for-aes-192-cbc-hmac-sha-384">B.2. Test Cases for AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#b-3-test-cases-for-aes-256-cbc-hmac-sha-512">B.3. Test Cases for AES_256_CBC_HMAC_SHA_512</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-c-example-ecdh-es-key-agreement-computation">Appendix C. Example ECDH-ES Key Agreement Computation</a></li>
<li><a class="reference internal" href="#jwa-terms">用語</a><ul>
<li><a class="reference internal" href="#ecdh">ECDHキー承諾プロトコル</a><ul>
<li><a class="reference internal" href="#edh">EDH算出</a></li>
<li><a class="reference internal" href="#id13">ECDH の例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation">Key Derivation</a></li>
<li><a class="reference internal" href="#key-wrap">Key Wrap</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14">用語</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="jose.html"
         title="Previous Chapter: Terms">&laquo; Terms</a></li>
  <li><a href="jwt.html"
         title="Next Chapter: JSON Web Token (JWT) : draft22">JSON Web Token (... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/jwa.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="json-web-algorithms-jwa-draft30">
<span id="jwa-head"></span><h1>JSON Web Algorithms (JWA) : draft30<a class="headerlink" href="#json-web-algorithms-jwa-draft30" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">Draft 30: <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30</a></p>
<blockquote>
<div><ul class="simple">
<li>Security Considerations</li>
<li>パディング: PKCS#5 -&gt; PKCS#7 (<a class="reference external" href="http://tools.ietf.org/html/rfc2315">http://tools.ietf.org/html/rfc2315</a>)</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>電子署名(alg)  <a class="reference internal" href="#jwa-3"><em>Section.3</em></a></li>
<li>暗号化キーの取り扱い(暗号化とか,alg)  <a class="reference internal" href="#jwa-4"><em>Section.4</em></a></li>
<li>コンテンツ暗号化(enc) <a class="reference internal" href="#jwa-5"><em>Section.5</em></a></li>
<li>キー(kty ...) <a class="reference internal" href="#jwa-6"><em>Section.6</em></a></li>
</ul>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id17">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id18">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions" id="id19">1.1.  Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#terminology" id="id20">2.  Terminology</a></li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-digital-signatures-and-macs" id="id21">3.  Cryptographic Algorithms for Digital Signatures and MACs</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jws" id="id22">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a></li>
<li><a class="reference internal" href="#hmac-with-sha-2-functions" id="id23">3.2.  HMAC with SHA-2 Functions</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pkcs1-v1-5" id="id24">3.3.  Digital Signature with RSASSA-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#digital-signature-with-ecdsa" id="id25">3.4.  Digital Signature with ECDSA</a></li>
<li><a class="reference internal" href="#digital-signature-with-rsassa-pss" id="id26">3.5.  Digital Signature with RSASSA-PSS</a></li>
<li><a class="reference internal" href="#using-the-algorithm-none" id="id27">3.6.  Using the Algorithm &#8220;none&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-key-management" id="id28">4.  Cryptographic Algorithms for Key Management</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter-values-for-jwe" id="id29">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-pkcs1-v1-5" id="id30">4.2. Key Encryption with RSAES-PKCS1-V1_5</a></li>
<li><a class="reference internal" href="#key-encryption-with-rsaes-oaep" id="id31">4.3. Key Encryption with RSAES OAEP</a></li>
<li><a class="reference internal" href="#key-wrapping-with-aes-key-wrap" id="id32">4.4. Key Wrapping with AES Key Wrap</a></li>
<li><a class="reference internal" href="#direct-encryption-with-a-shared-symmetric-key" id="id33">4.5. Direct Encryption with a Shared Symmetric Key</a></li>
<li><a class="reference internal" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" id="id34">4.6.  Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-ecdh-key-agreement" id="id35">4.6.1. Header Parameters Used for ECDH Key Agreement</a><ul>
<li><a class="reference internal" href="#epk-ephemeral-public-key-header-parameter" id="id36">4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a></li>
<li><a class="reference internal" href="#apu-agreement-partyuinfo-header-parameter" id="id37">4.6.1.2. &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a></li>
<li><a class="reference internal" href="#apv-agreement-partyvinfo-header-parameter" id="id38">4.6.1.3. &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation-for-ecdh-key-agreement" id="id39">4.6.2. Key Derivation for ECDH Key Agreement</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-aes-gcm" id="id40">4.7. Key Encryption with AES GCM</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-aes-gcm-key-encryption" id="id41">4.7.1. Header Parameters Used for AES GCM Key Encryption</a><ul>
<li><a class="reference internal" href="#iv-initialization-vector-header-parameter" id="id42">4.7.1.1. &#8220;iv&#8221; (Initialization Vector) Header Parameter</a></li>
<li><a class="reference internal" href="#tag-authentication-tag-header-parameter" id="id43">4.7.1.2. &#8220;tag&#8221; (Authentication Tag) Header Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#key-encryption-with-pbes2" id="id44">4.8. Key Encryption with PBES2</a><ul>
<li><a class="reference internal" href="#header-parameters-used-for-pbes2-key-encryption" id="id45">4.8.1. Header Parameters Used for PBES2 Key Encryption</a><ul>
<li><a class="reference internal" href="#p2s-pbes2-salt-parameter" id="id46">4.8.1.1. &#8220;p2s&#8221; (PBES2 salt) Parameter</a></li>
<li><a class="reference internal" href="#p2c-pbes2-count-parameter" id="id47">4.8.1.2. &#8220;p2c&#8221; (PBES2 count) Parameter</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-content-encryption" id="id48">5. Cryptographic Algorithms for Content Encryption</a><ul>
<li><a class="reference internal" href="#enc-encryption-algorithm-header-parameter-values-for-jwe" id="id49">5.1. &#8220;enc&#8221; (Encryption Algorithm) Header Parameter Values for JWE</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-algorithms" id="id50">5.2. AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" id="id51">5.2.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a></li>
<li><a class="reference internal" href="#generic-aes-cbc-hmac-sha2-algorithm" id="id52">5.2.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><ul>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-encryption" id="id53">5.2.2.1. AES_CBC_HMAC_SHA2 Encryption</a></li>
<li><a class="reference internal" href="#aes-cbc-hmac-sha2-decryption" id="id54">5.2.2.2. AES_CBC_HMAC_SHA2 Decryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aes-128-cbc-hmac-sha-256" id="id55">5.2.3. AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#aes-192-cbc-hmac-sha-384" id="id56">5.2.4. AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#aes-256-cbc-hmac-sha-512" id="id57">5.2.5. AES_256_CBC_HMAC_SHA_512</a></li>
<li><a class="reference internal" href="#content-encryption-with-aes-cbc-hmac-sha2" id="id58">5.2.6. Content Encryption with AES_CBC_HMAC_SHA2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#content-encryption-with-aes-gcm" id="id59">5.3. Content Encryption with AES GCM</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cryptographic-algorithms-for-keys" id="id60">6. Cryptographic Algorithms for Keys</a><ul>
<li><a class="reference internal" href="#kty-key-type-parameter-values" id="id61">6.1. &#8220;kty&#8221; (Key Type) Parameter Values</a></li>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-keys" id="id62">6.2. Parameters for Elliptic Curve Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-public-keys" id="id63">6.2.1. Parameters for Elliptic Curve Public Keys</a><ul>
<li><a class="reference internal" href="#crv-curve-parameter" id="id64">6.2.1.1. &#8220;crv&#8221; (Curve) Parameter</a></li>
<li><a class="reference internal" href="#x-x-coordinate-parameter" id="id65">6.2.1.2. &#8220;x&#8221; (X Coordinate) Parameter</a></li>
<li><a class="reference internal" href="#y-y-coordinate-parameter" id="id66">6.2.1.3. &#8220;y&#8221; (Y Coordinate) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-elliptic-curve-private-keys" id="id67">6.2.2. Parameters for Elliptic Curve Private Keys</a><ul>
<li><a class="reference internal" href="#d-ecc-private-key-parameter" id="id68">6.2.2.1. &#8220;d&#8221; (ECC Private Key) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-keys" id="id69">6.3. Parameters for RSA Keys</a><ul>
<li><a class="reference internal" href="#parameters-for-rsa-public-keys" id="id70">6.3.1. Parameters for RSA Public Keys</a><ul>
<li><a class="reference internal" href="#n-modulus-parameter" id="id71">6.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a></li>
<li><a class="reference internal" href="#e-exponent-parameter" id="id72">6.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-rsa-private-keys" id="id73">6.3.2. Parameters for RSA Private Keys</a><ul>
<li><a class="reference internal" href="#d-private-exponent-parameter" id="id74">6.3.2.1. &#8220;d&#8221; (Private Exponent) Parameter</a></li>
<li><a class="reference internal" href="#p-first-prime-factor-parameter" id="id75">6.3.2.2. &#8220;p&#8221; (First Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#q-second-prime-factor-parameter" id="id76">6.3.2.3. &#8220;q&#8221; (Second Prime Factor) Parameter</a></li>
<li><a class="reference internal" href="#dp-first-factor-crt-exponent-parameter" id="id77">6.3.2.4. &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#dq-second-factor-crt-exponent-parameter" id="id78">6.3.2.5. &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a></li>
<li><a class="reference internal" href="#qi-first-crt-coefficient-parameter" id="id79">6.3.2.6. &#8220;qi&#8221; (First CRT Coefficient) Parameter</a></li>
<li><a class="reference internal" href="#oth-other-primes-info-parameter" id="id80">6.3.2.7. &#8220;oth&#8221; (Other Primes Info) Parameter</a><ul>
<li><a class="reference internal" href="#r-prime-factor" id="id81">6.3.2.7.1. &#8220;r&#8221; (Prime Factor)</a></li>
<li><a class="reference internal" href="#d-factor-crt-exponent" id="id82">6.3.2.7.2. &#8220;d&#8221; (Factor CRT Exponent)</a></li>
<li><a class="reference internal" href="#t-factor-crt-coefficient" id="id83">6.3.2.7.3. &#8220;t&#8221; (Factor CRT Coefficient)</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#parameters-for-symmetric-keys" id="id84">6.4. Parameters for Symmetric Keys</a><ul>
<li><a class="reference internal" href="#k-key-value-parameter" id="id85">6.4.1. &#8220;k&#8221; (Key Value) Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id86">7. IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-algorithms-registry" id="id87">7.1. JSON Web Signature and Encryption Algorithms Registry</a><ul>
<li><a class="reference internal" href="#registration-template" id="id88">7.1.1. Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents" id="id89">7.1.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#header-parameter-names-registration" id="id90">7.2. Header Parameter Names Registration</a><ul>
<li><a class="reference internal" href="#registry-contents" id="id91">7.2.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-encryption-compression-algorithms-registry" id="id92">7.3. JSON Web Encryption Compression Algorithms Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-3-1" id="id93">7.3.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-3-2" id="id94">7.3.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-types-registry" id="id95">7.4. JSON Web Key Types Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-4-1" id="id96">7.4.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-4-2" id="id97">7.4.2. Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-parameters-registration" id="id98">7.5. JSON Web Key Parameters Registration</a><ul>
<li><a class="reference internal" href="#jwa-7-5-1" id="id99">7.5.1. Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#json-web-key-elliptic-curve-registry" id="id100">7.6. JSON Web Key Elliptic Curve Registry</a><ul>
<li><a class="reference internal" href="#jwa-7-6-1" id="id101">7.6.1. Registration Template</a></li>
<li><a class="reference internal" href="#jwa-7-6-2" id="id102">7.6.2. Initial Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id103">8. Security Considerations</a><ul>
<li><a class="reference internal" href="#algorithms-and-key-sizes-will-be-deprecated" id="id104">8.1. Algorithms and Key Sizes will be Deprecated</a></li>
<li><a class="reference internal" href="#key-lifetimes" id="id105">8.2. Key Lifetimes</a></li>
<li><a class="reference internal" href="#rsaes-pkcs1-v1-5-security-considerations" id="id106">8.3. RSAES-PKCS1-v1_5 Security Considerations</a></li>
<li><a class="reference internal" href="#aes-gcm-security-considerations" id="id107">8.4. AES GCM Security Considerations</a></li>
<li><a class="reference internal" href="#plaintext-jws-security-considerations" id="id108">8.5.  Plaintext JWS Security Considerations</a></li>
<li><a class="reference internal" href="#denial-of-service-attacks" id="id109">8.6.  Denial of Service Attacks</a></li>
<li><a class="reference internal" href="#reusing-key-material-when-encrypting-keys" id="id110">8.7.  Reusing Key Material when Encrypting Keys</a></li>
<li><a class="reference internal" href="#password-considerations" id="id111">8.8.  Password Considerations</a></li>
<li><a class="reference internal" href="#key-entropy" id="id112">8.9.  Key Entropy</a></li>
<li><a class="reference internal" href="#differences-between-digital-signatures-and-macs" id="id113">8.10.  Differences between Digital Signatures and MACs</a></li>
<li><a class="reference internal" href="#adaptive-chosen-ciphertext-attacks" id="id114">8.12.  Adaptive Chosen-Ciphertext Attacks</a></li>
<li><a class="reference internal" href="#timing-attacks" id="id115">8.13.  Timing Attacks</a></li>
<li><a class="reference internal" href="#rsa-private-key-representations-and-blinding" id="id116">8.14.  RSA Private Key Representations and Blinding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#internationalization-considerations" id="id117">9. Internationalization Considerations</a></li>
<li><a class="reference internal" href="#references" id="id118">10. References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id119">10.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id120">10.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-algorithm-identifier-cross-reference" id="id121">Appendix A. Algorithm Identifier Cross-Reference</a><ul>
<li><a class="reference internal" href="#a-1-digital-signature-mac-algorithm-identifier-cross-reference" id="id122">A.1. Digital Signature/MAC Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-2-key-management-algorithm-identifier-cross-reference" id="id123">A.2. Key Management Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#a-3-content-encryption-algorithm-identifier-cross-reference" id="id124">A.3. Content Encryption Algorithm Identifier Cross-Reference</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms" id="id125">Appendix B. Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><ul>
<li><a class="reference internal" href="#b-1-test-cases-for-aes-128-cbc-hmac-sha-256" id="id126">B.1. Test Cases for AES_128_CBC_HMAC_SHA_256</a></li>
<li><a class="reference internal" href="#b-2-test-cases-for-aes-192-cbc-hmac-sha-384" id="id127">B.2. Test Cases for AES_192_CBC_HMAC_SHA_384</a></li>
<li><a class="reference internal" href="#b-3-test-cases-for-aes-256-cbc-hmac-sha-512" id="id128">B.3. Test Cases for AES_256_CBC_HMAC_SHA_512</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-c-example-ecdh-es-key-agreement-computation" id="id129">Appendix C. Example ECDH-ES Key Agreement Computation</a></li>
<li><a class="reference internal" href="#jwa-terms" id="id130">用語</a><ul>
<li><a class="reference internal" href="#ecdh" id="id131">ECDHキー承諾プロトコル</a><ul>
<li><a class="reference internal" href="#edh" id="id132">EDH算出</a></li>
<li><a class="reference internal" href="#id13" id="id133">ECDH の例</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-derivation" id="id134">Key Derivation</a></li>
<li><a class="reference internal" href="#key-wrap" id="id135">Key Wrap</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id14" id="id136">用語</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwa-abstract"></span><h2><a class="toc-backref" href="#id17">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification registers cryptographic
algorithms and identifiers to be used
with the JSON Web Signature (<a class="reference internal" href="jws.html"><em>JWS</em></a>),
JSON Web Encryption (<a class="reference internal" href="jwe.html"><em>JWE</em></a>),
and JSON Web Key (<a class="reference internal" href="jwk.html"><em>JWK</em></a>) specifications.
It defines several IANA registries for these identifiers.</p>
<p>( draft20 )</p>
</div>
<div class="section" id="introduction">
<span id="jwa-1"></span><h2><a class="toc-backref" href="#id18">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The JSON Web Algorithms (JWA) specification
enumerates cryptographic algorithms and identifiers
to be used with
the JSON Web Signature (JWS) [JWS],
JSON Web Encryption (JWE) [JWE],
and JSON Web Key (JWK) [JWK] specifications.
All these specifications utilize
JavaScript Object Notation (JSON) [RFC4627] based data structures.
This specification also describes the semantics and operations
that are specific to these algorithms and algorithm families.</p>
<p>Enumerating the algorithms and identifiers for them in this specification,
rather than in the JWS, JWE, and JWK specifications,
is intended to allow them to remain unchanged in the face of changes
in the set of required, recommended, optional, and deprecated algorithms over time.</p>
<p>(draft 04 : <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-04#section-1</a> )</p>
<div class="section" id="notational-conventions">
<span id="jwa-1-1"></span><h3><a class="toc-backref" href="#id19">1.1.  Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in Key words for use in
RFCs to Indicate Requirement Levels [RFC2119].</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-14#section-1.1</a> )</p>
</div>
</div>
<div class="section" id="terminology">
<span id="jwa-2"></span><h2><a class="toc-backref" href="#id20">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<p>These terms defined by the JSON Web Signature (JWS) [JWS]
specification are incorporated into this specification: &#8220;JSON Web
Signature (JWS)&#8221;, &#8220;Base64url Encoding&#8221;, &#8220;Header Parameter&#8221;, &#8220;JOSE
Header&#8221;, &#8220;JWS Payload&#8221;, &#8220;JWS Protected Header&#8221;, &#8220;JWS Signature&#8221;,
&#8220;JWS Signing Input&#8221;, and &#8220;Plaintext JWS&#8221;.</p>
<p>These terms defined by the JSON Web Encryption (JWE) [JWE]
specification are incorporated into this specification: &#8220;JSON Web
Encryption (JWE)&#8221;, &#8220;Additional Authenticated Data (AAD)&#8221;,
&#8220;Authentication Tag&#8221;, &#8220;Ciphertext&#8221;, &#8220;Content Encryption Key (CEK)&#8221;,
&#8220;Direct Encryption&#8221;, &#8220;Direct Key Agreement&#8221;, &#8220;JWE Authentication
Tag&#8221;, &#8220;JWE Ciphertext&#8221;, &#8220;JWE Encrypted Key&#8221;, &#8220;JWE Initialization
Vector&#8221;, &#8220;JWE Protected Header&#8221;, &#8220;Key Agreement with Key Wrapping&#8221;,
&#8220;Key Encryption&#8221;, &#8220;Key Management Mode&#8221;, &#8220;Key Wrapping&#8221;, and
&#8220;Plaintext&#8221;.</p>
<p>These terms defined by the JSON Web Key (JWK) [JWK] specification are
incorporated into this specification: &#8220;JSON Web Key (JWK)&#8221; and &#8220;JSON
Web Key Set (JWK Set)&#8221;.</p>
<p>(draft30)</p>
</div>
<div class="section" id="cryptographic-algorithms-for-digital-signatures-and-macs">
<span id="jwa-3"></span><h2><a class="toc-backref" href="#id21">3.  Cryptographic Algorithms for Digital Signatures and MACs</a><a class="headerlink" href="#cryptographic-algorithms-for-digital-signatures-and-macs" title="Permalink to this headline">¶</a></h2>
<p>JWS uses cryptographic algorithms to digitally sign or create a
Message Authentication Codes (MAC) of the contents of the JWS
Protected Header and the JWS Payload.</p>
<p>(draft30)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30#section-3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30#section-3</a>)</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jws">
<span id="jwa-3-1"></span><h3><a class="toc-backref" href="#id22">3.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWS</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jws" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;alg&#8221; (algorithm) header parameter
values defined by this specification for use with JWS,
each of which is explained in more detail in the following sections:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="49%" />
<col width="29%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">alg
Parameter
Value</th>
<th class="head">Digital Signature or MAC
Algorithm</th>
<th class="head">Implementation
Requirements</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HS256</td>
<td>HMAC using SHA-256</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>HS384</td>
<td>HMAC using SHA-384</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>HS512</td>
<td>HMAC using SHA-512</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS256</td>
<td>RSASSA-PKCS-v1_5
using SHA-256</td>
<td>RECOMMENDED</td>
</tr>
<tr class="row-even"><td>RS384</td>
<td>RSASSA-PKCS-v1_5
using SHA-384</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>RS512</td>
<td>RSASSA-PKCS-v1_5
using SHA-512</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES256</td>
<td>ECDSA using P-256 curve and
SHA-256</td>
<td>RECOMMENDED+</td>
</tr>
<tr class="row-odd"><td>ES384</td>
<td>ECDSA using P-384 curve and
SHA-384</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>ES512</td>
<td>ECDSA using P-521 curve and
SHA-512 hash algorithm</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>PS256</td>
<td>RSASSA-PSS using SHA-256
MGF1 with SHA-256</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>PS384</td>
<td>RSASSA-PSS using SHA-384
MGF1 with SHA-384</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-odd"><td>PS512</td>
<td>RSASSA-PSS using SHA-512
MGF1 with SHA-512</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>none</td>
<td>No digital signature or MAC
performed</td>
<td>OPTIONAL</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PSnnn シリーズ増えてる</li>
</ul>
</div>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates
that the requirement strength is likely to be increased
in a future version of the specification.</p>
<p>See <a class="reference internal" href="#jwa-appendix-a-1"><em>Appendix A.1</em></a>
for a table cross-referencing the JWS digital signature
and MAC &#8220;alg&#8221; (algorithm) values defined in this specification
with the equivalent identifiers
used by other standards and software packages.</p>
<p>(draft21)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-3.1</a>)</p>
</div>
<div class="section" id="hmac-with-sha-2-functions">
<span id="jwa-3-2"></span><h3><a class="toc-backref" href="#id23">3.2.  HMAC with SHA-2 Functions</a><a class="headerlink" href="#hmac-with-sha-2-functions" title="Permalink to this headline">¶</a></h3>
<p>Hash-based Message Authentication Codes (HMACs) enable one
to use a <strong>secret</strong> plus a <strong>cryptographic hash function</strong>
to generate a Message Authentication Code (MAC).</p>
<p>This can be used to demonstrate that
whoever generated the MAC was in possession of the MAC key.
The algorithm for implementing and validating HMACs is
provided in <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2104.html"><strong>RFC 2104</strong></a> <a class="reference internal" href="#term-rfc2104"><em class="xref std std-term">[RFC2104]</em></a>.</p>
<p>A key of the same size as the hash output
(for instance, 256 bits for &#8220;HS256&#8221;)
or larger MUST be used with this algorithm.</p>
<p>The HMAC SHA-256 MAC is generated per RFC 2104,
using SHA-256 as the hash algorithm &#8220;<strong>H</strong>&#8221;,
using the <a class="reference internal" href="jws.html#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> as the &#8220;<strong>text</strong>&#8221; value,
and using the <a class="reference internal" href="glossary.html#term-shared-key"><em class="xref std std-term">shared key</em></a>.
The HMAC output value is the JWS Signature.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is an HMAC value computed
using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>MAC Algorithm</td>
</tr>
<tr class="row-even"><td>HS256
HS384
HS512</td>
<td>HMAC using SHA-256
HMAC using SHA-384
HMAC using SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The HMAC SHA-256 MAC for a JWS is validated
by computing an HMAC value per RFC 2104,
using SHA-256 as the hash algorithm &#8220;H&#8221;,
using the received JWS Signing Input as the &#8220;text&#8221; value,
and using the shared key.</p>
<p>This computed HMAC value is then compared
to the result of <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> decoding
the received encoded JWS Signature value.</p>
<p>Alternatively,
the computed HMAC value can be base64url encoded and
compared to the received encoded JWS Signature value,
as this comparison produces the same result
as comparing the unencoded values.</p>
<p>In either case,
if the values match,
the HMAC has been validated.</p>
<p>Securing content and validation with the HMAC SHA-384
and HMAC SHA-512 algorithms is performed
identically to the procedure for HMAC SHA-256 &#8211;
just using the corresponding hash algorithms
with correspondingly larger minimum key sizes
and result values:
384 bits each for HMAC SHA-384
and 512 bits each for HMAC SHA-512.</p>
<p>An example using this algorithm is shown
in <a class="reference internal" href="jws.html#jws-appendix-a-1"><em>Appendix A.1</em></a> of <a class="reference internal" href="jwe.html#term-76"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.2</a>)</p>
</div>
<div class="section" id="digital-signature-with-rsassa-pkcs1-v1-5">
<span id="jwa-3-3"></span><h3><a class="toc-backref" href="#id24">3.3.  Digital Signature with RSASSA-PKCS1-V1_5</a><a class="headerlink" href="#digital-signature-with-rsassa-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the RSASSA-PKCS1-V1_5
digital signature algorithm
as defined in Section 8.2 of <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> <a class="reference internal" href="jwe.html#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>
(commonly known as PKCS #1),
using SHA-2 [SHS] hash functions.</p>
<p>A key of size 2048 bits or larger MUST be used
with these algorithms.</p>
<p>The RSASSA-PKCS1-V1_5 SHA-256 digital signature is generated
as follows:
Generate a digital signature of the JWS Signing Input
using RSASSA-PKCS1-V1_5-SIGN
and the SHA-256 hash function
with the desired private key.
This is the <a class="reference internal" href="jws.html#term-15"><em class="xref std std-term">JWS Signature</em></a> value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is a digital signature value computed
using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td>RS256
RS384
RS512</td>
<td>RSASSA-PKCS-v1_5 using SHA-256
RSASSA-PKCS-v1_5 using SHA-384
RSASSA-PKCS-v1_5 using SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The RSASSA-PKCS1-V1_5 SHA-256 digital signature for a JWS
is validated as follows:
Submit the JWS Signing Input,
the JWS Signature,
and the public key corresponding to the private key
used by the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm
using SHA-256 as the hash function.</p>
<p>Signing and validation with the RSASSA-PKCS1-V1_5 SHA-384
and RSASSA- PKCS1-V1_5 SHA-512 algorithms
is performed identically to the procedure
for RSASSA-PKCS1-V1_5 SHA-256 &#8211; just using the
corresponding hash algorithms instead of SHA-256.</p>
<p>An example using this algorithm is shown
in <a class="reference internal" href="jws.html#jws-appendix-a-2"><em>Appendix A.2</em></a> of <a class="reference internal" href="jwe.html#term-76"><em class="xref std std-term">[JWS]</em></a>.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.3</a>)</p>
</div>
<div class="section" id="digital-signature-with-ecdsa">
<span id="jwa-3-4"></span><h3><a class="toc-backref" href="#id25">3.4.  Digital Signature with ECDSA</a><a class="headerlink" href="#digital-signature-with-ecdsa" title="Permalink to this headline">¶</a></h3>
<p>The Elliptic Curve Digital Signature Algorithm (ECDSA) [DSS]
provides for the use of Elliptic Curve cryptography,
which is able to provide equivalent security
to RSA cryptography
but using shorter key sizes and with greater processing speed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>ECDSAの方がRSAと同等の強度の場合、キーが短くて速い</li>
</ul>
</div>
<p>This means that ECDSA digital signatures
will be substantially smaller
in terms of length than equivalently strong RSA digital signatures.</p>
<p>This specification defines
the use of ECDSA with the P-256 curve and
the SHA-256 cryptographic hash function,
ECDSA with the P-384 curve and the SHA-384 hash function,
and ECDSA with the P-521 curve and the SHA-512 hash function.</p>
<p>The P-256, P-384, and P-521 curves are defined in <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a>.</p>
<p>The ECDSA P-256 SHA-256 digital signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Generate a digital signature of the JWS Signing Input
using ECDSA P-256 SHA-256 with the desired private key.</p>
<p>The output will be the pair (R, S),
where R and S are 256 bit unsigned integers.</p>
</li>
<li><p class="first">Turn R and S into octet sequences in <em class="xref std std-term">big endian order</em>,
with each array being be 32 octets long.</p>
<p>The octet sequence representations MUST NOT be shortened
to omit any leading zero octets contained in the values.</p>
</li>
<li><p class="first">Concatenate the two octet sequences in the order R and then S.
(Note that many ECDSA implementations will directly produce this
concatenation as their output.)</p>
</li>
<li><p class="first">The resulting 64 octet sequence is the JWS Signature value.</p>
</li>
</ol>
</div></blockquote>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that the JWS Signature is a digital signature value
computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="40%" />
<col width="60%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td>ES256</td>
<td>ECDSA using P-256 and SHA-256</td>
</tr>
<tr class="row-odd"><td>ES384</td>
<td>ECDSA using P-384 and SHA-384</td>
</tr>
<tr class="row-even"><td>ES512</td>
<td>ECDSA using P-521 and SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The ECDSA P-256 SHA-256 digital signature for a JWS is validated as
follows:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The JWS Signature value MUST be a 64 octet sequence.</p>
<p>If it is not a 64 octet sequence, the validation has failed.</p>
</li>
<li><p class="first">Split the 64 octet sequence into two 32 octet sequences.</p>
<p>The first octet sequence represents R and the second S.</p>
<p>The values R and S are represented as octet sequences
using the Integer-to- OctetString Conversion defined
in Section 2.3.7 of SEC1 [SEC1]
(in big endian octet order).</p>
</li>
<li><p class="first">Submit the JWS Signing Input R, S and the public key (x, y) to
the ECDSA P-256 SHA-256 validator.</p>
</li>
</ol>
</div></blockquote>
<p>Signing and validation with the ECDSA P-384 SHA-384
and ECDSA P-521 SHA-512 algorithms is performed
identically to the procedure for ECDSA P-256 SHA-256 &#8211;
just using the corresponding hash algorithms
with correspondingly larger result values.</p>
<p>For ECDSA P-384 SHA-384,
R and S will be 384 bits each, resulting in a 96 octet sequence.</p>
<p>For ECDSA P-521 SHA-512,
R and S will be 521 bits each, resulting in a 132 octet sequence.</p>
<p>Examples using these algorithms are shown in Appendices A.3 and A.4
of [JWS].</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.4</a>)</p>
</div>
<div class="section" id="digital-signature-with-rsassa-pss">
<span id="jwa-3-5"></span><h3><a class="toc-backref" href="#id26">3.5.  Digital Signature with RSASSA-PSS</a><a class="headerlink" href="#digital-signature-with-rsassa-pss" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the RSASSA-PSS
digital signature algorithm
as defined in Section 8.1 of <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> <a class="reference internal" href="jwe.html#term-rfc3447"><em class="xref std std-term">[RFC3447]</em></a>
with the <em class="xref std std-term">MGF1 mask generation function</em>
and SHA-2 hash functions,
always using the same hash function
for both the RSASSA-PSS hash function and the
<em class="xref std std-term">MGF1 hash function</em>.</p>
<p>The size of the salt value is the same size
as the hash function output.
All other algorithm parameters use
the defaults specified in Section A.2.3 of RFC 3447.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>The RSASSA-PSS SHA-256 digital signature is generated as follows:
Generate a digital signature of the JWS Signing Input
using RSASSA- PSS-SIGN,
the SHA-256 hash function,
and the <em class="xref std std-term">MGF1 mask generation function</em>
with SHA-256 with the desired private key.
This is the JWS signature value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWS Signature is a digital signature value
computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Digital Signature Algorithm</td>
</tr>
<tr class="row-even"><td>PS256</td>
<td>RSASSA-PSS using SHA-256 and MGF1 with
SHA-256</td>
</tr>
<tr class="row-odd"><td>PS384</td>
<td>RSASSA-PSS using SHA-384 and MGF1 with
SHA-384</td>
</tr>
<tr class="row-even"><td>PS512</td>
<td>RSASSA-PSS using SHA-512 and MGF1 with
SHA-512</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The RSASSA-PSS SHA-256 digital signature for a JWS
is validated as follows:
Submit the JWS Signing Input,
the JWS Signature,
and the public key corresponding to the private key
used by the signer to the RSASSA-PSS-VERIFY algorithm
using SHA-256 as the hash function and
using MGF1 as the mask generation function with SHA-256.</p>
<p>Signing and validation with the RSASSA-PSS SHA-384
and RSASSA-PSS SHA-512 algorithms is performed identically
to the procedure for RSASSA-PSS SHA-256 &#8211;
just using the alternative hash algorithm in both roles.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-3.5</a>)</p>
</div>
<div class="section" id="using-the-algorithm-none">
<span id="jwa-3-6"></span><h3><a class="toc-backref" href="#id27">3.6.  Using the Algorithm &#8220;none&#8221;</a><a class="headerlink" href="#using-the-algorithm-none" title="Permalink to this headline">¶</a></h3>
<p>JWSs MAY also be created that do not provide integrity protection.</p>
<p>Such a JWS is called a &#8220;Plaintext JWS&#8221;.</p>
<p>A Plaintext JWS MUST use the &#8220;alg&#8221; value &#8220;none&#8221;,
and is formatted identically to other JWSs,
but MUST use the empty octet sequence as its JWS Signature value.</p>
<p>Receivers MUST verify that the JWS Signature value is
the empty octet sequence.</p>
<p>See Section 8.5 for security considerations associated with
using this algorithm.</p>
<p>(draft24)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-24#section-3.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-24#section-3.6</a>)</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-key-management">
<span id="jwa-4"></span><h2><a class="toc-backref" href="#id28">4.  Cryptographic Algorithms for Key Management</a><a class="headerlink" href="#cryptographic-algorithms-for-key-management" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms to encrypt or determine
the Content Encryption Key (CEK).</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4</a>)</p>
<div class="section" id="alg-algorithm-header-parameter-values-for-jwe">
<span id="jwa-jwe-alg"></span><span id="jwa-4-1"></span><h3><a class="toc-backref" href="#id29">4.1. &#8220;alg&#8221; (Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#alg-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>キー(CMK)の暗号手順</li>
</ul>
</div>
<p>The table below is the set of &#8220;alg&#8221; (algorithm)
Header Parameter values that are defined
by this specification for use with JWE.</p>
<p>These algorithms are used to encrypt the CEK,
producing the JWE Encrypted Key,
or to use key agreement to agree upon the CEK.</p>
<table border="1" class="docutils">
<colgroup>
<col width="30%" />
<col width="27%" />
<col width="19%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>RSA1_5</td>
<td><a href="#id137"><span class="problematic" id="id138">RSAES-PKCS1-V1_</span></a>
5[RFC3447]</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>RSA-OAEP</td>
<td>RSAES OAEP
with
default
parameters</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>RSA-OAEP-256</td>
<td>RSAES OAEP
using SHA-256
and MGF1 with
SHA-256</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A128KW</td>
<td>AES Key Wrap
with default
initial value
using 128 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A192KW</td>
<td>AES Key Wrap
with default
initial value
using 192 bit
key</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A256KW</td>
<td>AES Key Wrap
with default
initial value
using 256 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>dir</td>
<td>Direct use of a
shared
symmetric key
as CEK</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>ECDH-ES</td>
<td>Elliptic Curve
Diffie-Hellman
Ephemeral
Static key
agreement using
Concat KDF</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended+</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A128KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A128KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A192KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A192KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A256KW</td>
<td>ECDH-ES using
Concat KDF and
CEK wrapped
with &#8220;A256KW&#8221;</td>
<td>&#8220;epk&#8221;,
&#8220;apu&#8221;,
&#8220;apv&#8221;</td>
<td>Recommended</td>
</tr>
<tr class="row-odd"><td>A128GCMKW</td>
<td>Key wrapping
with AES GCM
using 128 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A192GCMKW</td>
<td>Key wrapping
with AES GCM
using 192 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A256GCMKW</td>
<td>Key wrapping
with AES GCM
using 256 bit
key</td>
<td>&#8220;iv&#8221;,
&#8220;tag&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>PBES2-HS256+A128KW</td>
<td>PBES2 with HMAC
SHA-256 and
&#8220;A128KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>PBES2-HS384+A192KW</td>
<td>PBES2 with HMAC
SHA-384 and
&#8220;A192KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>PBES2-HS512+A256KW</td>
<td>PBES2 with HMAC
SHA-512 and
&#8220;A256KW&#8221;
wrapping</td>
<td>&#8220;p2s&#8221;,
&#8220;p2c&#8221;</td>
<td>Optional</td>
</tr>
</tbody>
</table>
<p>The <em class="xref std std-term">Additional Header Parameters</em> column indicates
what additional Header Parameters are used by the algorithm,
beyond &#8220;alg&#8221;, which all use.
All but &#8220;dir&#8221; and &#8220;ECDH-ES&#8221; also produce a JWE Encrypted Key value.</p>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>See <a class="reference internal" href="jwk.html#jwk-appendix-a-2"><em>Appendix A.2</em></a>
for a table cross-referencing the JWE &#8220;alg&#8221; (algorithm) values
defined in this specification
with the equivalent identifiers used by other standards
and software packages.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">draft 26, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1</a></p>
</li>
<li><p class="first">RSAでCEKを非対称暗号する ( <span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> )</p>
<blockquote>
<div><ul class="simple">
<li>RSA-OAEP-256</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">draft 21, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.1</a></p>
</li>
<li><p class="first">RSAでCEKを非対称暗号する ( <span class="target" id="index-4"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a> )</p>
<blockquote>
<div><ul class="simple">
<li>RSA1_5</li>
<li>RSA-OAEP</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">CEKを共有キーを使ってAESでラッピングする(<span class="target" id="index-5"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3394.html"><strong>RFC 3394</strong></a>)</p>
<blockquote>
<div><ul class="simple">
<li>A128KW</li>
<li>A192KW</li>
<li>A256KW</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">dir       : 共有キーを直接つかう(JWEでキーを交換しない</p>
</li>
<li><dl class="first docutils">
<dt>ECDHで共有キーを派生させる</dt>
<dd><ul class="first last simple">
<li>ECDH-ES   : <span class="target" id="index-6"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6090.html"><strong>RFC 6090</strong></a></li>
</ul>
</dd>
</dl>
</li>
<li><p class="first">ECDHで派生させたキーをAESでラッピングする</p>
<blockquote>
<div><ul class="simple">
<li>ECDH-ES+A128KW    :</li>
<li>ECDH-ES+A192KW    :</li>
<li>ECDH-ES+A256KW    :</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">CEK を AES + GCM でラッピング</p>
<blockquote>
<div><ul class="simple">
<li>A128GCMKW</li>
<li>A192GCMKW</li>
<li>A256GCMKW</li>
</ul>
</div></blockquote>
</li>
<li><dl class="first docutils">
<dt>PBES2</dt>
<dd><ul class="first last simple">
<li>PBES2-HS256+A128KW</li>
<li>PBES2-HS384+A192KW</li>
<li>PBES2-HS512+A256KW</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
</div>
<div class="section" id="key-encryption-with-rsaes-pkcs1-v1-5">
<span id="jwa-4-2"></span><h3><a class="toc-backref" href="#id30">4.2. Key Encryption with RSAES-PKCS1-V1_5</a><a class="headerlink" href="#key-encryption-with-rsaes-pkcs1-v1-5" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CEK
with RSAES-PKCS1-V1_5 [RFC3447].</p>
<p>The &#8220;alg&#8221; Header Parameter value &#8220;RSA1_5&#8221; is used for this algorithm.</p>
<p>A key of size 2048 bits or larger MUST be used with this algorithm.</p>
<p>An example using this algorithm is shown in Appendix A.2 of [JWE].</p>
<p>(draft20)</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.2</a>)</p>
</div>
<div class="section" id="key-encryption-with-rsaes-oaep">
<span id="jwa-4-3"></span><h3><a class="toc-backref" href="#id31">4.3. Key Encryption with RSAES OAEP</a><a class="headerlink" href="#key-encryption-with-rsaes-oaep" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of encrypting a JWE CEK
with RSAES using Optimal Asymmetric Encryption Padding (OAEP) [RFC3447].</p>
<p>Two sets of parameters for using OAEP are defined,
which use different hash functions.</p>
<p>In the first case,
the default parameters specified by RFC 3447 in Section A.2.1 are used.
(Those default parameters are the SHA-1 hash function
and the MGF1 with SHA-1 mask generation function.)</p>
<p>In the second case,
the SHA-256 hash function and the MGF1 with SHA-256 mask generation function are used.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the corresponding algorithm:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>RSA-OAEP</td>
<td>RSAES OAEP using default parameters</td>
</tr>
<tr class="row-odd"><td>RSA-OAEP-256</td>
<td>RSAES OAEP using SHA-256 and MGF1 with
SHA-256</td>
</tr>
</tbody>
</table>
<p>A key of size 2048 bits or larger MUST be used with these algorithms.</p>
<p>An example using RSAES OAEP with the default parameters is shown in
<em class="xref std std-term">Appendix A.1</em> of [JWE].</p>
<p>( draft27 )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 26 : RSA-OAEP-256 追加</li>
</ul>
</div>
</div>
<div class="section" id="key-wrapping-with-aes-key-wrap">
<span id="jwa-4-4"></span><h3><a class="toc-backref" href="#id32">4.4. Key Wrapping with AES Key Wrap</a><a class="headerlink" href="#key-wrapping-with-aes-key-wrap" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>AES キーラップアルゴリズムでCEKを暗号化する</li>
</ul>
</div>
<p>This section defines the specifics of encrypting a JWE CEK
with the Advanced Encryption Standard (AES) Key Wrap Algorithm
<a class="reference internal" href="jwe.html#term-rfc3394"><em class="xref std std-term">[RFC3394]</em></a>
using the default initial value
specified in <a class="reference internal" href="rfc3394.html#rfc3394-2-2-3-1"><em>Section 2.2.3.1</em></a>.</p>
<p>The following &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221; (algorithm) Header Parameter values
are used to indicate that
the <a class="reference internal" href="jwe.html#term-34"><em class="xref std std-term">JWE Encrypted Key</em></a> is the result of encrypting the CEK
using the corresponding algorithm and key size:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>A128KW</td>
<td>AES Key Wrap with default initial value using
128 bit key</td>
</tr>
<tr class="row-odd"><td>A192KW</td>
<td>AES Key Wrap with default initial value using
192 bit key</td>
</tr>
<tr class="row-even"><td>A256KW</td>
<td>AES Key Wrap with default initial value using
256 bit key</td>
</tr>
</tbody>
</table>
<p>An example using this algorithm is shown
in <a class="reference internal" href="jwe.html#jwe-appendix-a-3"><em>Appendix A.3</em></a> of <a class="reference internal" href="#term-jwe"><em class="xref std std-term">[JWE]</em></a>.</p>
<p>(draft23)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.4</a>)</p>
</div>
<div class="section" id="direct-encryption-with-a-shared-symmetric-key">
<span id="jwa-4-5"></span><h3><a class="toc-backref" href="#id33">4.5. Direct Encryption with a Shared Symmetric Key</a><a class="headerlink" href="#direct-encryption-with-a-shared-symmetric-key" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of directly performing symmetric
key encryption without performing a key wrapping step.  In this case,
the shared symmetric key is used directly as the Content Encryption
Key (CEK) value for the &#8220;enc&#8221; algorithm.  An empty octet sequence is
used as the JWE Encrypted Key value.  The &#8220;alg&#8221; Header Parameter
value &#8220;dir&#8221; is used in this case.</p>
<p>Refer to the security considerations on key lifetimes in Section 8.2
and AES GCM in Section 8.4 when considering utilizing direct
encryption.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.5</a>)</p>
</div>
<div class="section" id="key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es">
<span id="jwa-ecdh-es"></span><span id="jwa-4-6"></span><h3><a class="toc-backref" href="#id34">4.6.  Key Agreement with Elliptic Curve Diffie-Hellman Ephemeral Static (ECDH-ES)</a><a class="headerlink" href="#key-agreement-with-elliptic-curve-diffie-hellman-ephemeral-static-ecdh-es" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of key agreement with
Elliptic Curve Diffie-Hellman Ephemeral Static <a class="reference internal" href="jwe.html#term-rfc6090"><em class="xref std std-term">[RFC6090]</em></a>,
in combination with the <em class="xref std std-ref">Concat KDF</em>,
as defined in <em class="xref std std-ref">Section 5.8.1</em> of <a class="reference internal" href="#term-nist-800-56a"><em class="xref std std-term">[NIST.800-56A]</em></a>.</p>
<p>The key agreement result can be used in one of two ways:</p>
<ol class="arabic simple">
<li>directly as the Content Encryption Key (CEK) for the &#8220;enc&#8221;
algorithm, in the Direct Key Agreement mode, or</li>
<li>as a symmetric key used to wrap the CEK with the &#8220;A128KW&#8221;,
&#8220;A192KW&#8221;, or &#8220;A256KW&#8221; algorithms, in the Key Agreement with Key
Wrapping mode.</li>
</ol>
<p>A new <em class="xref std std-term">ephemeral public key</em> value MUST
be generated for each key agreement operation.</p>
<p>In Direct Key Agreement mode,
the output of the Concat KDF MUST be a key of the same length
as that used by the &#8220;enc&#8221; algorithm.</p>
<p>In this case,
the <strong>empty octet sequence</strong> is used as the JWE Encrypted Key value.</p>
<p>The &#8220;alg&#8221; Header Parameter value &#8220;ECDH-ES&#8221; is used in the Direct Key Agreement mode.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>ダイレクトの場合、 JWE Encrypted Keyは空</li>
<li>つまり、PartyV は epk と 自分の static private で派生したキー(agreed upon key)をそのまま使って復号</li>
</ul>
</div>
<p>In Key Agreement with Key Wrapping mode,
the output of the Concat KDF MUST be a key of the length
needed for the specified key wrapping algorithm.</p>
<p>In this case,
the JWE Encrypted Key is the CEK wrapped with the <em class="xref std std-term">agreed upon key</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>ラッピングの場合、 JWE Encrypted Key は  <em class="xref std std-term">agreed upon key</em> で
ラップされた CEK</li>
<li>つまり、PartyUはランダム作成した暗号化キーを epkのプライベートと PartyVのstatic public で派生したものでラップして
Jweに添付</li>
<li>PartyVはagreed upon keyでラップをほどいてCEKを取り出して復号</li>
</ul>
</div>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWE Encrypted Key is the result of encrypting
the CEK using the result of the key agreement algorithm
as the key encryption key for the corresponding key wrapping algorithm:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter
Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A128KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A128KW&#8221;</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A192KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A192KW&#8221;</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A256KW</td>
<td>ECDH-ES using Concat KDF and CEK wrapped with
&#8220;A256KW&#8221;</td>
</tr>
</tbody>
</table>
<p>(draft23)</p>
<div class="section" id="header-parameters-used-for-ecdh-key-agreement">
<span id="jwa-4-6-1"></span><h4><a class="toc-backref" href="#id35">4.6.1. Header Parameters Used for ECDH Key Agreement</a><a class="headerlink" href="#header-parameters-used-for-ecdh-key-agreement" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameter names
are used for key agreement as defined below.</p>
<p>(draft23)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1</a>)</p>
<div class="section" id="epk-ephemeral-public-key-header-parameter">
<span id="jwa-epk"></span><span id="jwa-4-6-1-1"></span><h5><a class="toc-backref" href="#id36">4.6.1.1. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a><a class="headerlink" href="#epk-ephemeral-public-key-header-parameter" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>JWK(パブリックキー)を指定します</li>
</ul>
</div>
<p>The &#8220;epk&#8221; (ephemeral public key) value
created by the originator for the use in key agreement algorithms.</p>
<p>This key is represented as a JSON Web Key [JWK] public key value.</p>
<p>It MUST contain only <strong>public key parameters</strong>
and SHOULD contain only the minimum JWK parameters necessary to represent the key;
other JWK parameters included can be checked
for consistency and honored or can be ignored.</p>
<p>This Header Parameter MUST be present
and MUST be understood and processed by implementations
when these algorithms are used.</p>
<p>(draft23)
( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1</a>)</p>
</div>
<div class="section" id="apu-agreement-partyuinfo-header-parameter">
<span id="jwa-4-6-1-2"></span><h5><a class="toc-backref" href="#id37">4.6.1.2. &#8220;apu&#8221; (Agreement PartyUInfo) Header Parameter</a><a class="headerlink" href="#apu-agreement-partyuinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apu&#8221; (agreement PartyUInfo) value
for key agreement algorithms using it (such as &#8220;ECDH-ES&#8221;),
represented as a base64url encoded string.</p>
<p>When used,
the PartyUInfo value contains information about the sender.</p>
<p>Use of this Header Parameter is OPTIONAL.</p>
<p>This Header Parameter MUST be understood
and processed by implementations when these algorithms are used.</p>
<p>(draft23)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1.2</a>)</p>
</div>
<div class="section" id="apv-agreement-partyvinfo-header-parameter">
<span id="jwa-4-6-1-3"></span><h5><a class="toc-backref" href="#id38">4.6.1.3. &#8220;apv&#8221; (Agreement PartyVInfo) Header Parameter</a><a class="headerlink" href="#apv-agreement-partyvinfo-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;apv&#8221; (agreement PartyVInfo) value
for key agreement algorithms using it (such as &#8220;ECDH-ES&#8221;),
represented as a base64url encoded string.</p>
<p>When used,
the PartyVInfo value contains information about the receiver.</p>
<p>Use of this Header Parameter is OPTIONAL.</p>
<p>This Header Parameter MUST be understood
and processed by implementations when these algorithms are used.</p>
<p>(draft23)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.6.1.3</a>)</p>
</div>
</div>
<div class="section" id="key-derivation-for-ecdh-key-agreement">
<span id="jwa-4-6-2"></span><h4><a class="toc-backref" href="#id39">4.6.2. Key Derivation for ECDH Key Agreement</a><a class="headerlink" href="#key-derivation-for-ecdh-key-agreement" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>シェアードシークレットから派生させて、
agreed upon key を作ります。</li>
<li>Concat KDF で派生させます</li>
<li>ダイジェストは SHA-256にします</li>
</ul>
</div>
<p>The <em class="xref std std-term">key derivation process</em> derives the <em class="xref std std-ref">agreed upon key</em>
from the shared secret <a class="reference internal" href="#term-z"><em class="xref std std-term">Z</em></a> established
through the ECDH algorithm,
per <a class="reference internal" href="nist-sp800-56a.html#nist-sp800-56a-6-2-2-2"><em>Section 6.2.2.2</em></a> of <a class="reference internal" href="#term-nist-800-56a"><em class="xref std std-term">[NIST.800-56A]</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="nist-sp800-56a.html#nist-sp800-56a-6-2-2-2"><em>6.2.2.2 One-Pass Diffie-Hellman,C(1,1,ECC CDH)</em></a></li>
</ul>
</div>
<p>Key derivation is performed
using the <em class="xref std std-term">Concat KDF</em>,
as defined in <em class="xref std std-ref">Section 5.8.1</em> of <a class="reference internal" href="#term-nist-800-56a"><em class="xref std std-term">[NIST.800-56A]</em></a>,
where the <em class="xref std std-term">Digest Method</em> is <a class="reference internal" href="glossary.html#term-sha-256"><em class="xref std std-term">SHA-256</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><em class="xref std std-ref">nist-sp800-56a.5.8.1</em></li>
</ul>
</div>
<p>The <em class="xref std std-term">Concat KDF</em> parameters are set as follows:</p>
<dl class="glossary docutils">
<dt id="term-z">Z</dt>
<dd><p class="first">This is set to the representation of the shared secret Z
as an octet sequence.</p>
<p class="last">(共有シークレットのバイト列)</p>
</dd>
<dt id="term-keydatalen">keydatalen</dt>
<dd><p class="first">This is set to the number of bits
in the desired output key.</p>
<p>(キーのビット数)</p>
<p>For &#8220;ECDH-ES&#8221;,
this is length of the key used by the &#8220;enc&#8221; algorithm.</p>
<p>For &#8220;ECDH-ES+A128KW&#8221;, &#8220;ECDH-ES+A192KW&#8221;, and
&#8220;ECDH-ES+A256KW&#8221;,
this is 128, 192, and 256, respectively.</p>
<table border="1" class="last docutils">
<colgroup>
<col width="63%" />
<col width="37%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc</td>
<td>ビット数</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A128KW</td>
<td>128</td>
</tr>
<tr class="row-odd"><td>ECDH-ES+A192KW</td>
<td>192</td>
</tr>
<tr class="row-even"><td>ECDH-ES+A256KW</td>
<td>256</td>
</tr>
</tbody>
</table>
</dd>
<dt id="term-algorithmid">AlgorithmID</dt>
<dd><p class="first">The AlgorithmID value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets,
and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.</p>
<p>In the <a class="reference internal" href="jwe.html#term-direct-key-agreement"><em class="xref std std-term">Direct Key Agreement</em></a> case,
Data is set to the octets of the UTF-8
representation of the &#8220;<strong>enc</strong>&#8221; Header Parameter value.</p>
<p class="last">In the <a class="reference internal" href="jwe.html#term-key-agreement-with-key-wrapping"><em class="xref std std-term">Key Agreement with Key Wrapping</em></a> case,
Data is set to the octets of the
UTF-8 representation of the &#8220;<strong>alg</strong>&#8221; Header Parameter value.</p>
</dd>
<dt id="term-partyuinfo">PartyUInfo</dt>
<dd><p class="first">The PartyUInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets,
and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.</p>
<p>If an &#8220;<em class="xref std std-term">apu</em>&#8221; (agreement PartyUInfo) Header Parameter is present,
Data is set to the result of base64url decoding the &#8220;apu&#8221; value
and Datalen is set to the number of octets in Data.</p>
<p class="last">Otherwise, Datalen is set to 0 and Data
is set to the empty octet sequence.</p>
</dd>
<dt id="term-partyvinfo">PartyVInfo</dt>
<dd><p class="first">The PartyVInfo value is of the form Datalen || Data,
where Data is a variable-length string of zero or more octets,
and
Datalen is a fixed-length, big endian 32 bit counter that
indicates the length (in octets) of Data.</p>
<p>If an &#8220;<em class="xref std std-term">apv</em>&#8221; (agreement PartyVInfo) Header Parameter is present,
Data is set to the result of base64url decoding the &#8220;apv&#8221; value
and Datalen is set to the number of octets in Data.</p>
<p class="last">Otherwise, Datalen is set to 0 and Data
is set to the empty octet sequence.</p>
</dd>
<dt id="term-supppubinfo">SuppPubInfo</dt>
<dd><p class="first">This is set to the <a class="reference internal" href="#term-keydatalen"><em class="xref std std-term">keydatalen</em></a>
represented as a 32 bit big endian integer.</p>
<p class="last">(キーデータ長)</p>
</dd>
<dt id="term-suppprivinfo">SuppPrivInfo</dt>
<dd>This is set to the <strong>empty octet sequence</strong>.</dd>
</dl>
<p>Applications need to specify how the &#8220;apu&#8221; and &#8220;apv&#8221; parameters are
used for that application.</p>
<p>The &#8220;apu&#8221; and &#8220;apv&#8221; values MUST be distinct, when used.</p>
<p>Applications wishing to conform to [NIST.800-56A]
need to provide values that meet the requirements of
that document, e.g.,
by using values that identify the sender and recipient.</p>
<p>Alternatively,
applications MAY conduct key derivation in
a manner similar to The Diffie-Hellman Key Agreement Method
[RFC2631]:
In that case,
the &#8220;apu&#8221; field MAY either be omitted or represent a random 512-bit value
(analogous to PartyAInfo in Ephemeral-Static mode in [RFC2631])
and the &#8220;apv&#8221; field should not be present.</p>
<p>See <a class="reference internal" href="#jwa-appendix-c"><em>Appendix C</em></a> for an example key agreement computation
using this method.</p>
<p>(draft21)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.6.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-21#section-4.6.2</a>)</p>
</div>
</div>
<div class="section" id="key-encryption-with-aes-gcm">
<span id="jwa-4-7"></span><h3><a class="toc-backref" href="#id40">4.7. Key Encryption with AES GCM</a><a class="headerlink" href="#key-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of
encrypting a JWE Content Encryption Key (CEK)
with Advanced Encryption Standard (AES)
in Galois/Counter Mode (GCM) [AES, NIST.800-38D].</p>
<p>Use of an Initialization Vector of size 96 bits is REQUIRED
with this algorithm.</p>
<p>The Initialization Vector is represented in base64url encoded
form as the &#8220;iv&#8221; (initialization vector) Header Parameter value.</p>
<p>The Additional Authenticated Data value used is the empty octet string.</p>
<p>The requested size of the Authentication Tag output MUST be 128 bits,
regardless of the key size.</p>
<p>The JWE Encrypted Key value is the Ciphertext output.</p>
<p>The Authentication Tag output is represented in base64url encoded
form as the &#8220;tag&#8221; (authentication tag) Header Parameter value.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values are used to
indicate that the JWE Encrypted Key is the result of encrypting the
CEK using the corresponding algorithm and key size:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>A128GCMKW</td>
<td>Key wrapping with AES GCM using 128 bit key</td>
</tr>
<tr class="row-odd"><td>A192GCMKW</td>
<td>Key wrapping with AES GCM using 192 bit key</td>
</tr>
<tr class="row-even"><td>A256GCMKW</td>
<td>Key wrapping with AES GCM using 256 bit key</td>
</tr>
</tbody>
</table>
<p>(draft30)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30#section-4.7">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-30#section-4.7</a>)</p>
<div class="section" id="header-parameters-used-for-aes-gcm-key-encryption">
<span id="jwa-4-7-1"></span><h4><a class="toc-backref" href="#id41">4.7.1. Header Parameters Used for AES GCM Key Encryption</a><a class="headerlink" href="#header-parameters-used-for-aes-gcm-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameters are used for AES GCM key encryption.</p>
<p>(draft20)
(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-20#section-4.7.1</a>)</p>
<div class="section" id="iv-initialization-vector-header-parameter">
<span id="jwa-4-7-1-1"></span><h5><a class="toc-backref" href="#id42">4.7.1.1. &#8220;iv&#8221; (Initialization Vector) Header Parameter</a><a class="headerlink" href="#iv-initialization-vector-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;iv&#8221; (initialization vector) Header Parameter value
is the base64url encoded representation of the Initialization Vector value
used for the key encryption operation.</p>
<p>This Header Parameter MUST be present and MUST be understood
and processed by implementations when these algorithms are used.</p>
<p>(draft23)</p>
</div>
<div class="section" id="tag-authentication-tag-header-parameter">
<span id="jwa-4-7-1-2"></span><h5><a class="toc-backref" href="#id43">4.7.1.2. &#8220;tag&#8221; (Authentication Tag) Header Parameter</a><a class="headerlink" href="#tag-authentication-tag-header-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;tag&#8221; (authentication tag) Header Parameter value
is the base64url encoded representation of the Authentication Tag value
resulting from the key encryption operation.</p>
<p>This Header Parameter MUST be present and MUST
be understood and processed by implementations
when these algorithms are used.</p>
<p>(draft23)</p>
</div>
</div>
</div>
<div class="section" id="key-encryption-with-pbes2">
<span id="jwa-4-8"></span><h3><a class="toc-backref" href="#id44">4.8. Key Encryption with PBES2</a><a class="headerlink" href="#key-encryption-with-pbes2" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>パスワードベース認証</li>
<li>ユーザーがパスワードを指定</li>
<li>PBES2スキームでパスワードから派生キーを作成</li>
<li>その派生キーでCEKを暗号化</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>パスワードは Jwk で { &#8220;kty&#8221;: &#8220;oct&#8221;, &#8220;k&#8221;: &#8220;my_pretty_password&#8221;} とかで共有するとか。</li>
</ul>
</div>
<p>This section defines the specifies of performing
password-based encryption of a JWE CEK,
by first deriving a key encryption key
from a user-supplied password using PBES2 schemes
as specified in Section 6.2 of <a class="reference internal" href="#term-rfc2898"><em class="xref std std-term">[RFC2898]</em></a>,
then by encrypting the JWE CEK using the derived key.</p>
<p>These algorithms use HMAC SHA-2 algorithms
as the Pseudo-Random Function (PRF)
for the PBKDF2 key derivation
and AES Key Wrap <a class="reference internal" href="jwe.html#term-rfc3394"><em class="xref std std-term">[RFC3394]</em></a> for the encryption scheme.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>疑似ランダム関数 HMAC SHA-2</li>
<li>AES Key Wrap (<span class="target" id="index-7"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3394.html"><strong>RFC 3394</strong></a>) で暗号化</li>
</ul>
</div>
<p>The PBES2 password input is an octet sequence;
if the password to be used is represented
as a text string rather than an octet sequence,
the UTF-8 encoding of the text string MUST be used as the octet sequence.</p>
<p>The <em class="xref std std-term">salt</em> parameter MUST be computed
from the &#8220;p2s&#8221; (PBES2 salt input) Header Parameter value,
and the &#8220;alg&#8221; (algorithm) Header Parameter value
as specified in the &#8220;p2s&#8221; definition below.</p>
<p>The <em class="xref std std-term">iteration count parameter</em> MUST be provided as
the &#8220;p2c&#8221; Header Parameter value.</p>
<p>The algorithms respectively use
HMAC SHA-256,
HMAC SHA-384, and
HMAC SHA-512 as the PRF and
use 128, 192, and 256 bit AES Key Wrap keys.</p>
<p>Their derived-key lengths respectively are 16, 24, and 32 octets.</p>
<p>The following &#8220;alg&#8221; (algorithm) Header Parameter values
are used to indicate that
the JWE Encrypted Key is the result of encrypting the CEK
using the result of the corresponding password-based encryption algorithm
as the key encryption key for the corresponding key wrapping algorithm:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Key Management Algorithm</td>
</tr>
<tr class="row-even"><td>PBES2-HS256+A128KW</td>
<td>PBES2 with HMAC SHA-256 and &#8220;A128KW&#8221;
wrapping</td>
</tr>
<tr class="row-odd"><td>PBES2-HS384+A192KW</td>
<td>PBES2 with HMAC SHA-384 and &#8220;A192KW&#8221;
wrapping</td>
</tr>
<tr class="row-even"><td>PBES2-HS512+A256KW</td>
<td>PBES2 with HMAC SHA-512 and &#8220;A256KW&#8221;
wrapping</td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="jwk.html#jwk-appendix-c"><em>Appendix C</em></a> of JSON Web Key (JWK) [JWK]
for an example key encryption computation using &#8220;<em class="xref std std-term">PBES2-HS256+A128KW</em>&#8221;.</p>
<p>(draft23)</p>
<div class="section" id="header-parameters-used-for-pbes2-key-encryption">
<span id="jwa-4-8-1"></span><h4><a class="toc-backref" href="#id45">4.8.1. Header Parameters Used for PBES2 Key Encryption</a><a class="headerlink" href="#header-parameters-used-for-pbes2-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>The following Header Parameters are used for Key Encryption with
PBES2.</p>
<p>(draft23)</p>
<div class="section" id="p2s-pbes2-salt-parameter">
<span id="jwa-p2s"></span><span id="jwa-4-8-1-1"></span><h5><a class="toc-backref" href="#id46">4.8.1.1. &#8220;p2s&#8221; (PBES2 salt) Parameter</a><a class="headerlink" href="#p2s-pbes2-salt-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2s&#8221; (PBES2 salt input) Header Parameter encodes
a Salt Input value,
which is used as part of the PBKDF2 salt value.</p>
<p>The &#8220;p2s&#8221; value is BASE64URL(Salt Input).
This Header Parameter MUST be present and
MUST be understood and processed by implementations
when these algorithms are used.</p>
<p>The salt expands the possible keys
that can be derived from a given password.</p>
<p>A Salt Input value containing 8 or more octets
MUST be used.</p>
<p>A new Salt Input value MUST be generated randomly
for every encryption operation;
see <a class="reference internal" href="jwe.html#term-89"><em class="xref std std-term">[RFC4086]</em></a> for considerations
on generating random values.</p>
<p>The salt value used is (UTF8(Alg) || 0x00 || Salt Input),
where Alg is the &#8220;alg&#8221; Header Parameter value.</p>
<p>(draft23)
( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.8.1.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-23#section-4.8.1.1</a> )</p>
</div>
<div class="section" id="p2c-pbes2-count-parameter">
<span id="jwa-p2c"></span><span id="jwa-4-8-1-2"></span><h5><a class="toc-backref" href="#id47">4.8.1.2. &#8220;p2c&#8221; (PBES2 count) Parameter</a><a class="headerlink" href="#p2c-pbes2-count-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p2c&#8221; (PBES2 count) Header Parameter contains
the PBKDF2 iteration count,
represented as a positive integer.</p>
<p>This Header Parameter MUST be present
and MUST be understood and processed
by implementations when these algorithms are used.</p>
<p>The iteration count adds computational expense,
ideally compounded by the possible range of keys
introduced by the salt.</p>
<p>A minimum iteration count of 1000 is RECOMMENDED.</p>
<p>(draft23)</p>
</div>
</div>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-content-encryption">
<span id="jwa-5"></span><h2><a class="toc-backref" href="#id48">5. Cryptographic Algorithms for Content Encryption</a><a class="headerlink" href="#cryptographic-algorithms-for-content-encryption" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms to encrypt and integrity protect
the Plaintext and to also integrity protect additional authenticated data.</p>
<p>(draft30)</p>
<div class="section" id="enc-encryption-algorithm-header-parameter-values-for-jwe">
<span id="jwa-5-1"></span><h3><a class="toc-backref" href="#id49">5.1. &#8220;enc&#8221; (Encryption Algorithm) Header Parameter Values for JWE</a><a class="headerlink" href="#enc-encryption-algorithm-header-parameter-values-for-jwe" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;enc&#8221; (encryption algorithm) Header
Parameter values that are defined by this specification for use with
JWE.</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="38%" />
<col width="19%" />
<col width="23%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc
Parameter
Value</td>
<td>Content Encryption
Algorithm</td>
<td>Additional
Header
Parameters</td>
<td>Implementatio
nRequirements</td>
</tr>
<tr class="row-even"><td>A128CBC-HS2
56</td>
<td><p class="first">AES_128_CBC_HMAC_SHA_2
56 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.3</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A192CBC-HS3
84</td>
<td><p class="first">AES_192_CBC_HMAC_SHA_3
84 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.4</div></blockquote>
</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-even"><td>A256CBC-HS5
12</td>
<td><p class="first">AES_256_CBC_HMAC_SHA_5
12 authenticated</p>
<blockquote class="last">
<div>encryption algorithm,
as defined in
Section 5.2.5</div></blockquote>
</td>
<td>(none)</td>
<td>Required</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td>AES GCM using 128 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
<tr class="row-even"><td>A192GCM</td>
<td>AES GCM using 192 bit
key</td>
<td>(none)</td>
<td>Optional</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td>AES GCM using 256 bit
key</td>
<td>(none)</td>
<td>Recommended</td>
</tr>
</tbody>
</table>
<p>The Additional Header Parameters column indicates what additional
Header Parameters are used by the algorithm, beyond &#8220;enc&#8221;, which all
use.  All also use a JWE Initialization Vector value and produce JWE
Ciphertext and JWE Authentication Tag values.</p>
<p>See Appendix A.3 for a table cross-referencing the JWE &#8220;enc&#8221;
(encryption algorithm) values defined in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>(draft30)</p>
</div>
<div class="section" id="aes-cbc-hmac-sha2-algorithms">
<span id="aes-cbc-hmac-sha2"></span><span id="jwa-5-2"></span><h3><a class="toc-backref" href="#id50">5.2. AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">AES CBS での AEAD</p>
</li>
<li><p class="first"><a class="reference external" href="https://en.wikipedia.org/wiki/AEAD_block_cipher_modes_of_operation">https://en.wikipedia.org/wiki/AEAD_block_cipher_modes_of_operation</a></p>
</li>
<li><p class="first">パディングは PKCS#7</p>
</li>
<li><p class="first">3種類</p>
<blockquote>
<div><ul class="simple">
<li>128ビットCBC + HMAC-SHA256</li>
<li>192ビットCBC + HMAC-SHA384</li>
<li>256ビットCBC + HMAC-SHA512</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>This section defines a family of authenticated encryption algorithms
built using a composition of Advanced Encryption Standard (AES)
in Cipher Block Chaining (CBC) mode
with PKCS #7 padding [AES, NIST.800-38A] operations
and HMAC [RFC2104,SHS] operations.</p>
<p>This algorithm family is called AES_CBC_HMAC_SHA2.</p>
<p>It also defines three instances of this family,
the first using 128 bit CBC keys and HMAC SHA-256,
the second using 192 bit CBC keys and HMAC SHA-384, and
the third using 256 bit CBC keys and HMAC SHA-512.</p>
<p>Test cases for these algorithms can be found
in <a class="reference internal" href="#jwa-appendix-b"><em>Appendix B</em></a>.</p>
<p>These algorithms are based upon
Authenticated Encryption with AES-CBC and HMAC-SHA
[I-D.mcgrew-aead-aes-cbc-hmac-sha2],
performing the same cryptographic computations,
but with the <em class="xref std std-term">Initialization Vector</em>
and <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">Authentication Tag</em></a> values remaining separate,
rather than being concatenated with the <a class="reference internal" href="jwe.html#term-46"><em class="xref std std-term">Ciphertext</em></a> value
in the output representation.</p>
<p>This option is discussed in <em class="xref std std-term">Appendix B</em>
of that specification.</p>
<p>This algorithm family is a generalization of the algorithm family
in [I-D.mcgrew-aead-aes-cbc-hmac-sha2],
and can be used to implement those algorithms.</p>
<p>(draft30)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#5ではなく PKCS#7 です</li>
</ul>
</div>
<div class="section" id="conventions-used-in-defining-aes-cbc-hmac-sha2">
<span id="jwa-5-2-1"></span><h4><a class="toc-backref" href="#id51">5.2.1. Conventions Used in Defining AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#conventions-used-in-defining-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>We use the following notational conventions.</p>
<blockquote>
<div><p>CBC-PKCS5-ENC(X, P) denotes the AES CBC encryption of P using PKCS
#7 padding using the cipher with the key X.</p>
<p>MAC(Y, M) denotes the application of the Message Authentication
Code (MAC) to the message M, using the key Y.</p>
</div></blockquote>
<p>(draft28)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#5ではなくPKCS#7です</li>
</ul>
</div>
</div>
<div class="section" id="generic-aes-cbc-hmac-sha2-algorithm">
<span id="jwa-5-2-2"></span><h4><a class="toc-backref" href="#id52">5.2.2. Generic AES_CBC_HMAC_SHA2 Algorithm</a><a class="headerlink" href="#generic-aes-cbc-hmac-sha2-algorithm" title="Permalink to this headline">¶</a></h4>
<p>This section defines AES_CBC_HMAC_SHA2 in a manner that is
independent of the AES CBC key size or hash function to be used.
Section 5.2.2.1 and Section 5.2.2.2 define the generic encryption and
decryption algorithms.  Section 5.2.3 and Section 5.2.5 define
instances of AES_CBC_HMAC_SHA2 that specify those details.</p>
<p>(draft28)</p>
<div class="section" id="aes-cbc-hmac-sha2-encryption">
<span id="jwa-5-2-2-1"></span><h5><a class="toc-backref" href="#id53">5.2.2.1. AES_CBC_HMAC_SHA2 Encryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-encryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated encryption algorithm takes as input four octet
strings:
a secret key K,
a plaintext P,
additional authenticated A,
and an initialization vector IV.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>キー</li>
<li>平文</li>
<li>AAD(Additional Authenticated Data)</li>
<li>IV</li>
</ol>
</div>
<p>The authenticated ciphertext value E and
the authentication tag value T are provided as outputs.  The data in
the plaintext are encrypted and authenticated, and the associated
data are authenticated, but not encrypted.</p>
<p>The encryption process is as follows, or uses an equivalent set of
steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The secondary keys MAC_KEY and ENC_KEY are generated from the
input key K as follows.  Each of these two keys is an octet
string.</p>
<blockquote>
<div><p>MAC_KEY consists of the initial MAC_KEY_LEN octets of K, in
order.</p>
<p>ENC_KEY consists of the final ENC_KEY_LEN octets of K, in
order.</p>
</div></blockquote>
<p>Here we denote the number of octets in the MAC_KEY as
MAC_KEY_LEN, and the number of octets in ENC_KEY as ENC_KEY_LEN;
the values of these parameters are specified by the AEAD
algorithms (in Section 5.2.3 and Section 5.2.5).  The number of
octets in the input key K is the sum of MAC_KEY_LEN and
ENC_KEY_LEN.  When generating the secondary keys from K, MAC_KEY
and ENC_KEY MUST NOT overlap.  Note that the MAC key comes before
the encryption key in the input key K; this is in the opposite
order of the algorithm names in the identifier
&#8220;AES_CBC_HMAC_SHA2&#8221;.</p>
</li>
<li><p class="first">The Initialization Vector (IV) used is a 128 bit value generated
randomly or pseudorandomly for use in the cipher.</p>
</li>
<li><p class="first">The plaintext is CBC encrypted using PKCS #7 padding using
ENC_KEY as the key, and the IV.  We denote the ciphertext output
from this step as E.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#5では無くPKCS#7です</li>
</ul>
</div>
</li>
<li><p class="first">The octet string AL is equal to the number of bits in A expressed
as a 64-bit unsigned integer in network byte order.</p>
</li>
<li><p class="first">A message authentication tag T is computed by applying HMAC
[RFC2104] to the following data, in order:</p>
<blockquote>
<div><p>the additional authenticated data A,</p>
<p>the initialization vector IV,</p>
<p>the ciphertext E computed in the previous step, and</p>
<p>the octet string AL defined above.</p>
</div></blockquote>
<p>The string MAC_KEY is used as the MAC key.  We denote the output
of the MAC computed in this step as M. The first T_LEN bits of M
are used as T.</p>
</li>
<li><p class="first">The Ciphertext E and the Authentication Tag T are returned as the
outputs of the authenticated encryption.</p>
</li>
</ol>
</div></blockquote>
<p>The encryption process can be illustrated as follows.  Here K, P, A,
IV, and E denote the key, plaintext, additional authenticated data, initialization
vector, and ciphertext, respectively.</p>
<blockquote>
<div><p>MAC_KEY = initial MAC_KEY_LEN bytes of K,</p>
<p>ENC_KEY = final ENC_KEY_LEN bytes of K,</p>
<p>E = CBC-PKCS5-ENC(ENC_KEY, P),</p>
<p>M = MAC(MAC_KEY, A || IV || E || AL),</p>
<p>T = initial T_LEN bytes of M.</p>
</div></blockquote>
<p>(draft28)</p>
</div>
<div class="section" id="aes-cbc-hmac-sha2-decryption">
<span id="jwa-5-2-2-2"></span><h5><a class="toc-backref" href="#id54">5.2.2.2. AES_CBC_HMAC_SHA2 Decryption</a><a class="headerlink" href="#aes-cbc-hmac-sha2-decryption" title="Permalink to this headline">¶</a></h5>
<p>The authenticated decryption operation has four inputs:
K, A, E, and T as defined above.</p>
<p>It has only a single output,
either a plaintext value P or a special symbol FAIL that indicates
that the inputs are not authentic.</p>
<p>The authenticated decryption algorithm is as follows,
or uses an equivalent set of steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The secondary keys MAC_KEY and ENC_KEY are generated
from the input key K as in Step 1 of <em class="xref std std-ref">Section 5.2.2.1</em>.</p>
</li>
<li><p class="first">The integrity and authenticity of A and E are checked by
computing an HMAC with the inputs as
in Step 5 of <a class="reference internal" href="#jwa-5-2-2-1"><em>Section 5.2.2.1</em></a>.</p>
<p>The value T, from the previous step,
is compared to the first MAC_KEY length bits of the HMAC output.</p>
<p>If those values are identical,
then A and E are considered valid,
and processing is continued.</p>
<p>Otherwise,
all of the data used in the MAC validation are discarded,
and the AEAD decryption operation returns an indication
that it failed, and the operation halts.</p>
<p>(But see <a class="reference internal" href="jwe.html#jwe-11-2"><em>Section 11.2</em></a> of [JWE] for security
considerations on thwarting timing attacks.)</p>
</li>
<li><p class="first">The value E is decrypted and the PKCS #7 padding is removed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#5 ではなくPKCS#7です</li>
</ul>
</div>
<p>The value IV is used as the initialization vector.</p>
<p>The value ENC_KEY is used as the decryption key.</p>
</li>
<li><p class="first">The plaintext value is returned.</p>
</li>
</ol>
</div></blockquote>
<p>(draft28)</p>
</div>
</div>
<div class="section" id="aes-128-cbc-hmac-sha-256">
<span id="jwa-5-2-3"></span><span id="id1"></span><h4><a class="toc-backref" href="#id55">5.2.3. AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h4>
<p>This algorithm is a concrete instantiation of
the generic <a class="reference internal" href="#aes-cbc-hmac-sha2"><em>5.2. AES_CBC_HMAC_SHA2 Algorithms</em></a> algorithm above.</p>
<p>It uses the HMAC message authentication code [RFC2104]
with the SHA-256 hash function [SHS] to
provide message authentication,
with the HMAC output truncated to 128 bits,
corresponding to the HMAC-SHA-256-128 algorithm
defined in [RFC4868].</p>
<p>For encryption,
it uses AES in the Cipher Block Chaining (CBC) mode of operation
as defined in Section 6.2 of [NIST.800-38A],
with PKCS #7 padding
and a 128 bit initialization vector (IV) value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#5ではなくPKCS#7</li>
</ul>
</div>
<p>The AES_CBC_HMAC_SHA2 parameters specific to AES_128_CBC_HMAC_SHA_256
are:</p>
<ul class="simple">
<li>The input key K is 32 octets long.</li>
<li>ENC_KEY_LEN is 16 octets.</li>
<li>MAC_KEY_LEN is 16 octets.</li>
<li>The SHA-256 hash algorithm is used for the HMAC.</li>
<li>The HMAC-SHA-256 output is truncated to T_LEN=16 octets,
by stripping off the final 16 octets.</li>
</ul>
<p>(draft28)</p>
</div>
<div class="section" id="aes-192-cbc-hmac-sha-384">
<span id="jwa-5-2-4"></span><h4><a class="toc-backref" href="#id56">5.2.4. AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h4>
<p>AES_192_CBC_HMAC_SHA_384 is based on <a class="reference internal" href="#aes-128-cbc-hmac-sha-256"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a>,
but with the following differences:</p>
<blockquote>
<div><p>The input key K is 48 octets long instead of 32.</p>
<p>ENC_KEY_LEN is 24 octets instead of 16.</p>
<p>MAC_KEY_LEN is 24 octets instead of 16.</p>
<p>SHA-384 is used for the HMAC instead of SHA-256.</p>
<p>The HMAC SHA-384 value is truncated to T_LEN=24 octets instead of
16.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="aes-256-cbc-hmac-sha-512">
<span id="jwa-5-2-5"></span><span id="id2"></span><h4><a class="toc-backref" href="#id57">5.2.5. AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h4>
<p>AES_256_CBC_HMAC_SHA_512 is based on <a class="reference internal" href="#aes-128-cbc-hmac-sha-256"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a>, but
with the following differences:</p>
<blockquote>
<div>The input key K is 64 octets long instead of 32.</div></blockquote>
<p>Jones                     Expires July 24, 2014                [Page 25]</p>
<p>Internet-Draft          JSON Web Algorithms (JWA)           January 2014</p>
<blockquote>
<div><p>ENC_KEY_LEN is 32 octets instead of 16.</p>
<p>MAC_KEY_LEN is 32 octets instead of 16.</p>
<p>SHA-512 is used for the HMAC instead of SHA-256.</p>
<p>The HMAC SHA-512 value is truncated to T_LEN=32 octets instead of
16.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="content-encryption-with-aes-cbc-hmac-sha2">
<span id="jwa-5-2-6"></span><h4><a class="toc-backref" href="#id58">5.2.6. Content Encryption with AES_CBC_HMAC_SHA2</a><a class="headerlink" href="#content-encryption-with-aes-cbc-hmac-sha2" title="Permalink to this headline">¶</a></h4>
<p>This section defines the specifics of performing
authenticated encryption
with the AES_CBC_HMAC_SHA2 algorithms.</p>
<p>The CEK is used as the secret key K.</p>
<p>The following &#8220;enc&#8221; (encryption algorithm) Header Parameter values
are used to indicate that the JWE Ciphertext and JWE Authentication
Tag values have been computed using the corresponding algorithm:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="79%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc Parameter
Value</td>
<td>Content Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>A128CBC-HS256</td>
<td><a class="reference internal" href="#aes-128-cbc-hmac-sha-256"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a> authenticated encryption
algorithm, as defined in Section 5.2.3</td>
</tr>
<tr class="row-odd"><td>A192CBC-HS384</td>
<td><em class="xref std std-ref">AES_192_CBC_HMAC_SHA_384</em> authenticated encryption
algorithm, as defined in Section 5.2.4</td>
</tr>
<tr class="row-even"><td>A256CBC-HS512</td>
<td><a class="reference internal" href="#aes-256-cbc-hmac-sha-512"><em>5.2.5. AES_256_CBC_HMAC_SHA_512</em></a> authenticated encryption
algorithm, as defined in Section 5.2.5</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="content-encryption-with-aes-gcm">
<span id="jwa-5-3"></span><h3><a class="toc-backref" href="#id59">5.3. Content Encryption with AES GCM</a><a class="headerlink" href="#content-encryption-with-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This section defines the specifics of performing
authenticated encryption with Advanced Encryption Standard (AES)
in Galois/Counter Mode (GCM) [AES] [NIST.800-38D].</p>
<p>The CEK is used as the encryption key.</p>
<p>Use of an initialization vector of size 96 bits is
REQUIRED with this algorithm.</p>
<p>The requested size of the Authentication Tag output MUST
be 128 bits, regardless of the key size.</p>
<p>The following &#8220;enc&#8221; (encryption algorithm) Header Parameter values
are used to indicate that the JWE Ciphertext and
JWE <a class="reference internal" href="jwe.html#term-authentication-tag"><em class="xref std std-term">Authentication Tag</em></a> values have been computed
using the corresponding algorithm and key size:</p>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="59%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc Parameter Value</td>
<td>Content Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>A128GCM</td>
<td>AES GCM using 128 bit key</td>
</tr>
<tr class="row-odd"><td>A192GCM</td>
<td>AES GCM using 192 bit key</td>
</tr>
<tr class="row-even"><td>A256GCM</td>
<td>AES GCM using 256 bit key</td>
</tr>
</tbody>
</table>
<p>An example using this algorithm is shown in <em class="xref std std-ref">Appendix A.1</em> of <a class="reference internal" href="#term-jwe"><em class="xref std std-term">[JWE]</em></a>.</p>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="cryptographic-algorithms-for-keys">
<span id="jwa-6"></span><h2><a class="toc-backref" href="#id60">6. Cryptographic Algorithms for Keys</a><a class="headerlink" href="#cryptographic-algorithms-for-keys" title="Permalink to this headline">¶</a></h2>
<p>A JSON Web Key (JWK) [JWK] is a JSON data structure that represents a
cryptographic key.  These keys can be either asymmetric or symmetric.
They can hold both public and private information about the key.
This section defines the parameters for keys using the algorithms
specified by this document.</p>
<p>(draft20)</p>
<div class="section" id="kty-key-type-parameter-values">
<span id="jwa-6-1"></span><h3><a class="toc-backref" href="#id61">6.1. &#8220;kty&#8221; (Key Type) Parameter Values</a><a class="headerlink" href="#kty-key-type-parameter-values" title="Permalink to this headline">¶</a></h3>
<p>The table below is the set of &#8220;kty&#8221; (key type) parameter values that
are defined by this specification for use in JWKs.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="49%" />
<col width="29%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>kty
Parameter
Value</td>
<td>Key Type</td>
<td>Implementation
Requirements</td>
</tr>
<tr class="row-even"><td>EC</td>
<td>Elliptic Curve [DSS]</td>
<td>Recommended+</td>
</tr>
<tr class="row-odd"><td>RSA</td>
<td>RSA [RFC3447]</td>
<td>Required</td>
</tr>
<tr class="row-even"><td>oct</td>
<td>Octet sequence (used to
represent symmetric keys)</td>
<td>Required</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The use of &#8220;+&#8221; in the Implementation Requirements indicates that the
requirement strength is likely to be increased in a future version of
the specification.</p>
<p>(draft20)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>See <a class="reference internal" href="jwk.html#jwk-kty"><em>4.1.  &#8220;kty&#8221; (Key Type) Parameter</em></a></li>
</ul>
</div>
</div>
<div class="section" id="parameters-for-elliptic-curve-keys">
<span id="jwa-6-2"></span><h3><a class="toc-backref" href="#id62">6.2. Parameters for Elliptic Curve Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent Elliptic Curve [DSS] keys.  In this case, the
&#8220;kty&#8221; member value MUST be &#8220;EC&#8221;.</p>
<p>(draft20)</p>
<div class="section" id="parameters-for-elliptic-curve-public-keys">
<span id="jwa-6-2-1"></span><h4><a class="toc-backref" href="#id63">6.2.1. Parameters for Elliptic Curve Public Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-public-keys" title="Permalink to this headline">¶</a></h4>
<p>An elliptic curve public key is represented by a pair of coordinates
drawn from a finite field, which together define a point on an
elliptic curve.  The following members MUST be present for elliptic
curve public keys:</p>
<blockquote>
<div><p>o  &#8220;crv&#8221;</p>
<p>o  &#8220;x&#8221;</p>
<p>o  &#8220;y&#8221;</p>
</div></blockquote>
<p>SEC1 [SEC1] point compression is not supported for any values.</p>
<p>(draft20)</p>
<div class="section" id="crv-curve-parameter">
<span id="jwa-6-2-1-1"></span><h5><a class="toc-backref" href="#id64">6.2.1.1. &#8220;crv&#8221; (Curve) Parameter</a><a class="headerlink" href="#crv-curve-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;crv&#8221; (curve) member identifies
the cryptographic curve used with the key.</p>
<p>Curve values from <a class="reference internal" href="#term-dss"><em class="xref std std-term">[DSS]</em></a> used by this specification are:</p>
<ul class="simple">
<li>&#8220;P-256&#8221;</li>
<li>&#8220;P-384&#8221;</li>
<li>&#8220;P-521&#8221;</li>
</ul>
<p>These values are registered
in the <em class="xref std std-term">IANA JSON Web Key Elliptic Curve</em> registry
defined in <a class="reference internal" href="#jwa-7-6"><em>Section 7.6</em></a>.</p>
<p>Additional &#8220;crv&#8221; values MAY be used,
provided they are understood by implementations using that
Elliptic Curve key.</p>
<p>The &#8220;crv&#8221; value is a case-sensitive string.</p>
<p>(draft20)</p>
</div>
<div class="section" id="x-x-coordinate-parameter">
<span id="jwa-6-2-1-2"></span><h5><a class="toc-backref" href="#id65">6.2.1.2. &#8220;x&#8221; (X Coordinate) Parameter</a><a class="headerlink" href="#x-x-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;x&#8221; (x coordinate) member contains the x coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the octet string representation of the coordinate, as defined in
Section 2.3.5 of SEC1 [SEC1].  The length of this octet string MUST
be the full size of a coordinate for the curve specified in the &#8220;crv&#8221;
parameter.  For example, if the value of &#8220;crv&#8221; is &#8220;P-521&#8221;, the octet
string must be 66 octets long.</p>
<p>(draft20)</p>
</div>
<div class="section" id="y-y-coordinate-parameter">
<span id="jwa-6-2-1-3"></span><h5><a class="toc-backref" href="#id66">6.2.1.3. &#8220;y&#8221; (Y Coordinate) Parameter</a><a class="headerlink" href="#y-y-coordinate-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;y&#8221; (y coordinate) member contains the y coordinate for the
elliptic curve point.  It is represented as the base64url encoding of
the octet string representation of the coordinate, as defined in
Section 2.3.5 of SEC1 [SEC1].  The length of this octet string MUST
be the full size of a coordinate for the curve specified in the &#8220;crv&#8221;
parameter.</p>
<p>For example, if the value of &#8220;crv&#8221; is &#8220;P-521&#8221;, the octet
string must be 66 octets long.</p>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="parameters-for-elliptic-curve-private-keys">
<span id="jwa-6-2-2"></span><h4><a class="toc-backref" href="#id67">6.2.2. Parameters for Elliptic Curve Private Keys</a><a class="headerlink" href="#parameters-for-elliptic-curve-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent Elliptic Curve public
keys, the following member MUST be present to represent Elliptic
Curve private keys.</p>
<p>(draft20)</p>
<div class="section" id="d-ecc-private-key-parameter">
<span id="jwa-6-2-2-1"></span><h5><a class="toc-backref" href="#id68">6.2.2.1. &#8220;d&#8221; (ECC Private Key) Parameter</a><a class="headerlink" href="#d-ecc-private-key-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (ECC private key) member contains the Elliptic Curve private
key value.  It is represented as the base64url encoding of the octet
string representation of the private key value, as defined in
Sections C.4 and 2.3.7 of SEC1 [SEC1].  The length of this octet
string MUST be ceiling(log-base-2(n)/8) octets (where n is the order
of the curve).</p>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="parameters-for-rsa-keys">
<span id="jwa-6-3"></span><h3><a class="toc-backref" href="#id69">6.3. Parameters for RSA Keys</a><a class="headerlink" href="#parameters-for-rsa-keys" title="Permalink to this headline">¶</a></h3>
<p>JWKs can represent RSA [RFC3447] keys.
In this case, the &#8220;kty&#8221; member value MUST be &#8220;RSA&#8221;.</p>
<p>(draft20)</p>
<div class="section" id="parameters-for-rsa-public-keys">
<span id="jwa-6-3-1"></span><h4><a class="toc-backref" href="#id70">6.3.1. Parameters for RSA Public Keys</a><a class="headerlink" href="#parameters-for-rsa-public-keys" title="Permalink to this headline">¶</a></h4>
<p>The following members MUST be present for RSA public keys.</p>
<p>(draft20)</p>
<div class="section" id="n-modulus-parameter">
<span id="jwa-6-3-1-1"></span><h5><a class="toc-backref" href="#id71">6.3.1.1. &#8220;n&#8221; (Modulus) Parameter</a><a class="headerlink" href="#n-modulus-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;n&#8221; (<a class="reference internal" href="#term-modulus"><em class="xref std std-term">modulus</em></a>) member contains the modulus value for the RSA
public key.  It is represented as the base64url encoding of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="e-exponent-parameter">
<span id="jwa-6-3-1-2"></span><h5><a class="toc-backref" href="#id72">6.3.1.2. &#8220;e&#8221; (Exponent) Parameter</a><a class="headerlink" href="#e-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;e&#8221; (<a class="reference internal" href="#term-exponent"><em class="xref std std-term">exponent</em></a>) member contains the exponent value for the RSA
public key.  It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</p>
<p>For instance, when representing the value 65537, the
octet sequence to be base64url encoded MUST consist of the three
octets [1, 0, 1].</p>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="parameters-for-rsa-private-keys">
<span id="jwa-6-3-2"></span><h4><a class="toc-backref" href="#id73">6.3.2. Parameters for RSA Private Keys</a><a class="headerlink" href="#parameters-for-rsa-private-keys" title="Permalink to this headline">¶</a></h4>
<p>In addition to the members used to represent RSA public keys, the
following members are used to represent RSA private keys.  The
parameter &#8220;d&#8221; is REQUIRED for RSA private keys.  The others enable
optimizations and SHOULD be included by producers of JWKs
representing RSA private keys.  If the producer includes any of the
other private key parameters, then all of the others MUST be present,
with the exception of &#8220;oth&#8221;, which MUST only be present when more
than two prime factors were used.  The consumer of a JWK MAY choose
to accept an RSA private key that does not contain a complete set of
the private key parameters other than &#8220;d&#8221;, including JWKs in which
&#8220;d&#8221; is the only RSA private key parameter included.</p>
<p>(draft20)</p>
<div class="section" id="d-private-exponent-parameter">
<span id="jwa-6-3-2-1"></span><h5><a class="toc-backref" href="#id74">6.3.2.1. &#8220;d&#8221; (Private Exponent) Parameter</a><a class="headerlink" href="#d-private-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;d&#8221; (private exponent) member contains the private exponent value
for the RSA private key.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a>
of the value&#8217;s unsigned big endian representation as an octet
sequence.
The octet sequence MUST utilize the minimum number of
octets to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="p-first-prime-factor-parameter">
<span id="jwa-6-3-2-2"></span><h5><a class="toc-backref" href="#id75">6.3.2.2. &#8220;p&#8221; (First Prime Factor) Parameter</a><a class="headerlink" href="#p-first-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;p&#8221; (first prime factor) member contains the first prime factor,
a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of
the value&#8217;s unsigned big endian representation as an octet sequence.
The octet sequence MUST utilize the minimum number of octets to
represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="q-second-prime-factor-parameter">
<span id="jwa-6-3-2-3"></span><h5><a class="toc-backref" href="#id76">6.3.2.3. &#8220;q&#8221; (Second Prime Factor) Parameter</a><a class="headerlink" href="#q-second-prime-factor-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;q&#8221; (second prime factor) member contains the second prime
factor, a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>The octet sequence MUST utilize the minimum number
of octets to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="dp-first-factor-crt-exponent-parameter">
<span id="jwa-6-3-2-4"></span><h5><a class="toc-backref" href="#id77">6.3.2.4. &#8220;dp&#8221; (First Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dp-first-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first factor CRT exponent) member contains
the <a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) exponent of the first factor,
a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s
unsigned big endian representation as an octet sequence.
The octet sequence MUST utilize the minimum number of octets
to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="dq-second-factor-crt-exponent-parameter">
<span id="jwa-6-3-2-5"></span><h5><a class="toc-backref" href="#id78">6.3.2.5. &#8220;dq&#8221; (Second Factor CRT Exponent) Parameter</a><a class="headerlink" href="#dq-second-factor-crt-exponent-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dq&#8221; (second factor CRT exponent) member contains
the <a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) exponent of the second factor,
a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s
unsigned big endian representation as an octet sequence.</p>
<p>The octet sequence MUST utilize the minimum number of octets
to represent the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="qi-first-crt-coefficient-parameter">
<span id="jwa-6-3-2-6"></span><h5><a class="toc-backref" href="#id79">6.3.2.6. &#8220;qi&#8221; (First CRT Coefficient) Parameter</a><a class="headerlink" href="#qi-first-crt-coefficient-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;dp&#8221; (first CRT coefficient) member contains the
<a class="reference internal" href="#term-chinese-remainder-theorem"><em class="xref std std-term">Chinese Remainder Theorem</em></a> (CRT) <a class="reference internal" href="#term-coefficient"><em class="xref std std-term">coefficient</em></a> of the second factor,
a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s
unsigned big endian representation as an octet sequence.  The octet
sequence MUST utilize the minimum number of octets to represent the
value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="oth-other-primes-info-parameter">
<span id="jwa-6-3-2-7"></span><h5><a class="toc-backref" href="#id80">6.3.2.7. &#8220;oth&#8221; (Other Primes Info) Parameter</a><a class="headerlink" href="#oth-other-primes-info-parameter" title="Permalink to this headline">¶</a></h5>
<p>The &#8220;oth&#8221; (other primes info) member contains an array of information
about any third and subsequent primes, should they exist.  When only
two primes have been used (the normal case), this parameter MUST be
omitted.</p>
<p>When three or more primes have been used, the number of
array elements MUST be the number of primes used minus two.  Each
array element MUST be an object with the following members:</p>
<p>(draft20)</p>
<div class="section" id="r-prime-factor">
<span id="jwa-6-3-2-7-1"></span><h6><a class="toc-backref" href="#id81">6.3.2.7.1. &#8220;r&#8221; (Prime Factor)</a><a class="headerlink" href="#r-prime-factor" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;r&#8221; (<a class="reference internal" href="#term-prime-factor"><em class="xref std std-term">prime factor</em></a>) parameter within an &#8220;oth&#8221; array member
represents the value of a subsequent prime factor, a positive
integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s
unsigned big endian representation as an octet sequence.  The octet
sequence MUST utilize the minimum number of octets to represent the
value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="d-factor-crt-exponent">
<span id="jwa-6-3-2-7-2"></span><h6><a class="toc-backref" href="#id82">6.3.2.7.2. &#8220;d&#8221; (Factor CRT Exponent)</a><a class="headerlink" href="#d-factor-crt-exponent" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;d&#8221; (Factor CRT Exponent) parameter within an &#8220;oth&#8221; array member
represents the CRT exponent of the corresponding prime factor, a
positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the
value&#8217;s unsigned big endian representation as an octet sequence.  The
octet sequence MUST utilize the minimum number of octets to represent
the value.</p>
<p>(draft20)</p>
</div>
<div class="section" id="t-factor-crt-coefficient">
<span id="jwa-6-3-2-7-3"></span><h6><a class="toc-backref" href="#id83">6.3.2.7.3. &#8220;t&#8221; (Factor CRT Coefficient)</a><a class="headerlink" href="#t-factor-crt-coefficient" title="Permalink to this headline">¶</a></h6>
<p>The &#8220;t&#8221; (factor CRT coefficient) parameter within an &#8220;oth&#8221; array
member represents the CRT coefficient of the corresponding prime
factor, a positive integer.</p>
<p>It is represented as the <a class="reference internal" href="jwt.html#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the value&#8217;s unsigned big endian representation as an
octet sequence.</p>
<p>The octet sequence MUST utilize the minimum number
of octets to represent the value.</p>
<p>(draft20)</p>
</div>
</div>
</div>
</div>
<div class="section" id="parameters-for-symmetric-keys">
<span id="jwa-6-4"></span><h3><a class="toc-backref" href="#id84">6.4. Parameters for Symmetric Keys</a><a class="headerlink" href="#parameters-for-symmetric-keys" title="Permalink to this headline">¶</a></h3>
<p>When the JWK &#8220;kty&#8221; member value is &#8220;oct&#8221; (octet sequence),
the member &#8220;k&#8221; is used to represent a symmetric key
(or another key whose value is a single octet sequence).</p>
<p>An &#8220;alg&#8221; member SHOULD also be present
to identify the algorithm intended to be used with the key,
unless the application uses another means
or convention to determine the algorithm used.</p>
<p>(draft20)</p>
<div class="section" id="k-key-value-parameter">
<span id="jwa-6-4-1"></span><h4><a class="toc-backref" href="#id85">6.4.1. &#8220;k&#8221; (Key Value) Parameter</a><a class="headerlink" href="#k-key-value-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;k&#8221; (key value) member contains the value of the symmetric (or
other single-valued) key.  It is represented as the base64url
encoding of the octet sequence containing the key value.</p>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jwa-7"></span><h2><a class="toc-backref" href="#id86">7. IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>The following registration procedure is used for all the registries
established by this specification.</p>
<p>Values are registered on a Specification Required [RFC5226] basis
after a two-week review period on the [TBD]&#64;ietf.org mailing list, on
the advice of one or more Designated Experts.  However, to allow for
the allocation of values prior to publication, the Designated
Expert(s) may approve registration once they are satisfied that such
a specification will be published.</p>
<p>Registration requests must be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject (e.g., &#8220;Request
for access token type: example&#8221;). [[ Note to the RFC Editor: The name
of the mailing list should be determined in consultation with the
IESG and IANA.  Suggested name: jose-reg-review. ]]</p>
<p>Within the review period, the Designated Expert(s) will either
approve or deny the registration request, communicating this decision
to the review list and IANA.  Denials should include an explanation
and, if applicable, suggestions as to how to make the request
successful.  Registration requests that are undetermined for a period
longer than 21 days can be brought to the IESG&#8217;s attention (using the
<a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list) for resolution.</p>
<p>Criteria that should be applied by the Designated Expert(s) includes
determining whether the proposed registration duplicates existing
functionality, determining whether it is likely to be of general
applicability or whether it is useful only for a single application,
and whether the registration makes sense.</p>
<p>IANA must only accept registry updates from the Designated Expert(s)
and should direct all requests for registration to the review mailing list.</p>
<p>It is suggested that multiple Designated Experts be appointed who are
able to represent the perspectives of different applications using
this specification, in order to enable broadly-informed review of
registration decisions.  In cases where a registration decision could
be perceived as creating a conflict of interest for a particular
Expert, that Expert should defer to the judgment of the other
Expert(s).</p>
<p>(draft30)</p>
<div class="section" id="json-web-signature-and-encryption-algorithms-registry">
<span id="jwa-7-1"></span><h3><a class="toc-backref" href="#id87">7.1. JSON Web Signature and Encryption Algorithms Registry</a><a class="headerlink" href="#json-web-signature-and-encryption-algorithms-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the IANA JSON Web Signature and
Encryption Algorithms registry for values of the JWS and JWE &#8220;alg&#8221;
(algorithm) and &#8220;enc&#8221; (encryption algorithm) Header Parameters.  The
registry records the algorithm name, the algorithm usage locations,
implementation requirements, and a reference to the specification
that defines it.  The same algorithm name can be registered multiple
times, provided that the sets of usage locations are disjoint.</p>
<p>It is suggested that when algorithms can use keys of different
lengths, that the length of the key be included in the algorithm
name.  This allows readers of the JSON text to easily make security
consideration decisions.</p>
<p>The implementation requirements of an algorithm MAY be changed over
time by the Designated Experts(s) as the cryptographic landscape
evolves, for instance, to change the status of an algorithm to
Deprecated, or to change the status of an algorithm from Optional to
Recommended+ or Required.  Changes of implementation requirements are
only permitted on a Specification Required basis, with the new
specification defining the revised implementation requirements level.</p>
<p>(draft20)</p>
<dl class="glossary docutils">
<dt id="term-iana-json-web-signature-and-encryption-algorithms">IANA JSON Web Signature and Encryption Algorithms</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#jwa-7-1-2"><em>7.1.2. Initial Registry Contents</em></a></li>
</ul>
</dd>
</dl>
<div class="section" id="registration-template">
<span id="jwa-7-1-1"></span><h4><a class="toc-backref" href="#id88">7.1.1. Registration Template</a><a class="headerlink" href="#registration-template" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Algorithm Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  This name is case-
sensitive.  Names may not match other registered names in a case-
insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Algorithm Description:</dt>
<dd>Brief description of the Algorithm (e.g., &#8220;Example description&#8221;).</dd>
<dt>Algorithm Usage Location(s):</dt>
<dd>The algorithm usage location.  This must be one or more of the
values &#8220;alg&#8221; or &#8220;enc&#8221; if the algorithm is to be used with JWS or
JWE.  The value &#8220;JWK&#8221; is used if the algorithm identifier will be
used as a JWK &#8220;alg&#8221; member value, but will not be used with JWS or
JWE; this could be the case, for instance, for non-authenticated
encryption algorithms.  Other values may be used with the approval
of a Designated Expert.</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The algorithm implementation requirements for JWS and JWE, which
must be one the words Required, Recommended, Optional, Deprecated,
or Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or
&#8220;-&#8221;.  The use of &#8220;+&#8221; indicates that the requirement strength is
likely to be increased in a future version of the specification.
The use of &#8220;-&#8221; indicates that the requirement strength is likely
to be decreased in a future version of the specification.  Any
identifiers registered for non-authenticated encryption algorithms
or other algorithms that are otherwise unsuitable for direct use
as JWS or JWE algorithms must be registered as &#8220;Prohibited&#8221;.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="initial-registry-contents">
<span id="jwa-7-1-2"></span><h4><a class="toc-backref" href="#id89">7.1.2. Initial Registry Contents</a><a class="headerlink" href="#initial-registry-contents" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">Algorithm Name: &#8220;HS256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: HMAC using SHA-256</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Required</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-3-1"><em>Section 3.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;HS384&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: HMAC using SHA-384</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-3-1"><em>Section 3.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;HS512&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: HMAC using SHA-512</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-3-1"><em>Section 3.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RS256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PKCS-v1_5 using SHA-256</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RS384&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PKCS-v1_5 using SHA-384</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RS512&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PKCS-v1_5 using SHA-512</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ES256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDSA using P-256 and SHA-256</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended+</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ES384&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDSA using P-384 and SHA-384</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ES512&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDSA using P-521 and SHA-512</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PS256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PSS using SHA-256 and MGF1 with SHA-256</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PS384&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PSS using SHA-384 and MGF1 with SHA-384</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PS512&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSASSA-PSS using SHA-512 and MGF1 with SHA-512</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;none&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: No digital signature or MAC performed</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 3.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RSA1_5&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSAES-PKCS1-V1_5</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Required</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RSA-OAEP&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSAES using OAEP with default parameters</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;RSA-OAEP-256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: RSAES OAEP using SHA-256 and MGF1 with SHA-256</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A128KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES Key Wrap using 128 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A192KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES Key Wrap using 192 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A256KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES Key Wrap using 256 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;dir&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: Direct use of a shared symmetric key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ECDH-ES&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDH-ES using Concat KDF</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended+</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ECDH-ES+A128KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDH-ES using Concat KDF and &#8220;A128KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ECDH-ES+A192KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDH-ES using Concat KDF and &#8220;A192KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;ECDH-ES+A256KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: ECDH-ES using Concat KDF and &#8220;A256KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): <a class="reference internal" href="#jwa-4-1"><em>Section 4.1</em></a> of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A128GCMKW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: Key wrapping with AES GCM using 128 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.7 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A192GCMKW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: Key wrapping with AES GCM using 192 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.7 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A256GCMKW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: Key wrapping with AES GCM using 256 bit key</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.7 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PBES2-HS256+A128KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: PBES2 with HMAC SHA-256 and &#8220;A128KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PBES2-HS384+A192KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: PBES2 with HMAC SHA-384 and &#8220;A192KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;PBES2-HS512+A256KW&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: PBES2 with HMAC SHA-512 and &#8220;A256KW&#8221; wrapping</li>
<li>Algorithm Usage Location(s): &#8220;alg&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 4.8 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A128CBC-HS256&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES_128_CBC_HMAC_SHA_256 authenticated encryption algorithm</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Required</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A192CBC-HS384&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES_192_CBC_HMAC_SHA_384 authenticated encryption algorithm</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A256CBC-HS512&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES_256_CBC_HMAC_SHA_512 authenticated encryption algorithm</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Required</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A128GCM&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES GCM using 128 bit key</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A192GCM&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES GCM using 192 bit key</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Optional</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">Algorithm Name: &#8220;A256GCM&#8221;</p>
<blockquote>
<div><ul class="simple">
<li>Algorithm Description: AES GCM using 256 bit key</li>
<li>Algorithm Usage Location(s): &#8220;enc&#8221;</li>
<li>JOSE Implementation Requirements: Recommended</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 5.1 of [[ this document ]]</li>
</ul>
</div></blockquote>
</li>
</ul>
<p>(draft21)</p>
</div>
</div>
<div class="section" id="header-parameter-names-registration">
<span id="jwa-7-2"></span><h3><a class="toc-backref" href="#id90">7.2. Header Parameter Names Registration</a><a class="headerlink" href="#header-parameter-names-registration" title="Permalink to this headline">¶</a></h3>
<p>This specification registers the Header Parameter names defined in
Section 4.6.1, Section 4.7.1, and Section 4.8.1 in the IANA JSON Web
Signature and Encryption Header Parameters registry defined in [JWS].</p>
<p>(draft30)</p>
<div class="section" id="registry-contents">
<span id="jwa-7-2-1"></span><h4><a class="toc-backref" href="#id91">7.2.1. Registry Contents</a><a class="headerlink" href="#registry-contents" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Header Parameter Name: &#8220;epk&#8221;
o  Header Parameter Description: Ephemeral Public Key
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;apu&#8221;
o  Header Parameter Description: Agreement PartyUInfo
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.2 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;apv&#8221;
o  Header Parameter Description: Agreement PartyVInfo
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.6.1.3 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;iv&#8221;
o  Header Parameter Description: Initialization Vector
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.7.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;tag&#8221;
o  Header Parameter Description: Authentication Tag
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.7.1.2 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;p2s&#8221;
o  Header Parameter Description: PBES2 salt
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.8.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;p2c&#8221;
o  Header Parameter Description: PBES2 count
o  Header Parameter Usage Location(s): JWE
o  Change Controller: IESG
o  Specification Document(s): Section 4.8.1.2 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-encryption-compression-algorithms-registry">
<span id="jwa-7-3"></span><h3><a class="toc-backref" href="#id92">7.3. JSON Web Encryption Compression Algorithms Registry</a><a class="headerlink" href="#json-web-encryption-compression-algorithms-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This specification establishes the IANA JSON Web Encryption
Compression Algorithms registry for JWE &#8220;zip&#8221; member values.  The
registry records the compression algorithm value and a reference to
the specification that defines it.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-3-1">
<span id="id3"></span><h4><a class="toc-backref" href="#id93">7.3.1. Registration Template</a><a class="headerlink" href="#jwa-7-3-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Compression Algorithm Value:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Compression Algorithm Description:</dt>
<dd>Brief description of the compression algorithm (e.g., &#8220;Example
description&#8221;).</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-3-2">
<span id="id4"></span><h4><a class="toc-backref" href="#id94">7.3.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-3-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>o  Compression Algorithm Value: &#8220;DEF&#8221;
o  Compression Algorithm Description: DEFLATE
o  Change Controller: IESG
o  Specification Document(s): JSON Web Encryption (JWE) [JWE]</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-types-registry">
<span id="jwa-7-4"></span><h3><a class="toc-backref" href="#id95">7.4. JSON Web Key Types Registry</a><a class="headerlink" href="#json-web-key-types-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This specification establishes the IANA JSON Web Key Types registry
for values of the JWK &#8220;kty&#8221; (key type) parameter.  The registry
records the &#8220;kty&#8221; value, implementation requirements, and a reference
to the specification that defines it.</p>
<p>The implementation requirements of a key type MAY be changed over
time by the Designated Experts(s) as the cryptographic landscape
evolves, for instance, to change the status of a key type to
Deprecated, or to change the status of a key type from Optional to
Recommended+ or Required.  Changes of implementation requirements are
only permitted on a Specification Required basis, with the new
specification defining the revised implementation requirements level.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-4-1">
<span id="id5"></span><h4><a class="toc-backref" href="#id96">7.4.1. Registration Template</a><a class="headerlink" href="#jwa-7-4-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>&#8220;kty&#8221; Parameter Value:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Key Type Description:</dt>
<dd>Brief description of the Key Type (e.g., &#8220;Example description&#8221;).</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The key type implementation requirements for JWS and JWE, which
must be one the words Required, Recommended, Optional, Deprecated,
or Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or
&#8220;-&#8221;.  The use of &#8220;+&#8221; indicates that the requirement strength is
likely to be increased in a future version of the specification.
The use of &#8220;-&#8221; indicates that the requirement strength is likely
to be decreased in a future version of the specification.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-4-2">
<span id="id6"></span><h4><a class="toc-backref" href="#id97">7.4.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-4-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>This specification registers the values defined in Section 6.1.</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;EC&#8221;
o  Key Type Description: Elliptic Curve
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 6.2 of [[ this document ]]</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;RSA&#8221;
o  Key Type Description: RSA
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 6.3 of [[ this document ]]</p>
<p>o  &#8220;kty&#8221; Parameter Value: &#8220;oct&#8221;
o  Key Type Description: Octet sequence
o  JOSE Implementation Requirements: Required
o  Change Controller: IESG
o  Specification Document(s): Section 6.4 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-parameters-registration">
<span id="jwa-7-5"></span><h3><a class="toc-backref" href="#id98">7.5. JSON Web Key Parameters Registration</a><a class="headerlink" href="#json-web-key-parameters-registration" title="Permalink to this headline">¶</a></h3>
<p>This specification registers the parameter names defined
in Sections 6.2, 6.3, and 6.4
in the <em class="xref std std-term">IANA JSON Web Key Parameters</em> registry
defined in [JWK].</p>
<p>(draft20)</p>
<div class="section" id="jwa-7-5-1">
<span id="id7"></span><h4><a class="toc-backref" href="#id99">7.5.1. Registry Contents</a><a class="headerlink" href="#jwa-7-5-1" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Parameter Name: &#8220;crv&#8221;<ul>
<li>Parameter Description: Curve</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.2.1.1 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;x&#8221;<ul>
<li>Parameter Description: X Coordinate</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.2.1.2 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;y&#8221;<ul>
<li>Parameter Description: Y Coordinate</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.2.1.3 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;d&#8221;<ul>
<li>Parameter Description: ECC Private Key</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;EC&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.2.2.1 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;n&#8221;<ul>
<li>Parameter Description: Modulus</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.1.1 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;e&#8221;<ul>
<li>Parameter Description: Exponent</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Public</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.1.2 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;d&#8221;<ul>
<li>Parameter Description: Private Exponent</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.1 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;p&#8221;<ul>
<li>Parameter Description: First Prime Factor</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.2 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;q&#8221;<ul>
<li>Parameter Description: Second Prime Factor</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.3 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;dp&#8221;<ul>
<li>Parameter Description: First Factor CRT Exponent</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.4 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;dq&#8221;<ul>
<li>Parameter Description: Second Factor CRT Exponent</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.5 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;qi&#8221;<ul>
<li>Parameter Description: First CRT Coefficient</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.6 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;oth&#8221;<ul>
<li>Parameter Description: Other Primes Info</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;RSA&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.3.2.7 of [[ this document ]]</li>
</ul>
</li>
<li>Parameter Name: &#8220;k&#8221;<ul>
<li>Parameter Description: Key Value</li>
<li>Used with &#8220;kty&#8221; Value(s): &#8220;oct&#8221;</li>
<li>Parameter Information Class: Private</li>
<li>Change Controller: IESG</li>
<li>Specification Document(s): Section 6.4.1 of [[ this document ]]</li>
</ul>
</li>
</ul>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="json-web-key-elliptic-curve-registry">
<span id="jwa-7-6"></span><h3><a class="toc-backref" href="#id100">7.6. JSON Web Key Elliptic Curve Registry</a><a class="headerlink" href="#json-web-key-elliptic-curve-registry" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>This specification establishes the IANA JSON Web Key Elliptic Curve
registry for JWK &#8220;crv&#8221; member values.  The registry records the curve
name, implementation requirements, and a reference to the
specification that defines it.  This specification registers the
parameter names defined in Section 6.2.1.1.</p>
<p>The implementation requirements of a curve MAY be changed over time
by the Designated Experts(s) as the cryptographic landscape evolves,
for instance, to change the status of a curve to Deprecated, or to
change the status of a curve from Optional to Recommended+ or
Required.  Changes of implementation requirements are only permitted
on a Specification Required basis, with the new specification
defining the revised implementation requirements level.</p>
</div></blockquote>
<p>(draft20)</p>
<div class="section" id="jwa-7-6-1">
<span id="id8"></span><h4><a class="toc-backref" href="#id101">7.6.1. Registration Template</a><a class="headerlink" href="#jwa-7-6-1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><dl class="docutils">
<dt>Curve Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Curve Description:</dt>
<dd>Brief description of the curve (e.g., &#8220;Example description&#8221;).</dd>
<dt>JOSE Implementation Requirements:</dt>
<dd>The curve implementation requirements for JWS and JWE, which must
be one the words Required, Recommended, Optional, Deprecated, or
Prohibited.  Optionally, the word can be followed by a &#8220;+&#8221; or &#8220;-&#8221;.
The use of &#8220;+&#8221; indicates that the requirement strength is likely
to be increased in a future version of the specification.  The use
of &#8220;-&#8221; indicates that the requirement strength is likely to be
decreased in a future version of the specification.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-7-6-2">
<span id="id9"></span><h4><a class="toc-backref" href="#id102">7.6.2. Initial Registry Contents</a><a class="headerlink" href="#jwa-7-6-2" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>o  Curve Name: &#8220;P-256&#8221;
o  Curve Description: P-256 curve
o  JOSE Implementation Requirements: Recommended+
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
<p>o  Curve Name: &#8220;P-384&#8221;
o  Curve Description: P-384 curve
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
<p>o  Curve Name: &#8220;P-521&#8221;
o  Curve Description: P-521 curve
o  JOSE Implementation Requirements: Optional
o  Change Controller: IESG
o  Specification Document(s): Section 6.2.1.1 of [[ this document ]]</p>
</div></blockquote>
<p>(draft20)</p>
</div>
</div>
</div>
<div class="section" id="security-considerations">
<span id="jwa-8"></span><h2><a class="toc-backref" href="#id103">8. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>All of the security issues that are pertinent to any cryptographic
must be faced by a JWS/JWE/JWK agent.</p>
<p>Among these issues are protecting the user&#8217;s asymmetric private
and symmetric secret keys,
preventing various attacks,
and helping avoid mistakes
such as inadvertently encrypting a message to the wrong recipient.</p>
<p>The entire list of security considerations is beyond the scope of
this document,
but some significant considerations are listed here.</p>
<p>The security considerations in [AES], [DSS], [JWE], [JWK], [JWS],
[NIST.800-38A], [NIST.800-38D], [NIST.800-56A], [RFC2104], [RFC3394],
[RFC3447], [RFC5116], [RFC6090],
and [SHS] apply to this specification.</p>
<p>(draft30)</p>
<div class="section" id="algorithms-and-key-sizes-will-be-deprecated">
<span id="jwa-8-1"></span><h3><a class="toc-backref" href="#id104">8.1. Algorithms and Key Sizes will be Deprecated</a><a class="headerlink" href="#algorithms-and-key-sizes-will-be-deprecated" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Eventually the algorithms and/or key sizes currently described in
this specification will no longer be considered sufficiently secure
and will be deprecated.  Therefore, implementers and deployments must
be prepared for this eventuality.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="key-lifetimes">
<span id="jwa-8-2"></span><h3><a class="toc-backref" href="#id105">8.2. Key Lifetimes</a><a class="headerlink" href="#key-lifetimes" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>Many algorithms have associated security considerations related to
key lifetimes and/or the number of times that a key may be used.
Those security considerations continue to apply when using those
algorithms with JOSE data structures.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="rsaes-pkcs1-v1-5-security-considerations">
<span id="jwa-8-3"></span><h3><a class="toc-backref" href="#id106">8.3. RSAES-PKCS1-v1_5 Security Considerations</a><a class="headerlink" href="#rsaes-pkcs1-v1-5-security-considerations" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>PKCS#1.5 は互換性の為にあるので、 基本的にはPSSを使う事</li>
</ul>
</div>
<p>While Section 8 of RFC 3447 [RFC3447] explicitly calls for people not
to adopt RSASSA-PKCS-v1_5 for new applications and instead requests
that people transition to RSASSA-PSS,
this specification does include RSASSA-PKCS-v1_5, for
interoperability reasons, because it commonly implemented.</p>
<p>Keys used with RSAES-PKCS1-v1_5 must follow the constraints
in Section 7.2 of RFC 3447 [RFC3447].</p>
<p>In particular, keys with a low public key exponent value must not be used.</p>
<p>(draft30)</p>
</div>
<div class="section" id="aes-gcm-security-considerations">
<span id="jwa-8-4"></span><h3><a class="toc-backref" href="#id107">8.4. AES GCM Security Considerations</a><a class="headerlink" href="#aes-gcm-security-considerations" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Keys used with AES GCM must follow the constraints in Section 8.3 of
[NIST.800-38D], which states: &#8220;The total number of invocations of the
authenticated encryption function shall not exceed 2^32, including
all IV lengths and all instances of the authenticated encryption
function with the given key&#8221;.  In accordance with this rule, AES GCM
MUST NOT be used with the same key value more than 2^32 times.</p>
<p>An Initialization Vector value MUST never be used multiple times with
the same AES GCM key.  One way to prevent this is to store a counter
with the key and increment it with every use.  The counter can also
be used to prevent exceeding the 2^32 limit above.</p>
<p>This security consideration does not apply to the composite AES-CBC
HMAC SHA-2 or AES Key Wrap algorithms.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="plaintext-jws-security-considerations">
<span id="jwa-8-5"></span><h3><a class="toc-backref" href="#id108">8.5.  Plaintext JWS Security Considerations</a><a class="headerlink" href="#plaintext-jws-security-considerations" title="Permalink to this headline">¶</a></h3>
<p>Plaintext JWSs (JWSs that use the &#8220;alg&#8221; value &#8220;none&#8221;) provide no
integrity protection.  Thus, they must only be used in contexts where
the payload is secured by means other than a digital signature or MAC
value, or need not be secured.</p>
<p>Implementations that support Plaintext JWS objects MUST NOT accept
such objects as valid unless the application specifies that it is
acceptable for a specific object to not be integrity-protected.
Implementations MUST NOT accept Plaintext JWS objects by default.
For example, the &#8220;verify&#8221; method of a hypothetical JWS software
library might have a Boolean &#8220;acceptUnsigned&#8221; parameter that
indicates &#8220;none&#8221; is an acceptable &#8220;alg&#8221; value.  As another example,
the &#8220;verify&#8221; method might take a list of algorithms that are
acceptable to the application as a parameter and would reject
Plaintext JWS values if &#8220;none&#8221; is not in that list.</p>
<p>In order to mitigate downgrade attacks, applications MUST NOT signal
acceptance of Plaintext JWS objects at a global level, and SHOULD
signal acceptance on a per-object basis.  For example, suppose an
application accepts JWS objects over two channels, (1) HTTP and (2)
HTTPS with client authentication.  It requires a JWS signature on
objects received over HTTP, but accepts Plaintext JWS objects over
HTTPS.  If the application were to globally indicate that &#8220;none&#8221; is
acceptable, then an attacker could provide it with an unsigned object
over HTTP and still have that object successfully validate.  Instead,
the application needs to indicate acceptance of &#8220;none&#8221; for each
object received over HTTPS (e.g., by setting &#8220;acceptUnsigned&#8221; to
&#8220;true&#8221; for the first hypothetical JWS software library above), but
not for each object received over HTTP.</p>
<p>(draft30)</p>
</div>
<div class="section" id="denial-of-service-attacks">
<span id="jwa-8-6"></span><h3><a class="toc-backref" href="#id109">8.6.  Denial of Service Attacks</a><a class="headerlink" href="#denial-of-service-attacks" title="Permalink to this headline">¶</a></h3>
<p>Receiving agents that validate signatures and sending agents that
encrypt messages need to be cautious of cryptographic processing
usage when validating signatures and encrypting messages using keys
larger than those mandated in this specification.  An attacker could
send certificates with keys that would result in excessive
cryptographic processing, for example, keys larger than those
mandated in this specification, which could swamp the processing
element.  Agents that use such keys without first validating the
certificate to a trust anchor are advised to have some sort of
cryptographic resource management system to prevent such attacks.</p>
<p>(draft28)</p>
</div>
<div class="section" id="reusing-key-material-when-encrypting-keys">
<span id="jwa-8-7"></span><h3><a class="toc-backref" href="#id110">8.7.  Reusing Key Material when Encrypting Keys</a><a class="headerlink" href="#reusing-key-material-when-encrypting-keys" title="Permalink to this headline">¶</a></h3>
<p>It is NOT RECOMMENDED to reuse the same key material
(Key Encryption Key, Content Encryption Key, Initialization Vector, etc.)
to encrypt multiple JWK or JWK Set objects,
or to encrypt the same JWK or JWK</p>
<p>Set object multiple times.</p>
<p>One suggestion for preventing re-use is
to always generate a new set key material
for each encryption operation,
based on the considerations noted
in this document as well as from <a href="#id10"><span class="problematic" id="id11">:rf:`4086`</span></a> <a class="reference internal" href="jwe.html#term-89"><em class="xref std std-term">[RFC4086]</em></a>.</p>
<p>(draft30)</p>
</div>
<div class="section" id="password-considerations">
<span id="jwa-8-8"></span><h3><a class="toc-backref" href="#id111">8.8.  Password Considerations</a><a class="headerlink" href="#password-considerations" title="Permalink to this headline">¶</a></h3>
<p>Passwords are vulnerable to a number of attacks.  To help mitigate
some of these limitations, this document applies principles from
<span class="target" id="index-8"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2898.html"><strong>RFC 2898</strong></a> [RFC2898] to derive cryptographic keys
from user-supplied passwords.</p>
<p>However, the strength of the password still has a significant impact.
A high-entropy password has greater resistance to dictionary attacks.
[NIST-800-63-1] contains guidelines for estimating password entropy,
which can help applications and users generate stronger passwords.</p>
<p>An ideal password is one that is as large as (or larger than) the
derived key length.  However, passwords larger than a certain
algorithm-specific size are first hashed, which reduces an attacker&#8217;s
effective search space to the length of the hash algorithm.  It is
RECOMMENDED that a password used for &#8220;PBES2-HS256+A128KW&#8221; be no
shorter than 16 octets and no longer than 128 octets and a password
used for &#8220;PBES2-HS512+A256KW&#8221; be no shorter than 32 octets and no
longer than 128 octets long.</p>
<p>Still, care needs to be taken in where and how password-based
encryption is used.  These algorithms can still be susceptible to
dictionary-based attacks if the iteration count is too small; this is
of particular concern if these algorithms are used to protect data
that an attacker can have indefinite number of attempts to circumvent
the protection, such as protected data stored on a file system.</p>
<p>(draft30)</p>
</div>
<div class="section" id="key-entropy">
<span id="jwa-8-9"></span><h3><a class="toc-backref" href="#id112">8.9.  Key Entropy</a><a class="headerlink" href="#key-entropy" title="Permalink to this headline">¶</a></h3>
<p>See Section 10.1 of [JWS] for security considerations on key entropy.</p>
<p>(draft28)</p>
</div>
<div class="section" id="differences-between-digital-signatures-and-macs">
<span id="jwa-8-10"></span><h3><a class="toc-backref" href="#id113">8.10.  Differences between Digital Signatures and MACs</a><a class="headerlink" href="#differences-between-digital-signatures-and-macs" title="Permalink to this headline">¶</a></h3>
<p>See Section 10.4 of [JWS] for security considerations on differences
between digital signatures and MACs.</p>
<p>(draft28)</p>
</div>
<div class="section" id="adaptive-chosen-ciphertext-attacks">
<span id="jwa-8-12"></span><h3><a class="toc-backref" href="#id114">8.12.  Adaptive Chosen-Ciphertext Attacks</a><a class="headerlink" href="#adaptive-chosen-ciphertext-attacks" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="jwe.html#jwe-11-2"><em>Section 11.2</em></a> of [JWE]
for security considerations on adaptive chosen-ciphertext attacks.</p>
<p>( draft27 )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Adaptive_chosen-ciphertext_attack">https://en.wikipedia.org/wiki/Adaptive_chosen-ciphertext_attack</a></li>
<li><a class="reference external" href="https://ja.wikipedia.org/wiki/Cramer-Shoup%E6%9A%97%E5%8F%B7">https://ja.wikipedia.org/wiki/Cramer-Shoup%E6%9A%97%E5%8F%B7</a></li>
</ul>
</div>
</div>
<div class="section" id="timing-attacks">
<span id="jwa-8-13"></span><h3><a class="toc-backref" href="#id115">8.13.  Timing Attacks</a><a class="headerlink" href="#timing-attacks" title="Permalink to this headline">¶</a></h3>
<p>See <em class="xref std std-ref">Section 10.3</em> of [JWE] for security considerations on timing attacks.</p>
</div>
<div class="section" id="rsa-private-key-representations-and-blinding">
<span id="jwa-8-14"></span><h3><a class="toc-backref" href="#id116">8.14.  RSA Private Key Representations and Blinding</a><a class="headerlink" href="#rsa-private-key-representations-and-blinding" title="Permalink to this headline">¶</a></h3>
<p>See <em class="xref std std-ref">Section 9.3</em> of [JWK]
for security considerations
on RSA private key representations and blinding.</p>
<p>(draft28)</p>
</div>
</div>
<div class="section" id="internationalization-considerations">
<span id="jwa-9"></span><h2><a class="toc-backref" href="#id117">9. Internationalization Considerations</a><a class="headerlink" href="#internationalization-considerations" title="Permalink to this headline">¶</a></h2>
<p>Passwords obtained from users are likely to require preparation and
normalization to account for differences of octet sequences generated
by different input devices, locales, etc.</p>
<p>It is RECOMMENDED that applications to perform the steps outlined in
[I-D.melnikov-precis-saslprepbis] to prepare a password supplied
directly by a user before performing key derivation and encryption.</p>
<p>(draft20)</p>
</div>
<div class="section" id="references">
<span id="jwa-10"></span><h2><a class="toc-backref" href="#id118">10. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="jwa-10-1"></span><h3><a class="toc-backref" href="#id119">10.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aes">[AES]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-dss">[DSS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Digital
Signature Standard (DSS)&#8221;, FIPS PUB 186-4, July 2013.</dd>
<dt id="term-i-d-ietf-json-rfc4627bis">[I-D.ietf-json-rfc4627bis]</dt>
<dd>Bray, T., &#8220;The JSON Data Interchange Format&#8221;,
draft-ietf-json-rfc4627bis-10 (work in progress),
December 2013.</dd>
<dt id="term-jwe">[JWE]</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, &#8220;JSON Web
Encryption (JWE)&#8221;, draft-ietf-jose-json-web-encryption
(work in progress), February 2014.</dd>
<dt id="term-jwk">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;,
draft-ietf-jose-json-web-key (work in progress),
February 2014.</dd>
<dt id="term-jws">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, draft-ietf-jose-json-web-signature (work
in progress), January 2014.</dd>
<dt id="term-nist-800-38a">[NIST.800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST.800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST.800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography&#8221;, NIST Special
Publication 800-56A, Revision 2, May 2013.</dd>
<dt id="term-rfc2104">[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, &#8220;HMAC: Keyed-
Hashing for Message Authentication&#8221;, RFC 2104,
February 1997.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2898">[RFC2898]</dt>
<dd>Kaliski, B., &#8220;PKCS #5: Password-Based Cryptography
Specification Version 2.0&#8221;, RFC 2898, September 2000.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc4868">[RFC4868]</dt>
<dd>Kelly, S. and S. Frankel, &#8220;Using HMAC-SHA-256, HMAC-SHA-
384, and HMAC-SHA-512 with IPsec&#8221;, RFC 4868, May 2007.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-sec1">[SEC1]</dt>
<dd>Standards for Efficient Cryptography Group, &#8220;SEC 1:
Elliptic Curve Cryptography&#8221;, May 2009.</dd>
<dt id="term-shs">[SHS]</dt>
<dd>National Institute of Standards and Technology, &#8220;Secure
Hash Standard (SHS)&#8221;, FIPS PUB 180-3, October 2008.</dd>
<dt id="term-usascii">[USASCII]</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
<p>(draft21)</p>
</div>
<div class="section" id="informative-references">
<span id="jwa-10-2"></span><h3><a class="toc-backref" href="#id120">10.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt id="term-i-d-ietf-precis-saslprepbis">[I-D.ietf-precis-saslprepbis]</dt>
<dd>Saint-Andre, P. and A. Melnikov, &#8220;Preparation and
Comparison of Internationalized Strings Representing
Usernames and Passwords&#8221;, draft-ietf-precis-saslprepbis-06
(work in progress), December 2013.</dd>
<dt id="term-i-d-mcgrew-aead-aes-cbc-hmac-sha2">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</dt>
<dd>McGrew, D., Foley, J., and K. Paterson, &#8220;Authenticated
Encryption with AES-CBC and HMAC-SHA&#8221;,
draft-mcgrew-aead-aes-cbc-hmac-sha2-04 (work in progress),
February 2014.</dd>
<dt id="term-i-d-miller-jose-jwe-protected-jwk">[I-D.miller-jose-jwe-protected-jwk]</dt>
<dd>Miller, M., &#8220;Using JavaScript Object Notation (JSON) Web
Encryption (JWE) for Protecting JSON Web Key (JWK)
Objects&#8221;, draft-miller-jose-jwe-protected-jwk-02 (work in
progress), June 2013.</dd>
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2013.</dd>
<dt id="term-jse">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-magicsignatures">[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt id="term-nist-800-63-1">[NIST-800-63-1]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Electronic Authentication Guideline&#8221;, NIST 800-63-1,
December 2011.</dd>
<dt id="term-rfc2631">[RFC2631]</dt>
<dd>Rescorla, E., &#8220;Diffie-Hellman Key Agreement Method&#8221;,
RFC 2631, June 1999.</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-w3c-cr-xmldsig-core2-20120124">[W3C.CR-xmldsig-core2-20120124]</dt>
<dd>Cantor, S., Roessler, T., Eastlake, D., Yiu, K., Reagle,
J., Solo, D., Datta, P., and F. Hirsch, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium CR CR-xmldsig-core2-20120124, January 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124">http://www.w3.org/TR/2012/CR-xmldsig-core2-20120124</a>&gt;.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20120313">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Roessler, T., and F. Hirsch,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core1-20130411">[W3C.REC-xmlenc-core1-20130411]</dt>
<dd>Eastlake, D., Reagle, J., Hirsch, F., and T. Roessler,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium Recommendation REC-xmlenc-core1-
20130411, April 2013,
&lt;<a class="reference external" href="http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/">http://www.w3.org/TR/2013/REC-xmlenc-core1-20130411/</a>&gt;.</dd>
</dl>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="appendix-a-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a"></span><h2><a class="toc-backref" href="#id121">Appendix A. Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-a-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>This appendix contains tables cross-referencing the cryptographic
algorithm identifier values defined in this specification with the
equivalent identifiers used by other standards and software packages.
See XML DSIG [RFC3275], XML DSIG 2.0 [W3C.CR-xmldsig-core2-20120124],
XML Encryption [W3C.REC-xmlenc-core-20021210], XML Encryption 1.1
[W3C.CR-xmlenc-core1-20120313], and Java Cryptography Architecture
[JCA] for more information about the names defined by those
documents.</div></blockquote>
<p>(draft20)</p>
<div class="section" id="a-1-digital-signature-mac-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-1"></span><h3><a class="toc-backref" href="#id122">A.1. Digital Signature/MAC Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-1-digital-signature-mac-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWS digital
signature and MAC &#8220;alg&#8221; (algorithm) values
defined in this specification with the equivalent identifiers
used by other standards and software packages.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="48%" />
<col width="22%" />
<col width="22%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWS</td>
<td>XML DSIG</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td>HS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha256</td>
<td>HmacSHA256</td>
<td>1.2.840.1135
49.2.9</td>
</tr>
<tr class="row-odd"><td>HS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha384</td>
<td>HmacSHA384</td>
<td>1.2.840.1135
49.2.10</td>
</tr>
<tr class="row-even"><td>HS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#hmac-sha512</td>
<td>HmacSHA512</td>
<td>1.2.840.1135
49.2.11</td>
</tr>
<tr class="row-odd"><td>RS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha256</td>
<td>SHA256withRS
A</td>
<td>1.2.840.1135
49.1.1.11</td>
</tr>
<tr class="row-even"><td>RS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha384</td>
<td>SHA384withRS
A</td>
<td>1.2.840.1135
49.1.1.12</td>
</tr>
<tr class="row-odd"><td>RS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#rsa-sha512</td>
<td>SHA512withRS
A</td>
<td>1.2.840.1135
49.1.1.13</td>
</tr>
<tr class="row-even"><td>ES2
56</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha256</td>
<td>SHA256withEC
DSA</td>
<td>1.2.840.1004
5.4.3.2</td>
</tr>
<tr class="row-odd"><td>ES3
84</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha384</td>
<td>SHA384withEC
DSA</td>
<td>1.2.840.1004
5.4.3.3</td>
</tr>
<tr class="row-even"><td>ES5
12</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xml">http://www.w3.org/2001/04/xml</a>
dsig-more#ecdsa-sha512</td>
<td>SHA512withEC
DSA</td>
<td>1.2.840.1004
5.4.3.4</td>
</tr>
<tr class="row-odd"><td>PS2
56</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha256-rsa-MGF1</td>
<td>SHA256withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
<tr class="row-even"><td>PS3
84</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha384-rsa-MGF1</td>
<td>SHA384withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
<tr class="row-odd"><td>PS5
12</td>
<td><a class="reference external" href="http://www.w3.org/2007/05/xml">http://www.w3.org/2007/05/xml</a>
dsig-more#sha512-rsa-MGF1</td>
<td>SHA512withRS
AandMGF1</td>
<td>1.2.840.1135
49.1.1.10</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="a-2-key-management-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-2"></span><h3><a class="toc-backref" href="#id123">A.2. Key Management Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-2-key-management-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWE &#8220;alg&#8221;
(algorithm) values defined in this specification with the equivalent
identifiers used by other standards and software packages.</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="38%" />
<col width="31%" />
<col width="20%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td><a href="#id139"><span class="problematic" id="id140">RSA1_</span></a>
5</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#rsa-1_5</td>
<td>RSA/ECB/PKCS1Paddi
ng</td>
<td>1.2.840.113
549.1.1.1</td>
</tr>
<tr class="row-odd"><td>RSA-O
AEP</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#rsa-oaep-mg
f1p</td>
<td>RSA/ECB/OAEPWithSH
A-1AndMGF1Padding</td>
<td>1.2.840.113
549.1.1.7</td>
</tr>
<tr class="row-even"><td>RSA-O
AEP-2
56</td>
<td><p class="first"><a class="reference external" href="http://www.w3.org/2009">http://www.w3.org/2009</a>
/xmlenc11#rsa-oaep &amp;</p>
<blockquote>
<div><a class="reference external" href="http://www.w3.org/200">http://www.w3.org/200</a></div></blockquote>
<p class="last">9/xmlenc11#mgf1sha256</p>
</td>
<td><p class="first">RSA/ECB/OAEPWithSH
A-256AndMGF1Paddin
g&amp;</p>
<blockquote>
<div>MGF1ParameterSpec</div></blockquote>
<p class="last">.SHA256</p>
</td>
<td>1.2.840.113
549.1.1.7</td>
</tr>
<tr class="row-odd"><td>ECDH-
ES</td>
<td><a class="reference external" href="http://www.w3.org/2009">http://www.w3.org/2009</a>
/xmlenc11#ECDH-ES</td>
<td>ECDH</td>
<td>1.3.132.1.1
2</td>
</tr>
<tr class="row-even"><td>A128K
W</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes128</td>
<td>AESWrap</td>
<td>2.16.840.1.
101.3.4.1.5</td>
</tr>
<tr class="row-odd"><td>A192K
W</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes192</td>
<td>AESWrap</td>
<td>2.16.840.1.
101.3.4.1.2
5</td>
</tr>
<tr class="row-even"><td>A256K
W</td>
<td><a class="reference external" href="http://www.w3.org/2001">http://www.w3.org/2001</a>
/04/xmlenc#kw-aes256</td>
<td>AESWrap</td>
<td>2.16.840.1.
101.3.4.1.4
5</td>
</tr>
</tbody>
</table>
<p>(draft27)</p>
</div>
<div class="section" id="a-3-content-encryption-algorithm-identifier-cross-reference">
<span id="jwa-appendix-a-3"></span><h3><a class="toc-backref" href="#id124">A.3. Content Encryption Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#a-3-content-encryption-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h3>
<p>This section contains a table cross-referencing the JWE &#8220;enc&#8221;
(encryption algorithm) values defined in this specification with the
equivalent identifiers used by other standards and software packages.</p>
<p>For the composite algorithms
&#8220;<em class="xref std std-ref">A128CBC-HS256</em>&#8221;,
&#8220;<em class="xref std std-ref">A192CBC-HS384</em>&#8221;, and
&#8220;<em class="xref std std-ref">A256CBC-HS512</em>&#8221;,
the corresponding AES CBC algorithm identifiers are listed.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="39%" />
<col width="22%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>JWE</td>
<td>XML ENC</td>
<td>JCA</td>
<td>OID</td>
</tr>
<tr class="row-even"><td>A128CBC
-HS256</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes128-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.2</td>
</tr>
<tr class="row-odd"><td>A192CBC
-HS384</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes192-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.22</td>
</tr>
<tr class="row-even"><td>A256CBC
-HS512</td>
<td><a class="reference external" href="http://www.w3.org/2001/">http://www.w3.org/2001/</a>
04/xmlenc#aes256-cbc</td>
<td>AES/CBC/PKCS
5Padding</td>
<td>2.16.840.1.101
.3.4.1.42</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes128-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.6</td>
</tr>
<tr class="row-even"><td>A192GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes192-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.26</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td><a class="reference external" href="http://www.w3.org/2009/">http://www.w3.org/2009/</a>
xmlenc11#aes256-gcm</td>
<td>AES/GCM/NoPa
dding</td>
<td>2.16.840.1.101
.3.4.1.46</td>
</tr>
</tbody>
</table>
<p>(draft23)</p>
</div>
</div>
<div class="section" id="appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms">
<span id="jwa-appendix-b"></span><h2><a class="toc-backref" href="#id125">Appendix B. Test Cases for AES_CBC_HMAC_SHA2 Algorithms</a><a class="headerlink" href="#appendix-b-test-cases-for-aes-cbc-hmac-sha2-algorithms" title="Permalink to this headline">¶</a></h2>
<p>The following test cases can be used to validate implementations of
the <a class="reference internal" href="#aes-cbc-hmac-sha2"><em>5.2. AES_CBC_HMAC_SHA2 Algorithms</em></a> algorithms
defined in <a class="reference internal" href="#jwa-5-2"><em>Section 5.2</em></a>.</p>
<p>They are also intended to correspond to test cases that may appear
in a future version of <a class="reference internal" href="#term-i-d-mcgrew-aead-aes-cbc-hmac-sha2"><em class="xref std std-term">[I-D.mcgrew-aead-aes-cbc-hmac-sha2]</em></a>,
demonstrating that
the cryptographic computations performed are the same.</p>
<p>The variable names are those defined in <a class="reference internal" href="#jwa-5-2"><em>Section 5.2</em></a>.</p>
<p>All values are hexadecimal.</p>
<p>(draft23)</p>
<div class="section" id="b-1-test-cases-for-aes-128-cbc-hmac-sha-256">
<span id="jwa-appendix-b-1"></span><h3><a class="toc-backref" href="#id126">B.1. Test Cases for AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#b-1-test-cases-for-aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#aes-128-cbc-hmac-sha-256"><em>5.2.3. AES_128_CBC_HMAC_SHA_256</em></a></p>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f

ENC_KEY = 10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       c8 0e df a3 2d df 39 d5 ef 00 c0 b4 68 83 42 79
          a2 e4 6a 1b 80 49 f7 92 f7 6b fe 54 b9 03 a9 c9
          a9 4a c9 b4 7a d2 65 5c 5f 10 f9 ae f7 14 27 e2
          fc 6f 9b 3f 39 9a 22 14 89 f1 63 62 c7 03 23 36
          09 d4 5a c6 98 64 e3 32 1c f8 29 35 ac 40 96 c8
          6e 13 33 14 c5 40 19 e8 ca 79 80 df a4 b9 cf 1b
          38 4c 48 6f 3a 54 c5 10 78 15 8e e5 d7 9d e5 9f
          bd 34 d8 48 b3 d6 95 50 a6 76 46 34 44 27 ad e5
          4b 88 51 ff b5 98 f7 f8 00 74 b9 47 3c 82 e2 db

M =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4
          e6 e5 45 82 47 65 15 f0 ad 9f 75 a2 b7 1c 73 ef

T =       65 2c 3f a3 6b 0a 7c 5b 32 19 fa b3 a3 0b c1 c4</pre>
</div>
<p>(draft20)</p>
</div>
<div class="section" id="b-2-test-cases-for-aes-192-cbc-hmac-sha-384">
<span id="jwa-appendix-b-2"></span><h3><a class="toc-backref" href="#id127">B.2. Test Cases for AES_192_CBC_HMAC_SHA_384</a><a class="headerlink" href="#b-2-test-cases-for-aes-192-cbc-hmac-sha-384" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17

ENC_KEY = 18 19 1a 1b 1c 1d 1e 1f 20 21 22 23 24 25 26 27
          28 29 2a 2b 2c 2d 2e 2f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       ea 65 da 6b 59 e6 1e db 41 9b e6 2d 19 71 2a e5
          d3 03 ee b5 00 52 d0 df d6 69 7f 77 22 4c 8e db
          00 0d 27 9b dc 14 c1 07 26 54 bd 30 94 42 30 c6
          57 be d4 ca 0c 9f 4a 84 66 f2 2b 22 6d 17 46 21
          4b f8 cf c2 40 0a dd 9f 51 26 e4 79 66 3f c9 0b
          3b ed 78 7a 2f 0f fc bf 39 04 be 2a 64 1d 5c 21
          05 bf e5 91 ba e2 3b 1d 74 49 e5 32 ee f6 0a 9a
          c8 bb 6c 6b 01 d3 5d 49 78 7b cd 57 ef 48 49 27
          f2 80 ad c9 1a c0 c4 e7 9c 7b 11 ef c6 00 54 e3

M =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7 45 94 f8 86 b3 fa af d4
          86 f2 5c 71 31 e3 28 1e 36 c7 a2 d1 30 af de 57

T =       84 90 ac 0e 58 94 9b fe 51 87 5d 73 3f 93 ac 20
          75 16 80 39 cc c7 33 d7</pre>
</div>
<p>(draft20)</p>
</div>
<div class="section" id="b-3-test-cases-for-aes-256-cbc-hmac-sha-512">
<span id="jwa-appendix-b-3"></span><h3><a class="toc-backref" href="#id128">B.3. Test Cases for AES_256_CBC_HMAC_SHA_512</a><a class="headerlink" href="#b-3-test-cases-for-aes-256-cbc-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>K =       00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f
          20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

MAC_KEY = 00 01 02 03 04 05 06 07 08 09 0a 0b 0c 0d 0e 0f
          10 11 12 13 14 15 16 17 18 19 1a 1b 1c 1d 1e 1f

ENC_KEY = 20 21 22 23 24 25 26 27 28 29 2a 2b 2c 2d 2e 2f
          30 31 32 33 34 35 36 37 38 39 3a 3b 3c 3d 3e 3f

P =       41 20 63 69 70 68 65 72 20 73 79 73 74 65 6d 20
          6d 75 73 74 20 6e 6f 74 20 62 65 20 72 65 71 75
          69 72 65 64 20 74 6f 20 62 65 20 73 65 63 72 65
          74 2c 20 61 6e 64 20 69 74 20 6d 75 73 74 20 62
          65 20 61 62 6c 65 20 74 6f 20 66 61 6c 6c 20 69
          6e 74 6f 20 74 68 65 20 68 61 6e 64 73 20 6f 66
          20 74 68 65 20 65 6e 65 6d 79 20 77 69 74 68 6f
          75 74 20 69 6e 63 6f 6e 76 65 6e 69 65 6e 63 65

IV =      1a f3 8c 2d c2 b9 6f fd d8 66 94 09 23 41 bc 04

A =       54 68 65 20 73 65 63 6f 6e 64 20 70 72 69 6e 63
          69 70 6c 65 20 6f 66 20 41 75 67 75 73 74 65 20
          4b 65 72 63 6b 68 6f 66 66 73

AL =      00 00 00 00 00 00 01 50

E =       4a ff aa ad b7 8c 31 c5 da 4b 1b 59 0d 10 ff bd
          3d d8 d5 d3 02 42 35 26 91 2d a0 37 ec bc c7 bd
          82 2c 30 1d d6 7c 37 3b cc b5 84 ad 3e 92 79 c2
          e6 d1 2a 13 74 b7 7f 07 75 53 df 82 94 10 44 6b
          36 eb d9 70 66 29 6a e6 42 7e a7 5c 2e 08 46 a1
          1a 09 cc f5 37 0d c8 0b fe cb ad 28 c7 3f 09 b3
          a3 b7 5e 66 2a 25 94 41 0a e4 96 b2 e2 e6 60 9e
          31 e6 e0 2c c8 37 f0 53 d2 1f 37 ff 4f 51 95 0b
          be 26 38 d0 9d d7 a4 93 09 30 80 6d 07 03 b1 f6

M =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5
          fd 30 a5 65 c6 16 ff b2 f3 64 ba ec e6 8f c4 07
          53 bc fc 02 5d de 36 93 75 4a a1 f5 c3 37 3b 9c

T =       4d d3 b4 c0 88 a7 f4 5c 21 68 39 64 5b 20 12 bf
          2e 62 69 a8 c5 6a 81 6d bc 1b 26 77 61 95 5b c5</pre>
</div>
<p>(draft20)</p>
</div>
</div>
<div class="section" id="appendix-c-example-ecdh-es-key-agreement-computation">
<span id="jwa-appendix-c"></span><h2><a class="toc-backref" href="#id129">Appendix C. Example ECDH-ES Key Agreement Computation</a><a class="headerlink" href="#appendix-c-example-ecdh-es-key-agreement-computation" title="Permalink to this headline">¶</a></h2>
<p>This example uses ECDH-ES Key Agreement
and the <em class="xref std std-term">Concat KDF</em> to derive the <a class="reference internal" href="glossary.html#term-content-encryption-key"><em class="xref std std-term">Content Encryption Key</em></a> (CEK)
in the manner described in <a class="reference internal" href="#jwa-4-6"><em>Section 4.6</em></a>.</p>
<p>In this example,
the ECDH-ES Direct Key Agreement mode (&#8220;alg&#8221; value &#8220;ECDH-ES&#8221;)
is used to produce an agreed upon key for AES
GCM with a 128 bit key (&#8220;enc&#8221; value &#8220;A128GCM&#8221;).</p>
<p>In this example, a sender Alice is encrypting content to a recipient
Bob. The sender (Alice) generates an ephemeral key for the key
agreement computation.</p>
<p>Alice&#8217;s <a class="reference internal" href="#term-ephemeral-key"><em class="xref std std-term">ephemeral key</em></a> (in JWK format) used
for the key agreement computation in this example (including the
private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;0_NxaRPUMQoAJt50Gz8YiTr8gRTwyEaCumd-MToTmIo&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The recipient&#8217;s (Bob&#8217;s) key (in JWK format) used for the key
agreement computation in this example (including the private part) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;weNJy2HscCSM6AEDTDg04biOvhFhyyWvOHQfeF_PxMQ&quot;</span><span class="p">,</span>
 <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;e8lnCO-AlStT-NJVX-crhB7QRYhiix03illJOVAOyck&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;VEmDZpDXXK8p8N0Cndsxs924q6nS1RXFASRl6BfUqdw&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Header Parameter values used in this example are as follows.
In this example,
the &#8220;apu&#8221; (agreement PartyUInfo) parameter value is the
base64url encoding of the UTF-8 string &#8220;Alice&#8221; and
the &#8220;apv&#8221; (agreement PartyVInfo) parameter value is
the base64url encoding of the UTF-8 string &#8220;Bob&#8221;.</p>
<div class="highlight-python"><pre>$ python -c "import base64;print base64.urlsafe_b64encode('Bob').replace('=','');"
Qm9i

$ python -c "import base64;print base64.urlsafe_b64encode('Alice').replace('=','');"
QWxpY2U</pre>
</div>
<p>The &#8220;epk&#8221; parameter is used to communicate
the sender&#8217;s (Alice&#8217;s) ephemeral public key value
to the recipient (Bob).</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ECDH-ES&quot;</span><span class="p">,</span>
 <span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A128GCM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apu&quot;</span><span class="o">:</span><span class="s2">&quot;QWxpY2U&quot;</span><span class="p">,</span>
 <span class="s2">&quot;apv&quot;</span><span class="o">:</span><span class="s2">&quot;Qm9i&quot;</span><span class="p">,</span>
 <span class="s2">&quot;epk&quot;</span><span class="o">:</span>
  <span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;EC&quot;</span><span class="p">,</span>
   <span class="s2">&quot;crv&quot;</span><span class="o">:</span><span class="s2">&quot;P-256&quot;</span><span class="p">,</span>
   <span class="s2">&quot;x&quot;</span><span class="o">:</span><span class="s2">&quot;gI0GAILBdu7T53akrFmMyGcsF3n5dO7MmwNBHKW5SV0&quot;</span><span class="p">,</span>
   <span class="s2">&quot;y&quot;</span><span class="o">:</span><span class="s2">&quot;SLW_xSffzlPWrHEVI30DHM_4egVwt3NQqeUD7nMFpps&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The resulting Concat KDF [NIST.800-56A] parameter values are:</p>
<blockquote>
<div><dl class="docutils">
<dt>Z</dt>
<dd><p class="first">This is set to the ECDH-ES key agreement output.  (This value is
often not directly exposed by libraries, due to NIST security
requirements, and only serves as an input to a KDF.)  In this
example, Z is the octet sequence(using JSON array notation):</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">158</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span>
<span class="mi">38</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span>
<span class="mi">140</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">196</span><span class="p">].</span>
</pre></div>
</div>
</dd>
<dt>keydatalen</dt>
<dd>This value is 128 - the number of bits in the desired
output key (because &#8220;A128GCM&#8221; uses a 128 bit key).</dd>
<dt>AlgorithmID</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 7 - [0, 0, 0, 7] - the number of octets in the
AlgorithmID content &#8220;A128GCM&#8221;, followed, by the octets
representing the UTF-8 string &#8220;A128GCM&#8221; - [65, 49, 50, 56, 71, 67,
77].</dd>
<dt>PartyUInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 5 - [0, 0, 0, 5] - the number of octets in the
PartyUInfo content &#8220;Alice&#8221;, followed, by the octets representing
the UTF-8 string &#8220;Alice&#8221; - [65, 108, 105, 99, 101].</dd>
<dt>PartyVInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 3 - [0, 0, 0, 3] - the number of octets in the
PartyUInfo content &#8220;Bob&#8221;, followed, by the octets representing the
UTF-8 string &#8220;Bob&#8221; - [66, 111, 98].</dd>
<dt>SuppPubInfo</dt>
<dd>This is set to the octets representing the 32 bit big
endian value 128 - [0, 0, 0, 128] - the keydatalen value.</dd>
<dt>SuppPrivInfo</dt>
<dd>This is set to the empty octet sequence.</dd>
</dl>
</div></blockquote>
<p>Concatenating the parameters AlgorithmID through SuppPubInfo results
in an OtherInfo value of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">99</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
</pre></div>
</div>
<p>Concatenating the round number 1 ([0, 0, 0, 1]), Z, and the OtherInfo
value results in the Concat KDF round 1 hash input of:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="mi">158</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span>
<span class="mi">156</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span>
<span class="mi">254</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span>
<span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span>
<span class="mi">101</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">]</span>
</pre></div>
</div>
<p>The resulting derived key, which is the first 128 bits of the round 1
hash output is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">86</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span>
<span class="mi">26</span><span class="p">]</span>
</pre></div>
</div>
<p>The base64url encoded representation of this derived key is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">VqqN6vgjbSBcIijNcacQGg</span>
</pre></div>
</div>
<p>(draft20)</p>
</div>
<div class="section" id="jwa-terms">
<span id="id12"></span><h2><a class="toc-backref" href="#id130">用語</a><a class="headerlink" href="#jwa-terms" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-elliptic-curve-diffie-hellman"><span id="term-elliptic-curve-diffie-hellman-ephemeral-static"></span>Elliptic Curve Diffie-Hellman<br />Elliptic Curve Diffie-Hellman Ephemeral Static</dt>
<dd><a class="reference internal" href="#jwa-ecdh"><em>ECDHキー承諾プロトコル</em></a></dd>
<dt id="term-key-derivation">Key Derivation</dt>
<dd><p class="first"><a class="reference internal" href="#jwa-key-derivation"><em>Key Derivation</em></a></p>
<dl class="last docutils">
<dt><a class="reference internal" href="#term-nist-sp800-56a"><em class="xref std std-term">NIST SP800-56A</em></a>:</dt>
<dd><ul class="first last simple">
<li>The process by which keying material is derived from a shared secret and other information.</li>
</ul>
</dd>
</dl>
</dd>
<dt id="term-key-wrap">Key Wrap</dt>
<dd><a class="reference internal" href="#jwa-key-wrap"><em>Key Wrap</em></a></dd>
<dt id="term-kem"><span id="term-key-encapsulation-mechanisms"></span>KEM<br />Key Encapsulation Mechanisms</dt>
<dd><ul class="first last simple">
<li>鍵カプセル化メカニズム。</li>
<li>例:  公開鍵キーカプセル化 : <a class="reference external" href="http://info.isl.ntt.co.jp/crypt/psec/intro.html">PSEC-KEM</a></li>
<li>参考 <a class="reference internal" href="#term-key-wrap"><em class="xref std std-term">Key Wrap</em></a></li>
</ul>
</dd>
<dt id="term-nist-sp800-56a">NIST SP800-56A</dt>
<dd><ul class="first last simple">
<li><tt class="xref doc docutils literal"><span class="pre">nist-sp-800-56a</span></tt></li>
<li><a class="reference external" href="http://csrc.nist.gov/publications/nistpubs/800-56A/SP800-56A_Revision1_Mar08-2007.pdf">Revision 1</a></li>
<li><a class="reference external" href="http://csrc.nist.gov/publications/drafts/800-56a/draft-sp-800-56a.pdf">Revision 2</a></li>
</ul>
</dd>
</dl>
<div class="section" id="ecdh">
<span id="jwa-ecdh"></span><h3><a class="toc-backref" href="#id131">ECDHキー承諾プロトコル</a><a class="headerlink" href="#ecdh" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://msdn.microsoft.com/ja-jp/library/cc488016(v=vs.90).aspx">ECDH アルゴリズムの概要 (CNG の例), Microsoft</a></li>
</ul>
</div>
<ul class="simple">
<li>共有秘密協定を作成できます</li>
<li>以前に交換した個人情報を使用することなく、
セキュリティで保護されていないパブリックな媒体を介してこの操作を実行できます</li>
<li>共有秘密協定はキー マテリアルの派生に使用されます</li>
</ul>
<div class="section" id="edh">
<h4><a class="toc-backref" href="#id132">EDH算出</a><a class="headerlink" href="#edh" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">ECDH プロトコルは、p と g の 2 つのパブリックなパラメータに依存します。</p>
<blockquote>
<div><ul class="simple">
<li>パラメータ p は大きな素数</li>
<li>パラメータ g は p より小さい整数</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">これらの 2 つのパラメータは、セキュリティで保護されていない通信回線上で交換されます。</p>
</li>
<li><p class="first">Alice と Bob は 2 つのパブリックなパラメータを受け取った後、プライベートな整数を選択します。</p>
<blockquote>
<div><ul class="simple">
<li>Alice は a を選択し、Bob は b を選択します。</li>
<li>これらの値は、秘密キーと呼ばれます。</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="id13">
<h4><a class="toc-backref" href="#id133">ECDH の例</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>小さな整数を使用して、ECDH アルゴリズムを例示します。</p>
<ol class="arabic">
<li><p class="first">Alice と Bob は、素数 p と基本の整数 g について同意しています。</p>
<blockquote>
<div><div class="highlight-python"><div class="highlight"><pre><span class="n">p</span> <span class="o">=</span> <span class="mi">83</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="mi">8</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Alice は秘密の整数 a = 9 を選び、Bob に (g^a) mod p を送信します。</p>
<blockquote>
<div><div class="highlight-python"><pre>(8^9) mod 83 = 5</pre>
</div>
</div></blockquote>
</li>
<li><p class="first">Bob は秘密の整数 b = 21 を選び、Alice に (g^b) mod p を送信します。</p>
<blockquote>
<div><div class="highlight-python"><pre>(8^21) mod 83 = 18</pre>
</div>
</div></blockquote>
</li>
<li><p class="first">Alice は ( ( (g^b) mod p)^a) mod p を計算します。</p>
<blockquote>
<div><div class="highlight-python"><pre>(18^9) mod 83 = 24</pre>
</div>
</div></blockquote>
</li>
<li><p class="first">Bob は ( ( (g^a) mod p)^b) mod p を計算します。</p>
<blockquote>
<div><div class="highlight-python"><pre>(5^21) mod 83 = 24</pre>
</div>
</div></blockquote>
</li>
</ol>
<ul class="simple">
<li>g^(ab) = g^(ba) であるため、Alice と Bob は同じ値 (24) を算出します。</li>
<li>この値が共有秘密協定になります。</li>
<li>Alice と Bob はこの値を使用して、
メッセージを暗号化するときに AES アルゴリズムで使用されるキーマテリアルを派生させます。</li>
</ul>
</div>
</div>
<div class="section" id="key-derivation">
<span id="jwa-key-derivation"></span><h3><a class="toc-backref" href="#id134">Key Derivation</a><a class="headerlink" href="#key-derivation" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">KDF(キー派生関数)に、入力キーと入力データを与えるとキーマテリアルを派生させることができます。</p>
</li>
<li><p class="first">この派生されたキーマテリアルを暗号化アルゴリズムで使う事ができます。</p>
</li>
<li><p class="first">ここで、入力キーを「キー派生キー」(Key Derivation Key)といいます。</p>
</li>
<li><p class="first">２つの方法で生成します</p>
<blockquote>
<div><ol class="arabic simple">
<li>承認された暗号化ランダムビットジェネレータ</li>
<li>承認されたキー確立プロセス(Key Establishment Process)</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">派生されたキーマテリアルを分割したそれぞれが暗号キーとして使う事ができます。</p>
</li>
<li><p class="first">ある派生キーマテリアルから同じキーを取得した物同志かどうかを判定するには、
KDFを採用している暗号化スキームがそれを異なるキーに変換する方法を決めて
おく必要がある。</p>
</li>
<li><p class="first">例えば、128ビットキーマテリアルが派生されたら、
最初の64ビットをMACのキーとして使い、
後の64ビットを指定された暗号化アルゴリズムの暗号キーとしてつかうとか。</p>
</li>
<li><p class="first">キーマテリアルは複数のキーに分割する事ができる。</p>
</li>
<li><p class="first">派生されるキーマテリアルの長さに応じて、KDFは擬似乱数関数(PRF)を複数呼び出す必要がある。</p>
</li>
<li><p class="first">あるキー派生キーから派生されたキーマテリアルは、
別のキー派生キーとしても使う事ができる。</p>
</li>
<li><p class="first">よって、キー階層を作る事ができる。</p>
</li>
<li></li>
</ul>
</div>
<div class="section" id="key-wrap">
<span id="jwa-key-wrap"></span><h3><a class="toc-backref" href="#id135">Key Wrap</a><a class="headerlink" href="#key-wrap" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="https://en.wikipedia.org/wiki/Key_Wrap">https://en.wikipedia.org/wiki/Key_Wrap</a></li>
</ul>
</div>
<ul>
<li><p class="first">キーラップ生成(Key Wrap Construction)とは、共通鍵暗号(Symetric Encryption)アルゴリズムです。</p>
</li>
<li><p class="first">暗号キーマテリアルをカプセル化(暗号化)するために使われます。</p>
</li>
<li><p class="first">用途</p>
<blockquote>
<div><ol class="loweralpha simple">
<li>まだ信頼関係を結んでいない間にキーを保護する</li>
<li>信頼できないネットワーク中でキーを転送する</li>
</ol>
</div></blockquote>
</li>
<li><p class="first">キーラップをキーのカプセル化アルゴリズムと考えてもいいですが、
非対称(公開鍵) <a class="reference internal" href="#term-kem"><em class="xref std std-term">キーアプセル化アルゴリズム</em></a> と混同すべきではない。</p>
</li>
<li><p class="first">ラップされたキーは短期間の使用に限定する。</p>
</li>
<li><p class="first">ラップに使うキーは長期で使える物を使用する。</p>
</li>
</ul>
</div>
</div>
<div class="section" id="id14">
<span id="id15"></span><h2><a class="toc-backref" href="#id136">用語</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-modulus">Modulus</dt>
<dd>係数</dd>
<dt id="term-exponent">Exponent</dt>
<dd>指数</dd>
<dt id="term-chinese-remainder-theorem"><span id="term-crt"></span>Chinese Remainder Theorem<br />CRT</dt>
<dd><a class="reference external" href="https://ja.wikipedia.org/wiki/%E4%B8%AD%E5%9B%BD%E3%81%AE%E5%89%B0%E4%BD%99%E5%AE%9A%E7%90%86">中国人剰余定理</a> 。
孫子の定理（そんしのていり）とも呼ばれる。 (Wikipedia)
CRT を使うと復号演算が高速できる。</dd>
<dt id="term-coefficient">coefficient</dt>
<dd>係数</dd>
<dt id="term-term">term</dt>
<dd>項</dd>
<dt id="term-prime-factor">Prime Factor</dt>
<dd>素因数</dd>
<dt id="term-message-authentication-code"><span id="term-mac"></span>Message Authentication Code<br />MAC</dt>
<dd>メッセージ認証符号/メッセージ認証コード。</dd>
<dt id="term-ephemeral-key">ephemeral key</dt>
<dd>短期鍵</dd>
</dl>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>