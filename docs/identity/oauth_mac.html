
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>HTTP Authentication: MAC Access Authentication &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth Dynamic Client Registration Protocol" href="oauth_reg.html" />
    <link rel="prev" title="Assertion Framework for OAuth 2.0" href="oauth_assertion.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft21</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft19</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft25</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft24</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">HTTP Authentication: MAC Access Authentication</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li><a class="reference internal" href="#example">1.1. Example</a></li>
<li><a class="reference internal" href="#notational-conventions">1.2. Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-with-oauth-2-0">5. Use with OAuth 2.0</a><ul>
<li><a class="reference internal" href="#issuing-mac-type-access-tokens">5.1. Issuing MAC-Type Access Tokens</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="oauth_assertion.html"
         title="Previous Chapter: Assertion Framework for OAuth 2.0">&laquo; Assertion Framew...</a></li>
  <li><a href="oauth_reg.html"
         title="Next Chapter: OAuth Dynamic Client Registration Protocol">OAuth Dynamic Cl... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/oauth_mac.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="http-authentication-mac-access-authentication">
<h1><a class="toc-backref" href="#id1">HTTP Authentication: MAC Access Authentication</a><a class="headerlink" href="#http-authentication-mac-access-authentication" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01</a>
( February 8, 2012 )</p>
<div class="section" id="abstract">
<span id="oauth-mac-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This document specifies
the <a class="reference internal" href="glossary.html#term-http-mac-access-authentication-scheme"><em class="xref std std-term">HTTP MAC access authentication scheme</em></a>,
an HTTP authentication method
using a message authentication code (<a class="reference internal" href="nist-sp800-56a.html#term-mac"><em class="xref std std-term">MAC</em></a>) algorithm
to provide cryptographic verification of portions of
HTTP requests.
The document also defines an <a class="reference internal" href="glossary.html#term-oauth-2-0"><em class="xref std std-term">OAuth 2.0</em></a> binding for use as an access-token type.</p>
<p>(Draft 01, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01</a>)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#http-authentication-mac-access-authentication" id="id1">HTTP Authentication: MAC Access Authentication</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1. Introduction</a><ul>
<li><a class="reference internal" href="#example" id="id4">1.1. Example</a></li>
<li><a class="reference internal" href="#notational-conventions" id="id5">1.2. Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#use-with-oauth-2-0" id="id6">5. Use with OAuth 2.0</a><ul>
<li><a class="reference internal" href="#issuing-mac-type-access-tokens" id="id7">5.1. Issuing MAC-Type Access Tokens</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-mac-1"></span><h2><a class="toc-backref" href="#id3">1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This specification defines the <a class="reference internal" href="glossary.html#term-http-mac-access-authentication-scheme"><em class="xref std std-term">HTTP MAC access authentication scheme</em></a>,
providing a method for making authenticated HTTP requests
with partial cryptographic verification of the request,
covering the HTTP method, request URI, and host.</p>
<p>Similar to the <a class="reference internal" href="glossary.html#term-http-basic-access-authentication-scheme"><em class="xref std std-term">HTTP Basic access authentication scheme</em></a> [RFC2617],
the <a class="reference internal" href="glossary.html#term-mac-scheme"><em class="xref std std-term">MAC scheme</em></a> utilizes a set of <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>
which include an identifier and key.
However,
in contrast with the <a class="reference internal" href="glossary.html#term-basic-scheme"><em class="xref std std-term">Basic scheme</em></a>,
the key is never included in authenticated requests
but is used to calculate the request <em class="xref std std-term">MAC value</em>
which is included instead.</p>
<p>The <a class="reference internal" href="glossary.html#term-mac-scheme"><em class="xref std std-term">MAC scheme</em></a> requires
the establishment of a <em class="xref std std-term">shared symmetric key</em>
between the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> and the <a class="reference internal" href="glossary.html#term-server"><em class="xref std std-term">server</em></a>.
This specification offers one
such method for issuing a set of <em class="xref std std-term">MAC credentials</em>
to the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> using
<a class="reference internal" href="glossary.html#term-oauth-2-0"><em class="xref std std-term">OAuth 2.0</em></a> in the form of a <em class="xref std std-term">MAC-type access token</em>.</p>
<p>The primary design goal of this mechanism is
to simplify and improve HTTP authentication
for services <strong>that are unwilling or unable to employ TLS for every request</strong>.
In particular,
this mechanism leverage an initial TLS setup phase
to establish a shared secret between the client and the server.
The shared secret is then used over an insecure channel
to provide protection against a passive network attacker.</p>
<p>In particular,
when a <a class="reference internal" href="glossary.html#term-server"><em class="xref std std-term">server</em></a> uses this mechanism,
a <em class="xref std std-term">passive network attacker</em> will be unable
to &#8220;steal&#8221; the user&#8217;s <em class="xref std std-term">session token</em>,
as is possible today with <em class="xref std std-term">cookies</em> and other <a class="reference internal" href="oauth_bearer.html#term-bearer-tokens"><em class="xref std std-term">bearer tokens</em></a>.
In addition,
this mechanism helps secure the session token against leakage
when sent over a secure channel to the wrong server.
For example,
when the client uses some form of dynamic configuration
to determine where to send an authenticated request,
or when the client fails to properly validate the server&#8217;s identity
as part of its TLS handshake.</p>
<p>Unlike the <a class="reference internal" href="glossary.html#term-http-digest-authentication-scheme"><em class="xref std std-term">HTTP Digest authentication scheme</em></a>,
this mechanism does not require interacting with the server
to prevent <a class="reference internal" href="glossary.html#term-replay-attacks"><em class="xref std std-term">replay attacks</em></a>.
Instead, the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> provides
both a <a class="reference internal" href="standard.html#term-nonce"><em class="xref std std-term">nonce</em></a> and a <em class="xref std std-term">timestamp</em>,
which the <a class="reference internal" href="glossary.html#term-server"><em class="xref std std-term">server</em></a> can use to prevent <a class="reference internal" href="glossary.html#term-replay-attacks"><em class="xref std std-term">replay attacks</em></a>
using a bounded amount of storage.
Also unlike <a class="reference internal" href="glossary.html#term-digest-scheme"><em class="xref std std-term">Digest</em></a>,
this mechanism is not intended
to protect the user&#8217;s password itself
because the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> and <a class="reference internal" href="glossary.html#term-server"><em class="xref std std-term">server</em></a>
both have access to the key material in the clear.
Instead,
servers should issue a <strong>short-lived derivative credential</strong>
for this mechanism during the initial TLS setup phase.</p>
<p><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-1">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-1</a></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>TLS/SSL is required only when &#8220;token&#8221; is exchanged.</li>
<li>nonce and timestamp prevent replay attacks</li>
</ul>
</div>
<div class="section" id="example">
<span id="oauth-mac-1-1"></span><h3><a class="toc-backref" href="#id4">1.1. Example</a><a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> attempts to access a <a class="reference internal" href="glossary.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a> without
authentication, making the following HTTP request to the resource
server:</p>
<div class="highlight-python"><pre>GET /resource/1?b=1&amp;a=2 HTTP/1.1
Host: example.com</pre>
</div>
<p>The resource server returns the following authentication challenge:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: MAC</pre>
</div>
<p>The <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> has previously obtained a set of <em class="xref std std-ref">MAC credentials</em>
for accessing resources on the &#8220;<a class="reference external" href="http://example.com/">http://example.com/</a>&#8221; server.
The <em class="xref std std-term">MAC credentials</em> issued to the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> include the following attributes:</p>
<div class="highlight-python"><pre>MAC key identifier:  h480djs93hd8
MAC key:  489dks293j39
MAC algorithm:  hmac-sha-1</pre>
</div>
<p>The <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> constructs the authentication header
by calculating a <em class="xref std std-term">timestamp</em>
(e.g. the number of seconds since January 1, 1970 00:00:00 GMT)
and generating a random string used as a <a class="reference internal" href="standard.html#term-nonce"><em class="xref std std-term">nonce</em></a>:</p>
<div class="highlight-python"><pre>Timestamp:  1336363200
Nonce:  dj83hs9s</pre>
</div>
<p>The client constructs the normalized request string
(the new line separator character is represented by &#8220;n&#8221; for display purposes only;
the trailing new line separator signify that no extension value is
included with the request, explained below):</p>
<div class="highlight-python"><pre>1336363200\n
dj83hs9s\n
GET\n
/resource/1?b=1&amp;a=2\n
example.com\n
80\n
\n</pre>
</div>
<p>The request MAC is calculated using the specified MAC algorithm
&#8220;hmac-sha-1&#8221; and the MAC key over the normalized request string.
The result is base64-encoded to produce the request MAC:</p>
<div class="highlight-python"><pre>bhCQXTVyfj5cmA9uKkPFx1zeOXM=</pre>
</div>
<p>The client includes the MAC key identifier, nonce, and request MAC
with the request using the &#8220;Authorization&#8221; request header field:</p>
<div class="highlight-python"><pre>GET /resource/1?b=1&amp;a=2 HTTP/1.1
Host: example.com
Authorization: MAC id="h480djs93hd8",
                   ts="1336363200",
                   nonce="dj83hs9s",
                   mac="bhCQXTVyfj5cmA9uKkPFx1zeOXM="</pre>
</div>
<p>The server validates the request by calculating the request MAC again
based on the request received and verifies the validity and scope of
the MAC credentials.  If valid, the server responds with the
requested resource representation.</p>
<p>(Draft 01 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-1.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-1.1</a>)</p>
</div>
<div class="section" id="notational-conventions">
<span id="oauth-mac-1-2"></span><h3><a class="toc-backref" href="#id5">1.2. Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8216;MUST&#8217;, &#8216;MUST NOT&#8217;, &#8216;REQUIRED&#8217;, &#8216;SHALL&#8217;, &#8216;SHALL NOT&#8217;,
&#8216;SHOULD&#8217;, &#8216;SHOULD NOT&#8217;, &#8216;RECOMMENDED&#8217;, &#8216;MAY&#8217;, and &#8216;OPTIONAL&#8217; in this
specification are to be interpreted as described in [RFC2119].</p>
<p>This specification uses the Augmented Backus-Naur Form (ABNF)
notation of [I-D.ietf-httpbis-p1-messaging].  Additionally, the
following rules are included from [RFC2617]: auth-param.</p>
<p>(draft 01)</p>
</div>
</div>
<div class="section" id="use-with-oauth-2-0">
<span id="oauth-mac-5"></span><h2><a class="toc-backref" href="#id6">5. Use with OAuth 2.0</a><a class="headerlink" href="#use-with-oauth-2-0" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="glossary.html#term-oauth-2-0"><em class="xref std std-term">OAuth 2.0</em></a> ([I-D.ietf-oauth-v2]) defines
an extensible token-based authentication framework.
The <em class="xref std std-term">MAC authentication scheme</em> can be used
to make OAuth-based requests by issuing <em class="xref std std-term">MAC-type access tokens</em>.</p>
<p>This specification does not define methods
for the <a class="reference internal" href="uma_core.html#term-client"><em class="xref std std-term">client</em></a> to specifically request a <em class="xref std std-term">MAC-type token</em>
from the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
Additionally,
it does not include any discovery facilities for identifying
which HMAC algorithms are supported by a resource server,
or how the client may go about obtaining MAC access tokens for any
given protected resource.</p>
<p>(Draft 01, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-5">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-5</a> )</p>
<div class="section" id="issuing-mac-type-access-tokens">
<span id="oauth-mac-5-1"></span><h3><a class="toc-backref" href="#id7">5.1. Issuing MAC-Type Access Tokens</a><a class="headerlink" href="#issuing-mac-type-access-tokens" title="Permalink to this headline">¶</a></h3>
<p>Authorization servers issuing MAC-type access tokens MUST include the
following parameters whenever a response includes the &#8220;<a class="reference internal" href="standard.html#term-30"><em class="xref std std-term">access_token</em></a>&#8221;
parameter:</p>
<dl class="glossary docutils">
<dt id="term-access-token">access_token</dt>
<dd>REQUIRED.
The MAC key identifier.</dd>
<dt id="term-mac-key">mac_key</dt>
<dd>REQUIRED.
The MAC key.</dd>
<dt id="term-mac-algorithm">mac_algorithm</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">The MAC algorithm used to calculate the request MAC.
Value MUST be one of &#8220;hmac-sha-1&#8221;, &#8220;hmac-sha-256&#8221;, or a
registered extension algorithm name as described in
Section 7.1.</p>
</dd>
</dl>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
  "access_token":"SlAV32hkKG",
  "token_type":"mac",
  "expires_in":3600,
  "refresh_token":"8xLOxBtZp8",
  "mac_key":"adijq39jdlaska9asud",
  "mac_algorithm":"hmac-sha-256"
}</pre>
</div>
<p>(Draft 01, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-5.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-01#section-5.1</a> )</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>