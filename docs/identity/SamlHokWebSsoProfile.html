

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="Web Services Security SAML Token Profile Version 1.1.1" href="wss_saml_token_profile.html" />
    <link rel="prev" title="SAML V2.0 Holder-of-Key Assertion Profile Version 1.0" href="SamlHokProfile.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="saml-v2-0-holder-of-key-web-browser-sso-profile-version-1-0">
<h1><a class="toc-backref" href="#id7">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a><a class="headerlink" href="#saml-v2-0-holder-of-key-web-browser-sso-profile-version-1-0" title="Permalink to this headline">¶</a></h1>
<p>Committee Specification 02 10 August 2010</p>
<p><a class="reference external" href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-holder-of-key-browser-sso.html">http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-holder-of-key-browser-sso.html</a></p>
<div class="section" id="related-work">
<h2><a class="toc-backref" href="#id8">Related Work:</a><a class="headerlink" href="#related-work" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>This specification is a cryptographically strong alternative to the SAML V2.0 Web Browser SSO Profile described in the SAML V2.0 Profiles specification [SAML2Prof].</div></blockquote>
</div>
<div class="section" id="declared-xml-namespace-s">
<h2><a class="toc-backref" href="#id9">Declared XML Namespace(s):</a><a class="headerlink" href="#declared-xml-namespace-s" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><a class="reference external" href="urn:oasis:names:tc:SAML:2.0:profiles:holder-of-key:SSO:browser">urn:oasis:names:tc:SAML:2.0:profiles:holder-of-key:SSO:browser</a></div></blockquote>
</div>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id10">Abstract:</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The doc:<cite>SAML V2.0 Holder-of-Key Web Browser SSO Profile &lt;SamlHokWebSsoProfile&gt;</cite>  allows
for <strong>transport</strong> of <a class="reference internal" href="glossary.html#term-holder-of-key-assertions"><em class="xref std std-term">holder-of-key assertions</em></a> modification of client software
and maximum compatibility with existing deployments.</p>
<p>The flow is similar to standard <a class="reference internal" href="glossary.html#term-web-browser-sso"><em class="xref std std-term">Web Browser SSO</em></a>,
but an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> presented by the <a class="reference internal" href="glossary.html#term-161"><em class="xref std std-term">user agent</em></a>
via a <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a> supplies a key to be used in a holder-of-key assertion.</p>
<p>Proof of possession of the <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a>
corresponding to the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> in the certificate
resulting from the <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>
strengthens the assurance of the resulting authentication context
and protects against credential theft.</p>
<p>Neither the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> nor the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> is required to validate the certificate.</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#saml-v2-0-holder-of-key-web-browser-sso-profile-version-1-0" id="id7">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a><ul>
<li><a class="reference internal" href="#related-work" id="id8">Related Work:</a></li>
<li><a class="reference internal" href="#declared-xml-namespace-s" id="id9">Declared XML Namespace(s):</a></li>
<li><a class="reference internal" href="#abstract" id="id10">Abstract:</a></li>
<li><a class="reference internal" href="#introduction" id="id11">1 Introduction</a><ul>
<li><a class="reference internal" href="#terminology" id="id12">1.2 Terminology</a></li>
<li><a class="reference internal" href="#normative-references" id="id13">1.3 Normative References</a></li>
<li><a class="reference internal" href="#non-normative-references" id="id14">1.4 Non-normative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#holder-of-key-web-browser-profile" id="id15">2 Holder-of-Key Web Browser Profile</a><ul>
<li><a class="reference internal" href="#required-information" id="id16">2.1 Required Information</a></li>
<li><a class="reference internal" href="#background" id="id17">2.2 Background</a></li>
<li><a class="reference internal" href="#profile-overview" id="id18">2.3 Profile Overview</a><ul>
<li><a class="reference internal" href="#figure-1" id="id19">Figure.1</a></li>
<li><a class="reference internal" href="#http-request-to-service-provider-section-2-6-1" id="id20">1. HTTP Request to Service Provider (section 2.6.1)</a></li>
<li><a class="reference internal" href="#service-provider-determines-identity-provider-section-2-6-2" id="id21">2. Service Provider Determines Identity Provider (section 2.6.2)</a></li>
<li><a class="reference internal" href="#service-provider-issues-samlp-authnrequest-to-identity-provider-section-2-6-3" id="id22">3. Service Provider Issues &lt;samlp:AuthnRequest&gt; to Identity Provider (section 2.6.3)</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-3-step-4" id="id23">4. Identity Provider Identifies Principal and Verifies Key Possession (section 2.6.4)</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-3-step-5" id="id24">5. Identity Provider Issues &lt;samlp:Response&gt; to Service Provider (section 2.6.5)</a></li>
<li><a class="reference internal" href="#service-provider-grants-or-denies-access-to-principal-section-2-6-6" id="id25">6. Service Provider Grants or Denies Access to Principal (section 2.6.6)</a></li>
<li><a class="reference internal" href="#note" id="id26">Note</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tls-usage" id="id27">2.4 TLS Usage</a></li>
<li><a class="reference internal" href="#choice-of-binding" id="id28">2.5 Choice of Binding</a></li>
<li><a class="reference internal" href="#profile-description" id="id29">2.6 Profile Description</a><ul>
<li><a class="reference internal" href="#http-request-to-service-provider" id="id30">2.6.1 HTTP Request to Service Provider</a></li>
<li><a class="reference internal" href="#service-provider-determines-identity-provider" id="id31">2.6.2 Service Provider Determines Identity Provider</a></li>
<li><a class="reference internal" href="#service-provider-issues-samlp-authnrequest-to-identity-provider" id="id32">2.6.3 Service Provider issues &lt;samlp:AuthnRequest&gt; to Identity Provider</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-6-4" id="id33">2.6.4 Identity Provider Identifies Principal and Verifies Key Possession</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-6-5" id="id34">2.6.5 Identity Provider Issues &lt;samlp:Response&gt; to Service Provider</a></li>
<li><a class="reference internal" href="#service-provider-grants-or-denies-access-to-principal" id="id35">2.6.6 Service Provider Grants or Denies Access to Principal</a></li>
</ul>
</li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-7" id="id36">2.7</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-7-1" id="id37">2.7.1</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-2-8" id="id38">2.8</a></li>
<li><a class="reference internal" href="#samlhokwebssoprofile-4-2" id="id39">4.2</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="samlhokwebssoprofile-1"></span><h2><a class="toc-backref" href="#id11">1 Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In the scenario addressed by this profile,
which is an alternate version of the <a class="reference internal" href="#term-saml2prof"><em class="xref std std-term">SAML V2.0 Web Browser SSO Profile [SAML2Prof]</em></a>,
a <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> uses an HTTP <a class="reference internal" href="glossary.html#term-161"><em class="xref std std-term">user agent</em></a> to access a web-based resource at a <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
To do so,
the user agent presents a <a class="reference internal" href="SamlHokProfile.html#term-holder-of-key-saml-assertion"><em class="xref std std-term">holder-of-key SAML assertion</em></a> acquired from its preferred <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>.</p>
<p>The user may first acquire an <a class="reference internal" href="glossary.html#term-authentication-request"><em class="xref std std-term">authentication request</em></a>
from the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> or a third party.</p>
<p>The <a class="reference internal" href="glossary.html#term-161"><em class="xref std std-term">user agent</em></a> transports the <a class="reference internal" href="glossary.html#term-authentication-request"><em class="xref std std-term">authentication request</em></a>
to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> by making an HTTP request over <a class="reference internal" href="glossary.html#term-tls"><em class="xref std std-term">TLS</em></a>.
An <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> supplied as a result of the <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>
supplies a <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> that is associated with the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>.</p>
<p>The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> authenticates the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> by any method of its choosing
and then produces a response containing at least one assertion with <a class="reference internal" href="glossary.html#term-holder-of-key-subject-confirmation"><em class="xref std std-term">holder-of-key subject confirmation</em></a>
and an <a class="reference internal" href="glossary.html#term-authentication-statement"><em class="xref std std-term">authentication statement</em></a> for the <a class="reference internal" href="glossary.html#term-161"><em class="xref std std-term">user agent</em></a> to transport to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a> is then presented by the <a class="reference internal" href="glossary.html#term-161"><em class="xref std std-term">user agent</em></a> to <a class="reference internal" href="glossary.html#term-the-service-provider"><em class="xref std std-term">the service provider</em></a>
by making an HTTP request over <a class="reference internal" href="glossary.html#term-tls"><em class="xref std std-term">TLS</em></a>.
An <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> supplied as a result of the <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a> proves
possession of the <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a> matching the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> bound to the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>.</p>
<p>Finally,
the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> consumes the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>
to create a <a class="reference internal" href="glossary.html#term-security-context"><em class="xref std std-term">security context</em></a> for the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>.</p>
<p>In what follows,
a profile of the <a class="reference internal" href="#term-saml2core"><em class="xref std std-term">SAML Authentication Request Protocol [SAML2Core]</em></a> is used
in conjunction with an HTTP binding (section 2.5).
It is assumed that the user wields an HTTP user agent,
such as a standard web browser,
capable of presenting <a class="reference internal" href="glossary.html#term-client-certificates"><em class="xref std std-term">client certificates</em></a> in conjunction with a <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>.</p>
<div class="section" id="terminology">
<span id="samlhokwebssoprofile-1-2"></span><h3><a class="toc-backref" href="#id12">1.2 Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-tls">TLS</dt>
<dd>The term TLS as used in this specification refers to either the Secure Sockets Layer (SSL) Protocol 3.0 [<a class="reference internal" href="#term-ssl3"><em class="xref std std-term">SSL3</em></a>]
or any version of the Transport Layer Security (TLS) Protocol [<a class="reference internal" href="reg.html#term-rfc2246"><em class="xref std std-term">RFC2246</em></a>] [<a class="reference internal" href="#term-rfc4346"><em class="xref std std-term">RFC4346</em></a>] [<a class="reference internal" href="standard.html#term-rfc5246"><em class="xref std std-term">RFC5246</em></a>].
As used in this specification,
the term TLS specifically does not refer to the SSL Protocol 2.0 [<a class="reference internal" href="#term-ssl2"><em class="xref std std-term">SSL2</em></a>].</dd>
<dt id="term-x-509-certificate">X.509 certificate</dt>
<dd>Unless otherwise noted,
the term X.509 certificate refers to an X.509 client certificate
as specified in the relevant version of the TLS protocol.</dd>
</dl>
</div>
<div class="section" id="normative-references">
<span id="samlhokwebssoprofile-1-3"></span><h3><a class="toc-backref" href="#id13">1.3 Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-hoksso-xsd">HoKSSO-XSD</dt>
<dd>OASIS Committee Specification 02, Schema for SAML V2.0 Holder-of-Key Web Browser SSO Profile. August 2010. <a class="reference external" href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-holder-of-key-browser-sso.xsd">http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-holder-of-key-browser-sso.xsd</a></dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd><ol class="first last upperalpha simple" start="19">
<li>Bradner. Key words for use in RFCs to Indicate Requirement Levels. IETF RFC 2119, March 1997. <a class="reference external" href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a></li>
</ol>
</dd>
<dt id="term-rfc2246">RFC2246</dt>
<dd><ol class="first last upperalpha simple" start="20">
<li>Dierks, C. Allen. The TLS Protocol Version 1.0. IETF RFC 2246, January 1999. <a class="reference external" href="http://www.ietf.org/rfc/rfc2246.txt">http://www.ietf.org/rfc/rfc2246.txt</a></li>
</ol>
</dd>
<dt id="term-rfc4346">RFC4346</dt>
<dd><ol class="first last upperalpha simple" start="20">
<li>Dierks, E. Rescorla. The Transport Layer Security (TLS) Protocol Version 1.1. IETF RFC 4346, April 2006. <a class="reference external" href="http://www.ietf.org/rfc/rfc4346.txt">http://www.ietf.org/rfc/rfc4346.txt</a></li>
</ol>
</dd>
<dt id="term-rfc5246">RFC5246</dt>
<dd><ol class="first last upperalpha simple" start="20">
<li>Dierks, E. Rescorla. The Transport Layer Security (TLS) Protocol Version 1.2. IETF RFC 5246, August 2008. <a class="reference external" href="http://www.ietf.org/rfc/rfc5246.txt">http://www.ietf.org/rfc/rfc5246.txt</a></li>
</ol>
</dd>
<dt id="term-rfc5280">RFC5280</dt>
<dd><ol class="first last upperalpha simple" start="4">
<li>Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, W. Polk. Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile. IETF RFC 5280, May 2008. <a class="reference external" href="http://www.ietf.org/rfc/rfc5280.txt">http://www.ietf.org/rfc/rfc5280.txt</a></li>
</ol>
</dd>
<dt id="term-saml2bind">SAML2Bind</dt>
<dd>OASIS Standard, Bindings for the OASIS Security Assertion Markup Language (SAML) V2.0. March 2005. <a class="reference external" href="http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf</a></dd>
<dt id="term-saml2core">SAML2Core</dt>
<dd>OASIS Standard, Assertions and Protocols for the OASIS Security Assertion Markup Language (SAML) V2.0. March 2005. <a class="reference external" href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf</a></dd>
<dt id="term-saml2hokap">SAML2HoKAP</dt>
<dd>OASIS Committee Specification 02, SAML V2.0 Holder-of-Key Assertion Profile. January 2010. <a class="reference external" href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml2-holder-of-key-cs-02.pdf">http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml2-holder-of-key-cs-02.pdf</a></dd>
<dt id="term-saml2meta">SAML2Meta</dt>
<dd>OASIS Standard, Metadata for the OASIS Security Assertion Markup Language (SAML) V2.0. March 2005. <a class="reference external" href="http://docs.oasis-open.org/security/saml/v2.0/saml-metadata-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-metadata-2.0-os.pdf</a></dd>
<dt id="term-saml2prof">SAML2Prof</dt>
<dd>OASIS Standard, Profiles for the OASIS Security Assertion Markup Language (SAML) V2.0. March 2005. <a class="reference external" href="http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf</a></dd>
<dt id="term-schema1">Schema1</dt>
<dd><ol class="first last upperalpha simple" start="8">
<li><ol class="first upperalpha" start="19">
<li>Thompson et al. XML Schema Part 1: Structures. World Wide Web Consortium Recommendation, May 2001. <a class="reference external" href="http://www.w3.org/TR/2001/REC-xmlschema-1-20010502/">http://www.w3.org/TR/2001/REC-xmlschema-1-20010502/</a></li>
</ol>
</li>
</ol>
</dd>
<dt id="term-ssl3">SSL3</dt>
<dd><ol class="first last upperalpha simple">
<li>Freier, P. Karlton, P. Kocher. The SSL Protocol Version 3.0. Netscape Communications Corp., November 18, 1996. <a class="reference external" href="http://www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt">http://www.mozilla.org/projects/security/pki/nss/ssl/draft302.txt</a></li>
</ol>
</dd>
<dt id="term-xmlsig">XMLSig</dt>
<dd><ol class="first last upperalpha simple" start="4">
<li>Eastlake, J. Reagle, D. Solo, F. Hirsch, T. Roessler. XML Signature Syntax and Processing (Second Edition). World Wide Web Consortium Recommendation, 10 June 2008. <a class="reference external" href="http://www.w3.org/TR/xmldsig-core/">http://www.w3.org/TR/xmldsig-core/</a></li>
</ol>
</dd>
</dl>
</div>
<div class="section" id="non-normative-references">
<span id="samlhokwebssoprofile-1-4"></span><h3><a class="toc-backref" href="#id14">1.4 Non-normative References</a><a class="headerlink" href="#non-normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-aixcm">AIXCM</dt>
<dd><ol class="first last upperalpha simple" start="20">
<li>Moreau. Auto Issued X.509 Certificate Mechanism (AIXCM). IETF Internet-Draft, 6 August 2008. <a class="reference external" href="http://www.ietf.org/internet-drafts/draft-moreau-pkix-aixcm-00.txt">http://www.ietf.org/internet-drafts/draft-moreau-pkix-aixcm-00.txt</a></li>
</ol>
</dd>
<dt id="term-idpdisco">IDPDisco</dt>
<dd>OASIS Committee Specification 01, Identity Provider Discovery Service Protocol and Profile., October 2007. <a class="reference external" href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-idp-discovery-cs-01.pdf">http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-idp-discovery-cs-01.pdf</a></dd>
<dt id="term-nisteauth">NISTEAuth</dt>
<dd><ol class="first last upperalpha simple" start="23">
<li><ol class="first upperalpha" start="5">
<li>Burr et al. Electronic Authentication Guideline. National Institute of Standards and Technology, Draft Special Publication 800-63-1, 12 December 2008. <a class="reference external" href="http://csrc.nist.gov/publications/drafts/800-63-rev1/SP800-63-Rev1_Dec2008.pdf">http://csrc.nist.gov/publications/drafts/800-63-rev1/SP800-63-Rev1_Dec2008.pdf</a></li>
</ol>
</li>
</ol>
</dd>
<dt id="term-rfc3820">RFC3820</dt>
<dd><ol class="first last upperalpha simple" start="19">
<li>Tuecke, V. Welch, D. Engert, L. Pearlman, M. Thompson. Internet X.509 Public Key Infrastructure (PKI) Proxy Certificate Profile. IETF RFC 3820, June 2004. <a class="reference external" href="http://www.ietf.org/rfc/rfc3820.txt">http://www.ietf.org/rfc/rfc3820.txt</a></li>
</ol>
</dd>
<dt id="term-saml2secure">SAML2Secure</dt>
<dd>OASIS Standard, Security and Privacy Considerations for the OASIS Security Assertion Markup Language (SAML) V2.0. March 2005. <a class="reference external" href="http://docs.oasis-open.org/security/saml/v2.0/saml-sec-consider-2.0-os.pdf">http://docs.oasis-open.org/security/saml/v2.0/saml-sec-consider-2.0-os.pdf</a></dd>
<dt id="term-saml2simple">SAML2Simple</dt>
<dd>OASIS Committee Draft 04, SAMLv2.0 HTTP POST &#8220;SimpleSign&#8221; Binding. December 2008. <a class="reference external" href="http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-binding-simplesign-cd-04.pdf">http://docs.oasis-open.org/security/saml/Post2.0/sstc-saml-binding-simplesign-cd-04.pdf</a></dd>
<dt id="term-ssl2">SSL2</dt>
<dd><ol class="first last upperalpha simple" start="11">
<li>Hickman. The SSL Protocol. Netscape Communications Corp., February 9, 1995. <a class="reference external" href="http://www.mozilla.org/projects/security/pki/nss/ssl/draft02.html">http://www.mozilla.org/projects/security/pki/nss/ssl/draft02.html</a></li>
</ol>
</dd>
<dt id="term-sstc2nist">SSTC2NIST</dt>
<dd>&#8220;Suggested revisions to Draft NIST Special Publication 800-63-1 and the use of Assertions at Level-of-Assurance 4.&#8221; OASIS SSTC, 4 November 2008. <a class="reference external" href="http://www.oasis-open.org/committees/download.php/29904/NIST-800-63-LOA-4-Letter-v2.pdf">http://www.oasis-open.org/committees/download.php/29904/NIST-800-63-LOA-4-Letter-v2.pdf</a></dd>
</dl>
</div>
</div>
<div class="section" id="holder-of-key-web-browser-profile">
<span id="samlhokwebssoprofile-2"></span><h2><a class="toc-backref" href="#id15">2 Holder-of-Key Web Browser Profile</a><a class="headerlink" href="#holder-of-key-web-browser-profile" title="Permalink to this headline">¶</a></h2>
<div class="section" id="required-information">
<span id="samlhokwebssoprofile-2-1"></span><h3><a class="toc-backref" href="#id16">2.1 Required Information</a><a class="headerlink" href="#required-information" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Identification:</dt>
<dd><a class="reference external" href="urn:oasis:names:tc:SAML:2.0:profiles:holder-of-key:SSO:browser">urn:oasis:names:tc:SAML:2.0:profiles:holder-of-key:SSO:browser</a></dd>
<dt>Contact information:</dt>
<dd><a class="reference external" href="mailto:security-services-comment&#37;&#52;&#48;lists&#46;oasis-open&#46;org">security-services-comment<span>&#64;</span>lists<span>&#46;</span>oasis-open<span>&#46;</span>org</a></dd>
<dt>SAML Confirmation Method Identifiers:</dt>
<dd>The SAML V2.0 “holder-of-key” confirmation method identifier,
<a class="reference external" href="urn:oasis:names:tc:SAML:2.0:cm:holder-of-key">urn:oasis:names:tc:SAML:2.0:cm:holder-of-key</a>, is included in all assertions issued under this profile.</dd>
<dt>Description:</dt>
<dd>Given below.</dd>
<dt>Updates:</dt>
<dd>Provides an alternative to the SAML V2.0 Web Browser SSO Profile [SAML2Prof].</dd>
</dl>
</div>
<div class="section" id="background">
<span id="samlhokwebssoprofile-2-2"></span><h3><a class="toc-backref" href="#id17">2.2 Background</a><a class="headerlink" href="#background" title="Permalink to this headline">¶</a></h3>
<p>This profile is designed to enhance the security of <a class="reference internal" href="glossary.html#term-saml-assertion"><em class="xref std std-term">SAML assertion</em></a> and message exchange
without requiring modifications to client software.
A <a class="reference internal" href="SamlHokProfile.html#term-holder-of-key-saml-assertion"><em class="xref std std-term">holder-of-key SAML assertion</em></a> is delivered to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> via an HTTP binding
(section 2.5) over <a class="reference internal" href="glossary.html#term-tls"><em class="xref std std-term">TLS</em></a>.</p>
<p>The user agent presents an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> previously vetted by the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>,
resulting in a strong association of the resulting security context
with the intended user and elimination of numerous attacks (section 4).</p>
<p>Enhanced security is the primary benefit associated with the use of this profile.
Under ordinary <a class="reference internal" href="glossary.html#term-web-browser-sso"><em class="xref std std-term">Web Browser SSO</em></a>,
there is a small chance that a <a class="reference internal" href="oauth_bearer.html#term-bearer-token"><em class="xref std std-term">bearer token</em></a> will be stolen in transit, as described in [<a class="reference internal" href="#term-saml2secure"><em class="xref std std-term">SAML2Secure</em></a>].
Confirming that the presenter of the token is the intended subject through public key cryptography
virtually eliminates this chance, improving the viability of SAML <a class="reference internal" href="glossary.html#term-web-browser-sso"><em class="xref std std-term">Web Browser SSO</em></a> for sensitive applications.</p>
<p>Related to this,
<a class="reference internal" href="glossary.html#term-nist"><em class="xref std std-term">NIST</em></a> has recently revised its E-Authentication Guideline [<a class="reference internal" href="#term-nisteauth"><em class="xref std std-term">NISTEAuth</em></a>],
and in the revision,
in response to a public comment from the <a class="reference internal" href="glossary.html#term-sstc"><em class="xref std std-term">SSTC</em></a> [<a class="reference internal" href="#term-sstc2nist"><em class="xref std std-term">SSTC2NIST</em></a>],
<a class="reference internal" href="glossary.html#term-nist"><em class="xref std std-term">NIST</em></a> has clarified the use of &#8220;assertions&#8221; at NIST level-of-assurance 4.</p>
<p>As a result of this revised E-Authentication Guideline,
<strong>“holder-of-key assertions may be used”</strong> as level 4 security tokens
provided certain requirements are met (section 10.3.2.4 of [<a class="reference internal" href="#term-nisteauth"><em class="xref std std-term">NISTEAuth</em></a>]).</p>
<p>We believe that <a class="reference internal" href="glossary.html#term-holder-of-key-saml-assertions"><em class="xref std std-term">holder-of-key SAML assertions</em></a> obtained
via the SAML V2.0 Holder-of-Key Web Browser SSO Profile are cryptographically strong authentication tokens
that meet the <a class="reference internal" href="glossary.html#term-nist"><em class="xref std std-term">NIST</em></a> requirements.</p>
</div>
<div class="section" id="profile-overview">
<span id="samlhokwebssoprofile-2-3"></span><h3><a class="toc-backref" href="#id18">2.3 Profile Overview</a><a class="headerlink" href="#profile-overview" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#samlhokwebssoprofile-figure-1"><em>Figure 1</em></a> illustrates
the basic template for achieving <a class="reference internal" href="glossary.html#term-web-browser-sso"><em class="xref std std-term">Web Browser SSO</em></a> under this profile.
The following steps are described by the profile.
Within an individual step,
there may be one or more actual message exchanges
depending on the binding used for that step and other deployment-specific behavior.</p>
<div class="section" id="figure-1">
<span id="samlhokwebssoprofile-figure-1"></span><h4><a class="toc-backref" href="#id19">Figure.1</a><a class="headerlink" href="#figure-1" title="Permalink to this headline">¶</a></h4>
<img alt="images/SamlHokWebSsoProfile.figure.1.png" src="images/SamlHokWebSsoProfile.figure.1.png" />
</div>
<div class="section" id="http-request-to-service-provider-section-2-6-1">
<span id="samlhokwebssoprofile-2-3-step-1"></span><h4><a class="toc-backref" href="#id20">1. HTTP Request to Service Provider (section 2.6.1)</a><a class="headerlink" href="#http-request-to-service-provider-section-2-6-1" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>,
via an HTTP user agent,
makes an HTTP request for a secured resource at the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
at this step,
the user agent may or may not present an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>
in conjunction with a <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>.
In any event,
the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> determines that
no <a class="reference internal" href="glossary.html#term-security-context"><em class="xref std std-term">security context</em></a> exists and subsequently initiates <a class="reference internal" href="glossary.html#term-holder-of-key-web-browser-sso"><em class="xref std std-term">Holder-of-Key Web Browser SSO</em></a>.</p>
</div>
<div class="section" id="service-provider-determines-identity-provider-section-2-6-2">
<span id="samlhokwebssoprofile-2-3-step-2"></span><h4><a class="toc-backref" href="#id21">2. Service Provider Determines Identity Provider (section 2.6.2)</a><a class="headerlink" href="#service-provider-determines-identity-provider-section-2-6-2" title="Permalink to this headline">¶</a></h4>
<p>The service provider determines the principal&#8217;s preferred identity provider by unspecified means.</p>
</div>
<div class="section" id="service-provider-issues-samlp-authnrequest-to-identity-provider-section-2-6-3">
<span id="samlhokwebssoprofile-2-3-step-3"></span><h4><a class="toc-backref" href="#id22">3. Service Provider Issues &lt;samlp:AuthnRequest&gt; to Identity Provider (section 2.6.3)</a><a class="headerlink" href="#service-provider-issues-samlp-authnrequest-to-identity-provider-section-2-6-3" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> issues a <strong>&lt;samlp:AuthnRequest&gt;</strong> message to be delivered
by the user agent to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>.
An HTTP binding is used (<a class="reference internal" href="#samlhokwebssoprofile-2-5"><em>section 2.5</em></a> ) to transport the message
to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> through the user agent.
The user agent presents the message to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> in an HTTP request over TLS.
In conjunction with TLS,
the user agent presents an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> to the identity provider
as described in <a class="reference internal" href="#samlhokwebssoprofile-2-4"><em>section 2.4</em></a>.</p>
</div>
<div class="section" id="samlhokwebssoprofile-2-3-step-4">
<span id="identity-provider-identifies-principal-and-verifies-key-possession-section-2-6-4"></span><h4><a class="toc-backref" href="#id23">4. Identity Provider Identifies Principal and Verifies Key Possession (section 2.6.4)</a><a class="headerlink" href="#samlhokwebssoprofile-2-3-step-4" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> is identified by the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> at this step.
The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> identifies the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>
using any authentication method at its disposal
while honoring any requirements imposed by the service provider in the <strong>&lt;samlp:AuthnRequest&gt;</strong> message.
The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> must establish that the user agent holds the <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a>
corresponding to the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> bound to the <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> and
that the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> does in fact belong to the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>.</p>
</div>
<div class="section" id="samlhokwebssoprofile-2-3-step-5">
<span id="identity-provider-issues-samlp-response-to-service-provider-section-2-6-5"></span><h4><a class="toc-backref" href="#id24">5. Identity Provider Issues &lt;samlp:Response&gt; to Service Provider (section 2.6.5)</a><a class="headerlink" href="#samlhokwebssoprofile-2-3-step-5" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> issues a <strong>&lt;samlp:Response&gt;</strong> message to be delivered
by the user agent to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
The response either indicates an error or includes at least an authentication statement in a <a class="reference internal" href="SamlHokProfile.html#term-holder-of-key-assertion"><em class="xref std std-term">holder-of-key assertion</em></a>.
An HTTP binding is used (<a class="reference internal" href="#samlhokwebssoprofile-2-5"><em>section 2.5</em></a>)
to transport the message to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> through the user agent.
The user agent presents the message to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> in an HTTP request over TLS.
As in step 3, the user agent presents an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>
as described in <a class="reference internal" href="#samlhokwebssoprofile-2-4"><em>section 2.4</em></a>.</p>
</div>
<div class="section" id="service-provider-grants-or-denies-access-to-principal-section-2-6-6">
<span id="samlhokwebssoprofile-2-3-step-6"></span><h4><a class="toc-backref" href="#id25">6. Service Provider Grants or Denies Access to Principal (section 2.6.6)</a><a class="headerlink" href="#service-provider-grants-or-denies-access-to-principal-section-2-6-6" title="Permalink to this headline">¶</a></h4>
<p>The SAML response is consumed by the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>
who either responds to the principal&#8217;s user agent
by establishing a <a class="reference internal" href="glossary.html#term-security-context"><em class="xref std std-term">security context</em></a> for the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> and
returning the requested resource, or by returning an error.</p>
</div>
<div class="section" id="note">
<h4><a class="toc-backref" href="#id26">Note</a><a class="headerlink" href="#note" title="Permalink to this headline">¶</a></h4>
<p>Note that
an <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> can initiate this profile at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-5"><em>step 5</em></a>
by issuing a <strong>&lt;samlp:Response&gt;</strong> message to a service provider without the preceding steps.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Idp Initiated Assertion</p>
</div>
<p>The user agent or a third party may also initiate this profile
by submitting an unsigned request at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-3"><em>step 3</em></a>.</p>
</div>
</div>
<div class="section" id="tls-usage">
<span id="samlhokwebssoprofile-2-4"></span><h3><a class="toc-backref" href="#id27">2.4 TLS Usage</a><a class="headerlink" href="#tls-usage" title="Permalink to this headline">¶</a></h3>
<p>As noted in the introduction,
this profile is an alternative to ordinary SAML Web Browser SSO [<a class="reference internal" href="#term-saml2prof"><em class="xref std std-term">SAML2Prof</em></a>].
The primary difference between that profile and this <a class="reference internal" href="glossary.html#term-holder-of-key-web-browser-sso-profile"><em class="xref std std-term">Holder-of-Key Web Browser SSO Profile</em></a> is that
the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> MUST present an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a>
and prove possession of the <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a> associated with the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> bound to the certificate.
This leads to <a class="reference internal" href="glossary.html#term-holder-of-key-subject-confirmation"><em class="xref std std-term">holder-of-key subject confirmation</em></a> [<a class="reference internal" href="#term-saml2hokap"><em class="xref std std-term">SAML2HoKAP</em></a>],
a type of subject confirmation that is stronger than the <a class="reference internal" href="glossary.html#term-bearer-subject-confirmation"><em class="xref std std-term">bearer subject confirmation</em></a> inherent
in ordinary <a class="reference internal" href="glossary.html#term-web-browser-sso"><em class="xref std std-term">Web Browser SSO</em></a>.</p>
<p>The user agent presents an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a>
in conjunction with a <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>.
It is important to realize that
the presented certificate need not be a <a class="reference internal" href="glossary.html#term-trusted-certificate"><em class="xref std std-term">trusted certificate</em></a>
(although this is certainly permitted).
However, the certificate MUST be presented via TLS.
This proves possession of the corresponding <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a>.</p>
<p>According to the TLS protocol,
validation of the client certificate is optional.
Likewise this <a class="reference internal" href="glossary.html#term-holder-of-key-web-browser-sso-profile"><em class="xref std std-term">Holder-of-Key Web Browser SSO Profile</em></a> does not require TLS client authentication,
which is strictly OPTIONAL (but see section 4.3).
Moreover,
the authentication method by which the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> identifies the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> is unspecified.</p>
<p>According to the TLS handshake protocol,
if the TLS server can not validate the client certificate,
the server may either continue the handshake
or prematurely terminate the handshake by returning a fatal alert to the client.
Moreover,
if the TLS server chooses to send a fatal alert,
it must immediately close the HTTP connection according to the TLS protocol.
Clearly this is undesirable,
so the TLS server MUST be configured to continue the TLS handshake to completion
even in the presence of an untrusted client certificate.
The method of doing so depends on the chosen TLS implementation
and is therefore out of scope with respect to this profile.</p>
<p>In summary,
the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> MUST present an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> (via TLS)
and prove possession of the <a class="reference internal" href="glossary.html#term-144"><em class="xref std std-term">private key</em></a>
at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-3"><em>steps 3</em></a> and <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-5"><em>5</em></a>
(sections <a class="reference internal" href="#samlhokwebssoprofile-2-6-3"><em>2.6.3</em></a> and <a class="reference internal" href="#samlhokwebssoprofile-2-6-5"><em>2.6.5</em></a>, resp.).
However,
the presentation of an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-1"><em>step 1</em></a>
(<a class="reference internal" href="#samlhokwebssoprofile-2-6-1"><em>section 2.6.1</em></a>) is strictly OPTIONAL.</p>
<p>At the conclusion of the <a class="reference internal" href="glossary.html#term-tls-handshake"><em class="xref std std-term">TLS handshake</em></a>,
the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>
(resp., the service provider)
MUST be able to retrieve the <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> presented by the user agent
at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-4"><em>step 4</em></a>
(resp. <a class="footnote-reference" href="#id2" id="id1">[1]</a> , <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-6"><em>step 6</em></a>).
The consequences of a failure to do so is discussed in detail
in <a class="reference internal" href="#samlhokwebssoprofile-2-6-4"><em>section 2.6.4</em></a>
(resp., <a class="reference internal" href="#samlhokwebssoprofile-2-6-6"><em>section 2.6.6</em></a> ).</p>
<p>At either of <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-3"><em>steps 3</em></a> or <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-5"><em>5</em></a> (or both),
the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> or the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> (resp.)
MAY use the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> bound to the certificate
or the <a class="reference internal" href="glossary.html#term-tls-session-key"><em class="xref std std-term">TLS session key</em></a> to create a <a class="reference internal" href="glossary.html#term-security-context"><em class="xref std std-term">security context</em></a> for the <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a>.
Also,
at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-1"><em>step 1</em></a>,
the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> MAY use the <a class="reference internal" href="glossary.html#term-public-key"><em class="xref std std-term">public key</em></a> bound to the certificate or
the <a class="reference internal" href="glossary.html#term-tls-session-key"><em class="xref std std-term">TLS session key</em></a> to associate any subsequent exchange with the original request.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>resp. = respectively, (in listing a number of items or attributes that refer to another list) separately in the order given</td></tr>
</tbody>
</table>
</div>
<div class="section" id="choice-of-binding">
<span id="samlhokwebssoprofile-2-5"></span><h3><a class="toc-backref" href="#id28">2.5 Choice of Binding</a><a class="headerlink" href="#choice-of-binding" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> and the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> MUST use a browser-based HTTP binding
to transmit the SAML protocol message to the other party.
A SAML HTTP binding [<a class="reference internal" href="#term-saml2bind"><em class="xref std std-term">SAML2Bind</em></a>] MAY be used for this purpose:</p>
<blockquote>
<div><p>HTTP Redirect</p>
<p>HTTP POST</p>
<p>HTTP Artifact</p>
</div></blockquote>
<p>This profile does not preclude the use of other browser-based HTTP bindings
(such as the SAML V2.0 SimpleSign binding [<a class="reference internal" href="#term-saml2simple"><em class="xref std std-term">SAML2Simple</em></a>]).</p>
<p>The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> and the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> independently choose their preferred binding
(subject to the other party&#8217;s desire or ability to comply).
The <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> chooses an HTTP binding to transmit the <strong>&lt;samlp:AuthnRequest&gt;</strong> message
to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>.
Later,
independent of the service provider&#8217;s choice of binding,
the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> chooses an HTTP binding to transmit the <strong>&lt;samlp:Response&gt;</strong> message
to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
The <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> MUST NOT use the HTTP Redirect binding
since the response typically exceeds the <strong>URL length</strong> permitted by most HTTP user agents.</p>
<p>If the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> uses either the HTTP Redirect or HTTP POST binding,
the <strong>&lt;samlp:AuthnRequest&gt;</strong> message is delivered directly to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a>
at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-3"><em>step 3</em></a> (<a class="reference internal" href="#samlhokwebssoprofile-2-6-3"><em>section 2.6.3</em></a>).
If the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> uses the HTTP Artifact binding,
the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> uses the <a class="reference internal" href="glossary.html#term-artifact-resolution-profile"><em class="xref std std-term">Artifact Resolution Profile</em></a> [<a class="reference internal" href="#term-saml2prof"><em class="xref std std-term">SAML2Prof</em></a>]
to make a callback to the service provider to retrieve the <strong>&lt;samlp:AuthnRequest&gt;</strong> message.</p>
<p>Similarly,
if the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> uses the HTTP POST binding,
the <strong>&lt;samlp:Response&gt;</strong> message is delivered directly to the service provider
at <a class="reference internal" href="#samlhokwebssoprofile-2-3-step-5"><em>step.5</em></a> (<a class="reference internal" href="#samlhokwebssoprofile-2-6-5"><em>section 2.6.5</em></a>).
If the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> uses the HTTP Artifact binding,
the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> uses the <a class="reference internal" href="glossary.html#term-artifact-resolution-profile"><em class="xref std std-term">Artifact Resolution Profile</em></a>
to make a callback to the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> to retrieve the <strong>&lt;samlp:Response&gt;</strong> message.</p>
</div>
<div class="section" id="profile-description">
<span id="samlhokwebssoprofile-2-6"></span><h3><a class="toc-backref" href="#id29">2.6 Profile Description</a><a class="headerlink" href="#profile-description" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href=""><em>SAML V2.0 Holder-of-Key Web Browser SSO Profile</em></a> is a profile of
the SAML V2.0 Authentication Request Protocol [<a class="reference internal" href="#term-saml2core"><em class="xref std std-term">SAML2Core</em></a>].
Where this <a class="reference internal" href="glossary.html#term-holder-of-key-web-browser-sso"><em class="xref std std-term">Holder-of-Key Web Browser SSO</em></a> specification conflicts with Core,
the former takes precedence.</p>
<p>If the request is initiated by the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>,
begin with section <a class="reference internal" href="#samlhokwebssoprofile-2-6-1"><em>2.6.1</em></a>.
If the request is initiated by the user agent or a third party,
begin with section <a class="reference internal" href="#samlhokwebssoprofile-2-6-4"><em>2.6.4</em></a>.
If the <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> issues a response without a corresponding request,
begin with <a class="reference internal" href="#samlhokwebssoprofile-2-6-5"><em>section 2.6.5</em></a>.
The descriptions refer to a single sign-on service and assertion consumer service
in accordance with their use described in section 4.1.3 of [<a class="reference internal" href="#term-saml2prof"><em class="xref std std-term">SAML2Prof</em></a>].
Processing rules for all messages are specified in <a class="reference internal" href="#samlhokwebssoprofile-2-7"><em>section 2.7</em></a>  of this profile.</p>
<div class="section" id="http-request-to-service-provider">
<span id="samlhokwebssoprofile-2-6-1"></span><h4><a class="toc-backref" href="#id30">2.6.1 HTTP Request to Service Provider</a><a class="headerlink" href="#http-request-to-service-provider" title="Permalink to this headline">¶</a></h4>
<p>The profile may be initiated by an arbitrary HTTP request to the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a>.
The <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> is free to use any means
it wishes to associate the subsequent interactions with the original request.
For example,
each of the SAML HTTP bindings discussed in <a class="reference internal" href="#samlhokwebssoprofile-2-5"><em>section 2.5</em></a> provides
a <a class="reference internal" href="glossary.html#term-relaystate-mechanism"><em class="xref std std-term">RelayState mechanism</em></a> that the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> MAY use to associate any subsequent exchange
with the original request.</p>
</div>
<div class="section" id="service-provider-determines-identity-provider">
<span id="samlhokwebssoprofile-2-6-2"></span><h4><a class="toc-backref" href="#id31">2.6.2 Service Provider Determines Identity Provider</a><a class="headerlink" href="#service-provider-determines-identity-provider" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> determines the principal&#8217;s preferred identity provider
by any means at its disposal,
including but not limited to the SAML V2.0 Identity Provider Discovery Profile [<a class="reference internal" href="#term-saml2prof"><em class="xref std std-term">SAML2Prof</em></a>]
or the Identity Provider Discovery Service Protocol and Profile [<a class="reference internal" href="#term-idpdisco"><em class="xref std std-term">IDPDisco</em></a>].
If the user agent presents an <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> at the previous step,
the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> MAY use the <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> as a means of discovery.
Use of the <a class="reference internal" href="#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a> in this way is out of scope.
However, see <a class="reference internal" href="#samlhokwebssoprofile-4-2"><em>section 4.2</em></a> for relevant discussion.</p>
</div>
<div class="section" id="service-provider-issues-samlp-authnrequest-to-identity-provider">
<span id="samlhokwebssoprofile-2-6-3"></span><h4><a class="toc-backref" href="#id32">2.6.3 Service Provider issues &lt;samlp:AuthnRequest&gt; to Identity Provider</a><a class="headerlink" href="#service-provider-issues-samlp-authnrequest-to-identity-provider" title="Permalink to this headline">¶</a></h4>
<p>Once an <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> has been selected,
the location of the single sign-on service
to which to send a <strong>&lt;samlp:AuthnRequest&gt;</strong> message is determined based on the SAML binding
chosen by the <a class="reference internal" href="glossary.html#term-service-provider"><em class="xref std std-term">service provider</em></a> ( <a class="reference internal" href="#samlhokwebssoprofile-2-5"><em>section 2.5</em></a>).
Metadata as described in <a class="reference internal" href="#samlhokwebssoprofile-2-8"><em>section 2.8</em></a> MAY be used for this purpose.
Following the HTTP request by the user agent in <a class="reference internal" href="#samlhokwebssoprofile-2-6-1"><em>section 2.6.1</em></a>,
an HTTP response is returned containing a <strong>&lt;samlp:AuthnRequest&gt;</strong> message or an artifact,
depending on the SAML binding used, to be delivered to the identity provider&#8217;s single sign-on service.</p>
<p>Profile-specific rules for the contents of the <strong>&lt;samlp:AuthnRequest&gt;</strong> element are given
in <a class="reference internal" href="#samlhokwebssoprofile-2-7-1"><em>section 2.7.1</em></a>.</p>
</div>
<div class="section" id="samlhokwebssoprofile-2-6-4">
<span id="identity-provider-identifies-principal-and-verifies-key-possession"></span><h4><a class="toc-backref" href="#id33">2.6.4 Identity Provider Identifies Principal and Verifies Key Possession</a><a class="headerlink" href="#samlhokwebssoprofile-2-6-4" title="Permalink to this headline">¶</a></h4>
<p>The identity provider must perform two functions in this step: identify the principal presenting the &lt;samlp:AuthnRequest&gt; message and verify that the principal possesses the private key associated with the public key bound to the presented X.509 certificate. The identity provider subsequently binds X.509 data from the certificate (or the certificate itself) to a &lt;saml:SubjectConfirmation&gt; element.</p>
<p>The identity provider MUST establish the identity of the principal (unless it will return an error) prior to the issuance of the &lt;samlp:Response&gt; message. If the ForceAuthn attribute on the &lt;samlp:AuthnRequest&gt; element is present and true, the identity provider MUST freshly establish this identity rather than relying on any existing session it may have with the principal. Otherwise, and in all other respects, the identity provider may use any means to authenticate the user agent, subject to any requirements called out in the &lt;samlp:AuthnRequest&gt; message. In particular, the identity provider MAY use TLS client authentication to identify the principal. That is, the identity provider MAY validate the presented X.509 certificate as described in [RFC5280], but this is by no means a requirement. See section 2.4 for details.</p>
<p>As described in section 2.4, it is REQUIRED that the &lt;samlp:AuthnRequest&gt; message be presented to the identity provider via an HTTP request over TLS that supplies the identity provider with an X.509 certificate and establishes the user agent&#8217;s possession of the corresponding private key. The certificate resulting from the TLS handshake MUST be used to construct any holder-of-key &lt;saml:SubjectConfirmation&gt; elements in the issued &lt;samlp:Response&gt; element.</p>
<p>Any holder-of-key &lt;saml:SubjectConfirmation&gt; elements included in the response MUST conform to the SAML V2.0 Holder-of-Key Assertion Profile [SAML2HoKAP]. See section 2.7.3 for consequences of this dependency. In addition, note well that the Holder-of-Key Assertion Profile requires that the X.509 certificate obtained as a result of the TLS handshake MUST be known to be associated with the principal (see section 2.4 of [SAML2HoKAP]). Precisely how the identity provider satisfies this requirement is out of scope, but see section 4.3.</p>
<p>If the principal is unable to prove possession of the private key corresponding to the public key in the certificate (via TLS), or the identity provider is unable to retrieve the X.509 certificate resulting from the TLS handshake, the identity provider MUST return an error. Otherwise, the identity provider processes the request following the rules specified in section 2.7.2.</p>
</div>
<div class="section" id="samlhokwebssoprofile-2-6-5">
<span id="identity-provider-issues-samlp-response-to-service-provider"></span><h4><a class="toc-backref" href="#id34">2.6.5 Identity Provider Issues &lt;samlp:Response&gt; to Service Provider</a><a class="headerlink" href="#samlhokwebssoprofile-2-6-5" title="Permalink to this headline">¶</a></h4>
<p>Depending on the SAML binding used (section 2.5), the identity provider returns an HTTP response to the user agent containing a &lt;samlp:Response&gt; message or an artifact, to be delivered to the service provider&#8217;s assertion consumer service. Profile-specific rules regarding the contents of the &lt;samlp:Response&gt; element are included in section 2.7.3.</p>
</div>
<div class="section" id="service-provider-grants-or-denies-access-to-principal">
<span id="samlhokwebssoprofile-2-6-6"></span><h4><a class="toc-backref" href="#id35">2.6.6 Service Provider Grants or Denies Access to Principal</a><a class="headerlink" href="#service-provider-grants-or-denies-access-to-principal" title="Permalink to this headline">¶</a></h4>
<p>As specified in section 2.4, the HTTP request that transports the response issued at the previous step MUST be made over TLS. This supplies proof of possession of the private key and an X.509 certificate to be checked against the X.509 data bound to the assertion&#8217;s &lt;saml:SubjectConfirmation&gt; element. The TLS protocol also maintains the confidentiality and integrity of the message exchange.</p>
<p>If the principal is unable to prove possession of the private key corresponding to the public key in the certificate (via TLS), or the service provider is unable to retrieve the X.509 certificate resulting from the TLS handshake, the subject is not confirmed and the service provider SHOULD NOT create a security context for the principal.</p>
<p>Otherwise, the service provider MUST process the &lt;samlp:Response&gt; message and any enclosed &lt;saml:Assertion&gt; elements as described in [SAML2Core] and section 2.7.4 below. Any subsequent use of the &lt;saml:Assertion&gt; elements is at the discretion of the service provider and other relying parties, subject to any restrictions on use contained within the assertions themselves or previously established out-of-band policy governing interactions between the identity provider and the service provider.</p>
<p>To complete the profile, the service provider creates a security context for the user. The service provider MAY establish a security context with the user agent using any session mechanism it chooses. In particular, the public key or the TLS session key MAY be used to create the security context as discussed in section 2.4.</p>
</div>
</div>
<div class="section" id="samlhokwebssoprofile-2-7">
<span id="id3"></span><h3><a class="toc-backref" href="#id36">2.7</a><a class="headerlink" href="#samlhokwebssoprofile-2-7" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="samlhokwebssoprofile-2-7-1">
<span id="id4"></span><h3><a class="toc-backref" href="#id37">2.7.1</a><a class="headerlink" href="#samlhokwebssoprofile-2-7-1" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="samlhokwebssoprofile-2-8">
<span id="id5"></span><h3><a class="toc-backref" href="#id38">2.8</a><a class="headerlink" href="#samlhokwebssoprofile-2-8" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="samlhokwebssoprofile-4-2">
<span id="id6"></span><h3><a class="toc-backref" href="#id39">4.2</a><a class="headerlink" href="#samlhokwebssoprofile-4-2" title="Permalink to this headline">¶</a></h3>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>