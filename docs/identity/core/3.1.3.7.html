

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.1.3.7. ID Token Validation &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <link rel="stylesheet" href="../static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>3.1.3.7. ID Token Validation</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="id-token-validation">
<h1>3.1.3.7.  ID Token Validation<a class="headerlink" href="#id-token-validation" title="Permalink to this headline">Â¶</a></h1>
<p>Clients MUST validate the ID Token in the Token Response in the following manner:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">If the ID Token is encrypted,
decrypt it using the keys and algorithms that the Client specified
during Registration that the OP was to use to encrypt the ID Token.
If encryption was negotiated with the OP at Registration time
and the ID Token is not encrypted, the RP SHOULD reject it.</p>
</li>
<li><p class="first">The Issuer Identifier for the OpenID Provider
(which is typically obtained during Discovery)
MUST exactly match the value of the iss (issuer) Claim.</p>
</li>
<li><p class="first">The Client MUST validate that the aud (audience)
Claim contains its client_id value registered at the Issuer
identified by the iss (issuer) Claim as an audience.</p>
<p>The aud (audience) Claim MAY contain an array with more than one element.</p>
<p>The ID Token MUST be rejected if the ID Token does not list the Client
as a valid audience,
or if it contains additional audiences not trusted by the Client.</p>
</li>
<li><p class="first">If the ID Token contains multiple audiences,
the Client SHOULD verify that an <a class="reference internal" href="../messages.html#term-azp"><em class="xref std std-term">azp</em></a> Claim is present.</p>
</li>
<li><p class="first">If an <a class="reference internal" href="../messages.html#term-azp"><em class="xref std std-term">azp</em></a> (authorized party) Claim is present,
the Client SHOULD verify that its <a class="reference internal" href="../standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> is the Claim Value.</p>
</li>
<li><p class="first">If the ID Token is received via direct communication
between the Client and the Token Endpoint
(which it is in this flow),
the TLS server validation MAY be used to validate the issuer
in place of checking the token signature.</p>
<p>The Client MUST validate the signature of
all other ID Tokens according to JWS [JWS]
using the algorithm specified in the JWT alg header parameter.</p>
<p>The Client MUST use the keys provided by the Issuer.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value SHOULD be the default of RS256
or the algorithm sent by the Client
in the <a class="reference internal" href="../reg.html#term-id-token-signed-response-alg"><em class="xref std std-term">id_token_signed_response_alg</em></a> parameter
during <tt class="xref doc docutils literal"><span class="pre">Registration</span></tt>.</p>
</li>
<li><p class="first">If the JWT <a class="reference internal" href="../glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter uses a MAC based algorithm
such as HS256, HS384, or HS512,
the octets of the UTF-8 representation of the <a class="reference internal" href="../oauth.html#term-client-secret"><em class="xref std std-term">client_secret</em></a>
corresponding to the <a class="reference internal" href="../standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> contained
in the <a class="reference internal" href="../session.html#term-8"><em class="xref std std-term">aud</em></a> (audience) Claim are used as the key
to validate the signature.</p>
<p>For MAC based algorithms,
the behavior is unspecified if the <a class="reference internal" href="../session.html#term-8"><em class="xref std std-term">aud</em></a> is multi-valued
or if an <a class="reference internal" href="../messages.html#term-azp"><em class="xref std std-term">azp</em></a> value is present that is different than the aud value.</p>
</li>
<li><p class="first">The current time MUST be
before the time represented by the <a class="reference internal" href="../session.html#term-exp"><em class="xref std std-term">exp</em></a> Claim.</p>
</li>
<li><p class="first">The <a class="reference internal" href="../oauth_introspect.html#term-iat"><em class="xref std std-term">iat</em></a> Claim can be used to reject tokens
that were issued too far away from the current time,
limiting the amount of time that nonces need to be stored
to prevent attacks.</p>
<p>The acceptable range is Client specific.</p>
</li>
<li><p class="first">If a <a class="reference internal" href="../standard.html#term-nonce"><em class="xref std std-term">nonce</em></a> value was sent in the Authentication Request,
a nonce Claim MUST be present and its value checked
to verify that it is the same value as the one
that was sent in the Authentication Request.</p>
<p>The Client SHOULD check the <a class="reference internal" href="../standard.html#term-nonce"><em class="xref std std-term">nonce</em></a> value for <a class="reference internal" href="../glossary.html#term-replay-attacks"><em class="xref std std-term">replay attacks</em></a>.</p>
<p>The precise method for detecting replay attacks is Client specific.</p>
</li>
<li><p class="first">If the <a class="reference internal" href="../session.html#term-acr"><em class="xref std std-term">acr</em></a> Claim was requested,
the Client SHOULD check that the asserted Claim Value is appropriate.</p>
<p>The meaning and processing of acr Claim Values is
out of scope for this specification.</p>
</li>
<li><p class="first">If the <a class="reference internal" href="../oauth_auth.html#term-auth-time"><em class="xref std std-term">auth_time</em></a> Claim was requested,
either through a specific request for this Claim
or by using the <a class="reference internal" href="../messages.html#term-89"><em class="xref std std-term">max_age</em></a> parameter,
the Client SHOULD check the <a class="reference internal" href="../oauth_auth.html#term-auth-time"><em class="xref std std-term">auth_time</em></a> Claim value
and request re-authentication
if it determines too much time has elapsed
since the last End-User authentication.</p>
</li>
</ol>
</div></blockquote>
<p>(draft17)</p>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>