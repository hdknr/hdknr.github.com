

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>7.5. Self-Issued ID Token Validation &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <link rel="stylesheet" href="../static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>7.5. Self-Issued ID Token Validation</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="self-issued-id-token-validation">
<h1>7.5.  Self-Issued ID Token Validation<a class="headerlink" href="#self-issued-id-token-validation" title="Permalink to this headline">Â¶</a></h1>
<p>To validate the ID Token received,
the Client MUST do the following:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">The Client MUST validate that
the value of the <a class="reference internal" href="../session.html#term-iss"><em class="xref std std-term">iss</em></a> (issuer) Claim is <a class="reference external" href="https://self-isued.me">https://self-isued.me</a>.</p>
<p>If <a class="reference internal" href="../session.html#term-iss"><em class="xref std std-term">iss</em></a> contains a different value,
the ID Token is not Self-Issued,
and instead it MUST be validated according to Section 3.1.3.7.</p>
</li>
<li><p class="first">The Client MUST validate that
the <a class="reference internal" href="../session.html#term-8"><em class="xref std std-term">aud</em></a> (audience) Claim contains the value of the <a class="reference internal" href="../standard.html#term-redirect-uri"><em class="xref std std-term">redirect_uri</em></a>
that the Client sent in the Authentication Request as an audience.</p>
</li>
<li><p class="first">The Client MUST validate the signature of the ID Token according
to JWS [JWS] using the algorithm specified
in the <a class="reference internal" href="../glossary.html#term-alg"><em class="xref std std-term">alg</em></a> parameter of the JWT header [JWT],
using the key in the sub_jwk Claim;
the key is a bare key in JWK format
(not an X.509 certificate value).</p>
</li>
<li><p class="first">The alg value SHOULD be the default of RS256.
It MAY also be ES256.</p>
</li>
</ol>
<ol class="arabic" start="6">
<li><p class="first">The Client MUST validate that the sub (subject) Claim value
is the base64url encoded SHA-256 hash of the concatenation
of the octets of the UTF-8 representations of the base64url encoded key values
in the <a class="reference internal" href="../messages.html#term-sub-jwk"><em class="xref std std-term">sub_jwk</em></a> Claim.</p>
<p>When the <em class="xref std std-term">kty</em> value is RSA,
the key values n and e are concatenated in that order.</p>
<p>When the kty value is EC, the key values crv, x, and y are concatenated in that order.</p>
</li>
<li><p class="first">The current time MUST be before the time represented by the exp Claim
(possibly allowing for some small leeway to account for clock skew).</p>
</li>
<li><p class="first">The iat Claim can be used to reject tokens that were issued
too far away from the current time,
limiting the amount of time that nonces need to be stored to prevent attacks.</p>
<p>The acceptable range is Client specific.</p>
</li>
<li><p class="first">If a nonce value was sent in the Authentication Request,
a nonce Claim MUST be present and its value of the checked to verify
that it is the same value as the one that was sent in the Authentication Request.</p>
<p>The Client SHOULD check the nonce value for replay attacks.</p>
<p>The precise method for detecting replay attacks is Client specific.</p>
</li>
</ol>
</div></blockquote>
<p>The following is a non-normative example of a base64url decoded Self-Issued ID Token
(with line wraps within values for display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;iss&quot;</span><span class="o">:</span> <span class="s2">&quot;https://self-issued.me&quot;</span><span class="p">,</span>
 <span class="s2">&quot;sub&quot;</span><span class="o">:</span> <span class="s2">&quot;wBy8QvHbPzUnL0x63h13QqvUYcOur1X0cbQpPVRqX5k&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aud&quot;</span><span class="o">:</span> <span class="s2">&quot;https://client.example.org/cb&quot;</span><span class="p">,</span>
 <span class="s2">&quot;nonce&quot;</span><span class="o">:</span> <span class="s2">&quot;n-0S6_WzA2Mj&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span> <span class="mi">1311281970</span><span class="p">,</span>
 <span class="s2">&quot;iat&quot;</span><span class="o">:</span> <span class="mi">1311280970</span><span class="p">,</span>
 <span class="s2">&quot;sub_jwk&quot;</span><span class="o">:</span> <span class="p">{</span>
   <span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
   <span class="s2">&quot;n&quot;</span><span class="o">:</span> <span class="s2">&quot;0vx7agoebGcQSuuPiLJXZptN9nndrQmbXEps2aiAFbWhM78LhWx</span>
<span class="s2">   4cbbfAAtVT86zwu1RK7aPFFxuhDR1L6tSoc_BJECPebWKRXjBZCiFV4n3oknjhMs</span>
<span class="s2">   tn64tZ_2W-5JsGY4Hc5n9yBXArwl93lqt7_RN5w6Cf0h4QyQ5v-65YGjQR0_FDW2</span>
<span class="s2">   QvzqY368QQMicAtaSqzs8KJZgnYb9c7d0zgdAZHzu6qMQvRL5hajrn1n91CbOpbI</span>
<span class="s2">   SD08qNLyrdkt-bFTWhAI4vMQFh6WeZu0fM4lFd2NcRwr3XPksINHaQ-G_xBniIqb</span>
<span class="s2">   w0Ls1jF44-csFCur-kEgU8awapJzKnqDKgw&quot;</span><span class="p">,</span>
   <span class="s2">&quot;e&quot;</span><span class="o">:</span><span class="s2">&quot;AQAB&quot;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(draft17)</p>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>