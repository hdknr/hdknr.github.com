

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6.1. Passing a Request Object by Value &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <link rel="stylesheet" href="../static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>6.1. Passing a Request Object by Value</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="passing-a-request-object-by-value">
<h1>6.1.  Passing a Request Object by Value<a class="headerlink" href="#passing-a-request-object-by-value" title="Permalink to this headline">¶</a></h1>
<p>The request Authorization Request parameter enables
OpenID Connect requests to be passed in a single, self-contained parameter
and to be optionally signed and/or encrypted.</p>
<p>It represents the request as a JWT
whose Claims are the request parameters specified in <a class="reference internal" href="../core.html#core-3-1-2"><em>Section 3.1.2</em></a>.</p>
<p>This JWT is called a Request Object.</p>
<p>Support for the request parameter is OPTIONAL.
The <a class="reference internal" href="../discovery.html#term-request-parameter-supported"><em class="xref std std-term">request_parameter_supported</em></a> <tt class="xref doc docutils literal"><span class="pre">Discovery</span></tt> result
indicates whether the OP supports this parameter.
Should an OP not support this parameter and an RP uses it,
the OP MUST return the <a class="reference internal" href="3.1.2.6.html#term-request-not-supported"><em class="xref std std-term">request_not_supported</em></a> error.</p>
<p>When the request parameter is used,
the OpenID Connect request parameter values contained
in the JWT supersede those passed using the OAuth 2.0 request syntax.</p>
<p>However,
parameters MAY also be passed using the OAuth 2.0 request syntax
even when a Request Object is used;
this would typically be done to enable a cached, pre-signed
(and possibly pre-encrypted) Request Object value
to be used containing the fixed request parameters,
while parameters that can vary with each request,
such as state and nonce,
are passed as OAuth 2.0 parameters.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>request_uri でパラメータを事前共有しても、 nonce, stateは必ず送る事</li>
<li>OPはRequest Objectを処理したあとでAuthReqのパラメータでオーバーライドすること(?)</li>
</ul>
</div>
<p>So that the request is a valid OAuth 2.0 Authorization Request,
values for the <a class="reference internal" href="../standard.html#term-response-type"><em class="xref std std-term">response_type</em></a> and <a class="reference internal" href="../standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> parameters
MUST be included using the OAuth 2.0 request syntax,
since they are REQUIRED by OAuth 2.0.
The values for these parameters MUST match those in the Request Object,
if present.</p>
<p>Even if a <a class="reference internal" href="../uma_core.html#term-scope"><em class="xref std std-term">scope</em></a> parameter is present in the Request Object value,
a <a class="reference internal" href="../uma_core.html#term-scope"><em class="xref std std-term">scope</em></a> parameter MUST always be passed
using the OAuth 2.0 request syntax containing the <strong>openid</strong> scope value
to indicate to the underlying OAuth 2.0 logic
that this is an OpenID Connect request.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>request / request_uri があればOpenID Connectだとわかりそうな気はしますが。。。</li>
</ul>
</div>
<p>The Request Object MAY be signed or unsigned (plaintext).</p>
<p>When it is <strong>plaintext</strong>,
this is indicated by use of the <a class="reference internal" href="../oauth_responses.html#term-none"><em class="xref std std-term">none</em></a> algorithm <a class="reference internal" href="../jws.html#term-jwa"><em class="xref std std-term">[JWA]</em></a>
in the JWS header.</p>
<p>If <strong>signed</strong>,
the Request Object SHOULD contain the Claims
<a class="reference internal" href="../session.html#term-iss"><em class="xref std std-term">iss</em></a> (issuer) and <a class="reference internal" href="../session.html#term-8"><em class="xref std std-term">aud</em></a> (audience) as members.
The <a class="reference internal" href="../session.html#term-iss"><em class="xref std std-term">iss</em></a> value SHOULD be the Client ID of the RP,
unless it was signed by a different party than the RP.
The <a class="reference internal" href="../session.html#term-8"><em class="xref std std-term">aud</em></a> value SHOULD be or include the OP&#8217;s Issuer Identifier URL.</p>
<p>The Request Object MAY also be encrypted using JWE [JWE]
and MAY be encrypted without also being signed.
If both signing and encryption are performed,
it MUST be signed then encrypted,
with the result being a Nested JWT,
as defined in [JWT].</p>
<p><a class="reference internal" href="../standard.html#term-request"><em class="xref std std-term">request</em></a> and <a class="reference internal" href="../standard.html#term-request-uri"><em class="xref std std-term">request_uri</em></a> parameters
MUST NOT be included in Request Objects.</p>
<p>The following is a non-normative example of the Claims
in a Request Object before base64url encoding and signing:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;iss&quot;</span><span class="o">:</span> <span class="s2">&quot;s6BhdRkqt3&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aud&quot;</span><span class="o">:</span> <span class="s2">&quot;https://server.example.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;response_type&quot;</span><span class="o">:</span> <span class="s2">&quot;code id_token&quot;</span><span class="p">,</span>
 <span class="s2">&quot;client_id&quot;</span><span class="o">:</span> <span class="s2">&quot;s6BhdRkqt3&quot;</span><span class="p">,</span>
 <span class="s2">&quot;redirect_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;https://client.example.org/cb&quot;</span><span class="p">,</span>
 <span class="s2">&quot;scope&quot;</span><span class="o">:</span> <span class="s2">&quot;openid&quot;</span><span class="p">,</span>
 <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="s2">&quot;af0ifjsldkj&quot;</span><span class="p">,</span>
 <span class="s2">&quot;nonce&quot;</span><span class="o">:</span> <span class="s2">&quot;n-0S6_WzA2Mj&quot;</span><span class="p">,</span>
 <span class="s2">&quot;max_age&quot;</span><span class="o">:</span> <span class="mi">86400</span><span class="p">,</span>
 <span class="s2">&quot;claims&quot;</span><span class="o">:</span>
  <span class="p">{</span>
   <span class="s2">&quot;userinfo&quot;</span><span class="o">:</span>
    <span class="p">{</span>
     <span class="s2">&quot;given_name&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;essential&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
     <span class="s2">&quot;nickname&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
     <span class="s2">&quot;email&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;essential&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
     <span class="s2">&quot;email_verified&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;essential&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
     <span class="s2">&quot;picture&quot;</span><span class="o">:</span> <span class="kc">null</span>
    <span class="p">},</span>
   <span class="s2">&quot;id_token&quot;</span><span class="o">:</span>
    <span class="p">{</span>
     <span class="s2">&quot;gender&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
     <span class="s2">&quot;birthdate&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;essential&quot;</span><span class="o">:</span> <span class="kc">true</span><span class="p">},</span>
     <span class="s2">&quot;acr&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s2">&quot;values&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;urn:mace:incommon:iap:silver&quot;</span><span class="p">]}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Signing it with the RS256 algorithm results in this Request Object value
(with line wraps within values for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJSUzI1NiIsImtpZCI6ImsyYmRjIn0.ew0KICJpc3MiOiAiczZCaGRSa3
F0MyIsDQogImF1ZCI6ICJodHRwczovL3NlcnZlci5leGFtcGxlLmNvbSIsDQogInJl
c3BvbnNlX3R5cGUiOiAiY29kZSBpZF90b2tlbiIsDQogImNsaWVudF9pZCI6ICJzNk
JoZFJrcXQzIiwNCiAicmVkaXJlY3RfdXJpIjogImh0dHBzOi8vY2xpZW50LmV4YW1w
bGUub3JnL2NiIiwNCiAic2NvcGUiOiAib3BlbmlkIiwNCiAic3RhdGUiOiAiYWYwaW
Zqc2xka2oiLA0KICJub25jZSI6ICJuLTBTNl9XekEyTWoiLA0KICJtYXhfYWdlIjog
ODY0MDAsDQogImNsYWltcyI6IA0KICB7DQogICAidXNlcmluZm8iOiANCiAgICB7DQ
ogICAgICJnaXZlbl9uYW1lIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAgICAgIm5p
Y2tuYW1lIjogbnVsbCwNCiAgICAgImVtYWlsIjogeyJlc3NlbnRpYWwiOiB0cnVlfS
wNCiAgICAgImVtYWlsX3ZlcmlmaWVkIjogeyJlc3NlbnRpYWwiOiB0cnVlfSwNCiAg
ICAgInBpY3R1cmUiOiBudWxsDQogICAgfSwNCiAgICJpZF90b2tlbiI6IA0KICAgIH
sNCiAgICAgImdlbmRlciI6IG51bGwsDQogICAgICJiaXJ0aGRhdGUiOiB7ImVzc2Vu
dGlhbCI6IHRydWV9LA0KICAgICAiYWNyIjogeyJ2YWx1ZXMiOiBbInVybjptYWNlOm
luY29tbW9uOmlhcDpzaWx2ZXIiXX0NCiAgICB9DQogIH0NCn0.nwwnNsk1-Zkbmnvs
F6zTHm8CHERFMGQPhos-EJcaH4Hh-sMgk8ePrGhw_trPYs8KQxsn6R9Emo_wHwajyF
KzuMXZFSZ3p6Mb8dkxtVyjoy2GIzvuJT_u7PkY2t8QU9hjBcHs68PkgjDVTrG1uRTx
0GxFbuPbj96tVuj11pTnmFCUR6IEOXKYr7iGOCRB3btfJhM0_AKQUfqKnRlrRscc8K
ol-cSLWoYE9l5QqholImzjT_cMnNIznW9E7CDyWXTsO70xnB4SkG6pXfLSjLLlxmPG
iyon_-Te111V8uE83IlzCYIb_NMXvtTIVc1jpspnTSD7xMbpL-2QgwUsAlMGzw</pre>
</div>
<p>The following RSA public key,
represented in JWK format,
can be used to validate the Request Object signature in this
and subsequent Request Object examples
(with line wraps within values for display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
 <span class="s2">&quot;kid&quot;</span><span class="o">:</span><span class="s2">&quot;k2bdc&quot;</span><span class="p">,</span>
 <span class="s2">&quot;n&quot;</span><span class="o">:</span><span class="s2">&quot;y9Lqv4fCp6Ei-u2-ZCKq83YvbFEk6JMs_pSj76eMkddWRuWX2aBKGHAtKlE5P</span>
<span class="s2">      7_vn__PCKZWePt3vGkB6ePgzAFu08NmKemwE5bQI0e6kIChtt_6KzT5OaaXDF</span>
<span class="s2">      I6qCLJmk51Cc4VYFaxgqevMncYrzaW_50mZ1yGSFIQzLYP8bijAHGVjdEFgZa</span>
<span class="s2">      ZEN9lsn_GdWLaJpHrB3ROlS50E45wxrlg9xMncVb8qDPuXZarvghLL0HzOuYR</span>
<span class="s2">      adBJVoWZowDNTpKpk2RklZ7QaBO7XDv3uR7s_sf2g-bAjSYxYUGsqkNA9b3xV</span>
<span class="s2">      W53am_UZZ3tZbFTIh557JICWKHlWj5uzeJXaw&quot;</span><span class="p">,</span>
 <span class="s2">&quot;e&quot;</span><span class="o">:</span><span class="s2">&quot;AQAB&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(draft17)</p>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>