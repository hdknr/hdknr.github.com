
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Signature (JWS) : draft28 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="Holder-of-Key JSON Web Signature (JWS)" href="jws_hok.html" />
    <link rel="prev" title="JSON Web Token (JWT) : draft22" href="jwt.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft28</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft22</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">JSON Web Signature (JWS) : draft28</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)(draft28)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft27</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">JSON Web Signature (JWS) : draft28</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1. Introduction</a></li>
<li><a class="reference internal" href="#terminology">2. Terminology</a></li>
<li><a class="reference internal" href="#json-web-signature-jws-overview">3.  JSON Web Signature (JWS) Overview</a><ul>
<li><a class="reference internal" href="#example-jws">3.1. Example JWS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jws-header">4.  JWS Header</a><ul>
<li><a class="reference internal" href="#reserved-header-parameter-names">4.1.  Reserved Header Parameter Names</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter">4.1.1. &#8220;alg&#8221; (Algorithm) Header Parameter</a></li>
<li><a class="reference internal" href="#jku-jwk-set-url-header-parameter">4.1.2.  &#8220;jku&#8221; (JWK Set URL) Header Parameter</a></li>
<li><a class="reference internal" href="#jwk-json-web-key-header-parameter">4.1.3. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a></li>
<li><a class="reference internal" href="#kid-key-id-header-parameter">4.1.4.  &#8220;kid&#8221; (Key ID) Header Parameter</a></li>
<li><a class="reference internal" href="#x5u-x-509-url-header-parameter">4.1.4.  &#8220;x5u&#8221; (X.509 URL) Header Parameter</a></li>
<li><a class="reference internal" href="#x5c-x-509-certificate-chain-header-parameter">4.1.6.  &#8220;x5c&#8221; (X.509 Certificate Chain) Header Parameter</a></li>
<li><a class="reference internal" href="#x5t-x-509-certificate-sha-1-thumbprint-header-parameter">4.1.7.  &#8220;x5t&#8221; (X.509 Certificate SHA-1 Thumbprint) Header Parameter</a></li>
<li><a class="reference internal" href="#x5t-s256-x-509-certificate-sha-256-thumbprint-header-parameter">4.1.8.  &#8220;x5t#S256&#8221; (X.509 Certificate SHA-256 Thumbprint) Header Parameter</a></li>
<li><a class="reference internal" href="#typ-type-header-parameter">4.1.9.  &#8220;typ&#8221; (Type) Header Parameter</a></li>
<li><a class="reference internal" href="#cty-content-type-header-parameter">4.1.10.  &#8220;cty&#8221; (Content Type) Header Parameter</a></li>
<li><a class="reference internal" href="#crit-critical-header-parameter">4.1.11.  &#8220;crit&#8221; (Critical) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-header-parameter-names">4.2.  Public Header Parameter Names</a></li>
<li><a class="reference internal" href="#private-header-parameter-names">4.3.  Private Header Parameter Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#producing-and-consuming-jwss">5.  Producing and Consuming JWSs</a><ul>
<li><a class="reference internal" href="#message-signature-or-mac-computation">5.1.  Message Signature or MAC Computation</a></li>
<li><a class="reference internal" href="#message-signature-or-mac-validation">5.2.  Message Signature or MAC Validation</a></li>
<li><a class="reference internal" href="#string-comparison-rules">5.3.  String Comparison Rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-identification">6.  Key Identification</a></li>
<li><a class="reference internal" href="#serializations">7.  Serializations</a><ul>
<li><a class="reference internal" href="#jws-compact-serialization">7.1.  JWS Compact Serialization</a></li>
<li><a class="reference internal" href="#jws-json-serialization">7.2.  JWS JSON Serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tls-requirements">8.  TLS Requirements</a><ul>
<li><a class="reference internal" href="#unicode-comparison-security-issues">8.1.  Unicode Comparison Security Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations">9.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-header-parameters-registry">9.1.  JSON Web Signature and Encryption Header Parameters Registry</a><ul>
<li><a class="reference internal" href="#registration-template">9.1.1.  Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents">9.1.2.  Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#media-type-registration">9.2.  Media Type Registration</a><ul>
<li><a class="reference internal" href="#registry-contents">9.2.1.  Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations">10.  Security Considerations</a><ul>
<li><a class="reference internal" href="#key-entropy">10.1.  Key Entropy</a></li>
<li><a class="reference internal" href="#chosen-plaintext-attacks">10.2.  Chosen Plaintext Attacks</a></li>
<li><a class="reference internal" href="#timing-attacks">10.3.  Timing Attacks</a></li>
<li><a class="reference internal" href="#differences-between-digital-signatures-and-macs">10.4.  Differences between Digital Signatures and MACs</a></li>
<li><a class="reference internal" href="#sha-1-certificate-thumbprints">10.5.  SHA-1 Certificate Thumbprints</a></li>
<li><a class="reference internal" href="#json-security-considerations">10.6.  JSON Security Considerations</a></li>
<li><a class="reference internal" href="#unicode-comparison-security-considerations">10.7.  Unicode Comparison Security Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">11.  References</a><ul>
<li><a class="reference internal" href="#normative-references">11.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references">11.2.  Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-jws-examples">Appendix A.  JWS Examples</a><ul>
<li><a class="reference internal" href="#a-1-example-jws-using-hmac-sha-256">A.1. Example JWS using HMAC SHA-256</a><ul>
<li><a class="reference internal" href="#a-1-1-encoding">A.1.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-1-2-validating">A.1.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-2-example-jws-using-rsassa-pkcs-v1-5-sha-256">A.2.  Example JWS using RSASSA-PKCS-v1_5 SHA-256</a><ul>
<li><a class="reference internal" href="#a-2-1-encoding">A.2.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-2-2-validating">A.2.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-3-jws-using-ecdsa-p-256-sha-256">A.3.  JWS using ECDSA P-256 SHA-256</a><ul>
<li><a class="reference internal" href="#a-3-1-encoding">A.3.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-3-2-decoding">A.3.2.  Decoding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-4-example-jws-using-ecdsa-p-521-sha-512">A.4.  Example JWS using ECDSA P-521 SHA-512</a><ul>
<li><a class="reference internal" href="#a-4-1-encoding">A.4.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-4-2-validating">A.4.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-5-example-plaintext-jws">A.5.  Example Plaintext JWS</a></li>
<li><a class="reference internal" href="#a-6-example-jws-using-jws-json-serialization">A.6.  Example JWS Using JWS JSON Serialization</a><ul>
<li><a class="reference internal" href="#a-6-1-jws-per-signature-protected-headers">A.6.1.  JWS Per-Signature Protected Headers</a></li>
<li><a class="reference internal" href="#a-6-2-jws-per-signature-unprotected-headers">A.6.2.  JWS Per-Signature Unprotected Headers</a></li>
<li><a class="reference internal" href="#a-6-3-complete-jws-header-values">A.6.3.  Complete JWS Header Values</a></li>
<li><a class="reference internal" href="#a-6-4-complete-jws-json-serialization-representation">A.6.4.  Complete JWS JSON Serialization Representation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-x5c-x-509-certificate-chain-example">Appendix B. &#8220;x5c&#8221; (X.509 Certificate Chain) Example</a></li>
<li><a class="reference internal" href="#appendix-c-notes-on-implementing-base64url-encoding-without-padding">Appendix C.  Notes on implementing base64url encoding without padding</a></li>
<li><a class="reference internal" href="#appendix-d-notes-on-key-selection">Appendix D.  Notes on Key Selection</a></li>
<li><a class="reference internal" href="#appendix-e-negative-test-case-for-crit-header-parameter">Appendix E.  Negative Test Case for &#8220;crit&#8221; Header Parameter</a></li>
<li><a class="reference internal" href="#appendix-f-detached-content">Appendix F.  Detached Content</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="jwt.html"
         title="Previous Chapter: JSON Web Token (JWT) : draft22">&laquo; JSON Web Token (...</a></li>
  <li><a href="jws_hok.html"
         title="Next Chapter: Holder-of-Key JSON Web Signature (JWS)">Holder-of-Key JS... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/jws.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="json-web-signature-jws-draft28">
<span id="jws-head"></span><h1>JSON Web Signature (JWS) : draft28<a class="headerlink" href="#json-web-signature-jws-draft28" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-28">https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-28</a></li>
<li>Security Considerations</li>
</ul>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id3">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id4">1. Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id5">2. Terminology</a></li>
<li><a class="reference internal" href="#json-web-signature-jws-overview" id="id6">3.  JSON Web Signature (JWS) Overview</a><ul>
<li><a class="reference internal" href="#example-jws" id="id7">3.1. Example JWS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jws-header" id="id8">4.  JWS Header</a><ul>
<li><a class="reference internal" href="#reserved-header-parameter-names" id="id9">4.1.  Reserved Header Parameter Names</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter" id="id10">4.1.1. &#8220;alg&#8221; (Algorithm) Header Parameter</a></li>
<li><a class="reference internal" href="#jku-jwk-set-url-header-parameter" id="id11">4.1.2.  &#8220;jku&#8221; (JWK Set URL) Header Parameter</a></li>
<li><a class="reference internal" href="#jwk-json-web-key-header-parameter" id="id12">4.1.3. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a></li>
<li><a class="reference internal" href="#kid-key-id-header-parameter" id="id13">4.1.4.  &#8220;kid&#8221; (Key ID) Header Parameter</a></li>
<li><a class="reference internal" href="#x5u-x-509-url-header-parameter" id="id14">4.1.4.  &#8220;x5u&#8221; (X.509 URL) Header Parameter</a></li>
<li><a class="reference internal" href="#x5c-x-509-certificate-chain-header-parameter" id="id15">4.1.6.  &#8220;x5c&#8221; (X.509 Certificate Chain) Header Parameter</a></li>
<li><a class="reference internal" href="#x5t-x-509-certificate-sha-1-thumbprint-header-parameter" id="id16">4.1.7.  &#8220;x5t&#8221; (X.509 Certificate SHA-1 Thumbprint) Header Parameter</a></li>
<li><a class="reference internal" href="#x5t-s256-x-509-certificate-sha-256-thumbprint-header-parameter" id="id17">4.1.8.  &#8220;x5t#S256&#8221; (X.509 Certificate SHA-256 Thumbprint) Header Parameter</a></li>
<li><a class="reference internal" href="#typ-type-header-parameter" id="id18">4.1.9.  &#8220;typ&#8221; (Type) Header Parameter</a></li>
<li><a class="reference internal" href="#cty-content-type-header-parameter" id="id19">4.1.10.  &#8220;cty&#8221; (Content Type) Header Parameter</a></li>
<li><a class="reference internal" href="#crit-critical-header-parameter" id="id20">4.1.11.  &#8220;crit&#8221; (Critical) Header Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-header-parameter-names" id="id21">4.2.  Public Header Parameter Names</a></li>
<li><a class="reference internal" href="#private-header-parameter-names" id="id22">4.3.  Private Header Parameter Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#producing-and-consuming-jwss" id="id23">5.  Producing and Consuming JWSs</a><ul>
<li><a class="reference internal" href="#message-signature-or-mac-computation" id="id24">5.1.  Message Signature or MAC Computation</a></li>
<li><a class="reference internal" href="#message-signature-or-mac-validation" id="id25">5.2.  Message Signature or MAC Validation</a></li>
<li><a class="reference internal" href="#string-comparison-rules" id="id26">5.3.  String Comparison Rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#key-identification" id="id27">6.  Key Identification</a></li>
<li><a class="reference internal" href="#serializations" id="id28">7.  Serializations</a><ul>
<li><a class="reference internal" href="#jws-compact-serialization" id="id29">7.1.  JWS Compact Serialization</a></li>
<li><a class="reference internal" href="#jws-json-serialization" id="id30">7.2.  JWS JSON Serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#tls-requirements" id="id31">8.  TLS Requirements</a><ul>
<li><a class="reference internal" href="#unicode-comparison-security-issues" id="id32">8.1.  Unicode Comparison Security Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id33">9.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#json-web-signature-and-encryption-header-parameters-registry" id="id34">9.1.  JSON Web Signature and Encryption Header Parameters Registry</a><ul>
<li><a class="reference internal" href="#registration-template" id="id35">9.1.1.  Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents" id="id36">9.1.2.  Initial Registry Contents</a></li>
</ul>
</li>
<li><a class="reference internal" href="#media-type-registration" id="id37">9.2.  Media Type Registration</a><ul>
<li><a class="reference internal" href="#registry-contents" id="id38">9.2.1.  Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id39">10.  Security Considerations</a><ul>
<li><a class="reference internal" href="#key-entropy" id="id40">10.1.  Key Entropy</a></li>
<li><a class="reference internal" href="#chosen-plaintext-attacks" id="id41">10.2.  Chosen Plaintext Attacks</a></li>
<li><a class="reference internal" href="#timing-attacks" id="id42">10.3.  Timing Attacks</a></li>
<li><a class="reference internal" href="#differences-between-digital-signatures-and-macs" id="id43">10.4.  Differences between Digital Signatures and MACs</a></li>
<li><a class="reference internal" href="#sha-1-certificate-thumbprints" id="id44">10.5.  SHA-1 Certificate Thumbprints</a></li>
<li><a class="reference internal" href="#json-security-considerations" id="id45">10.6.  JSON Security Considerations</a></li>
<li><a class="reference internal" href="#unicode-comparison-security-considerations" id="id46">10.7.  Unicode Comparison Security Considerations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id47">11.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id48">11.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id49">11.2.  Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-jws-examples" id="id50">Appendix A.  JWS Examples</a><ul>
<li><a class="reference internal" href="#a-1-example-jws-using-hmac-sha-256" id="id51">A.1. Example JWS using HMAC SHA-256</a><ul>
<li><a class="reference internal" href="#a-1-1-encoding" id="id52">A.1.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-1-2-validating" id="id53">A.1.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-2-example-jws-using-rsassa-pkcs-v1-5-sha-256" id="id54">A.2.  Example JWS using RSASSA-PKCS-v1_5 SHA-256</a><ul>
<li><a class="reference internal" href="#a-2-1-encoding" id="id55">A.2.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-2-2-validating" id="id56">A.2.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-3-jws-using-ecdsa-p-256-sha-256" id="id57">A.3.  JWS using ECDSA P-256 SHA-256</a><ul>
<li><a class="reference internal" href="#a-3-1-encoding" id="id58">A.3.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-3-2-decoding" id="id59">A.3.2.  Decoding</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-4-example-jws-using-ecdsa-p-521-sha-512" id="id60">A.4.  Example JWS using ECDSA P-521 SHA-512</a><ul>
<li><a class="reference internal" href="#a-4-1-encoding" id="id61">A.4.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-4-2-validating" id="id62">A.4.2.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-5-example-plaintext-jws" id="id63">A.5.  Example Plaintext JWS</a></li>
<li><a class="reference internal" href="#a-6-example-jws-using-jws-json-serialization" id="id64">A.6.  Example JWS Using JWS JSON Serialization</a><ul>
<li><a class="reference internal" href="#a-6-1-jws-per-signature-protected-headers" id="id65">A.6.1.  JWS Per-Signature Protected Headers</a></li>
<li><a class="reference internal" href="#a-6-2-jws-per-signature-unprotected-headers" id="id66">A.6.2.  JWS Per-Signature Unprotected Headers</a></li>
<li><a class="reference internal" href="#a-6-3-complete-jws-header-values" id="id67">A.6.3.  Complete JWS Header Values</a></li>
<li><a class="reference internal" href="#a-6-4-complete-jws-json-serialization-representation" id="id68">A.6.4.  Complete JWS JSON Serialization Representation</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-x5c-x-509-certificate-chain-example" id="id69">Appendix B. &#8220;x5c&#8221; (X.509 Certificate Chain) Example</a></li>
<li><a class="reference internal" href="#appendix-c-notes-on-implementing-base64url-encoding-without-padding" id="id70">Appendix C.  Notes on implementing base64url encoding without padding</a></li>
<li><a class="reference internal" href="#appendix-d-notes-on-key-selection" id="id71">Appendix D.  Notes on Key Selection</a></li>
<li><a class="reference internal" href="#appendix-e-negative-test-case-for-crit-header-parameter" id="id72">Appendix E.  Negative Test Case for &#8220;crit&#8221; Header Parameter</a></li>
<li><a class="reference internal" href="#appendix-f-detached-content" id="id73">Appendix F.  Detached Content</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jws-abstract"></span><h2><a class="toc-backref" href="#id3">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>JSON Web Signature (JWS) represents content secured with digital
signatures or Message Authentication Codes (MACs) using JavaScript
Object Notation (JSON) based data structures.  Cryptographic
algorithms and identifiers for use with this specification are
described in the separate JSON Web Algorithms (JWA) specification and
an IANA registry defined by that specification.  Related encryption
capabilities are described in the separate JSON Web Encryption (JWE)
specification.</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="introduction">
<span id="jws-1"></span><h2><a class="toc-backref" href="#id4">1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>JSON Web Signature (JWS) represents content secured with digital
signatures or Message Authentication Codes (MACs) using JavaScript
Object Notation (JSON) [I-D.ietf-json-rfc4627bis] based data
structures.  The JWS cryptographic mechanisms provide integrity
protection for an arbitrary sequence of octets.</p>
<p>Two closely related serializations for JWS objects are defined.  The
JWS Compact Serialization is a compact, URL-safe representation
intended for space constrained environments such as HTTP
Authorization headers and URI query parameters.  The JWS JSON
Serialization represents JWS objects as JSON objects and enables
multiple signatures and/or MACs to be applied to the same content.
Both share the same cryptographic underpinnings.</p>
<p>Cryptographic algorithms and identifiers for use with this
specification are described in the separate JSON Web Algorithms (JWA)
[JWA] specification and an IANA registry defined by that
specification.  Related encryption capabilities are described in the
separate JSON Web Encryption (JWE) [JWE] specification.</p>
<p>Names defined by this specification are short because a core goal is
for the resulting representations to be compact.</p>
</div></blockquote>
<p>(draft20)</p>
</div>
<div class="section" id="terminology">
<span id="jws-2"></span><h2><a class="toc-backref" href="#id5">2. Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-signature-jws">JSON Web Signature (JWS)</dt>
<dd>A data structure representing
a digitally signed or MACed message.</dd>
<dt id="term-jws-header">JWS Header</dt>
<dd><p class="first">JSON object containing the parameters
describing the cryptographic operations
and parameters employed.</p>
<p>The JWS Header members are the union of the members
of the JWS Protected Header
and the JWS Unprotected Header.</p>
<p class="last">The members of the JWS Header are Header Parameters.</p>
</dd>
<dt id="term-jws-payload">JWS Payload</dt>
<dd><p class="first">The sequence of octets to be secured &#8211; a.k.a.,
the message.</p>
<p class="last">The payload can contain an arbitrary sequence of octets.</p>
</dd>
<dt id="term-jws-signature">JWS Signature</dt>
<dd>Digital signature or MAC over the JWS Protected Header
and the JWS Payload.</dd>
<dt id="term-header-parameter">Header Parameter</dt>
<dd>A name/value pair that is member of the JWS Header.</dd>
<dt id="term-jws-protected-header">JWS Protected Header</dt>
<dd><p class="first">JSON object that contains
the JWS Header Parameters that are integrity protected
by the JWS Signature digital signature or MAC operation.</p>
<p>For the JWS Compact Serialization,
this comprises the entire JWS Header.</p>
<p class="last">For the JWS JSON Serialization,
this is one component of the JWS Header.</p>
</dd>
<dt id="term-jws-unprotected-header">JWS Unprotected Header</dt>
<dd><p class="first">JSON object that contains
the JWS Header Parameters that are not integrity protected.</p>
<p class="last">This can only be present
when using the JWS JSON Serialization.</p>
</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd><p class="first">Base64 encoding
using the URL- and filename-safe character set
defined in Section 5 of RFC 4648 [RFC4648],
with all trailing &#8216;=&#8217; characters omitted
(as permitted by Section 3.2).</p>
<p class="last">(See Appendix C for notes on implementing base64url encoding
without padding.)</p>
</dd>
<dt id="term-jws-signing-input">JWS Signing Input</dt>
<dd><p class="first">The input to the digital signature or
MAC computation.</p>
<p class="last">Its value is
ASCII(BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; || BASE64URL(JWS Payload)).</p>
</dd>
<dt id="term-jws-compact-serialization">JWS Compact Serialization</dt>
<dd>A representation of the JWS as a compact,
URL-safe string.</dd>
<dt id="term-jws-json-serialization">JWS JSON Serialization</dt>
<dd><p class="first">A representation of the JWS as a JSON object.</p>
<p>Unlike the JWS Compact Serialization,
the JWS JSON Serialization enables multiple digital signatures
and/or MACs to be applied to the same content.</p>
<p class="last">This representation is neither optimized for
compactness nor URL-safe.</p>
</dd>
<dt id="term-collision-resistant-name">Collision-Resistant Name</dt>
<dd><p class="first">A name in a namespace that enables names to
be allocated in a manner such that
they are highly unlikely to collide with other names.</p>
<p>Examples of collision-resistant namespaces include:
Domain Names,
Object Identifiers (OIDs) as defined in the ITU-T X.660 and
X.670 Recommendation series, and
Universally Unique IDentifiers (UUIDs) [RFC4122].</p>
<p class="last">When using an administratively delegated namespace,
the definer of a name needs to take reasonable precautions
to ensure they are in control of the portion of the namespace
they use to define the name.</p>
</dd>
<dt id="term-stringoruri">StringOrURI</dt>
<dd><p class="first">A JSON string value,
with the additional requirement that while arbitrary string values
MAY be used,
any value containing a &#8221;:&#8221; character MUST be a URI [RFC3986].</p>
<p class="last">StringOrURI values are compared as case-sensitive strings
with no transformations or canonicalizations applied.</p>
</dd>
</dl>
<p>(draft20)</p>
</div>
<div class="section" id="json-web-signature-jws-overview">
<span id="jws-overview"></span><span id="jws-3"></span><h2><a class="toc-backref" href="#id6">3.  JSON Web Signature (JWS) Overview</a><a class="headerlink" href="#json-web-signature-jws-overview" title="Permalink to this headline">¶</a></h2>
<p>JWS represents digitally signed or MACed content
using JSON data structures and base64url encoding.</p>
<p>A JWS represents these logical values:</p>
<dl class="glossary docutils">
<dt id="term-13">JWS Header</dt>
<dd><p class="first">JSON object containing the parameters
describing the cryptographic operations
and parameters employed.</p>
<p class="last">The JWS Header members are the union of the members
of the <a class="reference internal" href="#term-16"><em class="xref std std-term">JWS Protected Header</em></a> and
the <a class="reference internal" href="#term-17"><em class="xref std std-term">JWS Unprotected Header</em></a>, as described below.</p>
</dd>
<dt id="term-14">JWS Payload</dt>
<dd><p class="first">The sequence of octets to be secured &#8211;
a.k.a., the message.</p>
<p class="last">The payload can contain an arbitrary sequence of octets.</p>
</dd>
<dt id="term-15">JWS Signature</dt>
<dd><p class="first">Digital signature or MAC over the JWS Protected Header
and the JWS Payload.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>デジタル署名/MAC</li>
</ul>
</div>
</dd>
</dl>
<p>The JWS Header represents the combination of these values:</p>
<dl class="glossary docutils">
<dt id="term-16">JWS Protected Header</dt>
<dd>JSON object that contains the <a class="reference internal" href="glossary.html#term-jws-header-parameters"><em class="xref std std-term">JWS Header Parameters</em></a>
that are integrity protected by the <a class="reference internal" href="#term-15"><em class="xref std std-term">JWS Signature</em></a>
digital signature or MAC operation.</dd>
<dt id="term-17">JWS Unprotected Header</dt>
<dd>JSON object that contains the <a class="reference internal" href="glossary.html#term-jws-header-parameters"><em class="xref std std-term">JWS Header Parameters</em></a>
that are not integrity protected.</dd>
</dl>
<p>This document defines two serializations for JWS objects:
a compact, URL-safe serialization called the <a class="reference internal" href="#term-jws-compact-serialization"><em class="xref std std-term">JWS Compact Serialization</em></a>
and a JSON serialization called the <a class="reference internal" href="#term-jws-json-serialization"><em class="xref std std-term">JWS JSON Serialization</em></a>.</p>
<p>In both serializations,
the <a class="reference internal" href="#term-16"><em class="xref std std-term">JWS Protected Header</em></a>, <a class="reference internal" href="#term-14"><em class="xref std std-term">JWS Payload</em></a>,
and <a class="reference internal" href="#term-15"><em class="xref std std-term">JWS Signature</em></a> are <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded for transmission,
since JSON lacks a way to directly represent octet sequences.</p>
<p>In the JWS Compact Serialization,
no JWS Unprotected Header is used.</p>
<p>In this case,
the JWS Header and the JWS Protected Header are the same.</p>
<p>In the JWS Compact Serialization,
a JWS object is represented as the combination of these three string values,</p>
<blockquote>
<div><p>BASE64URL(UTF8(JWS Protected Header)),</p>
<p>BASE64URL(JWS Payload), and</p>
<p>BASE64URL(JWS Signature),</p>
</div></blockquote>
<p>concatenated in that order, with the three strings being separated by
two period (&#8216;.&#8217;) characters.</p>
<p>In the JWS JSON Serialization,
one or both of the JWS Protected Header
and JWS Unprotected Header MUST be present.</p>
<p>In this case,
the members of the JWS Header are the combination of the members
of the JWS Protected Header and the JWS Unprotected Header values
that are present.</p>
<p>In the JWS JSON Serialization,
a JWS object is represented as the combination of these four values,</p>
<blockquote>
<div><p>BASE64URL(UTF8(JWS Protected Header)),</p>
<p>JWS Unprotected Header,</p>
<p>BASE64URL(JWS Payload), and</p>
<p>BASE64URL(JWS Signature),</p>
</div></blockquote>
<p>with the three base64url encoding result strings
and the JWS Unprotected Header value being represented as members
within a JSON object.</p>
<p>The inclusion of some of these values is OPTIONAL.
The JWS JSON Serialization can also represent multiple signature
and/or MAC values, rather than just one.</p>
<p>See <em class="xref std std-ref">Section 7.2</em> for more information
about the <a class="reference internal" href="#term-jws-json-serialization"><em class="xref std std-term">JWS JSON Serialization</em></a>.</p>
<p>(draft20)</p>
<div class="section" id="example-jws">
<span id="jws-3-1"></span><h3><a class="toc-backref" href="#id7">3.1. Example JWS</a><a class="headerlink" href="#example-jws" title="Permalink to this headline">¶</a></h3>
<p>The following example JWS Header declares that the encoded object is
a JSON Web Token (JWT) [JWT] and the JWS Header and the JWS Payload
are secured using the HMAC SHA-256 algorithm:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;typ&quot;</span><span class="o">:</span><span class="s2">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JWS
Header yields this Encoded JWS Header value:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The following is an example of a JSON object that can be used as a
JWS Payload.  (Note that the payload can be any content, and need not
be a representation of a JSON object.)</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="s2">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s2">&quot;http://example.com/is_root&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JSON
object yields the following Encoded JWS Payload (with line breaks for
display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt</span>
<span class="nx">cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Computing the HMAC of the bytes of the ASCII [USASCII] representation
of the JWS Secured Input (the concatenation of the Encoded JWS
Header, a period (&#8216;.&#8217;) character, and the Encoded JWS Payload) with
the HMAC SHA-256 algorithm using the key specified in Appendix A.1
and base64url encoding the result yields this Encoded JWS Signature
value:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">dBjftJeZ4CVP</span><span class="o">-</span><span class="nx">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>Concatenating these parts in the order Header.Payload.Signature with
period (&#8216;.&#8217;) characters between the parts yields this complete JWS
representation (with line breaks for display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
<span class="p">.</span>
<span class="nx">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt</span>
<span class="nx">cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
<span class="p">.</span>
<span class="nx">dBjftJeZ4CVP</span><span class="o">-</span><span class="nx">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>This computation is illustrated in more detail in <a class="reference internal" href="#jws-appendix-a-1"><em>Appendix A.1</em></a>.</p>
<p>(draft 06, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-06#section-3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-06#section-3.1</a>)</p>
</div>
</div>
<div class="section" id="jws-header">
<span id="jws-4"></span><h2><a class="toc-backref" href="#id8">4.  JWS Header</a><a class="headerlink" href="#jws-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object(s) representing the JWS Header
describe the <em class="xref std std-term">digital signature</em> or <a class="reference internal" href="jwa.html#term-mac"><em class="xref std std-term">MAC</em></a>
applied to the JWS Protected Header and the JWS Payload
and optionally additional properties of the JWS.</p>
<p>The Header Parameter names within the JWS Header
MUST be unique;
recipients MUST either reject JWSs with duplicate Header Parameter names
or use a JSON parser that returns only the lexically last duplicate member name,
as specified in Section 15.12 (The JSON Object) of ECMAScript 5.1 [ECMAScript].</p>
<p>Implementations are required to understand
the specific Header Parameters defined by this specification
that are designated as &#8220;MUST be understood&#8221;
and process them in the manner defined in this specification.</p>
<p>All other Header Parameters defined by this specification
that are not so designated MUST be ignored when not understood.</p>
<p>Unless listed as a critical Header Parameter,
per <a class="reference internal" href="#jws-4-1-10"><em>Section 4.1.10</em></a>,
all Header Parameters not defined by this specification
MUST be ignored when not understood.</p>
<p>There are three classes of Header Parameter names:
<a class="reference internal" href="#jws-4-1"><em>Registered Header Parameter</em></a> names,
<a class="reference internal" href="#jws-4-2"><em>Public Header Parameter</em></a> names, and
<a class="reference internal" href="#jws-4-3"><em>Private Header Parameter</em></a> names.</p>
<p>(draft21)</p>
<div class="section" id="reserved-header-parameter-names">
<span id="jws-4-1"></span><h3><a class="toc-backref" href="#id9">4.1.  Reserved Header Parameter Names</a><a class="headerlink" href="#reserved-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>The following Header Parameter names are registered in the IANA JSON
Web Signature and Encryption Header Parameters registry defined in
<a class="reference internal" href="#jws-9-1"><em>Section 9.1</em></a>, with meanings as defined below.</p>
<p>As indicated by the common registry, JWSs and JWEs share a common
Header Parameter space; when a parameter is used by both
specifications, its usage must be compatible between the
specifications.</p>
</div></blockquote>
<p>(draft 21)</p>
<div class="section" id="alg-algorithm-header-parameter">
<span id="jws-alg"></span><span id="jws-4-1-1"></span><h4><a class="toc-backref" href="#id10">4.1.1. &#8220;alg&#8221; (Algorithm) Header Parameter</a><a class="headerlink" href="#alg-algorithm-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;alg&#8221; (algorithm) Header Parameter identifies the cryptographic
algorithm used to secure the JWS.</p>
<p>The signature, MAC, or plaintext value is not valid
if the &#8220;alg&#8221; value does not represent a supported algorithm,
or if there is not a key for use with
that algorithm associated with the party that digitally signed or MACed the content.</p>
<p>&#8220;alg&#8221; values should either be registered in the IANA JSON Web Signature
and Encryption Algorithms registry defined in [JWA]
or be a value that contains a Collision-Resistant Name.</p>
<p>The &#8220;alg&#8221; value is a case-sensitive string containing a StringOrURI value.
This Header Parameter MUST be present
and MUST be understood and processed by implementations.</p>
<p>A list of defined &#8220;alg&#8221; values for this use can be found
in the IANA JSON Web Signature and Encryption Algorithms registry
defined in [JWA];
the initial contents of this registry are the values defined in <a class="reference internal" href="jwa.html#jwa-3-1"><em>Section 3.1</em></a>
of the JSON Web Algorithms (JWA) [JWA] specification.</p>
<p>(draft21)</p>
</div>
<div class="section" id="jku-jwk-set-url-header-parameter">
<span id="jws-jku"></span><span id="jws-4-1-2"></span><h4><a class="toc-backref" href="#id11">4.1.2.  &#8220;jku&#8221; (JWK Set URL) Header Parameter</a><a class="headerlink" href="#jku-jwk-set-url-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;jku&#8221; (JWK Set URL) header parameter is a URI [RFC3986] that
refers to a resource for a set of JSON-encoded public keys,
one of which corresponds to the key used to digitally sign the JWS.</p>
<p>The keys MUST be encoded as a <em class="xref std std-term">JSON Web Key Set</em> (<em class="xref std std-term">JWK Set</em>) <a class="reference internal" href="jwe.html#term-66"><em class="xref std std-term">[JWK]</em></a>.</p>
<p>The protocol used to acquire the resource MUST provide integrity protection;
an HTTP GET request to retrieve the JWK Set MUST use TLS [RFC2818] [RFC5246];
the identity of the server MUST be validated, as per Section 3.1 of HTTP Over TLS [RFC2818].</p>
<p>Use of this header parameter is OPTIONAL.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.2</a> )
(draft21)</p>
</div>
<div class="section" id="jwk-json-web-key-header-parameter">
<span id="jws-jwk"></span><span id="jws-4-1-3"></span><h4><a class="toc-backref" href="#id12">4.1.3. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a><a class="headerlink" href="#jwk-json-web-key-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;jwk&#8221; (JSON Web Key) header parameter
is a public key that corresponds to the key used to digitally sign the JWS.</p>
<p>This key is represented as a JSON Web Key <a class="reference internal" href="jwe.html#term-66"><em class="xref std std-term">[JWK]</em></a>.</p>
<p>Use of this Header Parameter is OPTIONAL.</p>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.3</a></li>
</ul>
<p>(draft21)</p>
</div>
<div class="section" id="kid-key-id-header-parameter">
<span id="jws-kid"></span><span id="jws-4-1-4"></span><h4><a class="toc-backref" href="#id13">4.1.4.  &#8220;kid&#8221; (Key ID) Header Parameter</a><a class="headerlink" href="#kid-key-id-header-parameter" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The &#8220;kid&#8221; (key ID) Header Parameter is a hint indicating which key
was used to secure the JWS.  This parameter allows originators to
explicitly signal a change of key to recipients.  The structure of
the &#8220;kid&#8221; value is unspecified.  Its value MUST be a string.  Use of
this Header Parameter is OPTIONAL.</p>
<p>When used with a JWK, the &#8220;kid&#8221; value is used to match a JWK &#8220;kid&#8221;
parameter value.</p>
</div></blockquote>
<p>(draft21)</p>
</div>
<div class="section" id="x5u-x-509-url-header-parameter">
<span id="jws-x5u"></span><span id="jws-4-1-5"></span><h4><a class="toc-backref" href="#id14">4.1.4.  &#8220;x5u&#8221; (X.509 URL) Header Parameter</a><a class="headerlink" href="#x5u-x-509-url-header-parameter" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>証明書、あるいは証明書チェーンを取得するURL</li>
<li><a class="reference internal" href="glossary.html#term-288"><em class="xref std std-term">PEM</em></a></li>
<li>署名に使ったキーの証明書は x509_chain[0]</li>
</ul>
</div>
<p>The &#8220;x5u&#8221; (X.509 URL) header parameter is a URI [RFC3986] that
refers to a resource for the X.509 public key certificate or certificate chain [RFC5280]
corresponding to the key used to digitally sign the JWS.</p>
<p>The identified resource MUST provide
a representation of the certificate or certificate chain
that conforms to RFC 5280 <a class="reference internal" href="jwe.html#term-85"><em class="xref std std-term">[RFC5280]</em></a>
in <a class="reference internal" href="glossary.html#term-288"><em class="xref std std-term">PEM</em></a> encoded form <a class="reference internal" href="jwe.html#term-71"><em class="xref std std-term">[RFC1421]</em></a>.</p>
<p>The certificate containing the public key corresponding to the key
used to digitally sign the JWS MUST be the <strong>first certificate</strong>.</p>
<p>This MAY be followed by additional certificates,
with each subsequent certificate being the one used to certify the previous one.</p>
<p>The protocol used to acquire the resource MUST provide integrity protection;
an HTTP GET request to retrieve the certificate MUST use TLS [RFC2818] [RFC5246];
the identity of the server MUST be validated,
as per Section 3.1 of HTTP Over TLS [RFC2818].</p>
<p>Use of this header parameter is OPTIONAL.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.4</a> )</p>
<p>(draft21)</p>
</div>
<div class="section" id="x5c-x-509-certificate-chain-header-parameter">
<span id="jws-x5c"></span><span id="jws-4-1-6"></span><h4><a class="toc-backref" href="#id15">4.1.6.  &#8220;x5c&#8221; (X.509 Certificate Chain) Header Parameter</a><a class="headerlink" href="#x5c-x-509-certificate-chain-header-parameter" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="simple">
<li>DER 配列</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span> <span class="s">&quot;DER X.509[0]&quot;</span><span class="p">,</span> <span class="s">&quot;DER X.509[1]&quot;</span><span class="p">,</span> <span class="s">&quot;DER X.509[2]&quot;</span> <span class="p">]</span>
</pre></div>
</div>
<ul class="last simple">
<li>DER X.509[0] が署名に使われたキーの証明書</li>
</ul>
</div>
<p>The &#8220;x5c&#8221; (X.509 Certificate Chain) header parameter contains
the X.509 public key certificate or certificate chain [RFC5280]
corresponding to the key used to digitally sign the JWS.</p>
<p>The certificate or certificate chain is represented
as a JSON <strong>array</strong> of certificate value strings.</p>
<p>Each string in the array is a base64 encoded ([RFC4648] Section 4
&#8211; not base64url encoded) <a class="reference internal" href="glossary.html#term-der"><em class="xref std std-term">DER</em></a> [ITU.X690.1994] PKIX certificate value.</p>
<p>The certificate containing the public key corresponding to the key
used to digitally sign the JWS MUST be the first certificate.</p>
<p>This MAY be followed by additional certificates,
with each subsequent certificate
being the one used to certify the previous one.</p>
<p>The recipient MUST verify the certificate chain
according to [RFC5280] and reject the JWS
if any validation failure occurs.</p>
<p>Use of this header parameter is OPTIONAL.</p>
<p>See <a class="reference internal" href="#jws-appendix-b"><em>Appendix B</em></a> for an example &#8220;x5c&#8221; value.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-signature-21#section-4.1.6</a> )</p>
<p>(draft21)</p>
</div>
<div class="section" id="x5t-x-509-certificate-sha-1-thumbprint-header-parameter">
<span id="jws-x5t"></span><span id="jws-4-1-7"></span><h4><a class="toc-backref" href="#id16">4.1.7.  &#8220;x5t&#8221; (X.509 Certificate SHA-1 Thumbprint) Header Parameter</a><a class="headerlink" href="#x5t-x-509-certificate-sha-1-thumbprint-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;x5t&#8221; (X.509 Certificate SHA-1 Thumbprint) Header Parameter is a
base64url encoded SHA-1 thumbprint (a.k.a. digest) of the DER
encoding of the X.509 certificate [RFC5280] corresponding to the key
used to digitally sign the JWS.  Use of this Header Parameter is
OPTIONAL.</p>
<p>If, in the future, certificate thumbprints need to be computed using
hash functions other than SHA-1, it is suggested that additional
related Header Parameters be defined for that purpose.  For example,
it is suggested that a new &#8220;x5t#S256&#8221; (X.509 Certificate Thumbprint
using SHA-256) Header Parameter could be defined by registering it in
the IANA JSON Web Signature and Encryption Header Parameters registry
defined in Section 9.1.</p>
<p>(draft21)</p>
</div>
<div class="section" id="x5t-s256-x-509-certificate-sha-256-thumbprint-header-parameter">
<span id="jws-x5t-s256"></span><span id="jws-4-1-8"></span><h4><a class="toc-backref" href="#id17">4.1.8.  &#8220;x5t#S256&#8221; (X.509 Certificate SHA-256 Thumbprint) Header Parameter</a><a class="headerlink" href="#x5t-s256-x-509-certificate-sha-256-thumbprint-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;x5t#S256&#8221;
(X.509 Certificate SHA-256 Thumbprint) Header Parameter is
a base64url encoded SHA-256 thumbprint (a.k.a. digest)
of the DER encoding of the X.509 certificate [RFC5280]
corresponding to the key used to digitally sign the JWS.</p>
<p>Use of this Header Parameter is OPTIONAL.</p>
<p>(draft27)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft27で追加</li>
</ul>
</div>
</div>
<div class="section" id="typ-type-header-parameter">
<span id="jws-4-1-9"></span><h4><a class="toc-backref" href="#id18">4.1.9.  &#8220;typ&#8221; (Type) Header Parameter</a><a class="headerlink" href="#typ-type-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;typ&#8221; (type) Header Parameter is used to declare the MIME Media
Type [IANA.MediaTypes] of this complete JWS object in contexts where
this is useful to the application.  This parameter has no effect upon
the JWS processing.  Use of this Header Parameter is OPTIONAL.</p>
<p>Per [RFC2045], all media type values, subtype values, and parameter
names are case-insensitive.  However, parameter values are case-
sensitive unless otherwise specified for the specific parameter.</p>
<p>To keep messages compact in common situations, it is RECOMMENDED that
senders omit an &#8220;application/&#8221; prefix of a media type value in a
&#8220;typ&#8221; Header Parameter when no other &#8216;/&#8217; appears in the media type
value.  A recipient using the media type value MUST treat it as if
&#8220;application/&#8221; were prepended to any &#8220;typ&#8221; value not containing a
&#8216;/&#8217;.  For instance, a &#8220;typ&#8221; value of &#8220;example&#8221; SHOULD be used to
represent the &#8220;application/example&#8221; media type; whereas, the media
type &#8220;application/example;part=&#8221;1/2&#8221;&#8221; cannot be shortened to
&#8220;example;part=&#8221;1/2&#8221;&#8221;.</p>
<p>The &#8220;typ&#8221; value &#8220;JOSE&#8221; can be used by applications to indicate that
this object is a JWS or JWE using the JWS Compact Serialization or
the JWE Compact Serialization.  The &#8220;typ&#8221; value &#8220;JOSE+JSON&#8221; can be
used by applications to indicate that this object is a JWS or JWE
using the JWS JSON Serialization or the JWE JSON Serialization.
Other type values can also be used by applications.</p>
<p>(draft27)</p>
</div>
<div class="section" id="cty-content-type-header-parameter">
<span id="jws-cty"></span><span id="jws-4-1-10"></span><h4><a class="toc-backref" href="#id19">4.1.10.  &#8220;cty&#8221; (Content Type) Header Parameter</a><a class="headerlink" href="#cty-content-type-header-parameter" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><em>payload</em> のメディアタイプ</li>
</ul>
</div>
<p>The &#8220;cty&#8221; (content type) Header Parameter is used
to declare the MIME Media Type [IANA.MediaTypes]
of the secured content (the payload)
in contexts where this is useful to the application.</p>
<p>This parameter has no effect upon the JWS processing.
Use of this Header Parameter is OPTIONAL.</p>
<p>Per [RFC2045], all media type values, subtype values, and parameter
names are case-insensitive.  However, parameter values are case-
sensitive unless otherwise specified for the specific parameter.</p>
<p>To keep messages compact in common situations, it is RECOMMENDED that
senders omit an &#8220;application/&#8221; prefix of a media type value in a
&#8220;cty&#8221; Header Parameter when no other &#8216;/&#8217; appears in the media type
value.  A recipient using the media type value MUST treat it as if
&#8220;application/&#8221; were prepended to any &#8220;cty&#8221; value not containing a
&#8216;/&#8217;.  For instance, a &#8220;cty&#8221; value of &#8220;example&#8221; SHOULD be used to
represent the &#8220;application/example&#8221; media type; whereas, the media
type &#8220;application/example;part=&#8221;1/2&#8221;&#8221; cannot be shortened to
&#8220;example;part=&#8221;1/2&#8221;&#8221;.</p>
<p>(draft27)</p>
</div>
<div class="section" id="crit-critical-header-parameter">
<span id="jws-crit"></span><span id="jws-4-1-11"></span><h4><a class="toc-backref" href="#id20">4.1.11.  &#8220;crit&#8221; (Critical) Header Parameter</a><a class="headerlink" href="#crit-critical-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;crit&#8221; (critical) Header Parameter indicates that extensions to
the initial RFC versions of [[ this specification ]] and [JWA] are
being used that MUST be understood and processed.  Its value is an
array listing the Header Parameter names present in the JWS Header
that use those extensions.  If any of the listed extension Header
Parameters are not understood and supported by the receiver, it MUST
reject the JWS.  Senders must not include Header Parameter names
defined by the initial RFC versions of [[ this specification ]] or
[JWA] for use with JWS, duplicate names, or names that do not occur
as Header Parameter names within the JWS Header in the &#8220;crit&#8221; list.
Senders MUST not use the empty list &#8220;[]&#8221; as the &#8220;crit&#8221; value.
Recipients MAY reject the JWS if the critical list contains any
Header Parameter names defined by the initial RFC versions of [[ this
specification ]] or [JWA] for use with JWS, or any other constraints
on its use are violated.  This Header Parameter MUST be integrity
protected, and therefore MUST occur only within the JWS Protected
Header, when used.  Use of this Header Parameter is OPTIONAL.  This
Header Parameter MUST be understood and processed by implementations.</p>
<p>An example use, along with a hypothetical &#8220;exp&#8221; (expiration-time)
field is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ES256&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crit&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;exp&quot;</span><span class="p">],</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1363284000</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="public-header-parameter-names">
<span id="jws-4-2"></span><h3><a class="toc-backref" href="#id21">4.2.  Public Header Parameter Names</a><a class="headerlink" href="#public-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>Additional Header Parameter names can be defined by those using JWSs.
However, in order to prevent collisions, any new Header Parameter
name should either be registered in the IANA JSON Web Signature and
Encryption Header Parameters registry defined in Section 9.1 or be a
Public Name: a value that contains a Collision-Resistant Name.  In
each case, the definer of the name or value needs to take reasonable
precautions to make sure they are in control of the part of the
namespace they use to define the Header Parameter name.</p>
<p>New Header Parameters should be introduced sparingly, as they can
result in non-interoperable JWSs.</p>
<p>(draft27)</p>
</div>
<div class="section" id="private-header-parameter-names">
<span id="jws-4-3"></span><h3><a class="toc-backref" href="#id22">4.3.  Private Header Parameter Names</a><a class="headerlink" href="#private-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>A producer and consumer of a JWS may agree to use Header Parameter
names that are Private Names: names that are not Registered Header
Parameter names Section 4.1 or Public Header Parameter names
Section 4.2.  Unlike Public Header Parameter names, Private Header
Parameter names are subject to collision and should be used with
caution.</p>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="producing-and-consuming-jwss">
<span id="jws-rules"></span><span id="jws-5"></span><h2><a class="toc-backref" href="#id23">5.  Producing and Consuming JWSs</a><a class="headerlink" href="#producing-and-consuming-jwss" title="Permalink to this headline">¶</a></h2>
<p>(draft27)</p>
<div class="section" id="message-signature-or-mac-computation">
<span id="jws-5-1"></span><h3><a class="toc-backref" href="#id24">5.1.  Message Signature or MAC Computation</a><a class="headerlink" href="#message-signature-or-mac-computation" title="Permalink to this headline">¶</a></h3>
<p>To create a JWS, one MUST perform these steps.  The order of the
steps is not significant in cases where there are no dependencies
between the inputs and outputs of the steps.</p>
<ol class="arabic simple">
<li>Create the content to be used as the JWS Payload.</li>
<li>Compute the encoded payload value BASE64URL(JWS Payload).</li>
<li>Create the JSON object(s) containing the desired set of Header
Parameters, which together comprise the JWS Header: the JWS
Protected Header, and if the JWS JSON Serialization is being
used, the JWS Unprotected Header.</li>
<li>Compute the encoded header value BASE64URL(UTF8(JWS Protected
Header)).  If the JWS Protected Header is not present (which can
only happen when using the JWS JSON Serialization and no
&#8220;protected&#8221; member is present), let this value be the empty
string.</li>
<li>Compute the JWS Signature in the manner defined for the
particular algorithm being used over the JWS Signing Input
ASCII(BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; ||
BASE64URL(JWS Payload)).  The &#8220;alg&#8221; (algorithm) Header Parameter
MUST be present in the JWS Header, with the algorithm value
accurately representing the algorithm used to construct the JWS
Signature.</li>
<li>Compute the encoded signature value BASE64URL(JWS Signature).</li>
<li>These three encoded values are used in both the JWS Compact
Serialization and the JWS JSON Serialization representations.</li>
<li>If the JWS JSON Serialization is being used, repeat this process
(steps 3-7) for each digital signature or MAC operation being
performed.</li>
<li>Create the desired serialized output.  The JWS Compact
Serialization of this result is BASE64URL(UTF8(JWS Protected
Header)) || &#8216;.&#8217; || BASE64URL(JWS Payload) || &#8216;.&#8217; || BASE64URL(JWS
Signature).  The JWS JSON Serialization is described in
Section 7.2.</li>
</ol>
<p>(draft27)</p>
</div>
<div class="section" id="message-signature-or-mac-validation">
<span id="jws-5-2"></span><h3><a class="toc-backref" href="#id25">5.2.  Message Signature or MAC Validation</a><a class="headerlink" href="#message-signature-or-mac-validation" title="Permalink to this headline">¶</a></h3>
<p>When validating a JWS, the following steps MUST be taken.  The order
of the steps is not significant in cases where there are no
dependencies between the inputs and outputs of the steps.  If any of
the listed steps fails, then the signature or MAC cannot be
validated.</p>
<p>It is an application decision which signatures, MACs, or plaintext
values must successfully validate for the JWS to be accepted.  In
some cases, all must successfully validate or the JWS will be
rejected.  In other cases, only a specific signature, MAC, or
plaintext value needs to be successfully validated.  However, in all
cases, at least one signature, MAC, or plaintext value MUST
successfully validate or the JWS MUST be rejected.</p>
<ol class="arabic simple">
<li>Parse the JWS representation to extract the serialized values
for the components of the JWS &#8211; when using the JWS Compact
Serialization, the base64url encoded representations of the JWS
Protected Header, the JWS Payload, and the JWS Signature, and
when using the JWS JSON Serialization, also the unencoded JWS
Unprotected Header value.  When using the JWS Compact
Serialization, the JWS Protected Header, the JWS Payload, and
the JWS Signature are represented as base64url encoded values in
that order, separated by two period (&#8216;.&#8217;) characters.  The JWS
JSON Serialization is described in Section 7.2.</li>
<li>The encoded representation of the JWS Protected Header MUST be
successfully base64url decoded following the restriction that no
padding characters have been used.</li>
<li>The resulting octet sequence MUST be a UTF-8 encoded
representation of a completely valid JSON object conforming to
[RFC7159], which is the JWS Protected Header.</li>
<li>If using the JWS Compact Serialization, let the JWS Header be
the JWS Protected Header; otherwise, when using the JWS JSON
Serialization, let the JWS Header be the union of the members of
the corresponding JWS Protected Header and JWS Unprotected
Header, all of which must be completely valid JSON objects.</li>
<li>The resulting JWS Header MUST NOT contain duplicate Header
Parameter names.  When using the JWS JSON Serialization, this
restriction includes that the same Header Parameter name also
MUST NOT occur in distinct JSON object values that together
comprise the JWS Header.</li>
<li>Verify that the implementation understands and can process all
fields that it is required to support, whether required by this
specification, by the algorithm being used, or by the &#8220;crit&#8221;
Header Parameter value, and that the values of those parameters
are also understood and supported.</li>
<li>The encoded representation of the JWS Payload MUST be
successfully base64url decoded following the restriction that no
padding characters have been used.</li>
<li>The encoded representation of the JWS Signature MUST be
successfully base64url decoded following the restriction that no
padding characters have been used.</li>
<li>The JWS Signature MUST be successfully validated against the JWS
Signing Input ASCII(BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217;
|| BASE64URL(JWS Payload)) in the manner defined for the
algorithm being used, which MUST be accurately represented by
the value of the &#8220;alg&#8221; (algorithm) Header Parameter, which MUST
be present.</li>
<li>If the JWS JSON Serialization is being used, repeat this process
(steps 4-9) for each digital signature or MAC value contained in
the representation.</li>
</ol>
<p>(draft27)</p>
</div>
<div class="section" id="string-comparison-rules">
<span id="jws-5-3"></span><h3><a class="toc-backref" href="#id26">5.3.  String Comparison Rules</a><a class="headerlink" href="#string-comparison-rules" title="Permalink to this headline">¶</a></h3>
<p>Processing a JWS inevitably requires comparing known strings
to members and values in a JSON object.</p>
<p>For example,
in checking what the algorithm is,
the Unicode string &#8220;alg&#8221; will be checked against the member names
in the JWS Header to see
if there is a matching Header Parameter name.</p>
<p>The same process is then used to determine
if the value of the &#8220;alg&#8221; Header Parameter represents
a supported algorithm.</p>
<p>Since the only string comparison operations that are performed
are equality and inequality,
the same rules can be used for comparing
both member names and member values against known strings.</p>
<p>The JSON rules for doing member name comparison
are described in Section 8.3 of [RFC7159].</p>
<p>Also,
see the JSON security considerations in <a class="reference internal" href="#jws-10"><em>Section 10</em></a>.
2 and the Unicode security considerations in <a class="reference internal" href="#jws-10-3"><em>Section 10.3</em></a>.</p>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="key-identification">
<span id="jws-6"></span><h2><a class="toc-backref" href="#id27">6.  Key Identification</a><a class="headerlink" href="#key-identification" title="Permalink to this headline">¶</a></h2>
<p>It is necessary for the recipient of a JWS
to be able to determine the key that was employed
for the digital signature or MAC operation.</p>
<p>The key employed can be identified using the Header Parameter methods
described in <a class="reference internal" href="#jws-4-1"><em>Section 4.1</em></a>
or can be identified using methods that are outside the scope of this specification.</p>
<p>Specifically,
the Header Parameters &#8220;jku&#8221;, &#8220;jwk&#8221;, &#8220;kid&#8221;, &#8220;x5u&#8221;, &#8220;x5c&#8221;, &#8220;x5t&#8221;, and &#8220;x5t#S256&#8221;
can be used to identify the key used.  These Header Parameters MUST
be integrity protected if the information that they convey is to be
utilized in a trust decision.</p>
<p>The sender SHOULD include sufficient information
in the Header Parameters to identify the key used,
unless the application uses another means or convention to determine the key used.</p>
<p>Validation of the signature or MAC fails
when the algorithm used requires a key
(which is true of all algorithms except for &#8220;none&#8221;)
and the key used cannot be determined.</p>
<p>The means of exchanging any shared symmetric keys used is
outside the scope of this specification.</p>
<p>Also,
see <a class="reference internal" href="#jws-appendix-d"><em>Appendix D</em></a> for notes on possible key selection algorithms.</p>
<p>(draft27)</p>
</div>
<div class="section" id="serializations">
<span id="jws-serialization"></span><span id="jws-7"></span><h2><a class="toc-backref" href="#id28">7.  Serializations</a><a class="headerlink" href="#serializations" title="Permalink to this headline">¶</a></h2>
<p>JWS objects use one of two serializations, the JWS Compact
Serialization or the JWS JSON Serialization.  Applications using this
specification need to specify what serialization and serialization
features are used for that application.  For instance, applications
might specify that only the JWS JSON Serialization is used, that only
JWS JSON Serialization support for a single signature or MAC value is
used, or that support for multiple signatures and/or MAC values is
used.  JWS implementations only need to implement the features needed
for the applications they are designed to support.</p>
<p>(draft27)</p>
<div class="section" id="jws-compact-serialization">
<span id="jws-7-1"></span><span id="id1"></span><h3><a class="toc-backref" href="#id29">7.1.  JWS Compact Serialization</a><a class="headerlink" href="#jws-compact-serialization" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="simple">
<li>１個の署名のみ可能</li>
</ul>
<div class="last highlight-python"><pre>{{ BASE64URL(UTF8(JWS Protected Header)) }}.{{ BASE64URL(JWS Payload) }}.{{ BASE64URL(JWS Signature) }}</pre>
</div>
</div>
<p>The JWS Compact Serialization represents digitally signed or MACed content
as a compact URL-safe string.</p>
<p>This string is
BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; || BASE64URL(JWS Payload) || &#8216;.&#8217; || BASE64URL(JWS Signature).
Only one signature/MAC is supported by the JWS Compact Serialization
and it provides no syntax to represent a <a class="reference internal" href="#term-17"><em class="xref std std-term">JWS Unprotected Header</em></a> value.</p>
<p>(draft21)</p>
</div>
<div class="section" id="jws-json-serialization">
<span id="jws-7-2"></span><span id="id2"></span><h3><a class="toc-backref" href="#id30">7.2.  JWS JSON Serialization</a><a class="headerlink" href="#jws-json-serialization" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>例</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="p">{</span>
    <span class="s">&quot;payload&quot;</span><span class="p">:</span> <span class="s">&quot;{{ BASE64URL(Jws Payload) }}&quot;</span><span class="p">,</span>
    <span class="s">&quot;signatures&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s">&quot;protected&quot;</span><span class="p">:</span> <span class="s">&quot;{{ BASE64URL(UTF8(JWS Protected Header[0])) }}&quot;</span><span class="p">,</span>
            <span class="s">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;kid&quot;</span><span class="p">:</span> <span class="s">&quot;0&quot;</span><span class="p">},</span>
            <span class="s">&quot;signature&quot;</span><span class="p">:</span> <span class="s">&quot;{{ BASE64URL(JWS Signature[0]) }}&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s">&quot;protected&quot;</span><span class="p">:</span> <span class="s">&quot;{{ BASE64URL(UTF8(JWS Protected Header[1])) }}&quot;</span><span class="p">,</span>
            <span class="s">&quot;header&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s">&quot;kid&quot;</span><span class="p">:</span> <span class="s">&quot;1&quot;</span><span class="p">},</span>
            <span class="s">&quot;signature&quot;</span><span class="p">:</span> <span class="s">&quot;{{ BASE64URL(JWS Signature[1]) }}&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="#jws-json-serialization"><em>JWS JSON Serialization</em></a> represents
digitally signed or MACed content as a JSON object.</p>
<p>Content using the JWS JSON Serialization
can be secured with more than one digital signature
and/or MAC operation.</p>
<p>This representation is neither optimized for compactness nor URL-safe.</p>
<p>The following members are defined for use in top-level JSON objects
used for the JWS JSON Serialization:</p>
<dl class="glossary docutils">
<dt id="term-payload">payload</dt>
<dd>The &#8220;payload&#8221; member MUST be present and contain the value
BASE64URL(JWS Payload).</dd>
<dt id="term-signatures">signatures</dt>
<dd>The &#8220;signatures&#8221; member value MUST be an array of JSON objects.
Each object represents a signature or MAC
over the JWS Payload and the JWS Protected Header.</dd>
</dl>
<p>The following members are defined for use
in the JSON objects that are elements of the &#8220;<a class="reference internal" href="#term-signatures"><em class="xref std std-term">signatures</em></a>&#8221; array:</p>
<dl class="glossary docutils">
<dt id="term-protected">protected</dt>
<dd><p class="first">The &#8220;protected&#8221; member MUST be present
and contain the value BASE64URL(UTF8(JWS Protected Header))
when the JWS Protected Header value is non-empty;
otherwise, it MUST be absent.</p>
<p class="last">These Header Parameter values are integrity protected.</p>
</dd>
<dt id="term-header">header</dt>
<dd><p class="first">The &#8220;header&#8221; member MUST be present
and contain the value JWS Unprotected Header
when the JWS Unprotected Header value is non-empty;
otherwise, it MUST be absent.</p>
<p>This value is represented as an unencoded JSON object,
rather than as a string.</p>
<p class="last">These Header Parameter values are not integrity protected.</p>
</dd>
<dt id="term-signature">signature</dt>
<dd>The &#8220;signature&#8221; member MUST be present
and contain the value BASE64URL(JWS Signature).</dd>
</dl>
<p>At least one of the &#8220;protected&#8221; and &#8220;header&#8221; members MUST be present
for each signature/MAC computation so that an &#8220;alg&#8221; Header Parameter
value is conveyed.</p>
<p>Additional members can be present in both the JSON objects defined
above; if not understood by implementations encountering them, they
MUST be ignored.</p>
<p>The Header Parameter values used when creating or validating
individual signature or MAC values are the union of the two sets of
Header Parameter values that may be present: (1) the JWS Protected
Header represented in the &#8220;protected&#8221; member of the signature/MAC&#8217;s
array element, and (2) the JWS Unprotected Header in the &#8220;header&#8221;
member of the signature/MAC&#8217;s array element.  The union of these sets
of Header Parameters comprises the JWS Header.  The Header Parameter
names in the two locations MUST be disjoint.</p>
<p>Each JWS Signature value is computed using the parameters of the
corresponding JWS Header value in the same manner as for the JWS
Compact Serialization.  This has the desirable property that each JWS
Signature value represented in the &#8220;signatures&#8221; array is identical to
the value that would have been computed for the same parameter in the
JWS Compact Serialization, provided that the JWS Protected Header
value for that signature/MAC computation (which represents the
integrity-protected Header Parameter values) matches that used in the
JWS Compact Serialization.</p>
<p>In summary, the syntax of a JWS using the JWS JSON Serialization is
as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
 <span class="s2">&quot;payload&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;payload contents&gt;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;signatures&quot;</span><span class="o">:</span><span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;protected&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;integrity-protected header 1 contents&gt;&quot;</span><span class="p">,</span>
   <span class="s2">&quot;header&quot;</span><span class="o">:&lt;</span><span class="nx">non</span><span class="o">-</span><span class="nx">integrity</span><span class="o">-</span><span class="kr">protected</span> <span class="nx">header</span> <span class="mi">1</span> <span class="nx">contents</span><span class="o">&gt;</span><span class="p">,</span>
   <span class="s2">&quot;signature&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;signature 1 contents&gt;&quot;</span><span class="p">},</span>
  <span class="p">...</span>
  <span class="p">{</span><span class="s2">&quot;protected&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;integrity-protected header N contents&gt;&quot;</span><span class="p">,</span>
   <span class="s2">&quot;header&quot;</span><span class="o">:&lt;</span><span class="nx">non</span><span class="o">-</span><span class="nx">integrity</span><span class="o">-</span><span class="kr">protected</span> <span class="nx">header</span> <span class="nx">N</span> <span class="nx">contents</span><span class="o">&gt;</span><span class="p">,</span>
   <span class="s2">&quot;signature&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;signature N contents&gt;&quot;</span><span class="p">}]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>See Appendix A.6 for an example of computing a JWS using the JWS JSON
Serialization.</p>
<p>(draft21)</p>
</div>
</div>
<div class="section" id="tls-requirements">
<span id="jws-8"></span><h2><a class="toc-backref" href="#id31">8.  TLS Requirements</a><a class="headerlink" href="#tls-requirements" title="Permalink to this headline">¶</a></h2>
<p>Implementations MUST support TLS.  Which version(s) ought to be
implemented will vary over time, and depend on the widespread
deployment and known security vulnerabilities at the time of
implementation.  At the time of this writing, TLS version 1.2
[RFC5246] is the most recent version.</p>
<p>To protect against information disclosure and tampering,
confidentiality protection MUST be applied using TLS with a
ciphersuite that provides confidentiality and integrity protection.</p>
<p>Whenever TLS is used, the identity of the service provider encoded in
the TLS server certificate MUST be verified using the procedures
described in Section 6 of RFC 6125 [RFC6125].</p>
<p>(draft27)</p>
<div class="section" id="unicode-comparison-security-issues">
<span id="jws-8-1"></span><h3><a class="toc-backref" href="#id32">8.1.  Unicode Comparison Security Issues</a><a class="headerlink" href="#unicode-comparison-security-issues" title="Permalink to this headline">¶</a></h3>
<p>Header parameter names in JWSs are Unicode strings. For security reasons, the representations of these names must be compared verbatim after performing any escape processing (as per RFC 4627 [RFC4627], Section 2.5).</p>
<p>This means, for instance, that these JSON strings must compare as being equal (&#8220;sig&#8221;, &#8220;u0073ig&#8221;), whereas these must all compare as being not equal to the first set or to each other (&#8220;SIG&#8221;, &#8220;Sig&#8221;, &#8220;siu0047&#8221;).</p>
<p>JSON strings MAY contain characters outside the Unicode Basic Multilingual Plane. For instance, the G clef character (U+1D11E) may be represented in a JSON string as &#8220;uD834uDD1E&#8221;. Ideally, JWS implementations SHOULD ensure that characters outside the Basic Multilingual Plane are preserved and compared correctly; alternatively, if this is not possible due to these characters exercising limitations present in the underlying JSON implementation, then input containing them MUST be rejected.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jws-9"></span><h2><a class="toc-backref" href="#id33">9.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>The following registration procedure is used for all the registries
established by this specification.</p>
<p>Values are registered with a Specification Required [RFC5226] after a
two-week review period on the [TBD]&#64;ietf.org mailing list, on the
advice of one or more Designated Experts.  However, to allow for the
allocation of values prior to publication, the Designated Expert(s)
may approve registration once they are satisfied that such a
specification will be published.</p>
<p>Registration requests must be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject (e.g., &#8220;Request
for access token type: example&#8221;). [[ Note to the RFC Editor: The name
of the mailing list should be determined in consultation with the
IESG and IANA.  Suggested name: jose-reg-review. ]]</p>
<p>Within the review period, the Designated Expert(s) will either
approve or deny the registration request, communicating this decision
to the review list and IANA.  Denials should include an explanation
and, if applicable, suggestions as to how to make the request
successful.  Registration requests that are undetermined for a period
longer than 21 days can be brought to the IESG&#8217;s attention (using the
<a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list) for resolution.</p>
<p>Criteria that should be applied by the Designated Expert(s) includes
determining whether the proposed registration duplicates existing
functionality, determining whether it is likely to be of general
applicability or whether it is useful only for a single application,
and whether the registration makes sense.</p>
<p>IANA must only accept registry updates from the Designated Expert(s)
and should direct all requests for registration to the review mailing
list.</p>
<p>It is suggested that multiple Designated Experts be appointed who are
able to represent the perspectives of different applications using
this specification, in order to enable broadly-informed review of
registration decisions.  In cases where a registration decision could
be perceived as creating a conflict of interest for a particular
Expert, that Expert should defer to the judgment of the other
Expert(s).</p>
<p>(draft27)</p>
<div class="section" id="json-web-signature-and-encryption-header-parameters-registry">
<span id="jws-9-1"></span><h3><a class="toc-backref" href="#id34">9.1.  JSON Web Signature and Encryption Header Parameters Registry</a><a class="headerlink" href="#json-web-signature-and-encryption-header-parameters-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the IANA JSON Web Signature and
Encryption Header Parameters registry for JWS and JWE Header
Parameter names.  The registry records the Header Parameter name and
a reference to the specification that defines it.  The same Header
Parameter name can be registered multiple times, provided that the
parameter usage is compatible between the specifications.  Different
registrations of the same Header Parameter name will typically use
different Header Parameter Usage Location(s) values.</p>
<p>(draft27)</p>
<div class="section" id="registration-template">
<span id="jws-9-1-1"></span><h4><a class="toc-backref" href="#id35">9.1.1.  Registration Template</a><a class="headerlink" href="#registration-template" title="Permalink to this headline">¶</a></h4>
<dl class="docutils">
<dt>Header Parameter Name:</dt>
<dd>The name requested (e.g., &#8220;example&#8221;).  Because a core goal of this
specification is for the resulting representations to be compact,
it is RECOMMENDED that the name be short &#8211; not to exceed 8
characters without a compelling reason to do so.  This name is
case-sensitive.  Names may not match other registered names in a
case-insensitive manner unless the Designated Expert(s) state that
there is a compelling reason to allow an exception in this
particular case.</dd>
<dt>Header Parameter Description:</dt>
<dd>Brief description of the Header Parameter (e.g., &#8220;Example
description&#8221;).</dd>
<dt>Header Parameter Usage Location(s):</dt>
<dd>The Header Parameter usage locations, which should be one or more
of the values &#8220;JWS&#8221; or &#8220;JWE&#8221;.</dd>
<dt>Change Controller:</dt>
<dd>For Standards Track RFCs, state &#8220;IESG&#8221;.  For others, give the name
of the responsible party.  Other details (e.g., postal address,
email address, home page URI) may also be included.</dd>
<dt>Specification Document(s):</dt>
<dd>Reference to the document(s) that specify the parameter,
preferably including URI(s) that can be used to retrieve copies of
the document(s).  An indication of the relevant sections may also
be included but is not required.</dd>
</dl>
<p>(draft27)</p>
</div>
<div class="section" id="initial-registry-contents">
<span id="jws-9-1-2"></span><h4><a class="toc-backref" href="#id36">9.1.2.  Initial Registry Contents</a><a class="headerlink" href="#initial-registry-contents" title="Permalink to this headline">¶</a></h4>
<p>This specification registers the Header Parameter names defined in
Section 4.1 in this registry.</p>
<p>o  Header Parameter Name: &#8220;alg&#8221;
o  Header Parameter Description: Algorithm
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.1 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;jku&#8221;
o  Header Parameter Description: JWK Set URL
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.2 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;jwk&#8221;
o  Header Parameter Description: JSON Web Key
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification document(s): Section 4.1.3 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;kid&#8221;
o  Header Parameter Description: Key ID
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.4 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;x5u&#8221;
o  Header Parameter Description: X.509 URL
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.5 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;x5c&#8221;
o  Header Parameter Description: X.509 Certificate Chain
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.6 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;x5t&#8221;
o  Header Parameter Description: X.509 Certificate SHA-1 Thumbprint
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.7 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;x5t#S256&#8221;
o  Header Parameter Description: X.509 Certificate SHA-256 Thumbprint
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.8 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;typ&#8221;
o  Header Parameter Description: Type
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.9 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;cty&#8221;
o  Header Parameter Description: Content Type
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.10 of [[ this document ]]</p>
<p>o  Header Parameter Name: &#8220;crit&#8221;
o  Header Parameter Description: Critical
o  Header Parameter Usage Location(s): JWS
o  Change Controller: IESG
o  Specification Document(s): Section 4.1.11 of [[ this document ]]</p>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="media-type-registration">
<span id="jws-9-2"></span><h3><a class="toc-backref" href="#id37">9.2.  Media Type Registration</a><a class="headerlink" href="#media-type-registration" title="Permalink to this headline">¶</a></h3>
<p>(draft27)</p>
<div class="section" id="registry-contents">
<span id="jws-9-2-1"></span><h4><a class="toc-backref" href="#id38">9.2.1.  Registry Contents</a><a class="headerlink" href="#registry-contents" title="Permalink to this headline">¶</a></h4>
<p>This specification registers the &#8220;application/jose&#8221; Media Type
[RFC2046] in the MIME Media Types registry [IANA.MediaTypes], which
can be used to indicate that the content is a JWS or JWE object using
the JWS Compact Serialization or the JWE Compact Serialization and
the &#8220;application/jose+json&#8221; Media Type in the MIME Media Types
registry, which can be used to indicate that the content is a JWS or
JWE object using the JWS JSON Serialization or the JWE JSON
Serialization.</p>
<p>o  Type name: application
o  Subtype name: jose
o  Required parameters: n/a
o  Optional parameters: n/a
o  Encoding considerations: 8bit; application/jose values are encoded</p>
<blockquote>
<div>as a series of base64url encoded values (some of which may be the
empty string) separated by period (&#8216;.&#8217;) characters.</div></blockquote>
<dl class="docutils">
<dt>o  Security considerations: See the Security Considerations section</dt>
<dd>of [[ this document ]]</dd>
</dl>
<p>o  Interoperability considerations: n/a
o  Published specification: [[ this document ]]
o  Applications that use this media type: OpenID Connect, Mozilla</p>
<blockquote>
<div>Persona, Salesforce, Google, Android, Windows Azure, Xbox One, and
numerous others that use JWTs</div></blockquote>
<dl class="docutils">
<dt>o  Additional information: Magic number(s): n/a, File extension(s):</dt>
<dd>n/a, Macintosh file type code(s): n/a</dd>
<dt>o  Person &amp; email address to contact for further information: Michael</dt>
<dd><ol class="first last upperalpha simple" start="2">
<li>Jones, <a class="reference external" href="mailto:mbj&#37;&#52;&#48;microsoft&#46;com">mbj<span>&#64;</span>microsoft<span>&#46;</span>com</a></li>
</ol>
</dd>
</dl>
<p>o  Intended usage: COMMON
o  Restrictions on usage: none
o  Author: Michael B. Jones, <a class="reference external" href="mailto:mbj&#37;&#52;&#48;microsoft&#46;com">mbj<span>&#64;</span>microsoft<span>&#46;</span>com</a>
o  Change Controller: IESG</p>
<p>o  Type name: application
o  Subtype name: jose+json
o  Required parameters: n/a
o  Optional parameters: n/a
o  Encoding considerations: 8bit; application/jose+json values are</p>
<blockquote>
<div>represented as a JSON Object; UTF-8 encoding SHOULD be employed
for the JSON object.</div></blockquote>
<dl class="docutils">
<dt>o  Security considerations: See the Security Considerations section</dt>
<dd>of [[ this document ]]</dd>
</dl>
<p>o  Interoperability considerations: n/a
o  Published specification: [[ this document ]]
o  Applications that use this media type: TBD
o  Additional information: Magic number(s): n/a, File extension(s):</p>
<blockquote>
<div>n/a, Macintosh file type code(s): n/a</div></blockquote>
<dl class="docutils">
<dt>o  Person &amp; email address to contact for further information: Michael</dt>
<dd><ol class="first last upperalpha simple" start="2">
<li>Jones, <a class="reference external" href="mailto:mbj&#37;&#52;&#48;microsoft&#46;com">mbj<span>&#64;</span>microsoft<span>&#46;</span>com</a></li>
</ol>
</dd>
</dl>
<p>o  Intended usage: COMMON
o  Restrictions on usage: none
o  Author: Michael B. Jones, <a class="reference external" href="mailto:mbj&#37;&#52;&#48;microsoft&#46;com">mbj<span>&#64;</span>microsoft<span>&#46;</span>com</a>
o  Change Controller: IESG</p>
<p>(draft27)</p>
</div>
</div>
</div>
<div class="section" id="security-considerations">
<span id="jws-10"></span><h2><a class="toc-backref" href="#id39">10.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>All of the security issues faced by any cryptographic application
must be faced by a JWS/JWE/JWK agent.  Among these issues are
protecting the user&#8217;s asymmetric private and symmetric secret keys,
preventing various attacks, and helping avoid mistakes such as
inadvertently encrypting a message to the wrong recipient.  The
entire list of security considerations is beyond the scope of this
document, but some significant concerns are listed here.</p>
<p>All the security considerations in XML DSIG 2.0
[W3C.NOTE-xmldsig-core2-20130411], also apply to this specification,
other than those that are XML specific.  Likewise, many of the best
practices documented in XML Signature Best Practices
[W3C.NOTE-xmldsig-bestpractices-20130411] also apply to this
specification, other than those that are XML specific.</p>
<p>(draft28)</p>
<div class="section" id="key-entropy">
<span id="jws-10-1"></span><h3><a class="toc-backref" href="#id40">10.1.  Key Entropy</a><a class="headerlink" href="#key-entropy" title="Permalink to this headline">¶</a></h3>
<p>Keys are only as strong as the amount of entropy used to generate
them.  A minimum of 128 bits of entropy should be used for all keys,
and depending upon the application context, more may be required.  In
particular, it may be difficult to generate sufficiently random
values in some browsers and application environments.</p>
<p>(draft28)</p>
</div>
<div class="section" id="chosen-plaintext-attacks">
<span id="jws-10-2"></span><h3><a class="toc-backref" href="#id41">10.2.  Chosen Plaintext Attacks</a><a class="headerlink" href="#chosen-plaintext-attacks" title="Permalink to this headline">¶</a></h3>
<p>Creators of JWSs should not allow third parties to insert arbitrary
content into the message without adding entropy not controlled by the
third party.</p>
<p>(draft28)</p>
</div>
<div class="section" id="timing-attacks">
<span id="jws-10-3"></span><h3><a class="toc-backref" href="#id42">10.3.  Timing Attacks</a><a class="headerlink" href="#timing-attacks" title="Permalink to this headline">¶</a></h3>
<p>When cryptographic algorithms
are implemented in such a way that
successful operations take a different amount of time
than unsuccessful operations,
attackers may be able to use the time difference
to obtain information about the keys employed.</p>
<p>Therefore,
such timing differences must be avoided.</p>
<p>(draft28)</p>
</div>
<div class="section" id="differences-between-digital-signatures-and-macs">
<span id="jws-10-4"></span><h3><a class="toc-backref" href="#id43">10.4.  Differences between Digital Signatures and MACs</a><a class="headerlink" href="#differences-between-digital-signatures-and-macs" title="Permalink to this headline">¶</a></h3>
<p>While MACs and digital signatures can both be used
for integrity checking,
there are some significant differences between the security
properties that each of them provides.</p>
<p>These need to be taken into consideration
when designing protocols and selecting the algorithms
to be used in protocols.</p>
<p>Both signatures and MACs provide for integrity checking &#8211;
verifying that the message has not been modified
since the integrity value was computed.</p>
<p>However,
MACs provide for origination identification only under specific circumstances.</p>
<p>It can normally be assumed that a private key used for a signature
is only in the hands of a single entity
(although perhaps a distributed entity, in the case of replicated servers);
however,
a MAC key needs to be in the hands of all the entities
that use it for integrity computation and checking.</p>
<p>This means that origination can only be determined
if a MAC key is known only to two entities
and the receiver knows that it did not create the message.</p>
<p>MAC validation cannot be used to prove origination to a third party.</p>
<p>(draft28)</p>
</div>
<div class="section" id="sha-1-certificate-thumbprints">
<span id="jws-10-5"></span><h3><a class="toc-backref" href="#id44">10.5.  SHA-1 Certificate Thumbprints</a><a class="headerlink" href="#sha-1-certificate-thumbprints" title="Permalink to this headline">¶</a></h3>
<p>A SHA-1 hash is used when computing &#8220;x5t&#8221;
(X.509 Certificate SHA-1 Thumbprint) values,
for compatibility reasons.</p>
<p>Should an effective means of producing SHA-1 hash collisions be developed,
and should an attacker wish to interfere with the use of a known certificate on a
given system, this could be accomplished by creating another
certificate whose SHA-1 hash value is the same and adding it to the
certificate store used by the intended victim.  A prerequisite to
this attack succeeding is the attacker having write access to the
intended victim&#8217;s certificate store.</p>
<p>Header Parameter could be used instead of &#8220;x5t&#8221;.</p>
<p>However, at the time of this writing,
no development platform is known
to support SHA-256 certificate thumbprints.</p>
<p>(draft28)</p>
</div>
<div class="section" id="json-security-considerations">
<span id="jws-10-6"></span><h3><a class="toc-backref" href="#id45">10.6.  JSON Security Considerations</a><a class="headerlink" href="#json-security-considerations" title="Permalink to this headline">¶</a></h3>
<p>Strict JSON [RFC7159] validation is a security requirement.  If
malformed JSON is received, then the intent of the sender is
impossible to reliably discern.  Ambiguous and potentially
exploitable situations could arise if the JSON parser used does not
reject malformed JSON syntax.  In particular, any JSON inputs not
conforming to the JSON-text syntax defined in RFC 7159 input MUST be
rejected in their entirety.</p>
<p>Section 4 of the JSON Data Interchange Format specification [RFC7159]
states &#8220;The names within an object SHOULD be unique&#8221;, whereas this
specification states that &#8220;Header Parameter names within this object
MUST be unique; recipients MUST either reject JWSs with duplicate
Header Parameter names or use a JSON parser that returns only the
lexically last duplicate member name, as specified in Section 15.12
(The JSON Object) of ECMAScript 5.1 [ECMAScript]&#8221;.  Thus, this
specification requires that the Section 4 &#8220;SHOULD&#8221; be treated as a
&#8220;MUST&#8221; by senders and that it be either treated as a &#8220;MUST&#8221; or in the
manner specified in ECMAScript 5.1 by receivers.  Ambiguous and
potentially exploitable situations could arise if the JSON parser
used does not enforce the uniqueness of member names or returns an
unpredictable value for duplicate member names.</p>
<p>Some JSON parsers might not reject input that contains extra
significant characters after a valid input.  For instance, the input
&#8220;{&#8220;tag&#8221;:&#8221;value&#8221;}ABCD&#8221; contains a valid JSON-text object followed by
the extra characters &#8220;ABCD&#8221;.  Such input MUST be rejected in its
entirety.</p>
<p>(draft28)</p>
</div>
<div class="section" id="unicode-comparison-security-considerations">
<span id="jws-10-7"></span><h3><a class="toc-backref" href="#id46">10.7.  Unicode Comparison Security Considerations</a><a class="headerlink" href="#unicode-comparison-security-considerations" title="Permalink to this headline">¶</a></h3>
<p>Header Parameter names and algorithm names are Unicode strings.</p>
<p>For security reasons,
the representations of these names must be compared verbatim
after performing any escape processing
(as per Section 8.3 of [RFC7159]).</p>
<p>This means,
for instance,
that these JSON strings must compare as being equal
(&#8220;sig&#8221;, &#8220;u0073ig&#8221;),
whereas these must all compare as being not equal
to the first set or to each other (&#8220;SIG&#8221;, &#8220;Sig&#8221;, &#8220;siu0047&#8221;).</p>
<p>JSON strings can contain characters
outside the Unicode Basic Multilingual Plane.</p>
<p>For instance,
the G clef character (U+1D11E) may be represented in a JSON string
as &#8220;uD834uDD1E&#8221;.</p>
<p>Ideally,
JWS implementations SHOULD ensure that characters outside the Basic
Multilingual Plane are preserved and compared correctly;
alternatively,
if this is not possible due to these characters
exercising limitations present in the underlying JSON implementation,
then input containing them MUST be rejected.</p>
<p>(draft28)</p>
</div>
</div>
<div class="section" id="references">
<span id="jws-11"></span><h2><a class="toc-backref" href="#id47">11.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="jws-11-1"></span><h3><a class="toc-backref" href="#id48">11.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>[ECMAScript]</dt>
<dd>Ecma International, &#8220;ECMAScript Language Specification,
5.1 Edition&#8221;, ECMA 262, June 2011.</dd>
<dt>[IANA.MediaTypes]</dt>
<dd>Internet Assigned Numbers Authority (IANA), &#8220;MIME Media
Types&#8221;, 2005.</dd>
<dt>[ITU.X690.1994]</dt>
<dd>International Telecommunications Union, &#8220;Information
Technology - ASN.1 encoding rules: Specification of Basic
Encoding Rules (BER), Canonical Encoding Rules (CER) and
Distinguished Encoding Rules (DER)&#8221;, ITU-T Recommendation
X.690, 1994.</dd>
<dt>[JWA]      Jones, M., &#8220;JSON Web Algorithms (JWA)&#8221;,</dt>
<dd>draft-ietf-jose-json-web-algorithms (work in progress),
June 2014.</dd>
<dt>[JWK]      Jones, M., &#8220;JSON Web Key (JWK)&#8221;,</dt>
<dd>draft-ietf-jose-json-web-key (work in progress),
June 2014.</dd>
<dt>[RFC1421]  Linn, J., &#8220;Privacy Enhancement for Internet Electronic</dt>
<dd>Mail: Part I: Message Encryption and Authentication
Procedures&#8221;, RFC 1421, February 1993.</dd>
<dt>[RFC2045]  Freed, N. and N. Borenstein, &#8220;Multipurpose Internet Mail</dt>
<dd>Extensions (MIME) Part One: Format of Internet Message
Bodies&#8221;, RFC 2045, November 1996.</dd>
<dt>[RFC2046]  Freed, N. and N. Borenstein, &#8220;Multipurpose Internet Mail</dt>
<dd>Extensions (MIME) Part Two: Media Types&#8221;, RFC 2046,
November 1996.</dd>
<dt>[RFC2119]  Bradner, S., &#8220;Key words for use in RFCs to Indicate</dt>
<dd>Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
</dl>
<p>[RFC2818]  Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</p>
<dl class="docutils">
<dt>[RFC3629]  Yergeau, F., &#8220;UTF-8, a transformation format of ISO</dt>
<dd>10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt>[RFC3986]  Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform</dt>
<dd>Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt>[RFC4648]  Josefsson, S., &#8220;The Base16, Base32, and Base64 Data</dt>
<dd>Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt>[RFC5246]  Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security</dt>
<dd>(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt>[RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,</dt>
<dd>Housley, R., and W. Polk, &#8220;Internet X.509 Public Key
Infrastructure Certificate and Certificate Revocation List
(CRL) Profile&#8221;, RFC 5280, May 2008.</dd>
<dt>[RFC6125]  Saint-Andre, P. and J. Hodges, &#8220;Representation and</dt>
<dd>Verification of Domain-Based Application Service Identity
within Internet Public Key Infrastructure Using X.509
(PKIX) Certificates in the Context of Transport Layer
Security (TLS)&#8221;, RFC 6125, March 2011.</dd>
<dt>[RFC7159]  Bray, T., &#8220;The JavaScript Object Notation (JSON) Data</dt>
<dd>Interchange Format&#8221;, RFC 7159, March 2014.</dd>
<dt>[USASCII]  American National Standards Institute, &#8220;Coded Character</dt>
<dd>Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
</dl>
</div></blockquote>
<p>(draft27)</p>
</div>
<div class="section" id="informative-references">
<span id="jws-11-2"></span><h3><a class="toc-backref" href="#id49">11.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><dl class="docutils">
<dt>[CanvasApp]</dt>
<dd>Facebook, &#8220;Canvas Applications&#8221;, 2010.</dd>
<dt>[JSS]      Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,</dt>
<dd>September 2010.</dd>
<dt>[JWE]      Jones, M. and J. Hildebrand, &#8220;JSON Web Encryption (JWE)&#8221;,</dt>
<dd>draft-ietf-jose-json-web-encryption (work in progress),
June 2014.</dd>
<dt>[JWT]      Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web Token</dt>
<dd>(JWT)&#8221;, draft-ietf-oauth-json-web-token (work in
progress), June 2014.</dd>
<dt>[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, &#8220;Magic
Signatures&#8221;, January 2011.</dd>
<dt>[RFC4122]  Leach, P., Mealling, M., and R. Salz, &#8220;A Universally</dt>
<dd>Unique IDentifier (UUID) URN Namespace&#8221;, RFC 4122,
July 2005.</dd>
<dt>[RFC5226]  Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an</dt>
<dd>IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt>[W3C.NOTE-xmldsig-bestpractices-20130411]</dt>
<dd>Hirsch, F. and P. Datta, &#8220;XML Signature Best Practices&#8221;,
World Wide Web Consortium Note NOTE-xmldsig-bestpractices-
20130411, April 2013, &lt;<a class="reference external" href="http://www.w3.org/TR/2013/">http://www.w3.org/TR/2013/</a>
NOTE-xmldsig-bestpractices-20130411/&gt;.</dd>
<dt>[W3C.NOTE-xmldsig-core2-20130411]</dt>
<dd>Eastlake, D., Reagle, J., Solo, D., Hirsch, F., Roessler,
T., Yiu, K., Datta, P., and S. Cantor, &#8220;XML Signature
Syntax and Processing Version 2.0&#8221;, World Wide Web
Consortium Note NOTE-xmldsig-core2-20130411, April 2013,
&lt;<a class="reference external" href="http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/">http://www.w3.org/TR/2013/NOTE-xmldsig-core2-20130411/</a>&gt;.</dd>
</dl>
</div></blockquote>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="appendix-a-jws-examples">
<span id="jws-appendix-a"></span><h2><a class="toc-backref" href="#id50">Appendix A.  JWS Examples</a><a class="headerlink" href="#appendix-a-jws-examples" title="Permalink to this headline">¶</a></h2>
<p>This section provides several examples of JWSs.  While the first
three examples all represent JSON Web Tokens (JWTs) [JWT], the
payload can be any octet sequence, as shown in Appendix A.4.</p>
<p>(draft27)</p>
<div class="section" id="a-1-example-jws-using-hmac-sha-256">
<span id="jws-appendix-a-1"></span><h3><a class="toc-backref" href="#id51">A.1. Example JWS using HMAC SHA-256</a><a class="headerlink" href="#a-1-example-jws-using-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<p>(draft27)</p>
<div class="section" id="a-1-1-encoding">
<span id="jws-appendix-a-1-1"></span><h4><a class="toc-backref" href="#id52">A.1.1.  Encoding</a><a class="headerlink" href="#a-1-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The following example <a class="reference internal" href="#term-16"><em class="xref std std-term">JWS Protected Header</em></a> declares
that the data structure is a JSON Web Token (JWT) [JWT]
and the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> is signed
using the HMAC SHA-256 algorithm.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;typ&quot;</span><span class="p">:</span><span class="s">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The octets representing UTF8(JWS Protected Header)
in this case are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span>
<span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header
as BASE64URL(UTF8(JWS Protected Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example is
the octets of the UTF-8 representation of the JSON object below.</p>
<p>(Note that the payload can be any base64url encoded octet sequence,
and need not be a base64url encoded JSON object.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>The following octet sequence,
which is the UTF-8 representation of
the JSON object above, is the JWS Payload:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span>
<span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span>
<span class="mi">57</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span>
<span class="mi">47</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">115</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header
as BASE64URL(UTF8(JWS Protected Header)) gives this value
(with line breaks for display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt</span>
<span class="n">cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Combining these as
BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; ||
BASE64URL(JWS Payload)
gives this string (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The resulting JWS Signing Input value,
which is the ASCII representation of above string,
is the following octet sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span>
<span class="mi">81</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">74</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span>
<span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span>
<span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span>
<span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span>
<span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span>
<span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>
<span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>HMACs are generated using keys.</p>
<p>This example uses the symmetric key represented in JSON Web Key [JWK] format
below (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>{"kty":"oct",
 "k":"AyM1SysPpbyDfgZld3umj1qzKObwVMkoqQ-EstJQLr_T-1qS0gZH75
      aKtMN3Yj0iPS4hcgUuTwjAzZr1Z9CAow"
}</pre>
</div>
<p>Running the HMAC SHA-256 algorithm on the JWS Signing Input
with this key yields this JWS Signature octet sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">116</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span>
<span class="mi">187</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span>
<span class="mi">132</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">121</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding this JWS Signature as BASE64URL(JWS Signature) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dBjftJeZ4CVP</span><span class="o">-</span><span class="n">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>Concatenating these values in the order Header.Payload.Signature with
period (&#8216;.&#8217;) characters between the parts yields this complete JWS
representation using the JWS Compact Serialization (with line breaks
for display purposes only):</p>
<div class="highlight-python"><pre>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.
dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</pre>
</div>
<p>(draft25)</p>
</div>
<div class="section" id="a-1-2-validating">
<span id="jws-appendix-a-1-2"></span><h4><a class="toc-backref" href="#id53">A.1.2.  Validating</a><a class="headerlink" href="#a-1-2-validating" title="Permalink to this headline">¶</a></h4>
<p>Since the &#8220;alg&#8221; Header Parameter is &#8220;HS256&#8221;,
we validate the HMAC SHA-256 value contained in the JWS Signature.</p>
<p>To validate the HMAC value,
we repeat the previous process of
using the correct key and the JWS Signing Input
as input to the HMAC SHA-256 function
and then taking the output and determining
if it matches the JWS Signature.</p>
<p>If it matches exactly,
the HMAC has been validated.</p>
<p>(draft25)</p>
</div>
</div>
<div class="section" id="a-2-example-jws-using-rsassa-pkcs-v1-5-sha-256">
<span id="jws-appendix-a-2"></span><h3><a class="toc-backref" href="#id54">A.2.  Example JWS using RSASSA-PKCS-v1_5 SHA-256</a><a class="headerlink" href="#a-2-example-jws-using-rsassa-pkcs-v1-5-sha-256" title="Permalink to this headline">¶</a></h3>
<p>(draft25)</p>
<div class="section" id="a-2-1-encoding">
<span id="jws-appendix-a-2-1"></span><h4><a class="toc-backref" href="#id55">A.2.1.  Encoding</a><a class="headerlink" href="#a-2-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The JWS Protected Header in this example is different
from the previous example in two ways:</p>
<p>First,
because a different algorithm is being used,
the &#8220;alg&#8221; value is different.</p>
<p>Second,
for illustration purposes only,
the optional &#8220;typ&#8221; parameter is not used.
(This difference is not related to the algorithm employed.)</p>
<p>The JWS Protected Header used is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The octets representing UTF8(JWS Protected Header) in this case are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">ord</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="s">&#39;{&quot;alg&quot;:&quot;RS256&quot;}&#39;</span> <span class="p">]</span>

<span class="go">[123, 34, 97, 108, 103, 34, 58, 34, 82, 83, 50, 53, 54, 34, 125]</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header
as BASE64URL(UTF8(JWS Protected Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJSUzI1NiJ9</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="n">jose</span> <span class="kn">import</span> <span class="nn">base64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">base64</span><span class="o">.</span><span class="n">base64url_encode</span><span class="p">(</span><span class="s">&#39;{&quot;alg&quot;:&quot;RS256&quot;}&#39;</span><span class="p">)</span>
<span class="go">&#39;eyJhbGciOiJSUzI1NiJ9&#39;</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, which follows,
is the same as in the previous example.</p>
<p>Since the BASE64URL(JWS Payload) value will
therefore be the same,
its computation is not repeated here.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="s2">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s2">&quot;http://example.com/is_root&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Combining these as
BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; || BASE64URL(JWS Payload)
gives this string (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJSUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The resulting JWS Signing Input value, which is the ASCII
representation of above string, is the following octet sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>
<span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span>
<span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span>
<span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span>
<span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span>
<span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span>
<span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>This example uses the RSA key represented in JSON Web Key [JWK]
format below (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>{"kty":"RSA",
 "n":"ofgWCuLjybRlzo0tZWJjNiuSfb4p4fAkd_wWJcyQoTbji9k0l8W26mPddx
      HmfHQp-Vaw-4qPCJrcS2mJPMEzP1Pt0Bm4d4QlL-yRT-SFd2lZS-pCgNMs
      D1W_YpRPEwOWvG6b32690r2jZ47soMZo9wGzjb_7OMg0LOL-bSf63kpaSH
      SXndS5z5rexMdbBYUsLA9e-KXBdQOS-UTo7WTBEMa2R2CapHg665xsmtdV
      MTBQY4uDZlxvb3qCo5ZwKh9kG4LT6_I5IhlJH7aGhyxXFvUK-DWNmoudF8
      NAco9_h9iaGNj8q2ethFkMLs91kzk2PAcDTW9gb54h4FRWyuXpoQ",
 "e":"AQAB",
 "d":"Eq5xpGnNCivDflJsRQBXHx1hdR1k6Ulwe2JZD50LpXyWPEAeP88vLNO97I
      jlA7_GQ5sLKMgvfTeXZx9SE-7YwVol2NXOoAJe46sui395IW_GO-pWJ1O0
      BkTGoVEn2bKVRUCgu-GjBVaYLU6f3l9kJfFNS3E0QbVdxzubSu3Mkqzjkn
      439X0M_V51gfpRLI9JYanrC4D4qAdGcopV_0ZHHzQlBjudU2QvXt4ehNYT
      CBr6XCLQUShb1juUO1ZdiYoFaFQT5Tw8bGUl_x_jTj3ccPDVZFD9pIuhLh
      BOneufuBiB4cS98l2SR_RQyGWSeWjnczT0QU91p1DhOVRuOopznQ"
}</pre>
</div>
<p>The RSA private key is then passed to the RSA signing function, which
also takes the hash type, SHA-256, and the JWS Signing Input as
inputs.  The result of the digital signature is an octet sequence,
which represents a big endian integer.  In this example, it is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">112</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">243</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span>
<span class="mi">131</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span>
<span class="mi">102</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">229</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span>
<span class="mi">61</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
<span class="mi">16</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span>
<span class="mi">190</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span>
<span class="mi">74</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span>
<span class="mi">48</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span>
<span class="mi">253</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span>
<span class="mi">177</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span>
<span class="mi">173</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span>
<span class="mi">105</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">34</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span>
<span class="mi">234</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span>
<span class="mi">193</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span>
<span class="mi">251</span><span class="p">,</span> <span class="mi">71</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding the signature as BASE64URL(JWS Signature) produces this
value (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
p0igcN_IoypGlUPQGe77Rw</pre>
</div>
<p>Concatenating these values in the order Header.Payload.Signature with
period (&#8216;.&#8217;) characters between the parts yields this complete JWS
representation using the JWS Compact Serialization (with line breaks
for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJSUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.
cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7
AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4
BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K
0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqv
hJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrB
p0igcN_IoypGlUPQGe77Rw</pre>
</div>
<p>(draft25)</p>
</div>
<div class="section" id="a-2-2-validating">
<span id="jws-appendix-a-2-2"></span><h4><a class="toc-backref" href="#id56">A.2.2.  Validating</a><a class="headerlink" href="#a-2-2-validating" title="Permalink to this headline">¶</a></h4>
<p>Since the &#8220;alg&#8221; Header Parameter is &#8220;RS256&#8221;,
we validate the RSASSA-PKCS-v1_5 SHA-256 digital signature
contained in the JWS Signature.</p>
<p>Validating the JWS Signature is a little different
from the previous example.</p>
<p>We pass (n, e),
JWS Signature, and the JWS Signing Input
to an RSASSA-PKCS-v1_5 signature verifier
that has been configured to use the SHA-256 hash function.</p>
<p>(draft25)</p>
</div>
</div>
<div class="section" id="a-3-jws-using-ecdsa-p-256-sha-256">
<span id="jws-appendix-a-3"></span><h3><a class="toc-backref" href="#id57">A.3.  JWS using ECDSA P-256 SHA-256</a><a class="headerlink" href="#a-3-jws-using-ecdsa-p-256-sha-256" title="Permalink to this headline">¶</a></h3>
<p>(v.03)</p>
<div class="section" id="a-3-1-encoding">
<span id="jws-appendix-a-3-1"></span><h4><a class="toc-backref" href="#id58">A.3.1.  Encoding</a><a class="headerlink" href="#a-3-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="#term-13"><em class="xref std std-term">JWS Header</em></a> for this example
differs from the previous example because a different algorithm is being used.
The <a class="reference internal" href="#term-13"><em class="xref std std-term">JWS Header</em></a> used is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;ES256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The following byte array contains the UTF-8 characters for the JWS Header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding this UTF-8 representation yields this Encoded JWS Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJFUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, which follows, is the same as in the previous examples. Since the Encoded JWS Payload will therefore be the same, its computation is not repeated here.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Concatenating the Encoded JWS Header, a period character, and the Encoded JWS Payload yields this JWS Signing Input value (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJFUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The UTF-8 representation of the JWS Signing Input is the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>The ECDSA key consists of a public part, the EC point (x, y), and a private part d. The values of the ECDSA key used in this example, presented as the byte arrays representing big endian integers are:</p>
<p>Parameter Name /Value</p>
<blockquote>
<div><dl class="docutils">
<dt>x</dt>
<dd>[127, 205, 206, 39, 112, 246, 196, 93, 65, 131, 203, 238, 111, 219, 75, 123, 88, 7, 51, 53, 123, 233, 239, 19, 186, 207, 110, 60, 123, 209, 84, 69]</dd>
<dt>y</dt>
<dd>[199, 241, 68, 205, 27, 189, 155, 126, 135, 44, 223, 237, 185, 238, 185, 244, 179, 105, 93, 110, 169, 11, 36, 173, 138, 70, 35, 40, 133, 136, 229, 173]</dd>
<dt>d</dt>
<dd>[142, 155, 16, 158, 113, 144, 152, 191, 152, 4, 135, 223, 31, 93, 119, 233, 203, 41, 96, 110, 190, 210, 38, 59, 95, 87, 194, 19, 223, 132, 244, 178]</dd>
</dl>
</div></blockquote>
<p>The ECDSA <em class="xref std std-term">private part</em> <strong>d</strong> is then passed to an ECDSA signing function,
which also takes the curve type, P-256,
the hash type, SHA-256,
and the UTF-8 representation of the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> as inputs.
The result of the signature is the EC point (R, S),
where R and S are unsigned integers.</p>
<p>In this example, the R and S values,
given as byte arrays representing big endian integers are:</p>
<p>Result Name / Value</p>
<blockquote>
<div><dl class="docutils">
<dt>R</dt>
<dd>[14, 209, 33, 83, 121, 99, 108, 72, 60, 47, 127, 21, 88, 7, 212, 2, 163, 178, 40, 3, 58, 249, 124, 126, 23, 129, 154, 195, 22, 158, 166, 101]</dd>
<dt>S</dt>
<dd>[197, 10, 7, 211, 140, 60, 112, 229, 216, 241, 45, 175, 8, 74, 84, 128, 166, 101, 144, 197, 242, 147, 80, 154, 143, 63, 127, 138, 131, 163, 84, 213]</dd>
</dl>
</div></blockquote>
<p>Concatenating the S array to the end of the R array and base64url encoding the result produces this value for the Encoded JWS Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DtEhU3ljbEg8L38VWAfUAqOyKAM6</span><span class="o">-</span><span class="n">Xx</span><span class="o">-</span><span class="n">F4GawxaepmXFCgfTjDxw5djxLa8ISlSApmWQxfKTUJqPP3</span><span class="o">-</span><span class="n">Kg6NU1Q</span>
</pre></div>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="a-3-2-decoding">
<span id="jws-appendix-a-3-2"></span><h4><a class="toc-backref" href="#id59">A.3.2.  Decoding</a><a class="headerlink" href="#a-3-2-decoding" title="Permalink to this headline">¶</a></h4>
<p>Decoding the JWS from this example requires processing the Encoded JWS Header and Encoded JWS Payload exactly as done in the first example.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="a-4-example-jws-using-ecdsa-p-521-sha-512">
<span id="jws-appendix-a-4"></span><h3><a class="toc-backref" href="#id60">A.4.  Example JWS using ECDSA P-521 SHA-512</a><a class="headerlink" href="#a-4-example-jws-using-ecdsa-p-521-sha-512" title="Permalink to this headline">¶</a></h3>
<p>(draft27)</p>
<div class="section" id="a-4-1-encoding">
<span id="jws-appendix-a-4-1"></span><h4><a class="toc-backref" href="#id61">A.4.1.  Encoding</a><a class="headerlink" href="#a-4-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The JWS Protected Header for this example differs from the previous
example because different ECDSA curves and hash functions are used.
The JWS Protected Header used is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ES512&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The octets representing UTF8(JWS Protected Header) in this case are:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJFUzUxMiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, is the ASCII string &#8220;Payload&#8221;.
The representation of this string is the octet sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
<p>Encoding this JWS Payload as BASE64URL(JWS Payload) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">UGF5bG9hZA</span>
</pre></div>
</div>
<p>Combining these as BASE64URL(UTF8(JWS Protected Header)) || &#8216;.&#8217; ||
BASE64URL(JWS Payload) gives this string (with line breaks for
display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJFUzUxMiJ9</span><span class="o">.</span><span class="n">UGF5bG9hZA</span>
</pre></div>
</div>
<p>The resulting JWS Signing Input value, which is the ASCII
representation of above string, is the following octet sequence:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span>
<span class="mi">120</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">65</span><span class="p">]</span>
</pre></div>
</div>
<p>This example uses the elliptic curve key represented in JSON Web Key
[JWK] format below (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>{"kty":"EC",
 "crv":"P-521",
 "x":"AekpBQ8ST8a8VcfVOTNl353vSrDCLLJXmPk06wTjxrrjcBpXp5EOnYG_
      NjFZ6OvLFV1jSfS9tsz4qUxcWceqwQGk",
 "y":"ADSmRA43Z1DSNx_RvcLI87cdL07l6jQyyBXMoxVg_l2Th-x3S1WDhjDl
      y79ajL4Kkd0AZMaZmh9ubmf63e3kyMj2",
 "d":"AY5pb7A0UFiB3RELSD64fTLOSV_jazdF7fLYyuTw8lOfRhWg6Y6rUrPA
      xerEzgdRhajnu0ferB0d53vM9mE15j2C"
}</pre>
</div>
<p>The ECDSA private part <strong>d</strong> is then passed
to an ECDSA signing function,
which also takes the curve type, P-521,
the hash type, SHA-512, and
the JWS Signing Input as inputs.</p>
<p>The result of the digital signature
is the EC point (R, S),
where R and S are unsigned integers.</p>
<p>In this example,</p>
<p>the R and S values, given as octet sequences representing
big endian integers are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Result
Name</td>
<td>Value</td>
</tr>
<tr class="row-even"><td>R</td>
<td>[1, 220, 12, 129, 231, 171, 194, 209, 232, 135, 233,
117, 247, 105, 122, 210, 26, 125, 192, 1, 217, 21, 82,
91, 45, 240, 255, 83, 19, 34, 239, 71, 48, 157, 147,
152, 105, 18, 53, 108, 163, 214, 68, 231, 62, 153, 150,
106, 194, 164, 246, 72, 143, 138, 24, 50, 129, 223, 133,
206, 209, 172, 63, 237, 119, 109]</td>
</tr>
<tr class="row-odd"><td>S</td>
<td>[0, 111, 6, 105, 44, 5, 41, 208, 128, 61, 152, 40, 92,
61, 152, 4, 150, 66, 60, 69, 247, 196, 170, 81, 193,
199, 78, 59, 194, 169, 16, 124, 9, 143, 42, 142, 131,
48, 206, 238, 34, 175, 83, 203, 220, 159, 3, 107, 155,
22, 27, 73, 111, 68, 68, 21, 238, 144, 229, 232, 148,
188, 222, 59, 242, 103]</td>
</tr>
</tbody>
</table>
<p>The JWS Signature is the value R || S. Encoding the signature as
BASE64URL(JWS Signature) produces this value (with line breaks for
display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AdwMgeerwtHoh</span><span class="o">-</span><span class="n">l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc</span><span class="o">-</span><span class="n">mZZq</span>
<span class="n">wqT2SI</span><span class="o">-</span><span class="n">KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp</span>
<span class="n">EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn</span>
</pre></div>
</div>
<p>Concatenating these values in the order Header.Payload.Signature with
period (&#8216;.&#8217;) characters between the parts yields this complete JWS
representation using the JWS Compact Serialization (with line breaks
for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJFUzUxMiJ9
.
UGF5bG9hZA
.
AdwMgeerwtHoh-l192l60hp9wAHZFVJbLfD_UxMi70cwnZOYaRI1bKPWROc-mZZq
wqT2SI-KGDKB34XO0aw_7XdtAG8GaSwFKdCAPZgoXD2YBJZCPEX3xKpRwcdOO8Kp
EHwJjyqOgzDO7iKvU8vcnwNrmxYbSW9ERBXukOXolLzeO_Jn</pre>
</div>
<p>(draft27)</p>
</div>
<div class="section" id="a-4-2-validating">
<span id="jws-appendix-a-4-2"></span><h4><a class="toc-backref" href="#id62">A.4.2.  Validating</a><a class="headerlink" href="#a-4-2-validating" title="Permalink to this headline">¶</a></h4>
<p>Since the &#8220;alg&#8221; Header Parameter is &#8220;ES512&#8221;, we validate the ECDSA
P-521 SHA-512 digital signature contained in the JWS Signature.</p>
<p>Validating this JWS Signature is very similar to the previous
example.  We need to split the 132 member octet sequence of the JWS
Signature into two 66 octet sequences, the first representing R and
the second S. We then pass the public key (x, y), the signature (R,
S), and the JWS Signing Input to an ECDSA signature verifier that has
been configured to use the P-521 curve with the SHA-512 hash
function.</p>
<p>(draft27)</p>
</div>
</div>
<div class="section" id="a-5-example-plaintext-jws">
<span id="jws-appendix-a-5"></span><h3><a class="toc-backref" href="#id63">A.5.  Example Plaintext JWS</a><a class="headerlink" href="#a-5-example-plaintext-jws" title="Permalink to this headline">¶</a></h3>
<p>The following example JWS Protected Header declares that the encoded
object is a Plaintext JWS:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;none&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header as BASE64URL(UTF8(JWS Protected
Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJub25lIn0</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, which follows, is the same as
in the previous examples.  Since the BASE64URL(JWS Payload) value
will therefore be the same, its computation is not repeated here.</p>
<blockquote>
<div><dl class="docutils">
<dt>{&#8220;iss&#8221;:&#8221;joe&#8221;,</dt>
<dd>&#8220;exp&#8221;:1300819380,
&#8220;<a class="reference external" href="http://example.com/is_root">http://example.com/is_root</a>&#8221;:true}</dd>
</dl>
</div></blockquote>
<p>The JWS Signature is the empty octet string and
BASE64URL(JWS Signature) is the empty string.</p>
<p>Concatenating these parts in the order Header.Payload.Signature with
period (&#8216;.&#8217;) characters between the parts yields this complete JWS
(with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJub25lIn0
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.</pre>
</div>
<p>(draft24)</p>
</div>
<div class="section" id="a-6-example-jws-using-jws-json-serialization">
<span id="jws-appendix-a-6"></span><h3><a class="toc-backref" href="#id64">A.6.  Example JWS Using JWS JSON Serialization</a><a class="headerlink" href="#a-6-example-jws-using-jws-json-serialization" title="Permalink to this headline">¶</a></h3>
<p>This section contains an example using the JWS JSON Serialization.</p>
<p>This example demonstrates the capability
for conveying multiple digital signatures and/or MACs
for the same payload.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>複数のデジタル署名(or MAC)を１つのペイロードに入れられる</li>
</ul>
</div>
<p>The JWS Payload used in this example is the same as that used
in the examples in <a class="reference internal" href="#jws-appendix-a-2"><em>Appendix A.2</em></a>
and <a class="reference internal" href="#jws-appendix-a-3"><em>Appendix A.3</em></a>
(with line breaks for display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt</span>
<span class="n">cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">ーこの例では2つのデジタル署名を使っている
- RSASSA-PKCS-v1_5 SHA-256
- ECDSA P-256 SHA-256</p>
</div>
<p>Two digital signatures are used in this example:
the first using RSASSA-PKCS-v1_5 SHA-256
and the second using ECDSA P-256 SHA-256.</p>
<p>For the first,
the JWS Protected Header and key are the same as in <a class="reference internal" href="#jws-appendix-a-2"><em>Appendix A.2</em></a>,
resulting in the same JWS Signature value;
therefore, its computation is not repeated here.</p>
<p>For the second,
the JWS Protected Header and key are the same as in <a class="reference internal" href="#jws-appendix-a-3"><em>Appendix A.3</em></a>,
resulting in the same JWS Signature value; therefore,
its computation is not repeated here.</p>
<p>(draft24)</p>
<div class="section" id="a-6-1-jws-per-signature-protected-headers">
<span id="jws-appendix-a-6-1"></span><h4><a class="toc-backref" href="#id65">A.6.1.  JWS Per-Signature Protected Headers</a><a class="headerlink" href="#a-6-1-jws-per-signature-protected-headers" title="Permalink to this headline">¶</a></h4>
<p>The JWS Protected Header value used for the first signature is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;RS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header
as BASE64URL(UTF8(JWS Protected Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJSUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Protected Header value used for the second signature is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;ES256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Encoding this JWS Protected Header
as BASE64URL(UTF8(JWS Protected Header)) gives this value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJFUzI1NiJ9</span>
</pre></div>
</div>
<p>(draft 24)</p>
</div>
<div class="section" id="a-6-2-jws-per-signature-unprotected-headers">
<span id="jws-appendix-a-6-2"></span><h4><a class="toc-backref" href="#id66">A.6.2.  JWS Per-Signature Unprotected Headers</a><a class="headerlink" href="#a-6-2-jws-per-signature-unprotected-headers" title="Permalink to this headline">¶</a></h4>
<p>Key ID values are supplied for both keys
using per-signature Header Parameters.</p>
<p>The two values used to represent these Key IDs are:</p>
<div class="highlight-python"><pre>    {"kid":"2010-12-29"}

and</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;kid&quot;</span><span class="p">:</span><span class="s">&quot;e9bc097a-ce51-4036-9562-d2ade882db0d&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>(draft24)</p>
</div>
<div class="section" id="a-6-3-complete-jws-header-values">
<span id="jws-appendix-a-6-3"></span><h4><a class="toc-backref" href="#id67">A.6.3.  Complete JWS Header Values</a><a class="headerlink" href="#a-6-3-complete-jws-header-values" title="Permalink to this headline">¶</a></h4>
<p>Combining the protected and unprotected header values supplied,
the JWS Header values used for the first
and second signatures respectively are:</p>
<div class="highlight-python"><pre>  {"alg":"RS256",
   "kid":"2010-12-29"}

and</pre>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;ES256&quot;</span><span class="p">,</span>
 <span class="s">&quot;kid&quot;</span><span class="p">:</span><span class="s">&quot;e9bc097a-ce51-4036-9562-d2ade882db0d&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>(draft24)</p>
</div>
<div class="section" id="a-6-4-complete-jws-json-serialization-representation">
<span id="jws-appendix-a-6-4"></span><h4><a class="toc-backref" href="#id68">A.6.4.  Complete JWS JSON Serialization Representation</a><a class="headerlink" href="#a-6-4-complete-jws-json-serialization-representation" title="Permalink to this headline">¶</a></h4>
<p>The complete JSON Web Signature JSON Serialization
for these values is as follows
(with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>{"payload":
  "eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGF
   tcGxlLmNvbS9pc19yb290Ijp0cnVlfQ",

 "signatures":[
  {"protected":"eyJhbGciOiJSUzI1NiJ9",
   "header":
    {"kid":"2010-12-29"},
   "signature":
    "cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZ
     mh7AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjb
     KBYNX4BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHl
     b1L07Qe7K0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZES
     c6BfI7noOPqvhJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AX
     LIhWkWywlVmtVrBp0igcN_IoypGlUPQGe77Rw"},

  {"protected":"eyJhbGciOiJFUzI1NiJ9",
   "header":
    {"kid":"e9bc097a-ce51-4036-9562-d2ade882db0d"},
   "signature":
    "DtEhU3ljbEg8L38VWAfUAqOyKAM6-Xx-F4GawxaepmXFCgfTjDxw5djxLa8IS
     lSApmWQxfKTUJqPP3-Kg6NU1Q"}]
}</pre>
</div>
<p>(draft24)</p>
</div>
</div>
</div>
<div class="section" id="appendix-b-x5c-x-509-certificate-chain-example">
<span id="jws-appendix-b"></span><h2><a class="toc-backref" href="#id69">Appendix B. &#8220;x5c&#8221; (X.509 Certificate Chain) Example</a><a class="headerlink" href="#appendix-b-x5c-x-509-certificate-chain-example" title="Permalink to this headline">¶</a></h2>
<p>The JSON array below is an example of a certificate chain that could
be used as the value of an &#8220;x5c&#8221; (X.509 Certificate Chain) Header
Parameter, per Section 4.1.6.  Note that since these strings contain
base64 encoded (not base64url encoded) values, they are allowed to
contain white space and line breaks.</p>
<div class="highlight-python"><pre>["MIIE3jCCA8agAwIBAgICAwEwDQYJKoZIhvcNAQEFBQAwYzELMAkGA1UEBhMCVVM
xITAfBgNVBAoTGFRoZSBHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR2
8gRGFkZHkgQ2xhc3MgMiBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTAeFw0wNjExM
TYwMTU0MzdaFw0yNjExMTYwMTU0MzdaMIHKMQswCQYDVQQGEwJVUzEQMA4GA1UE
CBMHQXJpem9uYTETMBEGA1UEBxMKU2NvdHRzZGFsZTEaMBgGA1UEChMRR29EYWR
keS5jb20sIEluYy4xMzAxBgNVBAsTKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYW
RkeS5jb20vcmVwb3NpdG9yeTEwMC4GA1UEAxMnR28gRGFkZHkgU2VjdXJlIENlc
nRpZmljYXRpb24gQXV0aG9yaXR5MREwDwYDVQQFEwgwNzk2OTI4NzCCASIwDQYJ
KoZIhvcNAQEBBQADggEPADCCAQoCggEBAMQt1RWMnCZM7DI161+4WQFapmGBWTt
wY6vj3D3HKrjJM9N55DrtPDAjhI6zMBS2sofDPZVUBJ7fmd0LJR4h3mUpfjWoqV
Tr9vcyOdQmVZWt7/v+WIbXnvQAjYwqDL1CBM6nPwT27oDyqu9SoWlm2r4arV3aL
GbqGmu75RpRSgAvSMeYddi5Kcju+GZtCpyz8/x4fKL4o/K1w/O5epHBp+YlLpyo
7RJlbmr2EkRTcDCVw5wrWCs9CHRK8r5RsL+H0EwnWGu1NcWdrxcx+AuP7q2BNgW
JCJjPOq8lh8BJ6qf9Z/dFjpfMFDniNoW1fho3/Rb2cRGadDAW/hOUoz+EDU8CAw
EAAaOCATIwggEuMB0GA1UdDgQWBBT9rGEyk2xF1uLuhV+auud2mWjM5zAfBgNVH
SMEGDAWgBTSxLDSkdRMEXGzYcs9of7dqGrU4zASBgNVHRMBAf8ECDAGAQH/AgEA
MDMGCCsGAQUFBwEBBCcwJTAjBggrBgEFBQcwAYYXaHR0cDovL29jc3AuZ29kYWR
keS5jb20wRgYDVR0fBD8wPTA7oDmgN4Y1aHR0cDovL2NlcnRpZmljYXRlcy5nb2
RhZGR5LmNvbS9yZXBvc2l0b3J5L2dkcm9vdC5jcmwwSwYDVR0gBEQwQjBABgRVH
SAAMDgwNgYIKwYBBQUHAgEWKmh0dHA6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5j
b20vcmVwb3NpdG9yeTAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQEFBQADggE
BANKGwOy9+aG2Z+5mC6IGOgRQjhVyrEp0lVPLN8tESe8HkGsz2ZbwlFalEzAFPI
UyIXvJxwqoJKSQ3kbTJSMUA2fCENZvD117esyfxVgqwcSeIaha86ykRvOe5GPLL
5CkKSkB2XIsKd83ASe8T+5o0yGPwLPk9Qnt0hCqU7S+8MxZC9Y7lhyVJEnfzuz9
p0iRFEUOOjZv2kWzRaJBydTXRE4+uXR21aITVSzGh6O1mawGhId/dQb8vxRMDsx
uxN89txJx9OjxUUAiKEngHUuHqDTMBqLdElrRhjZkAzVvb3du6/KFUJheqwNTrZ
EjYx8WnM25sgVjOuH0aBsXBTWVU+4=",
"MIIE+zCCBGSgAwIBAgICAQ0wDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1Z
hbGlDZXJ0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIE
luYy4xNTAzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb
24gQXV0aG9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8x
IDAeBgkqhkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTA0MDYyOTE3MDY
yMFoXDTI0MDYyOTE3MDYyMFowYzELMAkGA1UEBhMCVVMxITAfBgNVBAoTGFRoZS
BHbyBEYWRkeSBHcm91cCwgSW5jLjExMC8GA1UECxMoR28gRGFkZHkgQ2xhc3MgM
iBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCCASAwDQYJKoZIhvcNAQEBBQADggEN
ADCCAQgCggEBAN6d1+pXGEmhW+vXX0iG6r7d/+TvZxz0ZWizV3GgXne77ZtJ6XC
APVYYYwhv2vLM0D9/AlQiVBDYsoHUwHU9S3/Hd8M+eKsaA7Ugay9qK7HFiH7Eux
6wwdhFJ2+qN1j3hybX2C32qRe3H3I2TqYXP2WYktsqbl2i/ojgC95/5Y0V4evLO
tXiEqITLdiOr18SPaAIBQi2XKVlOARFmR6jYGB0xUGlcmIbYsUfb18aQr4CUWWo
riMYavx4A6lNf4DD+qta/KFApMoZFv6yyO9ecw3ud72a9nmYvLEHZ6IVDd2gWMZ
Eewo+YihfukEHU1jPEX44dMX4/7VpkI+EdOqXG68CAQOjggHhMIIB3TAdBgNVHQ
4EFgQU0sSw0pHUTBFxs2HLPaH+3ahq1OMwgdIGA1UdIwSByjCBx6GBwaSBvjCBu
zEkMCIGA1UEBxMbVmFsaUNlcnQgVmFsaWRhdGlvbiBOZXR3b3JrMRcwFQYDVQQK
Ew5WYWxpQ2VydCwgSW5jLjE1MDMGA1UECxMsVmFsaUNlcnQgQ2xhc3MgMiBQb2x
pY3kgVmFsaWRhdGlvbiBBdXRob3JpdHkxITAfBgNVBAMTGGh0dHA6Ly93d3cudm
FsaWNlcnQuY29tLzEgMB4GCSqGSIb3DQEJARYRaW5mb0B2YWxpY2VydC5jb22CA
QEwDwYDVR0TAQH/BAUwAwEB/zAzBggrBgEFBQcBAQQnMCUwIwYIKwYBBQUHMAGG
F2h0dHA6Ly9vY3NwLmdvZGFkZHkuY29tMEQGA1UdHwQ9MDswOaA3oDWGM2h0dHA
6Ly9jZXJ0aWZpY2F0ZXMuZ29kYWRkeS5jb20vcmVwb3NpdG9yeS9yb290LmNybD
BLBgNVHSAERDBCMEAGBFUdIAAwODA2BggrBgEFBQcCARYqaHR0cDovL2NlcnRpZ
mljYXRlcy5nb2RhZGR5LmNvbS9yZXBvc2l0b3J5MA4GA1UdDwEB/wQEAwIBBjAN
BgkqhkiG9w0BAQUFAAOBgQC1QPmnHfbq/qQaQlpE9xXUhUaJwL6e4+PrxeNYiY+
Sn1eocSxI0YGyeR+sBjUZsE4OWBsUs5iB0QQeyAfJg594RAoYC5jcdnplDQ1tgM
QLARzLrUc+cb53S8wGd9D0VmsfSxOaFIqII6hR8INMqzW/Rn453HWkrugp++85j
09VZw==",
"MIIC5zCCAlACAQEwDQYJKoZIhvcNAQEFBQAwgbsxJDAiBgNVBAcTG1ZhbGlDZXJ
0IFZhbGlkYXRpb24gTmV0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNT
AzBgNVBAsTLFZhbGlDZXJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0a
G9yaXR5MSEwHwYDVQQDExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkq
hkiG9w0BCQEWEWluZm9AdmFsaWNlcnQuY29tMB4XDTk5MDYyNjAwMTk1NFoXDTE
5MDYyNjAwMTk1NFowgbsxJDAiBgNVBAcTG1ZhbGlDZXJ0IFZhbGlkYXRpb24gTm
V0d29yazEXMBUGA1UEChMOVmFsaUNlcnQsIEluYy4xNTAzBgNVBAsTLFZhbGlDZ
XJ0IENsYXNzIDIgUG9saWN5IFZhbGlkYXRpb24gQXV0aG9yaXR5MSEwHwYDVQQD
ExhodHRwOi8vd3d3LnZhbGljZXJ0LmNvbS8xIDAeBgkqhkiG9w0BCQEWEWluZm9
AdmFsaWNlcnQuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDOOnHK5a
vIWZJV16vYdA757tn2VUdZZUcOBVXc65g2PFxTXdMwzzjsvUGJ7SVCCSRrCl6zf
N1SLUzm1NZ9WlmpZdRJEy0kTRxQb7XBhVQ7/nHk01xC+YDgkRoKWzk2Z/M/VXwb
P7RfZHM047QSv4dk+NoS/zcnwbNDu+97bi5p9wIDAQABMA0GCSqGSIb3DQEBBQU
AA4GBADt/UG9vUJSZSWI4OB9L+KXIPqeCgfYrx+jFzug6EILLGACOTb2oWH+heQ
C1u+mNr0HZDzTuIYEZoDJJKPTEjlbVUjP9UNV+mWwD5MlM/Mtsq2azSiGM5bUMM
j4QssxsodyamEwCW/POuZ6lcg5Ktz885hZo+L7tdEy8W9ViH0Pd"]</pre>
</div>
<p>( draft27)</p>
</div>
<div class="section" id="appendix-c-notes-on-implementing-base64url-encoding-without-padding">
<span id="jws-appendix-c"></span><h2><a class="toc-backref" href="#id70">Appendix C.  Notes on implementing base64url encoding without padding</a><a class="headerlink" href="#appendix-c-notes-on-implementing-base64url-encoding-without-padding" title="Permalink to this headline">¶</a></h2>
<p>This appendix describes how to implement base64url encoding and decoding functions
without padding based upon standard base64 encoding and decoding functions that do use padding.</p>
<p>To be concrete, example C# code implementing these functions is shown below. Similar code could be used in other languages.</p>
<div class="highlight-python"><pre>static string base64urlencode(byte [] arg)
{
  string s = Convert.ToBase64String(arg); // Standard base64 encoder
  s = s.Split('=')[0]; // Remove any trailing '='s
  s = s.Replace('+', '-'); // 62nd char of encoding
  s = s.Replace('/', '_'); // 63rd char of encoding
  return s;
}

static byte [] base64urldecode(string arg)
{
  string s = arg;
  s = s.Replace('-', '+'); // 62nd char of encoding
  s = s.Replace('_', '/'); // 63rd char of encoding
  switch (s.Length % 4) // Pad with trailing '='s
  {
    case 0: break; // No pad chars in this case
    case 2: s += "=="; break; // Two pad chars
    case 3: s += "="; break; // One pad char
    default: throw new System.Exception(
      "Illegal base64url string!");
  }
  return Convert.FromBase64String(s); // Standard base64 decoder
}</pre>
</div>
<p>As per the example code above, the number of &#8216;=&#8217; padding characters
that needs to be added to the end of a base64url encoded string
without padding to turn it into one with padding is a deterministic function of the length of the encoded string. Specifically, if the length mod 4 is 0, no padding is added; if the length mod 4 is 2, two &#8216;=&#8217; padding characters are added; if the length mod 4 is 3, one &#8216;=&#8217; padding character is added; if the length mod 4 is 1, the input is malformed.</p>
<p>An example correspondence between unencoded and encoded values follows. The byte sequence below encodes into the string below, which when decoded, reproduces the byte sequence.</p>
<div class="highlight-python"><pre>3 236 255 224 193

A-z_4ME</pre>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="appendix-d-notes-on-key-selection">
<span id="jws-appendix-d"></span><h2><a class="toc-backref" href="#id71">Appendix D.  Notes on Key Selection</a><a class="headerlink" href="#appendix-d-notes-on-key-selection" title="Permalink to this headline">¶</a></h2>
<p>This appendix describes a set of possible algorithms
for selecting the key to be used
to validate the digital signature or MAC of a JWS object
or for selecting the key to be used to decrypt a JWE object.</p>
<p>This guidance describes a family of possible algorithms,
rather than a single algorithm,
because in different contexts,
not all the sources of keys will be used,
they can be tried in different orders,
and sometimes not all the collected keys will be tried; hence,
different algorithms will be used in different application contexts.</p>
<p>The steps below are described for illustration purposes only;
specific applications can and are likely to use different algorithms
or perform some of the steps in different orders.</p>
<p>Specific applications will frequently have a much simpler method of
determining the keys to use, as there may be one or two key selection
methods that are profiled for the application&#8217;s use.</p>
<p>This appendix supplements the normative information on key location in Section 6.</p>
<p>These algorithms include the following steps.</p>
<p>Note that the steps can be performed in any order
and do not need to be treated as distinct.</p>
<p>For example,
keys can be tried as soon as they are found,
rather than collecting all the keys before trying any.</p>
<ol class="arabic">
<li><p class="first">Collect the set of potentially applicable keys.</p>
<p>Sources of keys may include:</p>
<ul class="simple">
<li>Keys supplied by the application protocol being used.</li>
<li>Keys referenced by the &#8220;jku&#8221; (JWK Set URL) Header Parameter.</li>
<li>The key provided by the &#8220;jwk&#8221; (JSON Web Key) Header Parameter.</li>
<li>The key referenced by the &#8220;x5u&#8221; (X.509 URL) Header Parameter.</li>
<li>The key provided by the &#8220;x5c&#8221; (X.509 Certificate Chain) Header
Parameter.</li>
<li>Other applicable keys available to the application.</li>
</ul>
<p>The order for collecting and trying keys from different key
sources is typically application dependent.</p>
<p>For example,
frequently all keys from a one set of locations, such as local
caches, will be tried before collecting and trying keys from
other locations.</p>
</li>
<li><p class="first">Filter the set of collected keys.</p>
<p>For instance,
some applications will use only keys referenced by &#8220;kid&#8221; (key ID) or
&#8220;x5t&#8221; (X.509 certificate SHA-1 thumbprint) parameters.</p>
<p>If the application uses the &#8220;alg&#8221; (algorithm),
&#8220;use&#8221; (public key use), or &#8220;key_ops&#8221; (key operations) parameters,
keys with keys with inappropriate values of those parameters would be excluded.</p>
<p>Additionally,
keys might be filtered to include or exclude keys with certain other member values
in an application specific manner.
For some applications,
no filtering will be applied.</p>
</li>
<li><p class="first">Order the set of collected keys.</p>
<p>For instance, keys referenced by &#8220;kid&#8221; (Key ID) or &#8220;x5t&#8221; (X.509 Certificate SHA-1 Thumbprint)
parameters might be tried before keys with neither of these values.</p>
<p>Likewise, keys with certain member values might be ordered
before keys with other member values.</p>
<p>For some applications, no ordering will be applied.</p>
</li>
<li><p class="first">Make trust decisions about the keys.</p>
<p>Signatures made with keys not meeting the application&#8217;s trust criteria
would not be accepted.</p>
<p>Such criteria might include, but is not limited to the source of the key,
whether the TLS certificate validates for keys retrieved from URLs,
whether a key in an X.509 certificate is backed by a valid certificate chain,
and other information known by the application.</p>
</li>
<li><p class="first">Attempt signature or MAC validation for a JWS object or
decryption of a JWE object with some or all of the collected and
possibly filtered and/or ordered keys.</p>
<p>A limit on the number of keys to be tried might be applied.</p>
<p>This process will normally terminate following a successful validation or decryption.</p>
</li>
</ol>
<p>Note that it is reasonable for some applications to perform signature
or MAC validation prior to making a trust decision about a key, since
keys for which the validation fails need no trust decision.</p>
<p>(draft27)</p>
</div>
<div class="section" id="appendix-e-negative-test-case-for-crit-header-parameter">
<span id="jws-appendix-e"></span><h2><a class="toc-backref" href="#id72">Appendix E.  Negative Test Case for &#8220;crit&#8221; Header Parameter</a><a class="headerlink" href="#appendix-e-negative-test-case-for-crit-header-parameter" title="Permalink to this headline">¶</a></h2>
<p>Conforming implementations must reject input containing critical
extensions that are not understood or cannot be processed.</p>
<p>The following JWS must be rejected by all implementations,
because it uses an extension Header Parameter name
&#8220;<a class="reference external" href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>&#8221; that they do not understand.</p>
<p>Any other similar input,
in which the use of the value &#8220;<a class="reference external" href="http://example.invalid/UNDEFINED">http://example.invalid/UNDEFINED</a>&#8221;
is substituted for any other Header Parameter name not understood
by the implementation,
must also be rejected.</p>
<p>The JWS Protected Header value for this JWS is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;none&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crit&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;http://example.invalid/UNDEFINED&quot;</span><span class="p">],</span>
 <span class="s2">&quot;http://example.invalid/UNDEFINED&quot;</span><span class="o">:</span><span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The complete JWS that must be rejected is as follows (with line
breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJub25lIiwNCiAiY3JpdCI6WyJodHRwOi8vZXhhbXBsZS5jb20vVU5ERU
ZJTkVEIl0sDQogImh0dHA6Ly9leGFtcGxlLmNvbS9VTkRFRklORUQiOnRydWUNCn0.
RkFJTA.</pre>
</div>
<p>(draft27)</p>
</div>
<div class="section" id="appendix-f-detached-content">
<span id="jws-appendix-f"></span><h2><a class="toc-backref" href="#id73">Appendix F.  Detached Content</a><a class="headerlink" href="#appendix-f-detached-content" title="Permalink to this headline">¶</a></h2>
<p>In some contexts, it is useful integrity protect content that is not
itself contained in a JWS object.  One way to do this is create a JWS
object in the normal fashion using a representation of the content as
the payload, but then delete the payload representation from the JWS,
and send this modified object to the recipient, rather than the JWS.
When using the JWS Compact Serialization, the deletion is
accomplished by replacing the second field (which contains
BASE64URL(JWS Payload)) value with the empty string; when using the
JWS JSON Serialization, the deletion is accomplished by deleting the
&#8220;payload&#8221; member.  This method assumes that the recipient can
reconstruct the exact payload used in the JWS.  To use the modified
object, the recipient reconstructs the JWS by re-inserting the
payload representation into the modified object, and uses the
resulting JWS in the usual manner.  Note that this method needs no
support from JWS libraries, as applications can use this method by
modifying the inputs and outputs of standard JWS libraries.</p>
<p>(draft27)</p>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>