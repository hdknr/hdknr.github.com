

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Signature (JWS) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="Holder-of-Key JSON Web Signature (JWS)" href="jws_hok.html" />
    <link rel="prev" title="JSON Web Token(JWT)" href="jwt.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Signature (JWS)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jwt.html">JSON Web Token(JWT)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-signature-jws">
<h1><a class="toc-backref" href="#id21">JSON Web Signature (JWS)</a><a class="headerlink" href="#json-web-signature-jws" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://tools.ietf.org/html/draft-jones-json-web-signature-03">http://tools.ietf.org/html/draft-jones-json-web-signature-03</a>
( or <a class="reference external" href="http://self-issued.info/docs/draft-jones-json-web-signature-03.html">http://self-issued.info/docs/draft-jones-json-web-signature-03.html</a> )
(October 30, 2011)</p>
<div class="section" id="abstract">
<span id="jws-abstract"></span><h2><a class="toc-backref" href="#id22">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Signature (JWS) is a means of representing signed content using JSON data structures.</p>
<p>Related encryption capabilities are described in the separate JSON Web Encryption (<a class="reference internal" href="standard.html#term-jwe"><em class="xref std std-term">JWE</em></a>) specification.</p>
<p>(v.03)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#json-web-signature-jws" id="id21">JSON Web Signature (JWS)</a><ul>
<li><a class="reference internal" href="#abstract" id="id22">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id23">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id24">2.  Terminology</a></li>
<li><a class="reference internal" href="#json-web-signature-jws-overview" id="id25">3.  JSON Web Signature (JWS) Overview</a><ul>
<li><a class="reference internal" href="#example-jws" id="id26">3.1.  Example JWS</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jws-header" id="id27">4.  JWS Header</a><ul>
<li><a class="reference internal" href="#reserved-header-parameter-names" id="id28">4.1.  Reserved Header Parameter Names</a><ul>
<li><a class="reference internal" href="#table-2-header-parameter-syntax-definitions" id="id29">Table 2: Header Parameter Syntax Definitions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-header-parameter-names" id="id30">4.2.  Public Header Parameter Names</a></li>
<li><a class="reference internal" href="#private-header-parameter-names" id="id31">4.3.  Private Header Parameter Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rules-for-creating-and-validating-a-jws" id="id32">5.  Rules for Creating and Validating a JWS</a></li>
<li><a class="reference internal" href="#signing-jwss-with-cryptographic-algorithms" id="id33">6.  Signing JWSs with Cryptographic Algorithms</a><ul>
<li><a class="reference internal" href="#creating-a-jws-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" id="id34">6.1.  Creating a JWS with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a></li>
<li><a class="reference internal" href="#creating-a-jws-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" id="id35">6.2.  Creating a JWS with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a></li>
<li><a class="reference internal" href="#creating-a-jws-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" id="id36">6.3.  Creating a JWS with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a></li>
<li><a class="reference internal" href="#additional-algorithms" id="id37">6.4.  Additional Algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#iana-considerations" id="id38">7.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations" id="id39">8.  Security Considerations</a></li>
<li><a class="reference internal" href="#references" id="id40">10.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id41">10.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id42">10.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-jws-examples" id="id43">Appendix A.  JWS Examples</a><ul>
<li><a class="reference internal" href="#a-1-jws-using-hmac-sha-256" id="id44">A.1.  JWS using HMAC SHA-256</a><ul>
<li><a class="reference internal" href="#a-1-1-encoding" id="id45">A.1.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-1-2-decoding" id="id46">A.1.2.  Decoding</a></li>
<li><a class="reference internal" href="#a-1-3-validating" id="id47">A.1.3.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-2-jws-using-rsa-sha-256" id="id48">A.2.  JWS using RSA SHA-256</a><ul>
<li><a class="reference internal" href="#a-2-1-encoding" id="id49">A.2.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-2-2-decoding" id="id50">A.2.2.  Decoding</a></li>
<li><a class="reference internal" href="#a-2-3-validating" id="id51">A.2.3.  Validating</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-3-jws-using-ecdsa-p-256-sha-256" id="id52">A.3.  JWS using ECDSA P-256 SHA-256</a><ul>
<li><a class="reference internal" href="#a-3-1-encoding" id="id53">A.3.1.  Encoding</a></li>
<li><a class="reference internal" href="#a-3-2-decoding" id="id54">A.3.2.  Decoding</a></li>
<li><a class="reference internal" href="#a-3-3-validating" id="id55">A.3.3.  Validating</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-algorithm-identifier-cross-reference" id="id56">Appendix B.  Algorithm Identifier Cross-Reference</a></li>
<li><a class="reference internal" href="#appendix-c-notes-on-implementing-base64url-encoding-without-padding" id="id57">Appendix C.  Notes on implementing base64url encoding without padding</a></li>
<li><a class="reference internal" href="#appendix-d-acknowledgements" id="id58">Appendix D.  Acknowledgements</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="jws-abstrat"></span><h2><a class="toc-backref" href="#id23">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Signature (JWS) is a compact signature format intended for space constrained environments
such as HTTP <a class="reference internal" href="glossary.html#term-authorization-headers"><em class="xref std std-term">Authorization headers</em></a> and <a class="reference internal" href="glossary.html#term-uri-query-parameters"><em class="xref std std-term">URI query parameters</em></a>.
It represents signed content using JSON [RFC4627] data structures.
The JWS signature mechanisms are independent of the type of content being signed,
allowing arbitrary content to be signed.</p>
<p>A related encryption capability is described in a separate JSON Web Encryption (JWE) [JWE] specification.</p>
<p>(v.03)</p>
</div>
<div class="section" id="terminology">
<span id="jws-2"></span><h2><a class="toc-backref" href="#id24">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-signature-jws">JSON Web Signature (JWS)</dt>
<dd>A data structure cryptographically securing a JWS Header and a JWS Payload with a JWS Signature.</dd>
<dt id="term-jws-header">JWS Header</dt>
<dd>A string containing a JSON object that describes the signature applied to the JWS Header and the JWS Payload to create the JWS Signature.</dd>
<dt id="term-jws-payload">JWS Payload</dt>
<dd>The bytes to be signed - a.k.a., the message.</dd>
<dt id="term-jws-signature">JWS Signature</dt>
<dd>A byte array containing the cryptographic material that secures the contents of the JWS Header and the JWS Payload.</dd>
<dt id="term-encoded-jws-header">Encoded JWS Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8 RFC 3629 [RFC3629] representation of the JWS Header.</dd>
<dt id="term-encoded-jws-payload">Encoded JWS Payload</dt>
<dd>Base64url encoding of the JWS Payload.</dd>
<dt id="term-encoded-jws-signature">Encoded JWS Signature</dt>
<dd>Base64url encoding of the JWS Signature.</dd>
<dt id="term-jws-signing-input">JWS Signing Input</dt>
<dd>The concatenation of the Encoded JWS Header, a period (&#8216;.&#8217;) character, and the Encoded JWS Payload.</dd>
<dt id="term-header-parameter-names">Header Parameter Names</dt>
<dd>The names of the members within the JSON object represented in a JWS Header.</dd>
<dt id="term-header-parameter-values">Header Parameter Values</dt>
<dd>The values of the members within the JSON object represented in a JWS Header.</dd>
<dt id="term-digital-signature">Digital Signature</dt>
<dd>For the purposes of this specification, we use this term to encompass both Hash-based Message Authentication Codes (HMACs), which can provide authenticity but not non-repudiation, and digital signatures using public key algorithms, which can provide both. Readers should be aware of this distinction, despite the decision to use a single term for both concepts to improve readability of the specification.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>For the purposes of this specification, this term always refers to the he URL- and filename-safe Base64 encoding described in RFC 4648 [RFC4648], Section 5, with the (non URL-safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2. (See Appendix C for notes on implementing base64url encoding without padding.)</dd>
</dl>
<p>(v.03)</p>
</div>
<div class="section" id="json-web-signature-jws-overview">
<span id="jws-3"></span><h2><a class="toc-backref" href="#id25">3.  JSON Web Signature (JWS) Overview</a><a class="headerlink" href="#json-web-signature-jws-overview" title="Permalink to this headline">¶</a></h2>
<p>JWS represents signed content using JSON data structures and base64url encoding. The representation consists of three parts: the JWS Header, the JWS Payload, and the JWS Signature. The three parts are base64url-encoded for transmission, and typically represented as the concatenation of the encoded strings in that order, with the three strings being separated by period (&#8216;.&#8217;) characters, as is done when used in JSON Web Tokens (JWTs) [JWT].</p>
<p>A base64url encoded JSON object - the JWS Header - describes the signature method used. A portion of the base64url encoded content that is signed is the Encoded JWS Payload. Finally, JWSs contain a signature that ensures the integrity of the contents of the JWS Header and the JWS Payload. This signature value is base64url encoded to produce the Encoded JWS Signature.</p>
<p>The member names within the JWS Header are referred to as Header Parameter Names. These names MUST be unique. The corresponding values are referred to as Header Parameter Values. The JWS Header MUST contain an alg parameter, the value of which is a string that unambiguously identifies the algorithm used to sign the JWS Header and the JWS Payload to produce the JWS Signature.</p>
<p>(v.03)</p>
<div class="section" id="example-jws">
<span id="jws-3-1"></span><h3><a class="toc-backref" href="#id26">3.1.  Example JWS</a><a class="headerlink" href="#example-jws" title="Permalink to this headline">¶</a></h3>
<p>The following example JWS Header declares that the encoded object is a JSON Web Token (JWT) [JWT] and the JWS Header and the JWS Payload are signed using the HMAC SHA-256 algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;typ&quot;</span><span class="p">:</span><span class="s">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JWS Header yields this Encoded JWS Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The following is an example of a JSON object that can be used as a JWS Payload. (Note that the payload can be any content, and need not be a representation of a JSON object.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
<span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
<span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JSON object yields the following Encoded JWS Payload.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Signing the UTF-8 representation of the JWS Signing Input (the concatenation of the Encoded JWS Header, a period (&#8216;.&#8217;) character, and the Encoded JWS Payload) with the HMAC SHA-256 algorithm and base64url encoding the result, as per Section 6.1, yields this Encoded JWS Signature value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dBjftJeZ4CVP</span><span class="o">-</span><span class="n">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>This computation is illustrated in more detail in Appendix A.1.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="jws-header">
<span id="jws-4"></span><h2><a class="toc-backref" href="#id27">4.  JWS Header</a><a class="headerlink" href="#jws-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object represented by the JWS Header describe the signature applied to the Encoded JWS Header
and the Encoded JWS Payload and optionally additional properties of the JWS.</p>
<p>Implementations MUST understand the entire contents of the header; otherwise, the JWS MUST be rejected for processing.</p>
<p>(v.03)</p>
<div class="section" id="reserved-header-parameter-names">
<span id="jws-4-1"></span><h3><a class="toc-backref" href="#id28">4.1.  Reserved Header Parameter Names</a><a class="headerlink" href="#reserved-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>The following header parameter names are reserved.
All the names are short because a core goal of JWSs is for the representations to be compact.</p>
<table border="1" class="docutils" id="jws-table-1">
<caption>Table 1: Reserved Header Parameter Definitions</caption>
<colgroup>
<col width="7%" />
<col width="8%" />
<col width="10%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header
Paramter
Name</th>
<th class="head">JSON
Value
Type</th>
<th class="head">Header
Parameter
Syntax</th>
<th class="head">Header Parameter Semantics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>alg</td>
<td>string</td>
<td>StringOrURI</td>
<td>The alg (algorithm) header parameter identifies the cryptographic algorithm
used to secure the JWS.
A list of reserved alg values is in <a class="reference internal" href="#jws-table-3"><em>Table 3</em></a>.
The processing of the alg (algorithm) header parameter,
if present, requires that the value of the alg header parameter MUST be one
that is both supported and for which there exists a key for use with that algorithm
associated with the signer of the content.
The alg parameter value is case sensitive. This header parameter is REQUIRED.</td>
</tr>
<tr class="row-odd"><td>typ</td>
<td>string</td>
<td>String</td>
<td>The typ (type) header parameter is used to declare the type of the signed content.
The typ value is case sensitive. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>jku</td>
<td>string</td>
<td>URL</td>
<td>The jku (JSON Web Key URL) header parameter is an absolute URL
that refers to a resource for a set of JSON-encoded public keys,
one of which corresponds to the key that was used to sign the JWS.
The keys MUST be encoded as described in the JSON Web Key (JWK) [<a class="reference internal" href="reg.html#term-jwk"><em class="xref std std-term">JWK</em></a>] specification.
The protocol used to acquire the resource MUST provide integrity protection.
An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818]
RFC 5246 [RFC5246] with server authentication RFC 6125 [RFC6125].
This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>kid</td>
<td>string</td>
<td>String</td>
<td><p class="first">The kid (<strong>key ID</strong>) header parameter is a <strong>hint</strong> indicating
which specific key owned by the signer should be used to validate the signature.</p>
<p>This allows <strong>signers</strong> to explicitly signal a change of key to <strong>recipients</strong>.
The interpretation of the contents of the kid parameter is unspecified.</p>
<p class="last">This header parameter is OPTIONAL.</p>
</td>
</tr>
<tr class="row-even"><td>x5u</td>
<td>string</td>
<td>String</td>
<td><p class="first">The x5u (<strong>X.509 URL</strong>) header parameter is an absolute URL
that refers to a resource for the <em class="xref std std-term">X.509</em> <strong>public key certificate</strong>
or <strong>certificate chain</strong> corresponding to the key used to sign the JWS.</p>
<p>The identified resource MUST provide a representation of the certificate
or certificate chain that conforms to RFC 5280 [RFC5280]
in <a class="reference internal" href="glossary.html#term-pem"><em class="xref std std-term">PEM</em></a> encoded form RFC 1421 [RFC1421].
The protocol used to acquire the resource MUST provide <strong>integrity protection</strong>. <a class="footnote-reference" href="#id2" id="id1">[1]</a></p>
<p class="last">An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818]
RFC 5246 [RFC5246] with server authentication RFC 6125 [RFC6125]. This header parameter is OPTIONAL.</p>
</td>
</tr>
<tr class="row-odd"><td>x5t</td>
<td>string</td>
<td>String</td>
<td><p class="first">The x5t (<strong>x.509 certificate thumbprint</strong>) header parameter provides
a base64url encoded <em class="xref std std-term">SHA-1</em> thumbprint (a.k.a. digest) of the <a class="reference internal" href="glossary.html#term-der"><em class="xref std std-term">DER</em></a> encoding of
an X.509 certificate that can be used to match the certificate.</p>
<p class="last">This header parameter is OPTIONAL.</p>
</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>What kind of protection ?</td></tr>
</tbody>
</table>
<p>Additional reserved claim names MAY be defined via the IANA JSON Web Token Claims registry, as per <em class="xref std std-ref">Section 9</em>.
The syntax values used above are defined as follows:</p>
<div class="section" id="table-2-header-parameter-syntax-definitions">
<span id="jws-table-2"></span><h4><a class="toc-backref" href="#id29">Table 2: Header Parameter Syntax Definitions</a><a class="headerlink" href="#table-2-header-parameter-syntax-definitions" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Syntax
Name</th>
<th class="head">Syntax Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IntDate</td>
<td>The number of seconds from 1970-01-01T0:0:0Z as measured in UTC until the desired date/time.
See RFC 3339 [<span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3339.html"><strong>RFC 3339</strong></a>] for details regarding date/times in general and UTC in particular.</td>
</tr>
<tr class="row-odd"><td>String</td>
<td>Any string value MAY be used.</td>
</tr>
<tr class="row-even"><td>StringOrURI</td>
<td>Any string value MAY be used
but a value containing a &#8221;:&#8221; character MUST be a URI as defined in RFC 3986 [<span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a>].</td>
</tr>
<tr class="row-odd"><td>URL</td>
<td>A URL as defined in RFC 1738 [RFC1738].</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="public-header-parameter-names">
<span id="jws-4-2"></span><h3><a class="toc-backref" href="#id30">4.2.  Public Header Parameter Names</a><a class="headerlink" href="#public-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>Additional header parameter names can be defined by those using JWSs.
However, in order to prevent collisions,
any new header parameter name or algorithm value SHOULD either be defined in the IANA JSON Web Signature Header Parameters registry
or be defined as a <em class="xref std std-term">URI</em> that contains a collision resistant <strong>namespace</strong>.</p>
<p>In each case,
the definer of the name or value MUST take reasonable precautions
to make sure they are in control of the part of the namespace
they use to define the header parameter name.</p>
<p>New header parameters should be introduced sparingly,
as they can result in non-interoperable JWSs.</p>
<p>(v.03)</p>
</div>
<div class="section" id="private-header-parameter-names">
<span id="jws-4-3"></span><h3><a class="toc-backref" href="#id31">4.3.  Private Header Parameter Names</a><a class="headerlink" href="#private-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>A producer and consumer of a JWS may agree to any header parameter name
that is not a <a class="reference internal" href="#jws-4-1"><em>Reserved Name Section 4.1</em></a> or
a <a class="reference internal" href="#jws-4-2"><em>Public Name Section 4.2</em></a>.</p>
<p>Unlike <a class="reference internal" href="#jws-4-2"><em>Public Names</em></a>,
these private names are subject to collision and should be used with caution.</p>
<p>New header parameters should be introduced sparingly,
as they can result in non-interoperable JWSs.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="rules-for-creating-and-validating-a-jws">
<span id="jws-5"></span><h2><a class="toc-backref" href="#id32">5.  Rules for Creating and Validating a JWS</a><a class="headerlink" href="#rules-for-creating-and-validating-a-jws" title="Permalink to this headline">¶</a></h2>
<p>To create a JWS, one MUST follow these steps:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Create the content to be used as the <a class="reference internal" href="#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>.</li>
<li>Base64url encode the JWS Payload.
This encoding becomes the <a class="reference internal" href="#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>.</li>
<li>Create a JSON object containing a set of desired header parameters.
Note that white space is explicitly allowed
in the representation and no canonicalization is performed before encoding.</li>
<li>Translate this JSON object&#8217;s Unicode code points into UTF-8,
as defined in RFC 3629 [RFC3629].</li>
<li>Base64url encode the UTF-8 representation of this JSON object
as defined in this specification (without padding).
This encoding becomes the <a class="reference internal" href="#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>.</li>
<li>Compute the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a> in the manner
defined for the particular algorithm being used.
The <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> is always the concatenation of the <a class="reference internal" href="#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>,
a <strong>period</strong> (&#8216;.&#8217;) character,
and the <a class="reference internal" href="#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>.
The <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter MUST be present in the <em class="xref std std-term">JSON Header</em>,
with the algorithm value accurately representing the algorithm used to construct the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a>.</li>
<li>Base64url encode the representation of the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a> to create the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>.</li>
</ol>
</div></blockquote>
<p>When validating a JWS, the following steps MUST be taken.
If any of the listed steps fails, then the signed content MUST be rejected.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The <a class="reference internal" href="#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a> MUST be successfully base64url decoded
following the restriction given in this specification
that <strong>no padding characters</strong> have been used.</li>
<li>The <a class="reference internal" href="#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a> MUST be successfully base64url decoded
following the restriction given in this specification that <strong>no padding characters</strong> have been used.</li>
<li>The <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> MUST be completely valid JSON syntax conforming to RFC 4627 [RFC4627].</li>
<li>The <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> MUST be successfully base64url decoded
following the restriction given in this specification that <strong>no padding characters</strong> have been used.</li>
<li>The <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> MUST be validated to only include parameters
and values whose syntax and semantics are both understood and supported.</li>
<li>The <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a> MUST be successfully validated
against the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> and <a class="reference internal" href="#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>
in the manner defined for the algorithm being used,
which MUST be accurately represented by the value of the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter,
which MUST be present.</li>
</ol>
</div></blockquote>
<p>Processing a JWS inevitably requires comparing known strings to values in the header.
For example,
in checking what the algorithm is,
the Unicode string encoding <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> will be checked against the member names
in the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> to see if there is a matching header parameter name.
A similar process occurs
when determining
if the value of the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter represents a supported algorithm.
Comparing Unicode strings, however, has significant security implications, as per <a class="reference internal" href="#jws-8"><em>Section 8</em></a>.</p>
<p>Comparisons between JSON strings and other Unicode strings MUST be performed as specified below:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Remove any JSON applied escaping to produce an array of Unicode code points.</li>
<li>Unicode Normalization [USA15] MUST NOT be applied at any point
to either the JSON string or to the string it is to be compared against.</li>
<li>Comparisons between the two strings MUST be performed
as a Unicode code point to code point equality comparison.</li>
</ol>
</div></blockquote>
<p>(v.03)</p>
</div>
<div class="section" id="signing-jwss-with-cryptographic-algorithms">
<span id="jws-6"></span><h2><a class="toc-backref" href="#id33">6.  Signing JWSs with Cryptographic Algorithms</a><a class="headerlink" href="#signing-jwss-with-cryptographic-algorithms" title="Permalink to this headline">¶</a></h2>
<p>JWSs use specific cryptographic algorithms
to sign the contents of the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> and the <a class="reference internal" href="#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>.
The use of the following algorithms for producing JWSs is defined in this section.
The table below is the list of <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values
reserved by this specification,
each of which is explained in more detail in the following sections:</p>
<table border="1" class="docutils" id="jws-table-3">
<caption>Table 3: JSON Web Signature Reserved Algorithm Values</caption>
<colgroup>
<col width="34%" />
<col width="66%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Alg Parameter Value</th>
<th class="head">Algorithm</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HS256</td>
<td>HMAC using SHA-256 hash algorithm</td>
</tr>
<tr class="row-odd"><td>HS384</td>
<td>HMAC using SHA-384 hash algorithm</td>
</tr>
<tr class="row-even"><td>HS512</td>
<td>HMAC using SHA-512 hash algorithm</td>
</tr>
<tr class="row-odd"><td>RS256</td>
<td>RSA using SHA-256 hash algorithm</td>
</tr>
<tr class="row-even"><td>RS384</td>
<td>RSA using SHA-384 hash algorithm</td>
</tr>
<tr class="row-odd"><td>RS512</td>
<td>RSA using SHA-512 hash algorithm</td>
</tr>
<tr class="row-even"><td>ES256</td>
<td>ECDSA using P-256 curve and SHA-256 hash algorithm</td>
</tr>
<tr class="row-odd"><td>ES384</td>
<td>ECDSA using P-384 curve and SHA-384 hash algorithm</td>
</tr>
<tr class="row-even"><td>ES512</td>
<td>ECDSA using P-521 curve and SHA-512 hash algorithm</td>
</tr>
</tbody>
</table>
<p>See <a class="reference internal" href="#jws-appendix-b"><em>Appendix B</em></a> for a table cross-referencing
the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> values used in this specification
with the equivalent identifiers used by other standards and software packages.</p>
<p>Of these algorithms,
only <a class="reference internal" href="glossary.html#term-hmac"><em class="xref std std-term">HMAC</em></a> <a class="reference internal" href="glossary.html#term-sha-256"><em class="xref std std-term">SHA-256</em></a> MUST be implemented by conforming implementations.
It is RECOMMENDED that implementations also support the <a class="reference internal" href="glossary.html#term-rsa"><em class="xref std std-term">RSA</em></a> <a class="reference internal" href="glossary.html#term-sha-256"><em class="xref std std-term">SHA-256</em></a>
and <a class="reference internal" href="glossary.html#term-ecdsa"><em class="xref std std-term">ECDSA</em></a> <a class="reference internal" href="glossary.html#term-p-256"><em class="xref std std-term">P-256</em></a> <a class="reference internal" href="glossary.html#term-sha-256"><em class="xref std std-term">SHA-256</em></a> algorithms.
Support for other algorithms and key sizes is OPTIONAL.</p>
<p>The signed content for a JWS is the same for all algorithms:
the concatenation of the <a class="reference internal" href="#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>,
a period (&#8216;.&#8217;) character,
and the <a class="reference internal" href="#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>.
This character sequence is referred to as the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a>.
Note that if the JWS represents a JWT,
this corresponds to the portion of the JWT representation preceding the second period character.
The UTF-8 representation of the JWS Signing Input is passed to the respective signing algorithms.</p>
<p>(v.03)</p>
<div class="section" id="creating-a-jws-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512">
<span id="jws-6-1"></span><h3><a class="toc-backref" href="#id34">6.1.  Creating a JWS with HMAC SHA-256, HMAC SHA-384, or HMAC SHA-512</a><a class="headerlink" href="#creating-a-jws-with-hmac-sha-256-hmac-sha-384-or-hmac-sha-512" title="Permalink to this headline">¶</a></h3>
<p>Hash based Message Authentication Codes (<a class="reference internal" href="glossary.html#term-hmac"><em class="xref std std-term">HMACs</em></a>) enable one
to use a <strong>secret</strong> plus a cryptographic <strong>hash function</strong>
to generate a Message Authentication Code (<a class="reference internal" href="glossary.html#term-mac"><em class="xref std std-term">MAC</em></a>).</p>
<p>This can be used to demonstrate that the MAC matches the hashed content,
in this case the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a>,
which therefore demonstrates that whoever generated the MAC was in possession of the secret.
The means of exchanging the shared key is outside the scope of this specification.</p>
<p>The algorithm for implementing and validating HMACs is provided in RFC 2104 [<span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2104.html"><strong>RFC 2104</strong></a>].
This section defines
the use of the HMAC SHA-256, HMAC SHA-384, and HMAC SHA-512 cryptographic hash functions
as defined in FIPS 180-3 [FIPS.180‑3].</p>
<p>The reserved <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values
HS256, HS384, and HS512 are used in the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> to indicate that
the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> contains a base64url encoded HMAC value
using the respective hash function.</p>
<p>The HMAC SHA-256 MAC is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Apply the HMAC SHA-256 algorithm to the UTF-8 representation of
the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> using the shared key to produce an HMAC.</li>
<li>Base64url encode the HMAC, as defined in this specification.</li>
</ol>
</div></blockquote>
<p>The output is the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> for that JWS.</p>
<p>The HMAC SHA-256 MAC for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Apply the HMAC SHA-256 algorithm to the UTF-8 representation of
the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> of the JWS using the shared key.</li>
<li>Base64url encode the previously generated HMAC,
as defined in this specification.</li>
<li>If the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a> and the previously calculated value exactly match,
then one has confirmation that the key was used to generate the HMAC
on the JWS and that the contents of the JWS have not be tampered with.</li>
<li>If the validation fails, the signed content MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Signing with the HMAC SHA-384 and HMAC SHA-512 algorithms is performed identically
to the procedure for HMAC SHA-256 - just with correspondingly longer key and result values.</p>
<p>(v.03)</p>
</div>
<div class="section" id="creating-a-jws-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512">
<span id="jws-6-2"></span><h3><a class="toc-backref" href="#id35">6.2.  Creating a JWS with RSA SHA-256, RSA SHA-384, or RSA SHA-512</a><a class="headerlink" href="#creating-a-jws-with-rsa-sha-256-rsa-sha-384-or-rsa-sha-512" title="Permalink to this headline">¶</a></h3>
<p>This section defines the use of the <a class="reference internal" href="glossary.html#term-rsassa-pkcs1-v1-5"><em class="xref std std-term">RSASSA-PKCS1-v1_5</em></a> signature algorithm
as defined in RFC 3447 [<span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3447.html"><strong>RFC 3447</strong></a>], Section 8.2 (commonly known as PKCS#1),
using SHA-256, SHA-384, or SHA-512 as the hash function.</p>
<p>The RSASSA-PKCS1-v1_5 algorithm is described in FIPS 186-3 [FIPS.186‑3], Section 5.5,
and the SHA-256, SHA-384, and SHA-512 cryptographic hash functions are defined in FIPS 180-3 [FIPS.180‑3].</p>
<p>The reserved <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values
RS256, RS384, and RS512 are used in the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> to indicate
that the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> contains a base64url encoded RSA signature
using the respective hash function.</p>
<p>The public keys employed may be retrieved
using Header Parameter methods described in <a class="reference internal" href="#jws-4-1"><em>Section 4.1</em></a> or
may be distributed using methods that are outside the scope of this specification.</p>
<p>A <strong>2048-bit or longer key length</strong> MUST be used with this algorithm.</p>
<p>The RSA SHA-256 signature is generated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the UTF-8 representation of
the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> using RSASSA-PKCS1-V1_5-SIGN and
the SHA-256 hash function with the desired private key.
The output will be a byte array.</li>
<li>Base64url encode the byte array, as defined in this specification.</li>
</ol>
</div></blockquote>
<p>The output is the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> for that JWS.</p>
<p>The RSA SHA-256 signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> and base64url decode it into a byte array.
If decoding fails, the signed content MUST be rejected.</li>
<li>Submit the UTF-8 representation of the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> and the public key
corresponding to the private key used by the signer to the RSASSA-PKCS1-V1_5-VERIFY algorithm
using SHA-256 as the hash function.</li>
<li>If the validation fails, the signed content MUST be rejected.</li>
</ol>
</div></blockquote>
<p>Signing with the RSA SHA-384 and RSA SHA-512 algorithms is performed identically to the procedure for RSA SHA-256 -
just with correspondingly longer key and result values.</p>
<p>(v.03)</p>
</div>
<div class="section" id="creating-a-jws-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512">
<span id="jws-6-3"></span><h3><a class="toc-backref" href="#id36">6.3.  Creating a JWS with ECDSA P-256 SHA-256, ECDSA P-384 SHA-384, or ECDSA P-521 SHA-512</a><a class="headerlink" href="#creating-a-jws-with-ecdsa-p-256-sha-256-ecdsa-p-384-sha-384-or-ecdsa-p-521-sha-512" title="Permalink to this headline">¶</a></h3>
<p>The Elliptic Curve Digital Signature Algorithm (<a class="reference internal" href="glossary.html#term-ecdsa"><em class="xref std std-term">ECDSA</em></a>) is defined by FIPS 186-3 [FIPS.186‑3].
ECDSA provides for the use of Elliptic Curve cryptography,
which is able to provide equivalent security to RSA cryptography
but using shorter key lengths and with greater processing speed.
This means that ECDSA signatures will be substantially smaller
in terms of length than equivalently strong RSA Digital Signatures.</p>
<p>This specification defines the use of ECDSA with the P-256 curve
and the SHA-256 cryptographic hash function,
ECDSA with the P-384 curve and the SHA-384 hash function,
and ECDSA with the P-521 curve and the SHA-512 hash function.
The P-256, P-384, and P-521 curves are also defined in FIPS 186-3.
The reserved <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values
ES256, ES384, and ES512 are used in the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a>
to indicate that the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> contains
a base64url encoded ECDSA P-256 SHA-256, ECDSA P-384 SHA-384,
or ECDSA P-521 SHA-512 signature, respectively.</p>
<p>The public keys employed may be retrieved
using Header Parameter methods described in <em class="xref std std-ref">Section 4.1 &lt;jws.4.1&gt;`</em>
or may be distributed using methods that are outside the scope of this specification.</p>
<p>A JWS is signed with an ECDSA P-256 SHA-256 signature as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Generate a digital signature of the UTF-8 representation of
the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> using ECDSA P-256 SHA-256
with the desired private key.
The output will be the EC point (R, S), where R and S are unsigned integers.</li>
<li>Turn R and S into byte arrays in big endian order.
Each array will be 32 bytes long.</li>
<li>Concatenate the two byte arrays in the order R and then S.</li>
<li>Base64url encode the 64 byte array, as defined in this specification.</li>
</ol>
</div></blockquote>
<p>The output is the Encoded JWS Signature for the JWS.</p>
<p>The ECDSA P-256 SHA-256 signature for a JWS is validated as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Take the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>
and base64url decode it into a byte array.
If decoding fails, the signed content MUST be rejected.</li>
<li>The output of the base64url decoding MUST be a 64 byte array.</li>
<li>Split the 64 byte array into two 32 byte arrays.
The first array will be R and the second S.
Remember that the byte arrays are in big endian byte order;
please check the ECDSA validator in use to see what byte order it requires.</li>
<li>Submit the UTF-8 representation of the JWS Signing Input,
R, S and the public key (x, y) to the ECDSA P-256 SHA-256 validator.</li>
<li>If the validation fails, the signed content MUST be rejected.</li>
</ol>
</div></blockquote>
<p>The ECDSA validator will then determine
if the digital signature is valid,
given the inputs.
Note that ECDSA digital signature contains a value referred to as K,
which is a random number generated for each digital signature instance.
This means that two ECDSA digital signatures
using exactly the same input parameters will output different signatures
because their K values will be different.
The consequence of this is that one must validate an ECDSA signature
by submitting the previously specified inputs to an ECDSA validator.</p>
<p>Signing with the ECDSA P-384 SHA-384 and
ECDSA P-521 SHA-512 algorithms is performed identically
to the procedure for ECDSA P-256 SHA-256
- just with correspondingly longer key and result values.</p>
<p>(v.03)</p>
</div>
<div class="section" id="additional-algorithms">
<span id="jws-6-4"></span><h3><a class="toc-backref" href="#id37">6.4.  Additional Algorithms</a><a class="headerlink" href="#additional-algorithms" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWSs
with corresponding <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values
being defined to refer to them.
New <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values SHOULD either be defined
in the IANA JSON Web Signature Algorithms registry
or be a URI that contains a collision resistant namespace.</p>
<p>In particular,
the use of algorithm identifiers defined in XML DSIG [RFC3275]
and related specifications is permitted.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="iana-considerations">
<span id="jws-7"></span><h2><a class="toc-backref" href="#id38">7.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This specification calls for:</p>
<blockquote>
<div><ul class="simple">
<li>A new IANA registry entitled
&#8220;JSON Web Signature Header Parameters&#8221; for reserved header parameter names
is defined in <a class="reference internal" href="#jws-4-1"><em>Section 4.1</em></a>.
Inclusion in the registry is RFC Required in the RFC 5226 [RFC5226] sense
for reserved JWS header parameter names
that are intended to be interoperable between implementations.
The registry will just record the reserved header parameter name
and a pointer to the RFC that defines it.
This specification defines inclusion of the header parameter names defined
in <a class="reference internal" href="#jws-table-1"><em>Table 1</em></a>.</li>
<li>A new IANA registry entitled &#8220;JSON Web Signature Algorithms&#8221;
for reserved values used with the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> header parameter values is defined
in <a class="reference internal" href="#jws-6-4"><em>Section 6.4</em></a>.
Inclusion in the registry is RFC Required in the RFC 5226 [RFC5226] sense.
The registry will just record the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value and a pointer to the RFC
that defines it.
This specification defines inclusion of the algorithm values defined
in <a class="reference internal" href="#jws-table-3"><em>Table 3</em></a>.</li>
</ul>
</div></blockquote>
<p>(v.03)</p>
</div>
<div class="section" id="security-considerations">
<span id="jws-8"></span><h2><a class="toc-backref" href="#id39">8.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD: Lots of work to do here. We need to remember to look into any issues relating to security and JSON parsing. One wonders just how secure most JSON parsing libraries are. Were they ever hardened for security scenarios? If not, what kind of holes does that open up? Also, we need to walk through the JSON standard and see what kind of issues we have especially around comparison of names. For instance, comparisons of header parameter names and other parameters must occur after they are unescaped. Need to also put in text about: Importance of keeping secrets secret. Rotating keys. Strengths and weaknesses of the different algorithms.</p>
<p>TBD: Need to put in text about why strict JSON validation is necessary. Basically, that if malformed JSON is received then the intent of the sender is impossible to reliably discern. One example of malformed JSON that MUST be rejected is an object in which the same member name occurs multiple times.</p>
<p>TBD: Write security considerations about the implications of using a SHA-1 hash (for compatibility reasons) for the x5t (x.509 certificate thumbprint).</p>
<p>When utilizing TLS to retrieve information, the authority providing the resource MUST be authenticated and the information retrieved MUST be free from modification.</p>
<p>(v.03)</p>
</div>
<div class="section" id="references">
<span id="jws-10"></span><h2><a class="toc-backref" href="#id40">10.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(v.03)</p>
<div class="section" id="normative-references">
<span id="jws-10-1"></span><h3><a class="toc-backref" href="#id41">10.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>[FIPS.180-3]</dt>
<dd>National Institute of Standards and Technology, “Secure Hash Standard (SHS),” FIPS PUB 180-3, October 2008.</dd>
<dt>[FIPS.186-3]</dt>
<dd>National Institute of Standards and Technology, “Digital Signature Standard (DSS),” FIPS PUB 186-3, June 2009.</dd>
<dt>[JWK]</dt>
<dd>Jones, M., “JSON Web Key (JWK),” October 2011.</dd>
<dt>[RFC1421]</dt>
<dd>Linn, J., “Privacy Enhancement for Internet Electronic Mail: Part I: Message Encryption and Authentication Procedures,” RFC 1421, February 1993 (TXT).</dd>
<dt>[RFC1738]</dt>
<dd>Berners-Lee, T., Masinter, L., and M. McCahill, “Uniform Resource Locators (URL),” RFC 1738, December 1994 (TXT).</dd>
<dt>[RFC2045]</dt>
<dd>Freed, N. and N. Borenstein, “Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,” RFC 2045, November 1996 (TXT).</dd>
<dt>[RFC2104]</dt>
<dd>Krawczyk, H., Bellare, M., and R. Canetti, “HMAC: Keyed-Hashing for Message Authentication,” RFC 2104, February 1997 (TXT).</dd>
<dt>[RFC2119]</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt>[RFC2818]</dt>
<dd>Rescorla, E., “HTTP Over TLS,” RFC 2818, May 2000 (TXT).</dd>
<dt>[RFC3339]</dt>
<dd>Klyne, G., Ed. and C. Newman, “Date and Time on the Internet: Timestamps,” RFC 3339, July 2002 (TXT, HTML, XML).</dd>
<dt>[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, “Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,” RFC 3447, February 2003 (TXT).</dd>
<dt>[RFC3629]</dt>
<dd>Yergeau, F., “UTF-8, a transformation format of ISO 10646,” STD 63, RFC 3629, November 2003 (TXT).</dd>
<dt>[RFC3986]</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” STD 66, RFC 3986, January 2005 (TXT, HTML, XML).</dd>
<dt>[RFC4627]</dt>
<dd>Crockford, D., “The application/json Media Type for JavaScript Object Notation (JSON),” RFC 4627, July 2006 (TXT).</dd>
<dt>[RFC4648]</dt>
<dd>Josefsson, S., “The Base16, Base32, and Base64 Data Encodings,” RFC 4648, October 2006 (TXT).</dd>
<dt>[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, “Guidelines for Writing an IANA Considerations Section in RFCs,” BCP 26, RFC 5226, May 2008 (TXT).</dd>
<dt>[RFC5246]</dt>
<dd>Dierks, T. and E. Rescorla, “The Transport Layer Security (TLS) Protocol Version 1.2,” RFC 5246, August 2008 (TXT).</dd>
<dt>[RFC5280]</dt>
<dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, “Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,” RFC 5280, May 2008 (TXT).</dd>
<dt>[RFC5785]</dt>
<dd>Nottingham, M. and E. Hammer-Lahav, “Defining Well-Known Uniform Resource Identifiers (URIs),” RFC 5785, April 2010 (TXT).</dd>
<dt>[RFC6125]</dt>
<dd>Saint-Andre, P. and J. Hodges, “Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),” RFC 6125, March 2011 (TXT).</dd>
<dt>[USA15]</dt>
<dd>Davis, M., Whistler, K., and M. Dürst, “Unicode Normalization Forms,” Unicode Standard Annex 15, 09 2009.</dd>
</dl>
<p>(v.03)</p>
</div>
<div class="section" id="informative-references">
<span id="jws-10-2"></span><h3><a class="toc-backref" href="#id42">10.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>[CanvasApp]</dt>
<dd>Facebook, “Canvas Applications,” 2010.</dd>
<dt>[JCA]</dt>
<dd>Oracle, “Java Cryptography Architecture,” 2011.</dd>
<dt>[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), “JSON Simple Sign,” September 2010.</dd>
<dt>[JWE]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, “JSON Web Encryption (JWE),” October 2011.</dd>
<dt>[JWT]</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Token (JWT),” October 2011.</dd>
<dt>[MagicSignatures]</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, “Magic Signatures,” August 2010.</dd>
<dt>[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, “(Extensible Markup Language) XML-Signature Syntax and Processing,” RFC 3275, March 2002 (TXT).</dd>
</dl>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="appendix-a-jws-examples">
<span id="jws-appendix-a"></span><h2><a class="toc-backref" href="#id43">Appendix A.  JWS Examples</a><a class="headerlink" href="#appendix-a-jws-examples" title="Permalink to this headline">¶</a></h2>
<p>This section provides several examples of JWSs.
While these examples all represent JSON Web Tokens (JWTs) [JWT],
the payload can be any base64url encoded content.</p>
<p>(v.03)</p>
<div class="section" id="a-1-jws-using-hmac-sha-256">
<span id="jws-appendix-a-1"></span><h3><a class="toc-backref" href="#id44">A.1.  JWS using HMAC SHA-256</a><a class="headerlink" href="#a-1-jws-using-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-1-1-encoding">
<span id="jws-appendix-a-1-1"></span><h4><a class="toc-backref" href="#id45">A.1.1.  Encoding</a><a class="headerlink" href="#a-1-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The following example <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> declares
that the data structure is a JSON Web Token (JWT) [JWT]
and the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> is signed using the HMAC SHA-256 algorithm.
Note that
white space is explicitly allowed in <em class="xref std std-term">JWS Header strings</em>
and no canonicalization is performed before encoding.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;typ&quot;</span><span class="p">:</span><span class="s">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The following byte array contains the UTF-8 characters for the JWS Header:</p>
<dl class="docutils">
<dt>::</dt>
<dd>[123, 34, 116, 121, 112, 34, 58, 34, 74, 87, 84, 34, 44, 13, 10, 32, 34, 97, 108, 103, 34, 58, 34, 72, 83, 50, 53, 54, 34, 125]</dd>
</dl>
<p>Base64url encoding this UTF-8 representation yields this Encoded JWS Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example follows. (Note that the payload can be any base64url encoded content, and need not be a base64url encoded JSON object.)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>The following byte array contains the UTF-8 characters for the JWS Payload:</p>
<dl class="docutils">
<dt>::</dt>
<dd>[123, 34, 105, 115, 115, 34, 58, 34, 106, 111, 101, 34, 44, 13, 10, 32, 34, 101, 120, 112, 34, 58, 49, 51, 48, 48, 56, 49, 57, 51, 56, 48, 44, 13, 10, 32, 34, 104, 116, 116, 112, 58, 47, 47, 101, 120, 97, 109, 112, 108, 101, 46, 99, 111, 109, 47, 105, 115, 95, 114, 111, 111, 116, 34, 58, 116, 114, 117, 101, 125]</dd>
</dl>
<p>Base64url encoding the above yields the Encoded JWS Payload value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Concatenating the Encoded JWS Header, a period character, and the Encoded JWS Payload yields this JWS Signing Input value (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The UTF-8 representation of the JWS Signing Input is the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>HMACs are generated using keys. This example uses the key represented by the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">163</span><span class="p">]</span>
</pre></div>
</div>
<p>Running the HMAC SHA-256 algorithm on the UTF-8 representation of the JWS Signing Input with this key yields the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">116</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">121</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding the above HMAC output yields the Encoded JWS Signature value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dBjftJeZ4CVP</span><span class="o">-</span><span class="n">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="a-1-2-decoding">
<span id="jws-appendix-a-1-2"></span><h4><a class="toc-backref" href="#id46">A.1.2.  Decoding</a><a class="headerlink" href="#a-1-2-decoding" title="Permalink to this headline">¶</a></h4>
<p>Decoding the JWS first requires
removing the base64url encoding from the <a class="reference internal" href="#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>,
the <a class="reference internal" href="#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>,
and the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>.</p>
<p>We base64url decode the inputs
and turn them into the corresponding byte arrays.</p>
<p>We translate the header input byte array containing UTF-8 encoded characters
into the <em class="xref std std-term">JWS Header string</em>.</p>
<p>(v.03)</p>
</div>
<div class="section" id="a-1-3-validating">
<span id="jws-appendix-a-1-3"></span><h4><a class="toc-backref" href="#id47">A.1.3.  Validating</a><a class="headerlink" href="#a-1-3-validating" title="Permalink to this headline">¶</a></h4>
<p>Next we validate the decoded results.</p>
<p>Since the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> parameter in the header is &#8220;HS256&#8221;,
we validate the HMAC SHA-256 signature contained in the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a>.
If any of the validation steps fail,
the signed content MUST be rejected.</p>
<p>First, we validate that the JWS Header string is legal JSON.</p>
<p>To validate the signature,
we repeat the previous process of using the correct key
and the UTF-8 representation of the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a>
as input to a SHA-256 HMAC function
and then taking the output and determining
if it matches the <a class="reference internal" href="#term-jws-signature"><em class="xref std std-term">JWS Signature</em></a>.</p>
<p>If it matches exactly, the signature has been validated.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="a-2-jws-using-rsa-sha-256">
<span id="jws-appendix-a-2"></span><h3><a class="toc-backref" href="#id48">A.2.  JWS using RSA SHA-256</a><a class="headerlink" href="#a-2-jws-using-rsa-sha-256" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a-2-1-encoding">
<span id="jws-appendix-a-2-1"></span><h4><a class="toc-backref" href="#id49">A.2.1.  Encoding</a><a class="headerlink" href="#a-2-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The JWS Header in this example is different from the previous example in two ways: First, because a different algorithm is being used, the alg value is different. Second, for illustration purposes only, the optional &#8220;typ&#8221; parameter is not used. (This difference is not related to the signature algorithm employed.) The JWS Header used is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;RS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The following byte array contains the UTF-8 characters for the JWS Header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding this UTF-8 representation yields this Encoded JWS Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJSUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, which follows, is the same as in the previous example. Since the Encoded JWS Payload will therefore be the same, its computation is not repeated here.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Concatenating the Encoded JWS Header, a period character, and the Encoded JWS Payload yields this JWS Signing Input value (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJSUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The UTF-8 representation of the JWS Signing Input is the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>The RSA key consists of a public part (n, e), and a private exponent d. The values of the RSA key used in this example, presented as the byte arrays representing big endian integers are:</p>
<p>Parameter Name / Value</p>
<blockquote>
<div><dl class="docutils">
<dt>n</dt>
<dd>[161, 248, 22, 10, 226, 227, 201, 180, 101, 206, 141, 45, 101, 98, 99, 54, 43, 146, 125, 190, 41, 225, 240, 36, 119, 252, 22, 37, 204, 144, 161, 54, 227, 139, 217, 52, 151, 197, 182, 234, 99, 221, 119, 17, 230, 124, 116, 41, 249, 86, 176, 251, 138, 143, 8, 154, 220, 75, 105, 137, 60, 193, 51, 63, 83, 237, 208, 25, 184, 119, 132, 37, 47, 236, 145, 79, 228, 133, 119, 105, 89, 75, 234, 66, 128, 211, 44, 15, 85, 191, 98, 148, 79, 19, 3, 150, 188, 110, 155, 223, 110, 189, 210, 189, 163, 103, 142, 236, 160, 198, 104, 247, 1, 179, 141, 191, 251, 56, 200, 52, 44, 226, 254, 109, 39, 250, 222, 74, 90, 72, 116, 151, 157, 212, 185, 207, 154, 222, 196, 199, 91, 5, 133, 44, 44, 15, 94, 248, 165, 193, 117, 3, 146, 249, 68, 232, 237, 100, 193, 16, 198, 182, 71, 96, 154, 164, 120, 58, 235, 156, 108, 154, 215, 85, 49, 48, 80, 99, 139, 131, 102, 92, 111, 111, 122, 130, 163, 150, 112, 42, 31, 100, 27, 130, 211, 235, 242, 57, 34, 25, 73, 31, 182, 134, 135, 44, 87, 22, 245, 10, 248, 53, 141, 154, 139, 157, 23, 195, 64, 114, 143, 127, 135, 216, 154, 24, 216, 252, 171, 103, 173, 132, 89, 12, 46, 207, 117, 147, 57, 54, 60, 7, 3, 77, 111, 96, 111, 158, 33, 224, 84, 86, 202, 229, 233, 161]</dd>
<dt>e</dt>
<dd>[1, 0, 1]</dd>
<dt>d</dt>
<dd>[18, 174, 113, 164, 105, 205, 10, 43, 195, 126, 82, 108, 69, 0, 87, 31, 29, 97, 117, 29, 100, 233, 73, 112, 123, 98, 89, 15, 157, 11, 165, 124, 150, 60, 64, 30, 63, 207, 47, 44, 211, 189, 236, 136, 229, 3, 191, 198, 67, 155, 11, 40, 200, 47, 125, 55, 151, 103, 31, 82, 19, 238, 216, 193, 90, 37, 216, 213, 206, 160, 2, 94, 227, 171, 46, 139, 127, 121, 33, 111, 198, 59, 234, 86, 39, 83, 180, 6, 68, 198, 161, 81, 39, 217, 178, 149, 69, 64, 160, 187, 225, 163, 5, 86, 152, 45, 78, 159, 222, 95, 100, 37, 241, 77, 75, 113, 52, 65, 181, 93, 199, 59, 155, 74, 237, 204, 146, 172, 227, 146, 126, 55, 245, 125, 12, 253, 94, 117, 129, 250, 81, 44, 143, 73, 97, 169, 235, 11, 128, 248, 168, 7, 70, 114, 138, 85, 255, 70, 71, 31, 52, 37, 6, 59, 157, 83, 100, 47, 94, 222, 30, 132, 214, 19, 8, 26, 250, 92, 34, 208, 81, 40, 91, 214, 59, 148, 59, 86, 93, 137, 138, 5, 104, 84, 19, 229, 60, 60, 108, 101, 37, 255, 31, 227, 78, 61, 220, 112, 240, 213, 100, 80, 253, 164, 139, 161, 46, 16, 78, 157, 235, 159, 184, 24, 129, 225, 196, 189, 242, 93, 146, 71, 244, 80, 200, 101, 146, 121, 104, 231, 115, 52, 244, 65, 79, 117, 167, 80, 225, 57, 84, 110, 58, 138, 115, 157]</dd>
</dl>
</div></blockquote>
<p>The RSA private key (n, d) is then passed to the RSA signing function, which also takes the hash type, SHA-256, and the UTF-8 representation of the JWS Signing Input as inputs. The result of the signature is a byte array S, which represents a big endian integer. In this example, S is:</p>
<p>Reulst Nave / Value</p>
<blockquote>
<div><dl class="docutils">
<dt>s</dt>
<dd>[112, 46, 33, 137, 67, 232, 143, 209, 30, 181, 216, 45, 191, 120, 69, 243, 65, 6, 174, 27, 129, 255, 247, 115, 17, 22, 173, 209, 113, 125, 131, 101, 109, 66, 10, 253, 60, 150, 238, 221, 115, 162, 102, 62, 81, 102, 104, 123, 0, 11, 135, 34, 110, 1, 135, 237, 16, 115, 249, 69, 229, 130, 173, 252, 239, 22, 216, 90, 121, 142, 232, 198, 109, 219, 61, 184, 151, 91, 23, 208, 148, 2, 190, 237, 213, 217, 217, 112, 7, 16, 141, 178, 129, 96, 213, 248, 4, 12, 167, 68, 87, 98, 184, 31, 190, 127, 249, 217, 46, 10, 231, 111, 36, 242, 91, 51, 187, 230, 244, 74, 230, 30, 177, 4, 10, 203, 32, 4, 77, 62, 249, 18, 142, 212, 1, 48, 121, 91, 212, 189, 59, 65, 238, 202, 208, 102, 171, 101, 25, 129, 253, 228, 141, 247, 127, 55, 45, 195, 139, 159, 175, 221, 59, 239, 177, 139, 93, 163, 204, 60, 46, 176, 47, 158, 58, 65, 214, 18, 202, 173, 21, 145, 18, 115, 160, 95, 35, 185, 232, 56, 250, 175, 132, 157, 105, 132, 41, 239, 90, 30, 136, 121, 130, 54, 195, 212, 14, 96, 69, 34, 165, 68, 200, 242, 122, 122, 45, 184, 6, 99, 209, 108, 247, 202, 234, 86, 222, 64, 92, 178, 33, 90, 69, 178, 194, 85, 102, 181, 90, 193, 167, 72, 160, 112, 223, 200, 163, 42, 70, 149, 67, 208, 25, 238, 251, 71]</dd>
</dl>
</div></blockquote>
<p>Base64url encoding the signature produces this value for the Encoded JWS Signature:</p>
<div class="highlight-python"><pre>cC4hiUPoj9Eetdgtv3hF80EGrhuB__dzERat0XF9g2VtQgr9PJbu3XOiZj5RZmh7AAuHIm4Bh-0Qc_lF5YKt_O8W2Fp5jujGbds9uJdbF9CUAr7t1dnZcAcQjbKBYNX4BAynRFdiuB--f_nZLgrnbyTyWzO75vRK5h6xBArLIARNPvkSjtQBMHlb1L07Qe7K0GarZRmB_eSN9383LcOLn6_dO--xi12jzDwusC-eOkHWEsqtFZESc6BfI7noOPqvhJ1phCnvWh6IeYI2w9QOYEUipUTI8np6LbgGY9Fs98rqVt5AXLIhWkWywlVmtVrBp0igcN_IoypGlUPQGe77Rw</pre>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="a-2-2-decoding">
<span id="jws-appendix-a-2-2"></span><h4><a class="toc-backref" href="#id50">A.2.2.  Decoding</a><a class="headerlink" href="#a-2-2-decoding" title="Permalink to this headline">¶</a></h4>
<p>Decoding the JWS from this example requires processing the Encoded JWS Header and Encoded JWS Payload exactly as done in the first example.</p>
<p>(v.03)</p>
</div>
<div class="section" id="a-2-3-validating">
<span id="jws-appendix-a-2-3"></span><h4><a class="toc-backref" href="#id51">A.2.3.  Validating</a><a class="headerlink" href="#a-2-3-validating" title="Permalink to this headline">¶</a></h4>
<p>Since the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> parameter in the header is &#8220;RS256&#8221;,
we validate the RSA SHA-256 signature contained in the JWS Signature.
If any of the validation steps fail,
the signed content MUST be rejected.</p>
<p>First, we validate that the <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> string is legal JSON.</p>
<p>Validating the JWS Signature is a little different
from the previous example.</p>
<p>First,
we base64url decode the <a class="reference internal" href="#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>
to produce a signature S to check.</p>
<p>We then pass (n, e),
S and the UTF-8 representation of the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a>
to an RSA signature verifier that has been configured
to use the SHA-256 hash function.</p>
<p>(v.03)</p>
</div>
</div>
<div class="section" id="a-3-jws-using-ecdsa-p-256-sha-256">
<span id="jws-appendix-a-3"></span><h3><a class="toc-backref" href="#id52">A.3.  JWS using ECDSA P-256 SHA-256</a><a class="headerlink" href="#a-3-jws-using-ecdsa-p-256-sha-256" title="Permalink to this headline">¶</a></h3>
<p>(v.03)</p>
<div class="section" id="a-3-1-encoding">
<span id="jws-appendix-a-3-1"></span><h4><a class="toc-backref" href="#id53">A.3.1.  Encoding</a><a class="headerlink" href="#a-3-1-encoding" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> for this example
differs from the previous example because a different algorithm is being used.
The <a class="reference internal" href="#term-jws-header"><em class="xref std std-term">JWS Header</em></a> used is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;ES256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The following byte array contains the UTF-8 characters for the JWS Header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">123</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">125</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding this UTF-8 representation yields this Encoded JWS Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJFUzI1NiJ9</span>
</pre></div>
</div>
<p>The JWS Payload used in this example, which follows, is the same as in the previous examples. Since the Encoded JWS Payload will therefore be the same, its computation is not repeated here.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Concatenating the Encoded JWS Header, a period character, and the Encoded JWS Payload yields this JWS Signing Input value (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJFUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</pre>
</div>
<p>The UTF-8 representation of the JWS Signing Input is the following byte array:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">]</span>
</pre></div>
</div>
<p>The ECDSA key consists of a public part, the EC point (x, y), and a private part d. The values of the ECDSA key used in this example, presented as the byte arrays representing big endian integers are:</p>
<p>Parameter Name /Value</p>
<blockquote>
<div><dl class="docutils">
<dt>x</dt>
<dd>[127, 205, 206, 39, 112, 246, 196, 93, 65, 131, 203, 238, 111, 219, 75, 123, 88, 7, 51, 53, 123, 233, 239, 19, 186, 207, 110, 60, 123, 209, 84, 69]</dd>
<dt>y</dt>
<dd>[199, 241, 68, 205, 27, 189, 155, 126, 135, 44, 223, 237, 185, 238, 185, 244, 179, 105, 93, 110, 169, 11, 36, 173, 138, 70, 35, 40, 133, 136, 229, 173]</dd>
<dt>d</dt>
<dd>[142, 155, 16, 158, 113, 144, 152, 191, 152, 4, 135, 223, 31, 93, 119, 233, 203, 41, 96, 110, 190, 210, 38, 59, 95, 87, 194, 19, 223, 132, 244, 178]</dd>
</dl>
</div></blockquote>
<p>The ECDSA <em class="xref std std-term">private part</em> <strong>d</strong> is then passed to an ECDSA signing function,
which also takes the curve type, P-256,
the hash type, SHA-256,
and the UTF-8 representation of the <a class="reference internal" href="#term-jws-signing-input"><em class="xref std std-term">JWS Signing Input</em></a> as inputs.
The result of the signature is the EC point (R, S),
where R and S are unsigned integers.</p>
<p>In this example, the R and S values,
given as byte arrays representing big endian integers are:</p>
<p>Result Name / Value</p>
<blockquote>
<div><dl class="docutils">
<dt>R</dt>
<dd>[14, 209, 33, 83, 121, 99, 108, 72, 60, 47, 127, 21, 88, 7, 212, 2, 163, 178, 40, 3, 58, 249, 124, 126, 23, 129, 154, 195, 22, 158, 166, 101]</dd>
<dt>S</dt>
<dd>[197, 10, 7, 211, 140, 60, 112, 229, 216, 241, 45, 175, 8, 74, 84, 128, 166, 101, 144, 197, 242, 147, 80, 154, 143, 63, 127, 138, 131, 163, 84, 213]</dd>
</dl>
</div></blockquote>
<p>Concatenating the S array to the end of the R array and base64url encoding the result produces this value for the Encoded JWS Signature:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">DtEhU3ljbEg8L38VWAfUAqOyKAM6</span><span class="o">-</span><span class="n">Xx</span><span class="o">-</span><span class="n">F4GawxaepmXFCgfTjDxw5djxLa8ISlSApmWQxfKTUJqPP3</span><span class="o">-</span><span class="n">Kg6NU1Q</span>
</pre></div>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="a-3-2-decoding">
<span id="jws-appendix-a-3-2"></span><h4><a class="toc-backref" href="#id54">A.3.2.  Decoding</a><a class="headerlink" href="#a-3-2-decoding" title="Permalink to this headline">¶</a></h4>
<p>Decoding the JWS from this example requires processing the Encoded JWS Header and Encoded JWS Payload exactly as done in the first example.</p>
<p>(v.03)</p>
</div>
<div class="section" id="a-3-3-validating">
<span id="jws-appendix-a-3-3"></span><h4><a class="toc-backref" href="#id55">A.3.3.  Validating</a><a class="headerlink" href="#a-3-3-validating" title="Permalink to this headline">¶</a></h4>
<p>Since the alg parameter in the header is &#8220;ES256&#8221;, we validate the ECDSA P-256 SHA-256 signature contained in the JWS Signature. If any of the validation steps fail, the signed content MUST be rejected.</p>
<p>First, we validate that the JWS Header string is legal JSON.</p>
<p>Validating the JWS Signature is a little different from the first example. First, we base64url decode the Encoded JWS Signature as in the previous examples but we then need to split the 64 member byte array that must result into two 32 byte arrays, the first R and the second S. We then pass (x, y), (R, S) and the UTF-8 representation of the JWS Signing Input to an ECDSA signature verifier that has been configured to use the P-256 curve with the SHA-256 hash function.</p>
<p>As explained in <a class="reference internal" href="#jws-6-3"><em>Section 6.3</em></a>,
the use of the <strong>k</strong> value in ECDSA means
that we cannot validate the correctness of the signature in the same way we validated
the correctness of the HMAC.</p>
<p>Instead, implementations MUST use an ECDSA validator to validate the signature.</p>
<p>(v.03)</p>
</div>
</div>
</div>
<div class="section" id="appendix-b-algorithm-identifier-cross-reference">
<span id="jws-appendix-b"></span><h2><a class="toc-backref" href="#id56">Appendix B.  Algorithm Identifier Cross-Reference</a><a class="headerlink" href="#appendix-b-algorithm-identifier-cross-reference" title="Permalink to this headline">¶</a></h2>
<p>This appendix contains a table cross-referencing the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> values
used in this specification with the equivalent identifiers
used by other standards and software packages.</p>
<p>See XML DSIG [RFC3275] and Java Cryptography Architecture [JCA]
for more information about the names defined by those documents.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="8%" />
<col width="42%" />
<col width="15%" />
<col width="18%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Algorithm</th>
<th class="head">JWS</th>
<th class="head">XML DSIG</th>
<th class="head">JCA</th>
<th class="head">OID</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>HMAC
using SHA-256
hash algorithm</td>
<td>HS256</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha256">http://www.w3.org/2001/04/xmldsig-more#hmac-sha256</a></td>
<td>HmacSHA256</td>
<td>1.2.840.113549.2.9
<a class="footnote-reference" href="#id12" id="id3">[2]</a></td>
</tr>
<tr class="row-odd"><td>HMAC
using SHA-384
hash algorithm</td>
<td>HS384</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha384">http://www.w3.org/2001/04/xmldsig-more#hmac-sha384</a></td>
<td>HmacSHA384</td>
<td>1.2.840.113549.2.10
<a class="footnote-reference" href="#id13" id="id4">[3]</a></td>
</tr>
<tr class="row-even"><td>HMAC
using SHA-512
hash algorithm</td>
<td>HS512</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#hmac-sha512">http://www.w3.org/2001/04/xmldsig-more#hmac-sha512</a></td>
<td>HmacSHA512</td>
<td>1.2.840.113549.2.11
<a class="footnote-reference" href="#id14" id="id5">[4]</a></td>
</tr>
<tr class="row-odd"><td>RSA
using SHA-256
hash algorithm</td>
<td>RS256</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256">http://www.w3.org/2001/04/xmldsig-more#rsa-sha256</a></td>
<td>SHA256withRSA</td>
<td>1.2.840.113549.1.1.11
<a class="footnote-reference" href="#id15" id="id6">[5]</a></td>
</tr>
<tr class="row-even"><td>RSA
using SHA-384
hash algorithm</td>
<td>RS384</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#rsa-sha384">http://www.w3.org/2001/04/xmldsig-more#rsa-sha384</a></td>
<td>SHA384withRSA</td>
<td>1.2.840.113549.1.1.12
<a class="footnote-reference" href="#id16" id="id7">[6]</a></td>
</tr>
<tr class="row-odd"><td>RSA
using SHA-512
hash algorithm</td>
<td>RS512</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#rsa-sha512">http://www.w3.org/2001/04/xmldsig-more#rsa-sha512</a></td>
<td>SHA512withRSA</td>
<td>1.2.840.113549.1.1.13
<a class="footnote-reference" href="#id17" id="id8">[7]</a></td>
</tr>
<tr class="row-even"><td>ECDSA using
P-256 curve and
SHA-256
hash algorithm</td>
<td>ES256</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha256</a></td>
<td>SHA256withECDSA</td>
<td>1.2.840.10045.3.1.7
1.2.840.10045.4.3.2
<a class="footnote-reference" href="#id18" id="id9">[8]</a></td>
</tr>
<tr class="row-odd"><td>ECDSA using
P-384 curve and
SHA-384
hash algorithm</td>
<td>ES384</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha384</a></td>
<td>SHA384withECDSA</td>
<td>1.3.132.0.34
1.2.840.10045.4.3.3
<a class="footnote-reference" href="#id19" id="id10">[9]</a></td>
</tr>
<tr class="row-even"><td>ECDSA using
P-512 curve and
SHA-512
hash algorithm</td>
<td>ES512</td>
<td><a class="reference external" href="http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512">http://www.w3.org/2001/04/xmldsig-more#ecdsa-sha512</a></td>
<td>SHA512withECDSA</td>
<td>1.3.132.0.35
1.2.840.10045.4.3.4
<a class="footnote-reference" href="#id20" id="id11">[10]</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id12" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>hamcWithSHA256 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.2.9">http://www.oid-info.com/get/1.2.840.113549.2.9</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>hamcWithSHA384 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.2.10">http://www.oid-info.com/get/1.2.840.113549.2.10</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id14" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td>hamcWithSHA512 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.2.11">http://www.oid-info.com/get/1.2.840.113549.2.11</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id15" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td>sha256WithRSAEncryption <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.1.1.11">http://www.oid-info.com/get/1.2.840.113549.1.1.11</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id16" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id7">[6]</a></td><td>sha384WithRSAEncryption <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.1.1.12">http://www.oid-info.com/get/1.2.840.113549.1.1.12</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id17" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[7]</a></td><td>sha512WithRSAEncryption <a class="reference external" href="http://www.oid-info.com/get/1.2.840.113549.1.1.13">http://www.oid-info.com/get/1.2.840.113549.1.1.13</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id18" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id9">[8]</a></td><td>ecdsa-with-SHA256 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.10045.4.3.2">http://www.oid-info.com/get/1.2.840.10045.4.3.2</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id19" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id10">[9]</a></td><td>ecdsa-with-SHA384 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.10045.4.3.3">http://www.oid-info.com/get/1.2.840.10045.4.3.3</a></td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id20" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id11">[10]</a></td><td>ecdsa-with-SHA512 <a class="reference external" href="http://www.oid-info.com/get/1.2.840.10045.4.3.4">http://www.oid-info.com/get/1.2.840.10045.4.3.4</a></td></tr>
</tbody>
</table>
<p>(v.03)</p>
</div>
<div class="section" id="appendix-c-notes-on-implementing-base64url-encoding-without-padding">
<span id="jws-appendix-c"></span><h2><a class="toc-backref" href="#id57">Appendix C.  Notes on implementing base64url encoding without padding</a><a class="headerlink" href="#appendix-c-notes-on-implementing-base64url-encoding-without-padding" title="Permalink to this headline">¶</a></h2>
<p>This appendix describes how to implement base64url encoding and decoding functions
without padding based upon standard base64 encoding and decoding functions that do use padding.</p>
<p>To be concrete, example C# code implementing these functions is shown below. Similar code could be used in other languages.</p>
<div class="highlight-python"><pre>static string base64urlencode(byte [] arg)
{
  string s = Convert.ToBase64String(arg); // Standard base64 encoder
  s = s.Split('=')[0]; // Remove any trailing '='s
  s = s.Replace('+', '-'); // 62nd char of encoding
  s = s.Replace('/', '_'); // 63rd char of encoding
  return s;
}

static byte [] base64urldecode(string arg)
{
  string s = arg;
  s = s.Replace('-', '+'); // 62nd char of encoding
  s = s.Replace('_', '/'); // 63rd char of encoding
  switch (s.Length % 4) // Pad with trailing '='s
  {
    case 0: break; // No pad chars in this case
    case 2: s += "=="; break; // Two pad chars
    case 3: s += "="; break; // One pad char
    default: throw new System.Exception(
      "Illegal base64url string!");
  }
  return Convert.FromBase64String(s); // Standard base64 decoder
}</pre>
</div>
<p>As per the example code above, the number of &#8216;=&#8217; padding characters
that needs to be added to the end of a base64url encoded string
without padding to turn it into one with padding is a deterministic function of the length of the encoded string. Specifically, if the length mod 4 is 0, no padding is added; if the length mod 4 is 2, two &#8216;=&#8217; padding characters are added; if the length mod 4 is 3, one &#8216;=&#8217; padding character is added; if the length mod 4 is 1, the input is malformed.</p>
<p>An example correspondence between unencoded and encoded values follows. The byte sequence below encodes into the string below, which when decoded, reproduces the byte sequence.</p>
<div class="highlight-python"><pre>3 236 255 224 193

A-z_4ME</pre>
</div>
<p>(v.03)</p>
</div>
<div class="section" id="appendix-d-acknowledgements">
<span id="jws-appendix-d"></span><h2><a class="toc-backref" href="#id58">Appendix D.  Acknowledgements</a><a class="headerlink" href="#appendix-d-acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Solutions for signing JSON content were previously explored by Magic Signatures [MagicSignatures], JSON Simple Sign [JSS], and Canvas Applications [CanvasApp], all of which influenced this draft.</p>
<p>(v.03)</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jwt.html">JSON Web Token(JWT)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/660be19d7963.
    </div>
  </body>
</html>