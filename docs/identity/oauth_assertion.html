

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OAuth 2.0 Assertion Profile &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth 2.0 Multiple Response Type Encoding Practices" href="oauth_responses.html" />
    <link rel="prev" title="The OAuth 2.0 Authorization Protocol" href="oauth.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>OAuth 2.0 Assertion Profile</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth.html">The OAuth 2.0 Authorization Protocol</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="oauth-2-0-assertion-profile">
<h1><a class="toc-backref" href="#id5">OAuth 2.0 Assertion Profile</a><a class="headerlink" href="#oauth-2-0-assertion-profile" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-assertions-01">http://tools.ietf.org/html/draft-ietf-oauth-assertions-01</a></p>
<div class="section" id="abstract">
<span id="oauth-assertion-abstract"></span><h2><a class="toc-backref" href="#id6">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification provides <strong>a general framework for the use of assertions</strong>
as <strong>client credentials</strong> and/or <strong>authorization grants</strong> with <a class="reference internal" href="oauth.html"><em>OAuth 2.0</em></a>.</p>
<p>It includes a generic mechanism
for transporting assertions during interactions with a <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>,
as wells as rules for the content and processing of those assertions.
The intent is to provide an enhanced security profile
by using derived values such as signatures or HMACs,
as well as facilitate the use of OAuth 2.0
in client-server integration scenarios where the end-user may not be present.</p>
<p>This specification only defines <strong>abstract message flow</strong> and <strong>assertion content</strong>.
Actual use requires implementation of a companion protocol binding specification.
Additional profile documents provide standard representations in formats such as <em class="xref std std-term">SAML</em> and <a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Abstract message flow and assertion content for</p>
<blockquote>
<div><ul class="simple">
<li><em class="xref std std-term">client credeintial</em></li>
<li><a class="reference internal" href="oauth.html#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a></li>
</ul>
</div></blockquote>
<p>Token in OAuth can be in two type of generic format (&#8220;<a class="reference internal" href="oauth_threat.html#oauth-threat-3-1"><em>3.1.  Tokens</em></a> &#8221;):</p>
<blockquote class="last">
<div><ul class="simple">
<li>Handle - &#8220;artifact&#8221;</li>
<li>Assertion - &#8220;self-contained token&#8221;</li>
</ul>
</div></blockquote>
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#oauth-2-0-assertion-profile" id="id5">OAuth 2.0 Assertion Profile</a><ul>
<li><a class="reference internal" href="#abstract" id="id6">Abstract</a></li>
<li><a class="reference internal" href="#requirements-notation-and-conventions" id="id7">1.  Requirements Notation and Conventions</a></li>
<li><a class="reference internal" href="#overview" id="id8">2.  Overview</a></li>
<li><a class="reference internal" href="#authentication-vs-authorization" id="id9">3.  Authentication vs. Authorization</a></li>
<li><a class="reference internal" href="#transporting-assertions" id="id10">4.  Transporting Assertions</a><ul>
<li><a class="reference internal" href="#using-assertions-for-client-authentication" id="id11">4.1.  Using Assertions for Client Authentication</a></li>
<li><a class="reference internal" href="#using-assertions-as-authorization-grants" id="id12">4.2.  Using Assertions as Authorization Grants</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assertion-content-and-processing" id="id13">5.  Assertion Content and Processing</a><ul>
<li><a class="reference internal" href="#assertion-metamodel" id="id14">5.1.  Assertion Metamodel</a></li>
<li><a class="reference internal" href="#general-assertion-format-and-processing-rules" id="id15">5.2.  General Assertion Format and Processing Rules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#specific-assertion-format-and-processing-rules" id="id16">6.  Specific Assertion Format and Processing Rules</a><ul>
<li><a class="reference internal" href="#client-authentication" id="id17">6.1.  Client authentication</a></li>
<li><a class="reference internal" href="#client-acting-on-behalf-of-itself" id="id18">6.2.  Client acting on behalf of itself</a></li>
<li><a class="reference internal" href="#client-acting-on-behalf-of-a-user" id="id19">6.3.  Client acting on behalf of a user</a></li>
<li><a class="reference internal" href="#client-acting-on-behalf-of-an-anonymous-user" id="id20">6.4.  Client acting on behalf of an anonymous user</a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-responses" id="id21">7.  Error Responses</a></li>
<li><a class="reference internal" href="#security-considerations" id="id22">8.  Security Considerations</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id23">9.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#parameter-registration-request" id="id24">9.1.  Parameter Registration Request</a></li>
<li><a class="reference internal" href="#oauth-assertion-9-2" id="id25">9.2.  Parameter Registration Request</a></li>
<li><a class="reference internal" href="#oauth-assertion-9-3" id="id26">9.3.  Parameter Registration Request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#acknowledgements" id="id27">10.  Acknowledgements</a></li>
<li><a class="reference internal" href="#normative-references" id="id28">11.  Normative References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="requirements-notation-and-conventions">
<span id="oauth-assertion-1"></span><h2><a class="toc-backref" href="#id7">1.  Requirements Notation and Conventions</a><a class="headerlink" href="#requirements-notation-and-conventions" title="Permalink to this headline">¶</a></h2>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in [RFC2119] .</p>
<p>Throughout this document, values are quoted to indicate that they are
to be taken literally.  When using these values in protocol messages,
the quotes MUST NOT be used as part of the value.</p>
</div>
<div class="section" id="overview">
<span id="oauth-assertion-2"></span><h2><a class="toc-backref" href="#id8">2.  Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Assertions in this spec are for:</p>
<blockquote>
<div><ul class="simple">
<li><em class="xref std std-term">clent credential</em> ( for 3rd party <strong>authentication</strong> )</li>
<li><a class="reference internal" href="oauth.html#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a></li>
</ul>
</div></blockquote>
<p>Definitions are for:</p>
<blockquote class="last">
<div><ul class="simple">
<li><strong>abstract message flow</strong>  ( <a class="reference internal" href="#oauth-assertion-4"><em>4.  Transporting Assertions</em></a> )</li>
<li><strong>assertion content</strong>  ( <a class="reference internal" href="#oauth-assertion-5"><em>5.  Assertion Content and Processing</em></a> )</li>
</ul>
</div></blockquote>
</div>
<p>The <a class="reference internal" href="oauth.html"><em>OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2]</em></a> provides
a method for making authenticated HTTP requests
to a resource using an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.
Access tokens are issued to clients by an <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
with the (sometimes implicit) approval of the <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
These access tokens are typically obtained
by exchanging an <a class="reference internal" href="oauth.html#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>
representing authorization by the resource owner or privileged administrator.
Several authorization <a class="reference internal" href="glossary.html#term-grant-types"><em class="xref std std-term">grant types</em></a> are defined
to support a wide range of <em class="xref std std-term">client types</em>
and user experiences.
OAuth also allows for the definition of new extension grant types
to support additional clients or to provide a bridge between OAuth and other trust frameworks.
Finally, OAuth allows the definition of additional authentication mechanisms
to be used by clients when interacting with the authorization server.</p>
<p>In scenarios where security is at a premium one wants
to avoid sending secrets across the Internet,
even on encrypted connections.
Instead one wants to send values derived from the secret
that prove to the receiver that the sender is in possession of the secret
without actually sending the secret.
Typically the way derived values are created is by generating an assertion
that is then either HMAC&#8217;ed or digitally signed using an agreed upon secret.
By validating the <a class="reference internal" href="glossary.html#term-hmac"><em class="xref std std-term">HMAC</em></a> or <a class="reference internal" href="jws.html#term-digital-signature"><em class="xref std std-term">digital signature</em></a> on the <a class="reference internal" href="#term-assertion"><em class="xref std std-term">assertion</em></a>,
the receiver can prove to themselves that the entity
that generated the assertion was in possession of the secret without actually communicating the secret directly.</p>
<p>This specification provides a general framework for the use of assertions
as <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> and/or <em class="xref std std-term">authorization grants</em> with OAuth 2.0.
It includes a generic mechanism for transporting assertions during interactions with a token endpoint,
as wells as rules for the content and processing of those assertions.
The intent is to provide an enhanced security profile
by using derived values such as signatures or HMACs,
as well as facilitate the use of OAuth 2.0 in client-server integration scenarios
where the end-user may not be present.</p>
<p>This specification only defines <strong>abstract message flow</strong> and <strong>assertion content</strong>.
Actual use requires implementation of a companion protocol binding specification.
Additional profile documents provide standard representations in formats such as <em class="xref std std-term">SAML</em> and <a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>.</p>
</div>
<div class="section" id="authentication-vs-authorization">
<span id="oauth-assertion-3"></span><h2><a class="toc-backref" href="#id9">3.  Authentication vs. Authorization</a><a class="headerlink" href="#authentication-vs-authorization" title="Permalink to this headline">¶</a></h2>
<p>This specification provides a model for using assertions for
<strong>authentication</strong> of an OAuth client during interactions with an <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>,
as well as the use of assertions as <em class="xref std std-term">authorization grants</em>.
It is important to note that
the use of assertions for client authentication is orthogonal <a class="footnote-reference" href="#id2" id="id1">[1]</a>
and separable from using assertions as an <a class="reference internal" href="glossary.html#term-authorization"><em class="xref std std-term">authorization</em></a> grant
and can be used either in combination or in isolation.
In addition,
in scenarios when <strong>assertion based authentication</strong> and authorization are used in combination,
the assertion format and processing may be redundant; under such circumstances,
the protocol may be optimized to present a single assertion.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>(statically) unrelated</td></tr>
</tbody>
</table>
</div>
<div class="section" id="transporting-assertions">
<span id="oauth-assertion-4"></span><h2><a class="toc-backref" href="#id10">4.  Transporting Assertions</a><a class="headerlink" href="#transporting-assertions" title="Permalink to this headline">¶</a></h2>
<p>This section defines generic HTTP parameters for transporting assertions
during interactions with a <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.</p>
<p>Transportations:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#oauth-assertion-4-1"><em>4.1.  Using Assertions for Client Authentication</em></a></li>
<li><a class="reference internal" href="#oauth-assertion-4-2"><em>4.2.  Using Assertions as Authorization Grants</em></a></li>
</ul>
</div></blockquote>
<div class="section" id="using-assertions-for-client-authentication">
<span id="oauth-assertion-4-1"></span><h3><a class="toc-backref" href="#id11">4.1.  Using Assertions for Client Authentication</a><a class="headerlink" href="#using-assertions-for-client-authentication" title="Permalink to this headline">¶</a></h3>
<p>In scenarios
where one wants to avoid sending secrets,
one wants to send values derived from the secret
that prove to the receiver that the sender is in <strong>possession of the secret</strong>
without actually sending the secret.</p>
<p>For example,
a client can establish a secret using an out-of-band mechanism with a <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a>.
As part of this out-of-band communication the client and <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a> agree
that the client will authenticate itself using an assertion with agreed upon parameters
that will be signed by the provisioned secret.
Later on, the client might send an access token request to the token endpoint
for the resource server that includes an authorization code,
as well as a <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a>
that is signed with the previously agreed key and parameters.
The <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a> proves to the <em class="xref std std-ref">token endpoint</em> the <strong>identity of the client</strong>
and the <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a> provides the link to the end-user authorization.</p>
<p>The following section defines the use of assertions as <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>
as an extension of <a class="reference internal" href="oauth.html#oauth-3-2"><em>Section 3.2 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
When using assertions as client credentials,
the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> MUST include the assertion
using the following HTTP request parameters:</p>
<dl class="glossary docutils">
<dt id="term-client-id">client_id</dt>
<dd>OPTIONAL.
The <a class="reference internal" href="session.html#term-client-identifier"><em class="xref std std-term">client identifier</em></a> as described in <a class="reference internal" href="oauth.html#oauth-3"><em>Section 3 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.</dd>
<dt id="term-client-assertion-type">client_assertion_type</dt>
<dd>REQUIRED.
The <strong>format</strong> of the assertion as defined by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The value MUST be an <em class="xref std std-term">absolute URI</em>.</dd>
<dt id="term-client-assertion">client_assertion</dt>
<dd>REQUIRED.
The assertion being used to authenticate the client.
Specific serialization of the assertion is defined by profile documents.
The serialization MUST be encoded for transport within HTTP forms.
It is RECOMMENDED that <strong>base64url</strong> be used.</dd>
</dl>
<p>The following non-normative example demonstrates
a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> authenticating using an assertion during an <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">Authorization Code</em></a>
<a class="reference internal" href="glossary.html#term-access-token-request"><em class="xref std std-term">Access Token Request</em></a> as defined in <a class="reference internal" href="oauth.html#oauth-4-1-3"><em>Section 4.1.3 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=i1WsRn1uB1&amp;
client_id=s6BhdRkqt3&amp;
client_assertion_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&amp;
client_assertion=PHNhbWxwOl...[omitted for brevity]...ZT</pre>
</div>
<p>The <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> MUST NOT include the <em class="xref std std-term">client_credential</em> using more than one mechanism.
Token endpoints can differentiate between client assertion credentials
and other client credential types by looking for the presence of the <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a> and
<a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> attributes which will only be present with client assertion credentials.
See <a class="reference internal" href="#oauth-assertion-7"><em>section 7</em></a> for more details</p>
</div>
<div class="section" id="using-assertions-as-authorization-grants">
<span id="oauth-assertion-4-2"></span><h3><a class="toc-backref" href="#id12">4.2.  Using Assertions as Authorization Grants</a><a class="headerlink" href="#using-assertions-as-authorization-grants" title="Permalink to this headline">¶</a></h3>
<p>An assertion can be used to request an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
when a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> wishes to utilize an existing trust relationship.
This may be done through the semantics of
(and a <a class="reference internal" href="jws.html#term-digital-signature"><em class="xref std std-term">digital signature</em></a>/<a class="reference internal" href="glossary.html#term-hmac"><em class="xref std std-term">HMAC</em></a> calculated over) the assertion,
and expressed to the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> through an extension <a class="reference internal" href="glossary.html#term-authorization-grant-type"><em class="xref std std-term">authorization grant type</em></a>.
The processes by which authorization is previously granted,
and by which the client obtains the assertion
prior to exchanging it with the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>, are out of scope.</p>
<p>The following defines the use of assertions as <em class="xref std std-term">authorization grants</em>
as an extension of <a class="reference internal" href="oauth.html#oauth-4-5"><em>OAuth 2.0 [I-D.ietf.oauth-v2], section 4.5</em></a>.
When using assertions as authorization grants,
the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> MUST include the assertion using the following HTTP request parameters:</p>
<dl class="glossary docutils">
<dt id="term-3">client_id</dt>
<dd>OPTIONAL.
The client identifier as described in <a class="reference internal" href="oauth.html#oauth-3"><em>Section 3 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.</dd>
<dt id="term-grant-type">grant_type</dt>
<dd>REQUIRED.
The format of the assertion as defined by the authorization server.
The value MUST be an absolute URI.</dd>
<dt id="term-assertion">assertion</dt>
<dd>REQUIRED.
The assertion being used as an authorization grant.
Specific serialization of the assertion is defined by profile documents.
The serialization MUST be encoded for transport within HTTP forms.
It is RECOMMENDED that base64url be used.</dd>
<dt id="term-scope">scope</dt>
<dd>OPTIONAL.
The request MAY contain a &#8220;scope&#8221; parameter.
The scope of the access request is expressed as a list of space-delimited strings.
The value is defined by the authorization server.
If the value contains multiple space-delimited strings,
their order does not matter, and each string adds an additional access range to the requested scope.
When exchanging assertions for access_tokens,
the authorization for the token has been previously granted through some other mechanism.
As such, the requested scope SHOULD be equal or lesser than the scope
originally granted to the authorized accessor.
If the scope parameter and/or value is omitted,
the scope SHOULD be treated as equal to the scope originally granted to the authorized accessor.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> SHOULD limit the scope of the issued access token to be equal
or lesser than the scope originally granted to the authorized accessor.</dd>
</dl>
<p>The following non-normative example demonstrates an assertion being used as an authorization grant.
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

client_id=s6BhdRkqt3&amp;
grant_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&amp;
assertion=PHNhbWxwOl...[omitted for brevity]...ZT4</pre>
</div>
</div>
</div>
<div class="section" id="assertion-content-and-processing">
<span id="oauth-assertion-5"></span><h2><a class="toc-backref" href="#id13">5.  Assertion Content and Processing</a><a class="headerlink" href="#assertion-content-and-processing" title="Permalink to this headline">¶</a></h2>
<p>This section provides a general content and processing model
for the use of assertions in OAuth 2.0 [I-D.ietf.oauth-v2].</p>
<p>Formats:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#oauth-assertion-5-1"><em>5.1.  Assertion Metamodel</em></a></li>
<li><a class="reference internal" href="#oauth-assertion-5-2"><em>5.2.  General Assertion Format and Processing Rules</em></a></li>
</ul>
</div></blockquote>
<div class="section" id="assertion-metamodel">
<span id="oauth-assertion-5-1"></span><h3><a class="toc-backref" href="#id14">5.1.  Assertion Metamodel</a><a class="headerlink" href="#assertion-metamodel" title="Permalink to this headline">¶</a></h3>
<p>The following are entities and metadata involved in the issuance,
exchange and processing of assertions in OAuth 2.0.  These are
general terms, abstract from any particular assertion format.
Mappings of these terms into specific representations are provided by
profiles of this specification.</p>
<dl class="glossary docutils">
<dt id="term-issuer">Issuer</dt>
<dd>The unique identifier for the entity that issued the
assertion.  Generally this is the entity that holds the keying
material used to generate the assertion.  In some use-cases
Issuers may be either OAuth Clients (when assertions are self-
asserted ) or a Security Token Service (an entity capable of
issuing, renewing, transforming and validating of security
tokens).</dd>
<dt id="term-principal">Principal</dt>
<dd>A unique identifier for the subject of the assertion.
When using assertions for client authentication, the Principal
SHOULD be the client_id of the OAuth client.  When using
assertions as an authorization grant, the Principal MUST identify
an authorized accessor for whom the access token is being
requested (typically the resource owner, or an authorized
delegate).</dd>
<dt id="term-audience">Audience</dt>
<dd>A URI that identifies the party intended to process the assertion.
The audience SHOULD be the URL of the Token Endpoint
as defined in <a class="reference internal" href="oauth.html#oauth-2-2"><em>section 2.2 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.</dd>
<dt id="term-issued-at">Issued At</dt>
<dd>The time at which the assertion was issued.  While the
serialization may differ by assertion format, this is always
expressed in UTC with no time zone component.</dd>
<dt id="term-expires-at">Expires At</dt>
<dd>The time at which the assertion expires.  While the
serialization may differ by assertion format, this is always
expressed in UTC with no time zone component.</dd>
<dt id="term-assertion-id">Assertion ID</dt>
<dd>A nonce or unique identifier for the assertion.  The
Assertion ID may be used by implementations requiring message de-
duplication for one-time use assertions.  Any entity that assigns
an identifier MUST ensure that there is negligible probability
that that entity or any other entity will accidentally assign the
same identifier to a different data object.</dd>
</dl>
</div>
<div class="section" id="general-assertion-format-and-processing-rules">
<span id="oauth-assertion-5-2"></span><h3><a class="toc-backref" href="#id15">5.2.  General Assertion Format and Processing Rules</a><a class="headerlink" href="#general-assertion-format-and-processing-rules" title="Permalink to this headline">¶</a></h3>
<p>The following are general format and processing rules for the use of
assertions in OAuth:</p>
<blockquote>
<div><ul class="simple">
<li>The assertion MUST contain an Issuer.  The Issuer MUST identify
the entity that issued the assertion as recognized by the
Authorization Server.  If an assertion is self-asserted, the
Issuer SHOULD be the client_id.</li>
<li>The assertion SHOULD contain a Principal.  The Principal MUST
identify an authorized accessor for whom the access token is being
requested ( typically the resource owner, or an authorized
delegate ) When the client is acting on behalf of itself, the
Principal SHOULD be the client_id.</li>
<li>The assertion MUST contain an Audience that identifies the
Authorization Server as the intended audience.  The Authorization
Server MUST verify that it is an intended audience for the
assertion.  The Audience SHOULD be the URL of the Authorization
Server&#8217;s Token Endpoint.</li>
<li>The assertion MUST contain an Expires At entity that limits the
time window during which the assertion can be used.  The
authorization server MUST verify that the expiration time has not
passed, subject to allowable clock skew between systems.  The
authorization server SHOULD reject assertions with an Expires At
attribute value that is unreasonably far in the future.</li>
<li>The assertion MAY contain an Issued At entity containing the UTC
time at which the assertion was issued.</li>
<li>The assertion MAY contain an Assertion ID.  An Authorization
Server MAY dictate that Assertion ID is mandatory.</li>
<li>The Authorization Server MUST validate the assertion in order to
establish a mapping between the Issuer and the secret used to
generate the assertion.  The algorithm used to validate the
assertion, and the mechanism for designating the secret used to
generate the assertion is out-of-scope for this specification.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="specific-assertion-format-and-processing-rules">
<span id="oauth-assertion-6"></span><h2><a class="toc-backref" href="#id16">6.  Specific Assertion Format and Processing Rules</a><a class="headerlink" href="#specific-assertion-format-and-processing-rules" title="Permalink to this headline">¶</a></h2>
<p>The following clarifies the format and processing rules
defined in <a class="reference internal" href="#oauth-assertion-4"><em>section 4</em></a>
and <a class="reference internal" href="#oauth-assertion-5"><em>section 5</em></a> for a number of common use-cases:</p>
<img alt="images/6.png" src="images/6.png" style="width: 600px;" />
<p>Format and Rules:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#oauth-assertion-6-1"><em>6.1.  Client authentication</em></a></li>
<li><a class="reference internal" href="#oauth-assertion-6-2"><em>6.2.  Client acting on behalf of itself</em></a></li>
<li><a class="reference internal" href="#oauth-assertion-6-3"><em>6.3.  Client acting on behalf of a user</em></a></li>
<li><a class="reference internal" href="#oauth-assertion-6-4"><em>6.4.  Client acting on behalf of an anonymous user</em></a></li>
</ul>
</div></blockquote>
<div class="section" id="client-authentication">
<span id="oauth-assertion-6-1"></span><h3><a class="toc-backref" href="#id17">6.1.  Client authentication</a><a class="headerlink" href="#client-authentication" title="Permalink to this headline">¶</a></h3>
<p>When a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> authenticates to a token service using an assertion,
it SHOULD do so according to <a class="reference internal" href="#oauth-assertion-4-1"><em>section 4.1</em></a>.
The following format and processing rules SHOULD be applied:</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> HTTP parameter SHOULD identify the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> to the
<a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</li>
<li>The <a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> HTTP parameter MUST identify the
<em class="xref std std-term">assertion format</em> being used for authentication.</li>
<li>The <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a> HTTP parameter MUST contain the serialized
assertion in a format indicated by the <a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> parameter.</li>
<li>The <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> of the assertion MUST identify the entity
that issued the assertion as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
If the assertion is self-asserted, the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.</li>
<li>The <a class="reference internal" href="#term-principal"><em class="xref std std-term">Principal</em></a> MUST identify an <em class="xref std std-term">authorized accessor</em>.
If the assertion is self-issued, the <a class="reference internal" href="#term-principal"><em class="xref std std-term">Principal</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.</li>
<li>The <a class="reference internal" href="#term-audience"><em class="xref std std-term">Audience</em></a> of the assertion MUST identify the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>
and SHOULD be the URL of the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>.</li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST validate the assertion in order to
establish a mapping between the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> and the secret used to
generate the assertion.</li>
</ul>
</div></blockquote>
<p>The following non-normative example demonstrates the use of a client authentication using an assertion
during an <em class="xref std std-term">Authorization Code Access Token Request</em> as
defined in <a class="reference internal" href="oauth.html#oauth-4-1-3"><em>Section 4.1.3 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=i1WsRn1uB1&amp;
client_id=s6BhdRkqt3&amp;
client_assertion_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&amp;
client_assertion=PHNhbWxwOl...[omitted for brevity]...ZT4</pre>
</div>
</div>
<div class="section" id="client-acting-on-behalf-of-itself">
<span id="oauth-assertion-6-2"></span><h3><a class="toc-backref" href="#id18">6.2.  Client acting on behalf of itself</a><a class="headerlink" href="#client-acting-on-behalf-of-itself" title="Permalink to this headline">¶</a></h3>
<p>When a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> is accessing resources on behalf of itself,
it SHOULD do so in a manner analogous to the Client Credentials flow
defined in <a class="reference internal" href="oauth.html#oauth-4-4"><em>Section 4.4 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
This is a special case that combines
both the authentication and <a class="reference internal" href="oauth.html#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a> usage patterns.
In this case,
the interactions with the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> SHOULD be treated
as using an assertion for Client Authentication according to <a class="reference internal" href="#oauth-assertion-4-1"><em>section 4.1</em></a>,
with the addition of a <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> parameter.</p>
<p>The following format and processing rules SHOULD be applied.</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> HTTP parameter SHOULD identify the client to the
<a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</li>
<li>The <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> HTTP request parameter MUST be
&#8220;<a class="reference internal" href="glossary.html#term-333"><em class="xref std std-term">client_credentials</em></a>&#8221;.</li>
<li>The <a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> HTTP parameter MUST identify the assertion format.</li>
<li>The <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a> HTTP parameter MUST contain the serialized assertion
as in a format indicated by the <a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> parameter.</li>
<li>The <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> of the assertion MUST identify the entity that issued the assertion
as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
If the assertion is self-asserted, the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.
If the assertion was issued by a <em class="xref std std-term">Security Token Service</em>,
the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD identify the <em class="xref std std-term">STS</em> as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.</li>
<li>The <a class="reference internal" href="#term-principal"><em class="xref std std-term">Principal</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.</li>
<li>The <a class="reference internal" href="#term-audience"><em class="xref std std-term">Audience</em></a> of the assertion MUST identify the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>
and SHOULD be the URL of the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>.</li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST validate the assertion in order to
establish a mapping between the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> and the secret used to generate the assertion.</li>
</ul>
</div></blockquote>
<p>The following non-normative example demonstrates the use of a sample assertion
being used for a <em class="xref std std-term">Client Credentials Access Token Request</em>
as defined in <a class="reference internal" href="oauth.html#oauth-4-4-2"><em>Section 4.4.2 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

client_id=s6BhdRkqt3&amp;
grant_type=client_credentials&amp;
client_assertion_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&amp;
client_assertion=PHNhbWxwOl...[omitted for brevity]...ZT4%3D</pre>
</div>
</div>
<div class="section" id="client-acting-on-behalf-of-a-user">
<span id="oauth-assertion-6-3"></span><h3><a class="toc-backref" href="#id19">6.3.  Client acting on behalf of a user</a><a class="headerlink" href="#client-acting-on-behalf-of-a-user" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">I&#8217;m not quite sure what use case is taken accounted into....</p>
</div>
<p>When a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> is accessing resources on behalf of a user,
it SHOULD be treated as using an assertion as an <a class="reference internal" href="oauth.html#term-authorization-grant"><em class="xref std std-term">Authorization Grant</em></a>
according to <a class="reference internal" href="#oauth-assertion-4-2"><em>section 4.2</em></a>.
The following format and processing rules SHOULD be applied:</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> HTTP parameter MUST identify the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a>
to the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</li>
<li>The <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> HTTP request parameter MUST indicate the assertion format.</li>
<li>The <a class="reference internal" href="#term-assertion"><em class="xref std std-term">assertion</em></a> HTTP parameter MUST contain the serialized assertion
as in a format indicated by the <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> parameter.</li>
<li>The <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> of the assertion MUST identify the entity that issued the assertion
as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
If the assertion is self-asserted, the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.
If the assertion was issued by a <em class="xref std std-term">STS</em>,
the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD identify the <em class="xref std std-term">STS</em> as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.</li>
<li>The <a class="reference internal" href="#term-principal"><em class="xref std std-term">Principal</em></a> MUST identify an authorized accessor for whom
the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is being requested
(typically the <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>, or an authorized delegate).</li>
<li>The <a class="reference internal" href="#term-audience"><em class="xref std std-term">Audience</em></a> of the assertion MUST identify the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>
and MAY be the URL of the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>.</li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST validate the assertion
in order to establish a mapping between the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> and the secret used to
generate the assertion.</li>
</ul>
</div></blockquote>
<p>The following non-normative example demonstrates the use of a client
authenticating using an assertion during an <em class="xref std std-term">Authorization Code Access Token Request</em>
as defined in <a class="reference internal" href="oauth.html#oauth-4-1-3"><em>Section 4.1.3 of OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

client_id=s6BhdRkqt3&amp;
grant_type=urn%3Aoasis%3Anames%sAtc%3ASAML%3A2.0%3Aassertion&amp;
assertion=PHNhbWxwOl...[omitted for brevity]...ZT4%3D</pre>
</div>
</div>
<div class="section" id="client-acting-on-behalf-of-an-anonymous-user">
<span id="oauth-assertion-6-4"></span><h3><a class="toc-backref" href="#id20">6.4.  Client acting on behalf of an anonymous user</a><a class="headerlink" href="#client-acting-on-behalf-of-an-anonymous-user" title="Permalink to this headline">¶</a></h3>
<p>When a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> is accessing resources on behalf of an anonymous user,
the following format and processing rules SHOULD be applied:</p>
<blockquote>
<div><ul class="simple">
<li>The <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> HTTP parameter MUST identify the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> to the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</li>
<li>The <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> HTTP request parameter MUST indicate the <strong>assertion format</strong>.</li>
<li>The <a class="reference internal" href="#term-assertion"><em class="xref std std-term">assertion</em></a> HTTP parameter MUST contain the serialized assertion
as in a format indicated by the <a class="reference internal" href="#term-grant-type"><em class="xref std std-term">grant_type</em></a> parameter.</li>
<li>The <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> of the assertion MUST identify the entity that issued the assertion
as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
If the assertion is self-asserted, the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>.
If the assertion was issued by a Security Token Service,
the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> SHOULD identify the <em class="xref std std-term">STS</em> as recognized by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.</li>
<li>The <a class="reference internal" href="#term-principal"><em class="xref std std-term">Principal</em></a> SHOULD indicate to the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>
that the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> is acting on-behalf of an anonymous user
as defined by the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>.
It is implied that authorization is based
upon additional criteria, such as additional attributes or claims
provided in the assertion.
For example, a <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> may present an assertion from a trusted issuer asserting
that the bearer is over 18 via an included claim.
In this case, no additional information about the user&#8217;s identity is included yet all the data needed to
issue an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is present.</li>
<li>The <a class="reference internal" href="#term-audience"><em class="xref std std-term">Audience</em></a> of the assertion MUST identify the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>
and MAY be the URL of the <a class="reference internal" href="oauth.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>.</li>
<li>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST validate the assertion in order to
establish a mapping between the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">Issuer</em></a> and the secret used to
generate the assertion.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="error-responses">
<span id="oauth-assertion-7"></span><h2><a class="toc-backref" href="#id21">7.  Error Responses</a><a class="headerlink" href="#error-responses" title="Permalink to this headline">¶</a></h2>
<p>If an assertion is not valid or has expired,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST construct an error response
as defined in <a class="reference internal" href="oauth.html"><em>OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
The value of the error parameter MUST be the &#8220;<em class="xref std std-term">invalid_grant</em>&#8221; error code.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY include additional information
regarding the reasons the assertion was considered invalid
using the &#8220;<a class="reference internal" href="uma_core.html#term-error-description"><em class="xref std std-term">error_description</em></a>&#8221; or &#8220;<a class="reference internal" href="uma_core.html#term-error-uri"><em class="xref std std-term">error_uri</em></a>&#8221; parameters.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
"error":"invalid_grant",
"error_description":"Audience validation failed"
}</pre>
</div>
<p>A <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> MUST NOT include <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> using more than one mechanism.
<em class="xref std std-term">Token endpoints</em> can differentiate between assertion based credentials
and other <em class="xref std std-term">client credential types</em> by looking for the presence of the <a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a>
and <a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a> attributes which will only be present
when using assertions for <strong>client authentication</strong>.</p>
<p>If more than one mechanism is used,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> MUST construct an error response as defined in <a class="reference internal" href="oauth.html"><em>OAuth 2.0 [I-D.ietf.oauth-v2]</em></a>.
The value of the error parameter MUST be the &#8220;<em class="xref std std-term">invalid_client</em>&#8221; error code.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY include additional information
regarding the reasons the client was considered invalid using the &#8220;<a class="reference internal" href="uma_core.html#term-error-description"><em class="xref std std-term">error_description</em></a>&#8221; or &#8220;<a class="reference internal" href="uma_core.html#term-error-uri"><em class="xref std std-term">error_uri</em></a>&#8221; parameters.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
"error":"invalid_client"
"error_description":"Multiple Credentials Not Allowed"
}</pre>
</div>
</div>
<div class="section" id="security-considerations">
<span id="oauth-assertion-8"></span><h2><a class="toc-backref" href="#id22">8.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>Authorization Providers concerned with preventing replay attacks
may choose to implement using replay detection
using a combination of the <em class="xref std std-term">AssertionID</em> and <em class="xref std std-term">IssuedAt</em>/<em class="xref std std-term">ExpiredAt</em> attributes.
Previously processed assertions MAY be de-duped and rejected based on the <em class="xref std std-term">AssertionID</em>.</p>
<p>The addition of the validity window relieves the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
from maintaining an infinite state table of processed assertion IDs.</p>
<p><a class="reference internal" href="glossary.html#term-authorization-servers"><em class="xref std std-term">Authorization Servers</em></a> SHOULD consider the amount of information exposed in error responses,
and the risk associated with exposing details of specific processing errors.
In addition, <a class="reference internal" href="glossary.html#term-authorization-servers"><em class="xref std std-term">Authorization Servers</em></a> SHOULD prevent <em class="xref std std-term">timing attacks</em>
related to cryptographic processing of the assertion.</p>
<p>No additional considerations beyond those described
within the <a class="reference internal" href="oauth.html#oauth-10"><em>OAuth 2.0 Protocol Framework, Section 10 [I-D.ietf.oauth-v2]</em></a>.</p>
</div>
<div class="section" id="iana-considerations">
<span id="oauth-assertion-9"></span><h2><a class="toc-backref" href="#id23">9.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="parameter-registration-request">
<span id="oauth-assertion-9-1"></span><h3><a class="toc-backref" href="#id24">9.1.  Parameter Registration Request</a><a class="headerlink" href="#parameter-registration-request" title="Permalink to this headline">¶</a></h3>
<p>The following is the parameter registration request,
as defined in <a class="reference internal" href="oauth.html#oauth-11-2"><em>The OAuth Parameters Registry of The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2]</em></a>,
for the &#8220;<a class="reference internal" href="#term-assertion"><em class="xref std std-term">assertion</em></a>&#8221; parameter:</p>
<blockquote>
<div><ul class="simple">
<li>Parameter name: assertion</li>
<li>Parameter usage location: client authentication, token request</li>
<li>Change controller: IETF</li>
<li>Specification document(s): [[this document]]</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="oauth-assertion-9-2">
<span id="id3"></span><h3><a class="toc-backref" href="#id25">9.2.  Parameter Registration Request</a><a class="headerlink" href="#oauth-assertion-9-2" title="Permalink to this headline">¶</a></h3>
<p>The following is the parameter registration request,
as defined in <a class="reference internal" href="oauth.html#oauth-11-2"><em>The OAuth Parameters Registry of The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2]</em></a>,
for the &#8220;<a class="reference internal" href="#term-client-assertion"><em class="xref std std-term">client_assertion</em></a>&#8221; parameter:</p>
<blockquote>
<div><ul class="simple">
<li>Parameter name: client_assertion</li>
<li>Parameter usage location: client authentication, token request</li>
<li>Change controller: IETF</li>
<li>Specification document(s): [[this document]]</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="oauth-assertion-9-3">
<span id="id4"></span><h3><a class="toc-backref" href="#id26">9.3.  Parameter Registration Request</a><a class="headerlink" href="#oauth-assertion-9-3" title="Permalink to this headline">¶</a></h3>
<p>The following is the parameter registration request,
as defined in <a class="reference internal" href="oauth.html#oauth-11-2"><em>The OAuth Parameters Registry of The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2]</em></a>,
for the &#8220;<a class="reference internal" href="#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a>&#8221; parameter:</p>
<blockquote>
<div><ul class="simple">
<li>Parameter name: client_assertion_type</li>
<li>Parameter usage location: client authentication, token request</li>
<li>Change controller: IETF</li>
<li>Specification document(s): [[this document]]</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="acknowledgements">
<span id="oauth-assertion-10"></span><h2><a class="toc-backref" href="#id27">10.  Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>The authors wish to thank the following people that have influenced
or contributed this specification: Paul Madsen, Eric Sachs, Jian Cai,
Tony Nadalin, the authors of OAuth WRAP, and those in the OAuth 2
working group.</p>
</div>
<div class="section" id="normative-references">
<span id="oauth-assertion-11"></span><h2><a class="toc-backref" href="#id28">11.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><dl class="docutils">
<dt>[I-D.ietf.oauth-v2]</dt>
<dd>Hammer-Lahav, E., &#8220;The OAuth 2.0 Authorization Protocol&#8221;,
September 2011.</dd>
<dt>[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
</dl>
</div></blockquote>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth.html">The OAuth 2.0 Authorization Protocol</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/660be19d7963.
    </div>
  </body>
</html>