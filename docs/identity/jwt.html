

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Token(JWT) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Signature (JWS)" href="jws.html" />
    <link rel="prev" title="Terms" href="jose.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Token(JWT)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jose.html">Terms</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws.html">JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-token-jwt">
<h1>JSON Web Token(JWT)<a class="headerlink" href="#json-web-token-jwt" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id4">2.  Terminology</a></li>
<li><a class="reference internal" href="#json-web-token-jwt-overview" id="id5">3.  JSON Web Token (JWT) Overview</a><ul>
<li><a class="reference internal" href="#example-jwt" id="id6">3.1.  Example JWT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-claims" id="id7">4.  JWT Claims</a><ul>
<li><a class="reference internal" href="#reserved-claim-names" id="id8">4.1.  Reserved Claim Names</a></li>
<li><a class="reference internal" href="#iss-issuer-claim" id="id9">4.1.1.  &#8220;iss&#8221; (Issuer) Claim</a><ul>
<li><a class="reference internal" href="#sub-subject-claim" id="id10">4.1.2.  &#8220;sub&#8221; (Subject) Claim</a></li>
<li><a class="reference internal" href="#aud-audience-claim" id="id11">4.1.3.  &#8220;aud&#8221; (Audience) Claim</a></li>
<li><a class="reference internal" href="#exp-expiration-time-claim" id="id12">4.1.4.  &#8220;exp&#8221; (Expiration Time) Claim</a></li>
<li><a class="reference internal" href="#nbf-not-before-claim" id="id13">4.1.5.  &#8220;nbf&#8221; (Not Before) Claim</a></li>
<li><a class="reference internal" href="#iat-issued-at-claim" id="id14">4.1.6.  &#8220;iat&#8221; (Issued At) Claim</a></li>
<li><a class="reference internal" href="#jti-jwt-id-claim" id="id15">4.1.7. &#8220;jti&#8221; (JWT ID) Claim</a></li>
<li><a class="reference internal" href="#typ-type-claim" id="id16">4.1.8. &#8220;typ&#8221; (Type) Claim</a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-claim-names" id="id17">4.2.  Public Claim Names</a></li>
<li><a class="reference internal" href="#private-claim-names" id="id18">4.3.  Private Claim Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-header" id="id19">5.  JWT Header</a></li>
<li><a class="reference internal" href="#plaintext-jwts" id="id20">6.  Plaintext JWTs</a><ul>
<li><a class="reference internal" href="#example-plaintext-jwt" id="id21">6.1. Example Plaintext JWT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rules-for-creating-and-validating-a-jwt" id="id22">7.  Rules for Creating and Validating a JWT</a></li>
<li><a class="reference internal" href="#cryptographic-algorithms" id="id23">8.  Cryptographic Algorithms</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id24">9.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations" id="id25">10.  Security Considerations</a><ul>
<li><a class="reference internal" href="#unicode-comparison-security-issues" id="id26">10.1.  Unicode Comparison Security Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id27">12.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id28">12.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id29">12.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-jwt-examples" id="id30">Appendix A. JWT Examples</a></li>
<li><a class="reference internal" href="#appendix-b-relationship-of-jwts-to-simple-web-tokens-swts" id="id31">Appendix B.  Relationship of JWTs to Simple Web Tokens (SWTs)</a></li>
<li><a class="reference internal" href="#appendix-c-acknowledgements" id="id32">Appendix C.  Acknowledgements</a></li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11">https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwt-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Token (JWT) is
a compact URL-safe means of representing claims to be transferred between two parties.
The claims in a JWT are encoded as a JavaScript Object Notation (JSON) object
that is used as the <strong>payload</strong> of a JSON Web Signature (JWS) structure or
as the <strong>plaintext</strong> of a JSON Web Encryption (JWE) structure,
enabling the claims to be digitally signed or MACed and/or encrypted.</p>
<p>The suggested pronunciation of JWT is the same as the English word &#8220;jot&#8221;.</p>
<p>(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11">https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11</a>)</p>
</div>
<div class="section" id="introduction">
<span id="jwt-1"></span><h2><a class="toc-backref" href="#id3">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Token (JWT) is a compact token format intended for space constrained environments
such as HTTP <a class="reference internal" href="glossary.html#term-authorization-headers"><em class="xref std std-term">Authorization headers</em></a> and <a class="reference internal" href="glossary.html#term-uri-query-parameters"><em class="xref std std-term">URI query parameters</em></a>.
JWTs encode <a class="reference internal" href="messages.html#term-84"><em class="xref std std-term">claims</em></a> to be transmitted as a <a class="reference internal" href="glossary.html#term-json"><em class="xref std std-term">JSON</em></a> object (as defined in RFC 4627 [<span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc4627.html"><strong>RFC 4627</strong></a>])
that is <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded and digitally signed and/or encrypted.
Signing is accomplished using JSON Web Signature (JWS) [:term::<cite>JWS</cite>].
Encryption is accomplished using JSON Web Encryption (JWE) [<a class="reference internal" href="messages.html#term-jwe"><em class="xref std std-term">JWE</em></a>].</p>
<p>The suggested pronunciation of JWT is the same as the English word &#8220;jot&#8221;.</p>
<p>(v.06)</p>
</div>
<div class="section" id="terminology">
<span id="jwt-2"></span><h2><a class="toc-backref" href="#id4">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-token-jwt"><span id="term-json-web-token"></span><span id="term-jwt"></span>JSON Web Token (JWT)<br />JSON Web Token<br />JWT</dt>
<dd>A string representing a set of claims as a JSON
object that is digitally signed or MACed and/or encrypted.  The
string consists of multiple parts, the first being the Encoded JWT
Header, plus additional parts depending upon the contents of the
header, with the parts being separated by period (&#8216;.&#8217;) characters,
and each part containing base64url encoded content.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>The URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5, with the (non URL-
safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of [JWS] for notes on implementing base64url
encoding without padding.)</dd>
<dt id="term-jwt-header">JWT Header</dt>
<dd>A string representing a JSON object that describes the
cryptographic operations applied to the JWT.  When the JWT is
digitally signed or MACed, the JWT Header is a JWS Header.  When
the JWT is encrypted, the JWT Header is a JWE Header.</dd>
<dt id="term-header-parameter-name">Header Parameter Name</dt>
<dd>The name of a member of the JSON object
representing a JWT Header.</dd>
<dt id="term-header-parameter-value">Header Parameter Value</dt>
<dd>The value of a member of the JSON object
representing a JWT Header.</dd>
<dt id="term-jwt-claims-set">JWT Claims Set</dt>
<dd>A string representing a JSON object that contains the
claims conveyed by the JWT.  When the JWT is digitally signed or
MACed, the bytes of the UTF-8 representation of the JWT Claims Set
are base64url encoded to create the Encoded JWS Payload.  When the
JWT is encrypted, the bytes of the UTF-8 representation of the JWT
Claims Set are used as the JWE Plaintext.</dd>
<dt id="term-claim-name">Claim Name</dt>
<dd>The name of a member of the JSON object representing a JWT Claims Set.</dd>
<dt id="term-claim-value">Claim Value</dt>
<dd>The value of a member of the JSON object representing a JWT Claims Set.</dd>
<dt id="term-encoded-jwt-header">Encoded JWT Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8
[RFC3629] representation of the JWT Header.</dd>
<dt id="term-collision-resistant-namespace">Collision Resistant Namespace</dt>
<dd>A namespace that allows names to be
allocated in a manner such that they are highly unlikely to
collide with other names.  For instance, collision resistance can
be achieved through administrative delegation of portions of the
namespace or through use of collision-resistant name allocation
functions.  Examples of Collision Resistant Namespaces include:
Domain Names, Object Identifiers (OIDs) as defined in the ITU-T
X.660 and X.670 Recommendation series, and Universally Unique
IDentifiers (UUIDs) [RFC4122].  When using an administratively
delegated namespace, the definer of a name needs to take
reasonable precautions to ensure they are in control of the
portion of the namespace they use to define the name.</dd>
<dt id="term-stringoruri">StringOrURI</dt>
<dd>A JSON string value, with the additional requirement
that while arbitrary string values MAY be used, any value
containing a &#8221;:&#8221; character MUST be a URI [RFC3986].  StringOrURI
values are compared as case-sensitive strings with no
transformations or canonicalizations applied.</dd>
<dt id="term-intdate">IntDate</dt>
<dd>A JSON numeric value representing the number of seconds from
1970-01-01T0:0:0Z UTC until the specified UTC date/time.  See RFC
3339 [RFC3339] for details regarding date/times in general and UTC
in particular.</dd>
</dl>
<p>(draft 05)</p>
</div>
<div class="section" id="json-web-token-jwt-overview">
<span id="jwt-3"></span><h2><a class="toc-backref" href="#id5">3.  JSON Web Token (JWT) Overview</a><a class="headerlink" href="#json-web-token-jwt-overview" title="Permalink to this headline">¶</a></h2>
<p>JWTs represent a set of claims as a JSON object
that is base64url encoded and digitally signed and/or encrypted.
This object is the JWT Claims Object.
As per RFC 4627 [RFC4627] Section 2.2,
the JSON object consists of zero or more name/value pairs (or members),
where the names are strings and the values are arbitrary JSON values.
These members are the claims represented by the JWT.</p>
<p>The member names within the <em class="xref std std-term">JWT Claims Object</em> are referred to as <em class="xref std std-term">Claim Names</em>.
These names MUST be <strong>unique</strong>.
The corresponding values are referred to as <em class="xref std std-term">Claim Values</em>.</p>
<p>The bytes of the UTF-8 representation of the <em class="xref std std-term">JWT Claims Object</em> are signed
in the manner described in JSON Web Signature (JWS) [<a class="reference internal" href="messages.html#term-jws"><em class="xref std std-term">JWS</em></a>]
and/or encrypted in the manner described in JSON Web Encryption (JWE) [<a class="reference internal" href="messages.html#term-jwe"><em class="xref std std-term">JWE</em></a>].</p>
<p>The contents of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> describe the cryptographic operations applied to the JWT Claims Object.
If the JWT Header is a <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a>,
the claims are signed.
If the JWT Header is a <a class="reference internal" href="jwe.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a>, the claims are encrypted.</p>
<p>A JWT is represented as the concatenation of the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>, the JWT Second Part,
and the JWT Third Part, in that order, with the parts being separated by <strong>period</strong> (&#8216;.&#8217;) characters.
When signed,
the three parts of the JWT are the three parts of a JWS used to represent the JWT.
When encrypted, the three parts of the JWT are the three parts of a JWE used to represent the JWT.</p>
<p>(v.06)</p>
<div class="section" id="example-jwt">
<span id="jwt-3-1"></span><h3><a class="toc-backref" href="#id6">3.1.  Example JWT</a><a class="headerlink" href="#example-jwt" title="Permalink to this headline">¶</a></h3>
<p>The following example <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> declares that the encoded object
is a JSON Web Token (JWT) and the JWT is signed
using the HMAC SHA-256 algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;typ&quot;</span><span class="p">:</span><span class="s">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a>
yields this <a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a> value,
which is used as the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The following is an example of a <em class="xref std std-term">JWT Claims Object</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the <a class="reference internal" href="glossary.html#term-json-claims-object"><em class="xref std std-term">JSON Claims Object</em></a> yields this <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>,
which is used as the JWT Second Part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Signing the <a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a> and <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a> with the HMAC SHA-256 algorithm
and base64url encoding the signature in the manner specified in [JWS],
yields this <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>, which is used as the <em class="xref std std-term">JWT Third Part</em>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dBjftJeZ4CVP</span><span class="o">-</span><span class="n">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>Concatenating these parts in the order <strong>Header.Second.Third</strong> with <strong>period characters</strong>
between the parts yields this complete JWT (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.
dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</pre>
</div>
<p>This computation is illustrated in more detail in <a class="reference internal" href="jws.html#jws-appendix-a-1"><em>Appendix A.1</em></a> of <a class="reference internal" href="jwk.html#term-jws"><em class="xref std std-term">[JWS]</em></a>.
See <a class="reference internal" href="#jwt-appendix-a"><em>Appendix A</em></a> for an example of an encrypted JWT.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-3.1">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-3.1</a> )</p>
</div>
</div>
<div class="section" id="jwt-claims">
<span id="jwt-4"></span><h2><a class="toc-backref" href="#id7">4.  JWT Claims</a><a class="headerlink" href="#jwt-claims" title="Permalink to this headline">¶</a></h2>
<p>A JWT contains a set of :term::<cite>claims</cite> represented as a <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded JSON object.
Note however,
that the set of claims a JWT must contain to be considered valid is context-dependent
and is outside the scope of this specification.
When used in a security-related context,
implementations MUST understand and support all of the claims present;
otherwise, the JWT MUST be rejected for processing.</p>
<p>There are three classes of JWT Claim Names:
<a class="reference internal" href="#jwt-4-1"><em>Reserved Claim Names</em></a>,
<a class="reference internal" href="#jwt-4-2"><em>Public Claim Names</em></a>, and
<a class="reference internal" href="#jwt-4-3"><em>Private Claim Names</em></a>.</p>
<div class="section" id="reserved-claim-names">
<span id="jwt-reserved-claim"></span><span id="jwt-4-1"></span><h3><a class="toc-backref" href="#id8">4.1.  Reserved Claim Names</a><a class="headerlink" href="#reserved-claim-names" title="Permalink to this headline">¶</a></h3>
<p>The following claim names are reserved.</p>
<p>None of the claims defined below are intended to be mandatory,
but rather, provide a starting point for a set of useful, interoperable claims.</p>
<p>All the names are short because a core goal of JWTs is for the tokens to be <strong>compact</strong>.</p>
<p>Additional reserved claim names MAY be defined via the IANA JSON Web Token Claims registry <em class="xref std std-ref">Section 9.1</em>.</p>
<p>(draft 05)</p>
<table border="1" class="docutils" id="jwt-table-1">
<caption>Table 1: Reserved Claim Definitions</caption>
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Claim</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jwt-4-1-1"><em>4.1.1.  &#8220;iss&#8221; (Issuer) Claim</em></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jwt-4-1-2"><em>4.1.2.  &#8220;sub&#8221; (Subject) Claim</em></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jwt-4-1-3"><em>4.1.3.  &#8220;aud&#8221; (Audience) Claim</em></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jwt-4-1-4"><em>4.1.4.  &#8220;exp&#8221; (Expiration Time) Claim</em></a></td>
</tr>
<tr class="row-even"><td><em class="xref std std-ref">jwt.4.1.5</em></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jwt-4-1-6"><em>4.1.6.  &#8220;iat&#8221; (Issued At) Claim</em></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#jwt-4-1-7"><em>4.1.7. &#8220;jti&#8221; (JWT ID) Claim</em></a></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#jwt-4-1-8"><em>4.1.8. &#8220;typ&#8221; (Type) Claim</em></a></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="iss-issuer-claim">
<span id="jwt-issuer"></span><span id="jwt-iss"></span><span id="jwt-4-1-1"></span><h3><a class="toc-backref" href="#id9">4.1.1.  &#8220;iss&#8221; (Issuer) Claim</a><a class="headerlink" href="#iss-issuer-claim" title="Permalink to this headline">¶</a></h3>
<p>The &#8220;<strong>iss</strong>&#8221; (<strong>issuer</strong>) claim identifies
the <strong>principal</strong> that issued the JWT.
The processing of this claim is generally application specific.
The &#8220;iss&#8221; value is a case sensitive string containing a StringOrURI value.
Use of this claim is OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.1">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.1</a> )</p>
<div class="section" id="sub-subject-claim">
<span id="jwt-sub"></span><span id="jwt-4-1-2"></span><h4><a class="toc-backref" href="#id10">4.1.2.  &#8220;sub&#8221; (Subject) Claim</a><a class="headerlink" href="#sub-subject-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;sub&#8221; (subject) claim identifies the principal that is the
subject of the JWT.  The Claims in a JWT are normally statements
about the subject.  The processing of this claim is generally
application specific.  The &#8220;sub&#8221; value is a case sensitive string
containing a StringOrURI value.  Use of this claim is OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.2">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.2</a> )</p>
</div>
<div class="section" id="aud-audience-claim">
<span id="jwt-aud"></span><span id="jwt-4-1-3"></span><h4><a class="toc-backref" href="#id11">4.1.3.  &#8220;aud&#8221; (Audience) Claim</a><a class="headerlink" href="#aud-audience-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;aud&#8221; (audience) claim identifies the audiences that the JWT is
intended for.  Each principal intended to process the JWT MUST
identify itself with a value in audience claim.  If the principal
processing the claim does not identify itself with a value in the
&#8220;aud&#8221; claim, then the JWT MUST be rejected.  In the general case, the
&#8220;aud&#8221; value is an array of case sensitive strings, each containing a
StringOrURI value.  In the special case when the JWT has one
audience, the &#8220;aud&#8221; value MAY be a single case sensitive string
containing a StringOrURI value.  The interpretation of audience
values is generally application specific.  Use of this claim is
OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.3">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.3</a> )</p>
</div>
<div class="section" id="exp-expiration-time-claim">
<span id="jwt-exp"></span><span id="jwt-4-1-4"></span><h4><a class="toc-backref" href="#id12">4.1.4.  &#8220;exp&#8221; (Expiration Time) Claim</a><a class="headerlink" href="#exp-expiration-time-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;exp&#8221; (expiration time) claim identifies the expiration time on
or after which the JWT MUST NOT be accepted for processing.  The
processing of the &#8220;exp&#8221; claim requires that the current date/time
MUST be before the expiration date/time listed in the &#8220;exp&#8221; claim.
Implementers MAY provide for some small leeway, usually no more than
a few minutes, to account for clock skew.  Its value MUST be a number
containing an IntDate value.  Use of this claim is OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.4">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.4</a> )</p>
</div>
<div class="section" id="nbf-not-before-claim">
<span id="id1"></span><h4><a class="toc-backref" href="#id13">4.1.5.  &#8220;nbf&#8221; (Not Before) Claim</a><a class="headerlink" href="#nbf-not-before-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;nbf&#8221; (not before) claim identifies the time before which the JWT
MUST NOT be accepted for processing.  The processing of the &#8220;nbf&#8221;
claim requires that the current date/time MUST be after or equal to
the not-before date/time listed in the &#8220;nbf&#8221; claim.  Implementers MAY
provide for some small leeway, usually no more than a few minutes, to
account for clock skew.  Its value MUST be a number containing an
IntDate value.  Use of this claim is OPTIONAL.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.5">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.5</a> )</p>
</div>
<div class="section" id="iat-issued-at-claim">
<span id="jwt-iat"></span><span id="jwt-4-1-6"></span><h4><a class="toc-backref" href="#id14">4.1.6.  &#8220;iat&#8221; (Issued At) Claim</a><a class="headerlink" href="#iat-issued-at-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;iat&#8221; (issued at) claim identifies the time at which the JWT was
issued.  This claim can be used to determine the age of the JWT.  Its
value MUST be a number containing an IntDate value.  Use of this
claim is OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.6">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.6</a> )</p>
</div>
<div class="section" id="jti-jwt-id-claim">
<span id="jwt-jti"></span><span id="jwt-id"></span><span id="jwt-4-1-7"></span><h4><a class="toc-backref" href="#id15">4.1.7. &#8220;jti&#8221; (JWT ID) Claim</a><a class="headerlink" href="#jti-jwt-id-claim" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>JWTがリプレーされないように！</li>
</ul>
</div>
<p>The &#8220;jti&#8221; (JWT ID) claim provides a unique identifier for the JWT.
The identifier value MUST be assigned in a manner that ensures that
there is a negligible probability that the same value will be
accidentally assigned to a different data object.</p>
<p>The &#8220;jti&#8221; claim can be used to prevent the JWT from being replayed.</p>
<p>The &#8220;jti&#8221; value is a case sensitive string.</p>
<p>This claim is OPTIONAL.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.7">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.7</a> )</p>
</div>
<div class="section" id="typ-type-claim">
<span id="jwt-typ"></span><span id="jwt-type"></span><span id="jwt-4-1-8"></span><h4><a class="toc-backref" href="#id16">4.1.8. &#8220;typ&#8221; (Type) Claim</a><a class="headerlink" href="#typ-type-claim" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;typ&#8221; (type) claim is used to declare a type for the contents of
this JWT Claims Set. The &#8220;typ&#8221; value is a case sensitive string.
This claim is OPTIONAL.</p>
<p>The values used for the &#8220;typ&#8221; claim come from the same value space as
the &#8220;typ&#8221; header parameter, with the same rules applying.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.8">http://tools.ietf.org/html/draft-ietf-oauth-json-web-token-08#section-4.1.8</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://www.ietf.org/mail-archive/web/jose/current/msg02364.html">&#8220;[jose] Should we delete the &#8220;typ&#8221; header field&#8221;</a></li>
<li><a class="reference external" href="http://www.ietf.org/mail-archive/web/jose/current/msg02411.html">http://www.ietf.org/mail-archive/web/jose/current/msg02411.html</a></li>
</ul>
</div>
</div>
</div>
<div class="section" id="public-claim-names">
<span id="jwt-4-2"></span><h3><a class="toc-backref" href="#id17">4.2.  Public Claim Names</a><a class="headerlink" href="#public-claim-names" title="Permalink to this headline">¶</a></h3>
<p>Claim names can be defined at will by those using JWTs.
However,
in order to prevent collisions,
any new claim name SHOULD either be defined in the IANA JSON Web Token Claims registry or
be defined as a URI that contains a collision resistant namespace.
Examples of collision resistant namespaces include:</p>
<blockquote>
<div><ul class="simple">
<li>Domain Names,</li>
<li>Object Identifiers (OIDs) as defined in the ITU-T X 660 and X 670 Recommendation series or</li>
<li>Universally Unique IDentifier (UUID) as defined in RFC 4122 [RFC4122].</li>
</ul>
</div></blockquote>
<p>In each case,
the definer of the name or value MUST take reasonable precautions to make sure
they are in control of the part of the namespace they use to define the claim name.</p>
<p>(v.06)</p>
</div>
<div class="section" id="private-claim-names">
<span id="jwt-4-3"></span><h3><a class="toc-backref" href="#id18">4.3.  Private Claim Names</a><a class="headerlink" href="#private-claim-names" title="Permalink to this headline">¶</a></h3>
<p>A producer and consumer of a JWT may agree to any claim name that is not a <a class="reference internal" href="#jwt-4-1"><em>Reserved Name Section 4.1</em></a> or
a <a class="reference internal" href="#jwt-4-2"><em>Public Name Section 4.2</em></a>.
Unlike Public Names,
these private names are subject to collision and should be used with caution.</p>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="jwt-header">
<span id="jwt-5"></span><h2><a class="toc-backref" href="#id19">5.  JWT Header</a><a class="headerlink" href="#jwt-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object represented by the JWT Header
describe the cryptographic operations applied to the JWT and optionally,
additional properties of the JWT.</p>
<p>There are two ways of distinguishing whether the JWT is a JWS or JWE.
The first is by examining the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (<a class="reference internal" href="glossary.html#term-algorithm"><em class="xref std std-term">algorithm</em></a>) header value.
If the value represents a signature algorithm, the JWT is a JWS;
if it represents an encryption algorithm, the JWT is a JWE.</p>
<p>A second method is determining whether an <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> (<a class="reference internal" href="glossary.html#term-encryption-method"><em class="xref std std-term">encryption method</em></a>) member exists.
If the <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> member exists, the JWT is a JWE;
otherwise, the JWT is a JWS.</p>
<p>Both methods will yield the same result.</p>
<p>Implementations MUST understand the entire contents of the header;
otherwise, the JWT MUST be rejected for processing.</p>
<p><a class="reference internal" href="glossary.html#term-jws-header-parameters"><em class="xref std std-term">JWS Header Parameters</em></a> are defined by [JWS].
<a class="reference internal" href="glossary.html#term-jwe-header-parameters"><em class="xref std std-term">JWE Header Parameters</em></a> are defined by [JWE].
This specification further specifies the use of the following header parameters
in both the cases where the JWT is a JWS and where it is a JWE.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="15%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header
Parameter
Name</th>
<th class="head">JSON
Value
Type</th>
<th class="head">Header
Parameter
Syntax</th>
<th class="head">Header Parameter Semantics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>typ</td>
<td>string</td>
<td>String</td>
<td><p class="first">The <a class="reference internal" href="oauth_regtoken.html#term-typ"><em class="xref std std-term">typ</em></a> (type) header parameter is used to
declare structural information  about the JWT.</p>
<p>In the normal case where nested signing or
encryption operations are not employed,
the use of this header parameter is OPTIONAL,
and if present, it is RECOMMENDED that its value be either &#8220;JWT&#8221;
or &#8220;<a class="reference external" href="http://openid.net/specs/jwt/1.0">http://openid.net/specs/jwt/1.0</a>&#8221;.</p>
<p class="last">In the case that nested signing or encryption steps are employed,
the use of this header parameter is REQUIRED;
in this case, the value MUST either be &#8220;JWS&#8221;,
to indicate that a nested signed JWT is carried in this JWT or &#8220;JWE&#8221;,
to indicate that a nested encrypted JWT is carried in this JWT.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="plaintext-jwts">
<span id="jwt-6"></span><h2><a class="toc-backref" href="#id20">6.  Plaintext JWTs</a><a class="headerlink" href="#plaintext-jwts" title="Permalink to this headline">¶</a></h2>
<p>To support use cases where the JWT content is secured by a means other
than a signature and/or encryption contained within the token
(such as a signature on a data structure containing the token),
JWTs MAY also be created without a signature or encryption.</p>
<p>Plaintext JWTs MUST use the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value <strong>none</strong>, and are formatted identically to a signed JWT
with an empty signature.
This means that
the <a class="reference internal" href="#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the bytes representing the UTF-8 encoding of the <em class="xref std std-term">JWT Claims Object</em>
is the <em class="xref std std-term">JWT Second Part</em>, and the empty string is the <em class="xref std std-term">JWT Third Part</em>.</p>
<p>(v.06)</p>
<div class="section" id="example-plaintext-jwt">
<span id="plaintext-jwt"></span><span id="jwt-6-1"></span><h3><a class="toc-backref" href="#id21">6.1. Example Plaintext JWT</a><a class="headerlink" href="#example-plaintext-jwt" title="Permalink to this headline">¶</a></h3>
<p>The following example JWT Header declares that the encoded object is
a <a class="reference internal" href="glossary.html#term-plaintext-jwt"><em class="xref std std-term">Plaintext JWT</em></a>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;none&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the octets of the UTF-8 representation of
the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> yields this <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJub25lIn0</span>
</pre></div>
</div>
<p>The following is an example of a <a class="reference internal" href="#term-jwt-claims-set"><em class="xref std std-term">JWT Claims Set</em></a>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="s2">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s2">&quot;http://example.com/is_root&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
<p><a class="reference internal" href="#term-base64url-encoding"><em class="xref std std-term">Base64url encoding</em></a> the octets of the UTF-8 representation of
the JWT Claims Set yields this <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>
(with line breaks for display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt</span>
<span class="n">cGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a> is the empty string.</p>
<p>Concatenating these parts in this order with period (&#8216;.&#8217;) characters
between the parts yields this complete JWT
(with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJub25lIn0
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFt
cGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>alg = none だと、JWS ( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-3.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-algorithms-13#section-3.1</a> )</li>
<li>シグネチャがブランク文字列なので、トークンはピリオドで終わります</li>
</ul>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11#section-6.1">https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11#section-6.1</a> )</p>
</div>
</div>
<div class="section" id="rules-for-creating-and-validating-a-jwt">
<span id="jwt-7"></span><h2><a class="toc-backref" href="#id22">7.  Rules for Creating and Validating a JWT</a><a class="headerlink" href="#rules-for-creating-and-validating-a-jwt" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="jws.html"><em>JSON Web Signature (JWS)</em></a> : [<a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>].[<a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>].[<a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>]</li>
<li><a class="reference internal" href="jwe.html"><em>JSON Web Encryption (JWE)</em></a> - [<a class="reference internal" href="jwe.html#term-encoded-jwe-header"><em class="xref std std-term">Encoded JWE Header</em></a>].[<a class="reference internal" href="jwe.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>].[<a class="reference internal" href="jwe.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>]</li>
<li><strong>plaintext</strong> - [<a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>].[<a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a>]</li>
</ul>
</div>
<dl class="glossary docutils">
<dt id="term-message">Message</dt>
<dd>UTF-8 representation of the <em class="xref std std-term">JWT Claims Object</em></dd>
</dl>
<p>To create a JWT, one MUST follow these steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Create a <em class="xref std std-term">JWT Claims Object</em> containing the desired claims.
Note that <a class="reference internal" href="glossary.html#term-white-space"><em class="xref std std-term">white space</em></a> is explicitly allowed in the representation
and no canonicalization is performed before encoding.</p>
</li>
<li><p class="first">Let the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> be the bytes of the UTF-8 representation of the <em class="xref std std-term">JWT Claims Object</em>.</p>
</li>
<li><p class="first">Create a <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> containing the desired set of header parameters.</p>
<p>If the JWT is to be signed or encrypted,
they MUST conform to either the [<a class="reference internal" href="messages.html#term-jws"><em class="xref std std-term">JWS</em></a>] or [<a class="reference internal" href="messages.html#term-jwe"><em class="xref std std-term">JWE</em></a>] specifications, respectively.</p>
<p>Else, if the JWT is to be <a class="reference internal" href="jwe.html#term-plaintext"><em class="xref std std-term">plaintext</em></a>,
the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value <strong>none</strong> MUST be used.
Note that <a class="reference internal" href="glossary.html#term-white-space"><em class="xref std std-term">white space</em></a> is explicitly allowed in the representation
and no canonicalization is performed before encoding.</p>
</li>
<li><p class="first">Base64url encode the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a>.
Let this be the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>.</p>
</li>
<li><p class="first">Depending upon whether the JWT is to be signed, encrypted, or plaintext, there are three cases:</p>
<ul>
<li><p class="first">If the JWT is to be signed,
create a JWS using the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> as the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a>
and the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> as the <a class="reference internal" href="jws.html#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>;</p>
<p>all steps specified in [<a class="reference internal" href="messages.html#term-jws"><em class="xref std std-term">JWS</em></a>] for creating a JWS MUST be followed.</p>
<p>Let the <em class="xref std std-term">JWT Second Part</em> be the <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a> and
let the <em class="xref std std-term">JWT Third Part</em> be the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>.</p>
</li>
<li><p class="first">If the JWT is to be encrypted,
create a JWE using the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> as the <a class="reference internal" href="jwe.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> and
the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> as the <a class="reference internal" href="glossary.html#term-jwe-plaintext"><em class="xref std std-term">JWE Plaintext</em></a>;</p>
<p>all steps specified in [<a class="reference internal" href="messages.html#term-jwe"><em class="xref std std-term">JWE</em></a>] for creating a JWE MUST be followed.
Let the <em class="xref std std-term">JWT Second Part</em> be the <a class="reference internal" href="jwe.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a> and
let the <em class="xref std std-term">JWT Third Part</em> be the <a class="reference internal" href="jwe.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>.</p>
</li>
<li><p class="first">Else,
if the JWT is to be <a class="reference internal" href="jwe.html#term-plaintext"><em class="xref std std-term">plaintext</em></a>,
let the <em class="xref std std-term">JWT Second Part</em> be the base64url encoding of the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a>
and let the <em class="xref std std-term">JWT Third Part</em> be the <strong>empty string</strong>.</p>
</li>
</ul>
</li>
<li><p class="first">Concatenate the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>,
the <em class="xref std std-term">JWT Second Part</em>,
and the <em class="xref std std-term">JWT Third Part</em> in that order,
separating each by <strong>period (&#8216;.&#8217;)</strong> characters.</p>
</li>
<li><p class="first">If a nested signing or encryption operation will be performed,
let the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> be this concatenation, and return to Step 3,
using a <a class="reference internal" href="oauth_regtoken.html#term-typ"><em class="xref std std-term">typ</em></a> value of either &#8220;JWS&#8221; or &#8220;JWE&#8221; respectively in the new JWT Header created in that step.</p>
</li>
<li><p class="first">Otherwise, let the resulting JWT be this concatenation.</p>
</li>
</ol>
</div></blockquote>
<p>When validating a JWT the following steps MUST be taken. If any of the listed steps fails then the token MUST be rejected for processing.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The JWT MUST contain exactly <strong>two period characters</strong>.</li>
<li>The JWT MUST be split on the two period characters resulting in three strings.
The first string is the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>;
the second is the <em class="xref std std-term">JWT Second Part</em>;
the third is the <em class="xref std std-term">JWT Third Part</em>.</li>
<li>The <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a> MUST be successfully <strong>base64url decoded</strong>
following the restriction given in this specification that <strong>no padding characters</strong> have been used.</li>
<li>The <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> MUST be completely valid JSON syntax conforming to RFC 4627 [<a class="reference internal" href="messages.html#term-rfc4627"><em class="xref std std-term">RFC4627</em></a>].</li>
<li>The <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> MUST be validated to only include parameters
and values whose syntax and semantics are both understood and supported.</li>
<li>Determine whether the JWT is signed, encrypted, or plaintext
by examining the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (algorithm) header value and optionally,
the <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> (encryption method) header value,
if present.</li>
<li>Depending upon whether the JWT signed, encrypted, or plaintext, there are three cases:<ul>
<li>If the JWT is signed, all steps specified in [JWS] for validating a JWS MUST be followed.
Let the Message be the result of base64url decoding the JWS Payload.</li>
<li>If the JWT is encrypted, all steps specified in [JWE] for validating a JWE MUST be followed.
Let the Message be the JWE Plaintext.</li>
<li>Else,
if the JWT is plaintext,
let the Message be the result of base64url decoding the JWE Second Part.
The Third Part MUST be verified to be the empty string.</li>
</ul>
</li>
<li>If the JWT Header contains a typ value of either &#8220;JWS&#8221; or &#8220;JWE&#8221;, then the Message contains a JWT that was the subject of nested signing or encryption operations, respectively. In this case, return to Step 1, using the Message as the JWT.</li>
<li>Otherwise, let the JWT Claims object be the Message.</li>
<li>The JWT Claims Object MUST be completely valid JSON syntax conforming to RFC 4627 [RFC4627].</li>
<li>When used in a security-related context,
the JWT Claims Object MUST be validated to only include claims whose syntax and semantics are both understood and supported.</li>
</ol>
</div></blockquote>
<p>Processing a JWT inevitably requires comparing known strings to values in the token. For example, in checking what the algorithm is, the Unicode string encoding alg will be checked against the member names in the JWT Header to see if there is a matching header parameter name. A similar process occurs when determining if the value of the alg header parameter represents a supported algorithm. Comparing Unicode strings, however, has significant security implications, as per Section 10.</p>
<p>Comparisons between JSON strings and other Unicode strings MUST be performed as specified below:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Remove any JSON applied escaping to produce an array of Unicode code points.</li>
<li>Unicode Normalization [USA15] MUST NOT be applied at any point to either the JSON string or to the string it is to be compared against.</li>
<li>Comparisons between the two strings MUST be performed as a Unicode code point to code point equality comparison.</li>
</ol>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="cryptographic-algorithms">
<span id="jwt-8"></span><h2><a class="toc-backref" href="#id23">8.  Cryptographic Algorithms</a><a class="headerlink" href="#cryptographic-algorithms" title="Permalink to this headline">¶</a></h2>
<p>JWTs use JSON Web Signature (JWS) [<a class="reference internal" href="messages.html#term-jws"><em class="xref std std-term">JWS</em></a>] and
JSON Web Encryption (JWE) [<a class="reference internal" href="messages.html#term-jwe"><em class="xref std std-term">JWE</em></a>] to sign and/or encrypt the contents of the JWT.</p>
<p>Of the JWS signing algorithms,
only HMAC SHA-256 MUST be implemented by conforming JWT implementations.
It is RECOMMENDED that implementations also support the RSA SHA-256 and ECDSA P-256 SHA-256 algorithms.
Support for other algorithms and key sizes is OPTIONAL.</p>
<p>If an implementation provides encryption capabilities,
of the JWE encryption algorithms,
only RSA-PKCS1-1.5 with 2048 bit keys,
AES-128-CBC, and
AES-256-CBC
MUST be implemented by conforming implementations.</p>
<p>It is RECOMMENDED that implementations also support
ECDH-ES with 256 bit keys,
AES-128-GCM, and
AES-256-GCM.</p>
<p>Support for other algorithms and key sizes is OPTIONAL.</p>
<p>(v.06)</p>
</div>
<div class="section" id="iana-considerations">
<span id="jwt-9"></span><h2><a class="toc-backref" href="#id24">9.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This specification calls for:</p>
<blockquote>
<div><p>A new IANA registry entitled &#8220;JSON Web Token Claims&#8221; for reserved claim names is defined in <a class="reference internal" href="#jwt-4-1"><em>Section 4.1</em></a>.
Inclusion in the registry is RFC Required in the RFC 5226 [<span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc5226.html"><strong>RFC 5226</strong></a>] sense for reserved JWT claim names
that are intended to be interoperable between implementations.</p>
<p>The registry will just record the reserved claim name and a pointer to the RFC that defines it.
This specification defines inclusion of the claim names defined in <a class="reference internal" href="#jwt-table-1"><em>Table 1</em></a>.</p>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="security-considerations">
<span id="jwt-10"></span><h2><a class="toc-backref" href="#id25">10.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD: Lots of work to do here.
We need to remember to look into any issues relating to security and JSON parsing. One wonders just how secure most JSON parsing libraries are. Were they ever hardened for security scenarios? If not, what kind of holes does that open up? Also, we need to walk through the JSON standard and see what kind of issues we have especially around comparison of names. For instance, comparisons of claim names and other parameters must occur after they are unescaped. Need to also put in text about: Importance of keeping secrets secret. Rotating keys. Strengths and weaknesses of the different algorithms.</p>
<p>TBD: Need to put in text about why strict JSON validation is necessary. Basically, that if malformed JSON is received then the intent of the sender is impossible to reliably discern. One example of malformed JSON that MUST be rejected is an object in which the same member name occurs multiple times. While in non-security contexts it&#8217;s o.k. to be generous in what one accepts, in security contexts this can lead to serious security holes. For example, malformed JSON might indicate that someone has managed to find a security hole in the issuer&#8217;s code and is leveraging it to get the issuer to issue &#8220;bad&#8221; tokens whose content the attacker can control.</p>
<p>TBD: Write about the need to secure the token content if a signature is not contained in the JWT itself.</p>
<p>(v.06)</p>
<div class="section" id="unicode-comparison-security-issues">
<span id="jwt-10-1"></span><h3><a class="toc-backref" href="#id26">10.1.  Unicode Comparison Security Issues</a><a class="headerlink" href="#unicode-comparison-security-issues" title="Permalink to this headline">¶</a></h3>
<p>Claim names in JWTs are Unicode strings. For security reasons, the representations of these names must be compared verbatim after performing any escape processing (as per RFC 4627 [RFC4627], Section 2.5).</p>
<p>This means, for instance, that these JSON strings must compare as being equal (&#8220;JWT&#8221;, &#8220;u004aWT&#8221;), whereas these must all compare as being not equal to the first set or to each other (&#8220;jwt&#8221;, &#8220;Jwt&#8221;, &#8220;JWu0074&#8221;).</p>
<p>JSON strings MAY contain characters outside the Unicode Basic Multilingual Plane. For instance, the G clef character (U+1D11E) may be represented in a JSON string as &#8220;uD834uDD1E&#8221;. Ideally, JWT implementations SHOULD ensure that characters outside the Basic Multilingual Plane are preserved and compared correctly; alternatively, if this is not possible due to these characters exercising limitations present in the underlying JSON implementation, then input containing them MUST be rejected.</p>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="references">
<span id="jwt-12"></span><h2><a class="toc-backref" href="#id27">12.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(v.06)</p>
<div class="section" id="normative-references">
<span id="jwt-12-1"></span><h3><a class="toc-backref" href="#id28">12.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-jws">JWS</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Signature (JWS),” October 2011.
(<a class="reference internal" href="jws.html"><em>JSON Web Signature (JWS)</em></a>)</dd>
<dt id="term-rfc2045">RFC2045</dt>
<dd>Freed, N. and N. Borenstein, “Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,” RFC 2045, November 1996 (TXT).</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt id="term-rfc3339">RFC3339</dt>
<dd>Klyne, G., Ed. and C. Newman, “Date and Time on the Internet: Timestamps,” RFC 3339, July 2002 (TXT, HTML, XML).</dd>
<dt id="term-rfc3629">RFC3629</dt>
<dd>Yergeau, F., “UTF-8, a transformation format of ISO 10646,” STD 63, RFC 3629, November 2003 (TXT).</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” STD 66, RFC 3986, January 2005 (TXT, HTML, XML).</dd>
<dt id="term-rfc4627">RFC4627</dt>
<dd>Crockford, D., “The application/json Media Type for JavaScript Object Notation (JSON),” RFC 4627, July 2006 (TXT).</dd>
<dt id="term-rfc4648">RFC4648</dt>
<dd>Josefsson, S., “The Base16, Base32, and Base64 Data Encodings,” RFC 4648, October 2006 (TXT).</dd>
<dt id="term-rfc5226">RFC5226</dt>
<dd>Narten, T. and H. Alvestrand, “Guidelines for Writing an IANA Considerations Section in RFCs,” BCP 26, RFC 5226, May 2008 (TXT).</dd>
<dt id="term-usa15">USA15</dt>
<dd>Davis, M., Whistler, K., and M. Dürst, “Unicode Normalization Forms,” Unicode Standard Annex 15, 09 2009.</dd>
</dl>
<p>(v.06)</p>
</div>
<div class="section" id="informative-references">
<span id="jwt-12-2"></span><h3><a class="toc-backref" href="#id29">12.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">CanvasApp</dt>
<dd>Facebook, “Canvas Applications,” 2010.</dd>
<dt id="term-jss">JSS</dt>
<dd>Bradley, J. and N. Sakimura (editor), “JSON Simple Sign,” September 2010.</dd>
<dt id="term-jwe">JWE</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, “JSON Web Encryption (JWE),” October 2011. (<a class="reference internal" href="jwe.html"><em>JSON Web Encryption (JWE)</em></a>)</dd>
<dt id="term-magicsignatures">MagicSignatures</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, “Magic Signatures,” August 2010.</dd>
<dt id="term-oasis-saml-core-2-0-os">OASIS.saml-core-2.0-os</dt>
<dd>Cantor, S., Kemp, J., Philpott, R., and E. Maler, “Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0,” OASIS Standard saml-core-2.0-os, March 2005.</dd>
<dt id="term-rfc3275">RFC3275</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, “(Extensible Markup Language) XML-Signature Syntax and Processing,” RFC 3275, March 2002 (TXT).</dd>
<dt id="term-rfc4122">RFC4122</dt>
<dd>Leach, P., Mealling, M., and R. Salz, “A Universally Unique IDentifier (UUID) URN Namespace,” RFC 4122, July 2005 (TXT, HTML, XML).</dd>
<dt id="term-swt">SWT</dt>
<dd>Hardt, D. and Y. Goland, “Simple Web Token (SWT),” Version 0.9.5.1, November 2009.</dd>
<dt id="term-w3c-cr-xml11-20021015">W3C.CR-xml11-20021015</dt>
<dd>Cowan, J., “Extensible Markup Language (XML) 1.1,” W3C CR CR-xml11-20021015, October 2002.</dd>
</dl>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="appendix-a-jwt-examples">
<span id="jwt-appendix-a"></span><h2><a class="toc-backref" href="#id30">Appendix A. JWT Examples</a><a class="headerlink" href="#appendix-a-jwt-examples" title="Permalink to this headline">¶</a></h2>
<p>This section contains examples of JWTs.</p>
<p>For other example JWTs,
see Section 6.1 and Appendices A.1, A.2, and A.3 of [JWS].</p>
<p>(<a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11#appendix-A">https://tools.ietf.org/html/draft-ietf-oauth-json-web-token-11#appendix-A</a> )</p>
</div>
<div class="section" id="appendix-b-relationship-of-jwts-to-simple-web-tokens-swts">
<span id="jwt-appendix-b"></span><h2><a class="toc-backref" href="#id31">Appendix B.  Relationship of JWTs to Simple Web Tokens (SWTs)</a><a class="headerlink" href="#appendix-b-relationship-of-jwts-to-simple-web-tokens-swts" title="Permalink to this headline">¶</a></h2>
<p>Both JWTs and Simple Web Tokens SWT [SWT], at their core,
enable sets of claims to be communicated between applications.</p>
<p>For SWTs,
both the claim names and claim values are strings.
For JWTs,
while claim names are strings,
claim values can be any JSON type.</p>
<p>Both token types offer cryptographic protection of their content:
SWTs with HMAC SHA-256 and
JWTs with a choice of algorithms, including HMAC SHA-256, RSA SHA-256, and ECDSA P-256 SHA-256.</p>
<p>(v.06)</p>
</div>
<div class="section" id="appendix-c-acknowledgements">
<span id="jwt-appendix-c"></span><h2><a class="toc-backref" href="#id32">Appendix C.  Acknowledgements</a><a class="headerlink" href="#appendix-c-acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>The authors acknowledge that
the design of JWTs was intentionally influenced by the design and simplicity of Simple Web Tokens [SWT]
and ideas for JSON tokens that Dick Hardt discussed within the OpenID community.</p>
<p>Solutions for signing JSON content were previously explored by Magic Signatures [MagicSignatures],
JSON Simple Sign [JSS], and Canvas Applications [CanvasApp], all of which influenced this draft.</p>
<p>(v.06)</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jose.html">Terms</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws.html">JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>