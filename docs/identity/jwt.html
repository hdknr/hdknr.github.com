

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Token(JWT) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Signature (JWS)" href="jws.html" />
    <link rel="prev" title="UMA Trust Model" href="uma_trust.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Token(JWT)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="uma_trust.html">UMA Trust Model</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws.html">JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-token-jwt">
<h1><a class="toc-backref" href="#id1">JSON Web Token(JWT)</a><a class="headerlink" href="#json-web-token-jwt" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="http://self-issued.info/docs/draft-jones-json-web-token.html">JSON Web Token (JWT) draft-jones-json-web-token-06</a>
(October 30, 2011 )</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Now draft is 07 (December 13, 2011)
( <a class="reference external" href="http://self-issued.info/docs/draft-jones-json-web-token.html">http://self-issued.info/docs/draft-jones-json-web-token.html</a> )</p>
</div>
<div class="section" id="abstract">
<span id="jwt-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Token (JWT) is a means of representing <a class="reference internal" href="messages.html#term-claims"><em class="xref std std-term">claims</em></a> to be transferred between two parties.
The claims in a JWT are encoded as a <a class="reference internal" href="glossary.html#term-json"><em class="xref std std-term">JSON</em></a> object
that is digitally signed using <a class="reference internal" href="jws.html"><em>JSON Web Signature (JWS)</em></a>
and/or encrypted using <a class="reference internal" href="jwe.html"><em>JSON Web Encryption (JWE)</em></a>.</p>
<p>The suggested pronunciation of JWT is the same as the English word &#8220;jot&#8221;.</p>
<p>(v.06)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#json-web-token-jwt" id="id1">JSON Web Token(JWT)</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id4">2.  Terminology</a></li>
<li><a class="reference internal" href="#json-web-token-jwt-overview" id="id5">3.  JSON Web Token (JWT) Overview</a><ul>
<li><a class="reference internal" href="#example-jwt" id="id6">3.1.  Example JWT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-claims" id="id7">4.  JWT Claims</a><ul>
<li><a class="reference internal" href="#reserved-claim-names" id="id8">4.1.  Reserved Claim Names</a><ul>
<li><a class="reference internal" href="#table-1-reserved-claim-definitions" id="id9">Table 1: Reserved Claim Definitions</a></li>
<li><a class="reference internal" href="#table-2-claim-syntax-definitions" id="id10">Table 2: Claim Syntax Definitions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#public-claim-names" id="id11">4.2.  Public Claim Names</a></li>
<li><a class="reference internal" href="#private-claim-names" id="id12">4.3.  Private Claim Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-header" id="id13">5.  JWT Header</a></li>
<li><a class="reference internal" href="#plaintext-jwts" id="id14">6.  Plaintext JWTs</a><ul>
<li><a class="reference internal" href="#example-plaintext-jwt" id="id15">6.1.  Example Plaintext JWT</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rules-for-creating-and-validating-a-jwt" id="id16">7.  Rules for Creating and Validating a JWT</a></li>
<li><a class="reference internal" href="#cryptographic-algorithms" id="id17">8.  Cryptographic Algorithms</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id18">9.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations" id="id19">10.  Security Considerations</a><ul>
<li><a class="reference internal" href="#unicode-comparison-security-issues" id="id20">10.1.  Unicode Comparison Security Issues</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id21">12.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id22">12.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id23">12.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-relationship-of-jwts-to-saml-tokens" id="id24">Appendix A.  Relationship of JWTs to SAML Tokens</a></li>
<li><a class="reference internal" href="#appendix-b-relationship-of-jwts-to-simple-web-tokens-swts" id="id25">Appendix B.  Relationship of JWTs to Simple Web Tokens (SWTs)</a></li>
<li><a class="reference internal" href="#appendix-c-acknowledgements" id="id26">Appendix C.  Acknowledgements</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="jwt-1"></span><h2><a class="toc-backref" href="#id3">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Token (JWT) is a compact token format intended for space constrained environments
such as HTTP <a class="reference internal" href="glossary.html#term-authorization-headers"><em class="xref std std-term">Authorization headers</em></a> and <a class="reference internal" href="glossary.html#term-uri-query-parameters"><em class="xref std std-term">URI query parameters</em></a>.
JWTs encode <a class="reference internal" href="messages.html#term-claims"><em class="xref std std-term">claims</em></a> to be transmitted as a <a class="reference internal" href="glossary.html#term-json"><em class="xref std std-term">JSON</em></a> object (as defined in RFC 4627 [<span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc4627.html"><strong>RFC 4627</strong></a>])
that is <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded and digitally signed and/or encrypted.
Signing is accomplished using JSON Web Signature (JWS) [:term::<cite>JWS</cite>].
Encryption is accomplished using JSON Web Encryption (JWE) [<a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>].</p>
<p>The suggested pronunciation of JWT is the same as the English word &#8220;jot&#8221;.</p>
<p>(v.06)</p>
</div>
<div class="section" id="terminology">
<span id="jwt-2"></span><h2><a class="toc-backref" href="#id4">2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-token-jwt">JSON Web Token (JWT)</dt>
<dd>A string consisting of three parts:
the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a>,
the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a>, and
the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a>, in that order,
with the parts being separated by <strong>period</strong> (&#8216;.&#8217;) characters,
and each part containing <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded content.</dd>
<dt id="term-jwt-header">JWT Header</dt>
<dd>A string containing a JSON object that describes the <strong>cryptographic operations</strong> applied to the JWT.
When the JWT is signed, the JWT Header is the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a>.
When the JWT is encrypted, the JWT Header is the <a class="reference internal" href="jwe.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a>.</dd>
<dt id="term-jwt-second-part">JWT Second Part</dt>
<dd>When the JWT is signed, the JWT Second Part is the <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>.
When the JWT is encrypted, the JWT Second Part is the <a class="reference internal" href="jwe.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>.</dd>
<dt id="term-jwt-third-part">JWT Third Part</dt>
<dd>When the JWT is signed, the JWT Third Part is the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>.
When the JWT is encrypted, the JWT Third Part is the <a class="reference internal" href="jwe.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>.</dd>
<dt id="term-jwt-claims-object">JWT Claims Object</dt>
<dd>A JSON object that represents the claims contained in the JWT.
When the JWT is signed, the bytes of the UTF-8 representation of the JWT Claims Object are base64url encoded
to create the <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>.
When the JWT is encrypted, the bytes of the UTF-8 representation of the JWT Claims Object are used as the <a class="reference internal" href="glossary.html#term-jwe-plaintext"><em class="xref std std-term">JWE Plaintext</em></a>.</dd>
<dt id="term-claim-names">Claim Names</dt>
<dd>The names of the members of the JWT Claims Object.</dd>
<dt id="term-claim-values">Claim Values</dt>
<dd>The values of the members of the JWT Claims Object.</dd>
<dt id="term-encoded-jwt-header">Encoded JWT Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8 RFC 3629 [<span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3629.html"><strong>RFC 3629</strong></a>] representation of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a>.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>For the purposes of this specification,
this term always refers to the URL- and filename-safe Base64 encoding described in RFC 4648 [<span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc4648.html"><strong>RFC 4648</strong></a>], Section 5,
with the (non URL-safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>] for notes on implementing base64url encoding without padding.)</dd>
</dl>
<p>(v.06)</p>
</div>
<div class="section" id="json-web-token-jwt-overview">
<span id="jwt-3"></span><h2><a class="toc-backref" href="#id5">3.  JSON Web Token (JWT) Overview</a><a class="headerlink" href="#json-web-token-jwt-overview" title="Permalink to this headline">¶</a></h2>
<p>JWTs represent a set of claims as a JSON object
that is base64url encoded and digitally signed and/or encrypted.
This object is the JWT Claims Object.
As per RFC 4627 [RFC4627] Section 2.2,
the JSON object consists of zero or more name/value pairs (or members),
where the names are strings and the values are arbitrary JSON values.
These members are the claims represented by the JWT.</p>
<p>The member names within the <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a> are referred to as <a class="reference internal" href="#term-claim-names"><em class="xref std std-term">Claim Names</em></a>.
These names MUST be <strong>unique</strong>.
The corresponding values are referred to as <a class="reference internal" href="#term-claim-values"><em class="xref std std-term">Claim Values</em></a>.</p>
<p>The bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a> are signed
in the manner described in JSON Web Signature (JWS) [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>]
and/or encrypted in the manner described in JSON Web Encryption (JWE) [<a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>].</p>
<p>The contents of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> describe the cryptographic operations applied to the JWT Claims Object.
If the JWT Header is a <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a>,
the claims are signed.
If the JWT Header is a <a class="reference internal" href="jwe.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a>, the claims are encrypted.</p>
<p>A JWT is represented as the concatenation of the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>, the JWT Second Part,
and the JWT Third Part, in that order, with the parts being separated by <strong>period</strong> (&#8216;.&#8217;) characters.
When signed,
the three parts of the JWT are the three parts of a JWS used to represent the JWT.
When encrypted, the three parts of the JWT are the three parts of a JWE used to represent the JWT.</p>
<p>(v.06)</p>
<div class="section" id="example-jwt">
<span id="jwt-3-1"></span><h3><a class="toc-backref" href="#id6">3.1.  Example JWT</a><a class="headerlink" href="#example-jwt" title="Permalink to this headline">¶</a></h3>
<p>The following example <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> declares that the encoded object is a JSON Web Token (JWT)
and the JWT is signed using the HMAC SHA-256 algorithm:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;typ&quot;</span><span class="p">:</span><span class="s">&quot;JWT&quot;</span><span class="p">,</span>
 <span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> yields this <a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a> value,
which is used as the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9</span>
</pre></div>
</div>
<p>The following is an example of a <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
 <span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the <a class="reference internal" href="glossary.html#term-json-claims-object"><em class="xref std std-term">JSON Claims Object</em></a> yields this <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>,
which is used as the JWT Second Part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>Signing the <a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a> and <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a> with the HMAC SHA-256 algorithm
and base64url encoding the signature in the manner specified in [JWS],
yields this <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>, which is used as the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">dBjftJeZ4CVP</span><span class="o">-</span><span class="n">mB92K27uhbUJU1p1r_wW1gFWFOEjXk</span>
</pre></div>
</div>
<p>Concatenating these parts in the order <strong>Header.Second.Third</strong> with <strong>period characters</strong>
between the parts yields this complete JWT (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJ0eXAiOiJKV1QiLA0KICJhbGciOiJIUzI1NiJ9
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.
dBjftJeZ4CVP-mB92K27uhbUJU1p1r_wW1gFWFOEjXk</pre>
</div>
<p>This computation is illustrated in more detail in [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>], Appendix A.1.</p>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="jwt-claims">
<span id="jwt-4"></span><h2><a class="toc-backref" href="#id7">4.  JWT Claims</a><a class="headerlink" href="#jwt-claims" title="Permalink to this headline">¶</a></h2>
<p>A JWT contains a set of :term::<cite>claims</cite> represented as a <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a> encoded JSON object.
Note however,
that the set of claims a JWT must contain to be considered valid is context-dependent
and is outside the scope of this specification.
When used in a security-related context,
implementations MUST understand and support all of the claims present;
otherwise, the JWT MUST be rejected for processing.</p>
<p>There are three classes of JWT Claim Names:
<a class="reference internal" href="#jwt-4-1"><em>Reserved Claim Names</em></a>,
<a class="reference internal" href="#jwt-4-2"><em>Public Claim Names</em></a>, and
<a class="reference internal" href="#jwt-4-3"><em>Private Claim Names</em></a>.</p>
<div class="section" id="reserved-claim-names">
<span id="jwt-4-1"></span><h3><a class="toc-backref" href="#id8">4.1.  Reserved Claim Names</a><a class="headerlink" href="#reserved-claim-names" title="Permalink to this headline">¶</a></h3>
<p>The following claim names are reserved.
None of the claims defined in the table below are intended to be mandatory,
but rather, provide a starting point for a set of useful, interoperable claims.
All the names are short because a core goal of JWTs is for the tokens to be compact.</p>
<div class="section" id="table-1-reserved-claim-definitions">
<span id="jwt-table-1"></span><h4><a class="toc-backref" href="#id9">Table 1: Reserved Claim Definitions</a><a class="headerlink" href="#table-1-reserved-claim-definitions" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="4%" />
<col width="8%" />
<col width="11%" />
<col width="77%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Claim
Name</th>
<th class="head">JSON
Value
Type</th>
<th class="head">Claim
Syntax</th>
<th class="head">Claim Semantics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>exp</td>
<td>number</td>
<td>IntDate</td>
<td>The exp (expiration time) claim identifies the expiration time on or
after which the token MUST NOT be accepted for processing.
The processing of the exp claim requires that the current date/time MUST be
before the expiration date/time listed in the exp claim.
Implementers MAY provide for some small leeway,
usually no more than a few minutes, to account for clock skew.
This claim is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>nbf</td>
<td>number</td>
<td>IntDate</td>
<td>The nbf (not before) claim identifies the time before
which the token MUST NOT be accepted for processing.
The processing of the nbf claim requires that the current date/time MUST be after or equal to
the not-before date/time listed in the nbf claim.
Implementers MAY provide for some small leeway, usually no more than a few minutes,
to account for clock skew. This claim is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>iat</td>
<td>number</td>
<td>IntDate</td>
<td>The iat (issued at) claim identifies the time at which the JWT was issued.
This claim can be used to determine the age of the token. This claim is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>iss</td>
<td>string</td>
<td>StringOrURI</td>
<td>The iss (issuer) claim identifies the principal that issued the JWT.
The processing of this claim is generally application specific.
The iss value is case sensitive. This claim is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>aud</td>
<td>string</td>
<td>StringOrURI</td>
<td><p class="first">The <a class="reference internal" href="session.html#term-8"><em class="xref std std-term">aud</em></a> (<a class="reference internal" href="oauth_assertion.html#term-audience"><em class="xref std std-term">audience</em></a>) claim identifies the audience that the JWT is intended for.
The <a class="reference internal" href="oauth_assertion.html#term-principal"><em class="xref std std-term">principal</em></a> intended to process the JWT MUST be identified
by the value of the audience claim.</p>
<p class="last">If the principal processing the claim does not identify itself with the identifier
in the <a class="reference internal" href="session.html#term-8"><em class="xref std std-term">aud</em></a> claim value then the JWT MUST be rejected.
The interpretation of the contents of the audience value is generally application specific.
The aud value is case sensitive. This claim is OPTIONAL.</p>
</td>
</tr>
<tr class="row-odd"><td>typ</td>
<td>string</td>
<td>String</td>
<td>The typ (type) claim is used to declare a type for the contents of this JWT Claims Object.
The typ value is case sensitive. This claim is OPTIONAL.</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Additional reserved claim names MAY be defined via the IANA JSON Web Token Claims registry, as per <a class="reference internal" href="#jwt-9"><em>Section 9</em></a>.
The syntax values used above are defined as follows:</p>
</div>
<div class="section" id="table-2-claim-syntax-definitions">
<span id="jwt-table-2"></span><h4><a class="toc-backref" href="#id10">Table 2: Claim Syntax Definitions</a><a class="headerlink" href="#table-2-claim-syntax-definitions" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Syntax
Name</th>
<th class="head">Syntax Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>IntDate</td>
<td>The number of seconds from 1970-01-01T0:0:0Z as measured in UTC until the desired date/time.
See RFC 3339 [<span class="target" id="index-4"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3339.html"><strong>RFC 3339</strong></a>] for details regarding date/times in general and UTC in particular.</td>
</tr>
<tr class="row-odd"><td>String</td>
<td>Any string value MAY be used.</td>
</tr>
<tr class="row-even"><td>StringOrURI</td>
<td>Any string value MAY be used
but a value containing a &#8221;:&#8221; character MUST be a URI as defined in RFC 3986 [<span class="target" id="index-5"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a>].</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="public-claim-names">
<span id="jwt-4-2"></span><h3><a class="toc-backref" href="#id11">4.2.  Public Claim Names</a><a class="headerlink" href="#public-claim-names" title="Permalink to this headline">¶</a></h3>
<p>Claim names can be defined at will by those using JWTs.
However,
in order to prevent collisions,
any new claim name SHOULD either be defined in the IANA JSON Web Token Claims registry or
be defined as a URI that contains a collision resistant namespace.
Examples of collision resistant namespaces include:</p>
<blockquote>
<div><ul class="simple">
<li>Domain Names,</li>
<li>Object Identifiers (OIDs) as defined in the ITU-T X 660 and X 670 Recommendation series or</li>
<li>Universally Unique IDentifier (UUID) as defined in RFC 4122 [RFC4122].</li>
</ul>
</div></blockquote>
<p>In each case,
the definer of the name or value MUST take reasonable precautions to make sure
they are in control of the part of the namespace they use to define the claim name.</p>
<p>(v.06)</p>
</div>
<div class="section" id="private-claim-names">
<span id="jwt-4-3"></span><h3><a class="toc-backref" href="#id12">4.3.  Private Claim Names</a><a class="headerlink" href="#private-claim-names" title="Permalink to this headline">¶</a></h3>
<p>A producer and consumer of a JWT may agree to any claim name that is not a <a class="reference internal" href="#jwt-4-1"><em>Reserved Name Section 4.1</em></a> or
a <a class="reference internal" href="#jwt-4-2"><em>Public Name Section 4.2</em></a>.
Unlike Public Names,
these private names are subject to collision and should be used with caution.</p>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="jwt-header">
<span id="jwt-5"></span><h2><a class="toc-backref" href="#id13">5.  JWT Header</a><a class="headerlink" href="#jwt-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object represented by the JWT Header
describe the cryptographic operations applied to the JWT and optionally,
additional properties of the JWT.</p>
<p>There are two ways of distinguishing whether the JWT is a JWS or JWE.
The first is by examining the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (<a class="reference internal" href="glossary.html#term-algorithm"><em class="xref std std-term">algorithm</em></a>) header value.
If the value represents a signature algorithm, the JWT is a JWS;
if it represents an encryption algorithm, the JWT is a JWE.</p>
<p>A second method is determining whether an <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> (<a class="reference internal" href="glossary.html#term-encryption-method"><em class="xref std std-term">encryption method</em></a>) member exists.
If the <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> member exists, the JWT is a JWE;
otherwise, the JWT is a JWS.</p>
<p>Both methods will yield the same result.</p>
<p>Implementations MUST understand the entire contents of the header;
otherwise, the JWT MUST be rejected for processing.</p>
<p><a class="reference internal" href="glossary.html#term-jws-header-parameters"><em class="xref std std-term">JWS Header Parameters</em></a> are defined by [JWS].
<a class="reference internal" href="glossary.html#term-jwe-header-parameters"><em class="xref std std-term">JWE Header Parameters</em></a> are defined by [JWE].
This specification further specifies the use of the following header parameters
in both the cases where the JWT is a JWS and where it is a JWE.</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="9%" />
<col width="15%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Header
Parameter
Name</th>
<th class="head">JSON
Value
Type</th>
<th class="head">Header
Parameter
Syntax</th>
<th class="head">Header Parameter Semantics</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>typ</td>
<td>string</td>
<td>String</td>
<td><p class="first">The <a class="reference internal" href="glossary.html#term-typ"><em class="xref std std-term">typ</em></a> (type) header parameter is used to
declare structural information  about the JWT.</p>
<p>In the normal case where nested signing or
encryption operations are not employed,
the use of this header parameter is OPTIONAL,
and if present, it is RECOMMENDED that its value be either &#8220;JWT&#8221;
or &#8220;<a class="reference external" href="http://openid.net/specs/jwt/1.0">http://openid.net/specs/jwt/1.0</a>&#8221;.</p>
<p class="last">In the case that nested signing or encryption steps are employed,
the use of this header parameter is REQUIRED;
in this case, the value MUST either be &#8220;JWS&#8221;,
to indicate that a nested signed JWT is carried in this JWT or &#8220;JWE&#8221;,
to indicate that a nested encrypted JWT is carried in this JWT.</p>
</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="plaintext-jwts">
<span id="jwt-6"></span><h2><a class="toc-backref" href="#id14">6.  Plaintext JWTs</a><a class="headerlink" href="#plaintext-jwts" title="Permalink to this headline">¶</a></h2>
<p>To support use cases where the JWT content is secured by a means other
than a signature and/or encryption contained within the token
(such as a signature on a data structure containing the token),
JWTs MAY also be created without a signature or encryption.</p>
<p>Plaintext JWTs MUST use the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value <strong>none</strong>, and are formatted identically to a signed JWT
with an empty signature.
This means that
the <a class="reference internal" href="#term-base64url-encoding"><em class="xref std std-term">base64url encoding</em></a> of the bytes representing the UTF-8 encoding of the <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a>
is the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a>, and the empty string is the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a>.</p>
<p>(v.06)</p>
<div class="section" id="example-plaintext-jwt">
<span id="jwt-6-1"></span><h3><a class="toc-backref" href="#id15">6.1.  Example Plaintext JWT</a><a class="headerlink" href="#example-plaintext-jwt" title="Permalink to this headline">¶</a></h3>
<p>The following example JWT Header declares that the encoded object is a Plaintext JWT:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;none&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JWT Header yields this Encoded JWT Header:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJub25lIn0</span>
</pre></div>
</div>
<p>The following is an example of a JWT Claims Object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;iss&quot;</span><span class="p">:</span><span class="s">&quot;joe&quot;</span><span class="p">,</span>
<span class="s">&quot;exp&quot;</span><span class="p">:</span><span class="mi">1300819380</span><span class="p">,</span>
<span class="s">&quot;http://example.com/is_root&quot;</span><span class="p">:</span><span class="n">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the JSON Claims Object yields
this Encoded JWS Payload, which is used as the JWT Second Part:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ</span>
</pre></div>
</div>
<p>The JWT Third Part is the empty string.</p>
<p>Concatenating these parts in the order Header.Second.Third with period characters between the parts yields this complete JWT (with line breaks for display purposes only):</p>
<div class="highlight-python"><pre>eyJhbGciOiJub25lIn0
.
eyJpc3MiOiJqb2UiLA0KICJleHAiOjEzMDA4MTkzODAsDQogImh0dHA6Ly9leGFtcGxlLmNvbS9pc19yb290Ijp0cnVlfQ
.</pre>
</div>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="rules-for-creating-and-validating-a-jwt">
<span id="jwt-7"></span><h2><a class="toc-backref" href="#id16">7.  Rules for Creating and Validating a JWT</a><a class="headerlink" href="#rules-for-creating-and-validating-a-jwt" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="jws.html"><em>JSON Web Signature (JWS)</em></a> : [<a class="reference internal" href="jws.html#term-encoded-jws-header"><em class="xref std std-term">Encoded JWS Header</em></a>].[<a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a>].[<a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>]</li>
<li><a class="reference internal" href="jwe.html"><em>JSON Web Encryption (JWE)</em></a> - [<a class="reference internal" href="jwe.html#term-encoded-jwe-header"><em class="xref std std-term">Encoded JWE Header</em></a>].[<a class="reference internal" href="jwe.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>].[<a class="reference internal" href="jwe.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>]</li>
<li><strong>plaintext</strong> - [<a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>].[<a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a>]</li>
</ul>
</div>
<dl class="glossary docutils">
<dt id="term-message">Message</dt>
<dd>UTF-8 representation of the <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a></dd>
</dl>
<p>To create a JWT, one MUST follow these steps:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">Create a <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a> containing the desired claims.
Note that <a class="reference internal" href="glossary.html#term-white-space"><em class="xref std std-term">white space</em></a> is explicitly allowed in the representation
and no canonicalization is performed before encoding.</p>
</li>
<li><p class="first">Let the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> be the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-claims-object"><em class="xref std std-term">JWT Claims Object</em></a>.</p>
</li>
<li><p class="first">Create a <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> containing the desired set of header parameters.</p>
<p>If the JWT is to be signed or encrypted,
they MUST conform to either the [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>] or [<a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>] specifications, respectively.</p>
<p>Else, if the JWT is to be <a class="reference internal" href="jwe.html#term-plaintext"><em class="xref std std-term">plaintext</em></a>,
the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value <strong>none</strong> MUST be used.
Note that <a class="reference internal" href="glossary.html#term-white-space"><em class="xref std std-term">white space</em></a> is explicitly allowed in the representation
and no canonicalization is performed before encoding.</p>
</li>
<li><p class="first">Base64url encode the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a>.
Let this be the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>.</p>
</li>
<li><p class="first">Depending upon whether the JWT is to be signed, encrypted, or plaintext, there are three cases:</p>
<ul>
<li><p class="first">If the JWT is to be signed,
create a JWS using the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> as the <a class="reference internal" href="jws.html#term-jws-header"><em class="xref std std-term">JWS Header</em></a>
and the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> as the <a class="reference internal" href="jws.html#term-jws-payload"><em class="xref std std-term">JWS Payload</em></a>;</p>
<p>all steps specified in [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>] for creating a JWS MUST be followed.</p>
<p>Let the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a> be the <a class="reference internal" href="jws.html#term-encoded-jws-payload"><em class="xref std std-term">Encoded JWS Payload</em></a> and
let the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a> be the <a class="reference internal" href="jws.html#term-encoded-jws-signature"><em class="xref std std-term">Encoded JWS Signature</em></a>.</p>
</li>
<li><p class="first">If the JWT is to be encrypted,
create a JWE using the <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> as the <a class="reference internal" href="jwe.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> and
the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> as the <a class="reference internal" href="glossary.html#term-jwe-plaintext"><em class="xref std std-term">JWE Plaintext</em></a>;</p>
<p>all steps specified in [<a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>] for creating a JWE MUST be followed.
Let the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a> be the <a class="reference internal" href="jwe.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a> and
let the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a> be the <a class="reference internal" href="jwe.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>.</p>
</li>
<li><p class="first">Else,
if the JWT is to be <a class="reference internal" href="jwe.html#term-plaintext"><em class="xref std std-term">plaintext</em></a>,
let the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a> be the base64url encoding of the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a>
and let the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a> be the <strong>empty string</strong>.</p>
</li>
</ul>
</li>
<li><p class="first">Concatenate the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>,
the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a>,
and the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a> in that order,
separating each by <strong>period (&#8216;.&#8217;)</strong> characters.</p>
</li>
<li><p class="first">If a nested signing or encryption operation will be performed,
let the <a class="reference internal" href="messages.html#term-message"><em class="xref std std-term">Message</em></a> be this concatenation, and return to Step 3,
using a <a class="reference internal" href="glossary.html#term-typ"><em class="xref std std-term">typ</em></a> value of either &#8220;JWS&#8221; or &#8220;JWE&#8221; respectively in the new JWT Header created in that step.</p>
</li>
<li><p class="first">Otherwise, let the resulting JWT be this concatenation.</p>
</li>
</ol>
</div></blockquote>
<p>When validating a JWT the following steps MUST be taken. If any of the listed steps fails then the token MUST be rejected for processing.</p>
<blockquote>
<div><ol class="arabic simple">
<li>The JWT MUST contain exactly <strong>two period characters</strong>.</li>
<li>The JWT MUST be split on the two period characters resulting in three strings.
The first string is the <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a>;
the second is the <a class="reference internal" href="#term-jwt-second-part"><em class="xref std std-term">JWT Second Part</em></a>;
the third is the <a class="reference internal" href="#term-jwt-third-part"><em class="xref std std-term">JWT Third Part</em></a>.</li>
<li>The <a class="reference internal" href="#term-encoded-jwt-header"><em class="xref std std-term">Encoded JWT Header</em></a> MUST be successfully <strong>base64url decoded</strong>
following the restriction given in this specification that <strong>no padding characters</strong> have been used.</li>
<li>The <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> MUST be completely valid JSON syntax conforming to RFC 4627 [<a class="reference internal" href="standard.html#term-rfc4627"><em class="xref std std-term">RFC4627</em></a>].</li>
<li>The <a class="reference internal" href="#term-jwt-header"><em class="xref std std-term">JWT Header</em></a> MUST be validated to only include parameters
and values whose syntax and semantics are both understood and supported.</li>
<li>Determine whether the JWT is signed, encrypted, or plaintext
by examining the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (algorithm) header value and optionally,
the <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> (encryption method) header value,
if present.</li>
<li>Depending upon whether the JWT signed, encrypted, or plaintext, there are three cases:<ul>
<li>If the JWT is signed, all steps specified in [JWS] for validating a JWS MUST be followed.
Let the Message be the result of base64url decoding the JWS Payload.</li>
<li>If the JWT is encrypted, all steps specified in [JWE] for validating a JWE MUST be followed.
Let the Message be the JWE Plaintext.</li>
<li>Else,
if the JWT is plaintext,
let the Message be the result of base64url decoding the JWE Second Part.
The Third Part MUST be verified to be the empty string.</li>
</ul>
</li>
<li>If the JWT Header contains a typ value of either &#8220;JWS&#8221; or &#8220;JWE&#8221;, then the Message contains a JWT that was the subject of nested signing or encryption operations, respectively. In this case, return to Step 1, using the Message as the JWT.</li>
<li>Otherwise, let the JWT Claims object be the Message.</li>
<li>The JWT Claims Object MUST be completely valid JSON syntax conforming to RFC 4627 [RFC4627].</li>
<li>When used in a security-related context,
the JWT Claims Object MUST be validated to only include claims whose syntax and semantics are both understood and supported.</li>
</ol>
</div></blockquote>
<p>Processing a JWT inevitably requires comparing known strings to values in the token. For example, in checking what the algorithm is, the Unicode string encoding alg will be checked against the member names in the JWT Header to see if there is a matching header parameter name. A similar process occurs when determining if the value of the alg header parameter represents a supported algorithm. Comparing Unicode strings, however, has significant security implications, as per Section 10.</p>
<p>Comparisons between JSON strings and other Unicode strings MUST be performed as specified below:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Remove any JSON applied escaping to produce an array of Unicode code points.</li>
<li>Unicode Normalization [USA15] MUST NOT be applied at any point to either the JSON string or to the string it is to be compared against.</li>
<li>Comparisons between the two strings MUST be performed as a Unicode code point to code point equality comparison.</li>
</ol>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="cryptographic-algorithms">
<span id="jwt-8"></span><h2><a class="toc-backref" href="#id17">8.  Cryptographic Algorithms</a><a class="headerlink" href="#cryptographic-algorithms" title="Permalink to this headline">¶</a></h2>
<p>JWTs use JSON Web Signature (JWS) [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>] and
JSON Web Encryption (JWE) [<a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>] to sign and/or encrypt the contents of the JWT.</p>
<p>Of the JWS signing algorithms,
only HMAC SHA-256 MUST be implemented by conforming JWT implementations.
It is RECOMMENDED that implementations also support the RSA SHA-256 and ECDSA P-256 SHA-256 algorithms.
Support for other algorithms and key sizes is OPTIONAL.</p>
<p>If an implementation provides encryption capabilities,
of the JWE encryption algorithms,
only RSA-PKCS1-1.5 with 2048 bit keys,
AES-128-CBC, and
AES-256-CBC
MUST be implemented by conforming implementations.</p>
<p>It is RECOMMENDED that implementations also support
ECDH-ES with 256 bit keys,
AES-128-GCM, and
AES-256-GCM.</p>
<p>Support for other algorithms and key sizes is OPTIONAL.</p>
<p>(v.06)</p>
</div>
<div class="section" id="iana-considerations">
<span id="jwt-9"></span><h2><a class="toc-backref" href="#id18">9.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This specification calls for:</p>
<blockquote>
<div><p>A new IANA registry entitled &#8220;JSON Web Token Claims&#8221; for reserved claim names is defined in <a class="reference internal" href="#jwt-4-1"><em>Section 4.1</em></a>.
Inclusion in the registry is RFC Required in the RFC 5226 [<span class="target" id="index-6"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc5226.html"><strong>RFC 5226</strong></a>] sense for reserved JWT claim names
that are intended to be interoperable between implementations.</p>
<p>The registry will just record the reserved claim name and a pointer to the RFC that defines it.
This specification defines inclusion of the claim names defined in <a class="reference internal" href="#jwt-table-1"><em>Table 1</em></a>.</p>
</div></blockquote>
<p>(v.06)</p>
</div>
<div class="section" id="security-considerations">
<span id="jwt-10"></span><h2><a class="toc-backref" href="#id19">10.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>TBD: Lots of work to do here.
We need to remember to look into any issues relating to security and JSON parsing. One wonders just how secure most JSON parsing libraries are. Were they ever hardened for security scenarios? If not, what kind of holes does that open up? Also, we need to walk through the JSON standard and see what kind of issues we have especially around comparison of names. For instance, comparisons of claim names and other parameters must occur after they are unescaped. Need to also put in text about: Importance of keeping secrets secret. Rotating keys. Strengths and weaknesses of the different algorithms.</p>
<p>TBD: Need to put in text about why strict JSON validation is necessary. Basically, that if malformed JSON is received then the intent of the sender is impossible to reliably discern. One example of malformed JSON that MUST be rejected is an object in which the same member name occurs multiple times. While in non-security contexts it&#8217;s o.k. to be generous in what one accepts, in security contexts this can lead to serious security holes. For example, malformed JSON might indicate that someone has managed to find a security hole in the issuer&#8217;s code and is leveraging it to get the issuer to issue &#8220;bad&#8221; tokens whose content the attacker can control.</p>
<p>TBD: Write about the need to secure the token content if a signature is not contained in the JWT itself.</p>
<p>(v.06)</p>
<div class="section" id="unicode-comparison-security-issues">
<span id="jwt-10-1"></span><h3><a class="toc-backref" href="#id20">10.1.  Unicode Comparison Security Issues</a><a class="headerlink" href="#unicode-comparison-security-issues" title="Permalink to this headline">¶</a></h3>
<p>Claim names in JWTs are Unicode strings. For security reasons, the representations of these names must be compared verbatim after performing any escape processing (as per RFC 4627 [RFC4627], Section 2.5).</p>
<p>This means, for instance, that these JSON strings must compare as being equal (&#8220;JWT&#8221;, &#8220;u004aWT&#8221;), whereas these must all compare as being not equal to the first set or to each other (&#8220;jwt&#8221;, &#8220;Jwt&#8221;, &#8220;JWu0074&#8221;).</p>
<p>JSON strings MAY contain characters outside the Unicode Basic Multilingual Plane. For instance, the G clef character (U+1D11E) may be represented in a JSON string as &#8220;uD834uDD1E&#8221;. Ideally, JWT implementations SHOULD ensure that characters outside the Basic Multilingual Plane are preserved and compared correctly; alternatively, if this is not possible due to these characters exercising limitations present in the underlying JSON implementation, then input containing them MUST be rejected.</p>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="references">
<span id="jwt-12"></span><h2><a class="toc-backref" href="#id21">12.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(v.06)</p>
<div class="section" id="normative-references">
<span id="jwt-12-1"></span><h3><a class="toc-backref" href="#id22">12.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-jws">JWS</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Signature (JWS),” October 2011.
(<a class="reference internal" href="jws.html"><em>JSON Web Signature (JWS)</em></a>)</dd>
<dt id="term-rfc2045">RFC2045</dt>
<dd>Freed, N. and N. Borenstein, “Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,” RFC 2045, November 1996 (TXT).</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt id="term-rfc3339">RFC3339</dt>
<dd>Klyne, G., Ed. and C. Newman, “Date and Time on the Internet: Timestamps,” RFC 3339, July 2002 (TXT, HTML, XML).</dd>
<dt id="term-rfc3629">RFC3629</dt>
<dd>Yergeau, F., “UTF-8, a transformation format of ISO 10646,” STD 63, RFC 3629, November 2003 (TXT).</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” STD 66, RFC 3986, January 2005 (TXT, HTML, XML).</dd>
<dt id="term-rfc4627">RFC4627</dt>
<dd>Crockford, D., “The application/json Media Type for JavaScript Object Notation (JSON),” RFC 4627, July 2006 (TXT).</dd>
<dt id="term-rfc4648">RFC4648</dt>
<dd>Josefsson, S., “The Base16, Base32, and Base64 Data Encodings,” RFC 4648, October 2006 (TXT).</dd>
<dt id="term-rfc5226">RFC5226</dt>
<dd>Narten, T. and H. Alvestrand, “Guidelines for Writing an IANA Considerations Section in RFCs,” BCP 26, RFC 5226, May 2008 (TXT).</dd>
<dt id="term-usa15">USA15</dt>
<dd>Davis, M., Whistler, K., and M. Dürst, “Unicode Normalization Forms,” Unicode Standard Annex 15, 09 2009.</dd>
</dl>
<p>(v.06)</p>
</div>
<div class="section" id="informative-references">
<span id="jwt-12-2"></span><h3><a class="toc-backref" href="#id23">12.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-canvasapp">CanvasApp</dt>
<dd>Facebook, “Canvas Applications,” 2010.</dd>
<dt id="term-jss">JSS</dt>
<dd>Bradley, J. and N. Sakimura (editor), “JSON Simple Sign,” September 2010.</dd>
<dt id="term-jwe">JWE</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, “JSON Web Encryption (JWE),” October 2011. (<a class="reference internal" href="jwe.html"><em>JSON Web Encryption (JWE)</em></a>)</dd>
<dt id="term-magicsignatures">MagicSignatures</dt>
<dd>Panzer (editor), J., Laurie, B., and D. Balfanz, “Magic Signatures,” August 2010.</dd>
<dt id="term-oasis-saml-core-2-0-os">OASIS.saml-core-2.0-os</dt>
<dd>Cantor, S., Kemp, J., Philpott, R., and E. Maler, “Assertions and Protocol for the OASIS Security Assertion Markup Language (SAML) V2.0,” OASIS Standard saml-core-2.0-os, March 2005.</dd>
<dt id="term-rfc3275">RFC3275</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, “(Extensible Markup Language) XML-Signature Syntax and Processing,” RFC 3275, March 2002 (TXT).</dd>
<dt id="term-rfc4122">RFC4122</dt>
<dd>Leach, P., Mealling, M., and R. Salz, “A Universally Unique IDentifier (UUID) URN Namespace,” RFC 4122, July 2005 (TXT, HTML, XML).</dd>
<dt id="term-swt">SWT</dt>
<dd>Hardt, D. and Y. Goland, “Simple Web Token (SWT),” Version 0.9.5.1, November 2009.</dd>
<dt id="term-w3c-cr-xml11-20021015">W3C.CR-xml11-20021015</dt>
<dd>Cowan, J., “Extensible Markup Language (XML) 1.1,” W3C CR CR-xml11-20021015, October 2002.</dd>
</dl>
<p>(v.06)</p>
</div>
</div>
<div class="section" id="appendix-a-relationship-of-jwts-to-saml-tokens">
<span id="jwt-appendix-a"></span><h2><a class="toc-backref" href="#id24">Appendix A.  Relationship of JWTs to SAML Tokens</a><a class="headerlink" href="#appendix-a-relationship-of-jwts-to-saml-tokens" title="Permalink to this headline">¶</a></h2>
<p>SAML 2.0 [OASIS.saml‑core‑2.0‑os] provides a standard for creating tokens with much greater expressivity
and more security options than supported by JWTs.</p>
<p>However, the cost of this flexibility and expressiveness is both size and complexity.
In addition,
SAML&#8217;s use of XML [W3C.CR‑xml11‑20021015] and XML DSIG [RFC3275] only contributes to the size of SAML tokens.</p>
<p>JWTs are intended to provide a simple token format
that is small enough to fit into HTTP headers and query arguments in URIs.
It does this by supporting a much simpler token model than SAML and using the JSON [RFC4627] object encoding syntax.
It also supports securing tokens using Hash-based Message Authentication Codes (HMACs)
and digital signatures using a smaller (and less flexible) format than XML DSIG.</p>
<p>Therefore,
while JWTs can do some of the things SAML tokens do,
JWTs are not intended as a full replacement for SAML tokens,
but rather as a compromise token format to be used when space is at a premium.</p>
<p>(v.06)</p>
</div>
<div class="section" id="appendix-b-relationship-of-jwts-to-simple-web-tokens-swts">
<span id="jwt-appendix-b"></span><h2><a class="toc-backref" href="#id25">Appendix B.  Relationship of JWTs to Simple Web Tokens (SWTs)</a><a class="headerlink" href="#appendix-b-relationship-of-jwts-to-simple-web-tokens-swts" title="Permalink to this headline">¶</a></h2>
<p>Both JWTs and Simple Web Tokens SWT [SWT], at their core,
enable sets of claims to be communicated between applications.</p>
<p>For SWTs,
both the claim names and claim values are strings.
For JWTs,
while claim names are strings,
claim values can be any JSON type.</p>
<p>Both token types offer cryptographic protection of their content:
SWTs with HMAC SHA-256 and
JWTs with a choice of algorithms, including HMAC SHA-256, RSA SHA-256, and ECDSA P-256 SHA-256.</p>
<p>(v.06)</p>
</div>
<div class="section" id="appendix-c-acknowledgements">
<span id="jwt-appendix-c"></span><h2><a class="toc-backref" href="#id26">Appendix C.  Acknowledgements</a><a class="headerlink" href="#appendix-c-acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>The authors acknowledge that
the design of JWTs was intentionally influenced by the design and simplicity of Simple Web Tokens [SWT]
and ideas for JSON tokens that Dick Hardt discussed within the OpenID community.</p>
<p>Solutions for signing JSON content were previously explored by Magic Signatures [MagicSignatures],
JSON Simple Sign [JSS], and Canvas Applications [CanvasApp], all of which influenced this draft.</p>
<p>(v.06)</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="uma_trust.html">UMA Trust Model</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jws.html">JSON Web Signature (JWS)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/660be19d7963.
    </div>
  </body>
</html>