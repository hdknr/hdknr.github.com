

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The OAuth 2.0 Protocol: Bearer Tokens &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>The OAuth 2.0 Protocol: Bearer Tokens</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="the-oauth-2-0-protocol-bearer-tokens">
<h1><a class="toc-backref" href="#id1">The OAuth 2.0 Protocol: Bearer Tokens</a><a class="headerlink" href="#the-oauth-2-0-protocol-bearer-tokens" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-15">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-15</a> (v.15)
( December 18, 2011 )</p>
<div class="section" id="abstract">
<span id="bearer-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification describes how to use bearer tokens in HTTP requests
to access OAuth 2.0 protected resources.
Any party in possession of a bearer token (a &#8220;bearer&#8221;) can use it
to get access to the associated resources
(without demonstrating possession of a cryptographic key).
To prevent misuse,
bearer tokens need to be protected from disclosure in storage and in transport.</p>
<p>(v.15)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-oauth-2-0-protocol-bearer-tokens" id="id1">The OAuth 2.0 Protocol: Bearer Tokens</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#authenticated-requests" id="id3">2. Authenticated Requests</a><ul>
<li><a class="reference internal" href="#authorization-request-header-field" id="id4">2.1. Authorization Request Header Field</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-www-authenticate-response-header-field" id="id5">3. The WWW-Authenticate Response Header Field</a><ul>
<li><a class="reference internal" href="#error-codes" id="id6">3.1. Error Codes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="authenticated-requests">
<span id="bearer-2"></span><h2><a class="toc-backref" href="#id3">2. Authenticated Requests</a><a class="headerlink" href="#authenticated-requests" title="Permalink to this headline">¶</a></h2>
<p>This section defines three methods of sending bearer access tokens
in resource requests to resource servers.
Clients MUST NOT use more than one method to transmit the token in each request.</p>
<p>(v.15)</p>
<div class="section" id="authorization-request-header-field">
<span id="bearer-2-1"></span><h3><a class="toc-backref" href="#id4">2.1. Authorization Request Header Field</a><a class="headerlink" href="#authorization-request-header-field" title="Permalink to this headline">¶</a></h3>
<p>When sending the access token in the &#8220;Authorization&#8221; request header field
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth],
the client uses the &#8220;Bearer&#8221; authentication scheme to transmit the access token.</p>
<p>For example:</p>
<div class="highlight-python"><pre>GET /resource HTTP/1.1
Host: server.example.com
Authorization: Bearer vF9dft4qmT</pre>
</div>
<p>The &#8220;Authorization&#8221; header field uses the framework
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth] as follows:</p>
<div class="highlight-python"><pre>credentials = "Bearer" 1*SP b64token</pre>
</div>
<p>The b64token syntax was chosen over the alternative #auth-param syntax
also defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth]
both for simplicity and for compatibility with existing implementations.
If additional parameters are needed in the future,
a different scheme would need to be defined.</p>
<p>Clients SHOULD make authenticated requests
with a bearer token using the &#8220;Authorization&#8221; request header field
with the &#8220;Bearer&#8221; HTTP authorization scheme.
Resource servers MUST support this method.</p>
<p>(v.15)</p>
</div>
</div>
<div class="section" id="the-www-authenticate-response-header-field">
<span id="bearer-3"></span><h2><a class="toc-backref" href="#id5">3. The WWW-Authenticate Response Header Field</a><a class="headerlink" href="#the-www-authenticate-response-header-field" title="Permalink to this headline">¶</a></h2>
<p>If the protected resource request does not include authentication credentials
or does not contain an access token that enables access to the protected resource,
the resource server MUST include the HTTP &#8220;WWW-Authenticate&#8221; response header field;
it MAY include it in response to other conditions as well.
The &#8220;WWW-Authenticate&#8221; header field uses the framework
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth] as follows:</p>
<div class="highlight-python"><pre>challenge       = "Bearer" [ 1*SP 1#param ]

param           = realm / scope /
                  error / error-desc / error-uri /
                  auth-param

scope           = "scope" "=" quoted-string
error           = "error" "=" quoted-string
error-desc      = "error_description" "=" quoted-string
error-uri       = "error_uri" "=" quoted-string</pre>
</div>
<p>A &#8220;realm&#8221; attribute MAY be included to indicate the scope of protection
in the manner described in HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth].
The &#8220;realm&#8221; attribute MUST NOT appear more than once.
The &#8220;realm&#8221; value is intended for programmatic use
and is not meant to be displayed to end users.</p>
<p>The &#8220;scope&#8221; attribute is a space-delimited list of scope values
indicating the required scope of the access token
for accessing the requested resource.
In some cases,
the &#8220;scope&#8221; value will be used
when requesting a new access token with sufficient scope of access
to utilize the protected resource.
The &#8220;scope&#8221; attribute MUST NOT appear more than once.
The &#8220;scope&#8221; value is intended for programmatic use
and is not meant to be displayed to end users.</p>
<p>If the protected resource request included an access token
and failed authentication,
the resource server SHOULD include the &#8220;error&#8221; attribute
to provide the client with the reason why the access request was declined.
The parameter value is described in <a class="reference internal" href="#bearer-3-1"><em>Section 3.1</em></a>.
In addition,
the resource server MAY include the &#8220;error_description&#8221; attribute
to provide developers a human-readable explanation
that is not meant to be displayed to end users.
It also MAY include the &#8220;error_uri&#8221; attribute
with an absolute URI identifying a human-readable web page explaining the error.
The &#8220;error&#8221;, &#8220;error_description&#8221;, and &#8220;error_uri&#8221; attributes MUST NOT appear more than once.</p>
<p>Producers of &#8220;scope&#8221; strings MUST NOT use characters
outside the set %x21 / %x23-5B / %x5D-7E for representing the scope values
and %x20 for the delimiter.
Producers of &#8220;error&#8221; and &#8220;error_description&#8221; strings MUST NOT use characters
outside the set %x20-21 / %x23-5B / %x5D-7E for representing these values.
Producers of &#8220;error-uri&#8221; strings MUST NOT use characters
outside the set %x21 / %x23-5B / %x5D-7E for representing these values.
Furthermore, &#8220;error-uri&#8221; strings MUST conform to the URI-Reference syntax.
In all these cases,
no character quoting will occur, as senders are prohibited from using the %5C (&#8216;&#8217;) character.</p>
<p>For example,
in response to a protected resource request without authentication:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"</pre>
</div>
<p>And in response to a protected resource request with an authentication attempt
using an expired access token:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example",
                  error="invalid_token",
                  error_description="The access token expired"</pre>
</div>
<p>(v.15)</p>
<div class="section" id="error-codes">
<span id="bearer-3-1"></span><h3><a class="toc-backref" href="#id6">3.1. Error Codes</a><a class="headerlink" href="#error-codes" title="Permalink to this headline">¶</a></h3>
<p>When a request fails,
the resource server responds using the appropriate HTTP status code
(typically, 400, 401, 403, or 405),
and includes one of the following error codes in the response:</p>
<dl class="glossary docutils">
<dt id="term-invalid-request">invalid_request</dt>
<dd>The request is missing a required parameter, includes an
unsupported parameter or parameter value, repeats the same
parameter, uses more than one method for including an access
token, or is otherwise malformed.  The resource server SHOULD
respond with the HTTP 400 (Bad Request) status code.</dd>
<dt id="term-invalid-token">invalid_token</dt>
<dd>The access token provided is expired, revoked, malformed, or
invalid for other reasons.  The resource SHOULD respond with
the HTTP 401 (Unauthorized) status code.  The client MAY
request a new access token and retry the protected resource
request.</dd>
<dt id="term-insufficient-scope">insufficient_scope</dt>
<dd>The request requires higher privileges than provided by the
access token.  The resource server SHOULD respond with the HTTP
403 (Forbidden) status code and MAY include the &#8220;scope&#8221;
attribute with the scope necessary to access the protected
resource.</dd>
</dl>
<p>If the request lacks any authentication information
(i.e. the client was unaware,authentication is necessary
or attempted using an unsupported authentication method),
the resource server SHOULD NOT include an error code or other error information.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"</pre>
</div>
<p>(v.15)</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>