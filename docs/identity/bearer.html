
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The OAuth 2.0 Protocol: Bearer Tokens &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft21</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft19</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft25</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft24</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">The OAuth 2.0 Protocol: Bearer Tokens</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#authenticated-requests">2. Authenticated Requests</a><ul>
<li><a class="reference internal" href="#authorization-request-header-field">2.1. Authorization Request Header Field</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-www-authenticate-response-header-field">3. The WWW-Authenticate Response Header Field</a><ul>
<li><a class="reference internal" href="#error-codes">3.1. Error Codes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/bearer.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="the-oauth-2-0-protocol-bearer-tokens">
<h1><a class="toc-backref" href="#id1">The OAuth 2.0 Protocol: Bearer Tokens</a><a class="headerlink" href="#the-oauth-2-0-protocol-bearer-tokens" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-15">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-15</a> (v.15)
( December 18, 2011 )</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">June 19, 2012, Draft 21 is the latest
( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-21">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-21</a> )</p>
</div>
<div class="section" id="abstract">
<span id="bearer-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification describes how to use bearer tokens in HTTP requests
to access OAuth 2.0 protected resources.
Any party in possession of a bearer token (a &#8220;bearer&#8221;) can use it
to get access to the associated resources
(without demonstrating possession of a cryptographic key).
To prevent misuse,
bearer tokens need to be protected from disclosure in storage and in transport.</p>
<p>(v.15)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-oauth-2-0-protocol-bearer-tokens" id="id1">The OAuth 2.0 Protocol: Bearer Tokens</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#authenticated-requests" id="id3">2. Authenticated Requests</a><ul>
<li><a class="reference internal" href="#authorization-request-header-field" id="id4">2.1. Authorization Request Header Field</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-www-authenticate-response-header-field" id="id5">3. The WWW-Authenticate Response Header Field</a><ul>
<li><a class="reference internal" href="#error-codes" id="id6">3.1. Error Codes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="authenticated-requests">
<span id="bearer-2"></span><h2><a class="toc-backref" href="#id3">2. Authenticated Requests</a><a class="headerlink" href="#authenticated-requests" title="Permalink to this headline">¶</a></h2>
<p>This section defines three methods of sending bearer access tokens
in resource requests to resource servers.
Clients MUST NOT use more than one method to transmit the token in each request.</p>
<p>(v.15)</p>
<div class="section" id="authorization-request-header-field">
<span id="bearer-2-1"></span><h3><a class="toc-backref" href="#id4">2.1. Authorization Request Header Field</a><a class="headerlink" href="#authorization-request-header-field" title="Permalink to this headline">¶</a></h3>
<p>When sending the access token in the &#8220;Authorization&#8221; request header field
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth],
the client uses the &#8220;Bearer&#8221; authentication scheme to transmit the access token.</p>
<p>For example:</p>
<div class="highlight-python"><pre>GET /resource HTTP/1.1
Host: server.example.com
Authorization: Bearer vF9dft4qmT</pre>
</div>
<p>The &#8220;Authorization&#8221; header field uses the framework
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth] as follows:</p>
<div class="highlight-python"><pre>credentials = "Bearer" 1*SP b64token</pre>
</div>
<p>The b64token syntax was chosen over the alternative #auth-param syntax
also defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth]
both for simplicity and for compatibility with existing implementations.
If additional parameters are needed in the future,
a different scheme would need to be defined.</p>
<p>Clients SHOULD make authenticated requests
with a bearer token using the &#8220;Authorization&#8221; request header field
with the &#8220;Bearer&#8221; HTTP authorization scheme.
Resource servers MUST support this method.</p>
<p>(v.15)</p>
</div>
</div>
<div class="section" id="the-www-authenticate-response-header-field">
<span id="bearer-3"></span><h2><a class="toc-backref" href="#id5">3. The WWW-Authenticate Response Header Field</a><a class="headerlink" href="#the-www-authenticate-response-header-field" title="Permalink to this headline">¶</a></h2>
<p>If the protected resource request does not include authentication credentials
or does not contain an access token that enables access to the protected resource,
the resource server MUST include the HTTP &#8220;WWW-Authenticate&#8221; response header field;
it MAY include it in response to other conditions as well.
The &#8220;WWW-Authenticate&#8221; header field uses the framework
defined by HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth] as follows:</p>
<div class="highlight-python"><pre>challenge       = "Bearer" [ 1*SP 1#param ]

param           = realm / scope /
                  error / error-desc / error-uri /
                  auth-param

scope           = "scope" "=" quoted-string
error           = "error" "=" quoted-string
error-desc      = "error_description" "=" quoted-string
error-uri       = "error_uri" "=" quoted-string</pre>
</div>
<p>A &#8220;realm&#8221; attribute MAY be included to indicate the scope of protection
in the manner described in HTTP/1.1, Part 7 [I-D.ietf-httpbis-p7-auth].
The &#8220;realm&#8221; attribute MUST NOT appear more than once.
The &#8220;realm&#8221; value is intended for programmatic use
and is not meant to be displayed to end users.</p>
<p>The &#8220;scope&#8221; attribute is a space-delimited list of scope values
indicating the required scope of the access token
for accessing the requested resource.
In some cases,
the &#8220;scope&#8221; value will be used
when requesting a new access token with sufficient scope of access
to utilize the protected resource.
The &#8220;scope&#8221; attribute MUST NOT appear more than once.
The &#8220;scope&#8221; value is intended for programmatic use
and is not meant to be displayed to end users.</p>
<p>If the protected resource request included an access token
and failed authentication,
the resource server SHOULD include the &#8220;error&#8221; attribute
to provide the client with the reason why the access request was declined.
The parameter value is described in <a class="reference internal" href="#bearer-3-1"><em>Section 3.1</em></a>.
In addition,
the resource server MAY include the &#8220;error_description&#8221; attribute
to provide developers a human-readable explanation
that is not meant to be displayed to end users.
It also MAY include the &#8220;error_uri&#8221; attribute
with an absolute URI identifying a human-readable web page explaining the error.
The &#8220;error&#8221;, &#8220;error_description&#8221;, and &#8220;error_uri&#8221; attributes MUST NOT appear more than once.</p>
<p>Producers of &#8220;scope&#8221; strings MUST NOT use characters
outside the set %x21 / %x23-5B / %x5D-7E for representing the scope values
and %x20 for the delimiter.
Producers of &#8220;error&#8221; and &#8220;error_description&#8221; strings MUST NOT use characters
outside the set %x20-21 / %x23-5B / %x5D-7E for representing these values.
Producers of &#8220;error-uri&#8221; strings MUST NOT use characters
outside the set %x21 / %x23-5B / %x5D-7E for representing these values.
Furthermore, &#8220;error-uri&#8221; strings MUST conform to the URI-Reference syntax.
In all these cases,
no character quoting will occur, as senders are prohibited from using the %5C (&#8216;&#8217;) character.</p>
<p>For example,
in response to a protected resource request without authentication:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"</pre>
</div>
<p>And in response to a protected resource request with an authentication attempt
using an expired access token:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example",
                  error="invalid_token",
                  error_description="The access token expired"</pre>
</div>
<p>(v.15)</p>
<div class="section" id="error-codes">
<span id="bearer-3-1"></span><h3><a class="toc-backref" href="#id6">3.1. Error Codes</a><a class="headerlink" href="#error-codes" title="Permalink to this headline">¶</a></h3>
<p>When a request fails,
the resource server responds using the appropriate HTTP status code
(typically, 400, 401, 403, or 405),
and includes one of the following error codes in the response:</p>
<dl class="glossary docutils">
<dt id="term-invalid-request">invalid_request</dt>
<dd>The request is missing a required parameter, includes an
unsupported parameter or parameter value, repeats the same
parameter, uses more than one method for including an access
token, or is otherwise malformed.  The resource server SHOULD
respond with the HTTP 400 (Bad Request) status code.</dd>
<dt id="term-invalid-token">invalid_token</dt>
<dd>The access token provided is expired, revoked, malformed, or
invalid for other reasons.  The resource SHOULD respond with
the HTTP 401 (Unauthorized) status code.  The client MAY
request a new access token and retry the protected resource
request.</dd>
<dt id="term-insufficient-scope">insufficient_scope</dt>
<dd>The request requires higher privileges than provided by the
access token.  The resource server SHOULD respond with the HTTP
403 (Forbidden) status code and MAY include the &#8220;scope&#8221;
attribute with the scope necessary to access the protected
resource.</dd>
</dl>
<p>If the request lacks any authentication information
(i.e. the client was unaware,authentication is necessary
or attempted using an unsupported authentication method),
the resource server <strong>SHOULD NOT</strong> include an error code or other error information.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"</pre>
</div>
<p>(v.21)</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>