

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>13.4. Post Messages &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/print.css" type="text/css" />
    <link rel="stylesheet" href="../static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>13.4. Post Messages</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="post-messages">
<h1>13.4.  Post Messages<a class="headerlink" href="#post-messages" title="Permalink to this headline">¶</a></h1>
<p>Publish messages to the Backplane.</p>
<blockquote>
<div><dl class="docutils">
<dt>Endpoint</dt>
<dd>/v2/messages</dd>
<dt>HTTP mehod</dt>
<dd>POST</dd>
<dt>Security</dt>
<dd>HTTPS</dd>
<dt>Authorization</dt>
<dd><p class="first">The client MUST present the access token
obtained from a Access Token Request (Access Token Request)
as described in section 2.1
(Jones, M., Hardt, D., and D. Recordon, “The OAuth 2.0 Protocol: Bearer Tokens,” Jun 2011.)
[OAuth2.token.bearer].</p>
<p class="last">The server MUST retrieve the Access Scopes (Access Scopes)
associated with the presented access token
and determine that it has Privileged Access Level (Privileged Access)
for each of the Buses referenced in the request body.</p>
</dd>
<dt>Request body</dt>
<dd><p class="first">The body of the request is a JSON object of the following structure:</p>
<blockquote class="last">
<div><ul>
<li><p class="first">messages[]: an array of messages to be posted, represented as JSON objects of the following structure:</p>
<blockquote>
<div><ul class="simple">
<li>source (string): an arbitrary URL identifying the client which has posted the message</li>
<li>type (string): message type (arbitrary string)</li>
<li>bus (string): the name of the bus to post the message to</li>
<li>channel (string): the name of the channel to post the message to</li>
<li>payload (object): the message payload</li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>Returns</p>
<blockquote>
<div><ul class="simple">
<li>HTTP status code 201 (&#8220;Created&#8221;) upon success.</li>
<li>HTTP status code 403 (&#8220;Forbidden&#8221;)
if the client is not authorized to post messages
to any of the referenced Buses.
The server processes the messages in the request one by one;
if a message can&#8217;t be posted for any reason,
the whole request fails and none of the messages get posted.</li>
</ul>
</div></blockquote>
</div></blockquote>
<p>The server MUST check that the <a class="reference internal" href="2.html#term-channel"><em class="xref std std-term">channel</em></a> in a message was previously allocated
as a result of a <a class="reference internal" href="../backplane.html#backplane-13-1"><em>Access Token Request (Access Token Request)</em></a>.</p>
<p>If the channel is not yet bound to a <a class="reference internal" href="2.html#term-bus"><em class="xref std std-term">bus</em></a>,
the server MUST bind it to the <a class="reference internal" href="2.html#term-bus"><em class="xref std std-term">bus</em></a> specified
in the same message object from the request.</p>
<p>If the channel is already bound to a different <a class="reference internal" href="2.html#term-bus"><em class="xref std std-term">bus</em></a>
than the one specified in the same message object in the request,
the entire request is considered invalid and is aborted.</p>
<p>Request example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;messages&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;source&quot;</span><span class="o">:</span> <span class="s2">&quot;http://aboutecho.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;identity/ack&quot;</span>
      <span class="s2">&quot;bus&quot;</span><span class="o">:</span> <span class="s2">&quot;customer.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;channel&quot;</span><span class="o">:</span> <span class="s2">&quot;67dc880cc265b0dbc755ea959b257118&quot;</span><span class="p">,</span>
      <span class="s2">&quot;payload&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="s2">&quot;administrator&quot;</span>
      <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="s2">&quot;source&quot;</span><span class="o">:</span> <span class="s2">&quot;http://aboutecho.com&quot;</span><span class="p">,</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;identity/ack&quot;</span>
      <span class="s2">&quot;bus&quot;</span><span class="o">:</span> <span class="s2">&quot;organization.org&quot;</span><span class="p">,</span>
      <span class="s2">&quot;channel&quot;</span><span class="o">:</span> <span class="s2">&quot;d7a592b31fbbc2baf5f9476884b9acd5&quot;</span><span class="p">,</span>
      <span class="s2">&quot;payload&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;role&quot;</span><span class="o">:</span> <span class="s2">&quot;moderator&quot;</span>
      <span class="p">},</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>(draft 08)</p>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>