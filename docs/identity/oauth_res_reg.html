

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OAuth 2.0 Resource Set Registration &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth Resoure" href="oauth_res.html" />
    <link rel="prev" title="JSON Metadata for OAuth Responses" href="oauth_meta.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>OAuth 2.0 Resource Set Registration</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth_meta.html">JSON Metadata for OAuth Responses</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_res.html">OAuth Resoure</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="oauth-2-0-resource-set-registration">
<h1>OAuth 2.0 Resource Set Registration<a class="headerlink" href="#oauth-2-0-resource-set-registration" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00</a></li>
</ul>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id2">1. Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions" id="id3">1.1. Notational Conventions</a></li>
<li><a class="reference internal" href="#terminology" id="id4">1.2. Terminology</a></li>
<li><a class="reference internal" href="#authorization-server-configuration-data" id="id5">1.3. Authorization Server Configuration Data</a></li>
</ul>
</li>
<li><a class="reference internal" href="#resource-set-registration" id="id6">2. Resource Set Registration</a><ul>
<li><a class="reference internal" href="#scope-type-descriptions" id="id7">2.1. Scope Type Descriptions</a></li>
<li><a class="reference internal" href="#resource-set-descriptions" id="id8">2.2. Resource Set Descriptions</a></li>
<li><a class="reference internal" href="#resource-set-registration-api" id="id9">2.3. Resource Set Registration API</a><ul>
<li><a class="reference internal" href="#create-resource-set-description" id="id10">2.3.1. Create Resource Set Description</a></li>
<li><a class="reference internal" href="#read-resource-set-description" id="id11">2.3.2. Read Resource Set Description</a></li>
<li><a class="reference internal" href="#update-resource-set-description" id="id12">2.3.3. Update Resource Set Description</a></li>
<li><a class="reference internal" href="#delete-resource-set-description" id="id13">2.3.4. Delete Resource Set Description</a></li>
<li><a class="reference internal" href="#list-resource-set-descriptions" id="id14">2.3.5. List Resource Set Descriptions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#error-messages" id="id15">3. Error Messages</a></li>
<li><a class="reference internal" href="#security-considerations" id="id16">4. Security Considerations</a></li>
<li><a class="reference internal" href="#privacy-considerations" id="id17">5. Privacy Considerations</a></li>
<li><a class="reference internal" href="#conformance" id="id18">6. Conformance</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id19">7. IANA Considerations</a></li>
<li><a class="reference internal" href="#example-of-registering-resource-sets" id="id20">8. Example of Registering Resource Sets</a></li>
<li><a class="reference internal" href="#references" id="id21">11. References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id22">11.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id23">11.2. Informative References</a></li>
</ul>
</li>
</ul>
</div>
<table class="docutils field-list" frame="void" id="oauth-res-reg-abstract" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="abstract">
<h2><a class="toc-backref" href="#id1">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification defines a resource set registration mechanism
between an OAuth 2.0 authorization server and resource server.</p>
<p>The resource server registers information about the semantics and
discovery properties of its resources with the authorization server.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-1" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>There are various circumstances under which an OAuth 2.0 <a class="reference internal" href="#term-oauth2"><em class="xref std std-term">[OAuth2]</em></a>
resource server needs to communicate to its authorization server
information about its protected resources.
A resource server and authorization server may need to communicate
with each other about resources in one of several circumstances:</p>
<blockquote>
<div><ul>
<li><p class="first">In some OAuth 2.0 deployments, the resource server and
authorization server are operated by the same organization and
deployed in the same domain,
but many resource servers share a single authorization server
(a security token service (STS) component).</p>
<p>Thus, even though the trust between these two is
typically tightly bound,
there is value in defining a singular standardized resource protection communications interface
between the authorization server and each of the resource servers.</p>
</li>
<li><p class="first">In some deployments of OpenID Connect, which has a dependency on OAuth 2.0,
the OpenID Provider (OP) component is a specialized version of an OAuth authorization server
that brokers availability of user attributes by dealing
with with an ecosystem of attribute providers (APs).</p>
<p>These APs effectively function as third-party resource servers.
Thus, there is value in defining a mechanism by
which all of the third-party APs can communicate with a central OP,
as well as ensuring that trust between the authorization server
and resource servers is able to be established in a dynamic, loosely coupled fashion.</p>
</li>
<li><p class="first">In some deployments of User-Managed Access (UMA),
which has a dependency on OAuth 2.0,
an end-user resource owner (the &#8220;user&#8221; in UMA)
may choose their own authorization server as an independent &#8220;CloudOS&#8221; authorization service,
along with using any number of resource servers that make up their &#8220;personal cloud&#8221;.</p>
<p>Thus, there is value in defining a mechanism by which all of the third-party
resource servers can outsource resource protection
(and potentially discovery) to a central authorization server,
as well as ensuring that trust between the authorization server and
resource servers is able to be established by the resource owner
in a dynamic, loosely coupled fashion.</p>
</li>
</ul>
</div></blockquote>
<p>This specification defines an API through which the resource server
can register information about resource sets with the authorization server.</p>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-1-1" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orpahn:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="notational-conventions">
<h3><a class="toc-backref" href="#id3">1.1. Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8216;MUST&#8217;, &#8216;MUST NOT&#8217;, &#8216;REQUIRED&#8217;, &#8216;SHALL&#8217;, &#8216;SHALL NOT&#8217;,
&#8216;SHOULD&#8217;, &#8216;SHOULD NOT&#8217;, &#8216;RECOMMENDED&#8217;, &#8216;MAY&#8217;, and &#8216;OPTIONAL&#8217; in this
document are to be interpreted as described in [RFC2119].</p>
<p>Unless otherwise noted, all the protocol properties and values are
case sensitive.</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-1-2" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="terminology">
<h3><a class="toc-backref" href="#id4">1.2. Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>This specification introduces the following new terms and
enhancements of OAuth term definitions.</p>
<dl class="glossary docutils">
<dt id="term-resource-set">resource set</dt>
<dd>One or more resources that the resource server manages as a set.</dd>
<dt id="term-scope-type">scope type</dt>
<dd><p class="first">A bounded extent of access that is possible to perform on a resource set.
In authorization policy terminology,
a scope type is one of the potentially many &#8220;<strong>verbs</strong>&#8221;
that can logically apply to a resource set (&#8220;<strong>object</strong>&#8221;).</p>
<p>This specification extends the OAuth concept of a &#8220;scope&#8221;
by defining scope types as applying to particular labeled resource sets,
rather than leaving the relevant resources
(such as API endpoints or URIs) implicit.</p>
<p>A resource set can have any number of scope types,
which together describe the universe of actions that <strong>can be</strong>
taken on this protected resource set.</p>
<p>For example,
a resource set representing a status update API might have scope types
that include adding an update or reading updates.
A resource set representing a photo album might have scope types that
include viewing a slideshow or printing the album.</p>
<p class="last">The resource server registers resource sets and their scope types
when there is not yet any particular client in the picture.</p>
</dd>
<dt id="term-resource-set-registration-endpoint">resource set registration endpoint</dt>
<dd><p class="first">The endpoint at which the resource server registers resource sets
it wants the authorization server to know about.</p>
<p class="last">The operations available at this endpoint constitute
a resource set registration API
(see <em class="xref std std-ref">Section 2.3</em>).</p>
</dd>
</dl>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1.2">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1.2</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-1-3" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="authorization-server-configuration-data">
<h3><a class="toc-backref" href="#id5">1.3. Authorization Server Configuration Data</a><a class="headerlink" href="#authorization-server-configuration-data" title="Permalink to this headline">¶</a></h3>
<p>If the authorization server declares its endpoints
and any other configuration data in a machine-readable form,
for example <a class="reference internal" href="#term-oauth-linktypes"><em class="xref std std-term">[OAuth-linktypes]</em></a>,
it SHOULD convey its resource set registration endpoint in this fashion as well.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1.3">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-1.3</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="resource-set-registration">
<h2><a class="toc-backref" href="#id6">2. Resource Set Registration</a><a class="headerlink" href="#resource-set-registration" title="Permalink to this headline">¶</a></h2>
<p>This specification defines a <em class="xref std std-term">resource set registration API</em>.
If this API is not open, it MUST be <strong>OAuth-protected</strong>.</p>
<p>For any of the resource owner&#8217;s sets of resources
this authorization server needs to be aware of,
the resource server MUST register these resource sets
at the authorization server&#8217;s registration endpoint.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-1" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="scope-type-descriptions">
<h3><a class="toc-backref" href="#id7">2.1. Scope Type Descriptions</a><a class="headerlink" href="#scope-type-descriptions" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="#term-scope-type"><em class="xref std std-term">scope type</em></a> is a <strong>bounded extent of access</strong>
that is possible to perform on a <a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a>.
A scope type description is a JSON document with the following properties:</p>
<dl class="glossary docutils">
<dt id="term-name">name</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">A human-readable string describing some scope
(extent) of access.  This name is intended for ultimate use in the
authorization server&#8217;s user interface to assist the user in
setting policies for protected resource sets that have this
available scope.</p>
</dd>
<dt id="term-icon-uri">icon_uri</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">A URI for a graphic icon representing the scope.
The referenced icon is intended for ultimate use in the
authorization server&#8217;s user interface to assist the user in
setting policies for protected resource sets that have this
available scope.</p>
</dd>
</dl>
<p>For example,
this description characterizes a scope type that
involves reading or viewing resources
(vs. creating them or editing them in some fashion):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;View&quot;</span><span class="p">,</span>
  <span class="s2">&quot;icon_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/icons/reading-glasses&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Scope type descriptions MAY contain extension properties
that are not defined in this specification.
Extension names that are unprotected from collisions are
outside the scope of the current specification.</p>
<p>A resource server MUST list a resource set&#8217;s available scopes
using URI references (as defined in <em class="xref std std-ref">Section 2.2</em>).</p>
<p>The scope types available for use at any one resource server MUST have
unique URI references so that
the resource server&#8217;s scope descriptions are uniquely distinguishable.</p>
<p>A scope type URI reference MAY include a fragment identifier.
Scope type descriptions MAY reside anywhere.
The resource server is not required to self-host scope type descriptions
and may wish to point to standardized scope type descriptions residing elsewhere.
Scope type description documents MUST be accessible to authorization servers
through GET calls made to these URI references.</p>
<p>See <a class="reference internal" href="#oauth-res-reg-8"><em>Section 8</em></a> for a long-form example of scope types used
in resource set registration.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.1">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.1</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-2" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resource-set-descriptions">
<h3><a class="toc-backref" href="#id8">2.2. Resource Set Descriptions</a><a class="headerlink" href="#resource-set-descriptions" title="Permalink to this headline">¶</a></h3>
<p>The resource server defines a resource set that
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> needs to be aware of
by registering a <a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a> description at the authorization server.</p>
<p>A resource set description is a JSON document with the following properties:</p>
<dl class="glossary docutils">
<dt id="term-5">name</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">A human-readable string describing a set of one or more resources.
The authorization server SHOULD use the name in
its user interface to assist the user in setting policies for
protecting this resource set.</p>
</dd>
<dt id="term-6">icon_uri</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">A URI for a graphic icon representing the resource set.</p>
</dd>
<dt id="term-scopes">scopes</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">An array providing the URI references of <a class="reference internal" href="#term-scope-type"><em class="xref std std-term">scope type</em></a> descriptions
that are available for this resource set.</p>
</dd>
<dt id="term-type">type</dt>
<dd><p class="first">OPTIONAL.</p>
<p>A string uniquely identifying the semantics of the
<a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a>.</p>
<p class="last">For example,
if the resource set consists of a single resource that is an identity claim
that leverages standardized claim semantics,
the value of this property could be an identifying URI for this claim.</p>
</dd>
</dl>
<p>For example,
this description characterizes a resource set (a photo album)
that can potentially be only viewed,
or alternatively to which full access can be granted;
the URIs point to scope descriptions as defined in <a class="reference internal" href="#oauth-res-reg-2-1"><em>Section 2.1</em></a>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Photo Album&quot;</span><span class="p">,</span>
  <span class="s2">&quot;icon_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/icons/flower.png&quot;</span><span class="p">,</span>
  <span class="s2">&quot;scopes&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;http://photoz.example.com/dev/scopes/view&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://photoz.example.com/dev/scopes/all&quot;</span>
  <span class="p">],</span>
  <span class="s2">&quot;resource_set_type&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/rsets/photoalbum&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Resource set descriptions MAY contain extension properties that are
not defined in this specification.
Extension names that are unprotected from collisions are
outside the scope of the current specification.</p>
<p>When a resource server creates or updates a <a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a> description
(see <a class="reference internal" href="#oauth-res-reg-2-3"><em>Section 2.3</em></a>),
the authorization server MUST attempt to retrieve the referenced scope descriptions
so that it can present fresh data in resource owner interactions.</p>
<p>(draft 00 ,  <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.2">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.2</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="resource-set-registration-api">
<h3><a class="toc-backref" href="#id9">2.3. Resource Set Registration API</a><a class="headerlink" href="#resource-set-registration-api" title="Permalink to this headline">¶</a></h3>
<p>The resource server uses the RESTful API at the authorization server&#8217;s
<a class="reference internal" href="#term-resource-set-registration-endpoint"><em class="xref std std-term">resource set registration endpoint</em></a>
to create, read, update, and delete <em class="xref std std-term">resource set descriptions</em>,
along with listing groups of such descriptions.
The <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a> is free to use its own methods of
identifying and describing <a class="reference internal" href="uma_core.html#term-resource-sets"><em class="xref std std-term">resource sets</em></a>.</p>
<p>(Note carefully the similar but distinct senses in which the word
&#8220;resource&#8221; is used in this section.  The resource set descriptions
are themselves managed as web resources at the authorization server
through this API.)</p>
<p>The authorization server MUST present an API
for registering <em class="xref std std-term">resource set descriptions</em> at a set of URIs
with the structure &#8220;{rsreguri}/resource_set/{rsid}&#8221;,
where the PAT provides sufficient context to distinguish
between identical resource set identifiers assigned by different hosts.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>PAT (Protection API Token) は定義されていない。</li>
<li>RAT (Resource Set Registration API Token)なんじゃないの？</li>
</ul>
</div>
<p>The components of these URIs are defined as follows:</p>
<dl class="glossary docutils">
<dt id="term-rsreguri">{rsreguri}</dt>
<dd>The authorization server&#8217;s resource set registration
endpoint as advertised in its configuration data
(see <em class="xref std std-ref">Section 1.3</em>).</dd>
<dt id="term-rsid">{rsid}</dt>
<dd>An identifier for a resource set description.</dd>
</dl>
<p>Without a specific resource set identifier path component,
the URI applies to the set of resource set descriptions already registered.</p>
<p>Following is a summary of the five registration operations the
authorization server is REQUIRED to support.
Each is defined in its own section below.
All other methods are unsupported.</p>
<p>This API uses <em class="xref std std-term">ETag</em> and <em class="xref std std-term">If-Match</em>
to ensure the desired resource at the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> is targeted.</p>
<blockquote>
<div><ul class="simple">
<li>Create resource set description: PUT /resource_set/{rsid}</li>
<li>Read resource set description: GET /resource_set/{rsid}</li>
<li>Update resource set description: PUT /resource_set/{rsid} with If-Match</li>
<li>Delete resource set description: DELETE /resource_set/{rsid}</li>
<li>List resource set descriptions: GET /resource_set/ with If-Match</li>
</ul>
</div></blockquote>
<p>If the request to the resource set registration endpoint is incorrect,
then the authorization server responds with an error message
by including one of the following error codes with the response:</p>
<dl class="glossary docutils">
<dt id="term-unsupported-method-type">unsupported_method_type</dt>
<dd>The resource server request used an
unsupported HTTP method.  The authorization server MUST respond
with the HTTP 405 (Method Not Allowed) status code and MUST fail
to act on the request.</dd>
<dt id="term-not-found">not_found</dt>
<dd>The resource set requested from the authorization server
cannot be found.  The authorization server MUST respond with HTTP
404 (Not Found) status code.</dd>
<dt id="term-precondition-failed">precondition_failed</dt>
<dd>The resource set that was requested to be
deleted or updated at the authorization server did not match the
If-Match value present in the request.  The authorization server
MUST respond with HTTP 412 (Precondition Failed) status code and
MUST fail to act on the request.</dd>
</dl>
<p>( draft 00 ,http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3 )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3-1" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="create-resource-set-description">
<h4><a class="toc-backref" href="#id10">2.3.1. Create Resource Set Description</a><a class="headerlink" href="#create-resource-set-description" title="Permalink to this headline">¶</a></h4>
<p>Adds a new resource set description using the PUT method,
thereby putting it under the authorization server&#8217;s protection.
If the request is successful,
the authorization server MUST respond with a status message
that includes an ETag header and _id and _rev properties
for managing resource set description versioning.</p>
<p>Form of a &#8220;create resource set description&#8221; HTTP request:</p>
<div class="highlight-python"><pre>PUT /resource_set/{rsid} HTTP/1.1
Content-Type: application/intro-resource-set+json
...

(body contains JSON resource set description to be created)</pre>
</div>
<p>Form of a successful HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 201 Created
Content-Type: application/intro-status+json
ETag: (matches "_rev" property in returned object)
...

{
  "status": "created",
  "_id": (id of created resource set),
  "_rev": (ETag of created resource set)
}</pre>
</div>
<p>On successful registration,
the authorization server MAY return a redirect <em class="xref std std-term">policy URI</em> to the resource server
in a property with the name &#8220;<em class="xref std std-term">policy_uri</em>&#8221;.</p>
<p>This URI allows the resource server to redirect the user
to a specific user interface
within the authorization server
where the user can immediately set or modify access policies
for the resource set that was just registered.</p>
<p>Form of a successful HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 201 Created
Content-Type: application/intro-status+json
ETag: (matches "_rev" property in returned object)
...

{
  "status": "created",
  "_id": (id of created resource set),
  "_rev": (ETag of created resource set)
  "policy_uri":"http://as.example.com/rs/222/resource/333/policy"
}</pre>
</div>
<p>(draft 00 , <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.1">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.1</a>  )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3-2" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="read-resource-set-description">
<h4><a class="toc-backref" href="#id11">2.3.2. Read Resource Set Description</a><a class="headerlink" href="#read-resource-set-description" title="Permalink to this headline">¶</a></h4>
<p>Reads a previously registered resource set description
using the GET method.
If the request is successful,
the authorization server MUST respond with a status message
that includes an ETag header and _id and _rev properties
for managing resource set description versioning.</p>
<p>Form of a &#8220;read resource set description&#8221; HTTP request:</p>
<div class="highlight-python"><pre>GET /resource_set/{rsid} HTTP/1.1
...</pre>
</div>
<p>Form of a successful HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/intro-resource-set+json
...

(body contains JSON resource set description, including _id and _rev)</pre>
</div>
<p>If the referenced resource does not exist,
the authorization server MUST produce an error response
with an error property value of &#8220;not_found&#8221;, as defined in Section 2.3.</p>
<p>On successful read,
the authorization server MAY return a redirect
policy URI to the resource server in a property with the name
&#8220;policy_uri&#8221;.  This URI allows the resource server to redirect the
user to a specific user interface within the authorization server
where the user can immediately set or modify access policies for the
resource set that was read.</p>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.2">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.2</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3-3" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="update-resource-set-description">
<h4><a class="toc-backref" href="#id12">2.3.3. Update Resource Set Description</a><a class="headerlink" href="#update-resource-set-description" title="Permalink to this headline">¶</a></h4>
<p>Updates a previously registered resource set description using the
PUT method, thereby changing the resource set&#8217;s protection
characteristics.  If the request is successful, the authorization
server MUST respond with a status message that includes an ETag
header and _id and _rev properties for managing resource set
description versioning.</p>
<p>Form of an &#8220;update resource set description&#8221; HTTfP request:</p>
<div class="highlight-python"><pre>PUT /resource_set/{rsid} HTTP/1.1
Content-Type: application/resource-set+json
If-Match: (entity tag of resource)
...

(body contains JSON resource set description to be updated)</pre>
</div>
<p>Form of a successful HTTP response:</p>
<blockquote>
<div>HTTP/1.1 204 No Content
ETag: &#8220;2&#8221;
...</div></blockquote>
<p>If the entity tag does not match, the authorization server MUST
produce an error response with an error property value of
&#8220;precondition_failed&#8221;, as defined in Section 2.3.</p>
<p>On successful update, the authorization server MAY return a redirect
policy URI to the resource server in a property with the name
&#8220;policy_uri&#8221;.  This URI allows the resource server to redirect the
user to a specific user interface within the authorization server
where the user can immediately set or modify access policies for the
resource set that was just updated.</p>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.3">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.3</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3-4" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="delete-resource-set-description">
<h4><a class="toc-backref" href="#id13">2.3.4. Delete Resource Set Description</a><a class="headerlink" href="#delete-resource-set-description" title="Permalink to this headline">¶</a></h4>
<p>Deletes a previously registered resource set description using the
DELETE method, thereby removing it from the authorization server&#8217;s
protection regime.</p>
<p>Form of a &#8220;delete resource set description&#8221; HTTP request:</p>
<div class="highlight-python"><pre>DELETE /resource_set/{rsid}
If-Match: (entity tag of resource)
...</pre>
</div>
<p>Form of a successful HTTP response:</p>
<blockquote>
<div>HTTP/1.1 204 No content
...</div></blockquote>
<p>As defined in Section 2.3, if the referenced resource does not exist
the authorization server MUST produce an error response with an error
property value of &#8220;not_found&#8221;, and if the entity tag does not match
the authorization server MUST produce an error response with an error
property value of &#8220;precondition_failed&#8221;.</p>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.4">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.4</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-2-3-5" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="list-resource-set-descriptions">
<h4><a class="toc-backref" href="#id14">2.3.5. List Resource Set Descriptions</a><a class="headerlink" href="#list-resource-set-descriptions" title="Permalink to this headline">¶</a></h4>
<p>Lists all previously registered resource set identifiers for this
user using the GET method.  The authorization server MUST return the
list in the form of a JSON array of {rsid} values.</p>
<p>The resource server uses this method as a first step in checking
whether its understanding of protected resources is in full
synchronization with the authorization server&#8217;s understanding.</p>
<p>Form of a &#8220;list resource set descriptions&#8221; HTTP request:</p>
<div class="highlight-python"><pre>GET /resource_set HTTP/1.1
...</pre>
</div>
<p>HTTP response:</p>
<blockquote>
<div><p>HTTP/1.1 200 OK
...</p>
<p>(body contains JSON array of {rsid} values)</p>
</div></blockquote>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.5">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-2.3.5</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-3" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="error-messages">
<h2><a class="toc-backref" href="#id15">3. Error Messages</a><a class="headerlink" href="#error-messages" title="Permalink to this headline">¶</a></h2>
<p>When a resource server attempts to access the resource set
registration endpoint at the authorization server, if the request is
successfully authenticated by OAuth means, but is invalid for another
reason, the authorization server produces an error response by adding
the following properties to the entity body of the HTTP response:</p>
<dl class="glossary docutils">
<dt id="term-error">error</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">A single error code, as noted in the API
definition.  Value for this property is defined in the specific
authorization server endpoint description.</p>
</dd>
<dt id="term-error-description">error_description</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">A human-readable text providing
additional information, used to assist in the understanding and
resolution of the error occurred.</p>
</dd>
<dt id="term-error-uri">error_uri</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">A URI identifying a human-readable web page
with information about the error, used to provide the end-user
with additional information about the error.</p>
</dd>
</dl>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-3">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-3</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-4" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="security-considerations">
<h2><a class="toc-backref" href="#id16">4. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>This specification relies on OAuth for API security and shares its
security and vulnerability considerations.</p>
<p>( draft 00 , <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-4">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-4</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-5" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="privacy-considerations">
<h2><a class="toc-backref" href="#id17">5. Privacy Considerations</a><a class="headerlink" href="#privacy-considerations" title="Permalink to this headline">¶</a></h2>
<p>The communication between the authorization server and resource
server may expose personally identifiable information.  The context
in which this API is used SHOULD deal with its own unique privacy
considerations.</p>
<p>( draft 00 , <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-5">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-5</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-6" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="conformance">
<h2><a class="toc-backref" href="#id18">6. Conformance</a><a class="headerlink" href="#conformance" title="Permalink to this headline">¶</a></h2>
<p>This specification makes optional normative reference to <a class="reference internal" href="#term-oauth2"><em class="xref std std-term">[OAuth2]</em></a>
for API protection.</p>
<p>This specification is anticipated to be used as a
module in higher-order specifications, where additional constraints
and profiling may appear.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-6">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-6</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-7" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="iana-considerations">
<h2><a class="toc-backref" href="#id19">7. IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This document makes no request of IANA.</p>
<p>(draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-7">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-7</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-8" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example-of-registering-resource-sets">
<h2><a class="toc-backref" href="#id20">8. Example of Registering Resource Sets</a><a class="headerlink" href="#example-of-registering-resource-sets" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>UX Only</li>
<li>Internal Only</li>
</ul>
</div>
<p>The following example illustrates the intent and usage of
<em class="xref std std-term">resource set descriptions</em>
and <em class="xref std std-term">scope type descriptions</em>
as part of resource set registration
for the purposes of User-Managed Access (<a class="reference internal" href="uma_core.html"><em>UMA</em></a>).</p>
<p>This example contains some steps
that are exclusively in the realm of user experience
rather than web protocol, to achieve realistic illustration.
These steps are labeled &#8220;<strong>User experience only</strong>&#8221;.
Some other steps are exclusively internal to the operation of the entity being discussed.
These are labeled &#8220;<strong>Internal only</strong>&#8221;.</p>
<p>A <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>, Alice Adams, has just uploaded a photo
of her new puppy to a <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a>, Photoz.example.com,
and wants to ensure that this specific photo is not publicly accessible.</p>
<p>Alice has already introduced this resource server to her authorization server,
CopMonkey.example.com,
and thus Photoz has already obtained a PAT from CopMonkey.
However,
Alice has not previously instructed Photoz to use CopMonkey
to protect any other photos of hers.</p>
<p>Alice has previously visited CopMonkey to map a default
&#8220;<strong>do not share with anyone</strong>&#8221; policy to any <a class="reference internal" href="uma_core.html#term-resource-sets"><em class="xref std std-term">resource sets</em></a>
registered by Photoz,
until such time as she maps some other more permissive policies
to those resources.</p>
<blockquote>
<div><p>(
<strong>User experience only</strong>.</p>
<p>This may have been done at the time Alice introduced the resource server
to the authorization server,
and/or it could have been a global or resource server-specific preference setting.
A different constraint or no constraint at all might be associated
with newly protected resources.</p>
<p>)</p>
</div></blockquote>
<p>Other kinds of policies she may eventually map to particular photos or
albums might be &#8220;<strong>Share only with husband&#64;email.example.net</strong>&#8221;
or &#8220;<strong>Share only with people in my &#8216;family&#8217; group</strong>&#8221;.</p>
<p>Photoz itself has a publicly documented application-specific API
that offers two dozen different methods that apply to single photos,
such as &#8220;addTags&#8221; and &#8220;getSizes&#8221;,
but rolls them up into two photo-related <em class="xref std std-term">scope types</em> of access:
&#8220;<strong>view</strong>&#8221; (consisting of various read-only operations) and
&#8220;<strong>all</strong>&#8221; (consisting of various reading, editing, and printing operations).</p>
<p>It defines two <em class="xref std std-term">scope type descriptions</em> that represent these <em class="xref std std-term">scope types</em>,
which it is able to reuse for all of its users (not just Alice),
and ensures that these scope type description documents are available
through HTTP GET requests that may be made by authorization servers.</p>
<p>The &#8220;name&#8221; property values are intended to be seen by Alice
when she maps authorization constraints to specific <a class="reference internal" href="uma_core.html#term-resource-sets"><em class="xref std std-term">resource sets</em></a>
and actions while visiting CopMonkey,
such that Alice would see the strings &#8220;<strong>View Photo and Related Info</strong>&#8221;
and &#8220;<strong>All Actions</strong>&#8221;,
likely accompanied by the referenced icons, in the CopMonkey interface.</p>
<blockquote>
<div><p>(Other users of Photoz might similarly see the same labels at CopMonkey
or whatever other authorization server they use.</p>
<p>Photoz could distinguish natural-language labels per user
if it wishes, by pointing to scopes with differently translated names.)</p>
</div></blockquote>
<p>Example of the viewing-related <em class="xref std std-term">scope type description document</em>
available at <a class="reference external" href="http://photoz.example.com/dev/scopes/view">http://photoz.example.com/dev/scopes/view</a> with a
Content-Type of <strong>application/intro-scope+json</strong>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;View Photo and Related Info&quot;</span><span class="p">,</span>
  <span class="s2">&quot;icon_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/icons/reading-glasses.png&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Example of the broader <em class="xref std std-term">scope type description document</em> available at
<a class="reference external" href="http://photoz.example.com/dev/scopes/all">http://photoz.example.com/dev/scopes/all</a>,
likewise with a Content- Type of <strong>application/intro-scope+json</strong>:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;All Actions&quot;</span><span class="p">,</span>
  <span class="s2">&quot;icon_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/icons/galaxy.png&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>While visiting Photoz,
Alice selects a link or button that instructs the site to &#8220;<strong>Protect</strong>&#8221; or &#8220;<strong>Share</strong>&#8221;
this single photo.</p>
<blockquote>
<div><p>(<strong>user experience only</strong>;</p>
<p>Photoz could have made this a default or preference setting)</p>
</div></blockquote>
<p>As a result,
Photoz defines for itself a <a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a> that represents this photo.</p>
<blockquote>
<div><p>(<strong>internal only</strong>;</p>
<p>Photoz is the only application that knows how to map a particular photo to a particular resource set
)</p>
</div></blockquote>
<p>Photoz also prepares the following <em class="xref std std-term">resource set description</em>,
which is specific to Alice and her photo.
The &#8220;name&#8221; property value is intended to be seen by Alice in mapping authorization policies
to specific <a class="reference internal" href="uma_core.html#term-resource-sets"><em class="xref std std-term">resource sets</em></a> and actions when she visits CopMonkey.
Alice would see the string &#8220;<strong>Steve the puppy!</strong>&#8221;,
likely accompanied by the referenced icon, in the CopMonkey interface.
The possible scopes of access on this <a class="reference internal" href="#term-resource-set"><em class="xref std std-term">resource set</em></a> are indicated with URI references
to the scope descriptions, as shown just above.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Steve the puppy!&quot;</span><span class="p">,</span>
  <span class="s2">&quot;icon_uri&quot;</span><span class="o">:</span> <span class="s2">&quot;http://www.example.com/icons/flower&quot;</span><span class="p">,</span>
  <span class="s2">&quot;scopes&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="s2">&quot;http://photoz.example.com/dev/scopes/view&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://photoz.example.com/dev/scopes/all&quot;</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Photoz uses the &#8220;<strong>create resource set description</strong>&#8221; method of
CopMonkey&#8217;s standard UMA <em class="xref std std-term">resource set registration API</em>,
presenting its Alice-specific PAT there,
to register and assign an identifier to the resource set description.</p>
<div class="highlight-python"><pre>PUT /resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/intro-resource-set+json
...

{
  "name": "Steve the puppy!",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}</pre>
</div>
<p>If the registration attempt succeeds,
CopMonkey responds in the following fashion.</p>
<div class="highlight-python"><pre>HTTP/1.1 201 Created
Content-Type: application/intro-status+json
ETag: "1"
...

{
  "status": "created",
  "_id":  "112210f47de98100",
  "_rev": "1"
}</pre>
</div>
<p>At the time Alice indicates she would like this photo protected,
Photoz can choose to redirect Alice to CopMonkey for further policy setting,
access auditing, and other authorization server-related tasks (<strong>user experience only</strong>).</p>
<p>Once it has successfully registered this description,
Photoz is responsible for outsourcing to CopMonkey all questions of
authorization for access attempts made to this photo.</p>
<p>Over time,
as Alice uploads other photos and creates and organizes photo albums,
and as Photoz makes new action functionality available,
Photoz can use additional methods of the <em class="xref std std-term">resource set registration API</em> to ensure
that CopMonkey&#8217;s understanding of Alice&#8217;s protected resources matches its own.</p>
<p>For example,
if Photoz suspects that somehow its understanding of the resource set has gotten out of sync with CopMonkey&#8217;s,
it can ask to read the resource set description as follows.</p>
<div class="highlight-python"><pre>GET /resource_set/112210f47de98100 HTTP/1.1
Host: as.example.com
...</pre>
</div>
<p>CopMonkey responds with the full content of the <em class="xref std std-term">resource set description</em>,
including its <strong>_id</strong> and its current <strong>_rev</strong>, as follows:</p>
<p>Example of an HTTP response to a &#8220;<strong>read resource set description</strong>&#8221; request,
containing a <em class="xref std std-term">resource set description</em> from the authorization server:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/intro-resource-set+json
ETag: "1"
...

{
  "_id":  "112210f47de98100",
  "_rev": "1",
  "name": "Photo album",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}</pre>
</div>
<p>If for some reason Photoz and CopMonkey have gotten dramatically out of sync,
Photoz can ask for the list of resource set identifiers CopMonkey currently knows about:</p>
<div class="highlight-python"><pre>GET /resource_set HTTP/1.1
Host: as.example.com
...</pre>
</div>
<p>CopMonkey&#8217;s response might look as follows:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
...

[ "112210f47de98100", "34234df47eL95300" ]</pre>
</div>
<p>If Alice later changes the photo&#8217;s title (user experience only) on Photoz
from &#8220;Steve the puppy!&#8221; to &#8220;Steve on October 14, 2011&#8221;,
Photoz would use the &#8220;<strong>update resource set description</strong>&#8221; method to ensure that
Alice&#8217;s experience of policy-setting at CopMonkey remains consistent with
what she sees at Photoz.</p>
<p>Following is an example of this request.</p>
<div class="highlight-python"><pre>PUT /resource_set/112210f47de98100 HTTP/1.1
Content-Type: application/intro-resource-set+json
Host: as.example.com
If-Match: "1"
...

{
  "name": "Steve on October 14, 2011",
  "icon_uri": "http://www.example.com/icons/flower.png",
  "scopes": [
    "http://photoz.example.com/dev/scopes/view",
    "http://photoz.example.com/dev/scopes/all"
  ]
}</pre>
</div>
<p>CopMonkey would respond as follows.</p>
<div class="highlight-python"><pre>HTTP/1.1 201 Created
Content-Type: application/intro-status+json
ETag: "2"
...

{
  "status": "updated",
  "_id":  "112210f47de98100",
  "_rev": "2"
}</pre>
</div>
<p>There are other reasons Photoz might want to update <em class="xref std std-term">resource set descriptions</em>,
having nothing to do with Alice&#8217;s actions or wishes.</p>
<p>For example,
it might extend its API to include new features,
and want to add new scopes to all of Alice&#8217;s and other users&#8217; <em class="xref std std-term">resource set descriptions</em>.</p>
<p>if Alice later decides to entirely remove sharing protection
(<strong>user experience only</strong>) on this photo while visiting Photoz,
ensuring that the public can get access without any UMA-based protection,
Photoz is responsible for deleting the relevant <em class="xref std std-term">resource set registration</em>,
as follows:</p>
<div class="highlight-python"><pre>DELETE /resource_set/112210f47de98100 HTTP/1.1
Host: as.example.com
If-Match: "2"
...</pre>
</div>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-8">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-8</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-11" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id21">11. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" id="oauth-res-reg-11-1" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<div class="section" id="normative-references">
<h3><a class="toc-backref" href="#id22">11.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-oauth2">[OAuth2]</dt>
<dd>Hammer-Lahav, E., &#8220;The OAuth 2.0 Protocol&#8221;,
September 2011,
&lt;<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2">http://tools.ietf.org/html/draft-ietf-oauth-v2</a>&gt;.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2119.html"><strong>RFC 2119</strong></a>, March 1997.</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">OAuth2は RFCですよ!!!!!</p>
</div>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-11.1">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-11.1</a> )</p>
<table class="docutils field-list" frame="void" id="oauth-res-reg-11-2" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">orphan:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="informative-references">
<h3><a class="toc-backref" href="#id23">11.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-oauth-linktypes">[OAuth-linktypes]</dt>
<dd>Richer, J., &#8220;Link Type Registrations for OAuth 2&#8221;,
October 2012,
&lt;<a class="reference external" href="http://tools.ietf.org/html/draft-wmills-oauth-lrdd">http://tools.ietf.org/html/draft-wmills-oauth-lrdd</a>&gt;.</dd>
</dl>
<p>( draft 00, <a class="reference external" href="http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-11.2">http://tools.ietf.org/html/draft-hardjono-oauth-resource-reg-00#section-11.2</a> )</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth_meta.html">JSON Metadata for OAuth Responses</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_res.html">OAuth Resoure</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>