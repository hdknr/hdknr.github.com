

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The OAuth 2.0 Authorization Framework &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth 2.0 Assertion Profile" href="oauth_assertion.html" />
    <link rel="prev" title="Digital Identity" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>The OAuth 2.0 Authorization Framework</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Digital Identity</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_assertion.html">OAuth 2.0 Assertion Profile</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="the-oauth-2-0-authorization-framework">
<h1><a class="toc-backref" href="#id6">The OAuth 2.0 Authorization Framework</a><a class="headerlink" href="#the-oauth-2-0-authorization-framework" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-oauth-2-0-authorization-framework" id="id6">The OAuth 2.0 Authorization Framework</a><ul>
<li><a class="reference internal" href="#abstract" id="id7">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id8">1.  Introduction</a><ul>
<li><a class="reference internal" href="#roles" id="id9">1.1.  Roles</a></li>
<li><a class="reference internal" href="#protocol-flow" id="id10">1.2.  Protocol Flow</a></li>
<li><a class="reference internal" href="#authorization-grant" id="id11">1.3.  Authorization Grant</a><ul>
<li><a class="reference internal" href="#authorization-code" id="id12">1.3.1.  Authorization Code</a></li>
<li><a class="reference internal" href="#implicit" id="id13">1.3.2.  Implicit</a></li>
<li><a class="reference internal" href="#resource-owner-password-credentials" id="id14">1.3.3.  Resource Owner Password Credentials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token" id="id15">1.4. Access Token</a></li>
<li><a class="reference internal" href="#refresh-token" id="id16">1.5. Refresh Token</a></li>
<li><a class="reference internal" href="#tls-version" id="id17">1.6. TLS Version</a></li>
<li><a class="reference internal" href="#http-redirections" id="id18">1.7. HTTP Redirections</a></li>
<li><a class="reference internal" href="#interoperability" id="id19">1.8. Interoperability</a></li>
<li><a class="reference internal" href="#notational-conventions" id="id20">1.9. Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#client-registration" id="id21">2. Client Registration</a><ul>
<li><a class="reference internal" href="#client-types" id="id22">2.1. Client Types</a></li>
<li><a class="reference internal" href="#client-identifier" id="id23">2.2. Client Identifier</a></li>
<li><a class="reference internal" href="#client-authentication" id="id24">2.3. Client Authentication</a><ul>
<li><a class="reference internal" href="#client-password" id="id25">2.3.1. Client Password</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unregistered-clients" id="id26">2.4. Unregistered Clients</a></li>
</ul>
</li>
<li><a class="reference internal" href="#protocol-endpoints" id="id27">3. Protocol Endpoints</a><ul>
<li><a class="reference internal" href="#authorization-endpoint" id="id28">3.1. Authorization Endpoint</a><ul>
<li><a class="reference internal" href="#response-type" id="id29">3.1.1. Response Type</a></li>
<li><a class="reference internal" href="#redirection-endpoint" id="id30">3.1.2. Redirection Endpoint</a><ul>
<li><a class="reference internal" href="#endpoint-request-confidentiality" id="id31">3.1.2.1.  Endpoint Request Confidentiality</a></li>
<li><a class="reference internal" href="#registration-requirements" id="id32">3.1.2.2.  Registration Requirements</a></li>
<li><a class="reference internal" href="#dynamic-configuration" id="id33">3.1.2.3.  Dynamic Configuration</a></li>
<li><a class="reference internal" href="#invalid-endpoint" id="id34">3.1.2.4.  Invalid Endpoint</a></li>
<li><a class="reference internal" href="#endpoint-content" id="id35">3.1.2.5.  Endpoint Content</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#token-endpoint" id="id36">3.2. Token Endpoint</a><ul>
<li><a class="reference internal" href="#oauth-3-2-1" id="id37">3.2.1. Client Authentication</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#obtaining-authorization" id="id38">4.  Obtaining Authorization</a><ul>
<li><a class="reference internal" href="#authorization-code-grant" id="id39">4.1. Authorization Code Grant</a><ul>
<li><a class="reference internal" href="#authorization-request" id="id40">4.1.1. Authorization Request</a></li>
<li><a class="reference internal" href="#authorization-response" id="id41">4.1.2. Authorization Response</a><ul>
<li><a class="reference internal" href="#error-response" id="id42">4.1.2.1. Error Response</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#issuing-an-access-token" id="id43">5.  Issuing an Access Token</a><ul>
<li><a class="reference internal" href="#successful-response" id="id44">5.1.  Successful Response</a></li>
<li><a class="reference internal" href="#oauth-5-2" id="id45">5.2. Error Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#refreshing-an-access-token" id="id46">6. Refreshing an Access Token</a></li>
<li><a class="reference internal" href="#accessing-protected-resources" id="id47">7. Accessing Protected Resources</a><ul>
<li><a class="reference internal" href="#access-token-types" id="id48">7.1. Access Token Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extensibility" id="id49">8. Extensibility</a><ul>
<li><a class="reference internal" href="#defining-new-authorization-endpoint-response-types" id="id50">8.4. Defining New Authorization Endpoint Response Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#native-applications" id="id51">9.  Native Applications</a></li>
<li><a class="reference internal" href="#security-considerations" id="id52">10. Security Considerations</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id53">11.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#the-oauth-parameters-registry" id="id54">11.2.  The OAuth Parameters Registry</a></li>
<li><a class="reference internal" href="#the-oauth-authorization-endpoint-response-type-registry" id="id55">11.3. The OAuth Authorization Endpoint Response Type Registry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id56">13.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id57">13.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id58">13.2.  Informative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li>An annotated document based on <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6749.html"><strong>RFC 6749</strong></a></li>
</ul>
<div class="section" id="abstract">
<span id="oauth-abstract"></span><h2><a class="toc-backref" href="#id7">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The OAuth 2.0 authorization framework enables
a third-party application to obtain limited access to an HTTP service,
either on behalf of a <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>
by orchestrating an approval interaction
between the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> and the HTTP service,
or by allowing the third-party application
to obtain access on its own behalf.
This specification replaces and obsoletes the OAuth 1.0 protocol described in <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc5849.html"><strong>RFC 5849</strong></a> .</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749">Abstract</a> )</p>
</div>
<div class="section" id="introduction">
<span id="oauth-1"></span><h2><a class="toc-backref" href="#id8">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In the traditional client-server authentication model,
the client requests an access-restricted resource (<a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a>)
on the server by authenticating with the server
using the resource owner&#8217;s credentials.
In order to provide third-party applications access to restricted resources,
the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> shares its credentials with the third party.
This creates several problems and limitations:</p>
<blockquote>
<div><ul class="simple">
<li>Third-party applications are required to store the resource
owner&#8217;s credentials for future use, typically a password in
clear-text.</li>
<li>Servers are required to support password authentication, despite
the security weaknesses inherent in passwords.</li>
<li>Third-party applications gain overly broad access to the resource
owner&#8217;s protected resources, leaving resource owners without any
ability to restrict duration or access to a limited subset of
resources.</li>
<li>Resource owners cannot revoke access to an individual third party
without revoking access to all third parties, and must do so by
changing the third party&#8217;s password.</li>
<li>Compromise of any third-party application results in compromise of
the end-user&#8217;s password and all of the data protected by that
password.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">credential scattering</p>
<blockquote>
<div><ul class="simple">
<li>security breach on a single client = danger other clients and the server</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">passwords are usually week secrets.</p>
</li>
<li><p class="first">huge access scope for single grant</p>
</li>
<li><p class="first">no revocation : give up credential. all clients or nothing.</p>
</li>
</ul>
</div>
<p>OAuth addresses these issues by introducing an authorization layer
and separating the role of the client from that of the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
In OAuth,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> requests access to resources controlled by
the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> and hosted by the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>,
and is issued a different set of credentials
than those of the resource owner.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Authorization Layer</li>
<li>Role Separation</li>
</ul>
</div>
<p>Instead of using the resource owner&#8217;s credentials to access protected resources,
the client obtains an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> &#8211;
a string denoting a specific <a class="reference internal" href="uma_core.html#term-scope"><em class="xref std std-term">scope</em></a>, <em class="xref std std-term">lifetime</em>, and other access attributes.
Access tokens are issued to third-party clients
by an <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> with the approval of the resource owner.
The client uses the access token to access the protected resources hosted by the resource server.</p>
<p>For example,
an <a class="reference internal" href="#term-end-user"><em class="xref std std-term">end-user</em></a> (resource owner) can <em class="xref std std-term">grant</em> a printing service (<a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>)
access to her protected photos stored at a photo-sharing service (<a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>),
without sharing her username and password with the printing service.</p>
<p>Instead,
she authenticates directly with a server trusted by the photo-sharing service
(<a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>),
which issues the printing service delegation-specific credentials (<a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>).</p>
<p>This specification is designed for use with HTTP (<a class="reference internal" href="swd.html#term-rfc2616"><em class="xref std std-term">[RFC2616]</em></a>).
The use of OAuth over any protocol other than HTTP is out of scope.</p>
<p>The OAuth 1.0 protocol (<em class="xref std std-term">[RFC5849]</em>),
published as an informational document,
was the result of a small ad hoc community effort.
This Standards Track specification builds on the OAuth 1.0 deployment experience,
as well as additional use cases and extensibility requirements gathered
from the wider IETF community.
The OAuth 2.0 protocol is not backward compatible with OAuth 1.0.
The two versions may co-exist on the network,
and implementations may choose to support both.
However,
it is the intention of this specification that new implementations support OAuth 2.0
as specified in this document and
that OAuth 1.0 is used only to support existing deployments.
The OAuth 2.0 protocol shares very few implementation details
with the OAuth 1.0 protocol.
Implementers familiar with OAuth 1.0 should approach this document
without any assumptions as to its structure and details.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>NO backward compatibility to <span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc5849.html"><strong>RFC 5849</strong></a></li>
<li>NO implementation sharing with 1.0</li>
</ul>
</div>
<p>(<a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1">http://tools.ietf.org/html/rfc6749#section-1</a>)</p>
<div class="section" id="roles">
<span id="oauth-1-1"></span><h3><a class="toc-backref" href="#id9">1.1.  Roles</a><a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h3>
<p>OAuth defines four roles:</p>
<dl class="glossary docutils">
<dt id="term-resource-owner"><span id="term-resource-owners"></span>resource owner<br />resource owners</dt>
<dd>An entity capable of granting access to a <a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a>.
When the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> is a person, it is referred to as an
<a class="reference internal" href="#term-end-user"><em class="xref std std-term">end-user</em></a>.</dd>
<dt id="term-resource-server"><span id="term-resource-servers"></span>resource server<br />resource servers</dt>
<dd>The server hosting the <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>,
capable of accepting and responding to <a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a> requests
using <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a>.</dd>
<dt id="term-client"><span id="term-clients"></span>client<br />clients</dt>
<dd>An application making <a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a> requests on behalf of the
<em class="xref std std-ref">resource owner</em> and with its authorization.  The term &#8220;client&#8221; does
not imply any particular implementation characteristics (e.g.,
whether the application executes on a server, a desktop, or other
devices).</dd>
<dt id="term-authorization-server"><span id="term-authorization-servers"></span>authorization server<br />authorization servers</dt>
<dd>The server issuing <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> after successfully
authenticating the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> and obtaining authorization.</dd>
</dl>
<p>The interaction between the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> and <em class="xref std std-ref">resource server</em>
is beyond the scope of this specification.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> may be the same server as the resource server
or a separate entity.
A single authorization server may issue access tokens accepted by
multiple resource servers.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="glossary docutils">
<dt id="term-entity">entity</dt>
<dd><ul class="first last simple">
<li>server or something like that.</li>
</ul>
</dd>
<dt id="term-end-user">end-user</dt>
<dd><ul class="first last simple">
<li>special <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> when it is is a person.</li>
</ul>
</dd>
</dl>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.1">http://tools.ietf.org/html/rfc6749#section-1.1</a> )</p>
</div>
<div class="section" id="protocol-flow">
<span id="oauth-1-2"></span><h3><a class="toc-backref" href="#id10">1.2.  Protocol Flow</a><a class="headerlink" href="#protocol-flow" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre>+--------+                               +---------------+
|        |--(A)- Authorization Request -&gt;|   Resource    |
|        |                               |     Owner     |
|        |&lt;-(B)-- Authorization Grant ---|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(C)-- Authorization Grant --&gt;| Authorization |
| Client |                               |     Server    |
|        |&lt;-(D)----- Access Token -------|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(E)----- Access Token ------&gt;|    Resource   |
|        |                               |     Server    |
|        |&lt;-(F)--- Protected Resource ---|               |
+--------+                               +---------------+

                Figure 1: Abstract Protocol Flow</pre>
</div>
<p>The abstract OAuth 2.0 flow illustrated in Figure 1 describes the
interaction between the four roles and includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The client requests authorization from the resource owner.  The
authorization request can be made directly to the resource owner
(as shown), or preferably indirectly via the authorization
server as an intermediary.</li>
<li>The client receives an authorization grant, which is a
credential representing the resource owner&#8217;s authorization,
expressed using one of four <a class="reference internal" href="#term-grant-types"><em class="xref std std-term">grant types</em></a> defined in this
specification or using an <a class="reference internal" href="glossary.html#term-extension-grant-type"><em class="xref std std-term">extension grant type</em></a>.  The
authorization grant type depends on the method used by the
client to request authorization and the types supported by the
authorization server.</li>
<li>The client requests an access token by authenticating with the
authorization server and presenting the authorization grant.</li>
<li>The authorization server authenticates the client and validates
the authorization grant, and if valid, issues an access token.</li>
<li>The client requests the protected resource from the resource
server and authenticates by presenting the access token.</li>
<li>The resource server validates the access token, and if valid,
serves the request.</li>
</ol>
</div></blockquote>
<p>The preferred method for the client to obtain an authorization grant
from the resource owner (depicted in steps (A) and (B)) is to use the
authorization server as an intermediary, which is illustrated in
Figure 3 in <a class="reference internal" href="#oauth-4-1"><em>Section 4.1</em></a>.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.2">http://tools.ietf.org/html/rfc6749#section-1.2</a> )</p>
</div>
<div class="section" id="authorization-grant">
<span id="oauth-1-3"></span><h3><a class="toc-backref" href="#id11">1.3.  Authorization Grant</a><a class="headerlink" href="#authorization-grant" title="Permalink to this headline">¶</a></h3>
<p>An <em class="xref std std-term">authorization grant</em> is a <em class="xref std std-term">credential</em>
representing the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s authorization
(to access its protected resources) used by the client to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.
This specification defines four <a class="reference internal" href="#term-grant-types"><em class="xref std std-term">grant types</em></a> &#8211;
authorization code, implicit, resource owner password
credentials, and client credentials &#8211;
as well as an extensibility mechanism for defining additional types.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="glossary docutils">
<dt id="term-grant-types">grant types</dt>
<dd><ol class="first last arabic simple">
<li>authorization code</li>
<li>implicit</li>
<li>resource owner password credentials</li>
<li>client credentials</li>
</ol>
</dd>
</dl>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.3">http://tools.ietf.org/html/rfc6749#section-1.3</a> )</p>
<div class="section" id="authorization-code">
<span id="oauth-code"></span><span id="oauth-1-3-1"></span><h4><a class="toc-backref" href="#id12">1.3.1.  Authorization Code</a><a class="headerlink" href="#authorization-code" title="Permalink to this headline">¶</a></h4>
<p>The authorization code is obtained by using an authorization server
as an intermediary between the client and resource owner.  Instead of
requesting authorization directly from the resource owner, the client
directs the resource owner to an authorization server (via its
user-agent as defined in <a class="reference internal" href="swd.html#term-rfc2616"><em class="xref std std-term">[RFC2616]</em></a>), which in turn directs the
resource owner back to the client with the authorization code.</p>
<p>Before directing the resource owner back to the client with the
authorization code, the authorization server authenticates the
resource owner and obtains authorization.  Because the resource owner
only authenticates with the authorization server, the resource
owner&#8217;s credentials are never shared with the client.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>user authentication before code response</li>
</ul>
</div>
<p>The authorization code provides a few important security benefits,
such as the ability to authenticate the client, as well as the
transmission of the access token directly to the client without
passing it through the resource owner&#8217;s user-agent and potentially
exposing it to others, including the resource owner.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.3.1">http://tools.ietf.org/html/rfc6749#section-1.3.1</a> )</p>
</div>
<div class="section" id="implicit">
<span id="oauth-implicit"></span><span id="oauth-1-3-2"></span><h4><a class="toc-backref" href="#id13">1.3.2.  Implicit</a><a class="headerlink" href="#implicit" title="Permalink to this headline">¶</a></h4>
<p>The implicit grant is a simplified authorization code flow optimized
for clients implemented in a browser using a scripting language such
as <em class="xref std std-term">JavaScript</em>.
In the implicit flow,
instead of issuing the client an authorization code,
the client is issued an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> directly
(as the result of the resource owner authorization).
The grant type is implicit,
as no intermediate credentials (such as an authorization code)
are issued (and later used to obtain an access token).</p>
<p>When issuing an access token during the implicit grant flow,
the authorization server does not authenticate the client.  In some
cases, the client identity can be verified via the <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a>
used to deliver the access token to the client.  The access token may
be exposed to the resource owner or other applications with access to
the resource owner&#8217;s user-agent.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">resource requester( client ) IS not authenticated.</p>
</li>
<li><p class="first">Access token holders is valid requesters.</p>
</li>
<li><p class="first">redirection URL for tokens to be returned may be verified by tokens issuers.</p>
</li>
<li><p class="first">access tokes ARE EXPOSED to:</p>
<blockquote>
<div><ul class="simple">
<li>resource owner( end-user), because he operates his browser</li>
<li>other applications which running on the same user agent.</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>Implicit grants improve the responsiveness and efficiency of some
clients (such as a client implemented as an in-browser application),
since it reduces the number of round trips required to obtain an
access token.
However, this convenience should be weighed against
the security implications of using implicit grants, such as those
described in Sections <em class="xref std std-ref">10.3</em> and <em class="xref std std-ref">10.16</em>,
especially when the authorization code grant type is available.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.3.2">http://tools.ietf.org/html/rfc6749#section-1.3.2</a> )</p>
</div>
<div class="section" id="resource-owner-password-credentials">
<span id="oauth-1-3-3"></span><h4><a class="toc-backref" href="#id14">1.3.3.  Resource Owner Password Credentials</a><a class="headerlink" href="#resource-owner-password-credentials" title="Permalink to this headline">¶</a></h4>
<p>The resource owner password credentials (i.e., username and password)
can be used directly as an authorization grant to obtain an access token.
The credentials should only be used when there is a high
degree of trust between the resource owner and the client (e.g., the
client is part of the device operating system or a highly privileged
application), and when other authorization grant types are not
available (such as an authorization code).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Resource owners store their credentials at clients</li>
<li>There MUST be tight trust relationship.</li>
</ul>
</div>
<p>Even though this grant type requires direct client access to the
resource owner credentials, the resource owner credentials are used
for a single request and are exchanged for an access token.  This
grant type can eliminate the need for the client to store the
resource owner credentials for future use, by exchanging the
credentials with a long-lived access token or refresh token.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.3.3">http://tools.ietf.org/html/rfc6749#section-1.3.3</a> )</p>
<p id="oauth-1-3-4">1.3.4.  Client Credentials</p>
<p>The client credentials (or other forms of client authentication) can
be used as an authorization grant when the authorization scope is
limited to the protected resources under the control of the client,
or to protected resources previously arranged with the authorization server.
Client credentials are used as an authorization grant
typically when the client is acting on its own behalf (the client is
also the resource owner) or is requesting access to protected
resources based on an authorization previously arranged with the
authorization server.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>when protected resoruces are uder the client&#8217;s controlls</li>
<li>when protected resources have been arrageded with authorizatio server before.</li>
<li>when a cliet are equal to the resource owner.</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749#section-1.3.4">http://tools.ietf.org/html/rfc6749#section-1.3.4</a> )</p>
</div>
</div>
<div class="section" id="access-token">
<span id="oauth-1-4"></span><h3><a class="toc-backref" href="#id15">1.4. Access Token</a><a class="headerlink" href="#access-token" title="Permalink to this headline">¶</a></h3>
<p>Access tokens are credentials used to access protected resources.
An access token is a string representing an authorization issued to the client.
The string is usually opaque to the client.
Tokens represent specific scopes and durations of access,
granted by the resource owner,
and enforced by the resource server and authorization server.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>credentials for protected resources</li>
<li>scope</li>
<li>duration</li>
<li>granted by resource owner</li>
<li>enforced by resource server &amp; authorization server</li>
</ul>
</div>
<p>The token may denote an identifier used to retrieve the authorization
information or may self-contain the authorization information in a
verifiable manner (i.e., a token string consisting of some data and a
signature).  Additional authentication credentials, which are beyond
the scope of this specification, may be required in order for the
client to use a token.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>may identifer to information</li>
<li>may contains authorization information</li>
</ul>
</div>
<p>The access token provides an abstraction layer, replacing different
authorization constructs (e.g., username and password) with a single
token understood by the resource server.  This abstraction enables
issuing access tokens more restrictive than the authorization grant
used to obtain them, as well as removing the resource server&#8217;s need
to understand a wide range of authentication methods.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>issuing token is more restrictive than authorization grant</li>
</ul>
</div>
<p>Access tokens can have different formats, structures, and methods of
utilization (e.g., cryptographic properties) based on the resource
server security requirements.  Access token attributes and the
methods used to access protected resources are beyond the scope of
this specification and are defined by companion specifications such as <em class="xref std std-term">[RFC6750]</em>.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.4">http://tools.ietf.org/html/rfc6749.html#section-1.4</a> )</p>
</div>
<div class="section" id="refresh-token">
<span id="oauth-1-5"></span><h3><a class="toc-backref" href="#id16">1.5. Refresh Token</a><a class="headerlink" href="#refresh-token" title="Permalink to this headline">¶</a></h3>
<p>Refresh tokens are credentials used to obtain access tokens.
Refresh tokens are issued to the client by the authorization server and
are used to obtain a new access token
when the current access token becomes invalid or expires,
or to obtain additional access tokens with identical or narrower scope
(access tokens may have a shorter lifetime and fewer permissions
than authorized by the resource owner).
Issuing a refresh token is optional at the discretion of the authorization server.
If the authorization server issues a refresh token,
it is included when issuing an access token (i.e., step (D) in Figure 1).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>refresh token -&gt; access token</li>
<li>refresh token support is OPTIONAL.</li>
</ul>
</div>
<p>A refresh token is a string representing the authorization granted to
the client by the resource owner.  The string is usually opaque to
the client.  The token denotes an identifier used to retrieve the
authorization information.  Unlike access tokens, refresh tokens are
intended for use only with authorization servers and are never sent
to resource servers.</p>
<div class="highlight-python"><pre>+--------+                                           +---------------+
|        |--(A)------- Authorization Grant ---------&gt;|               |
|        |                                           |               |
|        |&lt;-(B)----------- Access Token -------------|               |
|        |               &amp; Refresh Token             |               |
|        |                                           |               |
|        |                            +----------+   |               |
|        |--(C)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(D)- Protected Resource --| Resource |   | Authorization |
| Client |                            |  Server  |   |     Server    |
|        |--(E)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(F)- Invalid Token Error -|          |   |               |
|        |                            +----------+   |               |
|        |                                           |               |
|        |--(G)----------- Refresh Token -----------&gt;|               |
|        |                                           |               |
|        |&lt;-(H)----------- Access Token -------------|               |
+--------+           &amp; Optional Refresh Token        +---------------+

             Figure 2: Refreshing an Expired Access Token</pre>
</div>
<p>The flow illustrated in Figure 2 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The client requests an access token by authenticating with the
authorization server and presenting an authorization grant.</li>
<li>The authorization server authenticates the client and validates
the authorization grant, and if valid, issues an access token
and a refresh token.</li>
<li>The client makes a protected resource request to the resource
server by presenting the access token.</li>
<li>The resource server validates the access token, and if valid,
serves the request.</li>
<li>Steps (C) and (D) repeat until the access token expires.  If the
client knows the access token expired, it skips to step (G);
otherwise, it makes another protected resource request.</li>
<li>Since the access token is invalid, the resource server returns
an invalid token error.</li>
<li>The client requests a new access token by authenticating with
the authorization server and presenting the refresh token.  The
client authentication requirements are based on the client type
and on the authorization server policies.</li>
<li>The authorization server authenticates the client and validates
the refresh token, and if valid, issues a new access token (and,
optionally, a new refresh token).</li>
</ol>
</div></blockquote>
<p>Steps (C), (D), (E), and (F) are outside the scope of this
specification, as described in <em class="xref std std-ref">Section 7</em>.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.5">http://tools.ietf.org/html/rfc6749.html#section-1.5</a> )</p>
</div>
<div class="section" id="tls-version">
<span id="oauth-1-6"></span><h3><a class="toc-backref" href="#id17">1.6. TLS Version</a><a class="headerlink" href="#tls-version" title="Permalink to this headline">¶</a></h3>
<p>Whenever Transport Layer Security (TLS) is used by this
specification, the appropriate version (or versions) of TLS will vary
over time, based on the widespread deployment and known security
vulnerabilities.  At the time of this writing, TLS version 1.2
[RFC5246] is the most recent version, but has a very limited
deployment base and might not be readily available for
implementation.  TLS version 1.0 [RFC2246] is the most widely
deployed version and will provide the broadest interoperability.</p>
<p>Implementations MAY also support additional transport-layer security
mechanisms that meet their security requirements.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.6">http://tools.ietf.org/html/rfc6749.html#section-1.6</a> )</p>
</div>
<div class="section" id="http-redirections">
<span id="oauth-1-7"></span><h3><a class="toc-backref" href="#id18">1.7. HTTP Redirections</a><a class="headerlink" href="#http-redirections" title="Permalink to this headline">¶</a></h3>
<p>This specification makes extensive use of HTTP redirections, in which
the client or the authorization server directs the resource owner&#8217;s
user-agent to another destination.  While the examples in this
specification show the use of the HTTP 302 status code, any other
method available via the user-agent to accomplish this redirection is
allowed and is considered to be an implementation detail.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.7">http://tools.ietf.org/html/rfc6749.html#section-1.7</a> )</p>
</div>
<div class="section" id="interoperability">
<span id="oauth-1-8"></span><h3><a class="toc-backref" href="#id19">1.8. Interoperability</a><a class="headerlink" href="#interoperability" title="Permalink to this headline">¶</a></h3>
<p>OAuth 2.0 provides a rich authorization framework with well-defined
security properties.  However, as a rich and highly extensible
framework with many optional components, on its own, this
specification is likely to produce a wide range of non-interoperable
implementations.</p>
<p>In addition, this specification leaves a few required components
partially or fully undefined (e.g., client registration,
authorization server capabilities, endpoint discovery).  Without
these components, clients must be manually and specifically
configured against a specific authorization server and resource
server in order to interoperate.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Implements are required.</p>
<ul class="last simple">
<li>client registration</li>
<li>authorization server functions</li>
<li>discovery</li>
</ul>
</div>
<p>This framework was designed with the clear expectation that future
work will define prescriptive profiles and extensions necessary to
achieve full web-scale interoperability.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.8">http://tools.ietf.org/html/rfc6749.html#section-1.8</a> )</p>
</div>
<div class="section" id="notational-conventions">
<span id="oauth-1-9"></span><h3><a class="toc-backref" href="#id20">1.9. Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
specification are to be interpreted as described in [RFC2119].</p>
<p>This specification uses the Augmented Backus-Naur Form (ABNF)
notation of [RFC5234].  Additionally, the rule URI-reference is
included from &#8220;Uniform Resource Identifier (URI): Generic Syntax&#8221;
[RFC3986].</p>
<p>Certain security-related terms are to be understood in the sense
defined in [RFC4949].  These terms include, but are not limited to,
&#8220;attack&#8221;, &#8220;authentication&#8221;, &#8220;authorization&#8221;, &#8220;certificate&#8221;,
&#8220;confidentiality&#8221;, &#8220;credential&#8221;, &#8220;encryption&#8221;, &#8220;identity&#8221;, &#8220;sign&#8221;,
&#8220;signature&#8221;, &#8220;trust&#8221;, &#8220;validate&#8221;, and &#8220;verify&#8221;.</p>
<p>Unless otherwise noted, all the protocol parameter names and values
are case sensitive.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-1.9">http://tools.ietf.org/html/rfc6749.html#section-1.9</a> )</p>
</div>
</div>
<div class="section" id="client-registration">
<span id="oauth-2"></span><h2><a class="toc-backref" href="#id21">2. Client Registration</a><a class="headerlink" href="#client-registration" title="Permalink to this headline">¶</a></h2>
<p>Before initiating the protocol,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> registers with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The means through which the client registers
with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> are beyond the scope of this specification
but typically involve end-user interaction with an HTML registration form.</p>
<p>Client registration does not require a direct interaction between the
client and the authorization server.
When supported by the authorization server,
registration can rely on other means for
establishing trust and obtaining the required client properties
(e.g., redirection URI, client type).
For example,
registration can be accomplished using a self-issued or third-party-issued assertion,
or by the authorization server performing client discovery using a
trusted channel.</p>
<p>When registering a client, the client developer SHALL:</p>
<ul class="simple">
<li>specify the <em class="xref std std-term">client type</em> as described in <a class="reference internal" href="#oauth-2-1"><em>Section 2.1</em></a>,</li>
<li>provide its <em class="xref std std-term">client redirection URIs</em> as described in <em class="xref std std-ref">Section 3.1.2</em>,
and</li>
<li>include any other information required by the authorization server
(e.g., <em class="xref std std-term">application name</em>, website, description, logo image, the
acceptance of legal terms).</li>
</ul>
<p>(<a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2">http://tools.ietf.org/html/rfc6749.html#section-2</a>)</p>
<div class="section" id="client-types">
<span id="oauth-2-1"></span><h3><a class="toc-backref" href="#id22">2.1. Client Types</a><a class="headerlink" href="#client-types" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>no assumption for client type. must check</li>
</ul>
</div>
<p>OAuth defines two <em class="xref std std-term">client types</em>,
based on their ability to authenticate securely
with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
(i.e., ability to maintain the confidentiality of their client credentials):</p>
<dl class="glossary docutils">
<dt id="term-confidential">confidential</dt>
<dd>Clients capable of maintaining the confidentiality of their
credentials (e.g., client implemented on a secure server with
restricted access to the client credentials), or capable of secure
client authentication using other means.</dd>
<dt id="term-public">public</dt>
<dd>Clients incapable of maintaining the confidentiality of their
credentials (e.g., clients executing on the device used by the
resource owner, such as an installed native application or a web
browser-based application), and incapable of secure client
authentication via any other means.</dd>
</dl>
<p>The <em class="xref std std-term">client type</em> designation is based on
the authorization server&#8217;s definition of secure authentication
and its acceptable exposure levels of client credentials.
The authorization server SHOULD NOT make assumptions about the client type.</p>
<p>A client may be implemented as a distributed set of components,
each with a different client type and security context
(e.g., a distributed client with both a confidential server-based component
and a public browser-based component).
If the authorization server does not provide support
for such clients or does not provide guidance
with regard to their registration,
the client SHOULD register each component as a separate client.</p>
<p>This specification has been designed around the following <em class="xref std std-term">client profiles</em>:</p>
<dl class="glossary docutils">
<dt id="term-web-application">web application</dt>
<dd><p class="first">A web application is a <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a> client
running on a web server.</p>
<p>Resource owners access the client via an HTML user
interface rendered in a user-agent on the device used by the
resource owner.</p>
<p class="last">The client credentials as well as any access token
issued to the client are stored on the web server and
are not exposed to or accessible by the resource owner.</p>
</dd>
<dt id="term-user-agent-based-application">user-agent-based application</dt>
<dd>A user-agent-based application is a <a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a> client in which the
client code is downloaded from a web server and executes within a
user-agent (e.g., web browser) on the device used by the resource
owner.  Protocol data and credentials are easily accessible (and
often visible) to the resource owner.  Since such applications
reside within the user-agent, they can make seamless use of the
user-agent capabilities when requesting authorization.</dd>
<dt id="term-native-application">native application</dt>
<dd><p class="first">A native application is a <a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a> client
installed and executed on the device used by the resource owner.</p>
<p class="last">Protocol data and credentials are accessible to the resource owner.
It is assumed that any client authentication credentials included in the
application can be extracted.  On the other hand, dynamically
issued credentials such as access tokens or refresh tokens can
receive an acceptable level of protection.  At a minimum, these
credentials are protected from hostile servers with which the
application may interact.  On some platforms, these credentials
might be protected from other applications residing on the same
device.</p>
</dd>
</dl>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.1">http://tools.ietf.org/html/rfc6749.html#section-2.1</a> )</p>
</div>
<div class="section" id="client-identifier">
<span id="oauth-2-2"></span><h3><a class="toc-backref" href="#id23">2.2. Client Identifier</a><a class="headerlink" href="#client-identifier" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues the registered client
a client identifier &#8211; a unique string representing the registration
information provided by the client.
The client identifier is not a secret;
it is exposed to the resource owner and MUST NOT be used
alone for client authentication.
The client identifier is unique to the authorization server.</p>
<p>The client identifier string size is left undefined by this specification.
The client should avoid making assumptions about the
identifier size.
The authorization server SHOULD document the size of any identifier it issues.</p>
<dl class="glossary docutils">
<dt id="term-client-identifier">Client Identifier</dt>
<dd><ul class="first last simple">
<li>issued by authorization server</li>
<li>unique in the server</li>
<li>not secert, do not use as authentication credential by itself.</li>
<li>size of identfiiers SHOULD be documented.</li>
</ul>
</dd>
</dl>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.2">http://tools.ietf.org/html/rfc6749.html#section-2.2</a> )</p>
</div>
<div class="section" id="client-authentication">
<span id="oauth-2-3"></span><h3><a class="toc-backref" href="#id24">2.3. Client Authentication</a><a class="headerlink" href="#client-authentication" title="Permalink to this headline">¶</a></h3>
<p>If the client type is confidential,
the client and authorization
server establish a client authentication method suitable for the
security requirements of the authorization server.  The authorization
server MAY accept any form of client authentication meeting its
security requirements.</p>
<p>Confidential clients are typically issued (or establish) a set of
client credentials used for authenticating with the authorization
server (e.g., password, public/private key pair).</p>
<p>The authorization server MAY establish a client authentication method
with public clients.
However, the authorization server MUST NOT rely on public client authentication
for the purpose of identifying the client.</p>
<p>The client MUST NOT use more than one authentication method in each request.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Basic authentication MUST be support <a class="reference internal" href="#oauth-2-3-1"><em>2.3.1. Client Password</em></a>.</li>
<li>OpenID Connect documents client authentication in <tt class="xref doc docutils literal"><span class="pre">discvoery</span></tt>.</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.3">http://tools.ietf.org/html/rfc6749.html#section-2.3</a> )</p>
<div class="section" id="client-password">
<span id="oauth-2-3-1"></span><h4><a class="toc-backref" href="#id25">2.3.1. Client Password</a><a class="headerlink" href="#client-password" title="Permalink to this headline">¶</a></h4>
<p>Clients in possession of a client password MAY use the HTTP Basic
authentication scheme as defined in <a class="reference internal" href="backplane.html#term-rfc2617"><em class="xref std std-term">[RFC2617]</em></a> to authenticate with
the authorization server.  The client identifier is encoded using the
&#8220;application/x-www-form-urlencoded&#8221; encoding algorithm per
Appendix B, and the encoded value is used as the username; the client
password is encoded using the same algorithm and used as the
password.  The authorization server MUST support the HTTP Basic
authentication scheme for authenticating clients that were issued a
client password.</p>
<p>For example (with extra line breaks for display purposes only):</p>
<div class="highlight-python"><pre>Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3</pre>
</div>
<p>Alternatively, the authorization server MAY support including the
client credentials in the request-body using the following
parameters:</p>
<dl class="glossary docutils">
<dt id="term-client-id">client_id</dt>
<dd>REQUIRED.  The client identifier issued to the client during
the registration process described by Section 2.2.</dd>
<dt id="term-client-secret">client_secret</dt>
<dd>REQUIRED.  The client secret.  The client MAY omit the
parameter if the client secret is an empty string.</dd>
</dl>
<p>Including the client credentials in the request-body using the two
parameters is NOT RECOMMENDED and SHOULD be limited to clients unable
to directly utilize the HTTP Basic authentication scheme (or other
password-based HTTP authentication schemes).  The parameters can only
be transmitted in the request-body and MUST NOT be included in the
request URI.</p>
<p>For example, a request to refresh an access token (Section 6) using
the body parameters (with extra line breaks for display purposes
only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
&amp;client_id=s6BhdRkqt3&amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw</pre>
</div>
<p>The authorization server MUST require the use of TLS as described in
<a class="reference internal" href="#oauth-1-6"><em>Section 1.6</em></a> when sending requests using password authentication.</p>
<p>Since this client authentication method involves a password, the
authorization server MUST protect any endpoint utilizing it against
brute force attacks.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.3.1">http://tools.ietf.org/html/rfc6749.html#section-2.3.1</a> )</p>
<p id="oauth-2-3-2">2.3.2. Other Authentication Methods</p>
<p>The authorization server MAY support any suitable HTTP authentication
scheme matching its security requirements.  When using other
authentication methods, the authorization server MUST define a
mapping between the client identifier (registration record) and
authentication scheme.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>OpenID Connect documents client authentication methods in <a class="reference internal" href="discovery.html"><em>OpenID Connect Discovery 1.0</em></a>.</li>
</ul>
</div>
<p>(<a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.3.1">http://tools.ietf.org/html/rfc6749.html#section-2.3.1</a> )</p>
</div>
</div>
<div class="section" id="unregistered-clients">
<span id="oauth-2-4"></span><h3><a class="toc-backref" href="#id26">2.4. Unregistered Clients</a><a class="headerlink" href="#unregistered-clients" title="Permalink to this headline">¶</a></h3>
<p>This specification does not exclude the use of unregistered clients.
However, the use of such clients is beyond the scope of this
specification and requires additional security analysis and review of
its interoperability impact</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-2.4">http://tools.ietf.org/html/rfc6749.html#section-2.4</a> )</p>
</div>
</div>
<div class="section" id="protocol-endpoints">
<span id="oauth-3"></span><h2><a class="toc-backref" href="#id27">3. Protocol Endpoints</a><a class="headerlink" href="#protocol-endpoints" title="Permalink to this headline">¶</a></h2>
<p>The authorization process utilizes two authorization server endpoints
(HTTP resources):</p>
<blockquote>
<div><ul class="simple">
<li>Authorization endpoint - used by the client to obtain
authorization from the resource owner via user-agent redirection.</li>
<li>Token endpoint - used by the client to exchange an authorization
grant for an access token, typically with client authentication.</li>
</ul>
</div></blockquote>
<p>As well as one client endpoint:</p>
<blockquote>
<div><ul class="simple">
<li>Redirection endpoint - used by the authorization server to return
responses containing authorization credentials to the client via
the resource owner user-agent.</li>
</ul>
</div></blockquote>
<p>Not every authorization grant type utilizes both endpoints.
Extension grant types MAY define additional endpoints as needed.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-3">http://tools.ietf.org/html/rfc6749.html#section-3</a> )</p>
<div class="section" id="authorization-endpoint">
<span id="oauth-3-1"></span><h3><a class="toc-backref" href="#id28">3.1. Authorization Endpoint</a><a class="headerlink" href="#authorization-endpoint" title="Permalink to this headline">¶</a></h3>
<p>The authorization endpoint is used to interact with the resource
owner and obtain an authorization grant.  The authorization server
MUST first verify the identity of the resource owner.  The way in
which the authorization server authenticates the resource owner
(e.g., username and password login, session cookies) is beyond the
scope of this specification.</p>
<p>The means through which the client obtains the location of the
authorization endpoint are beyond the scope of this specification,
but the location is typically provided in the service documentation.</p>
<p>The endpoint URI MAY include an &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221;
formatted (per Appendix B) query component (<a class="reference internal" href="jws.html#term-rfc3986"><em class="xref std std-term">[RFC3986]</em></a> Section 3.4),
which MUST be retained when adding additional query parameters.  The
endpoint URI MUST NOT include a fragment component.</p>
<p>Since requests to the authorization endpoint result in user
authentication and the transmission of clear-text credentials (in the
HTTP response), the authorization server MUST require the use of TLS
as described in Section 1.6 when sending requests to the
authorization endpoint.</p>
<p>The authorization server MUST support the use of the HTTP &#8220;GET&#8221;
method [RFC2616] for the authorization endpoint and MAY support the
use of the &#8220;POST&#8221; method as well.</p>
<p>Parameters sent without a value MUST be treated as if they were
omitted from the request.  The authorization server MUST ignore
unrecognized request parameters.  Request and response parameters
MUST NOT be included more than once.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-3.1">http://tools.ietf.org/html/rfc6749.html#section-3.1</a> )</p>
<div class="section" id="response-type">
<span id="oauth-3-1-1"></span><h4><a class="toc-backref" href="#id29">3.1.1. Response Type</a><a class="headerlink" href="#response-type" title="Permalink to this headline">¶</a></h4>
<p>The authorization endpoint is used by the authorization code grant
type and implicit grant type flows.  The client informs the
authorization server of the desired grant type using the following parameter:</p>
<blockquote>
<div><p>response_type</p>
<blockquote>
<div>REQUIRED.  The value MUST be one of &#8220;code&#8221; for requesting an
authorization code as described by Section 4.1.1, &#8220;token&#8221; for
requesting an access token (implicit grant) as described by
Section 4.2.1, or a registered extension value as described by
Section 8.4.  If the response type contains one or more space
characters (%x20), it is interpreted as a space-delimited list
of values, where the order of values does not matter (e.g. &#8220;a
b&#8221; is the same as &#8220;b a&#8221;).</div></blockquote>
</div></blockquote>
<p>If an authorization request is missing the &#8220;response_type&#8221; parameter,
the authorization server SHOULD return an error response as described
in Section 4.1.2.1.</p>
</div>
<div class="section" id="redirection-endpoint">
<span id="oauth-3-1-2"></span><h4><a class="toc-backref" href="#id30">3.1.2. Redirection Endpoint</a><a class="headerlink" href="#redirection-endpoint" title="Permalink to this headline">¶</a></h4>
<p>After completing its interaction with the resource owner,
the authorization server directs the resource owner&#8217;s user-agent
back to the client.</p>
<p>The authorization server redirects the user-agent
to the client&#8217;s <em class="xref std std-term">redirection endpoint</em>
previously established with the authorization server
during the <a class="reference internal" href="glossary.html#term-client-registration"><em class="xref std std-term">client registration</em></a> process or
when making the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a>.</p>
<p>The redirection endpoint URI MUST be an absolute URI
as defined by [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 4.3.
The endpoint URI MAY include an &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221;
formatted ([<a class="reference internal" href="#term-w3c-rec-html401-19991224"><em class="xref std std-term">W3C.REC-html401-19991224</em></a>]) query component
([<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 3.4),
which MUST be retained when adding additional query parameters.
The endpoint URI MUST NOT include a fragment component.</p>
<p>(v.23)</p>
<div class="section" id="endpoint-request-confidentiality">
<span id="oauth-3-1-2-1"></span><h5><a class="toc-backref" href="#id31">3.1.2.1.  Endpoint Request Confidentiality</a><a class="headerlink" href="#endpoint-request-confidentiality" title="Permalink to this headline">¶</a></h5>
<p>The redirection endpoint SHOULD require
the use of TLS as described in Section 1.6
when the requested response type is &#8220;<a class="reference internal" href="#term-code"><em class="xref std std-term">code</em></a>&#8221; or &#8220;<a class="reference internal" href="standard.html#term-token"><em class="xref std std-term">token</em></a>&#8221;,
or when the redirection request will result
in the transmission of sensitive credentials over an open network.
This specification does not mandate the use of TLS
because at the time of this writing,
requiring clients to deploy TLS is a significant
hurdle for most client developers.</p>
<p>Lack of transport-layer security can have a severe impact
on the security of the client
and the protected resources it is authorized to access.
The use of transport-layer security is particularly critical
when the authorization process is used as a form of delegated end-user authentication
by the client (e.g. third-party sign-in service).</p>
<p>(v .23)</p>
</div>
<div class="section" id="registration-requirements">
<span id="oauth-3-1-2-2"></span><h5><a class="toc-backref" href="#id32">3.1.2.2.  Registration Requirements</a><a class="headerlink" href="#registration-requirements" title="Permalink to this headline">¶</a></h5>
<p>The authorization server MUST require the following clients to
register their redirection endpoint:</p>
<blockquote>
<div><ul class="simple">
<li><em class="xref std std-term">Public clients</em>.</li>
<li><em class="xref std std-term">Confidential clients</em> utilizing the <em class="xref std std-term">implicit grant type</em>.</li>
</ul>
</div></blockquote>
<p>The authorization server SHOULD require all clients
to register their redirection endpoint
prior to utilizing the authorization endpoint</p>
<p>The authorization server SHOULD require the client
to provide the complete redirection URI
(the client MAY use the &#8220;state&#8221; request parameter to achieve per-request customization).
If requiring the registration of the complete redirection URI is not possible,
the authorization server SHOULD require the registration of the URI scheme,
authority, and path
(allowing the client to dynamically vary only the <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a>
of the redirection URI when requesting authorization).</p>
<p>The authorization server MAY allow the client
to register <strong>multiple</strong> <em class="xref std std-term">redirection endpoints</em>.</p>
<p>Lack of a redirection URI registration requirement
can enable an attacker to use the authorization endpoint
as <em class="xref std std-term">open redirector</em> as described in <em class="xref std std-ref">Section 10.15</em>.</p>
<p>(v. 23)</p>
</div>
<div class="section" id="dynamic-configuration">
<span id="oauth-3-1-2-3"></span><h5><a class="toc-backref" href="#id33">3.1.2.3.  Dynamic Configuration</a><a class="headerlink" href="#dynamic-configuration" title="Permalink to this headline">¶</a></h5>
<p>If multiple redirection URIs have been registered, if only part of
the redirection URI has been registered, or if no redirection URI has
been registered, the client MUST include a redirection URI with the
authorization request using the &#8220;redirect_uri&#8221; request parameter.</p>
<p>When a <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a> is included in an authorization request,
the authorization server MUST compare and match the value received against
at least one of the registered redirection URIs
(or URI components) as defined in [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 6,
if any redirection URIs were registered.
If the client registration included the full redirection URI,
the authorization server MUST compare the two URIs
using simple string comparison as defined in [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 6.2.1.</p>
<p>(v 23)</p>
</div>
<div class="section" id="invalid-endpoint">
<span id="oauth-3-1-2-4"></span><h5><a class="toc-backref" href="#id34">3.1.2.4.  Invalid Endpoint</a><a class="headerlink" href="#invalid-endpoint" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>If an authorization request fails validation due to a missing,
invalid, or mismatching redirection URI, the authorization server
SHOULD inform the resource owner of the error, and MUST NOT
automatically redirect the user-agent to the invalid redirection URI.</div></blockquote>
<p>(v.23)</p>
</div>
<div class="section" id="endpoint-content">
<span id="oauth-3-1-2-5"></span><h5><a class="toc-backref" href="#id35">3.1.2.5.  Endpoint Content</a><a class="headerlink" href="#endpoint-content" title="Permalink to this headline">¶</a></h5>
<p>The redirection request to the client&#8217;s endpoint typically results in
an HTML document response, processed by the user-agent.  If the HTML
response is served directly as the result of the redirection request,
any script included in the HTML document will execute with full
access to the redirection URI and the credentials it contains.</p>
<p>The client MUST NOT include any untrusted third-party scripts in the
redirection endpoint response (e.g. third-party analytics, social
plug-ins, ad networks) without first ensuring that its own scripts
used to extract and remove the credentials from the URI will execute
first.</p>
<p>The client SHOULD NOT include any third-party scripts in the
redirection endpoint response.  Instead, it should extract the
credentials from the URI and redirect the user-agent again to another
endpoint without the credentials in the URI.</p>
<p>(v.23)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Developer MSUT provide a dedicated master template for
the redirection URL contents.
No third party Javascript or beacon to disclose
<strong>code</strong>, <strong>token</strong> and other privacy information.</p>
</div>
</div>
</div>
</div>
<div class="section" id="token-endpoint">
<span id="oauth-3-2"></span><h3><a class="toc-backref" href="#id36">3.2. Token Endpoint</a><a class="headerlink" href="#token-endpoint" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-token-endpoint">Token Endpoint</dt>
<dd>Endpoint to issue tokens.</dd>
</dl>
<p>The <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> is used by the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
by presenting its <em class="xref std std-term">authorization grant</em> or <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Confidential clients&#8217; credential can be a  authorization grant. See &#8220;<em class="xref std std-ref">oauth_4_4</em>&#8221;.</p>
</div>
<p>The <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> is used with every <em class="xref std std-term">authorization grant</em>
except for the <em class="xref std std-term">implicit grant</em> type
(since an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is issued directly).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Directly at <em class="xref std std-term">Autorization Endpoint</em></p>
</div>
<p>The means through which the client obtains
the location of the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> are beyond the scope of this specification
but is typically provided in the service documentation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Discovery</p>
</div>
<p>The endpoint URI MAY include an &#8220;application/x-www-form-urlencoded&#8221; formatted
([<a class="reference internal" href="#term-w3c-rec-html401-19991224"><em class="xref std std-term">W3C.REC-html401-19991224</em></a>]) <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a> ([<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 3.4),
which MUST be retained when adding additional query parameters.
The endpoint URI MUST NOT include a fragment component.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No fragment to URI</p>
</div>
<p>Since requests to the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> result in
the transmission of clear-text credentials
(in the HTTP request and response),
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST require TLS as described in <em class="xref std std-ref">Section 1.6</em>
when sending requests to the token endpoint.</p>
<p>The client MUST use the HTTP &#8220;<strong>POST</strong>&#8221; method when making access token requests.</p>
<p>Parameters sent without a value MUST be treated as
if they were omitted from the request.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST ignore unrecognized request parameters.
Request and response parameters MUST NOT be included more than once.</p>
<p>(v.23 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2</a>)</p>
<div class="section" id="oauth-3-2-1">
<span id="id2"></span><h4><a class="toc-backref" href="#id37">3.2.1. Client Authentication</a><a class="headerlink" href="#oauth-3-2-1" title="Permalink to this headline">¶</a></h4>
<p><em class="xref std std-term">Confidential clients</em>,
or other clients issued client credentials MUST
authenticate with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
as described in <em class="xref std std-ref">Section 2.3</em>
when making requests to the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.
<a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> authentication is used for:</p>
<blockquote>
<div><ul class="simple">
<li>Enforcing the binding of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a> and <em class="xref std std-term">authorization codes</em> to
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> they were issued to.
<strong>Client authentication</strong> is critical
when <em class="xref std std-term">an authorization code</em> is transmitted to the <em class="xref std std-term">redirection endpoint</em>
over an insecure channel,
or when the <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a> has not been registered in full.</li>
<li>Recovering from a compromised client by disabling the client or
changing its credentials,
thus preventing an attacker from abusing stolen <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a>.
Changing a single set of client
credentials is significantly faster than
revoking an entire set of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a>.</li>
<li>Implementing <em class="xref std std-term">authentication management best practices</em> which
require <em class="xref std std-term">periodic credential rotation</em>.
Rotation of an entire set of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a> can be challenging,
while rotation of a single set of client credentials is significantly easier.</li>
</ul>
</div></blockquote>
<p>A <a class="reference internal" href="glossary.html#term-public-client"><em class="xref std std-term">public client</em></a> that was not issued a client password
MAY use the &#8220;<a class="reference internal" href="#term-21"><em class="xref std std-term">client_id</em></a>&#8221; request parameter to identify itself
when sending requests to the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.</p>
<p>(v.28 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-28#section-3.2.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-28#section-3.2.1</a> )</p>
</div>
</div>
</div>
<div class="section" id="obtaining-authorization">
<span id="oauth-4"></span><h2><a class="toc-backref" href="#id38">4.  Obtaining Authorization</a><a class="headerlink" href="#obtaining-authorization" title="Permalink to this headline">¶</a></h2>
<p>To request an access token,
the client obtains authorization from the resource owner.
The authorization is expressed in the form of an authorization grant
which the client uses to request the access token.
OAuth defines four grant types: authorization code, implicit,
resource owner password credentials, and client credentials.
It also provides an extension mechanism for defining additional grant types.</p>
<p>(v.23)</p>
<div class="section" id="authorization-code-grant">
<span id="oauth-4-1"></span><h3><a class="toc-backref" href="#id39">4.1. Authorization Code Grant</a><a class="headerlink" href="#authorization-code-grant" title="Permalink to this headline">¶</a></h3>
<p>The authorization code grant type is used to obtain both access
tokens and refresh tokens and is optimized for confidential clients.
Since this is a redirection-based flow, the client must be capable of
interacting with the resource owner&#8217;s user-agent (typically a web
browser) and capable of receiving incoming requests (via redirection)
from the authorization server.</p>
<div class="highlight-python"><pre>+----------+
| Resource |
|   Owner  |
|          |
+----------+
     ^
     |
    (B)
+----|-----+          Client Identifier      +---------------+
|         -+----(A)-- &amp; Redirection URI ----&gt;|               |
|  User-   |                                 | Authorization |
|  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
|          |                                 |               |
|         -+----(C)-- Authorization Code ---&lt;|               |
+-|----|---+                                 +---------------+
  |    |                                         ^      v
 (A)  (C)                                        |      |
  |    |                                         |      |
  ^    v                                         |      |
+---------+                                      |      |
|         |&gt;---(D)-- Authorization Code ---------'      |
|  Client |          &amp; Redirection URI                  |
|         |                                             |
|         |&lt;---(E)----- Access Token -------------------'
+---------+       (w/ Optional Refresh Token)

Note: The lines illustrating steps (A), (B), and (C) are broken into
two parts as they pass through the user-agent.

                Figure 3: Authorization Code Flow</pre>
</div>
<p>The flow illustrated in Figure 3 includes the following steps:</p>
<ol class="upperalpha simple">
<li>The client initiates the flow by directing the resource owner&#8217;s
user-agent to the authorization endpoint.  The client includes
its client identifier, requested scope, local state, and a
redirection URI to which the authorization server will send the
user-agent back once access is granted (or denied).</li>
<li>The authorization server authenticates the resource owner (via
the user-agent) and establishes whether the resource owner
grants or denies the client&#8217;s access request.</li>
<li>Assuming the resource owner grants access, the authorization
server redirects the user-agent back to the client using the
redirection URI provided earlier (in the request or during
client registration).  The redirection URI includes an
authorization code and any local state provided by the client
earlier.</li>
<li>The client requests an access token from the authorization
server&#8217;s token endpoint by including the authorization code
received in the previous step.  When making the request, the
client authenticates with the authorization server.  The client
includes the redirection URI used to obtain the authorization
code for verification.</li>
<li>The authorization server authenticates the client, validates the
authorization code, and ensures that the redirection URI
received matches the URI used to redirect the client in
step (C).  If valid, the authorization server responds back with
an access token and, optionally, a refresh token.</li>
</ol>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-4.1">http://tools.ietf.org/html/rfc6749.html#section-4.1</a> )</p>
<div class="section" id="authorization-request">
<span id="oauth-4-1-1"></span><h4><a class="toc-backref" href="#id40">4.1.1. Authorization Request</a><a class="headerlink" href="#authorization-request" title="Permalink to this headline">¶</a></h4>
<p>The client constructs the request URI by adding the following
parameters to the query component of the authorization endpoint URI
using the &#8220;application/x-www-form-urlencoded&#8221; format, per Appendix B:</p>
<dl class="glossary docutils">
<dt id="term-response-type">response_type</dt>
<dd>REQUIRED.  Value MUST be set to &#8220;code&#8221;.</dd>
<dt id="term-21">client_id</dt>
<dd>REQUIRED.  The client identifier as described in Section 2.2.</dd>
<dt id="term-redirect-uri">redirect_uri</dt>
<dd>OPTIONAL.  As described in Section 3.1.2.</dd>
<dt id="term-scope">scope</dt>
<dd><p class="first"><strong>OPTIONAL</strong>.</p>
<p class="last">The scope of the access request as described by <em class="xref std std-ref">Section 3.3</em>.</p>
</dd>
<dt id="term-state">state</dt>
<dd>RECOMMENDED.  An opaque value used by the client to maintain
state between the request and callback.  The authorization
server includes this value when redirecting the user-agent back
to the client.  The parameter SHOULD be used for preventing
cross-site request forgery as described in Section 10.12.</dd>
</dl>
<p>The client directs the resource owner to the constructed URI using an
HTTP redirection response, or by other means available to it via the
user-agent.</p>
<p>For example, the client directs the user-agent to make the following
HTTP request using TLS (with extra line breaks for display purposes
only):</p>
<div class="highlight-python"><pre>GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz
    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
Host: server.example.com</pre>
</div>
<p>The authorization server validates the request to ensure that all
required parameters are present and valid.  If the request is valid,
the authorization server authenticates the resource owner and obtains
an authorization decision (by asking the resource owner or by
establishing approval via other means).</p>
<p>When a decision is established, the authorization server directs the
user-agent to the provided client redirection URI using an HTTP
redirection response, or by other means available to it via the
user-agent.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-4.1.1">http://tools.ietf.org/html/rfc6749.html#section-4.1.1</a> )</p>
</div>
<div class="section" id="authorization-response">
<span id="oauth-4-1-2"></span><h4><a class="toc-backref" href="#id41">4.1.2. Authorization Response</a><a class="headerlink" href="#authorization-response" title="Permalink to this headline">¶</a></h4>
<p>If the resource owner grants the access request, the authorization
server issues an authorization code and delivers it to the client by
adding the following parameters to the query component of the
redirection URI using the &#8220;application/x-www-form-urlencoded&#8221; format,
per Appendix B:</p>
<dl class="glossary docutils">
<dt id="term-code">code</dt>
<dd>REQUIRED.  The authorization code generated by the
authorization server.  The authorization code MUST expire
shortly after it is issued to mitigate the risk of leaks.  A
maximum authorization code lifetime of 10 minutes is
RECOMMENDED.  The client MUST NOT use the authorization code
more than once.  If an authorization code is used more than
once, the authorization server MUST deny the request and SHOULD
revoke (when possible) all tokens previously issued based on
that authorization code.  The authorization code is bound to
the client identifier and redirection URI.</dd>
<dt id="term-26">state</dt>
<dd>REQUIRED if the &#8220;state&#8221; parameter was present in the client
authorization request.  The exact value received from the
client.</dd>
</dl>
<p>For example, the authorization server redirects the user-agent by
sending the following HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
          &amp;state=xyz</pre>
</div>
<p>The client MUST ignore unrecognized response parameters.  The
authorization code string size is left undefined by this
specification.  The client should avoid making assumptions about code
value sizes.  The authorization server SHOULD document the size of
any value it issues.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-4.1.2">http://tools.ietf.org/html/rfc6749.html#section-4.1.2</a> )</p>
<div class="section" id="error-response">
<span id="oauth-4-1-2-1"></span><h5><a class="toc-backref" href="#id42">4.1.2.1. Error Response</a><a class="headerlink" href="#error-response" title="Permalink to this headline">¶</a></h5>
<p>If the request fails due to a missing, invalid, or mismatching
redirection URI, or if the client identifier is missing or invalid,
the authorization server SHOULD inform the resource owner of the
error and MUST NOT automatically redirect the user-agent to the
invalid redirection URI.</p>
<p>If the resource owner denies the access request or if the request
fails for reasons other than a missing or invalid redirection URI,
the authorization server informs the client by adding the following
parameters to the query component of the redirection URI using the
&#8220;application/x-www-form-urlencoded&#8221; format, per Appendix B:</p>
<dl class="glossary docutils">
<dt id="term-error">error</dt>
<dd><p class="first">REQUIRED.  A single ASCII [USASCII] error code from the
following:</p>
<dl class="glossary docutils">
<dt id="term-invalid-request">invalid_request</dt>
<dd>The request is missing a required parameter, includes an
invalid parameter value, includes a parameter more than
once, or is otherwise malformed.</dd>
<dt id="term-unauthorized-client">unauthorized_client</dt>
<dd>The client is not authorized to request an authorization
code using this method.</dd>
<dt id="term-access-denied">access_denied</dt>
<dd>The resource owner or authorization server denied the
request.</dd>
<dt id="term-unsupported-response-type">unsupported_response_type</dt>
<dd>The authorization server does not support obtaining an
authorization code using this method.</dd>
<dt id="term-invalid-scope">invalid_scope</dt>
<dd>The requested scope is
<strong>invalid</strong>, <strong>unknown</strong>, or <strong>malformed</strong>.</dd>
<dt id="term-server-error">server_error</dt>
<dd>The authorization server encountered an unexpected
condition that prevented it from fulfilling the request.
(This error code is needed because a 500 Internal Server
Error HTTP status code cannot be returned to the client
via an HTTP redirect.)</dd>
<dt id="term-temporarily-unavailable">temporarily_unavailable</dt>
<dd>The authorization server is currently unable to handle
the request due to a temporary overloading or maintenance
of the server.  (This error code is needed because a 503
Service Unavailable HTTP status code cannot be returned
to the client via an HTTP redirect.)</dd>
</dl>
<p class="last">Values for the &#8220;error&#8221; parameter MUST NOT include characters
outside the set %x20-21 / %x23-5B / %x5D-7E.</p>
</dd>
<dt id="term-error-description">error_description</dt>
<dd>OPTIONAL.  Human-readable ASCII [USASCII] text providing
additional information, used to assist the client developer in
understanding the error that occurred.
Values for the &#8220;error_description&#8221; parameter MUST NOT include
characters outside the set %x20-21 / %x23-5B / %x5D-7E.</dd>
<dt id="term-error-uri">error_uri</dt>
<dd>OPTIONAL.  A URI identifying a human-readable web page with
information about the error, used to provide the client
developer with additional information about the error.
Values for the &#8220;error_uri&#8221; parameter MUST conform to the
URI-reference syntax and thus MUST NOT include characters
outside the set %x21 / %x23-5B / %x5D-7E.</dd>
<dt id="term-37">state</dt>
<dd>REQUIRED if a &#8220;state&#8221; parameter was present in the client
authorization request.  The exact value received from the
client.</dd>
</dl>
<p>For example, the authorization server redirects the user-agent by
sending the following HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb?error=access_denied&amp;state=xyz</pre>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-4.1.2.1">http://tools.ietf.org/html/rfc6749.html#section-4.1.2.1</a> )</p>
</div>
</div>
</div>
</div>
<div class="section" id="issuing-an-access-token">
<span id="oauth-5"></span><h2><a class="toc-backref" href="#id43">5.  Issuing an Access Token</a><a class="headerlink" href="#issuing-an-access-token" title="Permalink to this headline">¶</a></h2>
<p>If the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> request is valid and authorized,
the authorization server issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> and optional <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>
as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a> .</p>
<p>If the request failed client authentication or is invalid,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> returns
an error response as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>(v.30, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-30#section-5">http://tools.ietf.org/html/draft-ietf-oauth-v2-30#section-5</a>)</p>
<div class="section" id="successful-response">
<span id="oauth-5-1"></span><h3><a class="toc-backref" href="#id44">5.1.  Successful Response</a><a class="headerlink" href="#successful-response" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
and optional <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>,
and constructs the response by adding the following parameters
to the entity body of the HTTP response with a 200 (OK) status code:</p>
<dl class="glossary docutils">
<dt id="term-access-token">access_token</dt>
<dd>REQUIRED.
The <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> issued by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</dd>
<dt id="term-token-type">token_type</dt>
<dd>REQUIRED.
The type of the token issued as described in <a class="reference internal" href="#oauth-7-1"><em>Section 7.1</em></a>.
Value is <strong>case insensitive</strong>.</dd>
<dt id="term-expires-in">expires_in</dt>
<dd><p class="first">RECOMMENDED.</p>
<p>The lifetime in <strong>seconds</strong> of the access token.</p>
<p>For example,
the value &#8220;3600&#8221; denotes that
the access token will expire in <strong>one hour</strong>
from the time the response was generated.</p>
<p class="last">If omitted,
the authorization server SHOULD provide
the expiration time via other means or document the default value.</p>
</dd>
<dt id="term-refresh-token">refresh_token</dt>
<dd>OPTIONAL.
The <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> which can be used to obtain new access tokens
using the same authorization grant as described in <a class="reference internal" href="#oauth-6"><em>Section 6</em></a>.</dd>
<dt id="term-42">scope</dt>
<dd>OPTIONAL.
The scope of the access token as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</dd>
</dl>
<p>The parameters are included in the entity body of the HTTP response
using the &#8220;application/json&#8221; media type as defined by [RFC4627].</p>
<p>The parameters are serialized into a JSON structure by adding each parameter
at the highest structure level.
Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers.
The order of parameters does not matter and can vary.</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST include
the HTTP &#8220;<em class="xref std std-term">Cache-Control</em>&#8221; response header field [<a class="reference internal" href="#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>]
with a value of &#8220;<strong>no-store</strong>&#8221;
in any response containing tokens, credentials,
or other sensitive information,
as well as the &#8220;<em class="xref std std-term">Pragma</em>&#8221; response header field [<a class="reference internal" href="#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>]
with a value of &#8220;<strong>no-cache</strong>&#8221;.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "example_parameter":"example_value"
}</pre>
</div>
<p>The client <strong>MUST</strong> ignore unrecognized response parameters in the response.
The sizes of tokens and other values received from the authorization server are left undefined.
The client should avoid making assumptions about value sizes.
The authorization server should document the size of any value it issues.</p>
<p>(v.30, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-30#section-5.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-30#section-5.1</a> )</p>
</div>
<div class="section" id="oauth-5-2">
<span id="id3"></span><h3><a class="toc-backref" href="#id45">5.2. Error Response</a><a class="headerlink" href="#oauth-5-2" title="Permalink to this headline">¶</a></h3>
<p>The authorization server responds with an HTTP 400 (Bad Request)
status code and includes the following parameters with the response:</p>
<blockquote>
<div><dl class="docutils">
<dt>error</dt>
<dd><blockquote class="first">
<div><p>REQUIRED.</p>
<p>A single ASCII [USASCII] error code from the following:</p>
<dl class="docutils">
<dt>invalid_request</dt>
<dd>The request is missing a required parameter,
includes an unsupported parameter value ((other than grant type),
repeats a parameter,
includes multiple credentials,
utilizes more than one mechanism for authenticating the client,
or is otherwise malformed.</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt>invalid_client</dt>
<dd><blockquote class="first">
<div><p>Client authentication failed
(e.g. unknown client,
no client authentication included,
or unsupported authentication method).</p>
<p>The authorization server MAY return an HTTP 401 (Unauthorized) status code
to indicate which HTTP authentication schemes are supported.
If the client attempted to authenticate via the &#8220;<strong>Authorization</strong>&#8221; request header field,
the authorization server MUST respond with an HTTP 401 (Unauthorized) status code,
and include the &#8220;WWW-Authenticate&#8221; response header field matching the authentication scheme used by the client.</p>
</div></blockquote>
<dl class="last docutils">
<dt>invalid_grant</dt>
<dd>The provided authorization grant
(e.g. authorization code,
resource owner credentials,
client credentials) is
invalid,
expired,
revoked,
does not match the redirection URI used in the authorization request,
or was issued to another client.</dd>
<dt>unauthorized_client <a class="footnote-reference" href="#id5" id="id4">[1]</a></dt>
<dd>The authenticated client is not authorized to use this authorization grant type.</dd>
<dt>unsupported_grant_type</dt>
<dd>The authorization grant type is not supported by the authorization server.</dd>
<dt>invalid_scope</dt>
<dd>The requested scope is invalid,
unknown,
malformed, or
exceeds the scope granted by the resource owner.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>error_description</dt>
<dd><p class="first">OPTIONAL.
A human-readable ASCII [USASCII] text
providing additional information,
used to assist the client developer in understanding the error that occurred.</p>
<p>Values for the &#8220;error_description&#8221; parameter MUST NOT include
characters outside the set %x20-21 / %x23-5B / %x5D-7E.</p>
<div class="last highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x20</span><span class="p">,</span><span class="mh">0x22</span><span class="p">)]</span>
<span class="go">[&#39; &#39;, &#39;!&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x23</span><span class="p">,</span><span class="mh">0x5B</span><span class="p">)]</span>
<span class="go">[&#39;#&#39;, &#39;$&#39;, &#39;%&#39;, &#39;&amp;&#39;, &quot;&#39;&quot;, &#39;(&#39;, &#39;)&#39;, &#39;*&#39;, &#39;+&#39;, &#39;,&#39;, &#39;-&#39;, &#39;.&#39;, &#39;/&#39;,</span>
<span class="go">&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;:&#39;, &#39;;&#39;, &#39;&lt;&#39;, &#39;=&#39;, &#39;&gt;&#39;, &#39;?&#39;, &#39;@&#39;,</span>
<span class="go">&#39;A&#39;, &#39;B&#39;, &#39;C&#39;, &#39;D&#39;, &#39;E&#39;, &#39;F&#39;, &#39;G&#39;, &#39;H&#39;, &#39;I&#39;, &#39;J&#39;, &#39;K&#39;, &#39;L&#39;, &#39;M&#39;, &#39;N&#39;,</span>
<span class="go">&#39;O&#39;, &#39;P&#39;, &#39;Q&#39;, &#39;R&#39;, &#39;S&#39;, &#39;T&#39;, &#39;U&#39;, &#39;V&#39;, &#39;W&#39;, &#39;X&#39;, &#39;Y&#39;, &#39;Z&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span> <span class="nb">chr</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mh">0x5D</span><span class="p">,</span><span class="mh">0x7E</span><span class="p">)]</span>
<span class="go">[&#39;]&#39;, &#39;^&#39;, &#39;_&#39;, &#39;`&#39;,</span>
<span class="go">&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;, &#39;l&#39;, &#39;m&#39;, &#39;n&#39;,</span>
<span class="go">&#39;o&#39;, &#39;p&#39;, &#39;q&#39;, &#39;r&#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;v&#39;, &#39;w&#39;, &#39;x&#39;, &#39;y&#39;, &#39;z&#39;, &#39;{&#39;, &#39;|&#39;, &#39;}&#39;]</span>
</pre></div>
</div>
</dd>
<dt>error_uri</dt>
<dd><p class="first">OPTIONAL.</p>
<p>A URI identifying a human-readable web page
with information about the error,
used to provide the client developer with additional information about the error.</p>
<p class="last">Values for the &#8220;error_uri&#8221; parameter MUST conform to the URI-
Reference syntax, and thus MUST NOT include characters outside
the set %x21 / %x23-5B / %x5D-7E.</p>
</dd>
</dl>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[1]</a></td><td>&#8220;client credentials&#8221; is handled by &#8220;invalid_grant&#8221; error. What exactly &#8220;unauthorized_client&#8221; mean?</td></tr>
</tbody>
</table>
<p>The parameters are included in the entity body of the HTTP response
using the &#8220;application/json&#8221; media type as defined by [RFC4627].
The parameters are serialized into a JSON structure by adding each parameter
at the highest structure level.
Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers.
The order of parameters does not matter and can vary.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "error":"invalid_request"
}</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="messages.html#messages-2-2-4"><em>2.2.4.  Token Error Response</em></a></li>
</ul>
</div>
<p>(draft 31, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-5.2">http://tools.ietf.org/html/draft-ietf-oauth-v2-31#section-5.2</a>)</p>
</div>
</div>
<div class="section" id="refreshing-an-access-token">
<span id="oauth-refreshing-an-access-token"></span><span id="oauth-6"></span><h2><a class="toc-backref" href="#id46">6. Refreshing an Access Token</a><a class="headerlink" href="#refreshing-an-access-token" title="Permalink to this headline">¶</a></h2>
<p>If the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issued a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> to the client,
the client makes a refresh request to the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>
by adding the following parameters using the &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221; format
per Appendix B
with a character encoding of UTF-8 in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-grant-type">grant_type</dt>
<dd>REQUIRED.  Value MUST be set to &#8220;refresh_token&#8221;.</dd>
<dt id="term-44">refresh_token</dt>
<dd>REQUIRED.  The refresh token issued to the client.</dd>
<dt id="term-45">scope</dt>
<dd><p class="first">OPTIONAL.</p>
<p>The <a class="reference internal" href="uma_core.html#term-scope"><em class="xref std std-term">scope</em></a> of the access request as described by <em class="xref std std-ref">Section 3.3</em>.</p>
<p class="last">The requested scope MUST NOT include any scope not originally granted by the resource owner,
and if omitted is treated as equal to the scope originally granted by the resource owner.</p>
</dd>
</dl>
<p>Because refresh tokens are typically long-lasting credentials used to
request additional access tokens,
the refresh token is bound to the client to which it was issued.</p>
<p>If the client type is confidential or the client was issued client credentials
(or assigned other authentication requirements),
the client MUST authenticate with the authorization server
as described in <em class="xref std std-ref">Section 3.2.1</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Refreshing tokens require the <strong>Client Authentication</strong>.</li>
</ul>
</div>
<p>For example, the client makes the following HTTP request using
transport-layer security (with extra line breaks for display purposes
only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Above sample uess the Basic Authentication</li>
</ul>
</div>
<p>The authorization server MUST:</p>
<ul class="simple">
<li>require <em class="xref std std-ref">client authentication</em>
for <em class="xref std std-term">confidential clients</em> or
for any client that was issued client credentials
(or with other authentication requirements),</li>
<li>authenticate the client if <em class="xref std std-ref">client authentication</em> is included and
ensure that the <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> was issued to the authenticated client, and</li>
<li>validate the refresh token.</li>
</ul>
<p>If valid and authorized,
the authorization server issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> as described in <em class="xref std std-ref">Section 5.1</em>.
If the request failed verification or is invalid,
the authorization server returns an error response as described in <em class="xref std std-ref">Section 5.2</em>.</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY issue a new refresh token,
in which case the client MUST discard the old refresh token
and replace it with the new refresh token.
The authorization server MAY revoke the old refresh token
after issuing a new refresh token to the client.
If a new refresh token is issued,
the refresh token <a class="reference internal" href="uma_core.html#term-scope"><em class="xref std std-term">scope</em></a> MUST be identical to
that of the refresh token included by the client in the request.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>scope of refresh tokens = scope in authorization request</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6749.html#section-6">http://tools.ietf.org/html/rfc6749.html#section-6</a> )</p>
</div>
<div class="section" id="accessing-protected-resources">
<span id="oauth-7"></span><h2><a class="toc-backref" href="#id47">7. Accessing Protected Resources</a><a class="headerlink" href="#accessing-protected-resources" title="Permalink to this headline">¶</a></h2>
<p>The client accesses protected resources by presenting the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> to the resource server.
The resource server MUST validate the access token and ensure it has not expired
and that its scope covers the requested resource.</p>
<p>The methods used by the resource server to validate the access token (as well as any error responses) are beyond the scope of this specification,
but generally involve an interaction or coordination between the resource server and the authorization server.</p>
<p>The method in which the client utilized the access token to authenticate with the resource server
depends on the type of access token issued by the authorization server.
Typically, it involves using the HTTP &#8220;Authorization&#8221; request header field [<span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2617.html"><strong>RFC 2617</strong></a>]
with an authentication scheme defined by the access token type specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>v21</li>
<li><strong>Access Token</strong> Valication.  Expiry and Scope.</li>
<li>Authroization header is <strong>typicall</strong> method</li>
</ul>
</div>
<p>(v22)</p>
<div class="section" id="access-token-types">
<span id="oauth-7-1"></span><h3><a class="toc-backref" href="#id48">7.1. Access Token Types</a><a class="headerlink" href="#access-token-types" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">&#8220;token_type&#8221; is one of  &#8220;bearer&#8221; or &#8220;mac&#8221; as of Draft 22 of OAuth2</p>
</div>
<p>The <strong>access token type</strong> provides the client
with the information required to successfully utilize the access token to make a protected resource request
(along with type-specific attributes).
The client MUST NOT use an access token if it does not understand or does not trust the token type.</p>
<p>For example, the <strong>&#8220;bearer&#8221;</strong> token type defined in
[<a class="reference internal" href="bearer.html"><em>I-D.ietf-oauth-v2-bearer</em></a>] is utilized by simply including the access token string in the request:</p>
<div class="highlight-python"><pre>GET /resource/1 HTTP/1.1
Host: example.com
Authorization: Bearer 7Fjfp0ZBr1KtDRbnfVdmIw</pre>
</div>
<p>while the <strong>&#8220;mac&#8221;</strong> token type defined in [I-D.ietf-oauth-v2-http-mac] is
utilized by issuing a MAC key together with the access token
which is used to sign certain components of the HTTP requests:</p>
<div class="highlight-python"><pre>GET /resource/1 HTTP/1.1
Host: example.com
Authorization: MAC id="h480djs93hd8",
                   nonce="274312:dj83hs9s",
                   mac="kDZvddkndxvhGRXZhvuDjEWhGeE="</pre>
</div>
<p>The above examples are provided for illustration purposes only.</p>
<p>Developers are advised to consult the [<a class="reference internal" href="bearer.html"><em>I-D.ietf-oauth-v2-bearer</em></a>] and
[I-D.ietf-oauth-v2-http-mac] specifications before use.</p>
<p>Each access token type definition specifies the additional attributes
(if any) sent to the client together with the &#8220;<a class="reference internal" href="#term-access-token"><em class="xref std std-term">access_token</em></a>&#8221; response parameter.</p>
<p>It also defines the HTTP authentication method used to
include the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> when making a <em class="xref std std-term">protected resource request</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>v22</li>
<li>OAuth only specify that access_token with token_type MUST be given to the protected resource endpoint.</li>
</ul>
</div>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="extensibility">
<span id="oauth-8"></span><h2><a class="toc-backref" href="#id49">8. Extensibility</a><a class="headerlink" href="#extensibility" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="defining-new-authorization-endpoint-response-types">
<span id="oauth-8-4"></span><h3><a class="toc-backref" href="#id50">8.4. Defining New Authorization Endpoint Response Types</a><a class="headerlink" href="#defining-new-authorization-endpoint-response-types" title="Permalink to this headline">¶</a></h3>
<p>New <a class="reference internal" href="glossary.html#term-response-types"><em class="xref std std-term">response types</em></a> for use with the <a class="reference internal" href="oauth_responses.html#term-authorization-endpoint"><em class="xref std std-term">authorization endpoint</em></a>
are defined and registered in the <a class="reference internal" href="oauth_responses.html#term-authorization-endpoint-response-type-registry"><em class="xref std std-term">authorization endpoint response type registry</em></a>
following the procedure in <a class="reference internal" href="#oauth-11-3"><em>Section 11.3</em></a>.
<em class="xref std std-term">Response type names</em> MUST conform to the response-type <em class="xref std std-term">ABNF</em>.</p>
<div class="highlight-python"><pre>response-type  = response-name *( SP response-name )
response-name  = 1*response-char
response-char  = "_" / DIGIT / ALPHA</pre>
</div>
<p>If a <a class="reference internal" href="oauth_responses.html#term-response-type"><em class="xref std std-term">response type</em></a> contains one of more space characters (%x20),
it is compared as a space-delimited list of values
in which the order of values does not matter.
Only one order of values can be registered,
which covers all other arrangements of the same set of values.</p>
<p>For example,
the response type &#8220;token code&#8221; is left undefined by this specification.
However,
an extension can define and register the &#8220;token code&#8221; response type.
Once registered,
the same combination cannot be registered as &#8220;code token&#8221;,
but both values can be used to denote the same response type.</p>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="native-applications">
<span id="oauth-9"></span><h2><a class="toc-backref" href="#id51">9.  Native Applications</a><a class="headerlink" href="#native-applications" title="Permalink to this headline">¶</a></h2>
<p>Native applications are clients installed and executed on the device
used by the resource owner (i.e. desktop application, native mobile
application).  Native applications require special consideration
related to security, platform capabilities, and overall end-user
experience.</p>
<p>The authorization endpoint requires interaction between the client
and the resource owner&#8217;s user-agent.  Native applications can invoke
an external user-agent or embed a user-agent within the application.
For example:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  External user-agent - the native application can capture the</dt>
<dd>response from the authorization server using a redirection URI
with a scheme registered with the operating system to invoke the
client as the handler, manual copy-and-paste of the credentials,
running a local web server, installing a user-agent extension, or
by providing a redirection URI identifying a server-hosted
resource under the client&#8217;s control, which in turn makes the
response available to the native application.</dd>
<dt>o  Embedded user-agent - the native application obtains the response</dt>
<dd>by directly communicating with the embedded user-agent by
monitoring state changes emitted during the resource load, or
accessing the user-agent&#8217;s cookies storage.</dd>
</dl>
</div></blockquote>
<p>When choosing between an external or embedded user-agent, developers
should consider:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  External user-agents may improve completion rate as the resource</dt>
<dd>owner may already have an active session with the authorization
server removing the need to re-authenticate.  It provides a
familiar end-user experience and functionality.  The resource
owner may also rely on user-agent features or extensions to assist
with authentication (e.g. password manager, 2-factor device
reader).</dd>
<dt>o  Embedded user-agents may offer improved usability, as they remove</dt>
<dd>the need to switch context and open new windows.</dd>
<dt>o  Embedded user-agents pose a security challenge because resource</dt>
<dd>owners are authenticating in an unidentified window without access
to the visual protections found in most external user-agents.
Embedded user-agents educate end-user to trust unidentified
requests for authentication (making phishing attacks easier to
execute).</dd>
</dl>
</div></blockquote>
<p>When choosing between the implicit grant type and the authorization
code grant type, the following should be considered:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  Native applications that use the authorization code grant type</dt>
<dd>SHOULD do so without using client credentials, due to the native
application&#8217;s inability to keep <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> confidential.</dd>
<dt>o  When using the implicit grant type flow a refresh token is not</dt>
<dd>returned which requires repeating the authorization process once
the access token expires.</dd>
</dl>
</div></blockquote>
<p>(v.23)</p>
</div>
<div class="section" id="security-considerations">
<span id="oauth-10"></span><h2><a class="toc-backref" href="#id52">10. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>As a flexible and extensible framework, OAuth&#8217;s security considerations depend on many factors.
The following sections provide implementers with security guidelines
focused on the three client profiles described in Section 2.1: web application,
user-agent-based application, and native application.</p>
<p>A comprehensive OAuth security model and analysis,
as well as background for the protocol design is provided by [I-D.ietf-oauth-v2-threatmodel].</p>
</div>
<div class="section" id="iana-considerations">
<span id="oauth-11"></span><h2><a class="toc-backref" href="#id53">11.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="the-oauth-parameters-registry">
<span id="oauth-11-2"></span><h3><a class="toc-backref" href="#id54">11.2.  The OAuth Parameters Registry</a><a class="headerlink" href="#the-oauth-parameters-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the OAuth parameters registry.</p>
<p>Additional parameters for inclusion in
the <a class="reference internal" href="glossary.html#term-authorization-endpoint-request"><em class="xref std std-term">authorization endpoint request</em></a>,
the <a class="reference internal" href="glossary.html#term-authorization-endpoint-response"><em class="xref std std-term">authorization endpoint response</em></a>,
the <a class="reference internal" href="glossary.html#term-token-endpoint-request"><em class="xref std std-term">token endpoint request</em></a>, or
the <a class="reference internal" href="glossary.html#term-token-endpoint-response"><em class="xref std std-term">token endpoint response</em></a> are registered
on the advice of one or more <a class="reference internal" href="glossary.html#term-designated-experts"><em class="xref std std-term">Designated Experts</em></a>
(appointed by the IESG or their delegate),
with a <a class="reference internal" href="glossary.html#term-specification-required"><em class="xref std std-term">Specification Required</em></a> (using terminology from [<a class="reference internal" href="#term-rfc5226"><em class="xref std std-term">RFC5226</em></a>]).</p>
<p>However,
to allow for the allocation of values prior to publication,
the <a class="reference internal" href="glossary.html#term-designated-experts"><em class="xref std std-term">Designated Expert(s)</em></a> may approve registration
once they are satisfied that such a specification will be published.</p>
<p>Registration requests should be sent to the <strong>[TBD]&#64;ietf.org</strong> mailing list
for review and comment,
with an appropriate subject (e.g., &#8220;Request for parameter: example&#8221;).
[[ Note to RFC-EDITOR:
The name of the mailing list should be determined in consultation
with the <a class="reference internal" href="glossary.html#term-iesg"><em class="xref std std-term">IESG</em></a> and <a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a>.
Suggested name: <strong>oauth-ext-review</strong>. ]]</p>
<p>Within at most 14 days of the request, the
Designated Expert(s) will either approve
or deny the registration request,
communicating this decision to the review list and <a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a>.
Denials should include an explanation and,
if applicable, suggestions as to how to make the request successful.</p>
<p>Decisions (or lack thereof) made by the Designated Expert(s)
can be first appealed to <em class="xref std std-term">Application Area Directors</em>
(contactable using <a class="reference external" href="mailto:app-ads&#37;&#52;&#48;tools&#46;ietf&#46;org">app-ads<span>&#64;</span>tools<span>&#46;</span>ietf<span>&#46;</span>org</a> email address
or directly by looking up their email addresses on <a class="reference external" href="http://www.iesg.org/">http://www.iesg.org/</a> website)
and, if the appellant is not satisfied with the response,
to the full <a class="reference internal" href="glossary.html#term-iesg"><em class="xref std std-term">IESG</em></a> (using the <a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list).</p>
<p><a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a> should only accept registry updates from the Designated Expert(s),
and should direct all requests for registration to the review mailing list.</p>
<p>(v.22)</p>
</div>
<div class="section" id="the-oauth-authorization-endpoint-response-type-registry">
<span id="oauth-11-3"></span><h3><a class="toc-backref" href="#id55">11.3. The OAuth Authorization Endpoint Response Type Registry</a><a class="headerlink" href="#the-oauth-authorization-endpoint-response-type-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the OAuth authorization endpoint
response type registry.</p>
<p>Additional response type for use with the authorization endpoint are
registered on the advice of one or more Designated Experts (appointed
by the IESG or their delegate), with a Specification Required (using
terminology from [RFC5226]).  However, to allow for the allocation of
values prior to publication, the Designated Expert(s) may approve
registration once they are satisfied that such a specification will
be published.</p>
<p>Registration requests should be sent to the [TBD]&#64;ietf.org mailing
list for review and comment, with an appropriate subject (e.g.,
&#8220;Request for response type: example&#8221;). [[ Note to RFC-EDITOR: The
name of the mailing list should be determined in consultation with
the IESG and IANA.  Suggested name: oauth-ext-review. ]]</p>
<p>Within at most 14 days of the request, the Designated Expert(s) will
either approve or deny the registration request, communicating this
decision to the review list and IANA.  Denials should include an
explanation and, if applicable, suggestions as to how to make the
request successful.</p>
<p>Decisions (or lack thereof) made by the Designated Expert(s) can be
first appealed to Application Area Directors (contactable using
<a class="reference external" href="mailto:app-ads&#37;&#52;&#48;tools&#46;ietf&#46;org">app-ads<span>&#64;</span>tools<span>&#46;</span>ietf<span>&#46;</span>org</a> email address or directly by looking up their
email addresses on <a class="reference external" href="http://www.iesg.org/">http://www.iesg.org/</a> website) and, if the
appellant is not satisfied with the response, to the full IESG (using
the <a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list).</p>
<p>IANA should only accept registry updates from the Designated
Expert(s), and should direct all requests for registration to the
review mailing list.</p>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="references">
<span id="oauth-13"></span><span id="oauth-11-4"></span><h2><a class="toc-backref" href="#id56">13.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="normative-references">
<span id="oauth-13-1"></span><h3><a class="toc-backref" href="#id57">13.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2246">RFC2246</dt>
<dd>Dierks, T. and C. Allen, &#8220;The TLS Protocol Version 1.0&#8221;,
RFC 2246, January 1999.</dd>
<dt id="term-rfc2616">RFC2616</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
Masinter, L., Leach, P., and T. Berners-Lee, &#8220;Hypertext
Transfer Protocol &#8211; HTTP/1.1&#8221;, RFC 2616, June 1999.</dd>
<dt id="term-rfc2617">RFC2617</dt>
<dd>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
Leach, P., Luotonen, A., and L. Stewart, &#8220;HTTP
Authentication: Basic and Digest Access Authentication&#8221;,
RFC 2617, June 1999.</dd>
<dt id="term-rfc2818">RFC2818</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-rfc4627">RFC4627</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4949">RFC4949</dt>
<dd>Shirey, R., &#8220;Internet Security Glossary, Version 2&#8221;,
RFC 4949, August 2007.</dd>
<dt id="term-rfc5226">RFC5226</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc5234">RFC5234</dt>
<dd>Crocker, D. and P. Overell, &#8220;Augmented BNF for Syntax
Specifications: ABNF&#8221;, STD 68, RFC 5234, January 2008.</dd>
<dt id="term-rfc5246">RFC5246</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-w3c-rec-html401-19991224">W3C.REC-html401-19991224</dt>
<dd>Hors, A., Raggett, D., and I. Jacobs, &#8220;HTML 4.01
Specification&#8221;, World Wide Web Consortium
Recommendation REC-html401-19991224, December 1999,
&lt;<a class="reference external" href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.</dd>
</dl>
<p>(v.22)</p>
</div>
<div class="section" id="informative-references">
<span id="oauth-13-2"></span><h3><a class="toc-backref" href="#id58">13.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-draft-hardt-oauth-01">I-D.draft-hardt-oauth-01</dt>
<dd>Hardt, D., Ed., Tom, A., Eaton, B., and Y. Goland, &#8220;OAuth
Web Resource Authorization Profiles&#8221;, January 2010.</dd>
<dt id="term-i-d-ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</dt>
<dd>Mortimore, C., &#8220;SAML 2.0 Bearer Assertion Profiles for
OAuth 2.0&#8221;, draft-ietf-oauth-saml2-bearer-08 (work in
progress), August 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-bearer">I-D.ietf-oauth-v2-bearer</dt>
<dd>Jones, M., Hardt, D., and D. Recordon, &#8220;The OAuth 2.0
Protocol: Bearer Tokens&#8221;, draft-ietf-oauth-v2-bearer-08
(work in progress), July 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-http-mac">I-D.ietf-oauth-v2-http-mac</dt>
<dd>Hammer-Lahav, E., Barth, A., and B. Adida, &#8220;HTTP
Authentication: MAC Access Authentication&#8221;,
draft-ietf-oauth-v2-http-mac-00 (work in progress),
May 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-threatmodel">I-D.ietf-oauth-v2-threatmodel</dt>
<dd>Lodderstedt, T., McGloin, M., and P. Hunt, &#8220;OAuth 2.0
Threat Model and Security Considerations&#8221;,
draft-ietf-oauth-v2-threatmodel-00 (work in progress),
July 2011.</dd>
<dt id="term-oasis-saml-core-2-0-os">OASIS.saml-core-2.0-os</dt>
<dd>Cantor, S., Kemp, J., Philpott, R., and E. Maler,
&#8220;Assertions and Protocol for the OASIS Security Assertion
Markup Language (SAML) V2.0&#8221;, OASIS Standard saml-core-
2.0-os, March 2005.</dd>
<dt id="term-rfc5849">RFC5849</dt>
<dd>Hammer-Lahav, E., &#8220;The OAuth 1.0 Protocol&#8221;, RFC 5849,
April 2010.</dd>
</dl>
<p>(v.22)</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Digital Identity</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_assertion.html">OAuth 2.0 Assertion Profile</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>