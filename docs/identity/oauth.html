

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The OAuth 2.0 Authorization Protocol &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth 2.0 Assertion Profile" href="oauth_assertion.html" />
    <link rel="prev" title="Digital Identity" href="index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>The OAuth 2.0 Authorization Protocol</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Digital Identity</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_assertion.html">OAuth 2.0 Assertion Profile</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="the-oauth-2-0-authorization-protocol">
<h1><a class="toc-backref" href="#id25">The OAuth 2.0 Authorization Protocol</a><a class="headerlink" href="#the-oauth-2-0-authorization-protocol" title="Permalink to this headline">¶</a></h1>
<p>Based on <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-26">The OAuth 2.0 Authorization Protocol draft-ietf-oauth-v2-22</a></p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p>Checke the Draft 26.-  May 1, 2012</p>
<blockquote class="last">
<div><ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-26">http://tools.ietf.org/html/draft-ietf-oauth-v2-26</a></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="abstract">
<span id="oauth-abstract"></span><h2><a class="toc-backref" href="#id26">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>The OAuth 2.0 authorization protocol enables a third-party application
to obtain limited access to an HTTP service,
either on behalf of a <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> by orchestrating an approval interaction
between the resource owner and the HTTP service,
or by allowing the third-party application to obtain access on its own behalf.
This specification replaces and obsoletes the OAuth 1.0 protocol described in RFC 5849.</p>
<p>(v.22)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-oauth-2-0-authorization-protocol" id="id25">The OAuth 2.0 Authorization Protocol</a><ul>
<li><a class="reference internal" href="#abstract" id="id26">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id27">1.  Introduction</a><ul>
<li><a class="reference internal" href="#roles" id="id28">1.1. Roles</a></li>
<li><a class="reference internal" href="#protocol-flow" id="id29">1.2.  Protocol Flow</a><ul>
<li><a class="reference internal" href="#figure-1-abstract-protocol-flow" id="id30">Figure 1: Abstract Protocol Flow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-grant" id="id31">1.3. Authorization Grant</a><ul>
<li><a class="reference internal" href="#authorization-code" id="id32">1.3.1.  Authorization Code</a></li>
<li><a class="reference internal" href="#implicit" id="id33">1.3.2.  Implicit</a></li>
<li><a class="reference internal" href="#resource-owner-password-credentials" id="id34">1.3.3. Resource Owner Password Credentials</a></li>
<li><a class="reference internal" href="#client-credentials" id="id35">1.3.4. Client Credentials</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token" id="id36">1.4.  Access Token</a></li>
<li><a class="reference internal" href="#refresh-token" id="id37">1.5.  Refresh Token</a><ul>
<li><a class="reference internal" href="#figure-2-refreshing-an-expired-access-token" id="id38">Figure 2: Refreshing an Expired Access Token</a></li>
</ul>
</li>
<li><a class="reference internal" href="#notational-conventions" id="id39">1.6.  Notational Conventions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#client-registration" id="id40">2.  Client Registration</a><ul>
<li><a class="reference internal" href="#client-types" id="id41">2.1. Client Types</a></li>
<li><a class="reference internal" href="#client-identifier" id="id42">2.2.  Client Identifier</a></li>
<li><a class="reference internal" href="#client-authentication" id="id43">2.3.  Client Authentication</a><ul>
<li><a class="reference internal" href="#client-password" id="id44">2.3.1.  Client Password</a></li>
<li><a class="reference internal" href="#other-authentication-methods" id="id45">2.3.2.  Other Authentication Methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#unregistered-clients" id="id46">2.4. Unregistered Clients</a></li>
</ul>
</li>
<li><a class="reference internal" href="#protocol-endpoints" id="id47">3. Protocol Endpoints</a><ul>
<li><a class="reference internal" href="#authorization-endpoint" id="id48">3.1. Authorization Endpoint</a><ul>
<li><a class="reference internal" href="#response-type" id="id49">3.1.1. Response Type</a></li>
<li><a class="reference internal" href="#redirection-endpoint" id="id50">3.1.2. Redirection Endpoint</a><ul>
<li><a class="reference internal" href="#endpoint-request-confidentiality" id="id51">3.1.2.1.  Endpoint Request Confidentiality</a></li>
<li><a class="reference internal" href="#registration-requirements" id="id52">3.1.2.2.  Registration Requirements</a></li>
<li><a class="reference internal" href="#dynamic-configuration" id="id53">3.1.2.3.  Dynamic Configuration</a></li>
<li><a class="reference internal" href="#invalid-endpoint" id="id54">3.1.2.4.  Invalid Endpoint</a></li>
<li><a class="reference internal" href="#endpoint-content" id="id55">3.1.2.5.  Endpoint Content</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#token-endpoint" id="id56">3.2. Token Endpoint</a><ul>
<li><a class="reference internal" href="#oauth-3-2-1" id="id57">3.2.1. Client Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token-scope" id="id58">3.3. Access Token Scope</a></li>
</ul>
</li>
<li><a class="reference internal" href="#obtaining-authorization" id="id59">4.  Obtaining Authorization</a><ul>
<li><a class="reference internal" href="#authorization-code-grant" id="id60">4.1.  Authorization Code Grant</a><ul>
<li><a class="reference internal" href="#authorization-request" id="id61">4.1.1. Authorization Request</a></li>
<li><a class="reference internal" href="#authorization-response" id="id62">4.1.2. Authorization Response</a><ul>
<li><a class="reference internal" href="#error-response" id="id63">4.1.2.1. Error Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token-request" id="id64">4.1.3.  Access Token Request</a></li>
<li><a class="reference internal" href="#access-token-response" id="id65">4.1.4. Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implicit-grant" id="id66">4.2.  Implicit Grant</a><ul>
<li><a class="reference internal" href="#oauth-4-2-1" id="id67">4.2.1. Authorization Request</a></li>
<li><a class="reference internal" href="#oauth-4-2-2" id="id68">4.2.2. Access Token Response</a><ul>
<li><a class="reference internal" href="#oauth-4-2-2-1" id="id69">4.2.2.1. Error Response</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#oauth-4-3" id="id70">4.3.  Resource Owner Password Credentials</a><ul>
<li><a class="reference internal" href="#authorization-request-and-response" id="id71">4.3.1.  Authorization Request and Response</a></li>
<li><a class="reference internal" href="#oauth-4-3-2" id="id72">4.3.2.  Access Token Request</a></li>
<li><a class="reference internal" href="#oauth-4-3-3" id="id73">4.3.3.  Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#oauth-4-4" id="id74">4.4.  Client Credentials</a><ul>
<li><a class="reference internal" href="#oauth-4-4-1" id="id75">4.4.1. Authorization Request and Response</a></li>
<li><a class="reference internal" href="#oauth-4-4-2" id="id76">4.4.2. Access Token Request</a></li>
<li><a class="reference internal" href="#oauth-4-4-3" id="id77">4.4.3. Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extensions" id="id78">4.5.  Extensions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#issuing-an-access-token" id="id79">5.  Issuing an Access Token</a><ul>
<li><a class="reference internal" href="#successful-response" id="id80">5.1.  Successful Response</a></li>
<li><a class="reference internal" href="#oauth-5-2" id="id81">5.2. Error Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#refreshing-an-access-token" id="id82">6.  Refreshing an Access Token</a></li>
<li><a class="reference internal" href="#accessing-protected-resources" id="id83">7. Accessing Protected Resources</a><ul>
<li><a class="reference internal" href="#access-token-types" id="id84">7.1. Access Token Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extensibility" id="id85">8. Extensibility</a><ul>
<li><a class="reference internal" href="#defining-new-authorization-endpoint-response-types" id="id86">8.4. Defining New Authorization Endpoint Response Types</a></li>
</ul>
</li>
<li><a class="reference internal" href="#native-applications" id="id87">9.  Native Applications</a></li>
<li><a class="reference internal" href="#security-considerations" id="id88">10. Security Considerations</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id89">11.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#the-oauth-parameters-registry" id="id90">11.2.  The OAuth Parameters Registry</a></li>
<li><a class="reference internal" href="#the-oauth-authorization-endpoint-response-type-registry" id="id91">11.3. The OAuth Authorization Endpoint Response Type Registry</a></li>
<li><a class="reference internal" href="#the-oauth-extensions-error-registry" id="id92">11.4. The OAuth Extensions Error Registry</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id93">13.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id94">13.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id95">13.2.  Informative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-1"></span><h2><a class="toc-backref" href="#id27">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In the traditional client-server authentication model,
the client requests an access restricted resource (protected resource)
on the server by authenticating with the server
using the resource owner&#8217;s credentials.</p>
<p>In order to provide third-party applications access to restricted resources,
the resource owner shares its credentials with the third-party.</p>
<p>This creates several problems and limitations:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  Third-party applications are required to store the resource</dt>
<dd>owner&#8217;s credentials for future use, typically a password in clear-text.</dd>
<dt>o  Servers are required to support password authentication, despite</dt>
<dd>the security weaknesses created by passwords.</dd>
<dt>o  Third-party applications gain overly broad access to the resource</dt>
<dd>owner&#8217;s protected resources, leaving resource owners without any
ability to restrict duration or access to a limited subset of
resources.</dd>
<dt>o  Resource owners cannot revoke access to an individual third-party</dt>
<dd>without revoking access to all third-parties, and must do so by
changing their password.</dd>
<dt>o  Compromise of any third-party application results in compromise of</dt>
<dd>the end-user&#8217;s password and all of the data protected by that
password.</dd>
</dl>
</div></blockquote>
<p>OAuth addresses these issues by introducing an authorization layer
and separating the role of the client from that of the resource owner.
In OAuth,
the client requests access to resources controlled by the resource owner
and hosted by the resource server,
and is issued a different set of credentials than those of the resource owner.</p>
<p>Instead of using the resource owner&#8217;s credentials to access protected resources,
the client obtains an access token -
a string denoting a specific scope, lifetime, and other access attributes.
<a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">Access tokens</em></a> are issued to third-party clients
by an authorization server with the approval of the resource owner.
The client uses the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> to access the protected resources
hosted by the resource server.</p>
<p>For example, an <a class="reference internal" href="messages.html#term-end-user"><em class="xref std std-term">end-user</em></a> (<a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>) can grant
a printing service (<a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>) access to her protected photos stored
at a photo sharing service (<a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>),
without sharing her username and password with the printing service.</p>
<p>Instead, she authenticates directly with a server
trusted by the photo sharing service (<a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>)
which issues the printing service delegation-specific credentials (<a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>).</p>
<p>This specification is designed for use with HTTP [<a class="reference internal" href="standard.html#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>].
The use of OAuth with any transport protocol other than HTTP is undefined.</p>
<p>(v.22)</p>
<div class="section" id="roles">
<span id="oauth-1-1"></span><h3><a class="toc-backref" href="#id28">1.1. Roles</a><a class="headerlink" href="#roles" title="Permalink to this headline">¶</a></h3>
<p>OAuth defines four roles:</p>
<dl class="glossary docutils">
<dt id="term-resource-owner">resource owner</dt>
<dd>An entity capable of granting access to a protected resource (e.g.
end-user).</dd>
<dt id="term-resource-server">resource server</dt>
<dd>The server hosting the protected resources, capable of accepting
and responding to protected resource requests using access tokens.</dd>
<dt id="term-client">client</dt>
<dd>An application making protected resource requests on behalf of the
resource owner and with its authorization.</dd>
<dt id="term-authorization-server">authorization server</dt>
<dd>The server issuing access tokens to the client after successfully
authenticating the resource owner and obtaining authorization.</dd>
</dl>
<p>The interaction between the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> and term:<cite>resource server</cite>
is beyond the scope of this specification.
The authorization server may be the same server as the resource server or a separate entity.
A single authorization server may issue <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> accepted by multiple resource servers.</p>
<p>(v.22)</p>
</div>
<div class="section" id="protocol-flow">
<span id="oauth-1-2"></span><h3><a class="toc-backref" href="#id29">1.2.  Protocol Flow</a><a class="headerlink" href="#protocol-flow" title="Permalink to this headline">¶</a></h3>
<div class="section" id="figure-1-abstract-protocol-flow">
<span id="oauth-figure-1"></span><h4><a class="toc-backref" href="#id30">Figure 1: Abstract Protocol Flow</a><a class="headerlink" href="#figure-1-abstract-protocol-flow" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><pre>+--------+                               +---------------+
|        |--(A)- Authorization Request -&gt;|   Resource    |
|        |                               |     Owner     |
|        |&lt;-(B)-- Authorization Grant ---|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(C)-- Authorization Grant --&gt;| Authorization |
| Client |                               |     Server    |
|        |&lt;-(D)----- Access Token -------|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(E)----- Access Token ------&gt;|    Resource   |
|        |                               |     Server    |
|        |&lt;-(F)--- Protected Resource ---|               |
+--------+                               +---------------+</pre>
</div>
<p>The abstract flow illustrated in Figure 1 describes the interaction
between the four <a class="reference internal" href="#oauth-1-1"><em>roles</em></a> and includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> requests authorization from the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
The <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a> can be made directly to the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>
(as shown), or preferably indirectly via the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> as an intermediary.</li>
<li>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> receives an <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a> which is a credential
representing the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s authorization, expressed using
one of four <a class="reference internal" href="glossary.html#term-grant-types"><em class="xref std std-term">grant types</em></a> defined in this specification or using
an extension <a class="reference internal" href="glossary.html#term-grant-type"><em class="xref std std-term">grant type</em></a>.  The <a class="reference internal" href="glossary.html#term-authorization-grant-type"><em class="xref std std-term">authorization grant type</em></a> depends
on the method used by the client to request authorization and
the types supported by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</li>
<li>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> requests an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> by authenticating with the
<a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> and presenting the <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>.</li>
<li>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> authenticates the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> and validates
the <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>, and if valid issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.</li>
<li>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> requests the <a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a> from the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>
and authenticates by presenting the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.</li>
<li>The <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a> validates the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>, and if valid,
serves the request.</li>
</ol>
</div></blockquote>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="authorization-grant">
<span id="oauth-1-3"></span><h3><a class="toc-backref" href="#id31">1.3. Authorization Grant</a><a class="headerlink" href="#authorization-grant" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-authorization-grant">Authorization Grant</dt>
<dd>An authorization grant is a <strong>credential representing</strong>
the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s authorization
(to access its <a class="reference internal" href="uma_core.html#term-protected-resource"><em class="xref std std-term">protected resources</em></a>)
used by the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.
This specification defines <strong>four grant types</strong>:
<a class="reference internal" href="#oauth-1-3-1"><em>authorization code</em></a>,
<a class="reference internal" href="#oauth-1-3-2"><em>implicit</em></a>,
<a class="reference internal" href="#oauth-1-3-3"><em>resource owner password credentials</em></a>, and
<a class="reference internal" href="#oauth-1-3-4"><em>client credentials</em></a>,
as well as an <a class="reference internal" href="#oauth-4-5"><em>extensibility mechanism for defining additional types</em></a>.</dd>
</dl>
<p>(v.22)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">1.3 used to be 1.5 in v.20.</p>
</div>
<div class="section" id="authorization-code">
<span id="oauth-1-3-1"></span><h4><a class="toc-backref" href="#id32">1.3.1.  Authorization Code</a><a class="headerlink" href="#authorization-code" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a> is obtained by using an <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
as an intermediary between the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> and <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
Instead of requesting authorization directly from the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> directs the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> to an <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
(via its user-agent as defined in [<a class="reference internal" href="standard.html#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>]),
which in turn directs the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> back
to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> with the <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a>.</p>
<p>Before directing the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> back to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
with the <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a>,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> authenticates the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> and obtains authorization.
Because the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> only authenticates with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>,
the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s credentials are never shared with the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.</p>
<p>The <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a> provides a few important security benefits
such as the ability to authenticate the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>,
and the transmission of the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> directly to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
without passing it through the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s user-agent,
potentially exposing it to others, including the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.</p>
<p>(v.22)</p>
</div>
<div class="section" id="implicit">
<span id="oauth-1-3-2"></span><h4><a class="toc-backref" href="#id33">1.3.2.  Implicit</a><a class="headerlink" href="#implicit" title="Permalink to this headline">¶</a></h4>
<p>The <a class="reference internal" href="#term-implicit-grant"><em class="xref std std-term">implicit grant</em></a> is a simplified <a class="reference internal" href="glossary.html#term-authorization-code-flow"><em class="xref std std-term">authorization code flow</em></a>
optimized for clients implemented in a browser using a scripting language
such as JavaScript.
In the <a class="reference internal" href="glossary.html#term-implicit-flow"><em class="xref std std-term">implicit flow</em></a>,
instead of issuing the client an <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a>,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> is issued an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> directly
(as the result of the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> authorization).
The <a class="reference internal" href="glossary.html#term-grant-type"><em class="xref std std-term">grant type</em></a> is implicit as no intermediate credentials
(such as an <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a>) are issued
(and later used to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>).</p>
<p>When issuing an <a class="reference internal" href="#term-implicit-grant"><em class="xref std std-term">implicit grant</em></a>,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> does not authenticate the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.
In some cases,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> identity can be verified via the <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a>
used to deliver the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.
The <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> may be exposed to the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> or
other applications with access to the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>&#8216;s user-agent.</p>
<p>Implicit grants improve the responsiveness and efficiency of some clients
(such as a client implemented as an in-browser application)
since it reduces the number of round trips required to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.
However,
this convenience should be weighed against the security implications of using implicit grants,
especially when the authorization code grant type is available.</p>
<p>(v.22)</p>
</div>
<div class="section" id="resource-owner-password-credentials">
<span id="oauth-1-3-3"></span><h4><a class="toc-backref" href="#id34">1.3.3. Resource Owner Password Credentials</a><a class="headerlink" href="#resource-owner-password-credentials" title="Permalink to this headline">¶</a></h4>
<p>The resource owner password credentials (i.e. username and password)
can be used directly as an authorization grant to obtain an access
token.  The credentials should only be used when there is a high
degree of trust between the resource owner and the client (e.g. its
device operating system or a highly privileged application), and when
other authorization grant types are not available (such as an
authorization code).</p>
<p>Even though this grant type requires direct client access to the
resource owner credentials, the resource owner credentials are used
for a single request and are exchanged for an access token.  This
grant type can eliminate the need for the client to store the
resource owner credentials for future use, by exchanging the
credentials with a long-lived access token or refresh token.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-1.3.3">http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-1.3.3</a>)
(v.22)</p>
</div>
<div class="section" id="client-credentials">
<span id="oauth-1-3-4"></span><h4><a class="toc-backref" href="#id35">1.3.4. Client Credentials</a><a class="headerlink" href="#client-credentials" title="Permalink to this headline">¶</a></h4>
<p>The client credentials (or other forms of client authentication) can
be used as an <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>
when the <a class="reference internal" href="glossary.html#term-authorization-scope"><em class="xref std std-term">authorization scope</em></a> is limited to the <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>
under the control of the client,
or to <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a> previously arranged with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<p>Client credentials are used as an <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>
typically
when the client is acting on its own behalf (the client is also the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>),
or
is requesting access to <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a> based on an authorization
previously arranged with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-1.3.4">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-1.3.4</a>)</p>
<p>(v.23)</p>
<p class="seqdiag">
<img src="images/seqdiag-ac68953a9a4205833d6f1ec904aca73602731960.png" alt="None" width="640" height="780" />
</p>
</div>
</div>
<div class="section" id="access-token">
<span id="oauth-1-4"></span><h3><a class="toc-backref" href="#id36">1.4.  Access Token</a><a class="headerlink" href="#access-token" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">Access tokens</em></a> are credentials used to access <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>.
An <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is a string representing an authorization
issued to the client.
The string is usually opaque to the client.
Tokens represent specific <a class="reference internal" href="uma_core.html#term-58"><em class="xref std std-term">scopes</em></a> and <em class="xref std std-term">durations of access</em>,
granted by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>,
and enforced by the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a> and <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<p>The token may denote an identifier used to retrieve the authorization information,
or self-contain the authorization information in a verifiable manner
(i.e. a token string consisting of some data and a signature).
Additional authentication credentials,
which are beyond the scope of this specification,
may be required in order for the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> to use a token.</p>
<p>The <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> provides an abstraction layer,
replacing different authorization constructs
(e.g. username and password) with a single token understood by the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>.
This abstraction enables issuing <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> more restrictive
than the <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a> used to obtain them,
as well as removing the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a>&#8216;s need to understand
a wide range of authentication methods.</p>
<p><a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">Access tokens</em></a> can have different formats, structures, and methods of utilization
(e.g. cryptographic properties) based on the <a class="reference internal" href="#term-resource-server"><em class="xref std std-term">resource server</em></a> security requirements <a class="footnote-reference" href="#id2" id="id1">[1]</a>.
<em class="xref std std-term">Access token attributes</em> and the methods used to access <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a> are
beyond the scope of this specification and are defined by companion specifications.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Information and process ?</td></tr>
</tbody>
</table>
<p>(v.22)</p>
</div>
<div class="section" id="refresh-token">
<span id="oauth-1-5"></span><h3><a class="toc-backref" href="#id37">1.5.  Refresh Token</a><a class="headerlink" href="#refresh-token" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">Refresh tokens</em></a> are credentials used to obtain <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a>.
<a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">Refresh tokens</em></a> are issued to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
and are used to obtain a new <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
when the current <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> becomes invalid or expires,
or to obtain additional <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> with identical
or narrower <a class="reference internal" href="standard.html#term-23"><em class="xref std std-term">scope</em></a>
(<a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> may have a shorter lifetime <a class="footnote-reference" href="#id4" id="id3">[2]</a>
and <strong>fewer permissions</strong> than authorized by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>).
Issuing a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> is <strong>optional</strong>.
If the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>,
it is included when issuing an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.</p>
<p>A <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> is a string representing the authorization
granted to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
The string is usually opaque to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.
The token denotes an identifier used to retrieve the authorization information.
Unlike <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a>,
<a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a> are intended for use only with <a class="reference internal" href="glossary.html#term-authorization-servers"><em class="xref std std-term">authorization servers</em></a>
and are never sent to <a class="reference internal" href="glossary.html#term-resource-servers"><em class="xref std std-term">resource servers</em></a>.</p>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>How shorter ?</td></tr>
</tbody>
</table>
<div class="section" id="figure-2-refreshing-an-expired-access-token">
<span id="oauth-figure-2"></span><h4><a class="toc-backref" href="#id38">Figure 2: Refreshing an Expired Access Token</a><a class="headerlink" href="#figure-2-refreshing-an-expired-access-token" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><pre>+--------+                                           +---------------+
|        |--(A)------- Authorization Grant ---------&gt;|               |
|        |                                           |               |
|        |&lt;-(B)----------- Access Token -------------|               |
|        |               &amp; Refresh Token             |               |
|        |                                           |               |
|        |                            +----------+   |               |
|        |--(C)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(D)- Protected Resource --| Resource |   | Authorization |
| Client |                            |  Server  |   |     Server    |
|        |--(E)---- Access Token ----&gt;|          |   |               |
|        |                            |          |   |               |
|        |&lt;-(F)- Invalid Token Error -|          |   |               |
|        |                            +----------+   |               |
|        |                                           |               |
|        |--(G)----------- Refresh Token -----------&gt;|               |
|        |                                           |               |
|        |&lt;-(H)----------- Access Token -------------|               |
+--------+           &amp; Optional Refresh Token        +---------------+</pre>
</div>
<p>The flow illustrated in Figure 2 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The client requests an access token by authenticating with the authorization server, and presenting an authorization grant.</li>
<li>The authorization server authenticates the client and validates the authorization grant,
and if valid issues an access token and a refresh token.</li>
<li>The client makes a protected resource requests to the resource server by presenting the access token.</li>
<li>The resource server validates the access token, and if valid, serves the request.</li>
<li>Steps (C) and (D) repeat until the access token expires.  If the
client knows the access token expired, it skips to step (G),
otherwise it makes another protected resource request.</li>
<li>Since the access token is invalid, the resource server returns
an invalid token error.</li>
<li>The client requests a new access token by authenticating with
the authorization server and presenting the refresh token.</li>
<li>The authorization server authenticates the client and validates
the refresh token, and if valid issues a new access token (and
optionally, a new refresh token).</li>
</ol>
</div></blockquote>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="notational-conventions">
<span id="oauth-1-6"></span><h3><a class="toc-backref" href="#id39">1.6.  Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8216;MUST&#8217;, &#8216;MUST NOT&#8217;, &#8216;REQUIRED&#8217;, &#8216;SHALL&#8217;, &#8216;SHALL NOT&#8217;,
&#8216;SHOULD&#8217;, &#8216;SHOULD NOT&#8217;, &#8216;RECOMMENDED&#8217;, &#8216;MAY&#8217;, and &#8216;OPTIONAL&#8217; in this
specification are to be interpreted as described in [RFC2119].</p>
<p>This specification uses the Augmented Backus-Naur Form (ABNF) notation of [RFC5234].</p>
<p>Certain security-related terms are to be understood in the sense
defined in [RFC4949].  These terms include, but are not limited to,
&#8216;attack&#8217;, &#8216;authentication&#8217;, &#8216;authorization&#8217;, &#8216;certificate&#8217;,
&#8216;confidentiality&#8217;, &#8216;credential&#8217;, &#8216;encryption&#8217;, &#8216;identity&#8217;, &#8216;sign&#8217;,
&#8216;signature&#8217;, &#8216;trust&#8217;, &#8216;validate&#8217;, and &#8216;verify&#8217;.</p>
<p>Unless otherwise noted, all the protocol parameter names and values
are case sensitive.</p>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="client-registration">
<span id="oauth-2"></span><h2><a class="toc-backref" href="#id40">2.  Client Registration</a><a class="headerlink" href="#client-registration" title="Permalink to this headline">¶</a></h2>
<p>Before initiating the protocol,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> registers with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The means through
which the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> registers with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> are beyond
the scope of this specification,
but typically involve end-user interaction with an HTML registration form.</p>
<p><a class="reference internal" href="glossary.html#term-client-registration"><em class="xref std std-term">Client registration</em></a> does not require a direct interaction
between the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> and the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
When supported by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>,
registration can rely on other means for establishing trust
and obtaining the required client properties
(e.g. <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a>, <em class="xref std std-term">client type</em>).
For example,
registration can be accomplished using a self-issued
or third-party-issued assertion,
or by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> performing <em class="xref std std-term">client discovery</em>
using a trusted channel.</p>
<p>When registering a client,
the client developer:</p>
<blockquote>
<div><p>o  specifies the <em class="xref std std-term">client type</em> as described in <a class="reference internal" href="#oauth-2-1"><em>Section 2.1</em></a>,</p>
<dl class="docutils">
<dt>o  provides its <em class="xref std std-term">client redirection URIs</em> as described in</dt>
<dd><a class="reference internal" href="#oauth-3-1-2"><em>Section 3.1.2</em></a>, and</dd>
<dt>o  includes any other information required by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a></dt>
<dd>(e.g. application name, website, description, logo image, the acceptance of legal terms).</dd>
</dl>
</div></blockquote>
<p>(v.22)</p>
<div class="section" id="client-types">
<span id="oauth-2-1"></span><h3><a class="toc-backref" href="#id41">2.1. Client Types</a><a class="headerlink" href="#client-types" title="Permalink to this headline">¶</a></h3>
<p>OAuth defines two client types,
based on their ability to authenticate securely with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
(i.e. ability to maintain the confidentiality of their client credentials):</p>
<dl class="glossary docutils">
<dt id="term-confidential">confidential</dt>
<dd>Clients capable of maintaining the confidentiality of their
credentials (e.g. client implemented on a secure server with
restricted access to the client credentials), or capable of secure
client authentication using other means.</dd>
<dt id="term-public">public</dt>
<dd>Clients incapable of maintaining the confidentiality of their
credentials
(e.g. clients executing on the  device
used by the resource owner
such as an installed native application or a web browser-based
application), and incapable of secure client authentication via
any other means.</dd>
</dl>
<p>The client type designation is based on the authorization server&#8217;s
definition of secure authentication
and its acceptable exposure levels of client credentials.</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> SHOULD NOT make assumptions
about the client type,
nor accept the type information provided by the client developer
without first establishing trust.</p>
<p>A <em class="xref std std-term">client application</em> consisting of multiple components,
each with its own client type
(e.g. a distributed client with both a confidential server-based component
and a public browser-based component),
MUST register each component separately
<strong>as a different client</strong> to ensure proper handling
by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY provider tools
to manage such <strong>complex clients</strong> through a single administration interface.</p>
<p>This specification has been designed around the following client
profiles:</p>
<dl class="glossary docutils">
<dt id="term-web-application">web application</dt>
<dd><p class="first">A web application is a <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a> client running on a web server.
<em class="xref std std-term">Resource owners</em> access the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> via an HTML user interface rendered
in a user-agent on device used by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a></p>
<p class="last">The <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> as well as any <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> issued to the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
are stored on the <em class="xref std std-term">web server</em> and are not exposed to or accessible by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.</p>
</dd>
<dt id="term-user-agent-based-application">user-agent-based application</dt>
<dd><p class="first">A user-agent-based application is a <a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a> client
in which the client code is downloaded from a web server and executes within a
user-agent (e.g. web browser)
on the device used by the resource owner.</p>
<p>Protocol data and credentials are easily accessible (and often visible)
to the resource owner.</p>
<p class="last">Since such applications reside within the user-agent,
they can make seamless use of the user-agent capabilities when requesting authorization.</p>
</dd>
<dt id="term-native-application">native application</dt>
<dd><p class="first">A native application is a <a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a> client installed and
executed on the device used by the resource owner.</p>
<p>Protocol data and credentials are accessible to the resource owner.
It is assumed that any client authentication credentials included in the application can be extracted.</p>
<p>On the other hand, dynamically issued credentials such access tokens or
refresh tokens can receive an acceptable level of protection.
At a minimum, these credentials are protected from hostile servers
with which the application may interact with.</p>
<p class="last">On some platforms these credentials might be protected from
other applications residing on the same device.</p>
</dd>
</dl>
<p>(v.23)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table border="1" class="last docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>client profile</td>
<td><a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a></td>
<td><a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#term-web-application"><em class="xref std std-term">web application</em></a></td>
<td>○</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#term-user-agent-based-application"><em class="xref std std-term">user-agent-based application</em></a></td>
<td>&nbsp;</td>
<td>○</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#term-native-application"><em class="xref std std-term">native application</em></a></td>
<td>&nbsp;</td>
<td>○</td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://tools.ietf.org/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-v2-23.txt">http://tools.ietf.org/rfcdiff?difftype=&#8211;hwdiff&amp;url2=draft-ietf-oauth-v2-23.txt</a></p>
</div>
</div>
<div class="section" id="client-identifier">
<span id="oauth-2-2"></span><h3><a class="toc-backref" href="#id42">2.2.  Client Identifier</a><a class="headerlink" href="#client-identifier" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues the registered <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
a <a class="reference internal" href="session.html#term-client-identifier"><em class="xref std std-term">client identifier</em></a>
- a unique string representing the registration information provided by the client.</p>
<p>The client identifier is not a secret,
it is exposed to the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>,
and MUST NOT be used alone for <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>.</p>
<p>(v.23)</p>
</div>
<div class="section" id="client-authentication">
<span id="oauth-2-3"></span><h3><a class="toc-backref" href="#id43">2.3.  Client Authentication</a><a class="headerlink" href="#client-authentication" title="Permalink to this headline">¶</a></h3>
<p>If the <a class="reference internal" href="#oauth-2-1"><em>client type</em></a> is <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a>,
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> and <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> establish a client authentication method
suitable for the security requirements of the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY accept any form of client authentication meeting its
security requirements.</p>
<p><a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">Confidential clients</em></a> are typically issued (or establish)
a set of <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> used for authenticating
with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
(e.g. password, public/private key pair).</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY establish a client authentication method
with <a class="reference internal" href="#term-public-clients"><em class="xref std std-term">public clients</em></a>.
However, the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST NOT rely on public client authentication
for the purpose of identifying the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.</p>
<p>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> MUST NOT use more than one authentication method
in each request.</p>
<dl class="glossary docutils">
<dt id="term-confidential-clients">Confidential Clients</dt>
<dd><a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a> client. See <em class="xref std std-ref">oauth_2_1&gt;</em>.</dd>
<dt id="term-public-clients">Public Clients</dt>
<dd><a class="reference internal" href="#term-public"><em class="xref std std-term">public</em></a> client. See <em class="xref std std-ref">oauth_2_1&gt;</em>.</dd>
</dl>
<p>(v.23)</p>
<div class="section" id="client-password">
<span id="oauth-2-3-1"></span><h4><a class="toc-backref" href="#id44">2.3.1.  Client Password</a><a class="headerlink" href="#client-password" title="Permalink to this headline">¶</a></h4>
<p>Clients in possession of a client password
MAY use the HTTP Basic authentication scheme
as defined in [<a class="reference internal" href="#term-rfc2617"><em class="xref std std-term">RFC2617</em></a>] to authenticate with the authorization server.</p>
<p>The client identifier is used as the username,
and the client password is used as the password.
The authorization server MUST support the HTTP Basic authentication
scheme for authenticating clients which were issued a client password.</p>
<p>For example (extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW</pre>
</div>
<p>Alternatively, the authorization server MAY support including the
client credentials in the request body using the following
parameters:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Reuquest body in section include HTTP GET URL.</p>
</div>
<dl class="glossary docutils">
<dt id="term-client-id">client_id</dt>
<dd>REQUIRED.
The client identifier issued to the client
during the registration process described by <a class="reference internal" href="#oauth-2-2"><em>Section 2.2.</em></a></dd>
<dt id="term-client-secret">client_secret</dt>
<dd>REQUIRED.
The client secret.
The client MAY omit the parameter
if the client secret is an empty string.</dd>
</dl>
<p>Including the client credentials in the request body
using the two parameters is <strong>NOT RECOMMENDED</strong>,
and should be limited to clients unable to directly utilize
the HTTP Basic authentication scheme
(or other password-based HTTP authentication schemes).
The parameters can only be transmitted in the request body
and MUST NOT be included in the request URI.</p>
<p>For example,
requesting to refresh an access token (<a class="reference internal" href="#oauth-6"><em>Section 6</em></a>)
using the body parameters
(extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
&amp;client_id=s6BhdRkqt3&amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw</pre>
</div>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST require TLS as described
in <a class="reference internal" href="#oauth-1-6"><em>Section 1.6</em></a>
when sending requests using password authentication.</p>
<p>Since this client authentication method involves a password,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST protect any endpoint utilizing it
against <em class="xref std std-term">brute force attacks</em>.</p>
<p>(v.23)</p>
</div>
<div class="section" id="other-authentication-methods">
<span id="oauth-2-3-2"></span><h4><a class="toc-backref" href="#id45">2.3.2.  Other Authentication Methods</a><a class="headerlink" href="#other-authentication-methods" title="Permalink to this headline">¶</a></h4>
<p>The authorization server MAY support
any suitable HTTP authentication scheme
matching its security requirements.</p>
<p>When using other authentication methods,
the authorization server MUST define a mapping
between the client identifier (registration record) and
authentication scheme.</p>
<p>(v.23)</p>
</div>
</div>
<div class="section" id="unregistered-clients">
<span id="oauth-2-4"></span><h3><a class="toc-backref" href="#id46">2.4. Unregistered Clients</a><a class="headerlink" href="#unregistered-clients" title="Permalink to this headline">¶</a></h3>
<p>This specification does not exclude the use of unregistered clients.
However,
the use with such clients is beyond the scope of this
specification,
and requires additional security analysis and review
of its interoperability impact.</p>
<p>(v 23)</p>
</div>
</div>
<div class="section" id="protocol-endpoints">
<span id="oauth-3"></span><h2><a class="toc-backref" href="#id47">3. Protocol Endpoints</a><a class="headerlink" href="#protocol-endpoints" title="Permalink to this headline">¶</a></h2>
<p>The authorization process utilizes two endpoints (HTTP resources):</p>
<blockquote>
<div><dl class="docutils">
<dt>o  <a class="reference internal" href="#term-authorization-endpoint"><em class="xref std std-term">Authorization endpoint</em></a> - used to obtain authorization from the</dt>
<dd>resource owner via user-agent redirection.</dd>
<dt>o  <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">Token endpoint</em></a> - used to exchange an authorization grant for an</dt>
<dd>access token, typically with client authentication.</dd>
</dl>
</div></blockquote>
<p>Not every authorization grant type utilizes both endpoints.
Extension grant types MAY define additional endpoints as needed.</p>
<div class="section" id="authorization-endpoint">
<span id="oauth-3-1"></span><h3><a class="toc-backref" href="#id48">3.1. Authorization Endpoint</a><a class="headerlink" href="#authorization-endpoint" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-authorization-endpoint">Authorization Endpoint</dt>
<dd>The authorization endpoint is used to interact with the resource owner and obtain an authorization grant.</dd>
</dl>
<p>The authorization server MUST first verify the identity of the resource owner.
The way in which the authorization server authenticates the resource owner
(e.g.  username and password login, session cookies)
is beyond the scope of this specification.</p>
<p>The means through which the client obtains the location of the
authorization endpoint are beyond the scope of this specification but
the location is typically provided in the service documentation.</p>
<p>The endpoint URI MAY include an &#8220;application/x-www-form-urlencoded&#8221;
formatted ([W3C.REC-html401-19991224]) query component ([RFC3986]
section 3.4), which MUST be retained when adding additional query
Since requests to the authorization endpoint result in user
authentication and the transmission of clear-text credentials (in the
HTTP response), the authorization server MUST require the use of a
transport-layer security mechanism when sending requests to the
authorization endpoint.  The authorization server MUST support TLS
1.0 ([RFC2246]), SHOULD support TLS 1.2 ([RFC5246]) and its future
replacements, and MAY support additional transport-layer mechanisms
meeting its security requirements.</p>
<p>The authorization server MUST support the use of the HTTP &#8220;GET&#8221;
method [RFC2616] for the authorization endpoint, and MAY support the
use of the &#8220;POST&#8221; method as well.</p>
<p>Parameters sent without a value MUST be treated as if they were
omitted from the request.  The authorization server SHOULD ignore
unrecognized request parameters.  Request and response parameters
MUST NOT be included more than once.</p>
<div class="section" id="response-type">
<span id="oauth-3-1-1"></span><h4><a class="toc-backref" href="#id49">3.1.1. Response Type</a><a class="headerlink" href="#response-type" title="Permalink to this headline">¶</a></h4>
<p>The authorization endpoint is used by the authorization code grant
type and implicit grant type flows.  The client informs the
authorization server of the desired grant type using the following parameter:</p>
<blockquote>
<div><p>response_type</p>
<blockquote>
<div>REQUIRED.  The value MUST be one of &#8220;code&#8221; for requesting an
authorization code as described by Section 4.1.1, &#8220;token&#8221; for
requesting an access token (implicit grant) as described by
Section 4.2.1, or a registered extension value as described by
Section 8.4.  If the response type contains one or more space
characters (%x20), it is interpreted as a space-delimited list
of values, where the order of values does not matter (e.g. &#8220;a
b&#8221; is the same as &#8220;b a&#8221;).</div></blockquote>
</div></blockquote>
<p>If an authorization request is missing the &#8220;response_type&#8221; parameter,
the authorization server SHOULD return an error response as described
in Section 4.1.2.1.</p>
</div>
<div class="section" id="redirection-endpoint">
<span id="oauth-3-1-2"></span><h4><a class="toc-backref" href="#id50">3.1.2. Redirection Endpoint</a><a class="headerlink" href="#redirection-endpoint" title="Permalink to this headline">¶</a></h4>
<p>After completing its interaction with the resource owner,
the authorization server directs the resource owner&#8217;s user-agent
back to the client.</p>
<p>The authorization server redirects the user-agent
to the client&#8217;s <em class="xref std std-term">redirection endpoint</em>
previously established with the authorization server
during the <a class="reference internal" href="glossary.html#term-client-registration"><em class="xref std std-term">client registration</em></a> process or
when making the <a class="reference internal" href="glossary.html#term-authorization-request"><em class="xref std std-term">authorization request</em></a>.</p>
<p>The redirection endpoint URI MUST be an absolute URI
as defined by [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 4.3.
The endpoint URI MAY include an &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221;
formatted ([<a class="reference internal" href="standard.html#term-w3c-rec-html401-19991224"><em class="xref std std-term">W3C.REC-html401-19991224</em></a>]) query component
([<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 3.4),
which MUST be retained when adding additional query parameters.
The endpoint URI MUST NOT include a fragment component.</p>
<p>(v.23)</p>
<div class="section" id="endpoint-request-confidentiality">
<span id="oauth-3-1-2-1"></span><h5><a class="toc-backref" href="#id51">3.1.2.1.  Endpoint Request Confidentiality</a><a class="headerlink" href="#endpoint-request-confidentiality" title="Permalink to this headline">¶</a></h5>
<p>The redirection endpoint SHOULD require
the use of TLS as described in Section 1.6
when the requested response type is &#8220;<a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a>&#8221; or &#8220;<a class="reference internal" href="standard.html#term-token"><em class="xref std std-term">token</em></a>&#8221;,
or when the redirection request will result
in the transmission of sensitive credentials over an open network.
This specification does not mandate the use of TLS
because at the time of this writing,
requiring clients to deploy TLS is a significant
hurdle for most client developers.</p>
<p>Lack of transport-layer security can have a severe impact
on the security of the client
and the protected resources it is authorized to access.
The use of transport-layer security is particularly critical
when the authorization process is used as a form of delegated end-user authentication
by the client (e.g. third-party sign-in service).</p>
<p>(v .23)</p>
</div>
<div class="section" id="registration-requirements">
<span id="oauth-3-1-2-2"></span><h5><a class="toc-backref" href="#id52">3.1.2.2.  Registration Requirements</a><a class="headerlink" href="#registration-requirements" title="Permalink to this headline">¶</a></h5>
<p>The authorization server MUST require the following clients to
register their redirection endpoint:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#term-public-clients"><em class="xref std std-term">Public clients</em></a>.</li>
<li><a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">Confidential clients</em></a> utilizing the <em class="xref std std-term">implicit grant type</em>.</li>
</ul>
</div></blockquote>
<p>The authorization server SHOULD require all clients
to register their redirection endpoint
prior to utilizing the authorization endpoint</p>
<p>The authorization server SHOULD require the client
to provide the complete redirection URI
(the client MAY use the &#8220;state&#8221; request parameter to achieve per-request customization).
If requiring the registration of the complete redirection URI is not possible,
the authorization server SHOULD require the registration of the URI scheme,
authority, and path
(allowing the client to dynamically vary only the <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a>
of the redirection URI when requesting authorization).</p>
<p>The authorization server MAY allow the client
to register <strong>multiple</strong> <em class="xref std std-term">redirection endpoints</em>.</p>
<p>Lack of a redirection URI registration requirement
can enable an attacker to use the authorization endpoint
as <em class="xref std std-term">open redirector</em> as described in <em class="xref std std-ref">Section 10.15</em>.</p>
<p>(v. 23)</p>
</div>
<div class="section" id="dynamic-configuration">
<span id="oauth-3-1-2-3"></span><h5><a class="toc-backref" href="#id53">3.1.2.3.  Dynamic Configuration</a><a class="headerlink" href="#dynamic-configuration" title="Permalink to this headline">¶</a></h5>
<p>If multiple redirection URIs have been registered, if only part of
the redirection URI has been registered, or if no redirection URI has
been registered, the client MUST include a redirection URI with the
authorization request using the &#8220;redirect_uri&#8221; request parameter.</p>
<p>When a <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a> is included in an authorization request,
the authorization server MUST compare and match the value received against
at least one of the registered redirection URIs
(or URI components) as defined in [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 6,
if any redirection URIs were registered.
If the client registration included the full redirection URI,
the authorization server MUST compare the two URIs
using simple string comparison as defined in [<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 6.2.1.</p>
<p>(v 23)</p>
</div>
<div class="section" id="invalid-endpoint">
<span id="oauth-3-1-2-4"></span><h5><a class="toc-backref" href="#id54">3.1.2.4.  Invalid Endpoint</a><a class="headerlink" href="#invalid-endpoint" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div>If an authorization request fails validation due to a missing,
invalid, or mismatching redirection URI, the authorization server
SHOULD inform the resource owner of the error, and MUST NOT
automatically redirect the user-agent to the invalid redirection URI.</div></blockquote>
<p>(v.23)</p>
</div>
<div class="section" id="endpoint-content">
<span id="oauth-3-1-2-5"></span><h5><a class="toc-backref" href="#id55">3.1.2.5.  Endpoint Content</a><a class="headerlink" href="#endpoint-content" title="Permalink to this headline">¶</a></h5>
<p>The redirection request to the client&#8217;s endpoint typically results in
an HTML document response, processed by the user-agent.  If the HTML
response is served directly as the result of the redirection request,
any script included in the HTML document will execute with full
access to the redirection URI and the credentials it contains.</p>
<p>The client MUST NOT include any untrusted third-party scripts in the
redirection endpoint response (e.g. third-party analytics, social
plug-ins, ad networks) without first ensuring that its own scripts
used to extract and remove the credentials from the URI will execute
first.</p>
<p>The client SHOULD NOT include any third-party scripts in the
redirection endpoint response.  Instead, it should extract the
credentials from the URI and redirect the user-agent again to another
endpoint without the credentials in the URI.</p>
<p>(v.23)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Developer MSUT provide a dedicated master template for
the redirection URL contents.
No third party Javascript or beacon to disclose
<strong>code</strong>, <strong>token</strong> and other privacy information.</p>
</div>
</div>
</div>
</div>
<div class="section" id="token-endpoint">
<span id="oauth-3-2"></span><h3><a class="toc-backref" href="#id56">3.2. Token Endpoint</a><a class="headerlink" href="#token-endpoint" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-token-endpoint">Token Endpoint</dt>
<dd>Endpoint to issue tokens.</dd>
</dl>
<p>The <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> is used by the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>
to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
by presenting its <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a> or <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Confidential clients&#8217; credential can be a  authorization grant. See &#8220;<a class="reference internal" href="#oauth-4-4"><em>4.4.  Client Credentials</em></a>&#8221;.</p>
</div>
<p>The <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> is used with every <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>
except for the <a class="reference internal" href="#term-implicit-grant"><em class="xref std std-term">implicit grant</em></a> type
(since an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is issued directly).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Directly at <em class="xref std std-term">Autorization Endpoint</em></p>
</div>
<p>The means through which the client obtains
the location of the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> are beyond the scope of this specification
but is typically provided in the service documentation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Discovery</p>
</div>
<p>The endpoint URI MAY include an &#8220;application/x-www-form-urlencoded&#8221; formatted
([<a class="reference internal" href="standard.html#term-w3c-rec-html401-19991224"><em class="xref std std-term">W3C.REC-html401-19991224</em></a>]) <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a> ([<a class="reference internal" href="#term-rfc3986"><em class="xref std std-term">RFC3986</em></a>] section 3.4),
which MUST be retained when adding additional query parameters.
The endpoint URI MUST NOT include a fragment component.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No fragment to URI</p>
</div>
<p>Since requests to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> result in
the transmission of clear-text credentials
(in the HTTP request and response),
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST require TLS as described in <a class="reference internal" href="#oauth-1-6"><em>Section 1.6</em></a>
when sending requests to the token endpoint.</p>
<p>The client MUST use the HTTP &#8220;<strong>POST</strong>&#8221; method when making access token requests.</p>
<p>Parameters sent without a value MUST be treated as
if they were omitted from the request.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST ignore unrecognized request parameters.
Request and response parameters MUST NOT be included more than once.</p>
<p>(v.23 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2</a>)</p>
<div class="section" id="oauth-3-2-1">
<span id="id5"></span><h4><a class="toc-backref" href="#id57">3.2.1. Client Authentication</a><a class="headerlink" href="#oauth-3-2-1" title="Permalink to this headline">¶</a></h4>
<p><a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">Confidential clients</em></a>,
clients issued client credentials,
or clients assigned other authentication requirements MUST
authenticate with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
as described in <a class="reference internal" href="#oauth-2-2"><em>Section 2.3</em></a>
when making requests to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.
<a class="reference internal" href="#term-client"><em class="xref std std-term">Client</em></a> authentication is used for:</p>
<blockquote>
<div><ul class="simple">
<li>Enforcing the binding of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a> and <em class="xref std std-term">authorization codes</em> to
the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> they are issued.  Client authentication is critical
when an <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a> is transmitted to the redirection
endpoint over an insecure channel, or when the redirection URI has
not been registered in full.</li>
<li>Recovering from a compromised client by disabling the client or
changing its credentials, thus preventing an attacker from abusing
stolen refresh tokens.  Changing a single set of client
credentials is significantly faster than revoking an entire set of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a>.</li>
<li>Implementing <em class="xref std std-term">authentication management best practices</em> which
require <em class="xref std std-term">periodic credential rotation</em>.  Rotation of an entire set
of <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a> can be challenging, while rotation of a single
set of client credentials is significantly easier.</li>
</ul>
</div></blockquote>
<p>A <a class="reference internal" href="glossary.html#term-public-client"><em class="xref std std-term">public client</em></a> that was not issued a client password
MAY use the &#8220;<a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a>&#8221; request parameter to identify itself
when sending requests to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.</p>
<p>(v.23 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-3.2.1</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em class="xref std std-ref">messages_3_2_1</em></p>
</div>
</div>
</div>
<div class="section" id="access-token-scope">
<span id="oauth-3-3"></span><h3><a class="toc-backref" href="#id58">3.3. Access Token Scope</a><a class="headerlink" href="#access-token-scope" title="Permalink to this headline">¶</a></h3>
<p>The authorization and token endpoints allow the client to specify the scope of the access request
using the &#8220;<strong>scope</strong>&#8221; request parameter.
In turn, the authorization server uses the &#8220;scope&#8221; response parameter
to inform the client of the scope of the access token issued.</p>
<p>The value of the scope parameter is expressed as a list of space-delimited, case sensitive strings.
The strings are defined by the authorization server.
If the value contains multiple space-delimited strings, their order does not matter,
and each string adds an additional access range to the requested scope.</p>
<p>The authorization server MAY fully or partially ignore the scope requested by the client
based on the authorization server policy or the resource owner&#8217;s instructions.
If the issued access token scope is different from the one requested by the client,
the authorization server SHOULD include the &#8220;scope&#8221; response parameter to inform the client of the actual scope granted.</p>
</div>
</div>
<div class="section" id="obtaining-authorization">
<span id="oauth-4"></span><h2><a class="toc-backref" href="#id59">4.  Obtaining Authorization</a><a class="headerlink" href="#obtaining-authorization" title="Permalink to this headline">¶</a></h2>
<p>To request an access token,
the client obtains authorization from the resource owner.
The authorization is expressed in the form of an authorization grant
which the client uses to request the access token.
OAuth defines four grant types: authorization code, implicit,
resource owner password credentials, and client credentials.
It also provides an extension mechanism for defining additional grant types.</p>
<p>(v.23)</p>
<div class="section" id="authorization-code-grant">
<span id="oauth-4-1"></span><h3><a class="toc-backref" href="#id60">4.1.  Authorization Code Grant</a><a class="headerlink" href="#authorization-code-grant" title="Permalink to this headline">¶</a></h3>
<p>The <em class="xref std std-term">authorization code grant</em> type is used to obtain
both <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> and <a class="reference internal" href="glossary.html#term-refresh-tokens"><em class="xref std std-term">refresh tokens</em></a>
and is optimized for <a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">confidential clients</em></a>.</p>
<p>As a redirection-based flow,
the client must be capable of interacting with the resource owner&#8217;s user-agent
(typically a web browser)
and capable of receiving incoming requests (via redirection)
from the authorization server.</p>
<div class="highlight-python"><pre>+----------+
| resource |
|   owner  |
|          |
+----------+
     ^
     |
    (B)
+----|-----+          Client Identifier      +---------------+
|         -+----(A)-- &amp; Redirection URI ----&gt;|               |
|  User-   |                                 | Authorization |
|  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
|          |                                 |               |
|         -+----(C)-- Authorization Code ---&lt;|               |
+-|----|---+                                 +---------------+
  |    |                                         ^      v
 (A)  (C)                                        |      |
  |    |                                         |      |
  ^    v                                         |      |
+---------+                                      |      |
|         |&gt;---(D)-- Authorization Code ---------'      |
|  Client |          &amp; Redirection URI                  |
|         |                                             |
|         |&lt;---(E)----- Access Token -------------------'
+---------+       (w/ Optional Refresh Token)


Note: The lines illustrating steps A, B, and C are broken into two
parts as they pass through the user-agent.


                Figure 3: Authorization Code Flow</pre>
</div>
<p>The flow illustrated in Figure 3 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The client initiates the flow by directing the resource owner&#8217;s
user-agent to the authorization endpoint.  The client includes
its client identifier, requested scope, local state, and a
redirection URI to which the authorization server will send the
user-agent back once access is granted (or denied).</li>
<li>The authorization server authenticates the resource owner (via
the user-agent) and establishes whether the resource owner
grants or denies the client&#8217;s access request.</li>
<li>Assuming the resource owner grants access, the authorization
server redirects the user-agent back to the client using the
redirection URI provided earlier (in the request or during
client registration).  The redirection URI includes an
authorization code and any local state provided by the client
earlier.</li>
<li>The client requests an access token from the authorization
server&#8217;s token endpoint by including the authorization code
received in the previous step.  When making the request, the
client authenticates with the authorization server.  The client
includes the redirection URI used to obtain the authorization
code for verification.</li>
<li>The authorization server authenticates the client, validates the
authorization code, and ensures the redirection URI received
matches the URI used to redirect the client in step (C).  If
valid, the authorization server responds back with an access
token and optionally, a refresh token.</li>
</ol>
</div></blockquote>
<p>(v.23)</p>
<div class="section" id="authorization-request">
<span id="oauth-4-1-1"></span><h4><a class="toc-backref" href="#id61">4.1.1. Authorization Request</a><a class="headerlink" href="#authorization-request" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-4.1.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-4.1.1</a></li>
</ul>
</div>
<p>The client constructs the <em class="xref std std-term">request URI</em>
by adding the following parameters to the <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a>
of the <em class="xref std std-term">authorization endpoint URI</em>
using the &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221; format
as defined by [<a class="reference internal" href="standard.html#term-w3c-rec-html401-19991224"><em class="xref std std-term">W3C.REC-html401-19991224</em></a>]:</p>
<dl class="glossary docutils">
<dt id="term-response-type">response_type</dt>
<dd>REQUIRED.  Value MUST be set to &#8220;<a class="reference internal" href="standard.html#term-19"><em class="xref std std-term">code</em></a>&#8221;.</dd>
<dt id="term-17">client_id</dt>
<dd>REQUIRED.
The client identifier as described in <a class="reference internal" href="#oauth-2-2"><em>Section 2.2</em></a>.</dd>
<dt id="term-redirect-uri">redirect_uri</dt>
<dd>OPTIONAL, as described in <a class="reference internal" href="#oauth-3-1-2"><em>Section 3.1.2</em></a>.</dd>
<dt id="term-scope">scope</dt>
<dd>OPTIONAL.  The scope of the access request as described by
<a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</dd>
<dt id="term-state">state</dt>
<dd>RECOMMENDED.  An opaque value used by the client to maintain
state between the request and callback.  The authorization
server includes this value when redirecting the user-agent back
to the client.  The parameter SHOULD be used for preventing
cross-site request forgery as described in <em class="xref std std-ref">Section 10.12</em>.</dd>
</dl>
<p>The client directs the resource owner to the constructed URI using an
<em class="xref std std-term">HTTP redirection response</em> or by other means <a class="footnote-reference" href="#id7" id="id6">[3]</a> available to it via the user-agent.</p>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[3]</a></td><td>ummmm....</td></tr>
</tbody>
</table>
<p>For example,
the client directs the user-agent to make the following
HTTP request using transport-layer security (extra line breaks are
for display purposes only):</p>
<div class="highlight-python"><pre>GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz
    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
Host: server.example.com</pre>
</div>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> validates the request
to ensure all required parameters are present and valid.
If the request is valid,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> authenticates the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>
and obtains an authorization decision
(by asking the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> or by establishing approval via other means).</p>
<p>When a decision is established,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> directs the <a class="reference internal" href="glossary.html#term-user-agent"><em class="xref std std-term">user-agent</em></a>
to the provided client redirection URI using an HTTP redirection response,
or by other means available to it via the user-agent.</p>
<p>(v.22)</p>
</div>
<div class="section" id="authorization-response">
<span id="oauth-4-1-2"></span><h4><a class="toc-backref" href="#id62">4.1.2. Authorization Response</a><a class="headerlink" href="#authorization-response" title="Permalink to this headline">¶</a></h4>
<p>If the resource owner grants the access request,
the authorization server issues an authorization code
and delivers it to the client by adding the following parameters
to the <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a> of the redirection URI
using the &#8220;application/x-www-form-urlencoded&#8221; format:</p>
<dl class="glossary docutils">
<dt id="term-code">code</dt>
<dd>REQUIRED.
The authorization code generated by the authorization server.
The authorization code MUST expire shortly
after it is issued to mitigate the risk of leaks.
A maximum authorization code lifetime of <strong>10 minutes</strong> is RECOMMENDED.
The client MUST NOT use the authorization code more than <strong>once</strong>.
If an authorization code is used more than once,
the authorization server MUST deny the request
and SHOULD attempt to revoke all tokens previously issued
based on that authorization code.
The authorization code is bound to the <strong>client identifier</strong> and <strong>redirection URI</strong>.</dd>
<dt id="term-22">state</dt>
<dd>REQUIRED if the &#8220;state&#8221; parameter was present in the client authorization request.
The exact value received from the client.</dd>
</dl>
<p>For example, the authorization server redirects the user-agent by
sending the following HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
          &amp;state=xyz</pre>
</div>
<p>The client SHOULD ignore unrecognized response parameters.
The <a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">authorization code</em></a> string size is left undefined by this specification.
The client should avoid making assumptions about code value sizes.
The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> should document the size of any value it issues.</p>
<p>(draft 26)</p>
<div class="section" id="error-response">
<span id="oauth-4-1-2-1"></span><h5><a class="toc-backref" href="#id63">4.1.2.1. Error Response</a><a class="headerlink" href="#error-response" title="Permalink to this headline">¶</a></h5>
<p>If the request fails due to a missing, invalid, or mismatching redirection URI,
or if the client identifier provided is invalid,
the authorization server SHOULD inform the resource owner of the error,
and MUST NOT automatically redirect the user-agent to the invalid redirection URI.</p>
<p>If the resource owner denies the access request or
if the request fails for reasons other than a missing
or invalid redirection URI,
the authorization server informs the client by adding the following parameters
to the <strong>query component</strong> of the redirection URI
using the &#8220;application/x-www-form-urlencoded&#8221; format:</p>
<dl class="glossary docutils">
<dt id="term-error">error</dt>
<dd><p class="first">REQUIRED.
A single error code from the following:</p>
<dl class="last docutils">
<dt>invalid_request</dt>
<dd>The request is missing a required parameter, includes an
unsupported parameter value, or is otherwise malformed.</dd>
<dt>unauthorized_client</dt>
<dd>The client is not authorized to request an authorization
code using this method.</dd>
<dt>access_denied</dt>
<dd>The resource owner or authorization server denied the
request.</dd>
<dt>unsupported_response_type</dt>
<dd>The authorization server does not support obtaining an
authorization code using this method.</dd>
<dt>invalid_scope</dt>
<dd>The requested scope is invalid, unknown, or malformed.</dd>
<dt>server_error</dt>
<dd>The authorization server encountered an unexpected
condition which prevented it from fulfilling the request.</dd>
<dt>temporarily_unavailable</dt>
<dd>The authorization server is currently unable to handle
the request due to a temporary overloading or maintenance
of the server.</dd>
</dl>
</dd>
<dt id="term-error-description">error_description</dt>
<dd>OPTIONAL.  A human-readable UTF-8 encoded text providing
additional information, used to assist the client developer in
understanding the error that occurred.</dd>
<dt id="term-error-uri">error_uri</dt>
<dd>OPTIONAL.  A URI identifying a human-readable web page with
information about the error, used to provide the client
developer with additional information about the error.</dd>
<dt id="term-26">state</dt>
<dd>REQUIRED if a valid &#8220;state&#8221; parameter was present in the client
authorization request.  The exact value received from the
client.</dd>
</dl>
<p>For example, the authorization server redirects the user-agent by
sending the following HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb?error=access_denied&amp;state=xyz</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>v22</li>
</ul>
</div>
</div>
</div>
<div class="section" id="access-token-request">
<span id="oauth-4-1-3"></span><h4><a class="toc-backref" href="#id64">4.1.3.  Access Token Request</a><a class="headerlink" href="#access-token-request" title="Permalink to this headline">¶</a></h4>
<p>The client makes a request to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>
by adding the following parameters
using the &#8220;application/x-www-form-urlencoded&#8221; format
in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-grant-type">grant_type</dt>
<dd>REQUIRED.  Value MUST be set to &#8220;authorization_code&#8221;.</dd>
<dt id="term-28">code</dt>
<dd>REQUIRED.  The authorization code received from the
authorization server.</dd>
<dt id="term-29">redirect_uri</dt>
<dd>REQUIRED, if the &#8220;redirect_uri&#8221; parameter was included in the
authorization request as described in Section 4.1.1, and their
values MUST be identical.</dd>
</dl>
<p>If the <em class="xref std std-term">client type</em> is <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a>
or the client was issued <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>
(or assigned other authentication requirements),
the client MUST authenticate with the authorization server as described
in <a class="reference internal" href="#oauth-3-2-1"><em>Section 3.2.1</em></a>.</p>
<p>For example,
the client makes the following HTTP request using TLS
(extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb</pre>
</div>
<p>The authorization server MUST:</p>
<blockquote>
<div><ul class="simple">
<li>require client authentication for confidential clients or for any
client that was issued client credentials (or with other
authentication requirements),</li>
<li>authenticate the client if client authentication is included and
ensure the authorization code was issued to the authenticated
client,</li>
<li>verify that the authorization code is valid, and</li>
<li>ensure that the &#8220;redirect_uri&#8221; parameter is present if the
&#8220;redirect_uri&#8221; parameter was included in the initial authorization
request as described in Section 4.1.1, and if included ensure
their values are identical.</li>
</ul>
</div></blockquote>
<p>(v.23)</p>
</div>
<div class="section" id="access-token-response">
<span id="oauth-4-1-4"></span><h4><a class="toc-backref" href="#id65">4.1.4. Access Token Response</a><a class="headerlink" href="#access-token-response" title="Permalink to this headline">¶</a></h4>
<p>If the access token request is valid and authorized, the
authorization server issues an access token and optional refresh
token as described in Section 5.1.  If the request client
authentication failed or is invalid, the authorization server returns
an error response as described in Section 5.2.</p>
<p>An example successful response:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "example_parameter":"example_value"
}</pre>
</div>
</div>
</div>
<div class="section" id="implicit-grant">
<span id="oauth-4-2"></span><h3><a class="toc-backref" href="#id66">4.2.  Implicit Grant</a><a class="headerlink" href="#implicit-grant" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-implicit-grant">Implicit Grant</dt>
<dd>The <a class="reference internal" href="glossary.html#term-implicit"><em class="xref std std-term">implicit</em></a> grant type is used to obtain <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> (it does not support the issuance of refresh tokens)
and is optimized for public clients known to operate a particular redirection URI.
These clients are typically implemented in a browser using a scripting language such as JavaScript.</dd>
</dl>
<p>As a redirection-based flow, the client must be capable of interacting with the resource owner&#8217;s user-agent
(typically a web browser) and capable of receiving incoming requests (via redirection) from the authorization server.</p>
<p>Unlike the authorization code grant type in which the client makes separate requests for authorization and access token,
the client receives the access token as the result of the authorization request.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Implicit grant is the only way to obtain an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> directly without intermidiate credentials.</p>
</div>
<p>The implicit grant type does not include client authentication, and relies on the presence of the resource owner and
the registration of the redirection URI.
Because the access token is encoded into the redirection URI,
it may be exposed to the resource owner and other applications residing on its device.</p>
<p>Figure 4: Implicit Grant Flow</p>
<div class="highlight-python"><pre>+----------+
| Resource |
|  Owner   |
|          |
+----------+
     ^
     |
    (B)
+----|-----+          Client Identifier     +---------------+
|         -+----(A)-- &amp; Redirection URI ---&gt;|               |
|  User-   |                                | Authorization |
|  Agent  -|----(B)-- User authenticates --&gt;|     Server    |
|          |                                |               |
|          |&lt;---(C)--- Redirection URI ----&lt;|               |
|          |          with Access Token     +---------------+
|          |            in Fragment
|          |                                +---------------+
|          |----(D)--- Redirection URI ----&gt;|   Web-Hosted  |
|          |          without Fragment      |     Client    |
|          |                                |    Resource   |
|     (F)  |&lt;---(E)------- Script ---------&lt;|               |
|          |                                +---------------+
+-|--------+
  |    |
 (A)  (G) Access Token
  |    |
  ^    v
+---------+
|         |
|  Client |
|         |
+---------+</pre>
</div>
<p>The flow illustrated in Figure 4 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The client initiates the flow by directing the resource owner&#8217;s user-agent to the authorization endpoint.
The client includes its client identifier, requested scope, local state,
and a redirection URI to which the authorization server will send the user-agent back once access is granted (or denied).</li>
<li>The authorization server authenticates the resource owner (via the user-agent) and
establishes whether the resource owner grants or denies the client&#8217;s access request.</li>
<li>Assuming the resource owner grants access, the authorization server redirects the user-agent back to the client
using the redirection URI provided earlier.
The redirection URI includes the access token in the URI fragment <a class="footnote-reference" href="#id9" id="id8">[4]</a> .</li>
<li>The user-agent follows the redirection instructions by making a request to the web-hosted client resource
(which does not include the fragment).
The user-agent retains the fragment information locally.</li>
<li>The web-hosted client resource returns a web page (typically an HTML document with an embedded script)
capable of accessing the full redirection URI including the fragment retained by the user-agent,
and extracting the access token (and other parameters) contained in the fragment.</li>
<li>The user-agent executes the script provided by the web-hosted client resource locally,
which extracts the access token and passes it to the client.</li>
</ol>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id9" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id8">[4]</a></td><td>URI fragemets ( string after <strong>#</strong> in URL) are not exposed to any other entity other than user agents. If a security token is encoded in somewhere in URL other than fragments( i,e. path string or query string ), your user agent may disclose that security token to other 3rd party entity with HTTP Referer request parameter.</td></tr>
</tbody>
</table>
<div class="section" id="oauth-4-2-1">
<span id="id10"></span><h4><a class="toc-backref" href="#id67">4.2.1. Authorization Request</a><a class="headerlink" href="#oauth-4-2-1" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-4.2.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-22#section-4.2.1</a></li>
</ul>
</div>
<p>The client constructs the <em class="xref std std-term">request URI</em> by adding the following
parameters to the <a class="reference internal" href="glossary.html#term-query-component"><em class="xref std std-term">query component</em></a> of the <em class="xref std std-term">authorization endpoint URI</em>
using the &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221; format:</p>
<dl class="glossary docutils">
<dt id="term-31">response_type</dt>
<dd>REQUIRED.  Value MUST be set to &#8220;token&#8221;.</dd>
<dt id="term-32">client_id</dt>
<dd>REQUIRED.  The client identifier as described in <a class="reference internal" href="#oauth-2-2"><em>Section 2.2</em></a>.</dd>
<dt id="term-33">redirect_uri</dt>
<dd>OPTIONAL, as described in <a class="reference internal" href="#oauth-3-1-2"><em>Section 3.1.2</em></a> .</dd>
<dt id="term-34">scope</dt>
<dd>OPTIONAL.  The scope of the access request as described by
<a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</dd>
<dt id="term-35">state</dt>
<dd>RECOMMENDED.  An opaque value used by the client to maintain
state between the request and callback.  The authorization
server includes this value when redirecting the user-agent back
to the client.  The parameter SHOULD be used for preventing
cross-site request forgery as described in <em class="xref std std-ref">Section 10.12</em>.</dd>
</dl>
<p>The client directs the resource owner to the constructed URI using an
HTTP redirection response, or by other means available to it via the
user-agent.</p>
<p>For example, the client directs the user-agent to make the following
HTTP request using transport-layer security (extra line breaks are
for display purposes only):</p>
<div class="highlight-python"><pre>GET /authorize?response_type=token&amp;client_id=s6BhdRkqt3&amp;state=xyz
    &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
Host: server.example.com</pre>
</div>
<p>The authorization server validates the request to ensure all required
parameters are present and valid.  The authorization server MUST
verify that the redirection URI to which it will redirect the access
token matches a redirection URI registered by the client as described
in <a class="reference internal" href="#oauth-3-1-2"><em>Section 3.1.2</em></a>.</p>
<p>If the request is valid, the authorization server authenticates the
resource owner and obtains an authorization decision (by asking the
resource owner or by establishing approval via other means).</p>
<p>When a decision is established, the authorization server directs the
user-agent to the provided client redirection URI using an HTTP
redirection response, or by other means available to it via the user-
agent.</p>
<p>(v.22)</p>
</div>
<div class="section" id="oauth-4-2-2">
<span id="id11"></span><h4><a class="toc-backref" href="#id68">4.2.2. Access Token Response</a><a class="headerlink" href="#oauth-4-2-2" title="Permalink to this headline">¶</a></h4>
<p>If the resource owner grants the access request,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> and delivers it
to the client by adding the following parameters
to the <em class="xref std std-term">fragment component</em> of the <a class="reference internal" href="glossary.html#term-redirection-uri"><em class="xref std std-term">redirection URI</em></a>
using the &#8220;application/x-www-form-urlencoded&#8221; format:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>Response is Redirection (302)</li>
<li>Token MUST be in Fragment Component.</li>
</ul>
</div>
<dl class="glossary docutils">
<dt id="term-access-token">access_token</dt>
<dd>REQUIRED.
The access token issued by the authorization server.</dd>
<dt id="term-token-type">token_type</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">The type of the token issued as described in <a class="reference internal" href="#oauth-7-1"><em>Section 7.1</em></a>.
Value is <strong>case insensitive</strong>.</p>
</dd>
<dt id="term-expires-in">expires_in</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">The lifetime in seconds of the access token.  For
example, the value &#8220;3600&#8221; denotes that the access token will
expire in one hour from the time the response was generated.</p>
</dd>
<dt id="term-39">scope</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">The scope of the access token as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</p>
</dd>
<dt id="term-40">state</dt>
<dd>REQUIRED if the &#8220;state&#8221; parameter was present in the client
authorization request.
The exact value received from the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>.</dd>
</dl>
<p>The authorization server <strong>MUST NOT</strong> issue a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>. <a class="footnote-reference" href="#id13" id="id12">[5]</a></p>
<table class="docutils footnote" frame="void" id="id13" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[5]</a></td><td>Tokens MUST NOT be returned in URL query part.
Are there any method to return access_token + refresh_token in fragment ?</td></tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NO Refresh Token in Implicit Flow.</p>
</div>
<p>For example,
the authorization server redirects the user-agent
by sending the following HTTP response (URI extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: http://example.com/rd#access_token=2YotnFZFEjr1zCsicMWpAA
          &amp;state=xyz&amp;token_type=example&amp;expires_in=3600</pre>
</div>
<p>Developers should note that
some user-agents do not support the inclusion of a <em class="xref std std-term">fragment component</em>
in the HTTP &#8220;Location&#8221; response header field.
Such client will require using other methods for redirecting the client
than a 3xx redirection response.
For example,
returning an HTML page which includes a &#8216;continue&#8217; button
with an action linked to the redirection URI.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">What browser can&#8217;t handle URL fragemnt component in Location response header?</p>
</div>
<p>The client SHOULD ignore unrecognized response parameters.
The <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> string size is left undefined by this specification.
The client should avoid making assumptions about value sizes.
The authorization server should document the size of any value it issues.</p>
<p>(draft 26)</p>
<div class="section" id="oauth-4-2-2-1">
<span id="id14"></span><h5><a class="toc-backref" href="#id69">4.2.2.1. Error Response</a><a class="headerlink" href="#oauth-4-2-2-1" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Error responses for <a class="reference internal" href="#oauth-4-2"><em>Implicit Grant</em></a></p>
</div>
<p>If the request fails due to a missing, invalid, or mismatching redirection URI,
or if the client identifier provided is invalid,
the authorization server SHOULD inform the resource owner of the error,
and MUST NOT automatically redirect the user-agent to the invalid redirection URI.</p>
<p>If the resource owner denies the access request or if the request fails
for reasons other than a missing or invalid redirection URI,
the authorization server informs the client by adding the following parameters
to the <strong>fragment component</strong> of the redirection URI using the &#8220;application/x-www-form-urlencoded&#8221; format:</p>
<blockquote>
<div><dl class="docutils">
<dt>error</dt>
<dd><p class="first">REQUIRED.
A single error code from the following:</p>
<dl class="last docutils">
<dt>invalid_request</dt>
<dd>The request is missing a required parameter,
includes an unsupported parameter value, or is otherwise malformed.</dd>
<dt>unauthorized_client</dt>
<dd>The client is not authorized to request an access token
using this method.</dd>
<dt>access_denied</dt>
<dd>The resource owner or authorization server denied the request.</dd>
<dt>unsupported_response_type</dt>
<dd>The authorization server does not support obtaining an access token using this method.</dd>
<dt>invalid_scope</dt>
<dd>The requested scope is invalid, unknown, or malformed.</dd>
<dt>server_error</dt>
<dd>The authorization server encountered an unexpected condition
which prevented it from fulfilling the request.</dd>
<dt>temporarily_unavailable</dt>
<dd>The authorization server is currently unable to handle
the request due to a temporary overloading or maintenance of the server.</dd>
</dl>
</dd>
<dt>error_description</dt>
<dd>OPTIONAL.
A human-readable UTF-8 encoded text providing
additional information, used to assist the client developer in
understanding the error that occurred.</dd>
<dt>error_uri</dt>
<dd>OPTIONAL.  A URI identifying a human-readable web page with
information about the error, used to provide the client
developer with additional information about the error.</dd>
<dt>state</dt>
<dd>REQUIRED if a valid &#8220;state&#8221; parameter was present in the client
authorization request.  The exact value received from the client.</dd>
</dl>
</div></blockquote>
<p>For example, the authorization server redirects the user-agent by
sending the following HTTP response:</p>
<div class="highlight-python"><pre>HTTP/1.1 302 Found
Location: https://client.example.com/cb#error=access_denied&amp;state=xyz</pre>
</div>
</div>
</div>
</div>
<div class="section" id="oauth-4-3">
<span id="id15"></span><h3><a class="toc-backref" href="#id70">4.3.  Resource Owner Password Credentials</a><a class="headerlink" href="#oauth-4-3" title="Permalink to this headline">¶</a></h3>
<p>The resource owner password credentials grant type is suitable in cases
where the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a> has a trust relationship with the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>,
such as its device operating system or a highly privileged application.</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> should take special care
when enabling this grant type, and only allow it when other flows are not viable.</p>
<p>The <a class="reference internal" href="glossary.html#term-grant-type"><em class="xref std std-term">grant type</em></a> is suitable for clients capable of
obtaining the resource owner&#8217;s credentials
(username and password, typically using an interactive form).
It is also used to migrate existing clients using direct authentication schemes
such as HTTP Basic or Digest authentication
to OAuth by converting the stored credentials to an access token.</p>
<p>Figure 5: Resource Owner Password Credentials Flow:</p>
<div class="highlight-python"><pre>+----------+
| Resource |
|  Owner   |
|          |
+----------+
     v
     |    Resource Owner
    (A) Password Credentials
     |
     v
+---------+                                  +---------------+
|         |&gt;--(B)---- Resource Owner -------&gt;|               |
|         |         Password Credentials     | Authorization |
| Client  |                                  |     Server    |
|         |&lt;--(C)---- Access Token ---------&lt;|               |
|         |    (w/ Optional Refresh Token)   |               |
+---------+                                  +---------------+</pre>
</div>
<p>The flow illustrated in Figure 5 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The resource owner provides the client with its username and password.</li>
<li>The client requests an access token from the authorization server&#8217;s token endpoint
by including the credentials received from the resource owner.
When making the request, the client authenticates with the authorization server.</li>
<li>The authorization server authenticates the client
and validates the resource owner credentials,
and if valid issues an access token.</li>
</ol>
</div></blockquote>
<p>(v.22)</p>
<div class="section" id="authorization-request-and-response">
<span id="oauth-4-3-1"></span><h4><a class="toc-backref" href="#id71">4.3.1.  Authorization Request and Response</a><a class="headerlink" href="#authorization-request-and-response" title="Permalink to this headline">¶</a></h4>
<p>The method through which the client obtains the resource owner
credentials is beyond the scope of this specification.  The client
MUST discard the credentials once an access token has been obtained.</p>
<p>(v.22)</p>
</div>
<div class="section" id="oauth-4-3-2">
<span id="id16"></span><h4><a class="toc-backref" href="#id72">4.3.2.  Access Token Request</a><a class="headerlink" href="#oauth-4-3-2" title="Permalink to this headline">¶</a></h4>
<p>The client makes a request to the token endpoint by adding the
following parameters using the &#8220;application/x-www-form-urlencoded&#8221;
format in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-41">grant_type</dt>
<dd>REQUIRED.
Value MUST be set to &#8220;password&#8221;.</dd>
<dt id="term-username">username</dt>
<dd>REQUIRED.
The resource owner username, encoded as UTF-8.</dd>
<dt id="term-password">password</dt>
<dd>REQUIRED.
The resource owner password, encoded as UTF-8.</dd>
<dt id="term-44">scope</dt>
<dd>OPTIONAL.
The scope of the access request as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a> .</dd>
</dl>
<p>If the client type is <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a> or the client was issued client
credentials (or assigned other authentication requirements), the
client MUST authenticate with the authorization server as described
in <a class="reference internal" href="#oauth-3-2-1"><em>Section 3.2.1</em></a>.</p>
<p>For example, the client makes the following HTTP request using
transport-layer security (extra line breaks are for display purposes
only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=password&amp;username=johndoe&amp;password=A3ddj3w</pre>
</div>
<p>The authorization server MUST:</p>
<blockquote>
<div><ul class="simple">
<li>require client authentication for <a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">confidential clients</em></a>
or for any client that was issued <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>
(or with other authentication requirements),</li>
<li>authenticate the client if client authentication is included, and</li>
<li>validate the resource owner password credentials.</li>
</ul>
</div></blockquote>
<p>Since this access token request utilizes the resource owner&#8217;s
password, the authorization server MUST protect the endpoint against
<em class="xref std std-term">brute force attacks</em>
(e.g. using rate-limitation or generating alerts).</p>
<p>(v.23)</p>
</div>
<div class="section" id="oauth-4-3-3">
<span id="id17"></span><h4><a class="toc-backref" href="#id73">4.3.3.  Access Token Response</a><a class="headerlink" href="#oauth-4-3-3" title="Permalink to this headline">¶</a></h4>
<p>If the access token request is valid and authorized,
the authorization server issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> and optional <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>
as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a>.
If the request failed client authentication or is invalid,
the authorization server returns an error response as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>An example successful response :</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "example_parameter":"example_value"
}</pre>
</div>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="oauth-4-4">
<span id="id18"></span><h3><a class="toc-backref" href="#id74">4.4.  Client Credentials</a><a class="headerlink" href="#oauth-4-4" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">(Confidential) Client can get  access tokens at Token Endpoint by presenting its credential.</p>
</div>
<p>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> can request an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
using only its client credentials
(or other supported means of authentication)
when the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> is requesting access to the <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>
under its control, or those of another resource owner
which has been previously arranged with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
(the method of which is beyond the scope of this specification).</p>
<p>The <em class="xref std std-term">client credentials grant type</em> MUST only be used by <a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">confidential clients</em></a>.</p>
<div class="highlight-python"><pre>+---------+                                  +---------------+
|         |                                  |               |
|         |&gt;--(A)- Client Authentication ---&gt;| Authorization |
| Client  |                                  |     Server    |
|         |&lt;--(B)---- Access Token ---------&lt;|               |
|         |                                  |               |
+---------+                                  +---------------+


                Figure 6: Client Credentials Flow</pre>
</div>
<p>The flow illustrated in Figure 6 includes the following steps:</p>
<blockquote>
<div><ol class="upperalpha simple">
<li>The <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a> authenticates with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> and
requests an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> from the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.</li>
<li>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> authenticates the <a class="reference internal" href="#term-client"><em class="xref std std-term">client</em></a>,
and if valid issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.</li>
</ol>
</div></blockquote>
<p>(v.23 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4</a>)</p>
<div class="section" id="oauth-4-4-1">
<span id="id19"></span><h4><a class="toc-backref" href="#id75">4.4.1. Authorization Request and Response</a><a class="headerlink" href="#oauth-4-4-1" title="Permalink to this headline">¶</a></h4>
<p>Since the client authentication is used as the <a class="reference internal" href="#term-authorization-grant"><em class="xref std std-term">authorization grant</em></a>,
no additional authorization request is needed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Credential = Grant.</p>
<p class="last">Means not grant request stage. Directly to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a> !.</p>
</div>
<p>(draft 23)</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.1</a> )</p>
</div>
<div class="section" id="oauth-4-4-2">
<span id="id20"></span><h4><a class="toc-backref" href="#id76">4.4.2. Access Token Request</a><a class="headerlink" href="#oauth-4-4-2" title="Permalink to this headline">¶</a></h4>
<p>The client makes a request to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>
by adding the following parameters
using the &#8220;application/x-www-form-urlencoded&#8221; format
in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-45">grant_type</dt>
<dd>REQUIRED.
Value MUST be set to &#8220;<a class="reference internal" href="glossary.html#term-342"><em class="xref std std-term">client_credentials</em></a>&#8221;.</dd>
<dt id="term-46">scope</dt>
<dd>OPTIONAL.
The scope of the access request as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="standard.html#term-23"><em class="xref std std-term">scope</em></a> can be spefified beause there is no previous grant request stage
for Clients can specify it.</p>
</div>
<p>The client MUST authenticate
with the authorization server as described in <a class="reference internal" href="#oauth-3-2"><em>Section 3.2.1</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Authentication method at <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a> can be different
betwee normatl token requeset  and client credentioals flows&#8217; one with
assertion. ( See <a class="reference internal" href="oauth_jwt_bearer.html"><em>JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</em></a> )</p>
</div>
<p>For example,
the client makes the following HTTP request
using transport-layer security
(extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=client_credentials</pre>
</div>
<p>The authorization server MUST authenticate the client.</p>
<p>(draft 23)</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.2">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.2</a> )</p>
</div>
<div class="section" id="oauth-4-4-3">
<span id="id21"></span><h4><a class="toc-backref" href="#id77">4.4.3. Access Token Response</a><a class="headerlink" href="#oauth-4-4-3" title="Permalink to this headline">¶</a></h4>
<p>If the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> request is valid and authorized,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a>.
A <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> SHOULD NOT be included.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No refresh token is returned in Client Credentials flow.</p>
</div>
<p>If the request failed client authentication or is invalid,
the authorization server returns an error response
as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>An example successful response:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "example_parameter":"example_value"
}</pre>
</div>
<p>(draft 23)</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.3">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-4.4.3</a> )</p>
</div>
</div>
<div class="section" id="extensions">
<span id="oauth-4-5"></span><h3><a class="toc-backref" href="#id78">4.5.  Extensions</a><a class="headerlink" href="#extensions" title="Permalink to this headline">¶</a></h3>
<p>The client uses an extension <a class="reference internal" href="glossary.html#term-grant-type"><em class="xref std std-term">grant type</em></a> by specifying the grant type
using an absolute URI (defined by the authorization server)
as the value of the &#8220;<a class="reference internal" href="#term-52"><em class="xref std std-term">grant_type</em></a>&#8221; parameter of the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>,
and by adding any additional parameters necessary.</p>
<p>For example,
to request an access token using a SAML 2.0 assertion grant type
as defined by [I-D.ietf-oauth-saml2-bearer],
the client makes the following HTTP request using transport-layer security
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Asaml2-
bearer&amp;assertion=PEFzc2VydGlvbiBJc3N1ZUluc3RhbnQ9IjIwMTEtMDU
[...omitted for brevity...]aG5TdGF0ZW1lbnQ-PC9Bc3NlcnRpb24-</pre>
</div>
<p>If the access token request is valid and authorized,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues an access token and optional refresh token
as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a>.
If the request failed client authentication or is invalid,
the authorization server returns an error response as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="issuing-an-access-token">
<span id="oauth-5"></span><h2><a class="toc-backref" href="#id79">5.  Issuing an Access Token</a><a class="headerlink" href="#issuing-an-access-token" title="Permalink to this headline">¶</a></h2>
<p>If the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> request is valid and authorized,
the authorization server issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> and optional <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>
as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a> .</p>
<p>If the request failed client authentication or is invalid,
the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> returns
an error response as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>(v.23, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-5">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-5</a>)</p>
<div class="section" id="successful-response">
<span id="oauth-5-1"></span><h3><a class="toc-backref" href="#id80">5.1.  Successful Response</a><a class="headerlink" href="#successful-response" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issues an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
and optional <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>,
and constructs the response by adding the following parameters
to the entity body of the HTTP response with a 200 (OK) status code:</p>
<dl class="glossary docutils">
<dt id="term-47">access_token</dt>
<dd>REQUIRED.
The <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> issued by the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</dd>
<dt id="term-48">token_type</dt>
<dd>REQUIRED.
The type of the token issued as described in <a class="reference internal" href="#oauth-7-1"><em>Section 7.1</em></a>.
Value is <strong>case insensitive</strong>.</dd>
<dt id="term-49">expires_in</dt>
<dd>OPTIONAL.
The lifetime in seconds of the access token.
For example, the value &#8220;3600&#8221; denotes that the access token will
expire in one hour from the time the response was generated.</dd>
<dt id="term-refresh-token">refresh_token</dt>
<dd>OPTIONAL.
The <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> which can be used to obtain new access tokens
using the same authorization grant as described in <a class="reference internal" href="#oauth-6"><em>Section 6</em></a>.</dd>
<dt id="term-51">scope</dt>
<dd>OPTIONAL.
The scope of the access token as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.</dd>
</dl>
<p>The parameters are included in the entity body of the HTTP response
using the &#8220;application/json&#8221; media type as defined by [RFC4627].</p>
<p>The parameters are serialized into a JSON structure by adding each parameter
at the highest structure level.
Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers.
The order of parameters does not matter and can vary.</p>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST include the HTTP &#8220;<em class="xref std std-term">Cache-Control</em>&#8221; response header field [<a class="reference internal" href="standard.html#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>]
with a value of &#8220;<strong>no-store</strong>&#8221; in any response containing tokens, credentials,
or other sensitive information,
as well as the &#8220;<em class="xref std std-term">Pragma</em>&#8221; response header field [<a class="reference internal" href="standard.html#term-rfc2616"><em class="xref std std-term">RFC2616</em></a>] with a value of &#8220;<strong>no-cache</strong>&#8221;.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "example_parameter":"example_value"
}</pre>
</div>
<p>The client <strong>MUST</strong> ignore unrecognized response parameters in the response.
The sizes of tokens and other values received from the authorization server are left undefined.
The client should avoid making assumptions about value sizes.
The authorization server should document the size of any value it issues.</p>
<p>(v.23, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-5.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-23#section-5.1</a> )</p>
</div>
<div class="section" id="oauth-5-2">
<span id="id22"></span><h3><a class="toc-backref" href="#id81">5.2. Error Response</a><a class="headerlink" href="#oauth-5-2" title="Permalink to this headline">¶</a></h3>
<p>The authorization server responds with an HTTP 400 (Bad Request)
status code and includes the following parameters with the response:</p>
<blockquote>
<div><dl class="docutils">
<dt>error</dt>
<dd><blockquote class="first">
<div><p>REQUIRED.  A single error code from the following:</p>
<dl class="docutils">
<dt>invalid_request</dt>
<dd>The request is missing a required parameter,
includes an unsupported parameter or parameter value,
repeats a parameter,
includes multiple credentials,
utilizes more than one mechanism for authenticating the client,
or is otherwise malformed.</dd>
</dl>
</div></blockquote>
<dl class="last docutils">
<dt>invalid_client</dt>
<dd><blockquote class="first">
<div><p>Client authentication failed
(e.g. unknown client,
no client authentication included,
or unsupported authentication method).</p>
<p>The authorization server MAY return an HTTP 401 (Unauthorized) status code
to indicate which HTTP authentication schemes are supported.
If the client attempted to authenticate via the &#8220;<strong>Authorization</strong>&#8221; request header field,
the authorization server MUST respond with an HTTP 401 (Unauthorized) status code,
and include the &#8220;WWW-Authenticate&#8221; response header field matching the authentication scheme used by the client.</p>
</div></blockquote>
<dl class="last docutils">
<dt>invalid_grant</dt>
<dd>The provided authorization grant
(e.g. authorization code,
resource owner credentials,
client credentials) is
invalid,
expired,
revoked,
does not match the redirection URI used in the authorization request,
or was issued to another client.</dd>
<dt>unauthorized_client <a class="footnote-reference" href="#id24" id="id23">[6]</a></dt>
<dd>The authenticated client is not authorized to use this authorization grant type.</dd>
<dt>unsupported_grant_type</dt>
<dd>The authorization grant type is not supported by the authorization server.</dd>
<dt>invalid_scope</dt>
<dd>The requested scope is invalid,
unknown,
malformed, or
exceeds the scope granted by the resource owner.</dd>
</dl>
</dd>
</dl>
</dd>
<dt>error_description</dt>
<dd>OPTIONAL.
A human-readable UTF-8 encoded text providing additional information,
used to assist the client developer in understanding the error that occurred.</dd>
<dt>error_uri</dt>
<dd>OPTIONAL.
A URI identifying a human-readable web page with information about the error,
used to provide the client developer with additional information about the error.</dd>
</dl>
</div></blockquote>
<table class="docutils footnote" frame="void" id="id24" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id23">[6]</a></td><td>&#8220;client credentials&#8221; is handled by &#8220;invalid_grant&#8221; error. What exactly &#8220;unauthorized_client&#8221; mean?</td></tr>
</tbody>
</table>
<p>The parameters are included in the entity body of the HTTP response
using the &#8220;application/json&#8221; media type as defined by [RFC4627].
The parameters are serialized into a JSON structure by adding each parameter
at the highest structure level.
Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers.
The order of parameters does not matter and can vary.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache

{
  "error":"invalid_request"
}</pre>
</div>
</div>
</div>
<div class="section" id="refreshing-an-access-token">
<span id="oauth-6"></span><h2><a class="toc-backref" href="#id82">6.  Refreshing an Access Token</a><a class="headerlink" href="#refreshing-an-access-token" title="Permalink to this headline">¶</a></h2>
<p>If the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> issued a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a> to the client,
the client makes a refresh request to the <a class="reference internal" href="#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>
by adding the following parameters
using the &#8220;application/x-www-form-urlencoded&#8221; format in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-52">grant_type</dt>
<dd>REQUIRED.
Value MUST be set to &#8220;<strong>refresh_token</strong>&#8221;.</dd>
<dt id="term-53">refresh_token</dt>
<dd>REQUIRED.
The refresh token issued to the client.</dd>
<dt id="term-54">scope</dt>
<dd>OPTIONAL.
The scope of the access request as described by <a class="reference internal" href="#oauth-3-3"><em>Section 3.3</em></a>.
The requested scope MUST NOT include any scope
not originally granted by the resource owner,
and if omitted is treated as equal to the scope originally granted by the <a class="reference internal" href="#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.</dd>
</dl>
<p>Because refresh tokens are typically <strong>long-lasting credentials</strong>
used to request additional access tokens,
the refresh token is bound to the client it was issued.</p>
<p>If the client type is <a class="reference internal" href="#term-confidential"><em class="xref std std-term">confidential</em></a> or the client was issued client credentials
(or assigned other authentication requirements),
the client MUST authenticate with the <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
as described in <a class="reference internal" href="#oauth-3-2-1"><em>Section 3.2.1</em></a>.</p>
<p>For example, the client makes the following HTTP request
using transport-layer security
(extra line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token HTTP/1.1
Host: server.example.com
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
Content-Type: application/x-www-form-urlencoded;charset=UTF-8

grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA</pre>
</div>
<p>The <a class="reference internal" href="#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST:</p>
<blockquote>
<div><ul class="simple">
<li>require <strong>client authentication</strong>
for <a class="reference internal" href="#term-confidential-clients"><em class="xref std std-term">confidential clients</em></a>
or for any client that was issued <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>
(or with other authentication requirements),</li>
<li>authenticate the client if client authentication is included and
ensure the refresh token was issued to the authenticated client,
and</li>
<li>validate the refresh token.</li>
</ul>
</div></blockquote>
<p>If valid and authorized, the authorization server issues an access
token as described in <a class="reference internal" href="#oauth-5-1"><em>Section 5.1</em></a>.
If the request failed verification or is invalid,
the authorization server returns an error response as described in <a class="reference internal" href="#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>The authorization server MAY issue a new refresh token,
in which case the client MUST <strong>discard the old refresh token</strong>
and replace it with the new refresh token.</p>
<p>The authorization server MAY revoke the old refresh token
after issuing a new refresh token to the client.
If a new refresh token is issued,
the refresh token scope MUST be identical to that of the refresh token
included by the client in the request.</p>
<p>(v.22)</p>
</div>
<div class="section" id="accessing-protected-resources">
<span id="oauth-7"></span><h2><a class="toc-backref" href="#id83">7. Accessing Protected Resources</a><a class="headerlink" href="#accessing-protected-resources" title="Permalink to this headline">¶</a></h2>
<p>The client accesses protected resources by presenting the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> to the resource server.
The resource server MUST validate the access token and ensure it has not expired
and that its scope covers the requested resource.</p>
<p>The methods used by the resource server to validate the access token (as well as any error responses) are beyond the scope of this specification,
but generally involve an interaction or coordination between the resource server and the authorization server.</p>
<p>The method in which the client utilized the access token to authenticate with the resource server
depends on the type of access token issued by the authorization server.
Typically, it involves using the HTTP &#8220;Authorization&#8221; request header field [<span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2617.html"><strong>RFC 2617</strong></a>]
with an authentication scheme defined by the access token type specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>v21</li>
<li><strong>Access Token</strong> Valication.  Expiry and Scope.</li>
<li>Authroization header is <strong>typicall</strong> method</li>
</ul>
</div>
<p>(v22)</p>
<div class="section" id="access-token-types">
<span id="oauth-7-1"></span><h3><a class="toc-backref" href="#id84">7.1. Access Token Types</a><a class="headerlink" href="#access-token-types" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">&#8220;token_type&#8221; is one of  &#8220;bearer&#8221; or &#8220;mac&#8221; as of Draft 22 of OAuth2</p>
</div>
<p>The <strong>access token type</strong> provides the client
with the information required to successfully utilize the access token to make a protected resource request
(along with type-specific attributes).
The client MUST NOT use an access token if it does not understand or does not trust the token type.</p>
<p>For example, the <strong>&#8220;bearer&#8221;</strong> token type defined in
[<a class="reference internal" href="bearer.html"><em>I-D.ietf-oauth-v2-bearer</em></a>] is utilized by simply including the access token string in the request:</p>
<div class="highlight-python"><pre>GET /resource/1 HTTP/1.1
Host: example.com
Authorization: Bearer 7Fjfp0ZBr1KtDRbnfVdmIw</pre>
</div>
<p>while the <strong>&#8220;mac&#8221;</strong> token type defined in [I-D.ietf-oauth-v2-http-mac] is
utilized by issuing a MAC key together with the access token
which is used to sign certain components of the HTTP requests:</p>
<div class="highlight-python"><pre>GET /resource/1 HTTP/1.1
Host: example.com
Authorization: MAC id="h480djs93hd8",
                   nonce="274312:dj83hs9s",
                   mac="kDZvddkndxvhGRXZhvuDjEWhGeE="</pre>
</div>
<p>The above examples are provided for illustration purposes only.</p>
<p>Developers are advised to consult the [<a class="reference internal" href="bearer.html"><em>I-D.ietf-oauth-v2-bearer</em></a>] and
[I-D.ietf-oauth-v2-http-mac] specifications before use.</p>
<p>Each access token type definition specifies the additional attributes
(if any) sent to the client together with the &#8220;<a class="reference internal" href="standard.html#term-30"><em class="xref std std-term">access_token</em></a>&#8221; response parameter.</p>
<p>It also defines the HTTP authentication method used to
include the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> when making a <em class="xref std std-term">protected resource request</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>v22</li>
<li>OAuth only specify that access_token with token_type MUST be given to the protected resource endpoint.</li>
</ul>
</div>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="extensibility">
<span id="oauth-8"></span><h2><a class="toc-backref" href="#id85">8. Extensibility</a><a class="headerlink" href="#extensibility" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="defining-new-authorization-endpoint-response-types">
<span id="oauth-8-4"></span><h3><a class="toc-backref" href="#id86">8.4. Defining New Authorization Endpoint Response Types</a><a class="headerlink" href="#defining-new-authorization-endpoint-response-types" title="Permalink to this headline">¶</a></h3>
<p>New <a class="reference internal" href="glossary.html#term-response-types"><em class="xref std std-term">response types</em></a> for use with the <a class="reference internal" href="#term-authorization-endpoint"><em class="xref std std-term">authorization endpoint</em></a>
are defined and registered in the <a class="reference internal" href="oauth_responses.html#term-authorization-endpoint-response-type-registry"><em class="xref std std-term">authorization endpoint response type registry</em></a>
following the procedure in <a class="reference internal" href="#oauth-11-3"><em>Section 11.3</em></a>.
<em class="xref std std-term">Response type names</em> MUST conform to the response-type <em class="xref std std-term">ABNF</em>.</p>
<div class="highlight-python"><pre>response-type  = response-name *( SP response-name )
response-name  = 1*response-char
response-char  = "_" / DIGIT / ALPHA</pre>
</div>
<p>If a <a class="reference internal" href="oauth_responses.html#term-response-type"><em class="xref std std-term">response type</em></a> contains one of more space characters (%x20),
it is compared as a space-delimited list of values
in which the order of values does not matter.
Only one order of values can be registered,
which covers all other arrangements of the same set of values.</p>
<p>For example,
the response type &#8220;token code&#8221; is left undefined by this specification.
However,
an extension can define and register the &#8220;token code&#8221; response type.
Once registered,
the same combination cannot be registered as &#8220;code token&#8221;,
but both values can be used to denote the same response type.</p>
<p>(v.22)</p>
</div>
</div>
<div class="section" id="native-applications">
<span id="oauth-9"></span><h2><a class="toc-backref" href="#id87">9.  Native Applications</a><a class="headerlink" href="#native-applications" title="Permalink to this headline">¶</a></h2>
<p>Native applications are clients installed and executed on the device
used by the resource owner (i.e. desktop application, native mobile
application).  Native applications require special consideration
related to security, platform capabilities, and overall end-user
experience.</p>
<p>The authorization endpoint requires interaction between the client
and the resource owner&#8217;s user-agent.  Native applications can invoke
an external user-agent or embed a user-agent within the application.
For example:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  External user-agent - the native application can capture the</dt>
<dd>response from the authorization server using a redirection URI
with a scheme registered with the operating system to invoke the
client as the handler, manual copy-and-paste of the credentials,
running a local web server, installing a user-agent extension, or
by providing a redirection URI identifying a server-hosted
resource under the client&#8217;s control, which in turn makes the
response available to the native application.</dd>
<dt>o  Embedded user-agent - the native application obtains the response</dt>
<dd>by directly communicating with the embedded user-agent by
monitoring state changes emitted during the resource load, or
accessing the user-agent&#8217;s cookies storage.</dd>
</dl>
</div></blockquote>
<p>When choosing between an external or embedded user-agent, developers
should consider:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  External user-agents may improve completion rate as the resource</dt>
<dd>owner may already have an active session with the authorization
server removing the need to re-authenticate.  It provides a
familiar end-user experience and functionality.  The resource
owner may also rely on user-agent features or extensions to assist
with authentication (e.g. password manager, 2-factor device
reader).</dd>
<dt>o  Embedded user-agents may offer improved usability, as they remove</dt>
<dd>the need to switch context and open new windows.</dd>
<dt>o  Embedded user-agents pose a security challenge because resource</dt>
<dd>owners are authenticating in an unidentified window without access
to the visual protections found in most external user-agents.
Embedded user-agents educate end-user to trust unidentified
requests for authentication (making phishing attacks easier to
execute).</dd>
</dl>
</div></blockquote>
<p>When choosing between the implicit grant type and the authorization
code grant type, the following should be considered:</p>
<blockquote>
<div><dl class="docutils">
<dt>o  Native applications that use the authorization code grant type</dt>
<dd>SHOULD do so without using client credentials, due to the native
application&#8217;s inability to keep <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a> confidential.</dd>
<dt>o  When using the implicit grant type flow a refresh token is not</dt>
<dd>returned which requires repeating the authorization process once
the access token expires.</dd>
</dl>
</div></blockquote>
<p>(v.23)</p>
</div>
<div class="section" id="security-considerations">
<span id="oauth-10"></span><h2><a class="toc-backref" href="#id88">10. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>As a flexible and extensible framework, OAuth&#8217;s security considerations depend on many factors.
The following sections provide implementers with security guidelines
focused on the three client profiles described in Section 2.1: web application,
user-agent-based application, and native application.</p>
<p>A comprehensive OAuth security model and analysis,
as well as background for the protocol design is provided by [I-D.ietf-oauth-v2-threatmodel].</p>
</div>
<div class="section" id="iana-considerations">
<span id="oauth-11"></span><h2><a class="toc-backref" href="#id89">11.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="the-oauth-parameters-registry">
<span id="oauth-11-2"></span><h3><a class="toc-backref" href="#id90">11.2.  The OAuth Parameters Registry</a><a class="headerlink" href="#the-oauth-parameters-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the OAuth parameters registry.</p>
<p>Additional parameters for inclusion in
the <a class="reference internal" href="glossary.html#term-authorization-endpoint-request"><em class="xref std std-term">authorization endpoint request</em></a>,
the <a class="reference internal" href="glossary.html#term-authorization-endpoint-response"><em class="xref std std-term">authorization endpoint response</em></a>,
the <a class="reference internal" href="glossary.html#term-token-endpoint-request"><em class="xref std std-term">token endpoint request</em></a>, or
the <a class="reference internal" href="glossary.html#term-token-endpoint-response"><em class="xref std std-term">token endpoint response</em></a> are registered
on the advice of one or more <a class="reference internal" href="glossary.html#term-designated-experts"><em class="xref std std-term">Designated Experts</em></a>
(appointed by the IESG or their delegate),
with a <a class="reference internal" href="glossary.html#term-specification-required"><em class="xref std std-term">Specification Required</em></a> (using terminology from [<a class="reference internal" href="#term-rfc5226"><em class="xref std std-term">RFC5226</em></a>]).</p>
<p>However,
to allow for the allocation of values prior to publication,
the <a class="reference internal" href="glossary.html#term-designated-experts"><em class="xref std std-term">Designated Expert(s)</em></a> may approve registration
once they are satisfied that such a specification will be published.</p>
<p>Registration requests should be sent to the <strong>[TBD]&#64;ietf.org</strong> mailing list
for review and comment,
with an appropriate subject (e.g., &#8220;Request for parameter: example&#8221;).
[[ Note to RFC-EDITOR:
The name of the mailing list should be determined in consultation
with the <a class="reference internal" href="glossary.html#term-iesg"><em class="xref std std-term">IESG</em></a> and <a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a>.
Suggested name: <strong>oauth-ext-review</strong>. ]]</p>
<p>Within at most 14 days of the request, the
Designated Expert(s) will either approve
or deny the registration request,
communicating this decision to the review list and <a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a>.
Denials should include an explanation and,
if applicable, suggestions as to how to make the request successful.</p>
<p>Decisions (or lack thereof) made by the Designated Expert(s)
can be first appealed to <em class="xref std std-term">Application Area Directors</em>
(contactable using <a class="reference external" href="mailto:app-ads&#37;&#52;&#48;tools&#46;ietf&#46;org">app-ads<span>&#64;</span>tools<span>&#46;</span>ietf<span>&#46;</span>org</a> email address
or directly by looking up their email addresses on <a class="reference external" href="http://www.iesg.org/">http://www.iesg.org/</a> website)
and, if the appellant is not satisfied with the response,
to the full <a class="reference internal" href="glossary.html#term-iesg"><em class="xref std std-term">IESG</em></a> (using the <a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list).</p>
<p><a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a> should only accept registry updates from the Designated Expert(s),
and should direct all requests for registration to the review mailing list.</p>
<p>(v.22)</p>
</div>
<div class="section" id="the-oauth-authorization-endpoint-response-type-registry">
<span id="oauth-11-3"></span><h3><a class="toc-backref" href="#id91">11.3. The OAuth Authorization Endpoint Response Type Registry</a><a class="headerlink" href="#the-oauth-authorization-endpoint-response-type-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the OAuth authorization endpoint
response type registry.</p>
<p>Additional response type for use with the authorization endpoint are
registered on the advice of one or more Designated Experts (appointed
by the IESG or their delegate), with a Specification Required (using
terminology from [RFC5226]).  However, to allow for the allocation of
values prior to publication, the Designated Expert(s) may approve
registration once they are satisfied that such a specification will
be published.</p>
<p>Registration requests should be sent to the [TBD]&#64;ietf.org mailing
list for review and comment, with an appropriate subject (e.g.,
&#8220;Request for response type: example&#8221;). [[ Note to RFC-EDITOR: The
name of the mailing list should be determined in consultation with
the IESG and IANA.  Suggested name: oauth-ext-review. ]]</p>
<p>Within at most 14 days of the request, the Designated Expert(s) will
either approve or deny the registration request, communicating this
decision to the review list and IANA.  Denials should include an
explanation and, if applicable, suggestions as to how to make the
request successful.</p>
<p>Decisions (or lack thereof) made by the Designated Expert(s) can be
first appealed to Application Area Directors (contactable using
<a class="reference external" href="mailto:app-ads&#37;&#52;&#48;tools&#46;ietf&#46;org">app-ads<span>&#64;</span>tools<span>&#46;</span>ietf<span>&#46;</span>org</a> email address or directly by looking up their
email addresses on <a class="reference external" href="http://www.iesg.org/">http://www.iesg.org/</a> website) and, if the
appellant is not satisfied with the response, to the full IESG (using
the <a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list).</p>
<p>IANA should only accept registry updates from the Designated
Expert(s), and should direct all requests for registration to the
review mailing list.</p>
<p>(v.22)</p>
</div>
<div class="section" id="the-oauth-extensions-error-registry">
<span id="oauth-11-4"></span><h3><a class="toc-backref" href="#id92">11.4. The OAuth Extensions Error Registry</a><a class="headerlink" href="#the-oauth-extensions-error-registry" title="Permalink to this headline">¶</a></h3>
<p>This specification establishes the OAuth extensions error registry.</p>
<p>Additional error codes used together with other protocol extensions
(i.e. extension grant types, access token types, or extension parameters)
are registered on the advice of one or more Designated Experts
(appointed by the IESG or their delegate), with a Specification Required
(using terminology from [RFC5226]).
However, to allow for the allocation of values prior to publication,
the Designated Expert(s) may approve registration
once they are satisfied that such a specification will be published.</p>
<p>Registration requests should be sent to the [TBD]&#64;ietf.org mailing list
for review and comment, with an appropriate subject
(e.g., &#8220;Request for error code: example&#8221;).
[[ Note to RFC-EDITOR: The name of the mailing list should be determined
in consultation with the IESG and IANA.
Suggested name: oauth-ext-review. ]]</p>
<p>Within at most 14 days of the request,
the Designated Expert(s) will either approve or deny the registration request,
communicating this decision to the review list and IANA.
Denials should include an explanation and,
if applicable, suggestions as to how to make the request successful.</p>
<p>Decisions (or lack thereof) made by the Designated Expert can be first appealed
to Application Area Directors
(contactable using <a class="reference external" href="mailto:app-ads&#37;&#52;&#48;tools&#46;ietf&#46;org">app-ads<span>&#64;</span>tools<span>&#46;</span>ietf<span>&#46;</span>org</a> email address or directly by looking up their email addresses
on <a class="reference external" href="http://www.iesg.org/">http://www.iesg.org/</a> website) and,
if the appellant is not satisfied with the response, to the full IESG
(using the <a class="reference external" href="mailto:iesg&#37;&#52;&#48;iesg&#46;org">iesg<span>&#64;</span>iesg<span>&#46;</span>org</a> mailing list).</p>
<p>IANA should only accept registry updates from the Designated Expert(s),
and should direct all requests for registration to the review mailing list.</p>
</div>
</div>
<div class="section" id="references">
<span id="oauth-13"></span><h2><a class="toc-backref" href="#id93">13.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(v.22)</p>
<div class="section" id="normative-references">
<span id="oauth-13-1"></span><h3><a class="toc-backref" href="#id94">13.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2246">RFC2246</dt>
<dd>Dierks, T. and C. Allen, &#8220;The TLS Protocol Version 1.0&#8221;,
RFC 2246, January 1999.</dd>
<dt id="term-rfc2616">RFC2616</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
Masinter, L., Leach, P., and T. Berners-Lee, &#8220;Hypertext
Transfer Protocol &#8211; HTTP/1.1&#8221;, RFC 2616, June 1999.</dd>
<dt id="term-rfc2617">RFC2617</dt>
<dd>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
Leach, P., Luotonen, A., and L. Stewart, &#8220;HTTP
Authentication: Basic and Digest Access Authentication&#8221;,
RFC 2617, June 1999.</dd>
<dt id="term-rfc2818">RFC2818</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-rfc4627">RFC4627</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4949">RFC4949</dt>
<dd>Shirey, R., &#8220;Internet Security Glossary, Version 2&#8221;,
RFC 4949, August 2007.</dd>
<dt id="term-rfc5226">RFC5226</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc5234">RFC5234</dt>
<dd>Crocker, D. and P. Overell, &#8220;Augmented BNF for Syntax
Specifications: ABNF&#8221;, STD 68, RFC 5234, January 2008.</dd>
<dt id="term-rfc5246">RFC5246</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-w3c-rec-html401-19991224">W3C.REC-html401-19991224</dt>
<dd>Hors, A., Raggett, D., and I. Jacobs, &#8220;HTML 4.01
Specification&#8221;, World Wide Web Consortium
Recommendation REC-html401-19991224, December 1999,
&lt;<a class="reference external" href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.</dd>
</dl>
<p>(v.22)</p>
</div>
<div class="section" id="informative-references">
<span id="oauth-13-2"></span><h3><a class="toc-backref" href="#id95">13.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-draft-hardt-oauth-01">I-D.draft-hardt-oauth-01</dt>
<dd>Hardt, D., Ed., Tom, A., Eaton, B., and Y. Goland, &#8220;OAuth
Web Resource Authorization Profiles&#8221;, January 2010.</dd>
<dt id="term-i-d-ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</dt>
<dd>Mortimore, C., &#8220;SAML 2.0 Bearer Assertion Profiles for
OAuth 2.0&#8221;, draft-ietf-oauth-saml2-bearer-08 (work in
progress), August 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-bearer">I-D.ietf-oauth-v2-bearer</dt>
<dd>Jones, M., Hardt, D., and D. Recordon, &#8220;The OAuth 2.0
Protocol: Bearer Tokens&#8221;, draft-ietf-oauth-v2-bearer-08
(work in progress), July 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-http-mac">I-D.ietf-oauth-v2-http-mac</dt>
<dd>Hammer-Lahav, E., Barth, A., and B. Adida, &#8220;HTTP
Authentication: MAC Access Authentication&#8221;,
draft-ietf-oauth-v2-http-mac-00 (work in progress),
May 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2-threatmodel">I-D.ietf-oauth-v2-threatmodel</dt>
<dd>Lodderstedt, T., McGloin, M., and P. Hunt, &#8220;OAuth 2.0
Threat Model and Security Considerations&#8221;,
draft-ietf-oauth-v2-threatmodel-00 (work in progress),
July 2011.</dd>
<dt id="term-oasis-saml-core-2-0-os">OASIS.saml-core-2.0-os</dt>
<dd>Cantor, S., Kemp, J., Philpott, R., and E. Maler,
&#8220;Assertions and Protocol for the OASIS Security Assertion
Markup Language (SAML) V2.0&#8221;, OASIS Standard saml-core-
2.0-os, March 2005.</dd>
<dt id="term-rfc5849">RFC5849</dt>
<dd>Hammer-Lahav, E., &#8220;The OAuth 1.0 Protocol&#8221;, RFC 5849,
April 2010.</dd>
</dl>
<p>(v.22)</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="index.html">Digital Identity</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_assertion.html">OAuth 2.0 Assertion Profile</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>