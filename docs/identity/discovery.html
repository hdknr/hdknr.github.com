

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OpenID Connect Discovery 1.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OpenID Connect Session Management 1.0" href="session.html" />
    <link rel="prev" title="OpenID Connect Dynamic Client Registration 1.0" href="reg.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>OpenID Connect Discovery 1.0</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="session.html">OpenID Connect Session Management 1.0</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="openid-connect-discovery-1-0">
<h1><a class="toc-backref" href="#id3">OpenID Connect Discovery 1.0</a><a class="headerlink" href="#openid-connect-discovery-1-0" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#openid-connect-discovery-1-0" id="id3">OpenID Connect Discovery 1.0</a><ul>
<li><a class="reference internal" href="#abstract" id="id4">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id5">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-notation-and-conventions" id="id6">1.1.  Requirements Notation and Conventions</a></li>
<li><a class="reference internal" href="#terminology" id="id7">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openid-provider-discovery" id="id8">2.  OpenID Provider Discovery</a><ul>
<li><a class="reference internal" href="#discovery-2-1" id="id9">2.1.  Identifier Normalization</a><ul>
<li><a class="reference internal" href="#user-input-identifier-types" id="id10">2.1.1.  User Input Identifier Types</a></li>
<li><a class="reference internal" href="#normalization-steps" id="id11">2.1.2.  Normalization Steps</a></li>
</ul>
</li>
<li><a class="reference internal" href="#non-normative-examples" id="id12">2.2.  Non-Normative Examples</a><ul>
<li><a class="reference internal" href="#user-input-using-e-mail-address-syntax" id="id13">2.2.1.  User Input Using E-Mail Address Syntax</a></li>
<li><a class="reference internal" href="#user-input-using-url-syntax" id="id14">2.2.2.  User Input Using URL Syntax</a></li>
<li><a class="reference internal" href="#user-input-using-hostname-and-port-syntax" id="id15">2.2.3.  User Input Using Hostname and Port Syntax</a></li>
<li><a class="reference internal" href="#user-input-using-acct-uri-syntax" id="id16">2.2.4.  User Input Using &#8220;acct&#8221; URI Syntax</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#openid-provider-metadata" id="id17">3.  OpenID Provider Metadata</a><ul>
<li><a class="reference internal" href="#opop" id="id18">OPOPについて</a></li>
</ul>
</li>
<li><a class="reference internal" href="#string-operations" id="id19">4.  String Operations</a><ul>
<li><a class="reference internal" href="#openid-provider-configuration-request" id="id20">4.1.  OpenID Provider Configuration Request</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id21">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id22">7.1. Normative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#discovery-8" id="id23">8.  References</a><ul>
<li><a class="reference internal" href="#discovery-8-1" id="id24">8.1. Normative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>Based on <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html">OpenID Connect Discovery 1.0 - draft 17</a></p>
<p>( July 5, 2013 )</p>
<div class="section" id="abstract">
<span id="discovery-abstract"></span><h2><a class="toc-backref" href="#id4">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>OpenID Connect 1.0 is a simple identity layer on top of the <a class="reference internal" href="glossary.html#term-oauth-2-0"><em class="xref std std-term">OAuth 2.0</em></a> protocol.
It allows <a class="reference internal" href="glossary.html#term-clients"><em class="xref std std-term">Clients</em></a> to verify the identity of the <a class="reference internal" href="messages.html#term-end-user"><em class="xref std std-term">End-User</em></a>
based on the authentication performed by an <a class="reference internal" href="glossary.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>,
as well as to obtain basic profile information about the <a class="reference internal" href="messages.html#term-end-user"><em class="xref std std-term">End-User</em></a> in an interoperable and <a class="reference internal" href="glossary.html#term-restful-manner"><em class="xref std std-term">RESTful manner</em></a>.</p>
<p>This specification provides a mechanism for the OpenID Connect <a class="reference internal" href="glossary.html#term-client"><em class="xref std std-term">client</em></a>
to discover the <a class="reference internal" href="messages.html#term-end-user"><em class="xref std std-term">user</em></a>&#8216;s <a class="reference internal" href="basic.html#term-openid-provider"><em class="xref std std-term">OpenID Provider</em></a>
as well as the necessary endpoints used by the OpenID Connect protocol suite.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>May 25, 2012, Draft 09 is available</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="discovery-1"></span><h2><a class="toc-backref" href="#id5">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In order for an OpenID Client
to utilize OpenID Connect services for a user,
the Client needs to know where the OpenID Provider is.
OpenID Connect uses <a class="reference internal" href="glossary.html#term-simple-web-discovery"><em class="xref std std-term">Simple Web Discovery</em></a> [<a class="reference internal" href="#term-72"><em class="xref std std-term">SWD</em></a>]
to locate the OpenID Provider for an End-User.</p>
<p>Once an OpenID Provider is identified,
the endpoint and other configuration information
for that OP is retrieved from a well-known location as a JSON document.</p>
<p>(draft 07, Dec ,22, 2011)</p>
<div class="section" id="requirements-notation-and-conventions">
<span id="discovery-1-1"></span><h3><a class="toc-backref" href="#id6">1.1.  Requirements Notation and Conventions</a><a class="headerlink" href="#requirements-notation-and-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;, &#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this document are to be interpreted as described in RFC 2119 [RFC2119].</p>
<p>Throughout this document, values are quoted to indicate that they are to be taken literally. When using these values in protocol messages, the quotes MUST NOT be used as part of the value.</p>
<p>(Draft 07, Dec 22,2011 )</p>
</div>
<div class="section" id="terminology">
<span id="discovery-1-2"></span><h3><a class="toc-backref" href="#id7">1.2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>This specification uses the terms
&#8220;<a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">Access Token</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">Refresh Token</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-authorization-code"><em class="xref std std-term">Authorization Code</em></a>&#8221;,
&#8220;<em class="xref std std-term">Authorization Grant</em>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-authorization-endpoint"><em class="xref std std-term">Authorization Endpoint</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-client"><em class="xref std std-term">Client</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-client-identifier"><em class="xref std std-term">Client Identifier</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-225"><em class="xref std std-term">Client Secret</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-protected-resource"><em class="xref std std-term">Protected Resource</em></a>&#8221;,
&#8220;<a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">Resource Owner</em></a>&#8221;,
&#8220;<a class="reference internal" href="glossary.html#term-resource-server"><em class="xref std std-term">Resource Server</em></a>&#8221;, and
&#8220;<a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">Token Endpoint</em></a>&#8221;
defined by OAuth 2.0 [<a class="reference internal" href="messages.html#term-oauth2-0"><em class="xref std std-term">OAuth2.0</em></a>],
and the terms defined by OpenID Connect Messages 1.0 [<a class="reference internal" href="#term-63"><em class="xref std std-term">OpenID.Messages</em></a>].
This specification also defines the following terms:</p>
<dl class="glossary docutils">
<dt id="term-principal">Principal</dt>
<dd>An Entity that is the target of a request in <a class="reference internal" href="glossary.html#term-simple-web-discovery"><em class="xref std std-term">Simple Web Discovery</em></a>.</dd>
<dt id="term-identifier">Identifier</dt>
<dd>An Identifier is either an http or https URI
(commonly referred to as a URL within this document),
or an account URI.
This document defines various kinds of Identifiers,
designed for use in different contexts.</dd>
</dl>
<p>(draft 07, Dec 22,2011 )</p>
</div>
</div>
<div class="section" id="openid-provider-discovery">
<span id="discovery-provider"></span><span id="discovery-2"></span><h2><a class="toc-backref" href="#id8">2.  OpenID Provider Discovery</a><a class="headerlink" href="#openid-provider-discovery" title="Permalink to this headline">¶</a></h2>
<p>OpenID Provider discovery is OPTIONAL;
if a <a class="reference internal" href="basic.html#term-relying-party"><em class="xref std std-term">Relying Party</em></a> knows the OP information through an out-of-band mechanism,
they can skip this step and proceed to <a class="reference internal" href="#discovery-4"><em>Section 4</em></a>.</p>
<p>Provider discovery requires the following information to make a discovery request:</p>
<dl class="glossary docutils">
<dt id="term-resource">resource</dt>
<dd>Identifier of the target End-User that is the subject of the discovery request.</dd>
<dt id="term-host">host</dt>
<dd>Server where a WebFinger service is hosted.</dd>
<dt id="term-rel">rel</dt>
<dd>URI identifying the type of service whose location is requested.</dd>
</dl>
<p>OpenID Connect uses the following discoverable <a class="reference internal" href="#term-rel"><em class="xref std std-term">rel</em></a> value in <em class="xref std std-term">WebFinger</em> [I‑D.ietf‑appsawg‑webfinger]:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Rel Type</th>
<th class="head">URI</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>OpenID Connect Issuer</td>
<td><a class="reference external" href="http://openid.net/specs/connect/1.0/issuer">http://openid.net/specs/connect/1.0/issuer</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>To start discovery of OpenID endpoints,
the End-User supplies an Identifier to the Client or Relying Party.</p>
<p>The Client applies the <a class="reference internal" href="#discovery-2-1"><em>normalization rules</em></a> to the <a class="reference internal" href="#term-identifier"><em class="xref std std-term">Identifier</em></a>
to determine the Resource and Host.</p>
<p>Then it makes an HTTPS GET request to the Host&#8217;s <em class="xref std std-term">WebFinger</em> [I‑D.ietf‑appsawg‑webfinger] endpoint
with the <a class="reference internal" href="#term-resource"><em class="xref std std-term">resource</em></a> and <a class="reference internal" href="#term-rel"><em class="xref std std-term">rel</em></a> parameters to obtain the location of the requested service.</p>
<p>The <a class="reference internal" href="messages.html#term-issuer"><em class="xref std std-term">Issuer</em></a> MUST be returned in the response.</p>
<p>This includes a <a class="reference internal" href="glossary.html#term-uri-scheme"><em class="xref std std-term">URI scheme</em></a> (which MUST be https), a <a class="reference internal" href="#term-host"><em class="xref std std-term">Host</em></a>, and OPTIONALLY, a port.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li>ユーザーが識別子をRPに入力 (識別子は <a class="reference external" href="https://op.net/path">https://op.net/path</a> )</li>
<li>RPは識別子を正規化 ( -&gt; Resource + Host )</li>
<li>WebFingerでHTTP GET</li>
</ol>
</div>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderDisc">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderDisc</a> )</p>
<div class="section" id="discovery-2-1">
<span id="identifier-normalization"></span><h3><a class="toc-backref" href="#id9">2.1.  Identifier Normalization</a><a class="headerlink" href="#discovery-2-1" title="Permalink to this headline">¶</a></h3>
<p>The purpose of normalization is to determine a normalized Resource and Host from the user input Identifier.
This is then used as input to WebFinger to discover the Issuer.</p>
<p>The user input Identifier SHOULD be a URL or URI relative reference defined in RFC 3986 [RFC3986].
The user input Identifier MUST include the authority component.</p>
<p>Note: A URI relative reference includes a string that looks like an e-mail address
in the form of <a class="reference external" href="mailto:userinfo&#37;&#52;&#48;host">userinfo<span>&#64;</span>host</a>.
This is a valid authority component of a URI
but excludes various possible extra strings allowed in addr-spec syntax of RFC 5322 [RFC5322].</p>
<p>The Identifier normalization rules MAY be extended by additional specifications
to enable other identifier types such as telephone numbers or XRIs [XRI_Syntax_2.0] to also be used.</p>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#IdentifierTypes">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#IdentifierTypes</a> )</p>
<div class="section" id="user-input-identifier-types">
<span id="discovery-2-1-1"></span><h4><a class="toc-backref" href="#id10">2.1.1.  User Input Identifier Types</a><a class="headerlink" href="#user-input-identifier-types" title="Permalink to this headline">¶</a></h4>
<p>A user input Identifier can be categorized into the following types, which require different normalization processes:</p>
<blockquote>
<div><ol class="arabic simple">
<li>User input Identifiers starting with the XRI [XRI_Syntax_2.0] global context symbols (&#8216;=&#8217;,&#8217;&#64;&#8217;, and &#8216;!&#8217;) are RESERVED.
Processing of these identifiers is out of scope for this specification.</li>
<li>All other user input Identifiers MUST be treated as a URI in one of the forms
scheme &#8221;://&#8221; authority path-abempty [ &#8221;?&#8221; query ] [ &#8220;#&#8221; fragment ]
or authority path-abempty [ &#8221;?&#8221; query ] [ &#8220;#&#8221; fragment ]
or scheme &#8221;:&#8221; path-rootless per RFC 3986 [RFC3986].</li>
</ol>
</div></blockquote>
<p>Note: The user input Identifier MAY be in the form of <a class="reference external" href="mailto:userinfo&#37;&#52;&#48;host">userinfo<span>&#64;</span>host</a>.
For the End-User,
this would normally be perceived as being an e-mail address.
However,
it is also a valid userpart &#8220;&#64;&#8221; host section of an acct URI [I‑D.ietf‑appsawg‑acct‑uri],
and this specification treats it such as to exclude various extra strings
allowed in addr-spec of RFC 5322 [RFC5322].</p>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#IdentifierTypes">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#IdentifierTypes</a> )</p>
</div>
<div class="section" id="normalization-steps">
<span id="discovery-2-1-2"></span><h4><a class="toc-backref" href="#id11">2.1.2.  Normalization Steps</a><a class="headerlink" href="#normalization-steps" title="Permalink to this headline">¶</a></h4>
<p>A string of any other type is interpreted as a URI in one of the forms
scheme &#8221;://&#8221; authority path-abempty [ &#8221;?&#8221; query ] [ &#8220;#&#8221; fragment ] or
authority path-abempty [ &#8221;?&#8221; query ] [ &#8220;#&#8221; fragment ] or
scheme &#8221;:&#8221; path-rootless per <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a> [RFC3986]
and is normalized according to the following rules:</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">If the user input Identifier does not have an <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc3986.html"><strong>RFC 3986</strong></a> [RFC3986] scheme portion,
the string is interpreted as [userinfo &#8220;&#64;&#8221;] host [&#8221;:&#8221; port] path-abempty [ &#8221;?&#8221; query ] [ &#8220;#&#8221; fragment ] per RFC 3986 [RFC3986].</p>
</li>
<li><p class="first">If the <em class="xref std std-term">userinfo component</em> is present and all of the scheme component,
path component, query component, and port component are empty, the <em class="xref std std-term">acct</em> scheme is assumed.</p>
<p>In this case,
the normalized URI is formed by prefixing acct: to the string as the scheme.
Per the &#8216;acct&#8217; URI Scheme [I‑D.ietf‑appsawg‑acct‑uri],
if there is an at-sign character (&#8216;&#64;&#8217;) in the userinfo component,
it needs to be percent-encoded as described in RFC 3986 [RFC3986].</p>
</li>
<li><p class="first">For all other inputs without a scheme portion,
the <strong>https</strong> scheme is assumed,
and the normalized URI is formed by prefixing <a class="reference external" href="https://">https://</a> to the string as the scheme.</p>
</li>
<li><p class="first">When the input contains an explicit scheme such as <em class="xref std std-term">acct</em>
that matches the RFC 3986 scheme &#8221;:&#8221; path-rootless syntax,
no input normalization is performed.</p>
</li>
<li><p class="first">If the resulting URI contains a fragment portion,
it MUST be stripped off together with the fragment delimiter character &#8220;#&#8221;.</p>
<p>The <em class="xref std std-term">WebFinger</em> [I‑D.ietf‑appsawg‑webfinger] Resource in this case is
the resulting URI,
and the WebFinger Host is the authority component.</p>
</li>
</ol>
</div></blockquote>
<p>Note: Since the definition of authority in RFC 3986 [RFC3986] is [ userinfo &#8220;&#64;&#8221; ] host [ &#8221;:&#8221; port ],
it is legal to have a user input identifier like <a class="reference external" href="mailto:userinfo&#37;&#52;&#48;host">userinfo<span>&#64;</span>host</a>:port, e.g., <a class="reference external" href="mailto:alice&#37;&#52;&#48;example&#46;com">alice<span>&#64;</span>example<span>&#46;</span>com</a>:8080.</p>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#NormalizationSteps">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#NormalizationSteps</a> )</p>
</div>
</div>
<div class="section" id="non-normative-examples">
<span id="discovery-2-2"></span><h3><a class="toc-backref" href="#id12">2.2.  Non-Normative Examples</a><a class="headerlink" href="#non-normative-examples" title="Permalink to this headline">¶</a></h3>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#Examples">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#Examples</a> )</p>
<div class="section" id="user-input-using-e-mail-address-syntax">
<span id="discovery-2-2-1"></span><h4><a class="toc-backref" href="#id13">2.2.1.  User Input Using E-Mail Address Syntax</a><a class="headerlink" href="#user-input-using-e-mail-address-syntax" title="Permalink to this headline">¶</a></h4>
<p>To find the Issuer for the given user input in the form of an e-mail address <a class="reference external" href="mailto:joe&#37;&#52;&#48;example&#46;com">joe<span>&#64;</span>example<span>&#46;</span>com</a>,
the WebFinger parameters are as follows:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">WebFinger Parameter</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>resource</td>
<td>acct:joe&#64;example.com</td>
</tr>
<tr class="row-odd"><td>host</td>
<td>example.com</td>
</tr>
<tr class="row-even"><td>rel</td>
<td><a class="reference external" href="http://openid.net/specs/connect/1.0/issuer">http://openid.net/specs/connect/1.0/issuer</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Note that in this case,
the <em class="xref std std-term">acct</em>: scheme [I‑D.ietf‑appsawg‑acct‑uri] is prepended to the Identifier.</p>
<p>Following the WebFinger specification, the Client would make the following request to get the discovery information (with line wraps within lines for display purposes only):</p>
<div class="highlight-python"><pre>GET /.well-known/webfinger
  ?resource=acct%3Ajoe%40example.com
  &amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer
  HTTP/1.1
Host: example.com

HTTP/1.1 200 OK
Content-Type: application/jrd+json

{
 "subject": "acct:joe@example.com",
 "links":
  [
   {
    "rel": "http://openid.net/specs/connect/1.0/issuer",
    "href": "https://server.example.com"
   }
  ]
}</pre>
</div>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#EmailSyntax">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#EmailSyntax</a> )</p>
</div>
<div class="section" id="user-input-using-url-syntax">
<span id="discovery-2-2-2"></span><h4><a class="toc-backref" href="#id14">2.2.2.  User Input Using URL Syntax</a><a class="headerlink" href="#user-input-using-url-syntax" title="Permalink to this headline">¶</a></h4>
<p>To find the Issuer for the given URL, <a class="reference external" href="https://example.com/joe">https://example.com/joe</a>,
the WebFinger parameters are as follows:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">WebFinger Parameter</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>resource</td>
<td><a class="reference external" href="https://example.com/joe">https://example.com/joe</a></td>
</tr>
<tr class="row-odd"><td>host</td>
<td>example.com</td>
</tr>
<tr class="row-even"><td>rel</td>
<td><a class="reference external" href="http://openid.net/specs/connect/1.0/issuer">http://openid.net/specs/connect/1.0/issuer</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Following the WebFinger specification,
the Client would make the following request to get the discovery information
(with line wraps within lines for display purposes only):</p>
<div class="highlight-python"><pre>GET /.well-known/webfinger
  ?resource=https%3A%2F%2Fexample.com%2Fjoe
  &amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer
  HTTP/1.1
Host: example.com

HTTP/1.1 200 OK
Content-Type: application/jrd+json

{
 "subject": "https://example.com/joe",
 "links":
  [
   {
    "rel": "http://openid.net/specs/connect/1.0/issuer",
    "href": "https://server.example.com"
   }
  ]
}</pre>
</div>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#URLSyntax">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#URLSyntax</a> )</p>
</div>
<div class="section" id="user-input-using-hostname-and-port-syntax">
<span id="discovery-2-2-3"></span><h4><a class="toc-backref" href="#id15">2.2.3.  User Input Using Hostname and Port Syntax</a><a class="headerlink" href="#user-input-using-hostname-and-port-syntax" title="Permalink to this headline">¶</a></h4>
<p>If the user input is in the form of host:port,
e.g., example.com:8080, then it is assumed as the authority component of the URL.</p>
<p>To find the Issuer for the given hostname, example.com:8080, the WebFinger parameters are as follows:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="26%" />
<col width="74%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">WebFinger Parameter</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>resource</td>
<td><a class="reference external" href="https://example.com:8080/">https://example.com:8080/</a></td>
</tr>
<tr class="row-odd"><td>host</td>
<td>example.com:8080</td>
</tr>
<tr class="row-even"><td>rel</td>
<td><a class="reference external" href="http://openid.net/specs/connect/1.0/issuer">http://openid.net/specs/connect/1.0/issuer</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Following the WebFinger specification, the Client would make the following request to get the discovery information (with line wraps within lines for display purposes only):</p>
<div class="highlight-python"><pre>GET /.well-known/webfinger
  ?resource=https%3A%2F%2Fexample.com%3A8080%2F
  &amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer
  HTTP/1.1
Host: example.com:8080

HTTP/1.1 200 OK
Content-Type: application/jrd+json

{
 "subject": "https://example.com:8080/",
 "links":
  [
   {
    "rel": "http://openid.net/specs/connect/1.0/issuer",
    "href": "https://server.example.com"
   }
  ]
}</pre>
</div>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#host.port.example">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#host.port.example</a> )</p>
</div>
<div class="section" id="user-input-using-acct-uri-syntax">
<span id="discovery-2-2-4"></span><h4><a class="toc-backref" href="#id16">2.2.4.  User Input Using &#8220;acct&#8221; URI Syntax</a><a class="headerlink" href="#user-input-using-acct-uri-syntax" title="Permalink to this headline">¶</a></h4>
<p>To find the Issuer for the given user input in the form of an account URI acct:juliet%40capulet.example&#64;shoppingsite.example.com, the WebFinger parameters are as follows:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="24%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">WebFinger Parameter</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>resource</td>
<td>acct:juliet%40capulet.example&#64;shoppingsite.example.com</td>
</tr>
<tr class="row-odd"><td>host</td>
<td>shoppingsite.example.com</td>
</tr>
<tr class="row-even"><td>rel</td>
<td><a class="reference external" href="http://openid.net/specs/connect/1.0/issuer">http://openid.net/specs/connect/1.0/issuer</a></td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Following the WebFinger specification, the Client would make the following request to get the discovery information (with line wraps within lines for display purposes only):</p>
<div class="highlight-python"><pre>GET /.well-known/webfinger
  ?resource=acct%3Ajuliet%2540capulet.example%40shoppingsite.example.com
  &amp;rel=http%3A%2F%2Fopenid.net%2Fspecs%2Fconnect%2F1.0%2Fissuer
  HTTP/1.1
Host: shoppingsite.example.com

HTTP/1.1 200 OK
Content-Type: application/jrd+json

{
 "subject": "acct:juliet%40capulet.example@shoppingsite.example.com",
 "links":
  [
   {
    "rel": "http://openid.net/specs/connect/1.0/issuer",
    "href": "https://server.example.com"
   }
  ]
}</pre>
</div>
<p>Note: It is common for sites to use e-mail addresses as local identifiers for accounts at those sites, even though the domain in the e-mail address one controlled by the site. For instance, the site example.org might have a local account named <a class="reference external" href="mailto:joe&#37;&#52;&#48;example&#46;com">joe<span>&#64;</span>example<span>&#46;</span>com</a>. As of the time of this writing, a discussion is ongoing among WebFinger contributors about the syntax that should be used when discovering information about such accounts with WebFinger. The current thinking seems to be that such accounts would be represented by quoting the &#8216;&#64;&#8217; character in the userinfo portion of the account identifier when constructing the acct: URI representing the account. Such an example is acct:joe%40example.com&#64;example.org. In a future version of this specification, it is possible that normalization rules will be defined allowing End-Users to input values like joe&#64;example.com&#64;example.org to initiate discovery on such accounts.</p>
<p>( <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#AcctURISyntax">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#AcctURISyntax</a> )</p>
</div>
</div>
</div>
<div class="section" id="openid-provider-metadata">
<span id="discovery-provider-metadata"></span><span id="discovery-3"></span><h2><a class="toc-backref" href="#id17">3.  OpenID Provider Metadata</a><a class="headerlink" href="#openid-provider-metadata" title="Permalink to this headline">¶</a></h2>
<p>OpenID Providers have metadata describing their configuration. The OpenID Provider Metadata values used by OpenID Connect are:</p>
<dl class="glossary docutils">
<dt id="term-issuer">issuer</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last"><strong>URL</strong> using the <strong>https scheme</strong> with <strong>no query or fragment component</strong> that the OP asserts as its Issuer Identifier.</p>
</dd>
<dt id="term-authorization-endpoint">authorization_endpoint</dt>
<dd>OPTIONAL. URL of the OP&#8217;s Authentication and Authorization Endpoint [OpenID.Messages].</dd>
<dt id="term-token-endpoint">token_endpoint</dt>
<dd>OPTIONAL. URL of the OP&#8217;s OAuth 2.0 Token Endpoint [OpenID.Messages].</dd>
<dt id="term-userinfo-endpoint">userinfo_endpoint</dt>
<dd>RECOMMENDED. URL of the OP&#8217;s UserInfo Endpoint [OpenID.Messages]. This URL MUST use the https scheme and MAY contain port, path, and query parameter components.</dd>
<dt id="term-check-session-iframe">check_session_iframe</dt>
<dd>OPTIONAL. URL of an OP endpoint that provides a page to support cross-origin communications for session state information with the RP Client, using the HTML5 postMessage API. The page is loaded from an invisible iframe embedded in an RP page so that it can run in the OP&#8217;s security context. See [OpenID.Session].</dd>
<dt id="term-end-session-endpoint">end_session_endpoint</dt>
<dd>OPTIONAL. URL of the OP&#8217;s endpoint that initiates logging out the End-User. See [OpenID.Session].</dd>
<dt id="term-jwks-uri">jwks_uri</dt>
<dd>REQUIRED. URL of the OP&#8217;s JSON Web Key Set [JWK] document. This contains the signing key(s) the Client uses to validate signatures from the OP. The JWK Set MAY also contain the Server&#8217;s encryption key(s), which are used by Clients to encrypt requests to the Server. When both signing and encryption keys are made available, a use (Key Use) parameter value is REQUIRED for all keys in the document to indicate each key&#8217;s intended usage.</dd>
<dt id="term-registration-endpoint">registration_endpoint</dt>
<dd>RECOMMENDED. URL of the OP&#8217;s Dynamic Client Registration Endpoint [OpenID.Registration].</dd>
<dt id="term-scopes-supported">scopes_supported</dt>
<dd>RECOMMENDED. JSON array containing a list of the OAuth 2.0 [RFC6749] scope values that this server supports. The server MUST support the openid scope value.</dd>
<dt id="term-response-types-supported">response_types_supported</dt>
<dd>REQUIRED. JSON array containing a list of the OAuth 2.0 response_type values that this server supports. The server MUST support the code, id_token, and the token id_token response type values.</dd>
<dt id="term-grant-types-supported">grant_types_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the OAuth 2.0 grant type values that this server supports. The server MUST support the authorization_code and implicit grant type values and MAY support the <a class="reference external" href="urn:ietf:params:oauth:grant-type:jwt-bearer">urn:ietf:params:oauth:grant-type:jwt-bearer</a> grant type defined in OAuth JWT Bearer Token Profiles [OAuth.JWT]. If omitted, the default value is [&#8220;authorization_code&#8221;, &#8220;implicit&#8221;].</dd>
<dt id="term-acr-values-supported">acr_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the Authentication Context Class References that this server supports.</dd>
<dt id="term-subject-types-supported">subject_types_supported</dt>
<dd>REQUIRED. JSON array containing a list of the subject identifier types that this server supports. Valid types include pairwise and public.</dd>
<dt id="term-userinfo-signing-alg-values-supported">userinfo_signing_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWS [JWS] signing algorithms (alg values) [JWA] supported by the UserInfo Endpoint to encode the Claims in a JWT [JWT].</dd>
<dt id="term-userinfo-encryption-alg-values-supported">userinfo_encryption_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE [JWE] encryption algorithms (alg values) [JWA] supported by the UserInfo Endpoint to encode the Claims in a JWT [JWT].</dd>
<dt id="term-userinfo-encryption-enc-values-supported">userinfo_encryption_enc_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE encryption algorithms (enc values) [JWA] supported by the UserInfo Endpoint to encode the Claims in a JWT [JWT].</dd>
<dt id="term-id-token-signing-alg-values-supported">id_token_signing_alg_values_supported</dt>
<dd>REQUIRED. JSON array containing a list of the JWS signing algorithms (alg values) supported by the Authorization Server for the ID Token to encode the Claims in a JWT [JWT].</dd>
<dt id="term-id-token-encryption-alg-values-supported">id_token_encryption_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE encryption algorithms (alg values) supported by the Authorization Server for the ID Token to encode the Claims in a JWT [JWT].</dd>
<dt id="term-id-token-encryption-enc-values-supported">id_token_encryption_enc_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE encryption algorithms (enc values) supported by the Authorization Server for the ID Token to encode the Claims in a JWT [JWT].</dd>
<dt id="term-request-object-signing-alg-values-supported">request_object_signing_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWS signing algorithms (alg values) supported by the Authorization Server for the Request Object described in Section 2.9 of OpenID Connect Messages 1.0 [OpenID.Messages]. These algorithms are used both when the Request Object is passed by value (using the request parameter) and when it is passed by reference (using the request_uri parameter). Servers SHOULD support none and RS256.</dd>
<dt id="term-request-object-encryption-alg-values-supported">request_object_encryption_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE encryption algorithms (alg values) supported by the Authorization Server for the Request Object described in Section 2.9 of OpenID Connect Messages 1.0 [OpenID.Messages]. These algorithms are used both when the Request Object is passed by value and when it is passed by reference.</dd>
<dt id="term-request-object-encryption-enc-values-supported">request_object_encryption_enc_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWE encryption algorithms (enc values) supported by the Authorization Server for the Request Object described in Section 2.9 of OpenID Connect Messages 1.0 [OpenID.Messages]. These algorithms are used both when the Request Object is passed by value and when it is passed by reference.</dd>
<dt id="term-token-endpoint-auth-methods-supported">token_endpoint_auth_methods_supported</dt>
<dd>OPTIONAL. JSON array containing a list of authentication methods supported by this Token Endpoint. The options are client_secret_post, client_secret_basic, client_secret_jwt, and private_key_jwt, as described in Section 2.2.1 of OpenID Connect Messages 1.0 [OpenID.Messages]. Other authentication methods MAY be defined by extensions. If omitted, the default is client_secret_basic &#8211; the HTTP Basic Authentication Scheme as specified in Section 2.3.1 of OAuth 2.0 [RFC6749].</dd>
<dt id="term-token-endpoint-auth-signing-alg-values-supported">token_endpoint_auth_signing_alg_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the JWS signing algorithms (alg values) supported by the Token Endpoint for the private_key_jwt and client_secret_jwt methods to encode the JWT [JWT]. Servers SHOULD support RS256.</dd>
<dt id="term-display-values-supported">display_values_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the display parameter values that the OpenID Provider supports. These values are described in Section 2.1.1 of OpenID Connect Messages 1.0 [OpenID.Messages].</dd>
<dt id="term-claim-types-supported">claim_types_supported</dt>
<dd>OPTIONAL. JSON array containing a list of the Claim Types that the OpenID Provider supports. These Claim Types are described in Section 2.6 of OpenID Connect Messages 1.0 [OpenID.Messages]. Values defined by this specification are normal, aggregated, and distributed. If not specified, the implementation supports only normal Claims.</dd>
<dt id="term-claims-supported">claims_supported</dt>
<dd>RECOMMENDED. JSON array containing a list of the Claim Names of the Claims that the OpenID Provider MAY be able to supply values for. Note that for privacy or other reasons, this might not be an exhaustive list.</dd>
<dt id="term-service-documentation">service_documentation</dt>
<dd>OPTIONAL. URL of a page containing human-readable information that developers might want or need to know when using the OpenID Provider. In particular, if the OpenID Provider does not support Dynamic Client Registration, then information on how to register Clients needs to be provided in this documentation.</dd>
<dt id="term-claims-locales-supported">claims_locales_supported</dt>
<dd>OPTIONAL. Languages and scripts supported for values in Claims being returned, represented as a JSON array of BCP47 [RFC5646] language tag values. Not all languages and scripts are necessarily supported for all Claim values.</dd>
<dt id="term-ui-locales-supported">ui_locales_supported</dt>
<dd>OPTIONAL. Languages and scripts supported for the user interface, represented as a JSON array of BCP47 [RFC5646] language tag values.</dd>
<dt id="term-claims-parameter-supported">claims_parameter_supported</dt>
<dd>OPTIONAL. Boolean value specifying whether the OP supports use of the claims parameter, with true indicating support. If omitted, the default value is false.</dd>
<dt id="term-request-parameter-supported">request_parameter_supported</dt>
<dd>OPTIONAL. Boolean value specifying whether the OP supports use of the request parameter, with true indicating support. If omitted, the default value is false.</dd>
<dt id="term-request-uri-parameter-supported">request_uri_parameter_supported</dt>
<dd>OPTIONAL. Boolean value specifying whether the OP supports use of the request_uri parameter, with true indicating support. If omitted, the default value is true.</dd>
<dt id="term-require-request-uri-registration">require_request_uri_registration</dt>
<dd>OPTIONAL. Boolean value specifying whether the OP requires any request_uri values used to be pre-registered using the request_uris registration parameter. Pre-registration is REQUIRED when the value is true. If omitted, the default value is false.</dd>
<dt id="term-op-policy-uri">op_policy_uri</dt>
<dd>OPTIONAL. URL that the OpenID Provider provides to the person registering the Client to read about the OP&#8217;s requirements on how the Relying Party can use the data provided by the OP. The registration process SHOULD display this URL to the person registering the Client if it is given.</dd>
<dt id="term-op-tos-uri">op_tos_uri</dt>
<dd>OPTIONAL. URL that the OpenID Provider provides to the person registering the Client to read about OpenID Provider&#8217;s terms of service. The registration process SHOULD display this URL to the person registering the Client if it is given.</dd>
</dl>
<p>( draft 17, <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderMetadata">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderMetadata</a> )</p>
<div class="section" id="opop">
<span id="discovery-opop"></span><h3><a class="toc-backref" href="#id18">OPOPについて</a><a class="headerlink" href="#opop" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>On Premis OP Sample。設定は以下の２つがあり得る</p>
<blockquote>
<div><ul class="simple">
<li>OPOPで設定してRESTでRegistryに転送</li>
<li>RegistryのUIで設定</li>
</ul>
</div></blockquote>
<p>RESTで設定する場合、 OP Discovery のJsonをPOSTで送信する。アクセストークンは</p>
<blockquote>
<div><ul class="simple">
<li>初期に提供されるトークンをそのまま使う</li>
<li>Jwkの登録が終わっていたら、そのキーを使って client_assertionの Client Credential でトークンを取得して使う</li>
</ul>
</div></blockquote>
<p>の２つ。</p>
<p>registory.net が信頼フレームワークの中心にあり、RPがmycompany.comのOPOPでID Tokenをもらう配置のディスカバリ情報の例。</p>
<p>mycompany.comのDNSエントリはエンドユーザーの企業内ネットワークで管理されているので、信頼できない。
また、IPアドレスのままのケースがあるかもしれない。
SSLは使われていないかもしれないし、使われていたとしてもmycompany.comはオレオレ証明書があり得る。</p>
<p>registory.netが信頼フレームワークの中心にあるということは</p>
<blockquote>
<div><ol class="arabic">
<li><p class="first">RPが registory.net でクライアント登録し、( <a class="reference internal" href="reg.html"><em>OpenID Connect Dynamic Client Registration 1.0</em></a> ) client_id をもらっている</p>
<blockquote>
<div><ul class="simple">
<li>registory.netと mycompany.comの間で client_id, ならびに メタ情報を共有する (ただしクレデンシャルは除く )</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">OPOPがregistory.net でRP情報を確認する為に、mycompany.comの管理者は registory.netにアカウント登録する。
アカウント登録が行われると、メールで情報が送られる。</p>
<blockquote>
<div><ul class="simple">
<li>初期アクセストークン</li>
<li>登録エンドポイント</li>
</ul>
</div></blockquote>
<p>登録エンドポイント詳細登録のUIエンドポイントのこともあるし、OPOPの管理画面でRESTで登録する場合のエンドポイントかもしれない。
実装によってはインストーラで処理を行うかもしれない</p>
</li>
<li><p class="first">RPがOPOPでログインするにあたり、OPの識別子として <a class="reference external" href="https://registroy.net/mycomapny.com">https://registroy.net/mycomapny.com</a> を使い、これで <a class="reference internal" href=""><em>OpenID Connect Discovery 1.0</em></a> する。
本ノートはこのディスカバリ情報で返されるJSONの例を書いています。このJSONはRESTでOPOPをRegistryに登録する場合も使うものとする。</p>
<blockquote>
<div><ul class="simple">
<li>OPOPのディスカバリ情報は、registory.net の Web UI で行った方が良いかと思う。</li>
</ul>
</div></blockquote>
</li>
<li><p class="first">RPはregistory.net を信頼しているので、クライアント登録をする。
registroy.netのサーバー証明書を確認すること。
信頼しているregistory.netからダウンロードされるJWK Setは信頼出来るものとする。
つまり、mycompany.com のOPOP自体は、JWK のベアキーを使ってよいとする。</p>
</li>
<li><p class="first">mycompany.com へのregistory.netの信頼は</p>
<blockquote>
<div><ul class="simple">
<li>B2Bで課金していること。</li>
<li>正しいアクセストークンでRESTサービスにアクセスしていること。</li>
<li>RESTサービスを使ってJWK を適切にローテーションしていること。</li>
<li>必要であれば、アクセストークン毎にRESTのIPアドレス制限をすること。</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
<p>サンプル Discovery</p>
<table border="1" class="last docutils">
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Metadata Claim</td>
<td>登録要求Json</td>
<td>登録後情報Json</td>
<td>Note</td>
</tr>
<tr class="row-even"><td>issuer</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompay.com">https://registry.net/mycompay.com</a>&#8220;</td>
<td>registory が発行するものをもらうので、登録リクエストの時は指定しない</td>
</tr>
<tr class="row-odd"><td>authorization_endpoint</td>
<td>&#8220;<a class="reference external" href="http://192.168.1.1/auth/">http://192.168.1.1/auth/</a>&#8220;</td>
<td>&lt;= 同じ</td>
<td>OPOPプライベートネットワークにある</td>
</tr>
<tr class="row-even"><td>token_endpoint</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompan.com/token">https://registry.net/mycompan.com/token</a>&#8220;</td>
<td>code フローの場合、Token Endpointは Registoryが提供。 Implictの場合はToken Endpointはありません。</td>
</tr>
<tr class="row-odd"><td>userinfo_endpoint</td>
<td>null</td>
<td>null</td>
<td>UserInfoはID Tokenに入れられます。</td>
</tr>
<tr class="row-even"><td>check_session_iframe</td>
<td>null</td>
<td>null</td>
<td>サポートしない</td>
</tr>
<tr class="row-odd"><td>end_session_endpoint</td>
<td>null</td>
<td>null</td>
<td>サポートしない</td>
</tr>
<tr class="row-even"><td>jwks_uri</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompay.com/jwk_set">https://registry.net/mycompay.com/jwk_set</a>&#8220;</td>
<td>Registryがキーを提供します。JWK Set JSONを返すURL。</td>
</tr>
<tr class="row-odd"><td>registration_endpoint</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompay.com/reg">https://registry.net/mycompay.com/reg</a>&#8220;</td>
<td>RPはOn Premis OP に直接登録するのではなく、レジストリサービスに代理登録する。</td>
</tr>
<tr class="row-even"><td>scopes_supported</td>
<td>[&#8220;opeid&#8221;,&#8221;profile&#8221;,&#8221;email&#8221;]</td>
<td>[&#8220;opeid&#8221;,&#8221;profile&#8221;,&#8221;email&#8221;]</td>
<td>通常のOPと同じ。openid は必ず指定。他はオプション</td>
</tr>
<tr class="row-odd"><td>response_types_supported</td>
<td>[&#8220;code&#8221;,&#8221;id_token&#8221;]</td>
<td>[&#8220;code&#8221;,&#8221;id_token&#8221;]</td>
<td>ID Tokenは必須</td>
</tr>
<tr class="row-even"><td>grant_types_supported</td>
<td>[&#8220;code&#8221;,&#8221;implicit&#8221;]</td>
<td>[&#8220;code&#8221;,&#8221;implicit&#8221;]</td>
<td>codeフローの場合は Registryがトークン処理を行う。</td>
</tr>
<tr class="row-odd"><td>acr_values_supported</td>
<td>[&#8220;1&#8221;,&#8221;2&#8221; ]</td>
<td>[&#8220;1&#8221;,&#8221;2&#8221; ]</td>
<td>オプション ( TODO:要調査 )</td>
</tr>
<tr class="row-even"><td>subject_types_supported</td>
<td>[&#8220;public&#8221;, &#8220;pairwise&#8221;]</td>
<td>[&#8220;public&#8221;, &#8220;pairwise&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>userinfo_signing_alg_values_supported</td>
<td>null</td>
<td>null</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>userinfo_encryption_alg_values_supported</td>
<td>null</td>
<td>null</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>userinfo_encryption_enc_values_supported</td>
<td>null</td>
<td>null</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>id_token_signing_alg_values_supported</td>
<td>[&#8220;RS256&#8221; ]</td>
<td>[&#8220;RS256&#8221; ]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>id_token_encryption_alg_values_supported</td>
<td>[&#8220;RSA1_5&#8221;, &#8220;A128KW&#8221;]</td>
<td>[&#8220;RSA1_5&#8221;, &#8220;A128KW&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>id_token_encryption_enc_values_supported</td>
<td>[&#8220;A128CBC+HS256&#8221;, &#8220;A128GCM&#8221;]</td>
<td>[&#8220;A128CBC+HS256&#8221;, &#8220;A128GCM&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>request_object_signing_alg_values_supported</td>
<td>[&#8220;none&#8221;, &#8220;RS256&#8221;, &#8220;ES256&#8221;]</td>
<td>[&#8220;none&#8221;, &#8220;RS256&#8221;, &#8220;ES256&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>request_object_encryption_alg_values_supported</td>
<td>[&#8220;RSA1_5&#8221;, &#8220;A128KW&#8221;]</td>
<td>[&#8220;RSA1_5&#8221;, &#8220;A128KW&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>request_object_encryption_enc_values_supported</td>
<td>[&#8220;A128CBC+HS256&#8221;, &#8220;A128GCM&#8221;]</td>
<td>[&#8220;A128CBC+HS256&#8221;, &#8220;A128GCM&#8221;]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>token_endpoint_auth_methods_supported</td>
<td>null</td>
<td>null</td>
<td>Token Endpoint はRegistoryが提供</td>
</tr>
<tr class="row-odd"><td>token_endpoint_auth_signing_alg_values_supported</td>
<td>null</td>
<td>null</td>
<td>Token Endpoint はRegistoryが提供</td>
</tr>
<tr class="row-even"><td>display_values_supported</td>
<td>TODO</td>
<td>TODO</td>
<td>TODO あとで調べる</td>
</tr>
<tr class="row-odd"><td>claim_types_supported</td>
<td>[&#8220;normal&#8221;,&#8221;aggregated&#8221;]</td>
<td>[&#8220;normal&#8221;,&#8221;aggregated&#8221;]</td>
<td>distributed は無いでしょう (TODO後で調べる)</td>
</tr>
<tr class="row-even"><td>claims_supported</td>
<td>[&#8220;sub&#8221;, &#8220;iss&#8221;, &#8220;auth_time&#8221;, &#8220;acr&#8221;, ]</td>
<td>[&#8220;sub&#8221;, &#8220;iss&#8221;, &#8220;auth_time&#8221;, &#8220;acr&#8221;, ]</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>service_documentation</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompay.com/docs">https://registry.net/mycompay.com/docs</a>&#8220;</td>
<td>Registryが提供</td>
</tr>
<tr class="row-even"><td>claims_locales_supported</td>
<td>&#8220;ja&#8221;</td>
<td>&#8220;ja&#8221;</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-odd"><td>ui_locales_supported</td>
<td>&#8220;ja&#8221;</td>
<td>&#8220;ja&#8221;</td>
<td>通常のOPと同じくOPが指定</td>
</tr>
<tr class="row-even"><td>claims_parameter_supported</td>
<td>false</td>
<td>false</td>
<td>falseがデフォルト。Request URI でやるべきだろう</td>
</tr>
<tr class="row-odd"><td>request_parameter_supported</td>
<td>false</td>
<td>false</td>
<td>falseがデフォルト。Request URI でやるべきだろう</td>
</tr>
<tr class="row-even"><td>request_uri_parameter_supported</td>
<td>true</td>
<td>true</td>
<td>信頼フレームワークとしてRPがregistory.netに登録が行われている前提で、request_uriは <a class="reference external" href="https://registry.net">https://registry.net</a> で始めるものとする。</td>
</tr>
<tr class="row-odd"><td>require_request_uri_registration</td>
<td>true</td>
<td>true</td>
<td>信頼フレームワークとしてRPがregistory.netに登録が行われている前提とする。</td>
</tr>
<tr class="row-even"><td>op_policy_uri</td>
<td>null</td>
<td>&#8220;<a class="reference external" href="https://registry.net/mycompay.com/policy">https://registry.net/mycompay.com/policy</a>&#8220;</td>
<td>Registryが提供</td>
</tr>
<tr class="row-odd"><td>op_tos_uri</td>
<td>&#8220;<a class="reference external" href="https://192.168.1.1/tos">https://192.168.1.1/tos</a>&#8220;</td>
<td>&#8220;<a class="reference external" href="https://192.168.1.1/tos">https://192.168.1.1/tos</a>&#8220;</td>
<td>OPOP でログインしようとしているユーザーに表示するURL</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="string-operations">
<span id="discovery-4"></span><h2><a class="toc-backref" href="#id19">4.  String Operations</a><a class="headerlink" href="#string-operations" title="Permalink to this headline">¶</a></h2>
<p>Processing some OpenID Connect messages requires comparing values in the messages to known values.
For example,
the member names in the provider configuration response might be compared to specific member names such as <a class="reference internal" href="messages.html#term-issuer"><em class="xref std std-term">issuer</em></a>.
Comparing Unicode strings, however, has significant security implications.</p>
<p>Therefore, comparisons between JSON strings and other Unicode strings MUST be performed as specified below:</p>
<blockquote>
<div><ul class="simple">
<li>Remove any JSON applied escaping to produce an array of <a class="reference internal" href="glossary.html#term-unicode-code-points"><em class="xref std std-term">Unicode code points</em></a>.</li>
<li>Unicode Normalization [<a class="reference internal" href="messages.html#term-usa15"><em class="xref std std-term">USA15</em></a>] MUST NOT be applied at any point to either the JSON string or to the string it is to be compared against.</li>
<li>Comparisons between the two strings MUST be performed as a Unicode code point to code point equality comparison.</li>
</ul>
</div></blockquote>
<p>In several places,
this specification uses space delimited lists of strings.
In all such cases,
only the ASCII space character (0x20) MAY be used for this purpose.</p>
<p>(draft 07, Dec 22, 2011 )</p>
<div class="section" id="openid-provider-configuration-request">
<span id="discovery-4-1"></span><h3><a class="toc-backref" href="#id20">4.1.  OpenID Provider Configuration Request</a><a class="headerlink" href="#openid-provider-configuration-request" title="Permalink to this headline">¶</a></h3>
<p>An OpenID Provider Configuration Document MUST be queried using an HTTPS GET request at the previously specified path.</p>
<p>The Client would make the following request to the Issuer to get the Configuration information, if the Issuer contains no path component.</p>
<div class="highlight-python"><pre>GET /.well-known/openid-configuration HTTP/1.1
Host: example.com</pre>
</div>
<p>If the Issuer value contains a <strong>path</strong> component,
any terminating / MUST be removed before appending /.well-known/openid-configuration.</p>
<p>The Client would make the following request to the Issuer to get the Configuration information,
if the Issuer string were <a class="reference external" href="https://example.com/issuer1">https://example.com/issuer1</a></p>
<div class="highlight-python"><pre>GET /issuer1/.well-known/openid-configuration HTTP/1.1
Host: example.com</pre>
</div>
<p>Path components are allowed to support <strong>multiple issuers per host</strong>.
This is required in some multi-tenant hosting configurations.</p>
<p>This use of .well-known is for supporting multiple issuers per host,
and unlike its use in RFC 5785 [RFC5785],
it does not provide general information about the host.</p>
<p>( draft 17, <a class="reference external" href="http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderConfigurationRequest">http://openid.bitbucket.org/openid-connect-discovery-1_0.html#ProviderConfigurationRequest</a> )</p>
</div>
</div>
<div class="section" id="references">
<span id="discovery-7"></span><h2><a class="toc-backref" href="#id21">7.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(draft 07, Dec 22, 2011 )</p>
<div class="section" id="normative-references">
<span id="discovery-7-1"></span><h3><a class="toc-backref" href="#id22">7.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-jwe">JWE</dt>
<dd>Jones, M., Rescorla, E., and J. Hildebrand, “JSON Web Encryption (JWE),” December 2011.</dd>
<dt id="term-jwk">JWK</dt>
<dd>Jones, M., “JSON Web Key (JWK),” December 2011.</dd>
<dt id="term-jws">JWS</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Signature,” December 2011.</dd>
<dt id="term-jwt">JWT</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Token,” December 2011.</dd>
<dt id="term-oauth2-0">OAuth2.0</dt>
<dd>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, “OAuth 2.0 Authorization Protocol,” September 2011.</dd>
<dt id="term-openid-messages">OpenID.Messages</dt>
<dd>Sakimura, N., Recordon, D., Bradley, J., de Medeiros, B., Jones, M., and E. Jay, “OpenID Connect Messages 1.0,” December 2011.</dd>
<dt id="term-openid-registration">OpenID.Registration</dt>
<dd>Sakimura, N., Bradley, J., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” December 2011.</dd>
<dt id="term-openid-session">OpenID.Session</dt>
<dd>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, “OpenID Connect Session Management 1.0,” December 2011.</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt id="term-rfc2246">RFC2246</dt>
<dd>Dierks, T. and C. Allen, “The TLS Protocol Version 1.0,” RFC 2246, January 1999 (TXT).</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” STD 66, RFC 3986, January 2005 (TXT, HTML, XML).</dd>
<dt id="term-rfc5246">RFC5246</dt>
<dd>Dierks, T. and E. Rescorla, “The Transport Layer Security (TLS) Protocol Version 1.2,” RFC 5246, August 2008 (TXT).</dd>
<dt id="term-rfc5322">RFC5322</dt>
<dd>Resnick, P., Ed., “Internet Message Format,” RFC 5322, October 2008 (TXT, HTML, XML).</dd>
<dt id="term-rfc5785">RFC5785</dt>
<dd>Nottingham, M. and E. Hammer-Lahav, “Defining Well-Known Uniform Resource Identifiers (URIs),” RFC 5785, April 2010 (TXT).</dd>
<dt id="term-rfc6125">RFC6125</dt>
<dd>Saint-Andre, P. and J. Hodges, “Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),” RFC 6125, March 2011 (TXT).</dd>
<dt id="term-swd">SWD</dt>
<dd>Jones, M. and Y. Goland, “Simple Web Discovery,” December 2011.</dd>
<dt id="term-usa15">USA15</dt>
<dd>Davis, M., Whistler, K., and M. Dürst, “Unicode Normalization Forms,” Unicode Standard Annex 15, 09 2009.</dd>
</dl>
<p>(draft 07, Dec 22,2011 )</p>
</div>
</div>
<div class="section" id="discovery-8">
<span id="id1"></span><h2><a class="toc-backref" href="#id23">8.  References</a><a class="headerlink" href="#discovery-8" title="Permalink to this headline">¶</a></h2>
<p>(draft 07)</p>
<div class="section" id="discovery-8-1">
<span id="id2"></span><h3><a class="toc-backref" href="#id24">8.1. Normative References</a><a class="headerlink" href="#discovery-8-1" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-58">JWE</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, “JSON Web Encryption,” October 2011.</dd>
<dt id="term-59">JWK</dt>
<dd>Jones, M., “JSON Web Key (JWK),” October 2011.</dd>
<dt id="term-60">JWS</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Signatures,” October 2011.</dd>
<dt id="term-61">JWT</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer, J., Sakimura, N., and P. Tarjan, “JSON Web Token,” October 2011.</dd>
<dt id="term-62">OAuth2.0</dt>
<dd>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, “OAuth 2.0 Authorization Protocol,” September 2011.</dd>
<dt id="term-63">OpenID.Messages</dt>
<dd>Sakimura, N., Recordon, D., Bradley, J., de Medeiros, B., Jones, M., and E. Jay, “OpenID Connect Messages 1.0,” September 2011.</dd>
<dt id="term-64">OpenID.Registration</dt>
<dd>Sakimura, N., Bradley, J., Ed., and M. Jones, “OpenID Connect Dynamic Client Registration 1.0,” September 2011.</dd>
<dt id="term-65">OpenID.Session</dt>
<dd>Sakimura, N., Bradley, J., Jones, M., de Medeiros, B., Mortimore, C., and E. Jay, “OpenID Connect Session Management 1.0,” September 2011.</dd>
<dt id="term-66">RFC2119</dt>
<dd>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels,” BCP 14, RFC 2119, March 1997 (TXT, HTML, XML).</dd>
<dt id="term-67">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, “Uniform Resource Identifier (URI): Generic Syntax,” STD 66, RFC 3986, January 2005 (TXT, HTML, XML).</dd>
<dt id="term-68">RFC5246</dt>
<dd>Dierks, T. and E. Rescorla, “The Transport Layer Security (TLS) Protocol Version 1.2,” RFC 5246, August 2008 (TXT).</dd>
<dt id="term-69">RFC5322</dt>
<dd>Resnick, P., Ed., “Internet Message Format,” RFC 5322, October 2008 (TXT, HTML, XML).</dd>
<dt id="term-70">RFC5785</dt>
<dd>Nottingham, M. and E. Hammer-Lahav, “Defining Well-Known Uniform Resource Identifiers (URIs),” RFC 5785, April 2010 (TXT).</dd>
<dt id="term-71">RFC6125</dt>
<dd>Saint-Andre, P. and J. Hodges, “Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS),” RFC 6125, March 2011 (TXT).</dd>
<dt id="term-72">SWD</dt>
<dd>Jones, M., Ed. and Y. Goland, “Simple Web Discovery,” July 2011.</dd>
<dt id="term-73">USA15</dt>
<dd>Davis, M., Whistler, K., and M. Dürst, “Unicode Normalization Forms,” Unicode Standard Annex 15, 09 2009.</dd>
</dl>
<p>(draft 07)</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="session.html">OpenID Connect Session Management 1.0</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>