

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>RFC7009:Token Revocation &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0" href="oauth_jwt_bearer.html" />
    <link rel="prev" title="Auth 2.0 Threat Model and Security Considerations" href="oauth_threat.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>RFC7009:Token Revocation</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="rfc7009-token-revocation">
<span id="oauth-revocation-head"></span><h1>RFC7009:Token Revocation<a class="headerlink" href="#rfc7009-token-revocation" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc7009.html"><strong>RFC 7009</strong></a></li>
</ul>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id2">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-language" id="id3">1.1.  Requirements Language</a></li>
</ul>
</li>
<li><a class="reference internal" href="#token-revocation" id="id4">2.  Token Revocation</a><ul>
<li><a class="reference internal" href="#revocation-request" id="id5">2.1.  Revocation Request</a></li>
<li><a class="reference internal" href="#revocation-response" id="id6">2.2.  Revocation Response</a><ul>
<li><a class="reference internal" href="#error-response" id="id7">2.2.1.  Error Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cross-origin-support" id="id8">2.3.  Cross-Origin Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation-note" id="id9">3.  Implementation Note</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id10">4.  IANA Considerations</a><ul>
<li><a class="reference internal" href="#oauth-extensions-error-registration" id="id11">4.1.  OAuth Extensions Error Registration</a><ul>
<li><a class="reference internal" href="#the-unsupported-token-type-error-value" id="id12">4.1.1.  The &#8220;unsupported_token_type&#8221; Error Value</a></li>
<li><a class="reference internal" href="#oauth-token-type-hints-registry" id="id13">4.1.2.  OAuth Token Type Hints Registry</a><ul>
<li><a class="reference internal" href="#registration-template" id="id14">4.1.2.1.  Registration Template</a></li>
<li><a class="reference internal" href="#initial-registry-contents" id="id15">4.1.2.2.  Initial Registry Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id16">5.  Security Considerations</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id17">6.  Acknowledgements</a></li>
<li><a class="reference internal" href="#references" id="id18">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id19">7.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id20">7.2.  Informative References</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="abstract">
<span id="oauth-revocation-abstract"></span><h2><a class="toc-backref" href="#id1">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This document proposes an additional endpoint for OAuth authorization servers,
which allows clients to notify the authorization server that
a previously obtained refresh or access token is no longer needed.</p>
<p>This allows the authorization server to clean up security credentials.
A revocation request will invalidate the actual token and,
if applicable, other tokens based on the same authorization grant</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009">http://tools.ietf.org/html/rfc7009</a> )</p>
</div>
<div class="section" id="introduction">
<span id="oauth-revocation-1"></span><h2><a class="toc-backref" href="#id2">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="oauth.html"><em>OAuth 2.0 core specification</em></a> [RFC6749]
defines several ways for a client to obtain refresh and access tokens.
This specification supplements the core specification
with a mechanism to revoke both types of tokens.</p>
<p>A token is a string representing an authorization grant
issued by the resource owner to the client.
A revocation request will invalidate the actual token and,
if applicable, other tokens based on the same authorization grant
and the authorization grant itself.</p>
<p>From an end-user&#8217;s perspective,
OAuth is often used to log into a certain site or application.
This revocation mechanism allows a client to invalidate its tokens
if the end-user logs out, changes identity, or uninstalls the respective application.</p>
<p>Notifying the authorization server that the token is no longer needed
allows the authorization server to clean up data associated with that token
(e.g., session data) and the underlying authorization grant.
This behavior prevents a situation
in which there is still a valid authorization grant for a particular client
of which the end-user is not aware.
This way,
token revocation prevents abuse of abandoned tokens
and facilitates a better end-user experience
since invalidated authorization grants will no longer turn up
in a list of authorization grants the authorization server might present to the end-user.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-1">http://tools.ietf.org/html/rfc7009#section-1</a> )</p>
<div class="section" id="requirements-language">
<span id="oauth-revocation-1-1"></span><h3><a class="toc-backref" href="#id3">1.1.  Requirements Language</a><a class="headerlink" href="#requirements-language" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in RFC 2119 [RFC2119].</p>
</div>
</div>
<div class="section" id="token-revocation">
<span id="oauth-revocation-2"></span><h2><a class="toc-backref" href="#id4">2.  Token Revocation</a><a class="headerlink" href="#token-revocation" title="Permalink to this headline">¶</a></h2>
<p>Implementations MUST support the revocation of refresh tokens and
SHOULD support the revocation of access tokens (see Implementation Note).</p>
<p>The client requests the revocation of a particular token by making an
HTTP POST request to the token revocation endpoint URL.
This URL MUST conform to the rules given in [RFC6749], Section 3.1.
Clients MUST verify that the URL is an HTTPS URL.</p>
<p>The means to obtain the location of the revocation endpoint is out of
the scope of this specification.
For example,
the client developer may consult the server&#8217;s documentation
or automatic discovery may be used.
As this endpoint is handling security credentials,
the endpoint location needs to be obtained from a trustworthy source.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>revocation エンドポイントが何処にあるかはこのスペックでは問わない</li>
</ul>
</div>
<p>Since requests to the token revocation endpoint result
in the transmission of plaintext credentials in the HTTP request,
URLs for token revocation endpoints MUST be HTTPS URLs.
The authorization server MUST use Transport Layer Security (TLS) [RFC5246]
in a version compliant with [RFC6749], Section 1.6.
Implementations MAY also support additional transport-layer security mechanisms
that meet their security requirements.</p>
<p>If the host of the token revocation endpoint can also be reached over HTTP,
then the server SHOULD also offer a revocation service at the corresponding HTTP URI,
but it MUST NOT publish this URI as a token revocation endpoint.
This ensures that tokens accidentally sent over HTTP will be revoked.</p>
<p>(<a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-2">http://tools.ietf.org/html/rfc7009#section-2</a>)</p>
<div class="section" id="revocation-request">
<span id="oauth-revocation-request"></span><span id="oauth-revocation-2-1"></span><h3><a class="toc-backref" href="#id5">2.1.  Revocation Request</a><a class="headerlink" href="#revocation-request" title="Permalink to this headline">¶</a></h3>
<p>The client constructs the request by including the following parameters
using the &#8220;<strong>application/x-www-form-urlencoded</strong>&#8221; format
in the HTTP request entity-body:</p>
<dl class="glossary docutils">
<dt id="term-token">token</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">The token that the client wants to get revoked.</p>
</dd>
<dt id="term-token-type-hint">token_type_hint</dt>
<dd><p class="first">OPTIONAL.</p>
<p>A hint about the type of the token submitted for revocation.</p>
<p>Clients MAY pass this parameter in order to help the authorization server
to optimize the token lookup.</p>
<p>If the server is unable to locate the token using the given hint,
it MUST extend its search across all of its supported token types.</p>
<p>An authorization server MAY ignore this parameter,
particularly if it is able to detect the token type automatically.</p>
<p>This specification defines two such values:</p>
<blockquote>
<div><ul class="simple">
<li>access_token: An access token as defined in [RFC6749], Section 1.4</li>
<li>refresh_token: A refresh token as defined in [RFC6749], Section 1.5</li>
</ul>
</div></blockquote>
<p>Specific implementations, profiles, and extensions of this
specification MAY define other values for this parameter
using the registry defined in <a class="reference internal" href="#oauth-revocation-4-1-2"><em>Section 4.1.2</em></a>.</p>
<div class="last admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="oauth_introspect.html#oauth-introspect-request"><em>2.1. Introspection Request</em></a></p>
</div>
</dd>
</dl>
<p>The client also includes its authentication credentials as described
in Section 2.3. of [RFC6749].</p>
<p>For example, a client may request the revocation of a refresh token
with the following request:</p>
<div class="highlight-python"><pre>POST /revoke HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded
Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

token=45ghiukldjahdnhzdauz&amp;token_type_hint=refresh_token</pre>
</div>
<p>The authorization server first validates the client credentials (in
case of a confidential client) and then verifies whether the token
was issued to the client making the revocation request.  If this
validation fails, the request is refused and the client is informed
of the error by the authorization server as described below.</p>
<p>In the next step, the authorization server invalidates the token.
The invalidation takes place immediately, and the token cannot be
used again after the revocation.  In practice, there could be a
propagation delay, for example, in which some servers know about the
invalidation while others do not.  Implementations should minimize
that window, and clients must not try to use the token after receipt
of an HTTP 200 response from the server.</p>
<p>Depending on the authorization server&#8217;s revocation policy, the
revocation of a particular token may cause the revocation of related
tokens and the underlying authorization grant.  If the particular
token is a refresh token and the authorization server supports the
revocation of access tokens, then the authorization server SHOULD
also invalidate all access tokens based on the same authorization
grant (see Implementation Note).  If the token passed to the request
is an access token, the server MAY revoke the respective refresh
token as well.</p>
<p>Note: A client compliant with [RFC6749] must be prepared to handle
unexpected token invalidation at any time.  Independent of the
revocation mechanism specified in this document, resource owners may
revoke authorization grants, or the authorization server may
invalidate tokens in order to mitigate security threats.  Thus,
having different server policies with respect to cascading the
revocation of tokens should not pose interoperability problems.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-2.1">http://tools.ietf.org/html/rfc7009#section-2.1</a>)</p>
</div>
<div class="section" id="revocation-response">
<span id="oauth-revocation-2-2"></span><h3><a class="toc-backref" href="#id6">2.2.  Revocation Response</a><a class="headerlink" href="#revocation-response" title="Permalink to this headline">¶</a></h3>
<p>The authorization server responds with HTTP status code 200 if the
token has been revoked successfully or if the client submitted an
invalid token.</p>
<p>Note:
invalid tokens do not cause an error response since the client
cannot handle such an error in a reasonable way.  Moreover, the
purpose of the revocation request, invalidating the particular token,
is already achieved.</p>
<p>The content of the response body is ignored by the client as all
necessary information is conveyed in the response code.</p>
<p>An invalid token type hint value is ignored by the authorization
server and does not influence the revocation response.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-2.2">http://tools.ietf.org/html/rfc7009#section-2.2</a> )</p>
<div class="section" id="error-response">
<span id="oauth-revocation-2-2-1"></span><h4><a class="toc-backref" href="#id7">2.2.1.  Error Response</a><a class="headerlink" href="#error-response" title="Permalink to this headline">¶</a></h4>
<p>The error presentation conforms to the definition in Section 5.2 of [RFC6749].
The following additional error code is defined for the token revocation endpoint:</p>
<dl class="glossary docutils">
<dt id="term-unsupported-token-type">unsupported_token_type</dt>
<dd><p class="first">The authorization server does not support
the revocation of the presented token type.</p>
<p class="last">That is,
the client tried to revoke an access token on a server not
supporting this feature.</p>
</dd>
</dl>
<p>If the server responds with HTTP status code 503, the client must
assume the token still exists and may retry after a reasonable delay.
The server may include a &#8220;<strong>Retry-After</strong>&#8221; header in the response to
indicate how long the service is expected to be unavailable to the
requesting client.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-2.2.1">http://tools.ietf.org/html/rfc7009#section-2.2.1</a> )</p>
</div>
</div>
<div class="section" id="cross-origin-support">
<span id="oauth-revocation-2-3"></span><h3><a class="toc-backref" href="#id8">2.3.  Cross-Origin Support</a><a class="headerlink" href="#cross-origin-support" title="Permalink to this headline">¶</a></h3>
<p>The revocation endpoint MAY support Cross-Origin Resource Sharing (CORS)
[W3C.WD-cors-20120403] if it is aimed at use in combination with user-agent-based applications.</p>
<p>In addition, for interoperability with legacy user-agents, it MAY
also offer JSONP (Remote JSON - JSONP) [jsonp] by allowing GET
requests with an additional parameter:</p>
<dl class="glossary docutils">
<dt id="term-callback">callback</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">The qualified name of a JavaScript function.</p>
</dd>
</dl>
<p>For example,
a client may request the revocation of an access token with the following request
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>https://example.com/revoke?token=agabcdefddddafdd&amp;callback=package.myCallback</pre>
</div>
<p>Successful response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">package</span><span class="o">.</span><span class="n">myCallback</span><span class="p">();</span>
</pre></div>
</div>
<p>Error response:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">package</span><span class="o">.</span><span class="n">myCallback</span><span class="p">({</span><span class="s">&quot;error&quot;</span><span class="p">:</span><span class="s">&quot;unsupported_token_type&quot;</span><span class="p">});</span>
</pre></div>
</div>
<p>Clients should be aware that when relying on JSONP,
a malicious revocation endpoint may attempt to inject malicious code into the client.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-2.3">http://tools.ietf.org/html/rfc7009#section-2.3</a> )</p>
</div>
</div>
<div class="section" id="implementation-note">
<span id="oauth-revocation-3"></span><h2><a class="toc-backref" href="#id9">3.  Implementation Note</a><a class="headerlink" href="#implementation-note" title="Permalink to this headline">¶</a></h2>
<p>OAuth 2.0 allows deployment flexibility with respect to the style of
access tokens.  The access tokens may be self-contained so that a
resource server needs no further interaction with an authorization
server issuing these tokens to perform an authorization decision of
the client requesting access to a protected resource.  A system
design may, however, instead use access tokens that are handles
referring to authorization data stored at the authorization server.
This consequently requires a resource server to issue a request to
the respective authorization server to retrieve the content of the
access token every time a client presents an access token.</p>
<p>While these are not the only options, they illustrate the
implications for revocation.  In the latter case, the authorization
server is able to revoke an access token previously issued to a
client when the resource server relays a received access token.  In
the former case, some (currently non-standardized) backend
interaction between the authorization server and the resource server
may be used when immediate access token revocation is desired.
Another design alternative is to issue short-lived access tokens,
which can be refreshed at any time using the corresponding refresh
tokens.  This allows the authorization server to impose a limit on
the time revoked when access tokens are in use.</p>
<p>Which approach of token revocation is chosen will depend on the
overall system design and on the application service provider&#8217;s risk
analysis.  The cost of revocation in terms of required state and
communication overhead is ultimately the result of the desired
security properties.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-3">http://tools.ietf.org/html/rfc7009#section-3</a> )</p>
</div>
<div class="section" id="iana-considerations">
<span id="oauth-revocation-4"></span><h2><a class="toc-backref" href="#id10">4.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>This specification registers an error value in the &#8220;OAuth Extensions
Error Registry&#8221; and establishes the &#8220;OAuth Token Type Hints&#8221;
registry.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc7009#section-4">http://tools.ietf.org/html/rfc7009#section-4</a> )</p>
<div class="section" id="oauth-extensions-error-registration">
<span id="oauth-revocation-4-1"></span><h3><a class="toc-backref" href="#id11">4.1.  OAuth Extensions Error Registration</a><a class="headerlink" href="#oauth-extensions-error-registration" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>This specification registers the following error value in the &#8220;OAuth
Extensions Error Registry&#8221; defined in [RFC6749].</div></blockquote>
<div class="section" id="the-unsupported-token-type-error-value">
<span id="oauth-revocation-4-1-1"></span><h4><a class="toc-backref" href="#id12">4.1.1.  The &#8220;unsupported_token_type&#8221; Error Value</a><a class="headerlink" href="#the-unsupported-token-type-error-value" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>Error name:  unsupported_token_type</p>
<p>Error Usage Location:  Revocation endpoint error response</p>
<p>Related Protocol Extension:  Token Revocation Endpoint</p>
<p>Change controller:  IETF</p>
<p>Specification document(s):  [RFC7009]</p>
</div></blockquote>
</div>
<div class="section" id="oauth-token-type-hints-registry">
<span id="oauth-revocation-4-1-2"></span><h4><a class="toc-backref" href="#id13">4.1.2.  OAuth Token Type Hints Registry</a><a class="headerlink" href="#oauth-token-type-hints-registry" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>This specification establishes the &#8220;OAuth Token Type Hints&#8221; registry.
Possible values of the parameter &#8220;token_type_hint&#8221; (see Section 2.1)
are registered with a Specification Required ([RFC5226]) after a two-
week review period on the <a class="reference external" href="mailto:oauth-ext-review&#37;&#52;&#48;ietf&#46;org">oauth-ext-review<span>&#64;</span>ietf<span>&#46;</span>org</a> mailing list, on
the advice of one or more Designated Experts.  However, to allow for
the allocation of values prior to publication, the Designated
Expert(s) may approve registration once they are satisfied that such
a specification will be published.  Registration requests must be
sent to the <a class="reference external" href="mailto:oauth-ext-review&#37;&#52;&#48;ietf&#46;org">oauth-ext-review<span>&#64;</span>ietf<span>&#46;</span>org</a> mailing list for review and
comment, with an appropriate subject (e.g., &#8220;Request for parameter:
example&#8221;).  Within the review period, the Designated Expert(s) will
either approve or deny the registration request, communicating this
decision to the review list and IANA.  Denials should include an
explanation and, if applicable, suggestions as to how to make the
request successful.  IANA must only accept registry updates from the
Designated Expert(s) and should direct all requests for registration
to the review mailing list.</div></blockquote>
<div class="section" id="registration-template">
<span id="oauth-revocation-4-1-2-1"></span><h5><a class="toc-backref" href="#id14">4.1.2.1.  Registration Template</a><a class="headerlink" href="#registration-template" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div><dl class="docutils">
<dt>Hint Value:  The additional value, which can be used to indicate a</dt>
<dd>certain token type to the authorization server.</dd>
<dt>Change controller:  For Standards Track RFCs, state &#8220;IETF&#8221;.  For</dt>
<dd>others, give the name of the responsible party.  Other details
(e.g., postal address, email address, and home page URI) may also
be included.</dd>
<dt>Specification document(s):  Reference to the document(s) that</dt>
<dd>specifies the type, preferably including a URI that can be used to
retrieve a copy of the document(s).  An indication of the relevant
sections may also be included but is not required.</dd>
</dl>
</div></blockquote>
</div>
<div class="section" id="initial-registry-contents">
<span id="oauth-revocation-4-1-2-2"></span><h5><a class="toc-backref" href="#id15">4.1.2.2.  Initial Registry Contents</a><a class="headerlink" href="#initial-registry-contents" title="Permalink to this headline">¶</a></h5>
<blockquote>
<div><p>The OAuth Token Type Hint registry&#8217;s initial contents are as follows.</p>
<blockquote>
<div><blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="42%" />
<col width="24%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Hint Value</td>
<td>Change Controller</td>
<td>Reference</td>
</tr>
<tr class="row-even"><td><blockquote class="first">
<div>access_token</div></blockquote>
<p class="last">refresh_token</p>
</td>
<td>IETF
IETF</td>
<td>[RFC7009]
[RFC7009]</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Table 1: OAuth Token Type Hints initial registry contents</p>
</div></blockquote>
</div></blockquote>
</div>
</div>
</div>
</div>
<div class="section" id="security-considerations">
<span id="oauth-revocation-5"></span><h2><a class="toc-backref" href="#id16">5.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>If the authorization server does not support access token revocation,
access tokens will not be immediately invalidated when the
corresponding refresh token is revoked.  Deployments must take this
into account when conducting their security risk analysis.</p>
<p>Cleaning up tokens using revocation contributes to overall security
and privacy since it reduces the likelihood for abuse of abandoned
tokens.  This specification in general does not intend to provide
countermeasures against token theft and abuse.  For a discussion of
respective threats and countermeasures, consult the security
considerations given in Section 10 of the OAuth core specification
[RFC6749] and the OAuth threat model document [RFC6819].</p>
<p>Malicious clients could attempt to use the new endpoint to launch
denial-of-service attacks on the authorization server.  Appropriate
countermeasures, which should be in place for the token endpoint as
well, MUST be applied to the revocation endpoint (see [RFC6819],
Section 4.4.1.11).  Specifically, invalid token type hints may
misguide the authorization server and cause additional database
lookups.  Care MUST be taken to prevent malicious clients from
exploiting this feature to launch denial-of-service attacks.</p>
<p>A malicious client may attempt to guess valid tokens on this endpoint
by making revocation requests against potential token strings.
According to this specification, a client&#8217;s request must contain a
valid client_id, in the case of a public client, or valid client
credentials, in the case of a confidential client.  The token being
revoked must also belong to the requesting client.  If an attacker is
able to successfully guess a public client&#8217;s client_id and one of
their tokens, or a private client&#8217;s credentials and one of their
tokens, they could do much worse damage by using the token elsewhere
than by revoking it.  If they chose to revoke the token, the
legitimate client will lose its authorization grant and will need to
prompt the user again.  No further damage is done and the guessed
token is now worthless.</p>
<p>Since the revocation endpoint is handling security credentials,
clients need to obtain its location from a trustworthy source only.
Otherwise, an attacker could capture valid security tokens by
utilizing a counterfeit revocation endpoint.  Moreover, in order to
detect counterfeit revocation endpoints, clients MUST authenticate
the revocation endpoint (certificate validation, etc.).</p>
</div>
<div class="section" id="acknowledgements">
<span id="oauth-revocation-6"></span><h2><a class="toc-backref" href="#id17">6.  Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div>We would like to thank Peter Mauritius, Amanda Anganes, Mark Wubben,
Hannes Tschofenig, Michiel de Jong, Doug Foiles, Paul Madsen, George
Fletcher, Sebastian Ebling, Christian Stuebner, Brian Campbell, Igor
Faynberg, Lukas Rosenstock, and Justin Richer for their valuable
feedback.</div></blockquote>
</div>
<div class="section" id="references">
<span id="oauth-revocation-7"></span><h2><a class="toc-backref" href="#id18">7.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="oauth-revocation-7-1"></span><h3><a class="toc-backref" href="#id19">7.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc5246">[RFC5246]</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-rfc6749">[RFC6749]</dt>
<dd>Hardt, D., &#8220;The OAuth 2.0 Authorization Framework&#8221;,
RFC 6749, October 2012.</dd>
</dl>
</div>
<div class="section" id="informative-references">
<span id="oauth-revocation-7-2"></span><h3><a class="toc-backref" href="#id20">7.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-rfc6819">[RFC6819]</dt>
<dd>Lodderstedt, T., McGloin, M., and P. Hunt, &#8220;OAuth 2.0
Threat Model and Security Considerations&#8221;, RFC 6819,
January 2013.</dd>
<dt id="term-w3c-wd-cors-20120403">[W3C.WD-cors-20120403]</dt>
<dd>Kesteren, A., &#8220;Cross-Origin Resource Sharing&#8221;, World Wide
Web Consortium LastCall WD-cors-20120403, April 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/WD-cors-20120403">http://www.w3.org/TR/2012/WD-cors-20120403</a>&gt;.</dd>
<dt id="term-jsonp">[jsonp]</dt>
<dd>Ippolito, B., &#8220;Remote JSON - JSONP&#8221;, December 2005,
&lt;<a class="reference external" href="http://bob.pythonmac.org/archives/2005/12/05/">http://bob.pythonmac.org/archives/2005/12/05/</a>
remote-json-jsonp&gt;.</dd>
</dl>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>