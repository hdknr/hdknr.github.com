

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OAuth Token Introspection &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Metadata for OAuth Responses" href="oauth_meta.html" />
    <link rel="prev" title="Token Revocation" href="oauth_revocation.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>OAuth Token Introspection</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth_revocation.html">Token Revocation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_meta.html">JSON Metadata for OAuth Responses</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="oauth-token-introspection">
<h1><a class="toc-backref" href="#id1">OAuth Token Introspection</a><a class="headerlink" href="#oauth-token-introspection" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#oauth-token-introspection" id="id1">OAuth Token Introspection</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1. Introduction</a></li>
<li><a class="reference internal" href="#introspection-endpoint" id="id4">2. Introspection Endpoint</a><ul>
<li><a class="reference internal" href="#introspection-request" id="id5">2.1. Introspection Request</a></li>
<li><a class="reference internal" href="#introspection-response" id="id6">2.2. Introspection Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-considerations" id="id7">4. Security Considerations</a></li>
<li><a class="reference internal" href="#normative-references" id="id8">6. Normative References</a></li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01">http://tools.ietf.org/html/draft-richer-oauth-introspection-01</a></li>
</ul>
<div class="section" id="abstract">
<span id="oauth-introspect-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification defines a method for a <a class="reference internal" href="oauth.html#term-client"><em class="xref std std-term">client</em></a>
or <a class="reference internal" href="glossary.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a> to query an OAuth <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
to determine meta-information about an OAuth <a class="reference internal" href="#term-token"><em class="xref std std-term">token</em></a>.</p>
<p>(draft 01)</p>
</div>
<div class="section" id="introduction">
<span id="oauth-introspect-1"></span><h2><a class="toc-backref" href="#id3">1. Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In OAuth,
the contents of tokens are opaque to clients.</p>
<p>This means that the <a class="reference internal" href="oauth.html#term-client"><em class="xref std std-term">client</em></a> does not need to know anything
about the content or structure of the token itself,
if there is any.</p>
<p>However, there is
still a large amount of metadata that may be attached to a token,
such as its current validity,
approved scopes,
and extra information about the authentication context
in which the token was issued.</p>
<p>These pieces of information are often vital to <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">Protected Resources</em></a>
making authorization decisions
based on the tokens being presented.
Since OAuth2 defines no direct relationship
between the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">Authorization Server</em></a> and the <a class="reference internal" href="glossary.html#term-protected-resource"><em class="xref std std-term">Protected Resource</em></a>,
only that they must have an agreement on the tokens themselves,
there have been many different approaches to bridging this gap.</p>
<p>This specification defines an <a class="reference internal" href="uma_core.html#term-introspection-endpoint"><em class="xref std std-term">Introspection Endpoint</em></a>
that allows the holder of a token
to query the Authorization Server to discover the set of metadata for a token.</p>
<p>A Protected Resource may use the mechanism described in this draft
to query the Introspection Endpoint
in a particular authorization decision context
and ascertain the relevant metadata
about the token in order to make this authorization decision appropriately.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-1">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-1</a> )</p>
</div>
<div class="section" id="introspection-endpoint">
<span id="oauth-introspect-2"></span><h2><a class="toc-backref" href="#id4">2. Introspection Endpoint</a><a class="headerlink" href="#introspection-endpoint" title="Permalink to this headline">¶</a></h2>
<p>The Introspection Endpoint is an OAuth 2 Endpoint
that responds to HTTP GET and HTTP POST requests from token holders.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>OAuth endpoints ということは access_token が必要ということ</li>
</ul>
</div>
<p>The endpoint takes a single parameter representing the token
(and optionally further authentication)
and returns a JSON document representing the meta information surrounding the token.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>入力 &#8220;token&#8221;</li>
<li>出力 &#8220;メタ情報JSON&#8221;</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2</a> )</p>
<div class="section" id="introspection-request">
<span id="oauth-introspect-2-1"></span><h3><a class="toc-backref" href="#id5">2.1. Introspection Request</a><a class="headerlink" href="#introspection-request" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-token">token</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">The string value of the token.</p>
</dd>
<dt id="term-resource-id">resource_id</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">A service-specific string
identifying the resource that the client doing the introspection is asking about.</p>
</dd>
</dl>
<p>The endpoint MAY allow other parameters
to provide context to the query.</p>
<p>For instance,
an authorization service may need
to know the IP address of the Client
in order to determine the appropriateness of the token being presented.</p>
<p>The endpoint SHOULD also require some form of authentication to access this endpoint,
such as the Client Authentication as described in OAuth 2 Core Specification [RFC6749]
or a separate OAuth2 Access Token.</p>
<p>The methods of managing and validating these authentication
credentials are out of scope of this specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>トークン必要(あるいはクレデンシャル)</li>
<li>アウトオブスコープ</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.1">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.1</a> )</p>
</div>
<div class="section" id="introspection-response">
<span id="oauth-introspect-2-2"></span><h3><a class="toc-backref" href="#id6">2.2. Introspection Response</a><a class="headerlink" href="#introspection-response" title="Permalink to this headline">¶</a></h3>
<p>The server responds with a JSON object [RFC4627] in &#8220;application/json&#8221; format
with the following top-level members.</p>
<p>Specific implementations MAY extend this structure
with their own service-specific pieces of information.</p>
<dl class="glossary docutils">
<dt id="term-valid">valid</dt>
<dd><p class="first">REQUIRED.</p>
<p class="last">Boolean indicator of whether or not the presented token is valid.</p>
</dd>
<dt id="term-expires-at">expires_at</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Integer timestamp, measured in the number of
seconds since January 1 1970 UTC, indicating when this token will
expire.</p>
</dd>
<dt id="term-issued-at">issued_at</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Integer timestamp, measured in the number of
seconds since January 1 1970 UTC, indicating when this token was
originally issued.</p>
</dd>
<dt id="term-scope">scope</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Array of strings representing the scopes associated
with this token.</p>
</dd>
<dt id="term-subject">subject</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Local identifier of the Resource Owner who authorized this token.</p>
</dd>
<dt id="term-client-id">client_id</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Client Identifier for the Client that requested this token.</p>
</dd>
<dt id="term-audience">audience</dt>
<dd><p class="first">OPTIONAL.</p>
<p class="last">Service-specific string identifier of the intended audience for this token.</p>
</dd>
</dl>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.2">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.2</a>)</p>
<p id="oauth-introspect-2-3">2.3. Non-normative Example</p>
<p>For example,
a Protected Resource accepts a request from a Client
carrying an OAuth2 Bearer Token.  In order to know how and whether to
serve the request, the Protected Resource then makes the following
request to the Introspection Endpoint of the Authorization Server.
The Protected Resource is here authenticating with its own Client ID
and Client Secret as per OAuth2 [RFC6749] Section 2.3.1.</p>
<p>Following is a non-normative example request (with line wraps for
display purposes only):</p>
<div class="highlight-python"><pre>POST /register HTTP/1.1
Accept: application/x-www-form-urlencoded
Host: server.example.com
Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3

token=X3241Affw.4233-99JXJ</pre>
</div>
<p>The Authorization Server validates the client credentials and looks
up the information in the token.  If the token is valid, it returns
the following JSON document.</p>
<p>Following is a non-normative example valid token response (with line
wraps for display purposes only):</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
 "valid": true,
 "client_id":"s6BhdRkqt3",
 "scope": ["read", "write", "dolphin"],
 "subject": "2309fj32kl",
 "audience": "http://example.org/protected-resource/*"
}</pre>
</div>
<p>If the token presented is not valid (but the authentication presented
is valid), it returns the following JSON document.</p>
<p>Following is a non-normative example invalid response (with line
wraps for display purposes only):</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json
Cache-Control: no-store

{
 "valid": false
}</pre>
</div>
<p>If the client credentials are invalid or there is another error, the
Authorization Server responds with the appropriate error response
from the OAuth2 Core.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.3">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-2.3</a> )</p>
</div>
</div>
<div class="section" id="security-considerations">
<span id="oauth-introspect-4"></span><h2><a class="toc-backref" href="#id7">4. Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>If left unprotected and un-throttled, the Introspection Endpoint
could present a means for an attacker to poll a series of possible
token values, fishing for a valid token.  Therefore, the
Authorization Server SHOULD issue special client credentials to any
protected resources or clients that need to access the introspection
endpoint.  These credentials may be used directly at the endpoint, or
they may be exchanged for an OAuth2 Access token scoped specifically
for the Introspection Endpoint.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-4">http://tools.ietf.org/html/draft-richer-oauth-introspection-01#section-4</a> )</p>
</div>
<div class="section" id="normative-references">
<span id="oauth-introspect-6"></span><h2><a class="toc-backref" href="#id8">6. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, <span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc2119.html"><strong>RFC 2119</strong></a>, March 1997.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, <span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc4627.html"><strong>RFC 4627</strong></a>, July 2006.</dd>
<dt id="term-rfc6749">[RFC6749]</dt>
<dd>Hardt, D., &#8220;The OAuth 2.0 Authorization Framework&#8221;,
<span class="target" id="index-2"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6749.html"><strong>RFC 6749</strong></a>, October 2012.</dd>
<dt id="term-rfc6750">[RFC6750]</dt>
<dd>Jones, M. and D. Hardt, &#8220;The OAuth 2.0 Authorization
Framework: Bearer Token Usage&#8221;, <span class="target" id="index-3"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6750.html"><strong>RFC 6750</strong></a>, October 2012.</dd>
</dl>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth_revocation.html">Token Revocation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_meta.html">JSON Metadata for OAuth Responses</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>