

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="SAML 2.0 Bearer Assertion Profiles for OAuth 2.0" href="oauth_saml2_bearer.html" />
    <link rel="prev" title="Auth 2.0 Threat Model and Security Considerations" href="oauth_threat.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-token-jwt-bearer-token-profiles-for-oauth-2-0">
<h1><a class="toc-backref" href="#id13">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a><a class="headerlink" href="#json-web-token-jwt-bearer-token-profiles-for-oauth-2-0" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id2">1.  Introduction</a><ul>
<li><a class="reference internal" href="#terminology" id="id3">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-parameter-bindings-for-transporting-assertions" id="id4">2.  HTTP Parameter Bindings for Transporting Assertions</a><ul>
<li><a class="reference internal" href="#using-jwts-as-authorization-grants" id="id5">2.1.  Using JWTs as Authorization Grants</a></li>
<li><a class="reference internal" href="#using-jwts-for-client-authentication" id="id6">2.2.  Using JWTs for Client Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-format-and-processing-requirements" id="id7">3.  JWT Format and Processing Requirements</a><ul>
<li><a class="reference internal" href="#authorization-grant-processing" id="id8">3.1.  Authorization Grant Processing</a></li>
<li><a class="reference internal" href="#client-authentication-processing" id="id9">3.2.  Client Authentication Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-grant-example" id="id10">4.  Authorization Grant Example</a></li>
<li><a class="reference internal" href="#references" id="id11">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id12">7.1.  Normative References</a></li>
</ul>
</li>
</ul>
</div>
<ul class="simple">
<li><a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-05">https://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-05</a></li>
</ul>
<div class="section" id="abstract">
<span id="oauth-jwt-bearer-abstract"></span><h2><a class="toc-backref" href="#id14">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification defines the use of a JSON Web Token (JWT) Bearer
Token as means for requesting an <a class="reference internal" href="glossary.html#term-oauth-2-0"><em class="xref std std-term">OAuth 2.0</em></a> <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> as well as
for use as a means of <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>.</p>
<p>(draft 04)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#json-web-token-jwt-bearer-token-profiles-for-oauth-2-0" id="id13">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a><ul>
<li><a class="reference internal" href="#abstract" id="id14">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id15">1.  Introduction</a><ul>
<li><a class="reference internal" href="#terminology" id="id16">1.2.  Terminology</a></li>
</ul>
</li>
<li><a class="reference internal" href="#http-parameter-bindings-for-transporting-assertions" id="id17">2.  HTTP Parameter Bindings for Transporting Assertions</a><ul>
<li><a class="reference internal" href="#using-jwts-as-authorization-grants" id="id18">2.1.  Using JWTs as Authorization Grants</a></li>
<li><a class="reference internal" href="#using-jwts-for-client-authentication" id="id19">2.2.  Using JWTs for Client Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwt-format-and-processing-requirements" id="id20">3.  JWT Format and Processing Requirements</a><ul>
<li><a class="reference internal" href="#authorization-grant-processing" id="id21">3.1.  Authorization Grant Processing</a></li>
<li><a class="reference internal" href="#client-authentication-processing" id="id22">3.2.  Client Authentication Processing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authorization-grant-example" id="id23">4.  Authorization Grant Example</a></li>
<li><a class="reference internal" href="#references" id="id24">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id25">7.1.  Normative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-jwt-bearer-1"></span><h2><a class="toc-backref" href="#id15">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Token (JWT) [JWT] is a JavaScript Object Notation (JSON) [RFC4627]
based security token encoding that enables identity and
security information to be shared across security domains.
A security token is generally issued by an <a class="reference internal" href="glossary.html#term-identity-provider"><em class="xref std std-term">identity provider</em></a> and
consumed by a <a class="reference internal" href="SamlHokProfile.html#term-relying-party"><em class="xref std std-term">relying party</em></a> that relies on its content to <em class="xref std std-term">identify</em>
the <a class="reference internal" href="standard.html#term-token"><em class="xref std std-term">token</em></a>&#8216;s <a class="reference internal" href="wss_saml_token_profile.html#term-subject"><em class="xref std std-term">subject</em></a> for security related purposes.</p>
<p>The <a class="reference internal" href="oauth.html"><em>OAuth 2.0 Authorization Framework</em></a> <a class="reference internal" href="oauth_saml2_bearer.html#term-rfc6749"><em class="xref std std-term">[RFC6749]</em></a> provides
a method for making authenticated HTTP requests to a resource using an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.
Access tokens are issued to third-party clients by an
authorization server (AS) with the (sometimes implicit) approval of
the <a class="reference internal" href="uma_core.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.</p>
<p>In OAuth,
an <em class="xref std std-term">authorization grant</em> is an <strong>abstract term</strong> used
to describe <strong>intermediate credentials</strong> that represent the resource owner authorization.
An authorization grant is used by the client to obtain an access token.
Several authorization grant types are defined
to support a wide range of client types and user experiences.
OAuth also allows for the definition of new extension
grant types to support additional clients or to provide a bridge
between OAuth and other trust frameworks.</p>
<p>Finally,
OAuth allows the definition of additional authentication mechanisms to be used by
clients when interacting with the authorization server.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">認可証 : 「抽象化された用語」</p>
<blockquote>
<div><ul class="simple">
<li>リソース所有者の認可を意味する</li>
<li>認可証はアクセストークンに交換できる</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>The <a class="reference internal" href="oauth_assertion.html"><em>Assertion Framework for OAuth 2.0</em></a> <a class="reference internal" href="oauth_saml2_bearer.html#term-i-d-ietf-oauth-assertions"><em class="xref std std-term">[I-D.ietf-oauth-assertions]</em></a> is
an abstract extension to OAuth 2.0 that provides a general framework
for the use of Assertions (a.k.a.  Security Tokens) as client
credentials and/or authorization grants with OAuth 2.0.  This
specification profiles the Assertion Framework for OAuth 2.0
[I-D.ietf-oauth-assertions] to define an extension grant type that
uses a JSON Web Token (JWT) Bearer Token to request an OAuth 2.0
access token as well as for use as client credentials.  The format
and processing rules for the JWT defined in this specification are
intentionally similar, though not identical, to those in the closely
related SAML 2.0 Bearer Assertion Profiles for OAuth 2.0
[I-D.ietf-oauth-saml2-bearer].</p>
<p>This document defines how a JSON Web Token (JWT) Bearer Token
can be used to request an access token
when a client wishes to utilize an existing trust relationship,
expressed through the semantics of (and digital signature calculated over) the JWT,
without a direct user approval step at the authorization server.</p>
<p>It also defines how a JWT can be used as a client authentication mechanism.
The use of a security token for client authentication is orthogonal to and
separable from using a security token as an authorization grant.
They can be used either in combination or separately.
Client authentication using a JWT is nothing more than an alternative way
for a client to authenticate to the token endpoint and
must be used in conjunction with some grant type to form a complete and meaningful
protocol request.
JWT authorization grants may be used with or
without client authentication or identification.
Whether or not client authentication is needed in conjunction with a JWT
authorization grant,
as well as the supported types of client authentication,
are policy decisions at the discretion of the authorization server.</p>
<p>The process by which the client obtains the JWT, prior to exchanging
it with the authorization server or using it for client
authentication, is out of scope.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-1">http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-1</a> )</p>
<div class="section" id="terminology">
<span id="oauth-jwt-bearer-1-2"></span><h3><a class="toc-backref" href="#id16">1.2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<p>All terms are as defined in
The <a class="reference internal" href="oauth.html"><em>OAuth 2.0 Authorization Protocol</em></a> [<a class="reference internal" href="#term-i-d-ietf-oauth-v2"><em class="xref std std-term">I-D.ietf.oauth-v2</em></a>],
<a class="reference internal" href="oauth_assertion.html"><em>OAuth 2.0 Assertion Profile</em></a> [<a class="reference internal" href="#term-i-d-ietf-oauth-assertions"><em class="xref std std-term">I-D.ietf.oauth-assertions</em></a>],
and <a class="reference internal" href="jwt.html"><em>JSON Web Token (JWT)</em></a> [<a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>].</p>
<p>(draft 02)</p>
</div>
</div>
<div class="section" id="http-parameter-bindings-for-transporting-assertions">
<span id="oauth-jwt-bearer-2"></span><h2><a class="toc-backref" href="#id17">2.  HTTP Parameter Bindings for Transporting Assertions</a><a class="headerlink" href="#http-parameter-bindings-for-transporting-assertions" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="oauth_assertion.html"><em>Assertion Framework for OAuth 2.0</em></a>
<a class="reference internal" href="oauth_saml2_bearer.html#term-i-d-ietf-oauth-assertions"><em class="xref std std-term">[I-D.ietf-oauth-assertions]</em></a>
defines generic HTTP parameters for transporting Assertions
(a.k.a.  Security Tokens) during interactions with a token endpoint.  This
section defines the values of those parameters for use with JWT
Bearer Tokens.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-2.1">http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-2.1</a> )</p>
<div class="section" id="using-jwts-as-authorization-grants">
<span id="oauth-jwt-bearer-2-1"></span><h3><a class="toc-backref" href="#id18">2.1.  Using JWTs as Authorization Grants</a><a class="headerlink" href="#using-jwts-as-authorization-grants" title="Permalink to this headline">¶</a></h3>
<p>To use a JWT Bearer Token as an authorization grant,
use the following parameter values and encodings.</p>
<p>The value of the &#8220;<a class="reference internal" href="oauth_assertion.html#term-grant-type"><em class="xref std std-term">grant_type</em></a>&#8221; parameter
MUST be &#8220;<strong>urn:ietf:params:oauth:grant-type:jwt-bearer</strong>&#8221;.</p>
<p>The value of the &#8220;<a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>&#8221; parameter MUST contain a single JWT.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>code</li>
<li>access_token</li>
<li>assertion</li>
</ul>
</div>
<p>The following non-normative example demonstrates
an <a class="reference internal" href="glossary.html#term-access-token-request"><em class="xref std std-term">Access Token Request</em></a> with a JWT as an <em class="xref std std-term">authorization grant</em>
(with extra line breaks for display purposes only):</p>
<div class="highlight-python"><pre>POST /token.oauth2 HTTP/1.1
Host: as.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-bearer
&amp;assertion=eyJhbGciOiJFUzI1NiJ9.
eyJpc3Mi[...omitted for brevity...].
J9l-ZhwP[...omitted for brevity...]</pre>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-2.1">http://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-04#section-2.1</a> )</p>
</div>
<div class="section" id="using-jwts-for-client-authentication">
<span id="oauth-jwk-bearer-client-authentication"></span><span id="oauth-jwt-bearer-2-2"></span><h3><a class="toc-backref" href="#id19">2.2.  Using JWTs for Client Authentication</a><a class="headerlink" href="#using-jwts-for-client-authentication" title="Permalink to this headline">¶</a></h3>
<p>To use a JWT Bearer Token for client authentication,
use the following parameter values and encodings.</p>
<p>The value of the &#8220;<a class="reference internal" href="oauth_assertion.html#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a>&#8221; parameter MUST be
&#8220;<strong>urn:ietf:params:oauth:client-assertion-type:jwt-bearer</strong>&#8221;.</p>
<blockquote>
<div>The value of the &#8220;client_assertion&#8221; parameter MUST contain a single JWT.</div></blockquote>
<p>The following non-normative example demonstrates client
authentication using a JWT during the presentation of an
authorization code grant in an Access Token Request
(with extra line breaks for display purposes only):</p>
<div class="highlight-python"><pre>POST /token.oauth2 HTTP/1.1
Host: as.example.com
Content-Type: application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=vAZEIHjQTHuGgaSvyW9hO0RpusLzkvTOww3trZBxZpo&amp;
client_assertion_type=urn%3Aietf%3Aparams%3Aoauth%3A
client-assertion-type%3Ajwt-bearer&amp;
client_assertion=eyJhbGciOiJSUzI1NiJ9.
eyJpc3Mi[...omitted for brevity...].
cC4hiUPo[...omitted for brevity...]</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-05#section-2.2">https://tools.ietf.org/html/draft-ietf-oauth-jwt-bearer-05#section-2.2</a> )</p>
</div>
</div>
<div class="section" id="jwt-format-and-processing-requirements">
<span id="oauth-jwt-bearer-3"></span><h2><a class="toc-backref" href="#id20">3.  JWT Format and Processing Requirements</a><a class="headerlink" href="#jwt-format-and-processing-requirements" title="Permalink to this headline">¶</a></h2>
<p>In order to issue an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> response
as described in The OAuth 2.0 Authorization Protocol [<a class="reference internal" href="#term-i-d-ietf-oauth-v2"><em class="xref std std-term">I-D.ietf.oauth-v2</em></a>]
or to rely on a <a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a> for <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST validate the JWT according to the criteria below.
Application of additional restrictions
and policy are at the discretion of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<ul>
<li><p class="first">The JWT MUST contain an &#8220;<a class="reference internal" href="session.html#term-iss"><em class="xref std std-term">iss</em></a>&#8221; (issuer) claim
that contains a unique identifier for the entity that issued the JWT.</p>
</li>
<li><p class="first">The JWT MUST contain a &#8220;<em class="xref std std-term">prn</em>&#8221; (principal) claim
identifying the subject of the transaction.
The principal MAY identify the <a class="reference internal" href="uma_core.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>
for whom the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is being requested.
For <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>,
the principal MUST be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> of the <em class="xref std std-term">OAuth client</em>.</p>
<p>When using JWTs as an <em class="xref std std-term">authorization grant</em>,
the principal SHOULD identify an authorized accessor
for whom the access token is being requested
(typically the <a class="reference internal" href="uma_core.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>, or an authorized delegate).</p>
</li>
<li><p class="first">The <a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a> MUST contain an &#8220;<a class="reference internal" href="session.html#term-8"><em class="xref std std-term">aud</em></a>&#8221; (audience) claim
containing a URI reference that identifies the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>,
or the service provider principal entity of its controlling domain,
as an intended audience.
The <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> URL of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY be used
as an acceptable value for an &#8220;<a class="reference internal" href="session.html#term-8"><em class="xref std std-term">aud</em></a>&#8221; element.
The authorization server MUST verify that it is an intended audience for the JWT.</p>
</li>
<li><p class="first">The JWT MUST contain an &#8220;<a class="reference internal" href="session.html#term-exp"><em class="xref std std-term">exp</em></a>&#8221; (expiration) claim
that limits the time window during which the JWT can be used.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify that the expiration time has not passed,
subject to allowable clock skew between systems.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY reject JWTs with an &#8220;exp&#8221; claim value
that is unreasonably far in the future.</p>
</li>
<li><p class="first">The JWT MAY contain an &#8220;<em class="xref std std-term">nbf</em>&#8221; (not before) claim
that identifies the time before which the token MUST NOT be accepted for processing.</p>
</li>
<li><p class="first">The JWT MAY contain other claims.</p>
</li>
<li><p class="first">The JWT MUST be digitally signed by the issuer and the authorization server MUST verify the signature.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify
that the JWT is valid in all other respects per JSON Web Token (JWT) [<a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>].</p>
</li>
</ul>
<p>(draft 02)</p>
<div class="section" id="authorization-grant-processing">
<span id="oauth-jwt-bearer-3-1"></span><h3><a class="toc-backref" href="#id21">3.1.  Authorization Grant Processing</a><a class="headerlink" href="#authorization-grant-processing" title="Permalink to this headline">¶</a></h3>
<p>If present,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST also validate the <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>.</p>
<p>Authorization servers SHOULD issue <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> with a limited lifetime
and require clients to refresh them
by requesting a new <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> using the same <a class="reference internal" href="standard.html#term-jwt"><em class="xref std std-term">JWT</em></a>,
if it is still valid, or with a new JWT.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> SHOULD NOT issue a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>.</p>
<p>If the JWT is not valid,
or the current time is not within the token&#8217;s valid time window for use,
the authorization server MUST construct an error response
as defined in The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2].</p>
<p>The value of the error parameter MUST be the &#8220;invalid_grant&#8221; error code.
The authorization server MAY include additional information
regarding the reasons the JWT was considered invalid
using the error_description or error_uri parameters.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
 "error":"invalid_grant",
 "error_description":"Audience validation failed"
}</pre>
</div>
<p>(draft 02)</p>
</div>
<div class="section" id="client-authentication-processing">
<span id="oauth-jwt-bearer-3-2"></span><h3><a class="toc-backref" href="#id22">3.2.  Client Authentication Processing</a><a class="headerlink" href="#client-authentication-processing" title="Permalink to this headline">¶</a></h3>
<p>If the client JWT is not valid,
or its subject confirmation requirements cannot be met,
the authorization server MUST construct an error response
as defined in The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2].</p>
<p>The value of the error parameter MUST be the &#8220;<em class="xref std std-term">invalid_client</em>&#8221; error code.
The authorization server MAY include additional information
regarding the reasons the JWT was considered invalid
using the error_description or error_uri parameters.</p>
<p>(draft 02)</p>
</div>
</div>
<div class="section" id="authorization-grant-example">
<span id="oauth-jwt-bearer-4"></span><h2><a class="toc-backref" href="#id23">4.  Authorization Grant Example</a><a class="headerlink" href="#authorization-grant-example" title="Permalink to this headline">¶</a></h2>
<p>Though non-normative,
the following examples illustrate what a conforming JWT
and access token request would look like.</p>
<p>Below is an example JSON object that could be encoded to produce the
JWT Claims Object for a JWT:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="s2">&quot;https://jwt-idp.example.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;prn&quot;</span><span class="o">:</span><span class="s2">&quot;mailto:mike@example.com&quot;</span><span class="p">,</span>
 <span class="s2">&quot;aud&quot;</span><span class="o">:</span><span class="s2">&quot;https://jwt-rp.example.net&quot;</span><span class="p">,</span>
 <span class="s2">&quot;nbf&quot;</span><span class="o">:</span><span class="mi">1300815780</span><span class="p">,</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1300819380</span><span class="p">,</span>
 <span class="s2">&quot;http://claims.example.com/member&quot;</span><span class="o">:</span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
<p>The following example JSON object,
used as the header of a JWT,
declares that the JWT is signed with the ECDSA P-256 SHA-256 algorithm.</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;ES256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>To present the JWT with the claims and header shown in the previous example
as part of an access token request,
for example,
the client might make the following HTTPS request
(line breaks are for display purposes only):</p>
<div class="highlight-python"><pre>POST /token.oauth2 HTTP/1.1
Host: authz.example.net
Content-Type: application/x-www-form-urlencoded

grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Ajwt-
bearer&amp;assertion=eyJhbGciOiJFUzI1NiJ9.
eyJpc3Mi[...omitted for brevity...].
J9l-ZhwP_2n[...omitted for brevity...]</pre>
</div>
<p>(draft 02)</p>
</div>
<div class="section" id="references">
<span id="oauth-jwt-bearer-7"></span><h2><a class="toc-backref" href="#id24">7.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(draft 02)</p>
<div class="section" id="normative-references">
<span id="oauth-jwt-bearer-7-1"></span><h3><a class="toc-backref" href="#id25">7.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-ietf-oauth-assertions">I-D.ietf.oauth-assertions</dt>
<dd><p class="first">Mortimore, C., Ed., Campbell, B., Jones, M., and Y.
Goland, &#8220;OAuth 2.0 Assertion Profile&#8221;,
ID draft-ietf-oauth-assertions-01 (work in progress),
October 2011.</p>
<p class="last">(<a class="reference internal" href="oauth_assertion.html"><em>Assertion Framework for OAuth 2.0</em></a> )</p>
</dd>
<dt id="term-i-d-ietf-oauth-urn-sub-ns">I-D.ietf.oauth-urn-sub-ns</dt>
<dd>Campbell, B., Ed. and H. Tschofenig, &#8220;An IETF URN Sub-
Namespace for OAuth&#8221;, ID draft-ietf-oauth-urn-sub-ns-00
(work in progress), Aug 2011.</dd>
<dt id="term-i-d-ietf-oauth-v2">I-D.ietf.oauth-v2</dt>
<dd>Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, &#8220;The
OAuth 2.0 Authorization Protocol&#8221;,
ID draft-ietf-oauth-v2-22 (work in progress),
September 2011.</dd>
<dt id="term-jwt">JWT</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
J., Sakimura, N., and P. Tarjan, &#8220;JSON Web Token (JWT)&#8221;,
October 2011.</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc4627">RFC4627</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">RFC4648</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
</dl>
<p>(draft 02)</p>
<p id="oauth-jwt-bearer-7-2">7.2.  Informative References</p>
<dl class="glossary docutils">
<dt id="term-i-d-ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</dt>
<dd>Mortimore, C., &#8220;SAML 2.0 Bearer Assertion Profiles for
OAuth 2.0&#8221;, draft-ietf-oauth-saml2-bearer-09 (work in
progress), October 2011.</dd>
<dt id="term-w3c-rec-html401-19991224">W3C.REC-html401-19991224</dt>
<dd>Jacobs, I., Raggett, D., and A. Hors, &#8220;HTML 4.01
Specification&#8221;, World Wide Web Consortium
Recommendation REC-html401-19991224, December 1999,
&lt;<a class="reference external" href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.</dd>
</dl>
<p>(draft 02)</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>