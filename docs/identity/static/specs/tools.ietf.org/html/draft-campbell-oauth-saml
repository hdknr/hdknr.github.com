<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:campbell-oauth-saml" />
<meta name="DC.Description.Abstract" content="This specification defines the use of a SAML 2.0 bearer Assertion as\nmeans for requesting an OAuth 2.0 access token." />
<meta name="DC.Creator" content="Campbell, Brian" />
<meta name="DC.Creator" content="Mortimore, Chuck" />
<meta name="DC.Date.Issued" content="2010-12-13" />
<meta name="DC.Title" content="SAML 2.0 Bearer Assertion Grant Type Profile for OAuth 2.0" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-campbell-oauth-saml-01 - SAML 2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-campbell-oauth-saml-01.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-campbell-oauth-saml-01.txt" title="PDF version of this document">pdf</a>] [<a href='https://datatracker.ietf.org/doc/draft-campbell-oauth-saml' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="mailto:draft-campbell-oauth-saml@tools.ietf.org?subject=draft-campbell-oauth-saml%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-campbell-oauth-saml-01.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-campbell-oauth-saml-01.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-campbell-oauth-saml-01.txt" title="Run an idnits check of this document">Nits</a>]               </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-campbell-oauth-saml-00">00</a> <a href="./draft-campbell-oauth-saml-01">01</a> <a href="./draft-ietf-oauth-saml2-bearer" title="draft-ietf-oauth-saml2-bearer replaces this draft">draft-ietf-oauth-saml2-bearer</a>                           </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
                                                        B. Campbell, Ed.
Internet-Draft                                       Ping Identity Corp.
Intended status: Standards Track                            C. Mortimore
Expires: June 16, 2011                                    Salesforce.com
                                                       December 13, 2010


       <span class="h1">SAML 2.0 Bearer Assertion Grant Type Profile for OAuth 2.0</span>
                      <span class="h1">draft-campbell-oauth-saml-01</span>

Abstract

   This specification defines the use of a SAML 2.0 bearer Assertion as
   means for requesting an OAuth 2.0 access token.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on June 16, 2011.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Notational Conventions . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  SAML Assertion Access Token Request  . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  Client Requests Access Token . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Assertion Format and Processing Requirements . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Error Response . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  Example (non-normative)  . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
   <a href="#section-3">3</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-4">4</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-A">Appendix A</a>.  Contributors  . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-B">Appendix B</a>.  Document History  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-5">5</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-5.1">5.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-5.2">5.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>


































<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   The Security Assertion Markup Language (SAML) 2.0
   [<a href="#ref-OASIS.saml-core-2.0-os">OASIS.saml-core-2.0-os</a>], is an XML-based framework that allows for
   identity and security information to be shared across security
   domains.  The SAML specification, while primarily targeted at
   providing cross domain web browser single sign-on, was also designed
   to be modular and extensible to facilitate use in other contexts.
   The Assertion, an XML security token, is a fundamental construct of
   SAML that is often adopted for use in other protocols and
   specifications.  An Assertion is generally issued by an identity
   provider and consumed by a service provider who relies on its content
   to identify the Assertion's subject for security related purposes.

   OAuth 2.0 [<a href="#ref-I-D.ietf.oauth-v2">I-D.ietf.oauth-v2</a>] provides a method for making
   authenticated HTTP requests to a resource using an access token.
   Access tokens are issued to third-party clients by an authorization
   server (AS) with the (sometimes implicit) approval of the resource
   owner.  OAuth defines multiple profiles for obtaining access tokens
   to support a wide range of client types and user experiences.  One
   such method is one in which the client trades an 'assertion' (not
   specifically a SAML Assertion) for an access token using the so-
   called 'assertion grant_type'.  However OAuth 2.0 leaves the specific
   format and validation of the assertion out of scope.

   This specification profiles the use of a SAML 2.0 bearer Assertion in
   requesting an access token using the assertion grant_type from OAuth
   2.0.  The format and processing rules for the SAML Assertion defined
   in this specification are intentionally similar, though not
   identical, to those in the Web Browser SSO Profile defined in
   [<a href="#ref-OASIS.saml-profiles-2.0-os">OASIS.saml-profiles-2.0-os</a>] reusing, to the extent reasonable,
   concepts and patterns from that well-established profile.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Notational Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   Unless otherwise noted, all the protocol parameter names and values
   are case sensitive.


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  SAML Assertion Access Token Request</span>

   A SAML Assertion can be used to request an access token when a client
   wishes to utilize an existing trust relationship, expressed though
   the semantics of (and digital signature calculated over) the SAML



<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   Assertion, without a direct user approval step at the authorization
   server.

   The process by which the client obtains the SAML Assertion, prior to
   exchanging it with the authorization server, is out of scope.



        +--------+                                  +---------------+
        |        |                                  |               |
        |        |&gt;--(A)-- SAML 2.0 Assertion -----&gt;| Authorization |
        | Client |                                  |     Server    |
        |        |&lt;--(B)---- Access Token ---------&lt;|               |
        |        |                                  |               |
        +--------+                                  +---------------+


                 Figure 1: Assertion Access Token Request

   The request/response flow illustrated in Figure 1 includes the
   following steps:

   (A)  The client sends an access token request to the authorization
        server with an appropriate OAuth grant_type and includes a SAML
        2.0 Assertion.

   (B)  The authorization server validates the Assertion per the
        processing rules defined in this specification and issues an
        access token.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Client Requests Access Token</span>

   The client requests an access token by making an HTTP "POST" request
   to the token endpoint using SAML Assertion as the access grant.  The
   client makes an access token request, as defined in OAuth, with the
   following parameter definitions taking precedence in the constructed
   URI:

   grant_type
         REQUIRED.  The value of the grant_type parameter MUST be
         "<a href="http://oauth.net/grant_type/assertion/saml/2.0/bearer">http://oauth.net/grant_type/assertion/saml/2.0/bearer</a>"

   assertion
         REQUIRED.  The value of the assertion parameter MUST contain a
         single SAML 2.0 Assertion.  The SAML Assertion XML data MUST be
         encoded using base64url, where the encoding adheres to the
         definition in <a href="./rfc4648#section-5">Section&nbsp;5 of RFC4648</a> [<a href="./rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>] and where the
         padding bits are set to zero.  To to avoid the need for



<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


         subsequent encoding steps (by "application/
         x-www-form-urlencoded" [<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>], for
         example), the base64url encoded data SHOULD NOT be line wrapped
         and pad characters ("=") SHOULD NOT be included.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Assertion Format and Processing Requirements</span>

   Prior to issuing an access token response as described in
   [<a href="#ref-I-D.ietf.oauth-v2">I-D.ietf.oauth-v2</a>], the authorization server MUST validate the
   Assertion according to the criteria below.  Application of additional
   restrictions and policy are at the discretion of the authorization
   server.

   o  The Assertion's &lt;Issuer&gt; element MUST contain a unique identifier
      for the entity that issued the Assertion; the Format attribute
      MUST be omitted or have a value of
      "urn:oasis:names:tc:SAML:2.0:nameid-format:entity".

   o  The Assertion MUST contain a &lt;Subject&gt; element.  The subject MAY
      identify the resource owner for whom the access token is being
      requested.

   o  The &lt;Subject&gt; element MUST contain at least one
      &lt;SubjectConfirmation&gt; element that allows the authorization server
      to confirm it as a bearer Assertion.  Conditions for bearer
      subject confirmation are described below.

      *  The &lt;SubjectConfirmation&gt; MUST have a Method attribute with a
         value of "urn:oasis:names:tc:SAML:2.0:cm:bearer" and MUST
         contain a &lt;SubjectConfirmationData&gt; element.

      *  The &lt;SubjectConfirmationData&gt; element MUST have a Recipient
         attribute with a value indicating the token endpoint URL of the
         authorization server.  The authorization server MUST verify
         that the value of the Recipient attribute matches the token
         endpoint URL (or an acceptable alias) to which the Assertion
         was delivered.

      *  The &lt;SubjectConfirmationData&gt; element MUST have a NotOnOrAfter
         attribute that limits the window during which the Assertion can
         be confirmed.  The authorization server MUST verify that the
         NotOnOrAfter instant has not passed, subject to allowable clock
         skew between systems.  The authorization server MAY ensure that
         bearer Assertions are not replayed, by maintaining the set of
         used ID values for the length of time for which the Assertion
         would be considered valid based on the NotOnOrAfter attribute
         in the &lt;SubjectConfirmationData&gt;.




<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


      *  The &lt;SubjectConfirmationData&gt; element MAY also contain an
         Address attribute limiting the client address from which the
         Assertion can be delivered.  Verification of the Address is at
         the discretion of the authorization server.

   o  If the Assertion issuer authenticated the subject, the Assertion
      SHOULD contain a single &lt;AuthnStatement&gt; representing that
      authentication event.

   o  If the Assertion was issued with the intention that the client act
      autonomously on behalf of the subject, an &lt;AuthnStatement&gt; SHOULD
      NOT be included.  The client SHOULD be identified in the &lt;NameID&gt;
      or similar element the &lt;SubjectConfirmation&gt; element or by other
      available means like [<a href="#ref-OASIS.saml-deleg-cs">OASIS.saml-deleg-cs</a>].

   o  Other statements, in particular, &lt;AttributeStatement&gt; elements MAY
      be included in the Assertion.

   o  The Assertion MUST contain an &lt;AudienceRestriction&gt; element with
      an &lt;Audience&gt; element containing a URI reference that identifies
      the authorization server, or the service provider SAML entity of
      its controlling domain, as an intended audience.  The
      authorization server MUST verify that it is an intended audience
      for the Assertion.

   o  The Assertion MUST be digitally signed by the issuer and the
      authorization server MUST verify the signature.

   o  Encrypted elements MAY appear in place of their plain text
      counterparts as defined in [<a href="#ref-OASIS.saml-core-2.0-os">OASIS.saml-core-2.0-os</a>].

   o  The authorization server MUST verify that the Assertion is valid
      in all other respects per [<a href="#ref-OASIS.saml-core-2.0-os">OASIS.saml-core-2.0-os</a>] such as (but
      not limited to) evaluating all content within the Conditions
      element including the NotOnOrAfter and NotBefore attributes,
      rejecting unknown condition types, etc.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Error Response</span>

   If the Assertion is not valid, or its subject confirmation
   requirements cannot be met, the the authorization server MUST
   construct an error response as defined in [<a href="#ref-I-D.ietf.oauth-v2">I-D.ietf.oauth-v2</a>].  The
   value of the error parameter MUST be the "invalid_grant" error code.
   The authorization server MAY include additional information regarding
   the reasons the Assertion was considered invalid using the
   error_description or error_uri parameters.





<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   For example:


   HTTP/1.1 400 Bad Request
   Content-Type: application/json
   Cache-Control: no-store

   {
     "error":"invalid_grant",
     "error_description":"Audience validation failed"
   }


<span class="h3"><a class="selflink" name="section-2.4" href="#section-2.4">2.4</a>.  Example (non-normative)</span>

   Though non-normative, the following examples illustrate what a
   conforming Assertion and access token request would look like.


































<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   Below is an example SAML 2.0 Assertion (whitespace formatting is for
   display purposes only):


   &lt;Assertion IssueInstant="2010-10-01T20:07:34.619Z"
     ID="ef1xsbZxPV2oqjd7HTLRLIBlBb7"
     Version="2.0"
     xmlns="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
    &lt;Issuer&gt;https://saml-idp.example.com&lt;/Issuer&gt;
    &lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
     [...omitted for brevity...]
    &lt;/ds:Signature&gt;
    &lt;Subject&gt;
     &lt;NameID
       Format="urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"&gt;
      brian@example.com
     &lt;/NameID&gt;
     &lt;SubjectConfirmation
       Method="urn:oasis:names:tc:SAML:2.0:cm:bearer"&gt;
      &lt;SubjectConfirmationData
        NotOnOrAfter="2010-10-01T20:12:34.619Z"
        Recipient="https://authz.example.net/token.oauth2"/&gt;
      &lt;/SubjectConfirmation&gt;
     &lt;/Subject&gt;
     &lt;Conditions&gt;
       &lt;AudienceRestriction&gt;
         &lt;Audience&gt;https://saml-sp.example.net&lt;/Audience&gt;
       &lt;/AudienceRestriction&gt;
     &lt;/Conditions&gt;
     &lt;AuthnStatement AuthnInstant="2010-10-01T20:07:34.371Z"&gt;
       &lt;AuthnContext&gt;
         &lt;AuthnContextClassRef&gt;
           urn:oasis:names:tc:SAML:2.0:ac:classes:X509
         &lt;/AuthnContextClassRef&gt;
       &lt;/AuthnContext&gt;
     &lt;/AuthnStatement&gt;
   &lt;/Assertion&gt;

                   Figure 2: Example SAML 2.0 Assertion












<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   To present the Assertion shown in the previous example as part of an
   access token request, for example, the client might make the
   following HTTPS request (line breaks are for display purposes only):


   POST /token.oauth2 HTTP/1.1
   Host: authz.example.net
   Content-Type: application/x-www-form-urlencoded

   grant_type=http%3A%2F%2Foauth.net%2Fgrant_type%2Fassertion%2F
   saml%2F2.0%2Fbearer&amp;assertion=PEFzc2VydGlvbiBJc3N1ZUluc3RhbnQ
   [...omitted for brevity...]V0aG5TdGF0ZW1lbnQ-PC9Bc3NlcnRpb24-

                         Figure 3: Example Request


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Security Considerations</span>

   No additional considerations beyond those described within the OAuth
   2.0 Protocol [<a href="#ref-I-D.ietf.oauth-v2">I-D.ietf.oauth-v2</a>] and in the Security and Privacy
   Considerations for the OASIS Security Assertion Markup Language
   (SAML) V2.0 [<a href="#ref-OASIS.saml-sec-consider-2.0-os">OASIS.saml-sec-consider-2.0-os</a>].


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  IANA Considerations</span>

   This document has no actions for IANA.


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Contributors</span>

   The following people contributed wording and concepts to this
   document: Paul Madsen, Patrick Harding, Peter Motyka, Peter Saint-
   Andre, Ian Barnett, Eric Fazendin, Torsten Lodderstedt, Scott Cantor
   and David Waite


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Document History</span>

   [[ to be removed by RFC editor before publication as an RFC ]]

   -01

   o  Updated to reference <a href="./draft-ietf-oauth-v2-11">draft-ietf-oauth-v2-11</a> and reflect changes
      from -10 to -11.

   o  Updated examples.




<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                 [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   o  Relaxed processing rules to allow for more than one
      SubjectConfirmation element.

   o  Removed the 'MUST NOT contain a NotBefore attribute' on
      SubjectConfirmationData.

   o  Relaxed wording that ties the subject of the Assertion to the
      resource owner.

   o  Added some wording about identifying the client when the subject
      hasn't directly authenticated including an informative reference
      to SAML V2.0 Condition for Delegation Restriction.

   o  Added a few examples to the language about verifying that the
      Assertion is valid in all other respects.

   o  Added some wording to the introduction about the similarities to
      Web SSO in the format and processing rules

   o  Changed the grant_type (was assertion_type) URI from
      <a href="http://oauth.net/assertion_type/saml/2.0/bearer">http://oauth.net/assertion_type/saml/2.0/bearer</a> to
      <a href="http://oauth.net/grant_type/assertion/saml/2.0/bearer">http://oauth.net/grant_type/assertion/saml/2.0/bearer</a>

   o  Changed title to include "Grant Type" in it.

   o  Editorial updates based on feedback from the WG and others
      (including capitalization of Assertion when referring to SAML).

   -00

   o  Initial I-D


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  References</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Normative References</span>

   [<a name="ref-I-D.ietf.oauth-v2" id="ref-I-D.ietf.oauth-v2">I-D.ietf.oauth-v2</a>]
              Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, "The
              OAuth 2.0 Protocol Framework", ID <a href="./draft-ietf-oauth-v2-11">draft-ietf-oauth-v2-11</a>,
              Dec 2010.

   [<a name="ref-OASIS.saml-core-2.0-os" id="ref-OASIS.saml-core-2.0-os">OASIS.saml-core-2.0-os</a>]
              Cantor, S., Kemp, J., Philpott, R., and E. Maler,
              "Assertions and Protocol for the OASIS Security Assertion
              Markup Language (SAML) V2.0", OASIS Standard saml-core-
              2.0-os, March 2005.




<span class="grey">Campbell &amp; Mortimore      Expires June 16, 2011                [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey">Internet-Draft     OAuth SAML Bearer Assertion Profile     December 2010</span>


   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC4648" id="ref-RFC4648">RFC4648</a>]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="./rfc4648">RFC 4648</a>, October 2006.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Informative References</span>

   [<a name="ref-OASIS.saml-deleg-cs" id="ref-OASIS.saml-deleg-cs">OASIS.saml-deleg-cs</a>]
              Cantor, S., Ed., "SAML V2.0 Condition for Delegation
              Restriction", Nov 2009.

   [<a name="ref-OASIS.saml-profiles-2.0-os" id="ref-OASIS.saml-profiles-2.0-os">OASIS.saml-profiles-2.0-os</a>]
              Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra,
              P., Philpott, R., and E. Maler, "Profiles for the OASIS
              Security Assertion Markup Language (SAML) V2.0", OASIS
              Standard OASIS.saml-profiles-2.0-os, March 2005.

   [<a name="ref-OASIS.saml-sec-consider-2.0-os" id="ref-OASIS.saml-sec-consider-2.0-os">OASIS.saml-sec-consider-2.0-os</a>]
              Hirsch, F., Philpott, R., and E. Maler, "Security and
              Privacy Considerations for the OASIS Security Markup
              Language (SAML) V2.0", OASIS Standard saml-sec-consider-
              2.0-os, March 2005.

   [<a name="ref-W3C.REC-html401-19991224" id="ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]
              Hors, A., Jacobs, I., and D. Raggett, "HTML 4.01
              Specification", World Wide Web Consortium
              Recommendation REC-html401-19991224, December 1999,
              &lt;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.


Authors' Addresses

   Brian Campbell (editor)
   Ping Identity Corp.

   Email: brian.d.campbell@gmail.com


   Chuck Mortimore
   Salesforce.com

   Email: cmortimore@salesforce.com








Campbell &amp; Mortimore      Expires June 16, 2011                [Page 11]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
