<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:2818" />
<meta name="DC.Description.Abstract" content="This memo describes how to use Transport Layer Security (TLS) to\nsecure Hypertext Transfer Protocol (HTTP) connections over the\nInternet. This memo provides information for the Internet community." />
<meta name="DC.Creator" content="E. Rescorla" />
<meta name="DC.Date.Issued" content="May, 2000" />
<meta name="DC.Title" content="HTTP Over TLS" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-tls-https-03 - HTTP Over TLS</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-ietf-tls-https-03.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-tls-https-03.txt" title="PDF version of this document">pdf</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-tls-https' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/tls" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-tls-https@tools.ietf.org?subject=draft-ietf-tls-https%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-tls-https-03.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-ietf-tls-https-03.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-ietf-tls-https-03.txt" title="Run an idnits check of this document">Nits</a>]          </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-ietf-tls-https-00">00</a> <a href="./draft-ietf-tls-https-01">01</a> <a href="./draft-ietf-tls-https-02">02</a> <a href="./draft-ietf-tls-https-03">03</a> <a href="./rfc2818">RFC 2818</a>                                          </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
                                                          E. Rescorla
INTERNET-DRAFT                                              RTFM, Inc.
&lt;<a href="./draft-ietf-tls-https-03.txt">draft-ietf-tls-https-03.txt</a>&gt;        September 1999 (Expires March-00)

                             HTTP Over TLS

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of <a href="./rfc2026#section-10">Section&nbsp;10 of RFC2026</a>.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference mate-
   rial or to cite them other than as ``work in progress.''

   The list of current Internet-Drafts can be accessed at
   <a href="http://www.ietf.org/ietf/1id-abstracts.txt">http://www.ietf.org/ietf/1id-abstracts.txt</a>

   The list of Internet-Draft Shadow Directories can be accessed at
   <a href="http://www.ietf.org/shadow.html">http://www.ietf.org/shadow.html</a>.


   To learn the current status of any Internet-Draft, please check the
   ``1id-abstracts.txt'' listing contained in the Internet-Drafts Shadow
   Directories on ftp.is.co.za (Africa), nic.nordu.net (Europe),
   munnari.oz.au (Pacific Rim), ds.internic.net (US East Coast), or
   ftp.isi.edu (US West Coast).

Abstract

   This memo describes how to use TLS to secure HTTP connections over
   the Internet. Current practice is to layer HTTP over SSL (the prede-
   cessor to TLS), distinguishing secured traffic from insecure traffic
   by the use of a different server port. This document documents that
   practice using TLS. A companion document describes a method for using
   HTTP/TLS over the same port as normal HTTP.

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   HTTP [<a href="./rfc2616">RFC2616</a>] was originally used in the clear on the Internet.
   However, increased use of HTTP for sensitive applications has
   required security measures. SSL, and its successor TLS [<a href="#ref-TLS" title="&quot;The TLS Protocol&quot;">TLS</a>] were
   designed to provide channel-oriented security. This document
   describes how to use HTTP over TLS.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Discussion of this Draft</span>

   This draft is being discussed on the "ietf-apps-tls" mailing list. To
   subscribe, send a message to:

     ietf-apps-tls-request@imc.org

<span class="grey">Rescorla                                                         [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

with the single word

     subscribe

in the body of the message. There is a Web site for the mailing list at
&lt;<a href="http://www.imc.org/ietf-apps-tls/">http://www.imc.org/ietf-apps-tls/</a>&gt;.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Requirements Terminology</span>

   Keywords "MUST", "MUST NOT", "REQUIRED", "SHOULD", "SHOULD NOT" and
   "MAY" that appear in this document are to be interpreted as described
   in [<a href="./rfc2119" title="&quot;Key Words for use in RFCs to indicate Requirement Levels&quot;">RFC2119</a>].

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  HTTP Over TLS</span>

   Conceptually, HTTP/TLS is very simple. Simply use HTTP over TLS pre-
   cisely as you would use HTTP over TCP.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Connection Initiation</span>

   The agent acting as the HTTP client should also act as the TLS
   client.  It should initiate a connection to the server on the appro-
   priate port and then send the TLS ClientHello to begin the TLS hand-
   shake. When the TLS handshake has finished. The client may then ini-
   tiate the first HTTP request.  All HTTP data MUST be sentas TLS
   "application data".  Normal HTTP behavior, including retained connec-
   tions should be followed.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Connection Closure</span>

   TLS provides a facility for secure connection closure. When a valid
   closure alert is received, an implementation can be assured that no
   further data will be received on that connection.  TLS implementa-
   tions MUST initiate an exchange of closure alerts before closing a
   connection. A TLS implementation MAY, after sending a closure alert,
   close the connection without waiting for the peer to send its closure
   alert, generating an "incomplete close".  Note that an implementation
   which does this MAY choose to reuse the session.  This SHOULD only be
   done when the application knows (typically through detecting HTTP
   message boundaries) that it has received all the message data that it
   cares about.

   As specified in [<a href="#ref-TLS" title="&quot;The TLS Protocol&quot;">TLS</a>], any implementation which receives a connection
   close without first receiving a valid closure alert (a "premature
   close") MUST NOT reuse that session.  Note that a premature close
   does not call into question the security of the data already
   received, but simply indicates that subsequent data might have been
   truncated. Because TLS is oblivious to HTTP request/response

<span class="grey">Rescorla                                                         [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

   boundaries, it is necessary to examine the HTTP data itself (specifi-
   cally the Content-Length header) to determine whether the truncation
   occurred inside a message or between messages.

<span class="h4"><a class="selflink" name="section-2.2.1" href="#section-2.2.1">2.2.1</a>.  Client Behavior</span>

   Because HTTP uses connection closure to signal end of server data,
   client implementations MUST treat any premature closes as errors and
   the data received as potentially truncated. Two cases in particular
   deserve special note:

     A HTTP response without a Content-Length header. Since data length in
     this situation is signalled by connection close a premature close
     generated by the server cannot be distinguished from a spurious
     close generated by an attacker.

     A HTTP response with a valid Content-Length header closed before
     all data has been read. Because TLS does not provide document
     oriented protection, it is impossible to determine whether the
     server has miscomputed the Content-Length or an attacker has
     truncated the connection.

   When encountering a premature close, a client SHOULD treat as com-
   pleted all requests for which it has received as much data as speci-
   fied in the Content-Length header.

   A client detecting an incomplete close SHOULD recover gracefully.  It
   MAY resume a TLS session closed in this fashion.

   Clients MUST send a closure alert before closing the connection.
   Clients which are unprepared to receive any more data MAY choose not
   to wait for the server's closure alert and simply close the connec-
   tion, thus generating an incomplete close on the server side.

<span class="h4"><a class="selflink" name="section-2.2.2" href="#section-2.2.2">2.2.2</a>.  Server Behavior</span>

   <a href="./rfc2068">RFC2068</a> permits an HTTP client to close the connection at any time,
   and requires servers to recover gracefully.  In particular, servers
   SHOULD be prepared to receive an incomplete close from the client,
   since the client can often determine when the end of server data is.
   Servers SHOULD be willing to resume TLS sessions closed in this fash-
   ion.

   Implementation note: In HTTP implementations which do not use persis-
   tent connections, the server ordinarily expects to be able to signal
   end of data by closing the connection. When Content-Length is used,
   however, the client may have already sent the closure alert and

<span class="grey">Rescorla                                                         [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

   dropped the connection.

   Servers MUST attempt to initiate an exchange of closure alerts with
   the client before closing the connection. Servers MAY close the con-
   nection after sending the closure alert, thus generating an incom-
   plete close on the client side.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Port Number</span>

   The first data that an HTTP server expects to receive from the client
   is the Request-Line production. The first data that a TLS server (and
   hence an HTTP/TLS server) expects to receive is the ClientHello. Con-
   sequently, common practice has been to run HTTP/TLS over a separate
   port in order to distinguish which protocol is being used. When
   HTTP/TLS is being run over a TCP/IP connection, the default port is
   443. This does not preclude HTTP/TLS from being run over another
   transport. TLS only presumes a reliable connection-oriented data
   stream.

<span class="h3"><a class="selflink" name="section-2.4" href="#section-2.4">2.4</a>.  URI Format</span>

   HTTP/TLS is differentiated from HTTP URIs by using the 'https' proto-
   col identifier in place of the 'http' protocol identifier. An example
   URI specifying HTTP/TLS is:

     https://www.example.com/~smith/home.html

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Endpoint Identification</span>

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Server Identity</span>

   In general, HTTP/TLS requests are generated by dereferencing a URI.
   As a consequence, the hostname for the server is known to the client.
   If the hostname is available, the client MUST check it against the
   server's identity as presented in the server's Certificate message,
   in order to prevent man-in-the-middle attacks.

   If the client has external information as to the expected identity of
   the server, the hostname check MAY be omitted. (For instance, a
   client may be connecting to a machine whose address and hostname are
   dynamic but the client knows the certificate that the server will
   present.) In such cases, it is important to narrow the scope of
   acceptable certificates as much as possible in order to prevent man
   in the middle attacks.  In special cases, it may be appropriate for
   the client to simply ignore the server's identity, but it must be
   understood that this leaves the connection open to active attack.

<span class="grey">Rescorla                                                         [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

   If a subjectAltName extension of type dNSName is present, that MUST
   be used as the identity. Otherwise, the (most specific) Common Name
   field in the Subject field of the certificate MUST be used. Although
   the use of the Common Name is existing practice, it is deprecated and
   Certification Authorities are encouraged to use the dNSName instead.

   Matching is performed using the matching rules specified by [PKIX].
   If more than one identity of a given type is present in the certifi-
   cate (e.g. more than one dNSName name, a match in any one of the set
   is considered acceptable.) Names may contain the wildcard character *
   which is considered to match any single domain name component or com-
   ponent fragment. E.g.  *.a.com matches foo.a.com but not
   bar.foo.a.com. f*.com matches foo.com but not bar.com.

   If the hostname does not match the identity in the certificate, user
   oriented clients MUST either notify the user (clients MAY give the
   user the opportunity to continue with the connection in any case) or
   terminate the connection with a bad certificate error. Automated
   clients MUST log the error to an appropriate audit log (if available)
   and SHOULD terminate the connection (with a bad certificate error).
   Automated clients MAY provide a configuration setting that disables
   this check, but MUST provide a setting which enables it.

   Note that in many cases the URI itself comes from an untrusted
   source. The above-described check provides no protection against
   attacks where this source is compromised. For example, if the URI was
   obtained by clicking on an HTML page which was itself obtained with-
   out using HTTP/TLS, a man in the middle could have replaced the URI.
   In order to prevent this form of attack, users should carefully exam-
   ine the certificate presented by the server to determine if it meets
   their expectations.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Client Identity</span>

   Typically, the server has no external knowledge of what the client's
   identity ought to be and so checks (other than that the client has a
   certificate chain rooted in an appropriate CA) are not possible. If a
   server has such knowledge (typically from some source external to
   HTTP or TLS) it SHOULD check the identity as described above.

<span class="grey">Rescorla                                                         [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

References
   [PKIX]   Housley, R., Ford, W., Polk, W. and D. Solo, "Internet
      Public Key Infrastructure: Part I: X.509 Certificate and CRL
      Profile", <a href="./rfc2459">RFC 2459</a>, January 1999.

   [<a name="ref-RFC-2616" id="ref-RFC-2616">RFC-2616</a>] Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
      Masinter, L., Leach, P. and T. Berners-Lee, "Hypertext
      Transfer Protocol, HTTP/1.1" <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>] Bradner, S., "Key Words for use in RFCs to indicate
      Requirement Levels", <a href="./rfc2119">RFC2119</a>, March 1997.

   [<a name="ref-TLS" id="ref-TLS">TLS</a>] Dierks, T., Allen, C., "The TLS Protocol", <a href="./rfc2246">RFC2246</a>, January 1999.

Security Considerations

   This entire document is about security.

Author's Address

Eric Rescorla &lt;ekr@rtfm.com&gt;
RTFM, Inc.
<span class="h2"><a class="selflink" name="section-30" href="#section-30">30</a> Newell Road, #16</span>
East Palo Alto, CA 94303
Phone: (650) 328-8631

<span class="grey">Rescorla                                                         [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'>
<span class="grey">Internet-Draft                HTTP Over TLS</span>

                           Table of Contents

<a href="#section-1">1</a>. Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-1">1</a>
<a href="#section-1.1">1.1</a>. Discussion of this Draft  . . . . . . . . . . . . . . . . . . .   <a href="#page-1">1</a>
<a href="#section-1.2">1.2</a>. Requirements Terminology  . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
<a href="#section-2">2</a>. HTTP Over TLS . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
<a href="#section-2.1">2.1</a>. Connection Initiation . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
<a href="#section-2.2">2.2</a>. Connection Closure  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-2">2</a>
<a href="#section-2.2.1">2.2.1</a>. Client Behavior . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
<a href="#section-2.2.2">2.2.2</a>. Server Behavior . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-3">3</a>
<a href="#section-2.3">2.3</a>. Port Number . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
<a href="#section-2.4">2.4</a>. URI Format  . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
<a href="#section-3">3</a>. Endpoint Identification . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
<a href="#section-3.1">3.1</a>. Server Identity . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-4">4</a>
<a href="#section-3.2">3.2</a>. Client Identity . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-5">5</a>
References . . . . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
Security Considerations  . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>
Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . .   <a href="#page-6">6</a>

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
