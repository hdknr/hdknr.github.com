<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Relation.Replaces" content="draft-lodderstedt-oauth-revocation" />
<meta name="DC.Identifier" content="urn:ietf:id:ietf-oauth-revocation" />
<meta name="DC.Date.Issued" content="2012-05-27" />
<meta name="DC.Creator" content="Scurtescu, Marius" />
<meta name="DC.Creator" content="Dronia, Stefanie" />
<meta name="DC.Creator" content="Lodderstedt, Torsten" />
<meta name="DC.Description.Abstract" content="This draft proposes an additional endpoint for OAuth authorization" />
<meta name="DC.Title" content="Token Revocation" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-oauth-revocation-00 - Token Revocation</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-ietf-oauth-revocation-00.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-oauth-revocation-00.txt" title="PDF version of this document">pdf</a>|<a href="/id/draft-ietf-oauth-revocation-00.xml" title="XML source for this document">xml</a>|<a href="/id/draft-ietf-oauth-revocation-00.html" title="HTML version of this document, from XML2RFC">html</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-oauth-revocation' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/oauth" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-revocation@tools.ietf.org?subject=draft-ietf-oauth-revocation%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-revocation-00.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-ietf-oauth-revocation-00.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-ietf-oauth-revocation-00.txt" title="Run an idnits check of this document">Nits</a>] </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: (<a href="./draft-lodderstedt-oauth-revocation" title="Precursor">draft-lodderstedt-oauth-revocation</a>)                          
          <a href="./draft-ietf-oauth-revocation-00">00</a>                                                            </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Web Authentication Protocol                          T. Lodderstedt, Ed.
Internet-Draft                                       Deutsche Telekom AG
Intended status: Standards Track                               S. Dronia
Expires: November 27, 2012
                                                           M. Scurtescu
                                                                  Google
                                                            May 26, 2012


                            <span class="h1">Token Revocation</span>
                     <span class="h1">draft-ietf-oauth-revocation-00</span>

Abstract

   This draft proposes an additional endpoint for OAuth authorization
   servers for revoking tokens.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 27, 2012.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of



<span class="grey">Lodderstedt, et al.     Expires November 27, 2012               [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft              Token Revocation                    May 2012</span>


   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Token Revocation  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  JSONP Support . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
   <a href="#section-3">3</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
   <a href="#section-4">4</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
   <a href="#section-6">6</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>
     <a href="#section-6.1">6.1</a>.  Normative References  . . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>
     <a href="#section-6.2">6.2</a>.  Informative References  . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>































<span class="grey">Lodderstedt, et al.     Expires November 27, 2012               [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft              Token Revocation                    May 2012</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   The OAuth 2.0 core specification [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>] defines several
   ways for a client to obtain refresh and access tokens.  This
   specification supplements the core specification with a mechanism to
   revoke both types of tokens and facilitates the following use cases:

   o  The end-user triggers revocation from within the client that sends
      the appropriate revocation request to the autorization server.
      From the end-user's perspective, this looks like a "logout" or
      "reset" function.  The request causes the removal of the client
      permissions associated with the particular token to access the
      end-user's protected resources.  This use case makes it even more
      comfortable to the end-user to revoke his access grant immediately
      via the client.

   o  In contrast to revocation by a client, the authorization server
      (or a related entity) may offer its end-users a self-care portal
      to delete access grants given to clients independent of any token
      storing devices.  Such a portal offers the possibility to an end-
      user to look at and revoke all access grants he once authorized.
      In cases the token storing device is not available, e.g. it is
      lost or stolen, revocation by a self-care portal is the only
      possibility to limit or avoid abuse.

   In the end, security, usability, and ease of use are increased by
   token revocation.

   By using an additional endpoint, the token revocation endpoint,
   clients can request the revocation of a particular token.  Compliant
   implementation MUST support the revocation of refresh tokens, access
   token revocation MAY be supported.


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Token Revocation</span>

   The client requests the revocation of a particular token by making an
   HTTP POST request to the token revocation endpoint.  The location of
   the token revocation endpoint can be found in the authorization
   servers documentation.  The token endpoint URI MAY include a query
   component.

   Since requests to the token revocation endpoint result in the
   transmission of plain text credentials in the HTTP request, the
   authorization server MUST require the use of a transport-layer
   security mechanism when sending requests to the token revocation
   endpoints.  The authorization server MUST support TLS 1.0
   ([<a href="./rfc2246" title="&quot;The TLS Protocol Version 1.0&quot;">RFC2246</a>]), SHOULD support TLS 1.2 ([<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>]) and its future



<span class="grey">Lodderstedt, et al.     Expires November 27, 2012               [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft              Token Revocation                    May 2012</span>


   replacements, and MAY support additional transport-layer mechanisms
   meeting its security requirements.

   The client constructs the request by including the following
   parameters using the "application/x-www-form-urlencoded" format in
   the HTTP request entity-body:

   token   REQUIRED.  The token that the client wants to get revoked.
           Note: the authorization server is supposed to detect the
           token type automatically.

   The client also includes its authentication credentials as described
   in <a href="#section-2.3">Section 2.3</a>. of [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>].

   For example, a client may request the revocation of a refresh token
   with the following request (line breaks are for display purposes
   only):

        POST /revoke HTTP/1.1
        Host: server.example.com
        Content-Type: application/x-www-form-urlencoded
        Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW

        token=45ghiukldjahdnhzdauz&amp;

   The authorization server first validates the client credentials (if
   present) and verifies whether the client is authorized to revoke the
   particular token based on the client identity and its policy.  For
   example, only the client the token has been issued for might be
   allowed to revoke it.  It is also conceivable to allow a dedicated
   user self-care portal to revoke all kinds of tokens.

   In the next step, the authorization server invalidates the token.
   Whether the revocation takes effect instantly or with some delay
   depends on the architecture of the particular deployment.  The client
   MUST NOT make any assumptions about the timing and MUST NOT use the
   token again.

   If the processed token is a refresh token and the authorization
   server supports the revocation of access tokens, then the
   authorization server SHOULD also invalidate all access tokens issued
   for that refresh token.

   The authorization server indicates a successful processing of the
   request by a HTTP status code 200.  Status code 401 indicates a
   failed client authentication, whereas a status code 403 is used if
   the client is not authorized to revoke the particular token.  For all
   other error conditions, a status code 400 is used along with an error



<span class="grey">Lodderstedt, et al.     Expires November 27, 2012               [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft              Token Revocation                    May 2012</span>


   response as defined in <a href="#section-5.2">section 5.2</a>. of [<a href="#ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>].  The
   following error codes are defined for the token revocation endpoint:

   unsupported_token_type  The authorization server does not support the
           revocation of the presented token type.  I.e. the client
           tried to revoke an access token on a server not supporting
           this feature.

   invalid_token  The presented token is invalid.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  JSONP Support</span>

   The revocation endpoint MAY support JSONP [<a href="#ref-jsonp" title="&quot;Remote JSON - JSONP&quot;">jsonp</a>] by allowing GET
   requests with an additional parameter:

   callback  The qualified name of a JavaScript function.

   Example request:

   https://example.com/revoke?token=45ghiukldjahdnhzdauz&amp;
   callback=package.myCallback

   Successful response:

   package.myCallback();

   Error response:

   package.myCallback({"error":"invalid_token"});


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Acknowledgements</span>

   We would like to thank Sebastian Ebling, Christian Stuebner, Brian
   Campbell, Igor Faynberg, Lukas Rosenstock, and Justin P. Richer for
   their valuable feedback.


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  IANA Considerations</span>

   This draft includes no request to IANA.


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Security Considerations</span>

   All relevant security considerations have been given in the
   functional specification.




<span class="grey">Lodderstedt, et al.     Expires November 27, 2012               [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft              Token Revocation                    May 2012</span>


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a name="ref-I-D.ietf-oauth-v2" id="ref-I-D.ietf-oauth-v2">I-D.ietf-oauth-v2</a>]
              Hammer-Lahav, E., Recordon, D., and D. Hardt, "The OAuth
              2.0 Authorization Framework", <a href="./draft-ietf-oauth-v2-26">draft-ietf-oauth-v2-26</a> (work
              in progress), May 2012.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2246" id="ref-RFC2246">RFC2246</a>]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              <a href="./rfc2246">RFC 2246</a>, January 1999.

   [<a name="ref-RFC5246" id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>, August 2008.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a name="ref-jsonp" id="ref-jsonp">jsonp</a>]    Ippolito, B., "Remote JSON - JSONP", December 2005.


Authors' Addresses

   Torsten Lodderstedt (editor)
   Deutsche Telekom AG

   Email: torsten@lodderstedt.net


   Stefanie Dronia

   Email: sdronia@gmx.de


   Marius Scurtescu
   Google

   Email: mscurtescu@google.com











Lodderstedt, et al.     Expires November 27, 2012               [Page 6]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
