<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:ietf-oauth-v2" />
<meta name="DC.Description.Abstract" content="The OAuth 2.0 authorization framework enables a third-party\napplication to obtain limited access to an HTTP service, either on\nbehalf of a resource owner by orchestrating an approval interaction\nbetween the resource owner and the HTTP service, or by allowing the\nthird-party application to obtain access on its own behalf. This\nspecification replaces and obsoletes the OAuth 1.0 protocol described\nin RFC 5849." />
<meta name="DC.Creator" content="Recordon, David" />
<meta name="DC.Creator" content="Hardt, Dick" />
<meta name="DC.Date.Issued" content="2012-07-15" />
<meta name="DC.Title" content="The OAuth 2.0 Authorization Framework" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-oauth-v2-28 - The OAuth 2.0 Authorization Framework</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-ietf-oauth-v2-28.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-oauth-v2-28.txt" title="PDF version of this document">pdf</a>|<a href="/id/draft-ietf-oauth-v2-28.xml" title="XML source for this document">xml</a>|<a href="/id/draft-ietf-oauth-v2-28.html" title="HTML version of this document, from XML2RFC">html</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-oauth-v2' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/oauth" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-v2@tools.ietf.org?subject=draft-ietf-oauth-v2%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-oauth-v2-28.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-ietf-oauth-v2-28.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-ietf-oauth-v2-28.txt" title="Run an idnits check of this document">Nits</a>] </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-ietf-oauth-v2-00">00</a> <a href="./draft-ietf-oauth-v2-01">01</a> <a href="./draft-ietf-oauth-v2-02">02</a> <a href="./draft-ietf-oauth-v2-03">03</a> <a href="./draft-ietf-oauth-v2-04">04</a> <a href="./draft-ietf-oauth-v2-05">05</a> <a href="./draft-ietf-oauth-v2-06">06</a> <a href="./draft-ietf-oauth-v2-07">07</a> <a href="./draft-ietf-oauth-v2-08">08</a> <a href="./draft-ietf-oauth-v2-09">09</a> <a href="./draft-ietf-oauth-v2-10">10</a> <a href="./draft-ietf-oauth-v2-11">11</a>                           
          <a href="./draft-ietf-oauth-v2-12">12</a> <a href="./draft-ietf-oauth-v2-13">13</a> <a href="./draft-ietf-oauth-v2-14">14</a> <a href="./draft-ietf-oauth-v2-15">15</a> <a href="./draft-ietf-oauth-v2-16">16</a> <a href="./draft-ietf-oauth-v2-17">17</a> <a href="./draft-ietf-oauth-v2-18">18</a> <a href="./draft-ietf-oauth-v2-19">19</a> <a href="./draft-ietf-oauth-v2-20">20</a> <a href="./draft-ietf-oauth-v2-21">21</a> <a href="./draft-ietf-oauth-v2-22">22</a> <a href="./draft-ietf-oauth-v2-23">23</a>                           
          <a href="./draft-ietf-oauth-v2-24">24</a> <a href="./draft-ietf-oauth-v2-25">25</a> <a href="./draft-ietf-oauth-v2-26">26</a> <a href="./draft-ietf-oauth-v2-27">27</a> <a href="./draft-ietf-oauth-v2-28">28</a> <a href="./draft-ietf-oauth-v2-29">29</a> <a href="./draft-ietf-oauth-v2-30">30</a>                                          </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
OAuth Working Group                                       E. Hammer, Ed.
Internet-Draft
Obsoletes: <a href="./rfc5849">5849</a> (if approved)                                D. Recordon
Intended status: Standards Track                                Facebook
Expires: December 21, 2012                                      D. Hardt
                                                               Microsoft
                                                           June 19, 2012


                 <span class="h1">The OAuth 2.0 Authorization Framework</span>
                         <span class="h1">draft-ietf-oauth-v2-28</span>

Abstract

   The OAuth 2.0 authorization framework enables a third-party
   application to obtain limited access to an HTTP service, either on
   behalf of a resource owner by orchestrating an approval interaction
   between the resource owner and the HTTP service, or by allowing the
   third-party application to obtain access on its own behalf.  This
   specification replaces and obsoletes the OAuth 1.0 protocol described
   in <a href="./rfc5849">RFC 5849</a>.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on December 21, 2012.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-1.1">1.1</a>.   Roles . . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-1.2">1.2</a>.   Protocol Flow . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-1.3">1.3</a>.   Authorization Grant . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-1.3.1">1.3.1</a>.  Authorization Code . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-1.3.2">1.3.2</a>.  Implicit . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
       <a href="#section-1.3.3">1.3.3</a>.  Resource Owner Password Credentials  . . . . . . . . .  <a href="#page-9">9</a>
       <a href="#section-1.3.4">1.3.4</a>.  Client Credentials . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-1.4">1.4</a>.   Access Token  . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-1.5">1.5</a>.   Refresh Token . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-1.6">1.6</a>.   TLS Version . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-1.7">1.7</a>.   HTTP Redirections . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-1.8">1.8</a>.   Interoperability  . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-1.9">1.9</a>.   Notational Conventions  . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-2">2</a>.  Client Registration  . . . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-2.1">2.1</a>.   Client Types  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-2.2">2.2</a>.   Client Identifier . . . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
     <a href="#section-2.3">2.3</a>.   Client Authentication . . . . . . . . . . . . . . . . . . <a href="#page-15">15</a>
       <a href="#section-2.3.1">2.3.1</a>.  Client Password  . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
       <a href="#section-2.3.2">2.3.2</a>.  Other Authentication Methods . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-2.4">2.4</a>.   Unregistered Clients  . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
   <a href="#section-3">3</a>.  Protocol Endpoints . . . . . . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#section-3.1">3.1</a>.   Authorization Endpoint  . . . . . . . . . . . . . . . . . <a href="#page-17">17</a>
       <a href="#section-3.1.1">3.1.1</a>.  Response Type  . . . . . . . . . . . . . . . . . . . . <a href="#page-18">18</a>
       <a href="#section-3.1.2">3.1.2</a>.  Redirection Endpoint . . . . . . . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#section-3.2">3.2</a>.   Token Endpoint  . . . . . . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
       <a href="#section-3.2.1">3.2.1</a>.  Client Authentication  . . . . . . . . . . . . . . . . <a href="#page-21">21</a>
     <a href="#section-3.3">3.3</a>.   Access Token Scope  . . . . . . . . . . . . . . . . . . . <a href="#page-22">22</a>
   <a href="#section-4">4</a>.  Obtaining Authorization  . . . . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
     <a href="#section-4.1">4.1</a>.   Authorization Code Grant  . . . . . . . . . . . . . . . . <a href="#page-23">23</a>
       <a href="#section-4.1.1">4.1.1</a>.  Authorization Request  . . . . . . . . . . . . . . . . <a href="#page-24">24</a>
       <a href="#section-4.1.2">4.1.2</a>.  Authorization Response . . . . . . . . . . . . . . . . <a href="#page-25">25</a>
       <a href="#section-4.1.3">4.1.3</a>.  Access Token Request . . . . . . . . . . . . . . . . . <a href="#page-27">27</a>
       <a href="#section-4.1.4">4.1.4</a>.  Access Token Response  . . . . . . . . . . . . . . . . <a href="#page-28">28</a>
     <a href="#section-4.2">4.2</a>.   Implicit Grant  . . . . . . . . . . . . . . . . . . . . . <a href="#page-29">29</a>
       <a href="#section-4.2.1">4.2.1</a>.  Authorization Request  . . . . . . . . . . . . . . . . <a href="#page-31">31</a>
       <a href="#section-4.2.2">4.2.2</a>.  Access Token Response  . . . . . . . . . . . . . . . . <a href="#page-32">32</a>
     <a href="#section-4.3">4.3</a>.   Resource Owner Password Credentials Grant . . . . . . . . <a href="#page-35">35</a>
       <a href="#section-4.3.1">4.3.1</a>.  Authorization Request and Response . . . . . . . . . . <a href="#page-36">36</a>



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


       <a href="#section-4.3.2">4.3.2</a>.  Access Token Request . . . . . . . . . . . . . . . . . <a href="#page-36">36</a>
       <a href="#section-4.3.3">4.3.3</a>.  Access Token Response  . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
     <a href="#section-4.4">4.4</a>.   Client Credentials Grant  . . . . . . . . . . . . . . . . <a href="#page-37">37</a>
       <a href="#section-4.4.1">4.4.1</a>.  Authorization Request and Response . . . . . . . . . . <a href="#page-38">38</a>
       <a href="#section-4.4.2">4.4.2</a>.  Access Token Request . . . . . . . . . . . . . . . . . <a href="#page-38">38</a>
       <a href="#section-4.4.3">4.4.3</a>.  Access Token Response  . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
     <a href="#section-4.5">4.5</a>.   Extension Grants  . . . . . . . . . . . . . . . . . . . . <a href="#page-39">39</a>
   <a href="#section-5">5</a>.  Issuing an Access Token  . . . . . . . . . . . . . . . . . . . <a href="#page-40">40</a>
     <a href="#section-5.1">5.1</a>.   Successful Response . . . . . . . . . . . . . . . . . . . <a href="#page-40">40</a>
     <a href="#section-5.2">5.2</a>.   Error Response  . . . . . . . . . . . . . . . . . . . . . <a href="#page-41">41</a>
   <a href="#section-6">6</a>.  Refreshing an Access Token . . . . . . . . . . . . . . . . . . <a href="#page-43">43</a>
   <a href="#section-7">7</a>.  Accessing Protected Resources  . . . . . . . . . . . . . . . . <a href="#page-44">44</a>
     <a href="#section-7.1">7.1</a>.   Access Token Types  . . . . . . . . . . . . . . . . . . . <a href="#page-45">45</a>
     <a href="#section-7.2">7.2</a>.   Error Response  . . . . . . . . . . . . . . . . . . . . . <a href="#page-46">46</a>
   <a href="#section-8">8</a>.  Extensibility  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-46">46</a>
     <a href="#section-8.1">8.1</a>.   Defining Access Token Types . . . . . . . . . . . . . . . <a href="#page-46">46</a>
     <a href="#section-8.2">8.2</a>.   Defining New Endpoint Parameters  . . . . . . . . . . . . <a href="#page-47">47</a>
     <a href="#section-8.3">8.3</a>.   Defining New Authorization Grant Types  . . . . . . . . . <a href="#page-47">47</a>
     <a href="#section-8.4">8.4</a>.   Defining New Authorization Endpoint Response Types  . . . <a href="#page-47">47</a>
     <a href="#section-8.5">8.5</a>.   Defining Additional Error Codes . . . . . . . . . . . . . <a href="#page-48">48</a>
   <a href="#section-9">9</a>.  Native Applications  . . . . . . . . . . . . . . . . . . . . . <a href="#page-48">48</a>
   <a href="#section-10">10</a>. Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-49">49</a>
     <a href="#section-10.1">10.1</a>.  Client Authentication . . . . . . . . . . . . . . . . . . <a href="#page-50">50</a>
     <a href="#section-10.2">10.2</a>.  Client Impersonation  . . . . . . . . . . . . . . . . . . <a href="#page-50">50</a>
     <a href="#section-10.3">10.3</a>.  Access Tokens . . . . . . . . . . . . . . . . . . . . . . <a href="#page-51">51</a>
     <a href="#section-10.4">10.4</a>.  Refresh Tokens  . . . . . . . . . . . . . . . . . . . . . <a href="#page-51">51</a>
     <a href="#section-10.5">10.5</a>.  Authorization Codes . . . . . . . . . . . . . . . . . . . <a href="#page-52">52</a>
     <a href="#section-10.6">10.6</a>.  Authorization Code Redirection URI Manipulation . . . . . <a href="#page-53">53</a>
     <a href="#section-10.7">10.7</a>.  Resource Owner Password Credentials . . . . . . . . . . . <a href="#page-53">53</a>
     <a href="#section-10.8">10.8</a>.  Request Confidentiality . . . . . . . . . . . . . . . . . <a href="#page-54">54</a>
     <a href="#section-10.9">10.9</a>.  Endpoints Authenticity  . . . . . . . . . . . . . . . . . <a href="#page-54">54</a>
     <a href="#section-10.10">10.10</a>. Credentials Guessing Attacks  . . . . . . . . . . . . . . <a href="#page-54">54</a>
     <a href="#section-10.11">10.11</a>. Phishing Attacks  . . . . . . . . . . . . . . . . . . . . <a href="#page-54">54</a>
     <a href="#section-10.12">10.12</a>. Cross-Site Request Forgery  . . . . . . . . . . . . . . . <a href="#page-55">55</a>
     <a href="#section-10.13">10.13</a>. Clickjacking  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-56">56</a>
     <a href="#section-10.14">10.14</a>. Code Injection and Input Validation . . . . . . . . . . . <a href="#page-56">56</a>
     <a href="#section-10.15">10.15</a>. Open Redirectors  . . . . . . . . . . . . . . . . . . . . <a href="#page-57">57</a>
   <a href="#section-11">11</a>. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-57">57</a>
     <a href="#section-11.1">11.1</a>.  The OAuth Access Token Type Registry  . . . . . . . . . . <a href="#page-57">57</a>
       <a href="#section-11.1.1">11.1.1</a>. Registration Template  . . . . . . . . . . . . . . . . <a href="#page-58">58</a>
     <a href="#section-11.2">11.2</a>.  The OAuth Parameters Registry . . . . . . . . . . . . . . <a href="#page-58">58</a>
       <a href="#section-11.2.1">11.2.1</a>. Registration Template  . . . . . . . . . . . . . . . . <a href="#page-59">59</a>
       <a href="#section-11.2.2">11.2.2</a>. Initial Registry Contents  . . . . . . . . . . . . . . <a href="#page-59">59</a>
     11.3.  The OAuth Authorization Endpoint Response Type
            Registry  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-61">61</a>
       <a href="#section-11.3.1">11.3.1</a>. Registration Template  . . . . . . . . . . . . . . . . <a href="#page-61">61</a>
       <a href="#section-11.3.2">11.3.2</a>. Initial Registry Contents  . . . . . . . . . . . . . . <a href="#page-62">62</a>
     <a href="#section-11.4">11.4</a>.  The OAuth Extensions Error Registry . . . . . . . . . . . <a href="#page-62">62</a>



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


       <a href="#section-11.4.1">11.4.1</a>. Registration Template  . . . . . . . . . . . . . . . . <a href="#page-63">63</a>
   <a href="#section-12">12</a>. References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-63">63</a>
     <a href="#section-12.1">12.1</a>.  Normative References  . . . . . . . . . . . . . . . . . . <a href="#page-63">63</a>
     <a href="#section-12.2">12.2</a>.  Informative References  . . . . . . . . . . . . . . . . . <a href="#page-64">64</a>
   <a href="#appendix-A">Appendix A</a>.  Augmented Backus-Naur Form (ABNF) Syntax  . . . . . . <a href="#page-65">65</a>
     <a href="#appendix-A.1">A.1</a>.   "client_id" Syntax  . . . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.2">A.2</a>.   "client_secret" Syntax  . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.3">A.3</a>.   "response_type" Syntax  . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.4">A.4</a>.   "scope" Syntax  . . . . . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.5">A.5</a>.   "state" Syntax  . . . . . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.6">A.6</a>.   "redirect_uri" Syntax . . . . . . . . . . . . . . . . . . <a href="#page-66">66</a>
     <a href="#appendix-A.7">A.7</a>.   "error" Syntax  . . . . . . . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.8">A.8</a>.   "error_description" Syntax  . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.9">A.9</a>.   "error_uri" Syntax  . . . . . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.10">A.10</a>.  "grant_type" Syntax . . . . . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.11">A.11</a>.  "code" Syntax . . . . . . . . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.12">A.12</a>.  "access_token" Syntax . . . . . . . . . . . . . . . . . . <a href="#page-67">67</a>
     <a href="#appendix-A.13">A.13</a>.  "token_type" Syntax . . . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
     <a href="#appendix-A.14">A.14</a>.  "expires_in" Syntax . . . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
     <a href="#appendix-A.15">A.15</a>.  "username" Syntax . . . . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
     <a href="#appendix-A.16">A.16</a>.  "password" Syntax . . . . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
     <a href="#appendix-A.17">A.17</a>.  "refresh_token" Syntax  . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
     <a href="#appendix-A.18">A.18</a>.  Endpoint Parameter Syntax . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
   <a href="#appendix-B">Appendix B</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . <a href="#page-68">68</a>
   <a href="#appendix-C">Appendix C</a>.  Editor's Notes  . . . . . . . . . . . . . . . . . . . <a href="#page-69">69</a>
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-70">70</a>

























<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   In the traditional client-server authentication model, the client
   requests an access restricted resource (protected resource) on the
   server by authenticating with the server using the resource owner's
   credentials.  In order to provide third-party applications access to
   restricted resources, the resource owner shares its credentials with
   the third-party.  This creates several problems and limitations:

   o  Third-party applications are required to store the resource
      owner's credentials for future use, typically a password in clear-
      text.
   o  Servers are required to support password authentication, despite
      the security weaknesses inherent in passwords.
   o  Third-party applications gain overly broad access to the resource
      owner's protected resources, leaving resource owners without any
      ability to restrict duration or access to a limited subset of
      resources.
   o  Resource owners cannot revoke access to an individual third-party
      without revoking access to all third-parties, and must do so by
      changing their password.
   o  Compromise of any third-party application results in compromise of
      the end-user's password and all of the data protected by that
      password.

   OAuth addresses these issues by introducing an authorization layer
   and separating the role of the client from that of the resource
   owner.  In OAuth, the client requests access to resources controlled
   by the resource owner and hosted by the resource server, and is
   issued a different set of credentials than those of the resource
   owner.

   Instead of using the resource owner's credentials to access protected
   resources, the client obtains an access token - a string denoting a
   specific scope, lifetime, and other access attributes.  Access tokens
   are issued to third-party clients by an authorization server with the
   approval of the resource owner.  The client uses the access token to
   access the protected resources hosted by the resource server.

   For example, an end-user (resource owner) can grant a printing
   service (client) access to her protected photos stored at a photo
   sharing service (resource server), without sharing her username and
   password with the printing service.  Instead, she authenticates
   directly with a server trusted by the photo sharing service
   (authorization server) which issues the printing service delegation-
   specific credentials (access token).

   This specification is designed for use with HTTP ([<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>]).  The



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   use of OAuth over any other protocol than HTTP is out of scope.

   The OAuth 1.0 protocol ([<a href="./rfc5849" title="&quot;The OAuth 1.0 Protocol&quot;">RFC5849</a>]), published as an informational
   document, was the result of a small ad-hoc community effort.  This
   standards-track specification builds on the OAuth 1.0 deployment
   experience, as well as additional use cases and extensibility
   requirements gathered from the wider IETF community.  The OAuth 2.0
   protocol is not backward compatible with OAuth 1.0.  The two versions
   may co-exist on the network and implementations may choose to support
   both.  However, it is the intention of this specification that new
   implementation support OAuth 2.0 as specified in this document, and
   that OAuth 1.0 is used only to support existing deployments.  The
   OAuth 2.0 protocol shares very few implementation details with the
   OAuth 1.0 protocol.  Implementers familiar with OAuth 1.0 should
   approach this document without any assumptions as to its structure
   and details.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Roles</span>

   OAuth defines four roles:

   resource owner
      An entity capable of granting access to a protected resource.
      When the resource owner is a person, it is referred to as an end-
      user.
   resource server
      The server hosting the protected resources, capable of accepting
      and responding to protected resource requests using access tokens.
   client
      An application making protected resource requests on behalf of the
      resource owner and with its authorization.  The term client does
      not imply any particular implementation characteristics (e.g.
      whether the application executes on a server, a desktop, or other
      devices).
   authorization server
      The server issuing access tokens to the client after successfully
      authenticating the resource owner and obtaining authorization.

   The interaction between the authorization server and resource server
   is beyond the scope of this specification.  The authorization server
   may be the same server as the resource server or a separate entity.
   A single authorization server may issue access tokens accepted by
   multiple resource servers.








<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Protocol Flow</span>


     +--------+                               +---------------+
     |        |--(A)- Authorization Request -&gt;|   Resource    |
     |        |                               |     Owner     |
     |        |&lt;-(B)-- Authorization Grant ---|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(C)-- Authorization Grant --&gt;| Authorization |
     | Client |                               |     Server    |
     |        |&lt;-(D)----- Access Token -------|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(E)----- Access Token ------&gt;|    Resource   |
     |        |                               |     Server    |
     |        |&lt;-(F)--- Protected Resource ---|               |
     +--------+                               +---------------+


                     Figure 1: Abstract Protocol Flow

   The abstract flow illustrated in Figure 1 describes the interaction
   between the four roles and includes the following steps:

   (A)  The client requests authorization from the resource owner.  The
        authorization request can be made directly to the resource owner
        (as shown), or preferably indirectly via the authorization
        server as an intermediary.
   (B)  The client receives an authorization grant which is a credential
        representing the resource owner's authorization, expressed using
        one of four grant types defined in this specification or using
        an extension grant type.  The authorization grant type depends
        on the method used by the client to request authorization and
        the types supported by the authorization server.
   (C)  The client requests an access token by authenticating with the
        authorization server and presenting the authorization grant.
   (D)  The authorization server authenticates the client and validates
        the authorization grant, and if valid issues an access token.
   (E)  The client requests the protected resource from the resource
        server and authenticates by presenting the access token.
   (F)  The resource server validates the access token, and if valid,
        serves the request.

   The preferred method for the client to obtain an authorization grant
   from the resource owner (depicted in steps (A) and (B)) is to use the



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   authorization server as an intermediary which is illustrated in
   Figure 3.

<span class="h3"><a class="selflink" name="section-1.3" href="#section-1.3">1.3</a>.  Authorization Grant</span>

   An authorization grant is a credential representing the resource
   owner's authorization (to access its protected resources) used by the
   client to obtain an access token.  This specification defines four
   grant types: authorization code, implicit, resource owner password
   credentials, and client credentials, as well as an extensibility
   mechanism for defining additional types.

<span class="h4"><a class="selflink" name="section-1.3.1" href="#section-1.3.1">1.3.1</a>.  Authorization Code</span>

   The authorization code is obtained by using an authorization server
   as an intermediary between the client and resource owner.  Instead of
   requesting authorization directly from the resource owner, the client
   directs the resource owner to an authorization server (via its user-
   agent as defined in [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>]), which in turn directs the resource
   owner back to the client with the authorization code.

   Before directing the resource owner back to the client with the
   authorization code, the authorization server authenticates the
   resource owner and obtains authorization.  Because the resource owner
   only authenticates with the authorization server, the resource
   owner's credentials are never shared with the client.

   The authorization code provides a few important security benefits
   such as the ability to authenticate the client, and the transmission
   of the access token directly to the client without passing it through
   the resource owner's user-agent, potentially exposing it to others,
   including the resource owner.

<span class="h4"><a class="selflink" name="section-1.3.2" href="#section-1.3.2">1.3.2</a>.  Implicit</span>

   The implicit grant is a simplified authorization code flow optimized
   for clients implemented in a browser using a scripting language such
   as JavaScript.  In the implicit flow, instead of issuing the client
   an authorization code, the client is issued an access token directly
   (as the result of the resource owner authorization).  The grant type
   is implicit as no intermediate credentials (such as an authorization
   code) are issued (and later used to obtain an access token).

   When issuing an access token during the implicit grant flow, the
   authorization server does not authenticate the client.  In some
   cases, the client identity can be verified via the redirection URI
   used to deliver the access token to the client.  The access token may
   be exposed to the resource owner or other applications with access to



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   the resource owner's user-agent.

   Implicit grants improve the responsiveness and efficiency of some
   clients (such as a client implemented as an in-browser application)
   since it reduces the number of round trips required to obtain an
   access token.  However, this convenience should be weighed against
   the security implications of using implicit grants, especially when
   the authorization code grant type is available.

<span class="h4"><a class="selflink" name="section-1.3.3" href="#section-1.3.3">1.3.3</a>.  Resource Owner Password Credentials</span>

   The resource owner password credentials (i.e. username and password)
   can be used directly as an authorization grant to obtain an access
   token.  The credentials should only be used when there is a high
   degree of trust between the resource owner and the client (e.g. the
   client is part of the device operating system or a highly privileged
   application), and when other authorization grant types are not
   available (such as an authorization code).

   Even though this grant type requires direct client access to the
   resource owner credentials, the resource owner credentials are used
   for a single request and are exchanged for an access token.  This
   grant type can eliminate the need for the client to store the
   resource owner credentials for future use, by exchanging the
   credentials with a long-lived access token or refresh token.

<span class="h4"><a class="selflink" name="section-1.3.4" href="#section-1.3.4">1.3.4</a>.  Client Credentials</span>

   The client credentials (or other forms of client authentication) can
   be used as an authorization grant when the authorization scope is
   limited to the protected resources under the control of the client,
   or to protected resources previously arranged with the authorization
   server.  Client credentials are used as an authorization grant
   typically when the client is acting on its own behalf (the client is
   also the resource owner), or is requesting access to protected
   resources based on an authorization previously arranged with the
   authorization server.

<span class="h3"><a class="selflink" name="section-1.4" href="#section-1.4">1.4</a>.  Access Token</span>

   Access tokens are credentials used to access protected resources.  An
   access token is a string representing an authorization issued to the
   client.  The string is usually opaque to the client.  Tokens
   represent specific scopes and durations of access, granted by the
   resource owner, and enforced by the resource server and authorization
   server.

   The token may denote an identifier used to retrieve the authorization



<span class="grey">Hammer, et al.          Expires December 21, 2012               [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   information, or self-contain the authorization information in a
   verifiable manner (i.e. a token string consisting of some data and a
   signature).  Additional authentication credentials, which are beyond
   the scope of this specification, may be required in order for the
   client to use a token.

   The access token provides an abstraction layer, replacing different
   authorization constructs (e.g. username and password) with a single
   token understood by the resource server.  This abstraction enables
   issuing access tokens more restrictive than the authorization grant
   used to obtain them, as well as removing the resource server's need
   to understand a wide range of authentication methods.

   Access tokens can have different formats, structures, and methods of
   utilization (e.g. cryptographic properties) based on the resource
   server security requirements.  Access token attributes and the
   methods used to access protected resources are beyond the scope of
   this specification and are defined by companion specifications.

<span class="h3"><a class="selflink" name="section-1.5" href="#section-1.5">1.5</a>.  Refresh Token</span>

   Refresh tokens are credentials used to obtain access tokens.  Refresh
   tokens are issued to the client by the authorization server and are
   used to obtain a new access token when the current access token
   becomes invalid or expires, or to obtain additional access tokens
   with identical or narrower scope (access tokens may have a shorter
   lifetime and fewer permissions than authorized by the resource
   owner).  Issuing a refresh token is optional at the discretion of the
   authorization server.  If the authorization server issues a refresh
   token, it is included when issuing an access token (i.e. step (D) in
   Figure 1).

   A refresh token is a string representing the authorization granted to
   the client by the resource owner.  The string is usually opaque to
   the client.  The token denotes an identifier used to retrieve the
   authorization information.  Unlike access tokens, refresh tokens are
   intended for use only with authorization servers and are never sent
   to resource servers.













<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


  +--------+                                           +---------------+
  |        |--(A)------- Authorization Grant ---------&gt;|               |
  |        |                                           |               |
  |        |&lt;-(B)----------- Access Token -------------|               |
  |        |               &amp; Refresh Token             |               |
  |        |                                           |               |
  |        |                            +----------+   |               |
  |        |--(C)---- Access Token ----&gt;|          |   |               |
  |        |                            |          |   |               |
  |        |&lt;-(D)- Protected Resource --| Resource |   | Authorization |
  | Client |                            |  Server  |   |     Server    |
  |        |--(E)---- Access Token ----&gt;|          |   |               |
  |        |                            |          |   |               |
  |        |&lt;-(F)- Invalid Token Error -|          |   |               |
  |        |                            +----------+   |               |
  |        |                                           |               |
  |        |--(G)----------- Refresh Token -----------&gt;|               |
  |        |                                           |               |
  |        |&lt;-(H)----------- Access Token -------------|               |
  +--------+           &amp; Optional Refresh Token        +---------------+


               Figure 2: Refreshing an Expired Access Token

   The flow illustrated in Figure 2 includes the following steps:

   (A)  The client requests an access token by authenticating with the
        authorization server, and presenting an authorization grant.
   (B)  The authorization server authenticates the client and validates
        the authorization grant, and if valid issues an access token and
        a refresh token.
   (C)  The client makes a protected resource request to the resource
        server by presenting the access token.
   (D)  The resource server validates the access token, and if valid,
        serves the request.
   (E)  Steps (C) and (D) repeat until the access token expires.  If the
        client knows the access token expired, it skips to step (G),
        otherwise it makes another protected resource request.
   (F)  Since the access token is invalid, the resource server returns
        an invalid token error.
   (G)  The client requests a new access token by authenticating with
        the authorization server and presenting the refresh token.  The
        client authentication requirements are based on the client type
        and on the authorization server policies.







<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   (H)  The authorization server authenticates the client and validates
        the refresh token, and if valid issues a new access token (and
        optionally, a new refresh token).

   Steps C, D, E, and F are outside the scope of this specification as
   described in <a href="#section-7">Section 7</a>.

<span class="h3"><a class="selflink" name="section-1.6" href="#section-1.6">1.6</a>.  TLS Version</span>

   Whenever TLS is used by this specification, the appropriate version
   (or versions) of TLS will vary over time, based on the widespread
   deployment and known security vulnerabilities.  At the time of this
   writing, TLS version 1.2 [<a href="./rfc5246" title="&quot;The Transport Layer Security (TLS) Protocol Version 1.2&quot;">RFC5246</a>] is the most recent version, but
   has a very limited deployment base and might not be readily available
   for implementation.  TLS version 1.0 [<a href="./rfc2246" title="&quot;The TLS Protocol Version 1.0&quot;">RFC2246</a>] is the most widely
   deployed version, and will provide the broadest interoperability.

   Implementations MAY also support additional transport-layer security
   mechanisms that meet their security requirements.

<span class="h3"><a class="selflink" name="section-1.7" href="#section-1.7">1.7</a>.  HTTP Redirections</span>

   This specification makes extensive use of HTTP redirections, in which
   the client or the authorization server direct the resource owner's
   user-agent to another destination.  While the examples in this
   specification show the use of the HTTP 302 status code, any other
   method available via the user-agent to accomplish this redirection is
   allowed and is considered to be an implementation detail.

<span class="h3"><a class="selflink" name="section-1.8" href="#section-1.8">1.8</a>.  Interoperability</span>

   OAuth 2.0 provides a rich authorization framework with well-defined
   security properties.  However, as a rich and highly extensible
   framework with many optional components, on its own, this
   specification is likely to produce a wide range of non-interoperable
   implementations.

   In addition, this specification leaves a few required components
   partially or fully undefined (e.g. client registration, authorization
   server capabilities, endpoint discovery).  Without these components,
   clients must be manually and specifically configured against a
   specific authorization server and resource server in order to
   interoperate.

   This framework was designed with the clear expectation that future
   work will define prescriptive profiles and extensions necessary to
   achieve full web-scale interoperability.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-1.9" href="#section-1.9">1.9</a>.  Notational Conventions</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   specification are to be interpreted as described in [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   This specification uses the Augmented Backus-Naur Form (ABNF)
   notation of [<a href="./rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>].  Additionally, the rule URI-Reference is
   included from Uniform Resource Identifier (URI) [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>].

   Certain security-related terms are to be understood in the sense
   defined in [<a href="./rfc4949" title="&quot;Internet Security Glossary, Version 2&quot;">RFC4949</a>].  These terms include, but are not limited to,
   "attack", "authentication", "authorization", "certificate",
   "confidentiality", "credential", "encryption", "identity", "sign",
   "signature", "trust", "validate", and "verify".

   Unless otherwise noted, all the protocol parameter names and values
   are case sensitive.


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Client Registration</span>

   Before initiating the protocol, the client registers with the
   authorization server.  The means through which the client registers
   with the authorization server are beyond the scope of this
   specification, but typically involve end-user interaction with an
   HTML registration form.

   Client registration does not require a direct interaction between the
   client and the authorization server.  When supported by the
   authorization server, registration can rely on other means for
   establishing trust and obtaining the required client properties (e.g.
   redirection URI, client type).  For example, registration can be
   accomplished using a self-issued or third-party-issued assertion, or
   by the authorization server performing client discovery using a
   trusted channel.

   When registering a client, the client developer SHALL:

   o  specify the client type as described in <a href="#section-2.1">Section 2.1</a>,
   o  provide its client redirection URIs as described in <a href="#section-3.1.2">Section 3.1.2</a>,
      and
   o  include any other information required by the authorization server
      (e.g. application name, website, description, logo image, the
      acceptance of legal terms).






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Client Types</span>

   OAuth defines two client types, based on their ability to
   authenticate securely with the authorization server (i.e. ability to
   maintain the confidentiality of their client credentials):

   confidential
      Clients capable of maintaining the confidentiality of their
      credentials (e.g. client implemented on a secure server with
      restricted access to the client credentials), or capable of secure
      client authentication using other means.
   public
      Clients incapable of maintaining the confidentiality of their
      credentials (e.g. clients executing on the device used by the
      resource owner such as an installed native application or a web
      browser-based application), and incapable of secure client
      authentication via any other means.

   The client type designation is based on the authorization server's
   definition of secure authentication and its acceptable exposure
   levels of client credentials.  The authorization server SHOULD NOT
   make assumptions about the client type.

   A client may be implemented as a distributed set of components, each
   with a different client type and security context (e.g. a distributed
   client with both a confidential server-based component and a public
   browser-based component).  If the authorization server does not
   provide support for such clients, or does not provide guidance with
   regard to their registration, the client SHOULD register each
   component as a separate client.

   This specification has been designed around the following client
   profiles:

   web application
      A web application is a confidential client running on a web
      server.  Resource owners access the client via an HTML user
      interface rendered in a user-agent on the device used by the
      resource owner.  The client credentials as well as any access
      token issued to the client are stored on the web server and are
      not exposed to or accessible by the resource owner.
   user-agent-based application
      A user-agent-based application is a public client in which the
      client code is downloaded from a web server and executes within a
      user-agent (e.g. web browser) on the device used by the resource
      owner.  Protocol data and credentials are easily accessible (and
      often visible) to the resource owner.  Since such applications
      reside within the user-agent, they can make seamless use of the



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


      user-agent capabilities when requesting authorization.
   native application
      A native application is a public client installed and executed on
      the device used by the resource owner.  Protocol data and
      credentials are accessible to the resource owner.  It is assumed
      that any client authentication credentials included in the
      application can be extracted.  On the other hand, dynamically
      issued credentials such as access tokens or refresh tokens can
      receive an acceptable level of protection.  At a minimum, these
      credentials are protected from hostile servers with which the
      application may interact with.  On some platforms these
      credentials might be protected from other applications residing on
      the same device.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Client Identifier</span>

   The authorization server issues the registered client a client
   identifier - a unique string representing the registration
   information provided by the client.  The client identifier is not a
   secret; it is exposed to the resource owner, and MUST NOT be used
   alone for client authentication.  The client identifier is unique to
   the authorization server.

   The client identifier string size is left undefined by this
   specification.  The client should avoid making assumptions about the
   identifier size.  The authorization server SHOULD document the size
   of any identifier it issues.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Client Authentication</span>

   If the client type is confidential, the client and authorization
   server establish a client authentication method suitable for the
   security requirements of the authorization server.  The authorization
   server MAY accept any form of client authentication meeting its
   security requirements.

   Confidential clients are typically issued (or establish) a set of
   client credentials used for authenticating with the authorization
   server (e.g. password, public/private key pair).

   The authorization server MAY establish a client authentication method
   with public clients.  However, the authorization server MUST NOT rely
   on public client authentication for the purpose of identifying the
   client.

   The client MUST NOT use more than one authentication method in each
   request.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 15]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h4"><a class="selflink" name="section-2.3.1" href="#section-2.3.1">2.3.1</a>.  Client Password</span>

   Clients in possession of a client password MAY use the HTTP Basic
   authentication scheme as defined in [<a href="./rfc2617" title="and L. Stewart">RFC2617</a>] to authenticate with
   the authorization server.  The client identifier is encoded using the
   "application/x-www-form-urlencoded" content-type encoding method
   defined by HTML 4.01 [<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>] and the encoded value
   is used as the username; the client password is used as the password.
   The authorization server MUST support the HTTP Basic authentication
   scheme for authenticating clients that were issued a client password.

   For example (extra line breaks are for display purposes only):


     Authorization: Basic czZCaGRSa3F0Mzo3RmpmcDBaQnIxS3REUmJuZlZkbUl3


   Alternatively, the authorization server MAY support including the
   client credentials in the request body using the following
   parameters:

   client_id
         REQUIRED.  The client identifier issued to the client during
         the registration process described by <a href="#section-2.2">Section 2.2</a>.
   client_secret
         REQUIRED.  The client secret.  The client MAY omit the
         parameter if the client secret is an empty string.

   Including the client credentials in the request body using the two
   parameters is NOT RECOMMENDED, and SHOULD be limited to clients
   unable to directly utilize the HTTP Basic authentication scheme (or
   other password-based HTTP authentication schemes).  The parameters
   can only be transmitted in the request body and MUST NOT be included
   in the request URI.

   For example, requesting to refresh an access token (<a href="#section-6">Section 6</a>) using
   the body parameters (extra line breaks are for display purposes
   only):


     POST /token HTTP/1.1
     Host: server.example.com
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8

     grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA
     &amp;client_id=s6BhdRkqt3&amp;client_secret=7Fjfp0ZBr1KtDRbnfVdmIw





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 16]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   The authorization server MUST require the use of TLS as described in
   <a href="#section-1.6">Section 1.6</a> when sending requests using password authentication.

   Since this client authentication method involves a password, the
   authorization server MUST protect any endpoint utilizing it against
   brute force attacks.

<span class="h4"><a class="selflink" name="section-2.3.2" href="#section-2.3.2">2.3.2</a>.  Other Authentication Methods</span>

   The authorization server MAY support any suitable HTTP authentication
   scheme matching its security requirements.  When using other
   authentication methods, the authorization server MUST define a
   mapping between the client identifier (registration record) and
   authentication scheme.

<span class="h3"><a class="selflink" name="section-2.4" href="#section-2.4">2.4</a>.  Unregistered Clients</span>

   This specification does not exclude the use of unregistered clients.
   However, the use with such clients is beyond the scope of this
   specification, and requires additional security analysis and review
   of its interoperability impact.


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Protocol Endpoints</span>

   The authorization process utilizes two authorization server endpoints
   (HTTP resources):

   o  Authorization endpoint - used by the client to obtain
      authorization from the resource owner via user-agent redirection.
   o  Token endpoint - used by the client to exchange an authorization
      grant for an access token, typically with client authentication.

   As well as one client endpoint:

   o  Redirection endpoint - used by the authorization server to return
      authorization credentials responses to the client via the resource
      owner user-agent.

   Not every authorization grant type utilizes both endpoints.
   Extension grant types MAY define additional endpoints as needed.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Authorization Endpoint</span>

   The authorization endpoint is used to interact with the resource
   owner and obtain an authorization grant.  The authorization server
   MUST first verify the identity of the resource owner.  The way in
   which the authorization server authenticates the resource owner (e.g.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 17]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   username and password login, session cookies) is beyond the scope of
   this specification.

   The means through which the client obtains the location of the
   authorization endpoint are beyond the scope of this specification,
   but the location is typically provided in the service documentation.

   The endpoint URI MAY include an "application/x-www-form-urlencoded"
   formatted ([<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]) query component (<a href="./rfc3986#section-3.4">[RFC3986]
   section&nbsp;3.4</a>), which MUST be retained when adding additional query
   parameters.  The endpoint URI MUST NOT include a fragment component.

   Since requests to the authorization endpoint result in user
   authentication and the transmission of clear-text credentials (in the
   HTTP response), the authorization server MUST require the use of TLS
   as described in <a href="#section-1.6">Section 1.6</a> when sending requests to the
   authorization endpoint.

   The authorization server MUST support the use of the HTTP "GET"
   method [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] for the authorization endpoint, and MAY support the
   use of the "POST" method as well.

   Parameters sent without a value MUST be treated as if they were
   omitted from the request.  The authorization server MUST ignore
   unrecognized request parameters.  Request and response parameters
   MUST NOT be included more than once.

<span class="h4"><a class="selflink" name="section-3.1.1" href="#section-3.1.1">3.1.1</a>.  Response Type</span>

   The authorization endpoint is used by the authorization code grant
   type and implicit grant type flows.  The client informs the
   authorization server of the desired grant type using the following
   parameter:

   response_type
         REQUIRED.  The value MUST be one of "code" for requesting an
         authorization code as described by <a href="#section-4.1.1">Section 4.1.1</a>, "token" for
         requesting an access token (implicit grant) as described by
         <a href="#section-4.2.1">Section 4.2.1</a>, or a registered extension value as described by
         <a href="#section-8.4">Section 8.4</a>.

   Extension response types MAY contain a space-delimited (%x20) list of
   values, where the order of values does not matter (e.g. response type
   "a b" is the same as "b a").  The meaning of such composite response
   types is defined by their respective specifications.

   If an authorization request is missing the "response_type" parameter,
   or if the response type is not understood, the authorization server



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 18]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   MUST return an error response as described in <a href="#section-4.1.2.1">Section 4.1.2.1</a>.

<span class="h4"><a class="selflink" name="section-3.1.2" href="#section-3.1.2">3.1.2</a>.  Redirection Endpoint</span>

   After completing its interaction with the resource owner, the
   authorization server directs the resource owner's user-agent back to
   the client.  The authorization server redirects the user-agent to the
   client's redirection endpoint previously established with the
   authorization server during the client registration process or when
   making the authorization request.

   The redirection endpoint URI MUST be an absolute URI as defined by
   <a href="./rfc3986#section-4.3">[RFC3986] section&nbsp;4.3</a>.  The endpoint URI MAY include an
   "application/x-www-form-urlencoded" formatted
   ([<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]) query component (<a href="./rfc3986#section-3.4">[RFC3986] section&nbsp;3.4</a>),
   which MUST be retained when adding additional query parameters.  The
   endpoint URI MUST NOT include a fragment component.

<span class="h5"><a class="selflink" name="section-3.1.2.1" href="#section-3.1.2.1">3.1.2.1</a>.  Endpoint Request Confidentiality</span>

   The redirection endpoint SHOULD require the use of TLS as described
   in <a href="#section-1.6">Section 1.6</a> when the requested response type is "code" or "token",
   or when the redirection request will result in the transmission of
   sensitive credentials over an open network.  This specification does
   not mandate the use of TLS because at the time of this writing,
   requiring clients to deploy TLS is a significant hurdle for many
   client developers.  If TLS is not available, the authorization server
   SHOULD warn the resource owner about the insecure endpoint prior to
   redirection (e.g. display a message during the authorization
   request).

   Lack of transport-layer security can have a severe impact on the
   security of the client and the protected resources it is authorized
   to access.  The use of transport-layer security is particularly
   critical when the authorization process is used as a form of
   delegated end-user authentication by the client (e.g. third-party
   sign-in service).

<span class="h5"><a class="selflink" name="section-3.1.2.2" href="#section-3.1.2.2">3.1.2.2</a>.  Registration Requirements</span>

   The authorization server MUST require the following clients to
   register their redirection endpoint:

   o  Public clients.
   o  Confidential clients utilizing the implicit grant type.

   The authorization server SHOULD require all clients to register their
   redirection endpoint prior to utilizing the authorization endpoint.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 19]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   The authorization server SHOULD require the client to provide the
   complete redirection URI (the client MAY use the "state" request
   parameter to achieve per-request customization).  If requiring the
   registration of the complete redirection URI is not possible, the
   authorization server SHOULD require the registration of the URI
   scheme, authority, and path (allowing the client to dynamically vary
   only the query component of the redirection URI when requesting
   authorization).

   The authorization server MAY allow the client to register multiple
   redirection endpoints.

   Lack of a redirection URI registration requirement can enable an
   attacker to use the authorization endpoint as open redirector as
   described in <a href="#section-10.15">Section 10.15</a>.

<span class="h5"><a class="selflink" name="section-3.1.2.3" href="#section-3.1.2.3">3.1.2.3</a>.  Dynamic Configuration</span>

   If multiple redirection URIs have been registered, if only part of
   the redirection URI has been registered, or if no redirection URI has
   been registered, the client MUST include a redirection URI with the
   authorization request using the "redirect_uri" request parameter.

   When a redirection URI is included in an authorization request, the
   authorization server MUST compare and match the value received
   against at least one of the registered redirection URIs (or URI
   components) as defined in <a href="./rfc3986#section-6">[RFC3986] section&nbsp;6</a>, if any redirection
   URIs were registered.  If the client registration included the full
   redirection URI, the authorization server MUST compare the two URIs
   using simple string comparison as defined in <a href="./rfc3986#section-6.2.1">[RFC3986] section&nbsp;6.2.1</a>.

<span class="h5"><a class="selflink" name="section-3.1.2.4" href="#section-3.1.2.4">3.1.2.4</a>.  Invalid Endpoint</span>

   If an authorization request fails validation due to a missing,
   invalid, or mismatching redirection URI, the authorization server
   SHOULD inform the resource owner of the error, and MUST NOT
   automatically redirect the user-agent to the invalid redirection URI.

<span class="h5"><a class="selflink" name="section-3.1.2.5" href="#section-3.1.2.5">3.1.2.5</a>.  Endpoint Content</span>

   The redirection request to the client's endpoint typically results in
   an HTML document response, processed by the user-agent.  If the HTML
   response is served directly as the result of the redirection request,
   any script included in the HTML document will execute with full
   access to the redirection URI and the credentials it contains.

   The client SHOULD NOT include any third-party scripts (e.g. third-
   party analytics, social plug-ins, ad networks) in the redirection



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 20]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   endpoint response.  Instead, it SHOULD extract the credentials from
   the URI and redirect the user-agent again to another endpoint without
   exposing the credentials (in the URI or elsewhere).  If third-party
   scripts are included, the client MUST ensure that its own scripts
   (used to extract and remove the credentials from the URI) will
   execute first.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Token Endpoint</span>

   The token endpoint is used by the client to obtain an access token by
   presenting its authorization grant or refresh token.  The token
   endpoint is used with every authorization grant except for the
   implicit grant type (since an access token is issued directly).

   The means through which the client obtains the location of the token
   endpoint are beyond the scope of this specification but is typically
   provided in the service documentation.

   The endpoint URI MAY include an "application/x-www-form-urlencoded"
   formatted ([<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]) query component (<a href="./rfc3986#section-3.4">[RFC3986]
   section&nbsp;3.4</a>), which MUST be retained when adding additional query
   parameters.  The endpoint URI MUST NOT include a fragment component.

   Since requests to the token endpoint result in the transmission of
   clear-text credentials (in the HTTP request and response), the
   authorization server MUST require the use of TLS as described in
   <a href="#section-1.6">Section 1.6</a> when sending requests to the token endpoint.

   The client MUST use the HTTP "POST" method when making access token
   requests.

   Parameters sent without a value MUST be treated as if they were
   omitted from the request.  The authorization server MUST ignore
   unrecognized request parameters.  Request and response parameters
   MUST NOT be included more than once.

<span class="h4"><a class="selflink" name="section-3.2.1" href="#section-3.2.1">3.2.1</a>.  Client Authentication</span>

   Confidential clients or other clients issued client credentials MUST
   authenticate with the authorization server as described in
   <a href="#section-2.3">Section 2.3</a> when making requests to the token endpoint.  Client
   authentication is used for:

   o  Enforcing the binding of refresh tokens and authorization codes to
      the client they were issued to.  Client authentication is critical
      when an authorization code is transmitted to the redirection
      endpoint over an insecure channel, or when the redirection URI has
      not been registered in full.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 21]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   o  Recovering from a compromised client by disabling the client or
      changing its credentials, thus preventing an attacker from abusing
      stolen refresh tokens.  Changing a single set of client
      credentials is significantly faster than revoking an entire set of
      refresh tokens.
   o  Implementing authentication management best practices which
      require periodic credential rotation.  Rotation of an entire set
      of refresh tokens can be challenging, while rotation of a single
      set of client credentials is significantly easier.

   A public client that was not issued a client password MAY use the
   "client_id" request parameter to identify itself when sending
   requests to the token endpoint (e.g. for the purpose of providing
   end-user context, client usage statistics).

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Access Token Scope</span>

   The authorization and token endpoints allow the client to specify the
   scope of the access request using the "scope" request parameter.  In
   turn, the authorization server uses the "scope" response parameter to
   inform the client of the scope of the access token issued.

   The value of the scope parameter is expressed as a list of space-
   delimited, case sensitive strings.  The strings are defined by the
   authorization server.  If the value contains multiple space-delimited
   strings, their order does not matter, and each string adds an
   additional access range to the requested scope.


     scope       = scope-token *( SP scope-token )
     scope-token = 1*( %x21 / %x23-5B / %x5D-7E )


   The authorization server MAY fully or partially ignore the scope
   requested by the client based on the authorization server policy or
   the resource owner's instructions.  If the issued access token scope
   is different from the one requested by the client, the authorization
   server MUST include the "scope" response parameter to inform the
   client of the actual scope granted.

   If the client omits the scope parameter when requesting
   authorization, the authorization server MUST either process the
   request using a pre-defined default value, or fail the request
   indicating an invalid scope.  The authorization server SHOULD
   document its scope requirements and default value (if defined).






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 22]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-23" id="page-23" href="#page-23" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Obtaining Authorization</span>

   To request an access token, the client obtains authorization from the
   resource owner.  The authorization is expressed in the form of an
   authorization grant which the client uses to request the access
   token.  OAuth defines four grant types: authorization code, implicit,
   resource owner password credentials, and client credentials.  It also
   provides an extension mechanism for defining additional grant types.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Authorization Code Grant</span>

   The authorization code grant type is used to obtain both access
   tokens and refresh tokens and is optimized for confidential clients.
   As a redirection-based flow, the client must be capable of
   interacting with the resource owner's user-agent (typically a web
   browser) and capable of receiving incoming requests (via redirection)
   from the authorization server.


     +----------+
     | resource |
     |   owner  |
     |          |
     +----------+
          ^
          |
         (B)
     +----|-----+          Client Identifier      +---------------+
     |         -+----(A)-- &amp; Redirection URI ----&gt;|               |
     |  User-   |                                 | Authorization |
     |  Agent  -+----(B)-- User authenticates ---&gt;|     Server    |
     |          |                                 |               |
     |         -+----(C)-- Authorization Code ---&lt;|               |
     +-|----|---+                                 +---------------+
       |    |                                         ^      v
      (A)  (C)                                        |      |
       |    |                                         |      |
       ^    v                                         |      |
     +---------+                                      |      |
     |         |&gt;---(D)-- Authorization Code ---------'      |
     |  Client |          &amp; Redirection URI                  |
     |         |                                             |
     |         |&lt;---(E)----- Access Token -------------------'
     +---------+       (w/ Optional Refresh Token)


   Note: The lines illustrating steps A, B, and C are broken into two
   parts as they pass through the user-agent.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 23]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-24" id="page-24" href="#page-24" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


                     Figure 3: Authorization Code Flow

   The flow illustrated in Figure 3 includes the following steps:

   (A)  The client initiates the flow by directing the resource owner's
        user-agent to the authorization endpoint.  The client includes
        its client identifier, requested scope, local state, and a
        redirection URI to which the authorization server will send the
        user-agent back once access is granted (or denied).
   (B)  The authorization server authenticates the resource owner (via
        the user-agent) and establishes whether the resource owner
        grants or denies the client's access request.
   (C)  Assuming the resource owner grants access, the authorization
        server redirects the user-agent back to the client using the
        redirection URI provided earlier (in the request or during
        client registration).  The redirection URI includes an
        authorization code and any local state provided by the client
        earlier.
   (D)  The client requests an access token from the authorization
        server's token endpoint by including the authorization code
        received in the previous step.  When making the request, the
        client authenticates with the authorization server.  The client
        includes the redirection URI used to obtain the authorization
        code for verification.
   (E)  The authorization server authenticates the client, validates the
        authorization code, and ensures the redirection URI received
        matches the URI used to redirect the client in step (C).  If
        valid, the authorization server responds back with an access
        token and optionally, a refresh token.

<span class="h4"><a class="selflink" name="section-4.1.1" href="#section-4.1.1">4.1.1</a>.  Authorization Request</span>

   The client constructs the request URI by adding the following
   parameters to the query component of the authorization endpoint URI
   using the "application/x-www-form-urlencoded" format as defined by
   [<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]:

   response_type
         REQUIRED.  Value MUST be set to "code".
   client_id
         REQUIRED.  The client identifier as described in <a href="#section-2.2">Section 2.2</a>.
   redirect_uri
         OPTIONAL.  As described in <a href="#section-3.1.2">Section 3.1.2</a>.
   scope
         OPTIONAL.  The scope of the access request as described by
         <a href="#section-3.3">Section 3.3</a>.





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 24]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-25" id="page-25" href="#page-25" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   state
         RECOMMENDED.  An opaque value used by the client to maintain
         state between the request and callback.  The authorization
         server includes this value when redirecting the user-agent back
         to the client.  The parameter SHOULD be used for preventing
         cross-site request forgery as described in <a href="#section-10.12">Section 10.12</a>.

   The client directs the resource owner to the constructed URI using an
   HTTP redirection response, or by other means available to it via the
   user-agent.

   For example, the client directs the user-agent to make the following
   HTTP request using TLS (extra line breaks are for display purposes
   only):


    GET /authorize?response_type=code&amp;client_id=s6BhdRkqt3&amp;state=xyz
        &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
    Host: server.example.com


   The authorization server validates the request to ensure all required
   parameters are present and valid.  If the request is valid, the
   authorization server authenticates the resource owner and obtains an
   authorization decision (by asking the resource owner or by
   establishing approval via other means).

   When a decision is established, the authorization server directs the
   user-agent to the provided client redirection URI using an HTTP
   redirection response, or by other means available to it via the user-
   agent.

<span class="h4"><a class="selflink" name="section-4.1.2" href="#section-4.1.2">4.1.2</a>.  Authorization Response</span>

   If the resource owner grants the access request, the authorization
   server issues an authorization code and delivers it to the client by
   adding the following parameters to the query component of the
   redirection URI using the "application/x-www-form-urlencoded" format:

   code
         REQUIRED.  The authorization code generated by the
         authorization server.  The authorization code MUST expire
         shortly after it is issued to mitigate the risk of leaks.  A
         maximum authorization code lifetime of 10 minutes is
         RECOMMENDED.  The client MUST NOT use the authorization code
         more than once.  If an authorization code is used more than
         once, the authorization server MUST deny the request and SHOULD
         revoke (when possible) all tokens previously issued based on



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 25]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-26" id="page-26" href="#page-26" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


         that authorization code.  The authorization code is bound to
         the client identifier and redirection URI.
   state
         REQUIRED if the "state" parameter was present in the client
         authorization request.  The exact value received from the
         client.

   For example, the authorization server redirects the user-agent by
   sending the following HTTP response:


     HTTP/1.1 302 Found
     Location: https://client.example.com/cb?code=SplxlOBeZQQYbYS6WxSbIA
               &amp;state=xyz


   The client MUST ignore unrecognized response parameters.  The
   authorization code string size is left undefined by this
   specification.  The client should avoid making assumptions about code
   value sizes.  The authorization server SHOULD document the size of
   any value it issues.

<span class="h5"><a class="selflink" name="section-4.1.2.1" href="#section-4.1.2.1">4.1.2.1</a>.  Error Response</span>

   If the request fails due to a missing, invalid, or mismatching
   redirection URI, or if the client identifier is missing or invalid,
   the authorization server SHOULD inform the resource owner of the
   error, and MUST NOT automatically redirect the user-agent to the
   invalid redirection URI.

   If the resource owner denies the access request or if the request
   fails for reasons other than a missing or invalid redirection URI,
   the authorization server informs the client by adding the following
   parameters to the query component of the redirection URI using the
   "application/x-www-form-urlencoded" format:

   error
         REQUIRED.  A single ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] error code from the
         following:
         invalid_request
               The request is missing a required parameter, includes an
               invalid parameter value, includes a parameter more than
               once, or is otherwise malformed.
         unauthorized_client
               The client is not authorized to request an authorization
               code using this method.





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 26]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-27" id="page-27" href="#page-27" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


         access_denied
               The resource owner or authorization server denied the
               request.
         unsupported_response_type
               The authorization server does not support obtaining an
               authorization code using this method.
         invalid_scope
               The requested scope is invalid, unknown, or malformed.
         server_error
               The authorization server encountered an unexpected
               condition which prevented it from fulfilling the request.
         temporarily_unavailable
               The authorization server is currently unable to handle
               the request due to a temporary overloading or maintenance
               of the server.
         Values for the "error" parameter MUST NOT include characters
         outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_description
         OPTIONAL.  A human-readable ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] text providing
         additional information, used to assist the client developer in
         understanding the error that occurred.
         Values for the "error_description" parameter MUST NOT include
         characters outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_uri
         OPTIONAL.  A URI identifying a human-readable web page with
         information about the error, used to provide the client
         developer with additional information about the error.
         Values for the "error_uri" parameter MUST conform to the URI-
         Reference syntax, and thus MUST NOT include characters outside
         the set %x21 / %x23-5B / %x5D-7E.
   state
         REQUIRED if a "state" parameter was present in the client
         authorization request.  The exact value received from the
         client.

   For example, the authorization server redirects the user-agent by
   sending the following HTTP response:


   HTTP/1.1 302 Found
   Location: https://client.example.com/cb?error=access_denied&amp;state=xyz


<span class="h4"><a class="selflink" name="section-4.1.3" href="#section-4.1.3">4.1.3</a>.  Access Token Request</span>

   The client makes a request to the token endpoint by adding the
   following parameters using the "application/x-www-form-urlencoded"
   format in the HTTP request entity-body:



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 27]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-28" id="page-28" href="#page-28" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   grant_type
         REQUIRED.  Value MUST be set to "authorization_code".
   code
         REQUIRED.  The authorization code received from the
         authorization server.
   redirect_uri
         REQUIRED, if the "redirect_uri" parameter was included in the
         authorization request as described in <a href="#section-4.1.1">Section 4.1.1</a>, and their
         values MUST be identical.

   If the client type is confidential or the client was issued client
   credentials (or assigned other authentication requirements), the
   client MUST authenticate with the authorization server as described
   in <a href="#section-3.2.1">Section 3.2.1</a>.

   For example, the client makes the following HTTP request using TLS
   (extra line breaks are for display purposes only):


     POST /token HTTP/1.1
     Host: server.example.com
     Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8

     grant_type=authorization_code&amp;code=SplxlOBeZQQYbYS6WxSbIA
     &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb


   The authorization server MUST:

   o  require client authentication for confidential clients or for any
      client that was issued client credentials (or with other
      authentication requirements),
   o  authenticate the client if client authentication is included and
      ensure the authorization code was issued to the authenticated
      client,
   o  verify that the authorization code is valid, and
   o  ensure that the "redirect_uri" parameter is present if the
      "redirect_uri" parameter was included in the initial authorization
      request as described in <a href="#section-4.1.1">Section 4.1.1</a>, and if included ensure
      their values are identical.

<span class="h4"><a class="selflink" name="section-4.1.4" href="#section-4.1.4">4.1.4</a>.  Access Token Response</span>

   If the access token request is valid and authorized, the
   authorization server issues an access token and optional refresh
   token as described in <a href="#section-5.1">Section 5.1</a>.  If the request client
   authentication failed or is invalid, the authorization server returns



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 28]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-29" id="page-29" href="#page-29" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   an error response as described in <a href="#section-5.2">Section 5.2</a>.

   An example successful response:


     HTTP/1.1 200 OK
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "access_token":"2YotnFZFEjr1zCsicMWpAA",
       "token_type":"example",
       "expires_in":3600,
       "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
       "example_parameter":"example_value"
     }


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Implicit Grant</span>

   The implicit grant type is used to obtain access tokens (it does not
   support the issuance of refresh tokens) and is optimized for public
   clients known to operate a particular redirection URI.  These clients
   are typically implemented in a browser using a scripting language
   such as JavaScript.

   As a redirection-based flow, the client must be capable of
   interacting with the resource owner's user-agent (typically a web
   browser) and capable of receiving incoming requests (via redirection)
   from the authorization server.

   Unlike the authorization code grant type in which the client makes
   separate requests for authorization and access token, the client
   receives the access token as the result of the authorization request.

   The implicit grant type does not include client authentication, and
   relies on the presence of the resource owner and the registration of
   the redirection URI.  Because the access token is encoded into the
   redirection URI, it may be exposed to the resource owner and other
   applications residing on the same device.










<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 29]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-30" id="page-30" href="#page-30" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


     +----------+
     | Resource |
     |  Owner   |
     |          |
     +----------+
          ^
          |
         (B)
     +----|-----+          Client Identifier     +---------------+
     |         -+----(A)-- &amp; Redirection URI ---&gt;|               |
     |  User-   |                                | Authorization |
     |  Agent  -|----(B)-- User authenticates --&gt;|     Server    |
     |          |                                |               |
     |          |&lt;---(C)--- Redirection URI ----&lt;|               |
     |          |          with Access Token     +---------------+
     |          |            in Fragment
     |          |                                +---------------+
     |          |----(D)--- Redirection URI ----&gt;|   Web-Hosted  |
     |          |          without Fragment      |     Client    |
     |          |                                |    Resource   |
     |     (F)  |&lt;---(E)------- Script ---------&lt;|               |
     |          |                                +---------------+
     +-|--------+
       |    |
      (A)  (G) Access Token
       |    |
       ^    v
     +---------+
     |         |
     |  Client |
     |         |
     +---------+


   Note: The lines illustrating steps A and B are broken into two parts
   as they pass through the user-agent.

                       Figure 4: Implicit Grant Flow

   The flow illustrated in Figure 4 includes the following steps:

   (A)  The client initiates the flow by directing the resource owner's
        user-agent to the authorization endpoint.  The client includes
        its client identifier, requested scope, local state, and a
        redirection URI to which the authorization server will send the
        user-agent back once access is granted (or denied).





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 30]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-31" id="page-31" href="#page-31" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   (B)  The authorization server authenticates the resource owner (via
        the user-agent) and establishes whether the resource owner
        grants or denies the client's access request.
   (C)  Assuming the resource owner grants access, the authorization
        server redirects the user-agent back to the client using the
        redirection URI provided earlier.  The redirection URI includes
        the access token in the URI fragment.
   (D)  The user-agent follows the redirection instructions by making a
        request to the web-hosted client resource (which does not
        include the fragment per [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>]).  The user-agent retains the
        fragment information locally.
   (E)  The web-hosted client resource returns a web page (typically an
        HTML document with an embedded script) capable of accessing the
        full redirection URI including the fragment retained by the
        user-agent, and extracting the access token (and other
        parameters) contained in the fragment.
   (F)  The user-agent executes the script provided by the web-hosted
        client resource locally, which extracts the access token and
        passes it to the client.

<span class="h4"><a class="selflink" name="section-4.2.1" href="#section-4.2.1">4.2.1</a>.  Authorization Request</span>

   The client constructs the request URI by adding the following
   parameters to the query component of the authorization endpoint URI
   using the "application/x-www-form-urlencoded" format:

   response_type
         REQUIRED.  Value MUST be set to "token".
   client_id
         REQUIRED.  The client identifier as described in <a href="#section-2.2">Section 2.2</a>.
   redirect_uri
         OPTIONAL.  As described in <a href="#section-3.1.2">Section 3.1.2</a>.
   scope
         OPTIONAL.  The scope of the access request as described by
         <a href="#section-3.3">Section 3.3</a>.
   state
         RECOMMENDED.  An opaque value used by the client to maintain
         state between the request and callback.  The authorization
         server includes this value when redirecting the user-agent back
         to the client.  The parameter SHOULD be used for preventing
         cross-site request forgery as described in <a href="#section-10.12">Section 10.12</a>.

   The client directs the resource owner to the constructed URI using an
   HTTP redirection response, or by other means available to it via the
   user-agent.






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 31]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-32" id="page-32" href="#page-32" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   For example, the client directs the user-agent to make the following
   HTTP request using TLS (extra line breaks are for display purposes
   only):


    GET /authorize?response_type=token&amp;client_id=s6BhdRkqt3&amp;state=xyz
        &amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb HTTP/1.1
    Host: server.example.com


   The authorization server validates the request to ensure all required
   parameters are present and valid.  The authorization server MUST
   verify that the redirection URI to which it will redirect the access
   token matches a redirection URI registered by the client as described
   in <a href="#section-3.1.2">Section 3.1.2</a>.

   If the request is valid, the authorization server authenticates the
   resource owner and obtains an authorization decision (by asking the
   resource owner or by establishing approval via other means).

   When a decision is established, the authorization server directs the
   user-agent to the provided client redirection URI using an HTTP
   redirection response, or by other means available to it via the user-
   agent.

<span class="h4"><a class="selflink" name="section-4.2.2" href="#section-4.2.2">4.2.2</a>.  Access Token Response</span>

   If the resource owner grants the access request, the authorization
   server issues an access token and delivers it to the client by adding
   the following parameters to the fragment component of the redirection
   URI using the "application/x-www-form-urlencoded" format:

   access_token
         REQUIRED.  The access token issued by the authorization server.
   token_type
         REQUIRED.  The type of the token issued as described in
         <a href="#section-7.1">Section 7.1</a>.  Value is case insensitive.
   expires_in
         RECOMMENDED.  The lifetime in seconds of the access token.  For
         example, the value "3600" denotes that the access token will
         expire in one hour from the time the response was generated.
         If omitted, the authorization server SHOULD provide the
         expiration time via other means or document the default value.
   scope
         OPTIONAL, if identical to the scope requested by the client,
         otherwise REQUIRED.  The scope of the access token as described
         by <a href="#section-3.3">Section 3.3</a>.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 32]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-33" id="page-33" href="#page-33" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   state
         REQUIRED if the "state" parameter was present in the client
         authorization request.  The exact value received from the
         client.

   The authorization server MUST NOT issue a refresh token.

   For example, the authorization server redirects the user-agent by
   sending the following HTTP response (URI extra line breaks are for
   display purposes only):


     HTTP/1.1 302 Found
     Location: http://example.com/cb#access_token=2YotnFZFEjr1zCsicMWpAA
               &amp;state=xyz&amp;token_type=example&amp;expires_in=3600


   Developers should note that some user-agents do not support the
   inclusion of a fragment component in the HTTP "Location" response
   header field.  Such clients will require using other methods for
   redirecting the client than a 3xx redirection response.  For example,
   returning an HTML page which includes a 'continue' button with an
   action linked to the redirection URI.

   The client MUST ignore unrecognized response parameters.  The access
   token string size is left undefined by this specification.  The
   client should avoid making assumptions about value sizes.  The
   authorization server SHOULD document the size of any value it issues.

<span class="h5"><a class="selflink" name="section-4.2.2.1" href="#section-4.2.2.1">4.2.2.1</a>.  Error Response</span>

   If the request fails due to a missing, invalid, or mismatching
   redirection URI, or if the client identifier is missing or invalid,
   the authorization server SHOULD inform the resource owner of the
   error, and MUST NOT automatically redirect the user-agent to the
   invalid redirection URI.

   If the resource owner denies the access request or if the request
   fails for reasons other than a missing or invalid redirection URI,
   the authorization server informs the client by adding the following
   parameters to the fragment component of the redirection URI using the
   "application/x-www-form-urlencoded" format:

   error
         REQUIRED.  A single ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] error code from the
         following:





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 33]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-34" id="page-34" href="#page-34" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


         invalid_request
               The request is missing a required parameter, includes an
               invalid parameter value, includes a parameter more than
               once, or is otherwise malformed.
         unauthorized_client
               The client is not authorized to request an access token
               using this method.
         access_denied
               The resource owner or authorization server denied the
               request.
         unsupported_response_type
               The authorization server does not support obtaining an
               access token using this method.
         invalid_scope
               The requested scope is invalid, unknown, or malformed.
         server_error
               The authorization server encountered an unexpected
               condition which prevented it from fulfilling the request.
         temporarily_unavailable
               The authorization server is currently unable to handle
               the request due to a temporary overloading or maintenance
               of the server.
         Values for the "error" parameter MUST NOT include characters
         outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_description
         OPTIONAL.  A human-readable ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] text providing
         additional information, used to assist the client developer in
         understanding the error that occurred.
         Values for the "error_description" parameter MUST NOT include
         characters outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_uri
         OPTIONAL.  A URI identifying a human-readable web page with
         information about the error, used to provide the client
         developer with additional information about the error.
         Values for the "error_uri" parameter MUST conform to the URI-
         Reference syntax, and thus MUST NOT include characters outside
         the set %x21 / %x23-5B / %x5D-7E.
   state
         REQUIRED if a "state" parameter was present in the client
         authorization request.  The exact value received from the
         client.

   For example, the authorization server redirects the user-agent by
   sending the following HTTP response:


   HTTP/1.1 302 Found
   Location: https://client.example.com/cb#error=access_denied&amp;state=xyz



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 34]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-35" id="page-35" href="#page-35" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Resource Owner Password Credentials Grant</span>

   The resource owner password credentials grant type is suitable in
   cases where the resource owner has a trust relationship with the
   client, such as the device operating system or a highly privileged
   application.  The authorization server should take special care when
   enabling this grant type, and only allow it when other flows are not
   viable.

   The grant type is suitable for clients capable of obtaining the
   resource owner's credentials (username and password, typically using
   an interactive form).  It is also used to migrate existing clients
   using direct authentication schemes such as HTTP Basic or Digest
   authentication to OAuth by converting the stored credentials to an
   access token.


     +----------+
     | Resource |
     |  Owner   |
     |          |
     +----------+
          v
          |    Resource Owner
         (A) Password Credentials
          |
          v
     +---------+                                  +---------------+
     |         |&gt;--(B)---- Resource Owner -------&gt;|               |
     |         |         Password Credentials     | Authorization |
     | Client  |                                  |     Server    |
     |         |&lt;--(C)---- Access Token ---------&lt;|               |
     |         |    (w/ Optional Refresh Token)   |               |
     +---------+                                  +---------------+


            Figure 5: Resource Owner Password Credentials Flow

   The flow illustrated in Figure 5 includes the following steps:

   (A)  The resource owner provides the client with its username and
        password.
   (B)  The client requests an access token from the authorization
        server's token endpoint by including the credentials received
        from the resource owner.  When making the request, the client
        authenticates with the authorization server.





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 35]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-36" id="page-36" href="#page-36" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   (C)  The authorization server authenticates the client and validates
        the resource owner credentials, and if valid issues an access
        token.

<span class="h4"><a class="selflink" name="section-4.3.1" href="#section-4.3.1">4.3.1</a>.  Authorization Request and Response</span>

   The method through which the client obtains the resource owner
   credentials is beyond the scope of this specification.  The client
   MUST discard the credentials once an access token has been obtained.

<span class="h4"><a class="selflink" name="section-4.3.2" href="#section-4.3.2">4.3.2</a>.  Access Token Request</span>

   The client makes a request to the token endpoint by adding the
   following parameters using the "application/x-www-form-urlencoded"
   format in the HTTP request entity-body:

   grant_type
         REQUIRED.  Value MUST be set to "password".
   username
         REQUIRED.  The resource owner username.
   password
         REQUIRED.  The resource owner password.
   scope
         OPTIONAL.  The scope of the access request as described by
         <a href="#section-3.3">Section 3.3</a>.

   If the client type is confidential or the client was issued client
   credentials (or assigned other authentication requirements), the
   client MUST authenticate with the authorization server as described
   in <a href="#section-3.2.1">Section 3.2.1</a>.

   For example, the client makes the following HTTP request using
   transport-layer security (extra line breaks are for display purposes
   only):


     POST /token HTTP/1.1
     Host: server.example.com
     Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8

     grant_type=password&amp;username=johndoe&amp;password=A3ddj3w


   The authorization server MUST:






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 36]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-37" id="page-37" href="#page-37" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   o  require client authentication for confidential clients or for any
      client that was issued client credentials (or with other
      authentication requirements),
   o  authenticate the client if client authentication is included, and
   o  validate the resource owner password credentials using its
      existing password validation algorithm.

   Since this access token request utilizes the resource owner's
   password, the authorization server MUST protect the endpoint against
   brute force attacks (e.g. using rate-limitation or generating
   alerts).

<span class="h4"><a class="selflink" name="section-4.3.3" href="#section-4.3.3">4.3.3</a>.  Access Token Response</span>

   If the access token request is valid and authorized, the
   authorization server issues an access token and optional refresh
   token as described in <a href="#section-5.1">Section 5.1</a>.  If the request failed client
   authentication or is invalid, the authorization server returns an
   error response as described in <a href="#section-5.2">Section 5.2</a>.

   An example successful response:


     HTTP/1.1 200 OK
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "access_token":"2YotnFZFEjr1zCsicMWpAA",
       "token_type":"example",
       "expires_in":3600,
       "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
       "example_parameter":"example_value"
     }


<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  Client Credentials Grant</span>

   The client can request an access token using only its client
   credentials (or other supported means of authentication) when the
   client is requesting access to the protected resources under its
   control, or those of another resource owner which has been previously
   arranged with the authorization server (the method of which is beyond
   the scope of this specification).

   The client credentials grant type MUST only be used by confidential
   clients.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 37]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-38" id="page-38" href="#page-38" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


     +---------+                                  +---------------+
     |         |                                  |               |
     |         |&gt;--(A)- Client Authentication ---&gt;| Authorization |
     | Client  |                                  |     Server    |
     |         |&lt;--(B)---- Access Token ---------&lt;|               |
     |         |                                  |               |
     +---------+                                  +---------------+


                     Figure 6: Client Credentials Flow

   The flow illustrated in Figure 6 includes the following steps:

   (A)  The client authenticates with the authorization server and
        requests an access token from the token endpoint.
   (B)  The authorization server authenticates the client, and if valid
        issues an access token.

<span class="h4"><a class="selflink" name="section-4.4.1" href="#section-4.4.1">4.4.1</a>.  Authorization Request and Response</span>

   Since the client authentication is used as the authorization grant,
   no additional authorization request is needed.

<span class="h4"><a class="selflink" name="section-4.4.2" href="#section-4.4.2">4.4.2</a>.  Access Token Request</span>

   The client makes a request to the token endpoint by adding the
   following parameters using the "application/x-www-form-urlencoded"
   format in the HTTP request entity-body:

   grant_type
         REQUIRED.  Value MUST be set to "client_credentials".
   scope
         OPTIONAL.  The scope of the access request as described by
         <a href="#section-3.3">Section 3.3</a>.

   The client MUST authenticate with the authorization server as
   described in <a href="#section-3.2.1">Section 3.2.1</a>.

   For example, the client makes the following HTTP request using
   transport-layer security (extra line breaks are for display purposes
   only):


     POST /token HTTP/1.1
     Host: server.example.com
     Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 38]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-39" id="page-39" href="#page-39" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


     grant_type=client_credentials


   The authorization server MUST authenticate the client.

<span class="h4"><a class="selflink" name="section-4.4.3" href="#section-4.4.3">4.4.3</a>.  Access Token Response</span>

   If the access token request is valid and authorized, the
   authorization server issues an access token as described in
   <a href="#section-5.1">Section 5.1</a>.  A refresh token SHOULD NOT be included.  If the request
   failed client authentication or is invalid, the authorization server
   returns an error response as described in <a href="#section-5.2">Section 5.2</a>.

   An example successful response:


     HTTP/1.1 200 OK
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "access_token":"2YotnFZFEjr1zCsicMWpAA",
       "token_type":"example",
       "expires_in":3600,
       "example_parameter":"example_value"
     }


<span class="h3"><a class="selflink" name="section-4.5" href="#section-4.5">4.5</a>.  Extension Grants</span>

   The client uses an extension grant type by specifying the grant type
   using an absolute URI (defined by the authorization server) as the
   value of the "grant_type" parameter of the token endpoint, and by
   adding any additional parameters necessary.

   For example, to request an access token using a SAML 2.0 assertion
   grant type as defined by [<a href="#ref-I-D.ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</a>], the client
   makes the following HTTP request using TLS (line breaks are for
   display purposes only):


     POST /token HTTP/1.1
     Host: server.example.com
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8

     grant_type=urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Asaml2-
     bearer&amp;assertion=PEFzc2VydGlvbiBJc3N1ZUluc3RhbnQ9IjIwMTEtMDU



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 39]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-40" id="page-40" href="#page-40" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


     [...omitted for brevity...]aG5TdGF0ZW1lbnQ-PC9Bc3NlcnRpb24-


   If the access token request is valid and authorized, the
   authorization server issues an access token and optional refresh
   token as described in <a href="#section-5.1">Section 5.1</a>.  If the request failed client
   authentication or is invalid, the authorization server returns an
   error response as described in <a href="#section-5.2">Section 5.2</a>.


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Issuing an Access Token</span>

   If the access token request is valid and authorized, the
   authorization server issues an access token and optional refresh
   token as described in <a href="#section-5.1">Section 5.1</a>.  If the request failed client
   authentication or is invalid, the authorization server returns an
   error response as described in <a href="#section-5.2">Section 5.2</a>.

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Successful Response</span>

   The authorization server issues an access token and optional refresh
   token, and constructs the response by adding the following parameters
   to the entity body of the HTTP response with a 200 (OK) status code:

   access_token
         REQUIRED.  The access token issued by the authorization server.
   token_type
         REQUIRED.  The type of the token issued as described in
         <a href="#section-7.1">Section 7.1</a>.  Value is case insensitive.
   expires_in
         RECOMMENDED.  The lifetime in seconds of the access token.  For
         example, the value "3600" denotes that the access token will
         expire in one hour from the time the response was generated.
         If omitted, the authorization server SHOULD provide the
         expiration time via other means or document the default value.
   refresh_token
         OPTIONAL.  The refresh token which can be used to obtain new
         access tokens using the same authorization grant as described
         in <a href="#section-6">Section 6</a>.
   scope
         OPTIONAL, if identical to the scope requested by the client,
         otherwise REQUIRED.  The scope of the access token as described
         by <a href="#section-3.3">Section 3.3</a>.

   The parameters are included in the entity body of the HTTP response
   using the "application/json" media type as defined by [<a href="./rfc4627" title="&quot;The application/json Media Type for JavaScript Object Notation (JSON)&quot;">RFC4627</a>].  The
   parameters are serialized into a JSON structure by adding each
   parameter at the highest structure level.  Parameter names and string



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 40]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-41" id="page-41" href="#page-41" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   values are included as JSON strings.  Numerical values are included
   as JSON numbers.  The order of parameters does not matter and can
   vary.

   The authorization server MUST include the HTTP "Cache-Control"
   response header field [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] with a value of "no-store" in any
   response containing tokens, credentials, or other sensitive
   information, as well as the "Pragma" response header field [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>]
   with a value of "no-cache".

   For example:


     HTTP/1.1 200 OK
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "access_token":"2YotnFZFEjr1zCsicMWpAA",
       "token_type":"example",
       "expires_in":3600,
       "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
       "example_parameter":"example_value"
     }


   The client MUST ignore unrecognized value names in the response.  The
   sizes of tokens and other values received from the authorization
   server are left undefined.  The client should avoid making
   assumptions about value sizes.  The authorization server SHOULD
   document the size of any value it issues.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Error Response</span>

   The authorization server responds with an HTTP 400 (Bad Request)
   status code (unless specified otherwise) and includes the following
   parameters with the response:

   error
         REQUIRED.  A single ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] error code from the
         following:
         invalid_request
               The request is missing a required parameter, includes an
               unsupported parameter value (other than grant type),
               repeats a parameter, includes multiple credentials,
               utilizes more than one mechanism for authenticating the
               client, or is otherwise malformed.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 41]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-42" id="page-42" href="#page-42" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


         invalid_client
               Client authentication failed (e.g. unknown client, no
               client authentication included, or unsupported
               authentication method).  The authorization server MAY
               return an HTTP 401 (Unauthorized) status code to indicate
               which HTTP authentication schemes are supported.  If the
               client attempted to authenticate via the "Authorization"
               request header field, the authorization server MUST
               respond with an HTTP 401 (Unauthorized) status code, and
               include the "WWW-Authenticate" response header field
               matching the authentication scheme used by the client.
         invalid_grant
               The provided authorization grant (e.g. authorization
               code, resource owner credentials) or refresh token is
               invalid, expired, revoked, does not match the redirection
               URI used in the authorization request, or was issued to
               another client.
         unauthorized_client
               The authenticated client is not authorized to use this
               authorization grant type.
         unsupported_grant_type
               The authorization grant type is not supported by the
               authorization server.
         invalid_scope
               The requested scope is invalid, unknown, malformed, or
               exceeds the scope granted by the resource owner.
         Values for the "error" parameter MUST NOT include characters
         outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_description
         OPTIONAL.  A human-readable ASCII [<a href="#ref-USASCII" title="&quot;Coded Character Set -- 7-bit American Standard Code for Information Interchange&quot;">USASCII</a>] text providing
         additional information, used to assist the client developer in
         understanding the error that occurred.
         Values for the "error_description" parameter MUST NOT include
         characters outside the set %x20-21 / %x23-5B / %x5D-7E.
   error_uri
         OPTIONAL.  A URI identifying a human-readable web page with
         information about the error, used to provide the client
         developer with additional information about the error.
         Values for the "error_uri" parameter MUST conform to the URI-
         Reference syntax, and thus MUST NOT include characters outside
         the set %x21 / %x23-5B / %x5D-7E.

   The parameters are included in the entity body of the HTTP response
   using the "application/json" media type as defined by [<a href="./rfc4627" title="&quot;The application/json Media Type for JavaScript Object Notation (JSON)&quot;">RFC4627</a>].  The
   parameters are serialized into a JSON structure by adding each
   parameter at the highest structure level.  Parameter names and string
   values are included as JSON strings.  Numerical values are included
   as JSON numbers.  The order of parameters does not matter and can



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 42]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-43" id="page-43" href="#page-43" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   vary.

   For example:


     HTTP/1.1 400 Bad Request
     Content-Type: application/json;charset=UTF-8
     Cache-Control: no-store
     Pragma: no-cache

     {
       "error":"invalid_request"
     }



<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Refreshing an Access Token</span>

   If the authorization server issued a refresh token to the client, the
   client makes a refresh request to the token endpoint by adding the
   following parameters using the "application/x-www-form-urlencoded"
   format in the HTTP request entity-body:

   grant_type
         REQUIRED.  Value MUST be set to "refresh_token".
   refresh_token
         REQUIRED.  The refresh token issued to the client.
   scope
         OPTIONAL.  The scope of the access request as described by
         <a href="#section-3.3">Section 3.3</a>.  The requested scope MUST NOT include any scope
         not originally granted by the resource owner, and if omitted is
         treated as equal to the scope originally granted by the
         resource owner.

   Because refresh tokens are typically long-lasting credentials used to
   request additional access tokens, the refresh token is bound to the
   client to which it was issued.  If the client type is confidential or
   the client was issued client credentials (or assigned other
   authentication requirements), the client MUST authenticate with the
   authorization server as described in <a href="#section-3.2.1">Section 3.2.1</a>.











<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 43]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-44" id="page-44" href="#page-44" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   For example, the client makes the following HTTP request using
   transport-layer security (extra line breaks are for display purposes
   only):


     POST /token HTTP/1.1
     Host: server.example.com
     Authorization: Basic czZCaGRSa3F0MzpnWDFmQmF0M2JW
     Content-Type: application/x-www-form-urlencoded;charset=UTF-8

     grant_type=refresh_token&amp;refresh_token=tGzv3JOkF0XG5Qx2TlKWIA


   The authorization server MUST:

   o  require client authentication for confidential clients or for any
      client that was issued client credentials (or with other
      authentication requirements),
   o  authenticate the client if client authentication is included and
      ensure the refresh token was issued to the authenticated client,
      and
   o  validate the refresh token.

   If valid and authorized, the authorization server issues an access
   token as described in <a href="#section-5.1">Section 5.1</a>.  If the request failed
   verification or is invalid, the authorization server returns an error
   response as described in <a href="#section-5.2">Section 5.2</a>.

   The authorization server MAY issue a new refresh token, in which case
   the client MUST discard the old refresh token and replace it with the
   new refresh token.  The authorization server MAY revoke the old
   refresh token after issuing a new refresh token to the client.  If a
   new refresh token is issued, the refresh token scope MUST be
   identical to that of the refresh token included by the client in the
   request.


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Accessing Protected Resources</span>

   The client accesses protected resources by presenting the access
   token to the resource server.  The resource server MUST validate the
   access token and ensure it has not expired and that its scope covers
   the requested resource.  The methods used by the resource server to
   validate the access token (as well as any error responses) are beyond
   the scope of this specification, but generally involve an interaction
   or coordination between the resource server and the authorization
   server.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 44]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-45" id="page-45" href="#page-45" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   The method in which the client utilizes the access token to
   authenticate with the resource server depends on the type of access
   token issued by the authorization server.  Typically, it involves
   using the HTTP "Authorization" request header field [<a href="./rfc2617" title="and L. Stewart">RFC2617</a>] with an
   authentication scheme defined by the access token type specification.

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Access Token Types</span>

   The access token type provides the client with the information
   required to successfully utilize the access token to make a protected
   resource request (along with type-specific attributes).  The client
   MUST NOT use an access token if it does not understand the token
   type.

   For example, the "bearer" token type defined in
   [<a href="#ref-I-D.ietf-oauth-v2-bearer">I-D.ietf-oauth-v2-bearer</a>] is utilized by simply including the access
   token string in the request:


     GET /resource/1 HTTP/1.1
     Host: example.com
     Authorization: Bearer mF_9.B5f-4.1JqM


   while the "mac" token type defined in [<a href="#ref-I-D.ietf-oauth-v2-http-mac">I-D.ietf-oauth-v2-http-mac</a>] is
   utilized by issuing a MAC key together with the access token which is
   used to sign certain components of the HTTP requests:


     GET /resource/1 HTTP/1.1
     Host: example.com
     Authorization: MAC id="h480djs93hd8",
                        nonce="274312:dj83hs9s",
                        mac="kDZvddkndxvhGRXZhvuDjEWhGeE="


   The above examples are provided for illustration purposes only.
   Developers are advised to consult the [<a href="#ref-I-D.ietf-oauth-v2-bearer">I-D.ietf-oauth-v2-bearer</a>] and
   [<a href="#ref-I-D.ietf-oauth-v2-http-mac">I-D.ietf-oauth-v2-http-mac</a>] specifications before use.

   Each access token type definition specifies the additional attributes
   (if any) sent to the client together with the "access_token" response
   parameter.  It also defines the HTTP authentication method used to
   include the access token when making a protected resource request.







<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 45]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-46" id="page-46" href="#page-46" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  Error Response</span>

   If a resource access request fails, the resource server SHOULD inform
   the client of the error.  While the specifics of such error responses
   are beyond the scope of this specification, this documents
   establishes a common registry in <a href="#section-11.4">Section 11.4</a> for error values to be
   shared among OAuth token authentication schemes.

   New authentication schemes designed primarily for OAuth token
   authentication SHOULD define a mechanism for providing an error
   status code to the client, in which the error values allowed are
   registered in the error registry established by this specification.
   Such schemes MAY limit the set of valid error codes to a subset of
   the registered values.  If the error code is returned using a named
   parameter, the parameter name SHOULD be "error".

   Other schemes capable of being used for OAuth token authentication,
   but not primarily designed for that purpose, MAY bind their error
   values to the registry in the same manner.

   New authentication schemes MAY choose to also specify the use of the
   "error_description" and "error_uri" parameters to return error
   information in a manner parallel to their usage in this
   specification.


<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  Extensibility</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Defining Access Token Types</span>

   Access token types can be defined in one of two ways: registered in
   the access token type registry (following the procedures in
   <a href="#section-11.1">Section 11.1</a>), or by using a unique absolute URI as its name.

   Types utilizing a URI name SHOULD be limited to vendor-specific
   implementations that are not commonly applicable, and are specific to
   the implementation details of the resource server where they are
   used.

   All other types MUST be registered.  Type names MUST conform to the
   type-name ABNF.  If the type definition includes a new HTTP
   authentication scheme, the type name SHOULD be identical to the HTTP
   authentication scheme name (as defined by [<a href="./rfc2617" title="and L. Stewart">RFC2617</a>]).  The token type
   "example" is reserved for use in examples.


     type-name  = 1*name-char
     name-char  = "-" / "." / "_" / DIGIT / ALPHA



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 46]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-47" id="page-47" href="#page-47" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Defining New Endpoint Parameters</span>

   New request or response parameters for use with the authorization
   endpoint or the token endpoint are defined and registered in the
   parameters registry following the procedure in <a href="#section-11.2">Section 11.2</a>.

   Parameter names MUST conform to the param-name ABNF and parameter
   values syntax MUST be well-defined (e.g., using ABNF, or a reference
   to the syntax of an existing parameter).


     param-name  = 1*name-char
     name-char   = "-" / "." / "_" / DIGIT / ALPHA


   Unregistered vendor-specific parameter extensions that are not
   commonly applicable, and are specific to the implementation details
   of the authorization server where they are used SHOULD utilize a
   vendor-specific prefix that is not likely to conflict with other
   registered values (e.g. begin with 'companyname_').

<span class="h3"><a class="selflink" name="section-8.3" href="#section-8.3">8.3</a>.  Defining New Authorization Grant Types</span>

   New authorization grant types can be defined by assigning them a
   unique absolute URI for use with the "grant_type" parameter.  If the
   extension grant type requires additional token endpoint parameters,
   they MUST be registered in the OAuth parameters registry as described
   by <a href="#section-11.2">Section 11.2</a>.

<span class="h3"><a class="selflink" name="section-8.4" href="#section-8.4">8.4</a>.  Defining New Authorization Endpoint Response Types</span>

   New response types for use with the authorization endpoint are
   defined and registered in the authorization endpoint response type
   registry following the procedure in <a href="#section-11.3">Section 11.3</a>.  Response type
   names MUST conform to the response-type ABNF.


     response-type  = response-name *( SP response-name )
     response-name  = 1*response-char
     response-char  = "_" / DIGIT / ALPHA


   If a response type contains one or more space characters (%x20), it
   is compared as a space-delimited list of values in which the order of
   values does not matter.  Only one order of values can be registered,
   which covers all other arrangements of the same set of values.

   For example, the response type "token code" is left undefined by this



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 47]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-48" id="page-48" href="#page-48" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   specification.  However, an extension can define and register the
   "token code" response type.  Once registered, the same combination
   cannot be registered as "code token", but both values can be used to
   denote the same response type.

<span class="h3"><a class="selflink" name="section-8.5" href="#section-8.5">8.5</a>.  Defining Additional Error Codes</span>

   In cases where protocol extensions (i.e. access token types,
   extension parameters, or extension grant types) require additional
   error codes to be used with the authorization code grant error
   response (<a href="#section-4.1.2.1">Section 4.1.2.1</a>), the implicit grant error response
   (<a href="#section-4.2.2.1">Section 4.2.2.1</a>), the token error response (<a href="#section-5.2">Section 5.2</a>), or the
   resource access error response (<a href="#section-7.2">Section 7.2</a>), such error codes MAY be
   defined.

   Extension error codes MUST be registered (following the procedures in
   <a href="#section-11.4">Section 11.4</a>) if the extension they are used in conjunction with is a
   registered access token type, a registered endpoint parameter, or an
   extension grant type.  Error codes used with unregistered extensions
   MAY be registered.

   Error codes MUST conform to the error ABNF, and SHOULD be prefixed by
   an identifying name when possible.  For example, an error identifying
   an invalid value set to the extension parameter "example" SHOULD be
   named "example_invalid".


     error      = 1*error-char
     error-char = %x20-21 / %x23-5B / %x5D-7E



<span class="h2"><a class="selflink" name="section-9" href="#section-9">9</a>.  Native Applications</span>

   Native applications are clients installed and executed on the device
   used by the resource owner (i.e. desktop application, native mobile
   application).  Native applications require special consideration
   related to security, platform capabilities, and overall end-user
   experience.

   The authorization endpoint requires interaction between the client
   and the resource owner's user-agent.  Native applications can invoke
   an external user-agent or embed a user-agent within the application.
   For example:

   o  External user-agent - the native application can capture the
      response from the authorization server using a redirection URI
      with a scheme registered with the operating system to invoke the



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 48]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-49" id="page-49" href="#page-49" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


      client as the handler, manual copy-and-paste of the credentials,
      running a local web server, installing a user-agent extension, or
      by providing a redirection URI identifying a server-hosted
      resource under the client's control, which in turn makes the
      response available to the native application.
   o  Embedded user-agent - the native application obtains the response
      by directly communicating with the embedded user-agent by
      monitoring state changes emitted during the resource load, or
      accessing the user-agent's cookies storage.

   When choosing between an external or embedded user-agent, developers
   should consider:

   o  An External user-agent may improve completion rate as the resource
      owner may already have an active session with the authorization
      server removing the need to re-authenticate.  It provides a
      familiar end-user experience and functionality.  The resource
      owner may also rely on user-agent features or extensions to assist
      with authentication (e.g. password manager, 2-factor device
      reader).
   o  An embedded user-agent may offer improved usability, as it removes
      the need to switch context and open new windows.
   o  An embedded user-agent poses a security challenge because resource
      owners are authenticating in an unidentified window without access
      to the visual protections found in most external user-agents.  An
      embedded user-agent educates end-users to trust unidentified
      requests for authentication (making phishing attacks easier to
      execute).

   When choosing between the implicit grant type and the authorization
   code grant type, the following should be considered:

   o  Native applications that use the authorization code grant type
      SHOULD do so without using client credentials, due to the native
      application's inability to keep client credentials confidential.
   o  When using the implicit grant type flow a refresh token is not
      returned which requires repeating the authorization process once
      the access token expires.


<span class="h2"><a class="selflink" name="section-10" href="#section-10">10</a>.  Security Considerations</span>

   As a flexible and extensible framework, OAuth's security
   considerations depend on many factors.  The following sections
   provide implementers with security guidelines focused on the three
   client profiles described in <a href="#section-2.1">Section 2.1</a>: web application, user-
   agent-based application, and native application.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 49]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-50" id="page-50" href="#page-50" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   A comprehensive OAuth security model and analysis, as well as
   background for the protocol design, is provided by
   [<a href="#ref-I-D.ietf-oauth-v2-threatmodel">I-D.ietf-oauth-v2-threatmodel</a>].

<span class="h3"><a class="selflink" name="section-10.1" href="#section-10.1">10.1</a>.  Client Authentication</span>

   The authorization server establishes client credentials with web
   application clients for the purpose of client authentication.  The
   authorization server is encouraged to consider stronger client
   authentication means than a client password.  Web application clients
   MUST ensure confidentiality of client passwords and other client
   credentials.

   The authorization server MUST NOT issue client passwords or other
   client credentials to native application or user-agent-based
   application clients for the purpose of client authentication.  The
   authorization server MAY issue a client password or other credentials
   for a specific installation of a native application client on a
   specific device.

   When client authentication is not possible, the authorization server
   SHOULD employ other means to validate the client's identity.  For
   example, by requiring the registration of the client redirection URI
   or enlisting the resource owner to confirm identity.  A valid
   redirection URI is not sufficient to verify the client's identity
   when asking for resource owner authorization, but can be used to
   prevent delivering credentials to a counterfeit client after
   obtaining resource owner authorization.

   The authorization server must consider the security implications of
   interacting with unauthenticated clients and take measures to limit
   the potential exposure of other credentials (e.g. refresh tokens)
   issued to such clients.

<span class="h3"><a class="selflink" name="section-10.2" href="#section-10.2">10.2</a>.  Client Impersonation</span>

   A malicious client can impersonate another client and obtain access
   to protected resources, if the impersonated client fails to, or is
   unable to, keep its client credentials confidential.

   The authorization server MUST authenticate the client whenever
   possible.  If the authorization server cannot authenticate the client
   due to the client's nature, the authorization server MUST require the
   registration of any redirection URI used for receiving authorization
   responses, and SHOULD utilize other means to protect resource owners
   from such potentially malicious clients.  For example, the
   authorization server can engage the resource owner to assist in
   identifying the client and its origin.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 50]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-51" id="page-51" href="#page-51" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   The authorization server SHOULD enforce explicit resource owner
   authentication and provide the resource owner with information about
   the client and the requested authorization scope and lifetime.  It is
   up to the resource owner to review the information in the context of
   the current client, and authorize or deny the request.

   The authorization server SHOULD NOT process repeated authorization
   requests automatically (without active resource owner interaction)
   without authenticating the client or relying on other measures to
   ensure the repeated request comes from the original client and not an
   impersonator.

<span class="h3"><a class="selflink" name="section-10.3" href="#section-10.3">10.3</a>.  Access Tokens</span>

   Access token credentials (as well as any confidential access token
   attributes) MUST be kept confidential in transit and storage, and
   only shared among the authorization server, the resource servers the
   access token is valid for, and the client to whom the access token is
   issued.  Access token credentials MUST only be transmitted using TLS
   as described in <a href="#section-1.6">Section 1.6</a> with server authentication as defined by
   [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>].

   When using the implicit grant type, the access token is transmitted
   in the URI fragment, which can expose it to unauthorized parties.

   The authorization server MUST ensure that access tokens cannot be
   generated, modified, or guessed to produce valid access tokens by
   unauthorized parties.

   The client SHOULD request access tokens with the minimal scope
   necessary.  The authorization server SHOULD take the client identity
   into account when choosing how to honor the requested scope, and MAY
   issue an access token with a less rights than requested.

   This specification does not provide any methods for the resource
   server to ensure that an access token presented to it by a given
   client was issued to that client by the authorization server.

<span class="h3"><a class="selflink" name="section-10.4" href="#section-10.4">10.4</a>.  Refresh Tokens</span>

   Authorization servers MAY issue refresh tokens to web application
   clients and native application clients.

   Refresh tokens MUST be kept confidential in transit and storage, and
   shared only among the authorization server and the client to whom the
   refresh tokens were issued.  The authorization server MUST maintain
   the binding between a refresh token and the client to whom it was
   issued.  Refresh tokens MUST only be transmitted using TLS as



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 51]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-52" id="page-52" href="#page-52" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   described in <a href="#section-1.6">Section 1.6</a> with server authentication as defined by
   [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>].

   The authorization server MUST verify the binding between the refresh
   token and client identity whenever the client identity can be
   authenticated.  When client authentication is not possible, the
   authorization server SHOULD deploy other means to detect refresh
   token abuse.

   For example, the authorization server could employ refresh token
   rotation in which a new refresh token is issued with every access
   token refresh response.  The previous refresh token is invalidated
   but retained by the authorization server.  If a refresh token is
   compromised and subsequently used by both the attacker and the
   legitimate client, one of them will present an invalidated refresh
   token which will inform the authorization server of the breach.

   The authorization server MUST ensure that refresh tokens cannot be
   generated, modified, or guessed to produce valid refresh tokens by
   unauthorized parties.

<span class="h3"><a class="selflink" name="section-10.5" href="#section-10.5">10.5</a>.  Authorization Codes</span>

   The transmission of authorization codes SHOULD be made over a secure
   channel, and the client SHOULD require the use of TLS with its
   redirection URI if the URI identifies a network resource.  Since
   authorization codes are transmitted via user-agent redirections, they
   could potentially be disclosed through user-agent history and HTTP
   referrer headers.

   Authorization codes operate as plaintext bearer credentials, used to
   verify that the resource owner who granted authorization at the
   authorization server is the same resource owner returning to the
   client to complete the process.  Therefore, if the client relies on
   the authorization code for its own resource owner authentication, the
   client redirection endpoint MUST require the use of TLS.

   Authorization codes MUST be short lived and single use.  If the
   authorization server observes multiple attempts to exchange an
   authorization code for an access token, the authorization server
   SHOULD attempt to revoke all access tokens already granted based on
   the compromised authorization code.

   If the client can be authenticated, the authorization servers MUST
   authenticate the client and ensure that the authorization code was
   issued to the same client.





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 52]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-53" id="page-53" href="#page-53" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-10.6" href="#section-10.6">10.6</a>.  Authorization Code Redirection URI Manipulation</span>

   When requesting authorization using the authorization code grant
   type, the client can specify a redirection URI via the "redirect_uri"
   parameter.  If an attacker can manipulate the value of the
   redirection URI, it can cause the authorization server to redirect
   the resource owner user-agent to a URI under the control of the
   attacker with the authorization code.

   An attacker can create an account at a legitimate client and initiate
   the authorization flow.  When the attacker's user-agent is sent to
   the authorization server to grant access, the attacker grabs the
   authorization URI provided by the legitimate client, and replaces the
   client's redirection URI with a URI under the control of the
   attacker.  The attacker then tricks the victim into following the
   manipulated link to authorize access to the legitimate client.

   Once at the authorization server, the victim is prompted with a
   normal, valid request on behalf of a legitimate and trusted client,
   and authorizes the request.  The victim is then redirected to an
   endpoint under the control of the attacker with the authorization
   code.  The attacker completes the authorization flow by sending the
   authorization code to the client using the original redirection URI
   provided by the client.  The client exchanges the authorization code
   with an access token and links it to the attacker's client account
   which can now gain access to the protected resources authorized by
   the victim (via the client).

   In order to prevent such an attack, the authorization server MUST
   ensure that the redirection URI used to obtain the authorization code
   is identical to the redirection URI provided when exchanging the
   authorization code for an access token.  The authorization server
   MUST require public clients and SHOULD require confidential clients
   to register their redirection URIs.  If a redirection URI is provided
   in the request, the authorization server MUST validate it against the
   registered value.

<span class="h3"><a class="selflink" name="section-10.7" href="#section-10.7">10.7</a>.  Resource Owner Password Credentials</span>

   The resource owner password credentials grant type is often used for
   legacy or migration reasons.  It reduces the overall risk of storing
   username and password by the client, but does not eliminate the need
   to expose highly privileged credentials to the client.

   This grant type carries a higher risk than other grant types because
   it maintains the password anti-pattern this protocol seeks to avoid.
   The client could abuse the password or the password could
   unintentionally be disclosed to an attacker (e.g. via log files or



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 53]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-54" id="page-54" href="#page-54" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   other records kept by the client).

   Additionally, because the resource owner does not have control over
   the authorization process (the resource owner involvement ends when
   it hands over its credentials to the client), the client can obtain
   access tokens with a broader scope than desired by the resource
   owner.  The authorization server should consider the scope and
   lifetime of access tokens issued via this grant type.

   The authorization server and client SHOULD minimize use of this grant
   type and utilize other grant types whenever possible.

<span class="h3"><a class="selflink" name="section-10.8" href="#section-10.8">10.8</a>.  Request Confidentiality</span>

   Access tokens, refresh tokens, resource owner passwords, and client
   credentials MUST NOT be transmitted in the clear.  Authorization
   codes SHOULD NOT be transmitted in the clear.

   The "state" and "scope" parameters SHOULD NOT include sensitive
   client or resource owner information in plain text as they can be
   transmitted over insecure channels or stored insecurely.

<span class="h3"><a class="selflink" name="section-10.9" href="#section-10.9">10.9</a>.  Endpoints Authenticity</span>

   In order to prevent man-in-the-middle attacks, the authorization
   server MUST require the use of TLS with server authentication as
   defined by [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>] for any request sent to the authorization and
   token endpoints.  The client MUST validate the authorization server's
   TLS certificate as defined by [<a href="./rfc6125" title="&quot;Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)&quot;">RFC6125</a>], and in accordance with its
   requirements for server identity authentication.

<span class="h3"><a class="selflink" name="section-10.10" href="#section-10.10">10.10</a>.  Credentials Guessing Attacks</span>

   The authorization server MUST prevent attackers from guessing access
   tokens, authorization codes, refresh tokens, resource owner
   passwords, and client credentials.

   The probability of an attacker guessing generated tokens (and other
   credentials not intended for handling by end-users) MUST be less than
   or equal to 2^(-128) and SHOULD be less than or equal to 2^(-160).

   The authorization server MUST utilize other means to protect
   credentials intended for end-user usage.

<span class="h3"><a class="selflink" name="section-10.11" href="#section-10.11">10.11</a>.  Phishing Attacks</span>

   Wide deployment of this and similar protocols may cause end-users to
   become inured to the practice of being redirected to websites where



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 54]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-55" id="page-55" href="#page-55" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   they are asked to enter their passwords.  If end-users are not
   careful to verify the authenticity of these websites before entering
   their credentials, it will be possible for attackers to exploit this
   practice to steal resource owners' passwords.

   Service providers should attempt to educate end-users about the risks
   phishing attacks pose, and should provide mechanisms that make it
   easy for end-users to confirm the authenticity of their sites.
   Client developers should consider the security implications of how
   they interact with the user-agent (e.g., external, embedded), and the
   ability of the end-user to verify the authenticity of the
   authorization server.

   To reduce the risk of phishing attacks, the authorization servers
   MUST require the use of TLS on every endpoint used for end-user
   interaction.

<span class="h3"><a class="selflink" name="section-10.12" href="#section-10.12">10.12</a>.  Cross-Site Request Forgery</span>

   Cross-site request forgery (CSRF) is an exploit in which an attacker
   causes the user-agent of a victim end-user to follow a malicious URI
   (e.g. provided to the user-agent as a misleading link, image, or
   redirection) to a trusting server (usually established via the
   presence of a valid session cookie).

   A CSRF attack against the client's redirection URI allows an attacker
   to inject their own authorization code or access token, which can
   result in the client using an access token associated with the
   attacker's protected resources rather than the victim's (e.g. save
   the victim's bank account information to a protected resource
   controlled by the attacker).

   The client MUST implement CSRF protection for its redirection URI.
   This is typically accomplished by requiring any request sent to the
   redirection URI endpoint to include a value that binds the request to
   the user-agent's authenticated state (e.g. a hash of the session
   cookie used to authenticate the user-agent).  The client SHOULD
   utilize the "state" request parameter to deliver this value to the
   authorization server when making an authorization request.

   Once authorization has been obtained from the end-user, the
   authorization server redirects the end-user's user-agent back to the
   client with the required binding value contained in the "state"
   parameter.  The binding value enables the client to verify the
   validity of the request by matching the binding value to the user-
   agent's authenticated state.  The binding value used for CSRF
   protection MUST contain a non-guessable value (as described in
   <a href="#section-10.10">Section 10.10</a>), and the user-agent's authenticated state (e.g.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 55]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-56" id="page-56" href="#page-56" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   session cookie, HTML5 local storage) MUST be kept in a location
   accessible only to the client and the user-agent (i.e., protected by
   same-origin policy).

   A CSRF attack against the authorization server's authorization
   endpoint can result in an attacker obtaining end-user authorization
   for a malicious client without involving or alerting the end-user.

   The authorization server MUST implement CSRF protection for its
   authorization endpoint, and ensure that a malicious client cannot
   obtain authorization without the awareness and explicit consent of
   the resource owner.

<span class="h3"><a class="selflink" name="section-10.13" href="#section-10.13">10.13</a>.  Clickjacking</span>

   In a clickjacking attack, an attacker registers a legitimate client
   and then constructs a malicious site in which it loads the
   authorization server's authorization endpoint web page in a
   transparent iframe overlaid on top of a set of dummy buttons which
   are carefully constructed to be placed directly under important
   buttons on the authorization page.  When an end-user clicks a
   misleading visible button, the end-user is actually clicking an
   invisible button on the authorization page (such as an "Authorize"
   button).  This allows an attacker to trick a resource owner into
   granting its client access without their knowledge.

   To prevent this form of attack, native applications SHOULD use
   external browsers instead of embedding browsers within the
   application when requesting end-user authorization.  For most newer
   browsers, avoidance of iframes can be enforced by the authorization
   server using the (non-standard) "x-frame-options" header.  This
   header can have two values, "deny" and "sameorigin", which will block
   any framing, or framing by sites with a different origin,
   respectively.  For older browsers, JavaScript framebusting techniques
   can be used but may not be effective in all browsers.

<span class="h3"><a class="selflink" name="section-10.14" href="#section-10.14">10.14</a>.  Code Injection and Input Validation</span>

   A code injection attack occurs when an input or otherwise external
   variable is used by an application unsanitized and causes
   modification to the application logic.  This may allow an attacker to
   gain access to the application device or its data, cause denial of
   service, or a wide range of malicious side-effects.

   The Authorization server and client MUST sanitize (and validate when
   possible) any value received, in particular, the value of the "state"
   and "redirect_uri" parameters.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 56]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-57" id="page-57" href="#page-57" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h3"><a class="selflink" name="section-10.15" href="#section-10.15">10.15</a>.  Open Redirectors</span>

   The authorization server authorization endpoint and the client
   redirection endpoint can be improperly configured and operate as open
   redirectors.  An open redirector is an endpoint using a parameter to
   automatically redirect a user-agent to the location specified by the
   parameter value without any validation.

   Open redirectors can be used in phishing attacks, or by an attacker
   to get end-users to visit malicious sites by making the URI's
   authority look like a familiar and trusted destination.  In addition,
   if the authorization server allows the client to register only part
   of the redirection URI, an attacker can use an open redirector
   operated by the client to construct a redirection URI that will pass
   the authorization server validation but will send the authorization
   code or access token to an endpoint under the control of the
   attacker.


<span class="h2"><a class="selflink" name="section-11" href="#section-11">11</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" name="section-11.1" href="#section-11.1">11.1</a>.  The OAuth Access Token Type Registry</span>

   This specification establishes the OAuth access token type registry.

   Access token types are registered with a Specification Required
   ([<a href="./rfc5226" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>]) after a two week review period on the [TBD]@ietf.org
   mailing list, on the advice of one or more Designated Experts.
   However, to allow for the allocation of values prior to publication,
   the Designated Expert(s) may approve registration once they are
   satisfied that such a specification will be published.

   Registration requests must be sent to the [TBD]@ietf.org mailing list
   for review and comment, with an appropriate subject (e.g., "Request
   for access token type: example"). [[ Note to RFC-EDITOR: The name of
   the mailing list should be determined in consultation with the IESG
   and IANA.  Suggested name: oauth-ext-review. ]]

   Within the review period, the Designated Expert(s) will either
   approve or deny the registration request, communicating this decision
   to the review list and IANA.  Denials should include an explanation
   and, if applicable, suggestions as to how to make the request
   successful.

   IANA must only accept registry updates from the Designated Expert(s),
   and should direct all requests for registration to the review mailing
   list.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 57]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-58" id="page-58" href="#page-58" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h4"><a class="selflink" name="section-11.1.1" href="#section-11.1.1">11.1.1</a>.  Registration Template</span>

   Type name:
      The name requested (e.g., "example").
   Additional Token Endpoint Response Parameters:
      Additional response parameters returned together with the
      "access_token" parameter.  New parameters MUST be separately
      registered in the OAuth parameters registry as described by
      <a href="#section-11.2">Section 11.2</a>.
   HTTP Authentication Scheme(s):
      The HTTP authentication scheme name(s), if any, used to
      authenticate protected resources requests using access tokens of
      this type.
   Change controller:
      For standards-track RFCs, state "IETF".  For others, give the name
      of the responsible party.  Other details (e.g., postal address,
      e-mail address, home page URI) may also be included.
   Specification document(s):
      Reference to the document that specifies the parameter, preferably
      including a URI that can be used to retrieve a copy of the
      document.  An indication of the relevant sections may also be
      included, but is not required.

<span class="h3"><a class="selflink" name="section-11.2" href="#section-11.2">11.2</a>.  The OAuth Parameters Registry</span>

   This specification establishes the OAuth parameters registry.

   Additional parameters for inclusion in the authorization endpoint
   request, the authorization endpoint response, the token endpoint
   request, or the token endpoint response are registered with a
   Specification Required ([<a href="./rfc5226" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>]) after a two week review period on
   the [TBD]@ietf.org mailing list, on the advice of one or more
   Designated Experts.  However, to allow for the allocation of values
   prior to publication, the Designated Expert(s) may approve
   registration once they are satisfied that such a specification will
   be published.

   Registration requests must be sent to the [TBD]@ietf.org mailing list
   for review and comment, with an appropriate subject (e.g., "Request
   for parameter: example"). [[ Note to RFC-EDITOR: The name of the
   mailing list should be determined in consultation with the IESG and
   IANA.  Suggested name: oauth-ext-review. ]]

   Within the review period, the Designated Expert(s) will either
   approve or deny the registration request, communicating this decision
   to the review list and IANA.  Denials should include an explanation
   and, if applicable, suggestions as to how to make the request
   successful.



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 58]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-59" id="page-59" href="#page-59" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   IANA must only accept registry updates from the Designated Expert(s),
   and should direct all requests for registration to the review mailing
   list.

<span class="h4"><a class="selflink" name="section-11.2.1" href="#section-11.2.1">11.2.1</a>.  Registration Template</span>

   Parameter name:
      The name requested (e.g., "example").
   Parameter usage location:
      The location(s) where parameter can be used.  The possible
      locations are: authorization request, authorization response,
      token request, or token response.
   Change controller:
      For standards-track RFCs, state "IETF".  For others, give the name
      of the responsible party.  Other details (e.g., postal address,
      e-mail address, home page URI) may also be included.
   Specification document(s):
      Reference to the document that specifies the parameter, preferably
      including a URI that can be used to retrieve a copy of the
      document.  An indication of the relevant sections may also be
      included, but is not required.

<span class="h4"><a class="selflink" name="section-11.2.2" href="#section-11.2.2">11.2.2</a>.  Initial Registry Contents</span>

   The OAuth Parameters Registry's initial contents are:

   o  Parameter name: client_id
   o  Parameter usage location: authorization request, token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: client_secret
   o  Parameter usage location: token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: response_type
   o  Parameter usage location: authorization request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: redirect_uri
   o  Parameter usage location: authorization request, token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 59]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-60" id="page-60" href="#page-60" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   o  Parameter name: scope
   o  Parameter usage location: authorization request, authorization
      response, token request, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: state
   o  Parameter usage location: authorization request, authorization
      response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: code
   o  Parameter usage location: authorization response, token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: error_description
   o  Parameter usage location: authorization response, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: error_uri
   o  Parameter usage location: authorization response, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: grant_type
   o  Parameter usage location: token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: access_token
   o  Parameter usage location: authorization response, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: token_type
   o  Parameter usage location: authorization response, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: expires_in
   o  Parameter usage location: authorization response, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 60]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-61" id="page-61" href="#page-61" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   o  Parameter name: username
   o  Parameter usage location: token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: password
   o  Parameter usage location: token request
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Parameter name: refresh_token
   o  Parameter usage location: token request, token response
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

<span class="h3"><a class="selflink" name="section-11.3" href="#section-11.3">11.3</a>.  The OAuth Authorization Endpoint Response Type Registry</span>

   This specification establishes the OAuth authorization endpoint
   response type registry.

   Additional response type for use with the authorization endpoint are
   registered with a Specification Required ([<a href="./rfc5226" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>]) after a two week
   review period on the [TBD]@ietf.org mailing list, on the advice of
   one or more Designated Experts.  However, to allow for the allocation
   of values prior to publication, the Designated Expert(s) may approve
   registration once they are satisfied that such a specification will
   be published.

   Registration requests must be sent to the [TBD]@ietf.org mailing list
   for review and comment, with an appropriate subject (e.g., "Request
   for response type: example"). [[ Note to RFC-EDITOR: The name of the
   mailing list should be determined in consultation with the IESG and
   IANA.  Suggested name: oauth-ext-review. ]]

   Within the review period, the Designated Expert(s) will either
   approve or deny the registration request, communicating this decision
   to the review list and IANA.  Denials should include an explanation
   and, if applicable, suggestions as to how to make the request
   successful.

   IANA must only accept registry updates from the Designated Expert(s),
   and should direct all requests for registration to the review mailing
   list.

<span class="h4"><a class="selflink" name="section-11.3.1" href="#section-11.3.1">11.3.1</a>.  Registration Template</span>






<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 61]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-62" id="page-62" href="#page-62" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   Response type name:
      The name requested (e.g., "example").
   Change controller:
      For standards-track RFCs, state "IETF".  For others, give the name
      of the responsible party.  Other details (e.g., postal address,
      e-mail address, home page URI) may also be included.
   Specification document(s):
      Reference to the document that specifies the type, preferably
      including a URI that can be used to retrieve a copy of the
      document.  An indication of the relevant sections may also be
      included, but is not required.

<span class="h4"><a class="selflink" name="section-11.3.2" href="#section-11.3.2">11.3.2</a>.  Initial Registry Contents</span>

   The OAuth Authorization Endpoint Response Type Registry's initial
   contents are:

   o  Response type name: code
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

   o  Response type name: token
   o  Change controller: IETF
   o  Specification document(s): [[ this document ]]

<span class="h3"><a class="selflink" name="section-11.4" href="#section-11.4">11.4</a>.  The OAuth Extensions Error Registry</span>

   This specification establishes the OAuth extensions error registry.

   Additional error codes used together with other protocol extensions
   (i.e. extension grant types, access token types, or extension
   parameters) are registered with a Specification Required ([<a href="./rfc5226" title="&quot;Guidelines for Writing an IANA Considerations Section in RFCs&quot;">RFC5226</a>])
   after a two week review period on the [TBD]@ietf.org mailing list, on
   the advice of one or more Designated Experts.  However, to allow for
   the allocation of values prior to publication, the Designated
   Expert(s) may approve registration once they are satisfied that such
   a specification will be published.

   Registration requests must be sent to the [TBD]@ietf.org mailing list
   for review and comment, with an appropriate subject (e.g., "Request
   for error code: example"). [[ Note to RFC-EDITOR: The name of the
   mailing list should be determined in consultation with the IESG and
   IANA.  Suggested name: oauth-ext-review. ]]

   Within the review period, the Designated Expert(s) will either
   approve or deny the registration request, communicating this decision
   to the review list and IANA.  Denials should include an explanation
   and, if applicable, suggestions as to how to make the request



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 62]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-63" id="page-63" href="#page-63" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   successful.

   IANA must only accept registry updates from the Designated Expert(s),
   and should direct all requests for registration to the review mailing
   list.

<span class="h4"><a class="selflink" name="section-11.4.1" href="#section-11.4.1">11.4.1</a>.  Registration Template</span>

   Error name:
      The name requested (e.g., "example").  Values for the error name
      MUST NOT include characters outside the set %x20-21 / %x23-5B /
      %x5D-7E.
   Error usage location:
      The location(s) where the error can be used.  The possible
      locations are: authorization code grant error response
      (<a href="#section-4.1.2.1">Section 4.1.2.1</a>), implicit grant error response
      (<a href="#section-4.2.2.1">Section 4.2.2.1</a>), token error response (<a href="#section-5.2">Section 5.2</a>), or resource
      access error response (<a href="#section-7.2">Section 7.2</a>).
   Related protocol extension:
      The name of the extension grant type, access token type, or
      extension parameter, the error code is used in conjunction with.
   Change controller:
      For standards-track RFCs, state "IETF".  For others, give the name
      of the responsible party.  Other details (e.g., postal address,
      e-mail address, home page URI) may also be included.
   Specification document(s):
      Reference to the document that specifies the error code,
      preferably including a URI that can be used to retrieve a copy of
      the document.  An indication of the relevant sections may also be
      included, but is not required.


<span class="h2"><a class="selflink" name="section-12" href="#section-12">12</a>.  References</span>

<span class="h3"><a class="selflink" name="section-12.1" href="#section-12.1">12.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2246" id="ref-RFC2246">RFC2246</a>]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              <a href="./rfc2246">RFC 2246</a>, January 1999.

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a name="ref-RFC2617" id="ref-RFC2617">RFC2617</a>]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
              Leach, P., Luotonen, A., and L. Stewart, "HTTP



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 63]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-64" id="page-64" href="#page-64" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


              Authentication: Basic and Digest Access Authentication",
              <a href="./rfc2617">RFC 2617</a>, June 1999.

   [<a name="ref-RFC2818" id="ref-RFC2818">RFC2818</a>]  Rescorla, E., "HTTP Over TLS", <a href="./rfc2818">RFC 2818</a>, May 2000.

   [<a name="ref-RFC3986" id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="./rfc3986">RFC 3986</a>, January 2005.

   [<a name="ref-RFC4627" id="ref-RFC4627">RFC4627</a>]  Crockford, D., "The application/json Media Type for
              JavaScript Object Notation (JSON)", <a href="./rfc4627">RFC 4627</a>, July 2006.

   [<a name="ref-RFC4949" id="ref-RFC4949">RFC4949</a>]  Shirey, R., "Internet Security Glossary, Version 2",
              <a href="./rfc4949">RFC 4949</a>, August 2007.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="./bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
              May 2008.

   [<a name="ref-RFC5234" id="ref-RFC5234">RFC5234</a>]  Crocker, D. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>, January 2008.

   [<a name="ref-RFC5246" id="ref-RFC5246">RFC5246</a>]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", <a href="./rfc5246">RFC 5246</a>, August 2008.

   [<a name="ref-RFC6125" id="ref-RFC6125">RFC6125</a>]  Saint-Andre, P. and J. Hodges, "Representation and
              Verification of Domain-Based Application Service Identity
              within Internet Public Key Infrastructure Using X.509
              (PKIX) Certificates in the Context of Transport Layer
              Security (TLS)", <a href="./rfc6125">RFC 6125</a>, March 2011.

   [<a name="ref-USASCII" id="ref-USASCII">USASCII</a>]  American National Standards Institute, "Coded Character
              Set -- 7-bit American Standard Code for Information
              Interchange", ANSI X3.4, 1986.

   [<a name="ref-W3C.REC-html401-19991224" id="ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]
              Hors, A., Raggett, D., and I. Jacobs, "HTML 4.01
              Specification", World Wide Web Consortium
              Recommendation REC-html401-19991224, December 1999,
              &lt;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.

<span class="h3"><a class="selflink" name="section-12.2" href="#section-12.2">12.2</a>.  Informative References</span>

   [I-D.<a href="./draft-hardt-oauth-01">draft-hardt-oauth-01</a>]
              Hardt, D., Ed., Tom, A., Eaton, B., and Y. Goland, "OAuth
              Web Resource Authorization Profiles", January 2010.

   [<a name="ref-I-D.ietf-httpbis-p7-auth" id="ref-I-D.ietf-httpbis-p7-auth">I-D.ietf-httpbis-p7-auth</a>]



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 64]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-65" id="page-65" href="#page-65" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


              Fielding, R., Lafon, Y., and J. Reschke, "HTTP/1.1, part
              7: Authentication", <a href="./draft-ietf-httpbis-p7-auth-19">draft-ietf-httpbis-p7-auth-19</a> (work in
              progress), March 2012.

   [<a name="ref-I-D.ietf-oauth-saml2-bearer" id="ref-I-D.ietf-oauth-saml2-bearer">I-D.ietf-oauth-saml2-bearer</a>]
              Mortimore, C., "SAML 2.0 Bearer Assertion Profiles for
              OAuth 2.0", <a href="./draft-ietf-oauth-saml2-bearer-12">draft-ietf-oauth-saml2-bearer-12</a> (work in
              progress), May 2012.

   [<a name="ref-I-D.ietf-oauth-v2-bearer" id="ref-I-D.ietf-oauth-v2-bearer">I-D.ietf-oauth-v2-bearer</a>]
              Jones, M., Hardt, D., and D. Recordon, "The OAuth 2.0
              Authorization Framework: Bearer Token Usage",
              <a href="./draft-ietf-oauth-v2-bearer-20">draft-ietf-oauth-v2-bearer-20</a> (work in progress),
              June 2012.

   [<a name="ref-I-D.ietf-oauth-v2-http-mac" id="ref-I-D.ietf-oauth-v2-http-mac">I-D.ietf-oauth-v2-http-mac</a>]
              Hammer-Lahav, E., "HTTP Authentication: MAC Access
              Authentication", <a href="./draft-ietf-oauth-v2-http-mac-01">draft-ietf-oauth-v2-http-mac-01</a> (work in
              progress), February 2012.

   [<a name="ref-I-D.ietf-oauth-v2-threatmodel" id="ref-I-D.ietf-oauth-v2-threatmodel">I-D.ietf-oauth-v2-threatmodel</a>]
              Lodderstedt, T., McGloin, M., and P. Hunt, "OAuth 2.0
              Threat Model and Security Considerations",
              <a href="./draft-ietf-oauth-v2-threatmodel-05">draft-ietf-oauth-v2-threatmodel-05</a> (work in progress),
              May 2012.

   [<a name="ref-RFC5849" id="ref-RFC5849">RFC5849</a>]  Hammer-Lahav, E., "The OAuth 1.0 Protocol", <a href="./rfc5849">RFC 5849</a>,
              April 2010.


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Augmented Backus-Naur Form (ABNF) Syntax</span>

   This section provides Augmented Backus-Naur Form (ABNF) syntax
   descriptions for the elements defined in this specification using the
   notation of [<a href="./rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>].  Elements are presented in the order first
   defined.

   Some of the definitions that follow use the "URI-reference"
   definition from [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>].

   Some of the definitions that follow use these common definitions:

VSCHAR     = %20-7E
NQCHAR     = %x21 / %x23-5B / %x5D-7E
NQSCHAR    = %x20-21 / %x23-5B / %x5D-7E
UNICODENOCTRLCHAR = &lt;Any Unicode character other than ( %x0-1F / %x7F )&gt;





<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 65]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-66" id="page-66" href="#page-66" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h1"><a class="selflink" name="appendix-A.1" href="#appendix-A.1">A.1</a>.  "client_id" Syntax</span>

   The "client_id" element is defined in <a href="#section-2.3.1">Section 2.3.1</a>:

   client-id     = *VSCHAR

<span class="h1"><a class="selflink" name="appendix-A.2" href="#appendix-A.2">A.2</a>.  "client_secret" Syntax</span>

   The "client_secret" element is defined in <a href="#section-2.3.1">Section 2.3.1</a>:

   client-secret = *VSCHAR

<span class="h1"><a class="selflink" name="appendix-A.3" href="#appendix-A.3">A.3</a>.  "response_type" Syntax</span>

   The "response_type" element is defined in <a href="#section-3.1.1">Section 3.1.1</a> and
   <a href="#section-8.4">Section 8.4</a>:

   response-type = response-name *( SP response-name )
   response-name = 1*response-char
   response-char = "_" / DIGIT / ALPHA

<span class="h1"><a class="selflink" name="appendix-A.4" href="#appendix-A.4">A.4</a>.  "scope" Syntax</span>

   The "scope" element is defined in <a href="#section-3.3">Section 3.3</a>:

   scope       = scope-token *( SP scope-token )
   scope-token = 1*NQCHAR

<span class="h1"><a class="selflink" name="appendix-A.5" href="#appendix-A.5">A.5</a>.  "state" Syntax</span>

   The "state" element is defined in <a href="#section-4.1.1">Section 4.1.1</a>, <a href="#section-4.1.2">Section 4.1.2</a>,
   <a href="#section-4.1.2.1">Section 4.1.2.1</a>, <a href="#section-4.2.1">Section 4.2.1</a>, <a href="#section-4.2.2">Section 4.2.2</a>, and <a href="#section-4.2.2.1">Section 4.2.2.1</a>:

   state      = 1*VSCHAR

<span class="h1"><a class="selflink" name="appendix-A.6" href="#appendix-A.6">A.6</a>.  "redirect_uri" Syntax</span>

   The "redirect_uri" element is defined in <a href="#section-4.1.1">Section 4.1.1</a>,
   <a href="#section-4.1.3">Section 4.1.3</a>, and <a href="#section-4.2.1">Section 4.2.1</a>:

   redirect-uri      = URI-reference










<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 66]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-67" id="page-67" href="#page-67" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h1"><a class="selflink" name="appendix-A.7" href="#appendix-A.7">A.7</a>.  "error" Syntax</span>

   The "error" element is defined in <a href="#section-4.1.2.1">Section 4.1.2.1</a>, <a href="#section-4.2.2.1">Section 4.2.2.1</a>,
   <a href="#section-5.2">Section 5.2</a>, <a href="#section-7.2">Section 7.2</a>, and <a href="#section-8.5">Section 8.5</a>:

   error             = 1*NQSCHAR

<span class="h1"><a class="selflink" name="appendix-A.8" href="#appendix-A.8">A.8</a>.  "error_description" Syntax</span>

   The "error_description" element is defined in <a href="#section-4.1.2.1">Section 4.1.2.1</a>,
   <a href="#section-4.2.2.1">Section 4.2.2.1</a>, <a href="#section-5.2">Section 5.2</a>, and <a href="#section-7.2">Section 7.2</a>:

   error-description = 1*NQSCHAR

<span class="h1"><a class="selflink" name="appendix-A.9" href="#appendix-A.9">A.9</a>.  "error_uri" Syntax</span>

   The "error_uri" element is defined in <a href="#section-4.1.2.1">Section 4.1.2.1</a>,
   <a href="#section-4.2.2.1">Section 4.2.2.1</a>, <a href="#section-5.2">Section 5.2</a>, and <a href="#section-7.2">Section 7.2</a>:

   error-uri         = URI-reference

<span class="h1"><a class="selflink" name="appendix-A.10" href="#appendix-A.10">A.10</a>.  "grant_type" Syntax</span>

   The "grant_type" element is defined in <a href="#section-4.1.3">Section 4.1.3</a>, <a href="#section-4.3.2">Section 4.3.2</a>,
   <a href="#section-4.4.2">Section 4.4.2</a>, <a href="#section-6">Section 6</a>, and <a href="#section-4.5">Section 4.5</a>:

   grant-type = grant-name / URI-reference
   grant-name = 1*name-char
   name-char  = "-" / "." / "_" / DIGIT / ALPHA

<span class="h1"><a class="selflink" name="appendix-A.11" href="#appendix-A.11">A.11</a>.  "code" Syntax</span>

   The "code" element is defined in <a href="#section-4.1.3">Section 4.1.3</a>:

   code       = 1*VSCHAR

<span class="h1"><a class="selflink" name="appendix-A.12" href="#appendix-A.12">A.12</a>.  "access_token" Syntax</span>

   The "access_token" element is defined in <a href="#section-4.2.2">Section 4.2.2</a> and
   <a href="#section-5.1">Section 5.1</a>:

   access-token = 1*VSCHAR









<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 67]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-68" id="page-68" href="#page-68" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


<span class="h1"><a class="selflink" name="appendix-A.13" href="#appendix-A.13">A.13</a>.  "token_type" Syntax</span>

   The "token_type" element is defined in <a href="#section-4.2.2">Section 4.2.2</a>, <a href="#section-5.1">Section 5.1</a>,
   and <a href="#section-8.1">Section 8.1</a>:

   token-type = type-name / URI-reference
   type-name  = 1*name-char
   name-char  = "-" / "." / "_" / DIGIT / ALPHA

<span class="h1"><a class="selflink" name="appendix-A.14" href="#appendix-A.14">A.14</a>.  "expires_in" Syntax</span>

   The "expires_in" element is defined in <a href="#section-4.2.2">Section 4.2.2</a> and <a href="#section-5.1">Section 5.1</a>:

   expires-in = 1*DIGIT

<span class="h1"><a class="selflink" name="appendix-A.15" href="#appendix-A.15">A.15</a>.  "username" Syntax</span>

   The "username" element is defined in <a href="#section-4.3.2">Section 4.3.2</a>:

   username = *UNICODENOCTRLCHAR

<span class="h1"><a class="selflink" name="appendix-A.16" href="#appendix-A.16">A.16</a>.  "password" Syntax</span>

   The "password" element is defined in <a href="#section-4.3.2">Section 4.3.2</a>:

   password = *UNICODENOCTRLCHAR

<span class="h1"><a class="selflink" name="appendix-A.17" href="#appendix-A.17">A.17</a>.  "refresh_token" Syntax</span>

   The "refresh_token" element is defined in <a href="#section-5.1">Section 5.1</a> and <a href="#section-6">Section 6</a>:

   refresh-token = 1*VSCHAR

<span class="h1"><a class="selflink" name="appendix-A.18" href="#appendix-A.18">A.18</a>.  Endpoint Parameter Syntax</span>

   The syntax for new endpoint parameters is defined in <a href="#section-8.2">Section 8.2</a>:

   param-name = 1*name-char
   name-char  = "-" / "." / "_" / DIGIT / ALPHA


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Acknowledgements</span>

   The initial OAuth 2.0 protocol specification was edited by David
   Recordon, based on two previous publications: the OAuth 1.0 community
   specification [<a href="./rfc5849" title="&quot;The OAuth 1.0 Protocol&quot;">RFC5849</a>], and OAuth WRAP (OAuth Web Resource
   Authorization Profiles) [I-D.<a href="./draft-hardt-oauth-01">draft-hardt-oauth-01</a>].  The Security
   Considerations section was drafted by Torsten Lodderstedt, Mark



<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 68]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-69" id="page-69" href="#page-69" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   McGloin, Phil Hunt, and Anthony Nadalin.  The ABNF section was
   drafted by Michael B. Jones.

   The OAuth 1.0 community specification was edited by Eran Hammer and
   authored by Mark Atwood, Dirk Balfanz, Darren Bounds, Richard M.
   Conlan, Blaine Cook, Leah Culver, Breno de Medeiros, Brian Eaton,
   Kellan Elliott-McCrea, Larry Halff, Eran Hammer, Ben Laurie, Chris
   Messina, John Panzer, Sam Quigley, David Recordon, Eran Sandler,
   Jonathan Sergent, Todd Sieling, Brian Slesinsky, and Andy Smith.

   The OAuth WRAP specification was edited by Dick Hardt and authored by
   Brian Eaton, Yaron Y. Goland, Dick Hardt, and Allen Tom.

   This specification is the work of the OAuth Working Group which
   includes dozens of active and dedicated participants.  In particular,
   the following individuals contributed ideas, feedback, and wording
   which shaped and formed the final specification:

   Michael Adams, Amanda Anganes, Andrew Arnott, Dirk Balfanz, Aiden
   Bell, John Bradley, Brian Campbell, Scott Cantor, Marcos Caceres,
   Blaine Cook, Roger Crew, Brian Eaton, Wesley Eddy, Leah Culver, Bill
   de hOra, Andre DeMarre, Brian Eaton, Wolter Eldering, Brian Ellin,
   Igor Faynberg, George Fletcher, Tim Freeman, Luca Frosini, Evan
   Gilbert, Yaron Y. Goland, Brent Goldman, Kristoffer Gronowski, Justin
   Hart, Dick Hardt, Craig Heath, Phil Hunt, Michael B. Jones, Terry
   Jones, John Kemp, Mark Kent, Raffi Krikorian, Chasen Le Hara, Rasmus
   Lerdorf, Torsten Lodderstedt, Hui-Lan Lu, Casey Lucas, Paul Madsen,
   Alastair Mair, Eve Maler, James Manger, Mark McGloin, Laurence Miao,
   William Mills, Chuck Mortimore, Anthony Nadalin, Julian Reschke,
   Justin Richer, Peter Saint-Andre, Nat Sakimura, Rob Sayre, Marius
   Scurtescu, Naitik Shah, Luke Shepard, Vlad Skvortsov, Justin Smith,
   Haibin Song, Niv Steingarten, Christian Stuebner, Jeremy Suriel, Paul
   Tarjan, Christopher Thomas, Henry S. Thompson, Allen Tom, Franklin
   Tse, Nick Walker, Shane Weeden, and Skylar Woodward.

   This document was produced under the chairmanship of Blaine Cook,
   Peter Saint-Andre, Hannes Tschofenig, Barry Leiba, and Derek Atkins.
   The area directors included Lisa Dusseault, Peter Saint-Andre, and
   Stephen Farrell.


<span class="h2"><a class="selflink" name="appendix-C" href="#appendix-C">Appendix C</a>.  Editor's Notes</span>

   While many people contributed to this specification throughout its
   long journey, the editor would like to acknowledge and thank a few
   individuals for their outstanding and invaluable efforts leading up
   to the publication of this specification.




<span class="grey">Hammer, et al.          Expires December 21, 2012              [Page 69]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-70" id="page-70" href="#page-70" class="invisible"> </a>
<span class="grey">Internet-Draft                  OAuth 2.0                      June 2012</span>


   David Recordon for continuously being one of OAuth's most valuable
   assets, bringing pragmatism and urgency to the work, and helping
   shape it from its very beginning, as well as being one of the best
   collaborators I had the pleasure of working with.

   James Manger for his creative ideas and always insightful feedback.
   Brian Campbell, Torsten Lodderstedt, Chuck Mortimore, Justin Richer,
   Marius Scurtescu, and Luke Shepard for their continued participation
   and valuable feedback.

   Special thanks goes to Mike Curtis and Yahoo! for their unconditional
   support of this work for over three years.


Authors' Addresses

   Eran Hammer (editor)

   Email: eran@hueniverse.com
   URI:   <a href="http://hueniverse.com">http://hueniverse.com</a>


   David Recordon
   Facebook

   Email: dr@fb.com
   URI:   <a href="http://www.davidrecordon.com/">http://www.davidrecordon.com/</a>


   Dick Hardt
   Microsoft

   Email: dick.hardt@gmail.com
   URI:   <a href="http://dickhardt.org/">http://dickhardt.org/</a>

















Hammer, et al.          Expires December 21, 2012              [Page 70]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
