<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:rfc:6692" />
<meta name="DC.Description.Abstract" content="This document defines an additional header field for use in Abuse\nReporting Format (ARF) reports to permit the identification of the\nsource port of the connection involved in an abuse incident.  This\ndocument updates RFC 6591. [STANDARDS-TRACK]" />
<meta name="DC.Creator" content="Kucherawy, Murray" />
<meta name="DC.Creator" content="Clayton, Richard" />
<meta name="DC.Date.Issued" content="July, 2012" />
<meta name="DC.Title" content="Source Ports in Abuse Reporting Format (ARF) Reports" />

    <link rel="icon" href="/images/rfc.png" type="image/png" />
    <link rel="shortcut icon" href="/images/rfc.png" type="image/png" />
    <title>RFC 6692 - Source Ports in Abuse Reporting Format (ARF) Reports</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgblue"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="/rfc/rfc6692.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/rfc6692" title="PDF version of this document">pdf</a>] [<a href="./draft-kucherawy-marf-source-ports" title="draft-kucherawy-marf-source-ports">draft-kucherawy-m...</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=rfc6692" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=rfc6692" title="Side-by-side diff">Diff2</a>]                 </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">                                                       PROPOSED STANDARD</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Internet Engineering Task Force (IETF)                        R. Clayton
Request for Comments: 6692                       University of Cambridge
Updates: <a href="./rfc6591">6591</a>                                               M. Kucherawy
Category: Standards Track                                Cloudmark, Inc.
ISSN: 2070-1721                                                July 2012


          <span class="h1">Source Ports in Abuse Reporting Format (ARF) Reports</span>

Abstract

   This document defines an additional header field for use in Abuse
   Reporting Format (ARF) reports to permit the identification of the
   source port of the connection involved in an abuse incident.

   This document updates <a href="./rfc6591">RFC 6591</a>.

Status of This Memo

   This is an Internet Standards Track document.

   This document is a product of the Internet Engineering Task Force
   (IETF).  It represents the consensus of the IETF community.  It has
   received public review and has been approved for publication by the
   Internet Engineering Steering Group (IESG).  Further information on
   Internet Standards is available in <a href="./rfc5741#section-2">Section&nbsp;2 of RFC 5741</a>.

   Information about the current status of this document, any errata,
   and how to provide feedback on it may be obtained at
   <a href="http://www.rfc-editor.org/info/rfc6692">http://www.rfc-editor.org/info/rfc6692</a>.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.






<span class="grey">Clayton &amp; Kucherawy          Standards Track                    [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey"><a href="./rfc6692">RFC 6692</a>                    ARF Source Ports                   July 2012</span>


Table of Contents

   <a href="#section-1">1</a>. Introduction ....................................................<a href="#page-2">2</a>
   <a href="#section-2">2</a>. Keywords ........................................................<a href="#page-2">2</a>
   <a href="#section-3">3</a>. Source-Port Field Definition ....................................<a href="#page-2">2</a>
   <a href="#section-4">4</a>. Time Accuracy ...................................................<a href="#page-3">3</a>
   <a href="#section-5">5</a>. IANA Considerations .............................................<a href="#page-3">3</a>
   <a href="#section-6">6</a>. Security Considerations .........................................<a href="#page-3">3</a>
   <a href="#section-7">7</a>. References ......................................................<a href="#page-4">4</a>
      <a href="#section-7.1">7.1</a>. Normative References .......................................<a href="#page-4">4</a>
      <a href="#section-7.2">7.2</a>. Informative References .....................................<a href="#page-4">4</a>
   <a href="#appendix-A">Appendix A</a>. Acknowledgements .......................................<a href="#page-5">5</a>

<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   [<a name="ref-ARF" id="ref-ARF">ARF</a>] defined the Abuse Reporting Format, an extensible message
   format for Email Feedback Reports.  These reports are used to report
   incidents of email abuse.  ARF was extended by [<a href="#ref-AUTHFAILURE-REPORT">AUTHFAILURE-REPORT</a>]
   to enable the reporting of email authentication failures.  These
   specifications provided for the source IP address to be included in a
   report.  As explained in [<a href="#ref-LOG" title="&quot;Logging Recommendations for Internet-Facing Servers&quot;">LOG</a>], the deployment of IP address sharing
   techniques requires the source port values to be included in reports
   if unambiguous identification of the origin of abuse is to be
   achieved.

   This document defines an ARF reporting field to contain this
   information and provides guidance for its use.

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Keywords</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="#ref-KEYWORDS">KEYWORDS</a>].

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Source-Port Field Definition</span>

   A new ARF header field called "Source-Port" is defined.  When present
   in a report, it MUST contain the client port of the TCP connection
   from which the reported message originated, corresponding to the
   "Source-IP" field that contains the client address of that same
   connection, thereby describing completely the origin of the abuse
   incident.

   Per, [<a href="#ref-ABNF" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">ABNF</a>], the formal syntax is:

     source-port = "Source-Port:" [CFWS] 1*5DIGIT [CFWS] CRLF





<span class="grey">Clayton &amp; Kucherawy          Standards Track                    [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey"><a href="./rfc6692">RFC 6692</a>                    ARF Source Ports                   July 2012</span>


   "CFWS", which represents email-style comments or folding white space,
   is imported from [<a href="#ref-MAIL" title="&quot;Internet Message Format&quot;">MAIL</a>].

   When any report is generated that includes the "Source-IP" field (see
   Section 3.2 of [<a href="#ref-ARF" title="&quot;An Extensible Format for Email Feedback Reports&quot;">ARF</a>]), this field SHOULD also be present, unless the
   port number is unavailable.

   Use of this field is RECOMMENDED for reports generated per
   [<a href="#ref-AUTHFAILURE-REPORT">AUTHFAILURE-REPORT</a>] (see <a href="#section-3.1">Section 3.1</a> of that document).

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Time Accuracy</span>

   [<a name="ref-LOG" id="ref-LOG">LOG</a>] underscores the importance of accurate clocks when generating
   reports that include source port information because of the fact that
   source ports can be recycled very quickly in Internet Service
   Provider environments.  The same considerations described there apply
   here.

   Report generators that include an Arrival-Date report field MAY
   choose to express the value of that date in Universal Coordinated
   Time (UTC) to enable simpler correlation with local records at sites
   that are following the provisions of [<a href="#ref-LOG" title="&quot;Logging Recommendations for Internet-Facing Servers&quot;">LOG</a>].

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  IANA Considerations</span>

   IANA has added the following entry to the "Feedback Report Header
   Fields" registry:

   Field Name:  Source-Port

   Description:  TCP source port from which the original message was
      received

   Multiple Appearances:  No

   Related "Feedback-Type":  any

   Reference:  [<a href="./rfc6692">RFC6692</a>]

   Status:  current

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

   This extension introduces no new security considerations not already
   covered in [<a href="#ref-ARF" title="&quot;An Extensible Format for Email Feedback Reports&quot;">ARF</a>].

   Some security considerations related to the general topic of source
   port logging can be found in [<a href="#ref-LOG" title="&quot;Logging Recommendations for Internet-Facing Servers&quot;">LOG</a>].



<span class="grey">Clayton &amp; Kucherawy          Standards Track                    [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey"><a href="./rfc6692">RFC 6692</a>                    ARF Source Ports                   July 2012</span>


<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  References</span>

<span class="h3"><a class="selflink" name="section-7.1" href="#section-7.1">7.1</a>.  Normative References</span>

   [<a name="ref-ABNF" id="ref-ABNF">ABNF</a>]     Crocker, D. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>, January 2008.

   [<a name="ref-ARF" id="ref-ARF">ARF</a>]      Shafranovich, Y., Levine, J., and M. Kucherawy, "An
              Extensible Format for Email Feedback Reports", <a href="./rfc5965">RFC 5965</a>,
              August 2010.

   [<a name="ref-AUTHFAILURE-REPORT" id="ref-AUTHFAILURE-REPORT">AUTHFAILURE-REPORT</a>]
              Fontana, H., "Authentication Failure Reporting Using the
              Abuse Reporting Format", <a href="./rfc6591">RFC 6591</a>, April 2012.

   [<a name="ref-KEYWORDS" id="ref-KEYWORDS">KEYWORDS</a>]
              Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-MAIL" id="ref-MAIL">MAIL</a>]     Resnick, P., Ed., "Internet Message Format", <a href="./rfc5322">RFC 5322</a>,
              October 2008.

<span class="h3"><a class="selflink" name="section-7.2" href="#section-7.2">7.2</a>.  Informative References</span>

   [<a name="ref-LOG" id="ref-LOG">LOG</a>]      Durand, A., Gashinsky, I., Lee, D., and S. Sheppard,
              "Logging Recommendations for Internet-Facing Servers",
              <a href="./bcp162">BCP 162</a>, <a href="./rfc6302">RFC 6302</a>, June 2011.
























<span class="grey">Clayton &amp; Kucherawy          Standards Track                    [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey"><a href="./rfc6692">RFC 6692</a>                    ARF Source Ports                   July 2012</span>


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Acknowledgements</span>

   The authors wish to acknowledge the following for their review and
   constructive criticism of this proposal: Steve Atkins, Scott
   Kitterman, John Levine, and Doug Otis.

   The idea for this work originated within the Messaging Anti-Abuse
   Working Group (MAAWG).

Authors' Addresses

   Richard Clayton
   University of Cambridge
   Computer Laboratory
   JJ Thomson Avenue
   Cambridge  CB3 0FD
   United Kingdom

   Phone: +44 1223 763570
   EMail: richard.clayton@cl.cam.ac.uk


   Murray S. Kucherawy
   Cloudmark, Inc.
   128 King St., 2nd Floor
   San Francisco, CA 94107
   US

   Phone: +1 415 946 3800
   EMail: superuser@gmail.com





















Clayton &amp; Kucherawy          Standards Track                    [Page 5]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
