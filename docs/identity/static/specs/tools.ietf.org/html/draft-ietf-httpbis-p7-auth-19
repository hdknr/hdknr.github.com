<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:ietf-httpbis-p7-auth" />
<meta name="DC.Description.Abstract" content="The Hypertext Transfer Protocol (HTTP) is an application-level\nprotocol for distributed, collaborative, hypermedia information\nsystems. This document defines the HTTP Authentication framework." />
<meta name="DC.Creator" content="Lafon, Yves" />
<meta name="DC.Creator" content="Fielding, Roy T." />
<meta name="DC.Creator" content="Reschke, Julian F." />
<meta name="DC.Date.Issued" content="2012-07-16" />
<meta name="DC.Title" content="HTTP/1.1, part 7: Authentication" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-httpbis-p7-auth-19 - HTTP/1.1, part 7: Authentication</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-ietf-httpbis-p7-auth-19.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-httpbis-p7-auth-19.txt" title="PDF version of this document">pdf</a>|<a href="/id/draft-ietf-httpbis-p7-auth-19.xml" title="XML source for this document">xml</a>|<a href="/id/draft-ietf-httpbis-p7-auth-19.html" title="HTML version of this document, from XML2RFC">html</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-httpbis-p7-auth' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/httpbis" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-httpbis-p7-auth@tools.ietf.org?subject=draft-ietf-httpbis-p7-auth%20" title="Send email to the document authors">Email</a>] [<a href="/rfcdiff?difftype=--hwdiff&amp;url2=draft-ietf-httpbis-p7-auth-19.txt" title="Inline diff (wdiff)">Diff1</a>] [<a href="/rfcdiff?url2=draft-ietf-httpbis-p7-auth-19.txt" title="Side-by-side diff">Diff2</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-ietf-httpbis-p7-auth-19.txt" title="Run an idnits check of this document">Nits</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=document_search&document_search=draft-ietf-httpbis-p7-auth" title="IPR disclosures related to this document">IPR</a>]</span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-ietf-httpbis-p7-auth-00">00</a> <a href="./draft-ietf-httpbis-p7-auth-01">01</a> <a href="./draft-ietf-httpbis-p7-auth-02">02</a> <a href="./draft-ietf-httpbis-p7-auth-03">03</a> <a href="./draft-ietf-httpbis-p7-auth-04">04</a> <a href="./draft-ietf-httpbis-p7-auth-05">05</a> <a href="./draft-ietf-httpbis-p7-auth-06">06</a> <a href="./draft-ietf-httpbis-p7-auth-07">07</a> <a href="./draft-ietf-httpbis-p7-auth-08">08</a> <a href="./draft-ietf-httpbis-p7-auth-09">09</a> <a href="./draft-ietf-httpbis-p7-auth-10">10</a> <a href="./draft-ietf-httpbis-p7-auth-11">11</a>                           
          <a href="./draft-ietf-httpbis-p7-auth-12">12</a> <a href="./draft-ietf-httpbis-p7-auth-13">13</a> <a href="./draft-ietf-httpbis-p7-auth-14">14</a> <a href="./draft-ietf-httpbis-p7-auth-15">15</a> <a href="./draft-ietf-httpbis-p7-auth-16">16</a> <a href="./draft-ietf-httpbis-p7-auth-17">17</a> <a href="./draft-ietf-httpbis-p7-auth-18">18</a> <a href="./draft-ietf-httpbis-p7-auth-19">19</a> <a href="./draft-ietf-httpbis-p7-auth-20">20</a>                                    </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
HTTPbis Working Group                                   R. Fielding, Ed.
Internet-Draft                                                     Adobe
Obsoletes: <a href="./rfc2616">2616</a> (if approved)                              Y. Lafon, Ed.
Updates: <a href="./rfc2617">2617</a> (if approved)                                          W3C
Intended status: Standards Track                         J. Reschke, Ed.
Expires: September 13, 2012                                   greenbytes
                                                          March 12, 2012


                    <span class="h1">HTTP/1.1, part 7: Authentication</span>
                     <span class="h1">draft-ietf-httpbis-p7-auth-19</span>

Abstract

   The Hypertext Transfer Protocol (HTTP) is an application-level
   protocol for distributed, collaborative, hypermedia information
   systems.  HTTP has been in use by the World Wide Web global
   information initiative since 1990.  This document is Part 7 of the
   seven-part specification that defines the protocol referred to as
   "HTTP/1.1" and, taken together, obsoletes <a href="./rfc2616">RFC 2616</a>.

   Part 7 defines the HTTP Authentication framework.

Editorial Note (To be removed by RFC Editor)

   Discussion of this draft should take place on the HTTPBIS working
   group mailing list (ietf-http-wg@w3.org), which is archived at
   &lt;<a href="http://lists.w3.org/Archives/Public/ietf-http-wg/">http://lists.w3.org/Archives/Public/ietf-http-wg/</a>&gt;.

   The current issues list is at
   &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/report/3">http://tools.ietf.org/wg/httpbis/trac/report/3</a>&gt; and related
   documents (including fancy diffs) can be found at
   &lt;<a href="http://tools.ietf.org/wg/httpbis/">http://tools.ietf.org/wg/httpbis/</a>&gt;.

   The changes in this draft are summarized in <a href="#appendix-C.20">Appendix C.20</a>.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 13, 2012.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

   This document may contain material from IETF Documents or IETF
   Contributions published or made publicly available before November
   10, 2008.  The person(s) controlling the copyright in some of this
   material may not have granted the IETF Trust the right to allow
   modifications of such material outside the IETF Standards Process.
   Without obtaining an adequate license from the person(s) controlling
   the copyright in such materials, this document may not be modified
   outside the IETF Standards Process, and derivative works of it may
   not be created outside the IETF Standards Process, except to format
   it for publication as an RFC or to translate it into languages other
   than English.

Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.1">1.1</a>.  Conformance and Error Handling . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-1.2">1.2</a>.  Syntax Notation  . . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
       <a href="#section-1.2.1">1.2.1</a>.  Core Rules . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
   <a href="#section-2">2</a>.  Access Authentication Framework  . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.1">2.1</a>.  Challenge and Response . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  Protection Space (Realm) . . . . . . . . . . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.3">2.3</a>.  Authentication Scheme Registry . . . . . . . . . . . . . .  <a href="#page-7">7</a>
       <a href="#section-2.3.1">2.3.1</a>.  Considerations for New Authentication Schemes  . . . .  <a href="#page-8">8</a>
   <a href="#section-3">3</a>.  Status Code Definitions  . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.1">3.1</a>.  401 Unauthorized . . . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.2">3.2</a>.  407 Proxy Authentication Required  . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#section-4">4</a>.  Header Field Definitions . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
     <a href="#section-4.1">4.1</a>.  Authorization  . . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


     <a href="#section-4.2">4.2</a>.  Proxy-Authenticate . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-4.3">4.3</a>.  Proxy-Authorization  . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
     <a href="#section-4.4">4.4</a>.  WWW-Authenticate . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>
   <a href="#section-5">5</a>.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-5.1">5.1</a>.  Authenticaton Scheme Registry  . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-5.2">5.2</a>.  Status Code Registration . . . . . . . . . . . . . . . . . <a href="#page-12">12</a>
     <a href="#section-5.3">5.3</a>.  Header Field Registration  . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
   <a href="#section-6">6</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . . <a href="#page-13">13</a>
     <a href="#section-6.1">6.1</a>.  Authentication Credentials and Idle Clients  . . . . . . . <a href="#page-13">13</a>
   <a href="#section-7">7</a>.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#section-8">8</a>.  References . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-8.1">8.1</a>.  Normative References . . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
     <a href="#section-8.2">8.2</a>.  Informative References . . . . . . . . . . . . . . . . . . <a href="#page-14">14</a>
   <a href="#appendix-A">Appendix A</a>.  Changes from RFCs 2616 and 2617 . . . . . . . . . . . <a href="#page-15">15</a>
   <a href="#appendix-B">Appendix B</a>.  Collected ABNF  . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
   <a href="#appendix-C">Appendix C</a>.  Change Log (to be removed by RFC Editor before
                publication)  . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#appendix-C.1">C.1</a>.  Since <a href="./rfc2616">RFC 2616</a> . . . . . . . . . . . . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#appendix-C.2">C.2</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-00">draft-ietf-httpbis-p7-auth-00</a>  . . . . . . . . . . . <a href="#page-16">16</a>
     <a href="#appendix-C.3">C.3</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-01">draft-ietf-httpbis-p7-auth-01</a>  . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-C.4">C.4</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-02">draft-ietf-httpbis-p7-auth-02</a>  . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-C.5">C.5</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-03">draft-ietf-httpbis-p7-auth-03</a>  . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-C.6">C.6</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-04">draft-ietf-httpbis-p7-auth-04</a>  . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-C.7">C.7</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-05">draft-ietf-httpbis-p7-auth-05</a>  . . . . . . . . . . . <a href="#page-17">17</a>
     <a href="#appendix-C.8">C.8</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-06">draft-ietf-httpbis-p7-auth-06</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.9">C.9</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-07">draft-ietf-httpbis-p7-auth-07</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.10">C.10</a>. Since <a href="./draft-ietf-httpbis-p7-auth-08">draft-ietf-httpbis-p7-auth-08</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.11">C.11</a>. Since <a href="./draft-ietf-httpbis-p7-auth-09">draft-ietf-httpbis-p7-auth-09</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.12">C.12</a>. Since <a href="./draft-ietf-httpbis-p7-auth-10">draft-ietf-httpbis-p7-auth-10</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.13">C.13</a>. Since <a href="./draft-ietf-httpbis-p7-auth-11">draft-ietf-httpbis-p7-auth-11</a>  . . . . . . . . . . . <a href="#page-18">18</a>
     <a href="#appendix-C.14">C.14</a>. Since <a href="./draft-ietf-httpbis-p7-auth-12">draft-ietf-httpbis-p7-auth-12</a>  . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#appendix-C.15">C.15</a>. Since <a href="./draft-ietf-httpbis-p7-auth-13">draft-ietf-httpbis-p7-auth-13</a>  . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#appendix-C.16">C.16</a>. Since <a href="./draft-ietf-httpbis-p7-auth-14">draft-ietf-httpbis-p7-auth-14</a>  . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#appendix-C.17">C.17</a>. Since <a href="./draft-ietf-httpbis-p7-auth-15">draft-ietf-httpbis-p7-auth-15</a>  . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#appendix-C.18">C.18</a>. Since <a href="./draft-ietf-httpbis-p7-auth-16">draft-ietf-httpbis-p7-auth-16</a>  . . . . . . . . . . . <a href="#page-19">19</a>
     <a href="#appendix-C.19">C.19</a>. Since <a href="./draft-ietf-httpbis-p7-auth-17">draft-ietf-httpbis-p7-auth-17</a>  . . . . . . . . . . . <a href="#page-20">20</a>
     <a href="#appendix-C.20">C.20</a>. Since <a href="./draft-ietf-httpbis-p7-auth-18">draft-ietf-httpbis-p7-auth-18</a>  . . . . . . . . . . . <a href="#page-20">20</a>
   Index  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-20">20</a>













<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   This document defines HTTP/1.1 access control and authentication.  It
   includes the relevant parts of <a href="./rfc2616">RFC 2616</a> with only minor changes, plus
   the general framework for HTTP authentication, as previously defined
   in "HTTP Authentication: Basic and Digest Access Authentication"
   ([<a href="./rfc2617" title="&quot;HTTP Authentication: Basic and Digest Access Authentication&quot;">RFC2617</a>]).

   HTTP provides several OPTIONAL challenge-response authentication
   mechanisms which can be used by a server to challenge a client
   request and by a client to provide authentication information.  The
   "basic" and "digest" authentication schemes continue to be specified
   in <a href="./rfc2617">RFC 2617</a>.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Conformance and Error Handling</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   This document defines conformance criteria for several roles in HTTP
   communication, including Senders, Recipients, Clients, Servers, User-
   Agents, Origin Servers, Intermediaries, Proxies and Gateways.  See
   Section 2 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>] for definitions of these terms.

   An implementation is considered conformant if it complies with all of
   the requirements associated with its role(s).  Note that SHOULD-level
   requirements are relevant here, unless one of the documented
   exceptions is applicable.

   This document also uses ABNF to define valid protocol elements
   (<a href="#section-1.2">Section 1.2</a>).  In addition to the prose requirements placed upon
   them, Senders MUST NOT generate protocol elements that are invalid.

   Unless noted otherwise, Recipients MAY take steps to recover a usable
   protocol element from an invalid construct.  However, HTTP does not
   define specific error handling mechanisms, except in cases where it
   has direct impact on security.  This is because different uses of the
   protocol require different error handling strategies; for example, a
   Web browser may wish to transparently recover from a response where
   the Location header field doesn't parse according to the ABNF,
   whereby in a systems control protocol using HTTP, this type of error
   recovery could lead to dangerous consequences.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Syntax Notation</span>

   This specification uses the Augmented Backus-Naur Form (ABNF)
   notation of [<a href="./rfc5234" title="&quot;Augmented BNF for Syntax Specifications: ABNF&quot;">RFC5234</a>] with the list rule extension defined in Section



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   1.2 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>].  <a href="#appendix-B">Appendix B</a> shows the collected ABNF with the list
   rule expanded.

   The following core rules are included by reference, as defined in
   <a href="./rfc5234#appendix-B.1">[RFC5234], Appendix&nbsp;B.1</a>: ALPHA (letters), CR (carriage return), CRLF
   (CR LF), CTL (controls), DIGIT (decimal 0-9), DQUOTE (double quote),
   HEXDIG (hexadecimal 0-9/A-F/a-f), LF (line feed), OCTET (any 8-bit
   sequence of data), SP (space), and VCHAR (any visible US-ASCII
   character).

<span class="h4"><a class="selflink" name="section-1.2.1" href="#section-1.2.1">1.2.1</a>.  Core Rules</span>

   The core rules below are defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>]:

     BWS           = &lt;BWS, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.1&gt;
     OWS           = &lt;OWS, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.1&gt;
     quoted-string = &lt;quoted-string, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.4&gt;
     token         = &lt;token, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.4&gt;

<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Access Authentication Framework</span>

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Challenge and Response</span>

   HTTP provides a simple challenge-response authentication mechanism
   that can be used by a server to challenge a client request and by a
   client to provide authentication information.  It uses an extensible,
   case-insensitive token to identify the authentication scheme,
   followed by additional information necessary for achieving
   authentication via that scheme.  The latter can either be a comma-
   separated list of parameters or a single sequence of characters
   capable of holding base64-encoded information.

   Parameters are name-value pairs where the name is matched case-
   insensitively, and each parameter name MUST only occur once per
   challenge.

     auth-scheme    = token

     auth-param     = token BWS "=" BWS ( token / quoted-string )

     b64token       = 1*( ALPHA / DIGIT /
                          "-" / "." / "_" / "~" / "+" / "/" ) *"="

   The "b64token" syntax allows the 66 unreserved URI characters
   ([<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]), plus a few others, so that it can hold a base64,
   base64url (URL and filename safe alphabet), base32, or base16 (hex)
   encoding, with or without padding, but excluding whitespace
   ([<a href="./rfc4648" title="&quot;The Base16, Base32, and Base64 Data Encodings&quot;">RFC4648</a>]).



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   The 401 (Unauthorized) response message is used by an origin server
   to challenge the authorization of a user agent.  This response MUST
   include a WWW-Authenticate header field containing at least one
   challenge applicable to the requested resource.

   The 407 (Proxy Authentication Required) response message is used by a
   proxy to challenge the authorization of a client and MUST include a
   Proxy-Authenticate header field containing at least one challenge
   applicable to the proxy for the requested resource.

     challenge   = auth-scheme [ 1*SP ( b64token / #auth-param ) ]

      Note: User agents will need to take special care in parsing the
      WWW-Authenticate and Proxy-Authenticate header field values
      because they can contain more than one challenge, or if more than
      one of each is provided, since the contents of a challenge can
      itself contain a comma-separated list of authentication
      parameters.

      Note: Many browsers fail to parse challenges containing unknown
      schemes.  A workaround for this problem is to list well-supported
      schemes (such as "basic") first.

   A user agent that wishes to authenticate itself with an origin server
   -- usually, but not necessarily, after receiving a 401 (Unauthorized)
   -- MAY do so by including an Authorization header field with the
   request.

   A client that wishes to authenticate itself with a proxy -- usually,
   but not necessarily, after receiving a 407 (Proxy Authentication
   Required) -- MAY do so by including a Proxy-Authorization header
   field with the request.

   Both the Authorization field value and the Proxy-Authorization field
   value consist of credentials containing the authentication
   information of the client for the realm of the resource being
   requested.  The user agent MUST choose to use one of the challenges
   with the strongest auth-scheme it understands and request credentials
   from the user based upon that challenge.

     credentials = auth-scheme [ 1*SP ( b64token / #auth-param ) ]

   If the origin server does not wish to accept the credentials sent
   with a request, it SHOULD return a 401 (Unauthorized) response.  The
   response MUST include a WWW-Authenticate header field containing at
   least one (possibly new) challenge applicable to the requested
   resource.




<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   If a proxy does not accept the credentials sent with a request, it
   SHOULD return a 407 (Proxy Authentication Required).  The response
   MUST include a Proxy-Authenticate header field containing a (possibly
   new) challenge applicable to the proxy for the requested resource.

   The HTTP protocol does not restrict applications to this simple
   challenge-response mechanism for access authentication.  Additional
   mechanisms MAY be used, such as encryption at the transport level or
   via message encapsulation, and with additional header fields
   specifying authentication information.  However, such additional
   mechanisms are not defined by this specification.

   Proxies MUST forward the WWW-Authenticate and Authorization headers
   unmodified and follow the rules found in <a href="#section-4.1">Section 4.1</a>.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Protection Space (Realm)</span>

   The authentication parameter realm is reserved for use by
   authentication schemes that wish to indicate the scope of protection.

   A protection space is defined by the canonical root URI (the scheme
   and authority components of the effective request URI; see <a href="#section-5.5">Section</a>
   <a href="#section-5.5">5.5</a> of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>]) of the server being accessed, in combination with the
   realm value if present.  These realms allow the protected resources
   on a server to be partitioned into a set of protection spaces, each
   with its own authentication scheme and/or authorization database.
   The realm value is a string, generally assigned by the origin server,
   which can have additional semantics specific to the authentication
   scheme.  Note that there can be multiple challenges with the same
   auth-scheme but different realms.

   The protection space determines the domain over which credentials can
   be automatically applied.  If a prior request has been authorized,
   the same credentials MAY be reused for all other requests within that
   protection space for a period of time determined by the
   authentication scheme, parameters, and/or user preference.  Unless
   otherwise defined by the authentication scheme, a single protection
   space cannot extend outside the scope of its server.

   For historical reasons, senders MUST only use the quoted-string
   syntax.  Recipients might have to support both token and quoted-
   string syntax for maximum interoperability with existing clients that
   have been accepting both notations for a long time.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Authentication Scheme Registry</span>

   The HTTP Authentication Scheme Registry defines the name space for
   the authentication schemes in challenges and credentials.



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   Registrations MUST include the following fields:

   o  Authentication Scheme Name

   o  Pointer to specification text

   o  Notes (optional)

   Values to be added to this name space require IETF Review (see
   <a href="./rfc5226#section-4.1">[RFC5226], Section&nbsp;4.1</a>).

   The registry itself is maintained at
   &lt;<a href="http://www.iana.org/assignments/http-authschemes">http://www.iana.org/assignments/http-authschemes</a>&gt;.

<span class="h4"><a class="selflink" name="section-2.3.1" href="#section-2.3.1">2.3.1</a>.  Considerations for New Authentication Schemes</span>

   There are certain aspects of the HTTP Authentication Framework that
   put constraints on how new authentication schemes can work:

   o  HTTP authentication is presumed to be stateless: all of the
      information necessary to authenticate a request MUST be provided
      in the request, rather than be dependent on the server remembering
      prior requests.  Authentication based on, or bound to, the
      underlying connection is outside the scope of this specification
      and inherently flawed unless steps are taken to ensure that the
      connection cannot be used by any party other than the
      authenticated user (see Section 2.3 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>]).

   o  The authentication parameter "realm" is reserved for defining
      Protection Spaces as defined in <a href="#section-2.2">Section 2.2</a>.  New schemes MUST NOT
      use it in a way incompatible with that definition.

   o  The "b64token" notation was introduced for compatibility with
      existing authentication schemes and can only be used once per
      challenge/credentials.  New schemes thus ought to use the "auth-
      param" syntax instead, because otherwise future extensions will be
      impossible.

   o  The parsing of challenges and credentials is defined by this
      specification, and cannot be modified by new authentication
      schemes.  When the auth-param syntax is used, all parameters ought
      to support both token and quoted-string syntax, and syntactical
      constraints ought to be defined on the field value after parsing
      (i.e., quoted-string processing).  This is necessary so that
      recipients can use a generic parser that applies to all
      authentication schemes.

      Note: the fact that the value syntax for the "realm" parameter is



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


      restricted to quoted-string was a bad design choice not to be
      repeated for new parameters.

   o  Definitions of new schemes ought to define the treatment of
      unknown extension parameters.  In general, a "must-ignore" rule is
      preferable over "must-understand", because otherwise it will be
      hard to introduce new parameters in the presence of legacy
      recipients.  Furthermore, it's good to describe the policy for
      defining new parameters (such as "update the specification", or
      "use this registry").

   o  Authentication schemes need to document whether they are usable in
      origin-server authentication (i.e., using WWW-Authenticate),
      and/or proxy authentication (i.e., using Proxy-Authenticate).

   o  The credentials carried in an Authorization header field are
      specific to the User Agent, and therefore have the same effect on
      HTTP caches as the "private" Cache-Control response directive,
      within the scope of the request they appear in.

      Therefore, new authentication schemes which choose not to carry
      credentials in the Authorization header (e.g., using a newly
      defined header) will need to explicitly disallow caching, by
      mandating the use of either Cache-Control request directives
      (e.g., "no-store") or response directives (e.g., "private").

<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Status Code Definitions</span>

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  401 Unauthorized</span>

   The request requires user authentication.  The response MUST include
   a WWW-Authenticate header field (<a href="#section-4.4">Section 4.4</a>) containing a challenge
   applicable to the target resource.  The client MAY repeat the request
   with a suitable Authorization header field (<a href="#section-4.1">Section 4.1</a>).  If the
   request already included Authorization credentials, then the 401
   response indicates that authorization has been refused for those
   credentials.  If the 401 response contains the same challenge as the
   prior response, and the user agent has already attempted
   authentication at least once, then the user SHOULD be presented the
   representation that was given in the response, since that
   representation might include relevant diagnostic information.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  407 Proxy Authentication Required</span>

   This code is similar to 401 (Unauthorized), but indicates that the
   client ought to first authenticate itself with the proxy.  The proxy
   MUST return a Proxy-Authenticate header field (<a href="#section-4.2">Section 4.2</a>)
   containing a challenge applicable to the proxy for the target



<span class="grey">Fielding, et al.       Expires September 13, 2012               [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   resource.  The client MAY repeat the request with a suitable Proxy-
   Authorization header field (<a href="#section-4.3">Section 4.3</a>).

<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Header Field Definitions</span>

   This section defines the syntax and semantics of HTTP/1.1 header
   fields related to authentication.

<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Authorization</span>

   The "Authorization" header field allows a user agent to authenticate
   itself with a server -- usually, but not necessarily, after receiving
   a 401 (Unauthorized) response.  Its value consists of credentials
   containing information of the user agent for the realm of the
   resource being requested.

     Authorization = credentials

   If a request is authenticated and a realm specified, the same
   credentials SHOULD be valid for all other requests within this realm
   (assuming that the authentication scheme itself does not require
   otherwise, such as credentials that vary according to a challenge
   value or using synchronized clocks).

   When a shared cache (see Section 1.2 of [<a href="#ref-Part6" title="&quot;HTTP/1.1, part 6: Caching&quot;">Part6</a>]) receives a request
   containing an Authorization field, it MUST NOT return the
   corresponding response as a reply to any other request, unless one of
   the following specific exceptions holds:

   1.  If the response includes the "s-maxage" cache-control directive,
       the cache MAY use that response in replying to a subsequent
       request.  But (if the specified maximum age has passed) a proxy
       cache MUST first revalidate it with the origin server, using the
       header fields from the new request to allow the origin server to
       authenticate the new request.  (This is the defined behavior for
       s-maxage.)  If the response includes "s-maxage=0", the proxy MUST
       always revalidate it before re-using it.

   2.  If the response includes the "must-revalidate" cache-control
       directive, the cache MAY use that response in replying to a
       subsequent request.  But if the response is stale, all caches
       MUST first revalidate it with the origin server, using the header
       fields from the new request to allow the origin server to
       authenticate the new request.

   3.  If the response includes the "public" cache-control directive, it
       MAY be returned in reply to any subsequent request.




<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h3"><a class="selflink" name="section-4.2" href="#section-4.2">4.2</a>.  Proxy-Authenticate</span>

   The "Proxy-Authenticate" header field consists of a challenge that
   indicates the authentication scheme and parameters applicable to the
   proxy for this effective request URI (Section 5.5 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>]).  It
   MUST be included as part of a 407 (Proxy Authentication Required)
   response.

     Proxy-Authenticate = 1#challenge

   Unlike WWW-Authenticate, the Proxy-Authenticate header field applies
   only to the current connection and SHOULD NOT be passed on to
   downstream clients.  However, an intermediate proxy might need to
   obtain its own credentials by requesting them from the downstream
   client, which in some circumstances will appear as if the proxy is
   forwarding the Proxy-Authenticate header field.

   Note that the parsing considerations for WWW-Authenticate apply to
   this header field as well; see <a href="#section-4.4">Section 4.4</a> for details.

<span class="h3"><a class="selflink" name="section-4.3" href="#section-4.3">4.3</a>.  Proxy-Authorization</span>

   The "Proxy-Authorization" header field allows the client to identify
   itself (or its user) to a proxy which requires authentication.  Its
   value consists of credentials containing the authentication
   information of the user agent for the proxy and/or realm of the
   resource being requested.

     Proxy-Authorization = credentials

   Unlike Authorization, the Proxy-Authorization header field applies
   only to the next outbound proxy that demanded authentication using
   the Proxy-Authenticate field.  When multiple proxies are used in a
   chain, the Proxy-Authorization header field is consumed by the first
   outbound proxy that was expecting to receive credentials.  A proxy
   MAY relay the credentials from the client request to the next proxy
   if that is the mechanism by which the proxies cooperatively
   authenticate a given request.

<span class="h3"><a class="selflink" name="section-4.4" href="#section-4.4">4.4</a>.  WWW-Authenticate</span>

   The "WWW-Authenticate" header field consists of at least one
   challenge that indicates the authentication scheme(s) and parameters
   applicable to the effective request URI (Section 5.5 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>]).

   It MUST be included in 401 (Unauthorized) response messages and MAY
   be included in other response messages to indicate that supplying
   credentials (or different credentials) might affect the response.



<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 11]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-12" id="page-12" href="#page-12" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


     WWW-Authenticate = 1#challenge

   User agents are advised to take special care in parsing the WWW-
   Authenticate field value as it might contain more than one challenge,
   or if more than one WWW-Authenticate header field is provided, the
   contents of a challenge itself can contain a comma-separated list of
   authentication parameters.

   For instance:

     WWW-Authenticate: Newauth realm="apps", type=1,
                       title="Login to \"apps\"", Basic realm="simple"

   This header field contains two challenges; one for the "Newauth"
   scheme with a realm value of "apps", and two additional parameters
   "type" and "title", and another one for the "Basic" scheme with a
   realm value of "simple".

      Note: The challenge grammar production uses the list syntax as
      well.  Therefore, a sequence of comma, whitespace, and comma can
      be considered both as applying to the preceding challenge, or to
      be an empty entry in the list of challenges.  In practice, this
      ambiguity does not affect the semantics of the header field value
      and thus is harmless.

<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  IANA Considerations</span>

<span class="h3"><a class="selflink" name="section-5.1" href="#section-5.1">5.1</a>.  Authenticaton Scheme Registry</span>

   The registration procedure for HTTP Authentication Schemes is defined
   by <a href="#section-2.3">Section 2.3</a> of this document.

   The HTTP Method Authentication Scheme shall be created at
   &lt;<a href="http://www.iana.org/assignments/http-authschemes">http://www.iana.org/assignments/http-authschemes</a>&gt;.

<span class="h3"><a class="selflink" name="section-5.2" href="#section-5.2">5.2</a>.  Status Code Registration</span>

   The HTTP Status Code Registry located at
   &lt;<a href="http://www.iana.org/assignments/http-status-codes">http://www.iana.org/assignments/http-status-codes</a>&gt; shall be updated
   with the registrations below:

   +-------+-------------------------------+-------------+
   | Value | Description                   | Reference   |
   +-------+-------------------------------+-------------+
   | 401   | Unauthorized                  | <a href="#section-3.1">Section 3.1</a> |
   | 407   | Proxy Authentication Required | <a href="#section-3.2">Section 3.2</a> |
   +-------+-------------------------------+-------------+




<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 12]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-13" id="page-13" href="#page-13" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h3"><a class="selflink" name="section-5.3" href="#section-5.3">5.3</a>.  Header Field Registration</span>

   The Message Header Field Registry located at &lt;<a href="http://www.iana.org/assignments/message-headers/message-header-index.html">http://www.iana.org/</a>
   <a href="http://www.iana.org/assignments/message-headers/message-header-index.html">assignments/message-headers/message-header-index.html</a>&gt; shall be
   updated with the permanent registrations below (see [<a href="./rfc3864" title="and J. Mogul">RFC3864</a>]):

   +---------------------+----------+----------+-------------+
   | Header Field Name   | Protocol | Status   | Reference   |
   +---------------------+----------+----------+-------------+
   | Authorization       | http     | standard | <a href="#section-4.1">Section 4.1</a> |
   | Proxy-Authenticate  | http     | standard | <a href="#section-4.2">Section 4.2</a> |
   | Proxy-Authorization | http     | standard | <a href="#section-4.3">Section 4.3</a> |
   | WWW-Authenticate    | http     | standard | <a href="#section-4.4">Section 4.4</a> |
   +---------------------+----------+----------+-------------+

   The change controller is: "IETF (iesg@ietf.org) - Internet
   Engineering Task Force".

<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  Security Considerations</span>

   This section is meant to inform application developers, information
   providers, and users of the security limitations in HTTP/1.1 as
   described by this document.  The discussion does not include
   definitive solutions to the problems revealed, though it does make
   some suggestions for reducing security risks.

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Authentication Credentials and Idle Clients</span>

   Existing HTTP clients and user agents typically retain authentication
   information indefinitely.  HTTP/1.1 does not provide a method for a
   server to direct clients to discard these cached credentials.  This
   is a significant defect that requires further extensions to HTTP.
   Circumstances under which credential caching can interfere with the
   application's security model include but are not limited to:

   o  Clients which have been idle for an extended period following
      which the server might wish to cause the client to reprompt the
      user for credentials.

   o  Applications which include a session termination indication (such
      as a "logout" or "commit" button on a page) after which the server
      side of the application "knows" that there is no further reason
      for the client to retain the credentials.

   This is currently under separate study.  There are a number of work-
   arounds to parts of this problem, and we encourage the use of
   password protection in screen savers, idle time-outs, and other
   methods which mitigate the security problems inherent in this



<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 13]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-14" id="page-14" href="#page-14" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   problem.  In particular, user agents which cache credentials are
   encouraged to provide a readily accessible mechanism for discarding
   cached credentials under user control.

<span class="h2"><a class="selflink" name="section-7" href="#section-7">7</a>.  Acknowledgments</span>

   This specification takes over the definition of the HTTP
   Authentication Framework, previously defined in <a href="./rfc2617">RFC 2617</a>.  We thank
   John Franks, Phillip M. Hallam-Baker, Jeffery L. Hostetler, Scott D.
   Lawrence, Paul J. Leach, Ari Luotonen, and Lawrence C. Stewart for
   their work on that specification.  See <a href="./rfc2617#section-6">Section&nbsp;6 of [RFC2617]</a> for
   further acknowledgements.

   See Section 9 of [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>] for the Acknowledgments related to this
   document revision.

<span class="h2"><a class="selflink" name="section-8" href="#section-8">8</a>.  References</span>

<span class="h3"><a class="selflink" name="section-8.1" href="#section-8.1">8.1</a>.  Normative References</span>

   [<a name="ref-Part1" id="ref-Part1">Part1</a>]    Fielding, R., Ed., Lafon, Y., Ed., and J. Reschke, Ed.,
              "HTTP/1.1, part 1: URIs, Connections, and Message
              Parsing", <a href="./draft-ietf-httpbis-p1-messaging-19">draft-ietf-httpbis-p1-messaging-19</a> (work in
              progress), March 2012.

   [<a name="ref-Part6" id="ref-Part6">Part6</a>]    Fielding, R., Ed., Lafon, Y., Ed., Nottingham, M., Ed.,
              and J. Reschke, Ed., "HTTP/1.1, part 6: Caching",
              <a href="./draft-ietf-httpbis-p6-cache-19">draft-ietf-httpbis-p6-cache-19</a> (work in progress),
              March 2012.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC5234" id="ref-RFC5234">RFC5234</a>]  Crocker, D., Ed. and P. Overell, "Augmented BNF for Syntax
              Specifications: ABNF", STD 68, <a href="./rfc5234">RFC 5234</a>, January 2008.

<span class="h3"><a class="selflink" name="section-8.2" href="#section-8.2">8.2</a>.  Informative References</span>

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a name="ref-RFC2617" id="ref-RFC2617">RFC2617</a>]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
              Leach, P., Luotonen, A., and L. Stewart, "HTTP
              Authentication: Basic and Digest Access Authentication",
              <a href="./rfc2617">RFC 2617</a>, June 1999.

   [<a name="ref-RFC3864" id="ref-RFC3864">RFC3864</a>]  Klyne, G., Nottingham, M., and J. Mogul, "Registration



<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 14]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-15" id="page-15" href="#page-15" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


              Procedures for Message Header Fields", <a href="./bcp90">BCP 90</a>, <a href="./rfc3864">RFC 3864</a>,
              September 2004.

   [<a name="ref-RFC3986" id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="./rfc3986">RFC 3986</a>, January 2005.

   [<a name="ref-RFC4648" id="ref-RFC4648">RFC4648</a>]  Josefsson, S., "The Base16, Base32, and Base64 Data
              Encodings", <a href="./rfc4648">RFC 4648</a>, October 2006.

   [<a name="ref-RFC5226" id="ref-RFC5226">RFC5226</a>]  Narten, T. and H. Alvestrand, "Guidelines for Writing an
              IANA Considerations Section in RFCs", <a href="./bcp26">BCP 26</a>, <a href="./rfc5226">RFC 5226</a>,
              May 2008.

<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Changes from RFCs 2616 and 2617</span>

   The "realm" parameter isn't required anymore in general;
   consequently, the ABNF allows challenges without any auth parameters.
   (<a href="#section-2">Section 2</a>)

   The "b64token" alternative to auth-param lists has been added for
   consistency with legacy authentication schemes such as "Basic".
   (<a href="#section-2">Section 2</a>)

   Change ABNF productions for header fields to only define the field
   value.  (<a href="#section-4">Section 4</a>)

























<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 15]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-16" id="page-16" href="#page-16" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Collected ABNF</span>

   Authorization = credentials

   BWS = &lt;BWS, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.1&gt;

   OWS = &lt;OWS, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.1&gt;

   Proxy-Authenticate = *( "," OWS ) challenge *( OWS "," [ OWS
    challenge ] )
   Proxy-Authorization = credentials

   WWW-Authenticate = *( "," OWS ) challenge *( OWS "," [ OWS challenge
    ] )

   auth-param = token BWS "=" BWS ( token / quoted-string )
   auth-scheme = token

   b64token = 1*( ALPHA / DIGIT / "-" / "." / "_" / "~" / "+" / "/" )
    *"="

   challenge = auth-scheme [ 1*SP ( b64token / [ ( "," / auth-param ) *(
    OWS "," [ OWS auth-param ] ) ] ) ]
   credentials = auth-scheme [ 1*SP ( b64token / [ ( "," / auth-param )
    *( OWS "," [ OWS auth-param ] ) ] ) ]

   quoted-string = &lt;quoted-string, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.4&gt;

   token = &lt;token, defined in [<a href="#ref-Part1" title="&quot;HTTP/1.1, part 1: URIs, Connections, and Message Parsing&quot;">Part1</a>], Section 3.2.4&gt;

   ABNF diagnostics:

   ; Authorization defined but not used
   ; Proxy-Authenticate defined but not used
   ; Proxy-Authorization defined but not used
   ; WWW-Authenticate defined but not used

<span class="h2"><a class="selflink" name="appendix-C" href="#appendix-C">Appendix C</a>.  Change Log (to be removed by RFC Editor before publication)</span>

<span class="h1"><a class="selflink" name="appendix-C.1" href="#appendix-C.1">C.1</a>.  Since <a href="./rfc2616">RFC 2616</a></span>

   Extracted relevant partitions from [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>].

<span class="h1"><a class="selflink" name="appendix-C.2" href="#appendix-C.2">C.2</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-00">draft-ietf-httpbis-p7-auth-00</a></span>

   Closed issues:





<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 16]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-17" id="page-17" href="#page-17" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/35">http://tools.ietf.org/wg/httpbis/trac/ticket/35</a>&gt;: "Normative and
      Informative references"

<span class="h1"><a class="selflink" name="appendix-C.3" href="#appendix-C.3">C.3</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-01">draft-ietf-httpbis-p7-auth-01</a></span>

   Ongoing work on ABNF conversion
   (&lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/36">http://tools.ietf.org/wg/httpbis/trac/ticket/36</a>&gt;):

   o  Explicitly import BNF rules for "challenge" and "credentials" from
      <a href="./rfc2617">RFC2617</a>.

   o  Add explicit references to BNF syntax and rules imported from
      other parts of the specification.

<span class="h1"><a class="selflink" name="appendix-C.4" href="#appendix-C.4">C.4</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-02">draft-ietf-httpbis-p7-auth-02</a></span>

   Ongoing work on IANA Message Header Field Registration
   (&lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/40">http://tools.ietf.org/wg/httpbis/trac/ticket/40</a>&gt;):

   o  Reference <a href="./rfc3984">RFC 3984</a>, and update header field registrations for
      header fields defined in this document.

<span class="h1"><a class="selflink" name="appendix-C.5" href="#appendix-C.5">C.5</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-03">draft-ietf-httpbis-p7-auth-03</a></span>

   None.

<span class="h1"><a class="selflink" name="appendix-C.6" href="#appendix-C.6">C.6</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-04">draft-ietf-httpbis-p7-auth-04</a></span>

   Ongoing work on ABNF conversion
   (&lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/36">http://tools.ietf.org/wg/httpbis/trac/ticket/36</a>&gt;):

   o  Use "/" instead of "|" for alternatives.

   o  Introduce new ABNF rules for "bad" whitespace ("BWS"), optional
      whitespace ("OWS") and required whitespace ("RWS").

   o  Rewrite ABNFs to spell out whitespace rules, factor out header
      field value format definitions.

<span class="h1"><a class="selflink" name="appendix-C.7" href="#appendix-C.7">C.7</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-05">draft-ietf-httpbis-p7-auth-05</a></span>

   Final work on ABNF conversion
   (&lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/36">http://tools.ietf.org/wg/httpbis/trac/ticket/36</a>&gt;):

   o  Add appendix containing collected and expanded ABNF, reorganize
      ABNF introduction.





<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 17]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-18" id="page-18" href="#page-18" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h1"><a class="selflink" name="appendix-C.8" href="#appendix-C.8">C.8</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-06">draft-ietf-httpbis-p7-auth-06</a></span>

   None.

<span class="h1"><a class="selflink" name="appendix-C.9" href="#appendix-C.9">C.9</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-07">draft-ietf-httpbis-p7-auth-07</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/198">http://tools.ietf.org/wg/httpbis/trac/ticket/198</a>&gt;: "move IANA
      registrations for optional status codes"

<span class="h1"><a class="selflink" name="appendix-C.10" href="#appendix-C.10">C.10</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-08">draft-ietf-httpbis-p7-auth-08</a></span>

   No significant changes.

<span class="h1"><a class="selflink" name="appendix-C.11" href="#appendix-C.11">C.11</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-09">draft-ietf-httpbis-p7-auth-09</a></span>

   Partly resolved issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/196">http://tools.ietf.org/wg/httpbis/trac/ticket/196</a>&gt;: "Term for the
      requested resource's URI"

<span class="h1"><a class="selflink" name="appendix-C.12" href="#appendix-C.12">C.12</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-10">draft-ietf-httpbis-p7-auth-10</a></span>

   None.

<span class="h1"><a class="selflink" name="appendix-C.13" href="#appendix-C.13">C.13</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-11">draft-ietf-httpbis-p7-auth-11</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/130">http://tools.ietf.org/wg/httpbis/trac/ticket/130</a>&gt;: "introduction
      to part 7 is work-in-progress"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/195">http://tools.ietf.org/wg/httpbis/trac/ticket/195</a>&gt;: "auth-param
      syntax"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/224">http://tools.ietf.org/wg/httpbis/trac/ticket/224</a>&gt;: "Header
      Classification"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/237">http://tools.ietf.org/wg/httpbis/trac/ticket/237</a>&gt;: "absorbing the
      auth framework from 2617"

   Partly resolved issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/141">http://tools.ietf.org/wg/httpbis/trac/ticket/141</a>&gt;: "should we
      have an auth scheme registry"





<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 18]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-19" id="page-19" href="#page-19" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h1"><a class="selflink" name="appendix-C.14" href="#appendix-C.14">C.14</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-12">draft-ietf-httpbis-p7-auth-12</a></span>

   None.

<span class="h1"><a class="selflink" name="appendix-C.15" href="#appendix-C.15">C.15</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-13">draft-ietf-httpbis-p7-auth-13</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/276">http://tools.ietf.org/wg/httpbis/trac/ticket/276</a>&gt;: "untangle
      ABNFs for header fields"

<span class="h1"><a class="selflink" name="appendix-C.16" href="#appendix-C.16">C.16</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-14">draft-ietf-httpbis-p7-auth-14</a></span>

   None.

<span class="h1"><a class="selflink" name="appendix-C.17" href="#appendix-C.17">C.17</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-15">draft-ietf-httpbis-p7-auth-15</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/78">http://tools.ietf.org/wg/httpbis/trac/ticket/78</a>&gt;: "Relationship
      between 401, Authorization and WWW-Authenticate"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/177">http://tools.ietf.org/wg/httpbis/trac/ticket/177</a>&gt;: "Realm
      required on challenges"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/195">http://tools.ietf.org/wg/httpbis/trac/ticket/195</a>&gt;: "auth-param
      syntax"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/257">http://tools.ietf.org/wg/httpbis/trac/ticket/257</a>&gt;:
      "Considerations for new authentications schemes"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/287">http://tools.ietf.org/wg/httpbis/trac/ticket/287</a>&gt;: "LWS in auth-
      param ABNF"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/309">http://tools.ietf.org/wg/httpbis/trac/ticket/309</a>&gt;: "credentials
      ABNF missing SP (still using implied LWS?)"

<span class="h1"><a class="selflink" name="appendix-C.18" href="#appendix-C.18">C.18</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-16">draft-ietf-httpbis-p7-auth-16</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/186">http://tools.ietf.org/wg/httpbis/trac/ticket/186</a>&gt;: "Document
      HTTP's error-handling philosophy"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/320">http://tools.ietf.org/wg/httpbis/trac/ticket/320</a>&gt;: "add advice on
      defining auth scheme parameters"





<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 19]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-20" id="page-20" href="#page-20" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


<span class="h1"><a class="selflink" name="appendix-C.19" href="#appendix-C.19">C.19</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-17">draft-ietf-httpbis-p7-auth-17</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/314">http://tools.ietf.org/wg/httpbis/trac/ticket/314</a>&gt;: "allow
      unquoted realm parameters"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/321">http://tools.ietf.org/wg/httpbis/trac/ticket/321</a>&gt;: "Repeating
      auth-params"

<span class="h1"><a class="selflink" name="appendix-C.20" href="#appendix-C.20">C.20</a>.  Since <a href="./draft-ietf-httpbis-p7-auth-18">draft-ietf-httpbis-p7-auth-18</a></span>

   Closed issues:

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/334">http://tools.ietf.org/wg/httpbis/trac/ticket/334</a>&gt;: "recipient
      behavior for new auth parameters"

   o  &lt;<a href="http://tools.ietf.org/wg/httpbis/trac/ticket/342">http://tools.ietf.org/wg/httpbis/trac/ticket/342</a>&gt;: "WWW-
      Authenticate ABNF slightly ambiguous"

Index

   4
      401 Unauthorized (status code)  9
      407 Proxy Authentication Required (status code)  9

   A
      auth-param  5
      auth-scheme  5
      Authorization header field  10

   B
      b64token  5

   C
      challenge  6
      credentials  6

   G
      Grammar
         auth-param  5
         auth-scheme  5
         Authorization  10
         b64token  5
         challenge  6
         credentials  6
         Proxy-Authenticate  11
         Proxy-Authorization  11



<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 20]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-21" id="page-21" href="#page-21" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


         WWW-Authenticate  12

   H
      Header Fields
         Authorization  10
         Proxy-Authenticate  11
         Proxy-Authorization  11
         WWW-Authenticate  11

   P
      Protection Space  7
      Proxy-Authenticate header field  11
      Proxy-Authorization header field  11

   R
      Realm  7

   S
      Status Codes
         401 Unauthorized  9
         407 Proxy Authentication Required  9

   W
      WWW-Authenticate header field  11

Authors' Addresses

   Roy T. Fielding (editor)
   Adobe Systems Incorporated
   345 Park Ave
   San Jose, CA  95110
   USA

   EMail: fielding@gbiv.com
   URI:   <a href="http://roy.gbiv.com/">http://roy.gbiv.com/</a>


   Yves Lafon (editor)
   World Wide Web Consortium
   W3C / ERCIM
   2004, rte des Lucioles
   Sophia-Antipolis, AM  06902
   France

   EMail: ylafon@w3.org
   URI:   <a href="http://www.raubacapeu.net/people/yves/">http://www.raubacapeu.net/people/yves/</a>





<span class="grey">Fielding, et al.       Expires September 13, 2012              [Page 21]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-22" id="page-22" href="#page-22" class="invisible"> </a>
<span class="grey">Internet-Draft              HTTP/1.1, Part 7                  March 2012</span>


   Julian F. Reschke (editor)
   greenbytes GmbH
   Hafenweg 16
   Muenster, NW  48155
   Germany

   Phone: +49 251 2807760
   Fax:   +49 251 2807761
   EMail: julian.reschke@greenbytes.de
   URI:   <a href="http://greenbytes.de/tech/webdav/">http://greenbytes.de/tech/webdav/</a>









































Fielding, et al.       Expires September 13, 2012              [Page 22]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
