<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:ietf-oauth-v2-bearer" />
<meta name="DC.Description.Abstract" content="This specification describes how to use bearer tokens in HTTP" />
<meta name="DC.Creator" content="Recordon, David" />
<meta name="DC.Creator" content="Hardt, Dick" />
<meta name="DC.Creator" content="Jones, Michael" />
<meta name="DC.Date.Issued" content="2012-07-12" />
<meta name="DC.Title" content="The OAuth 2.0 Authorization Framework: Bearer Token Usage" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-ietf-oauth-v2-bearer-00 - The OAuth 2.0 Authorization Framework: Bearer Token Usage</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-ietf-oauth-v2-bearer-00.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-ietf-oauth-v2-bearer-00.txt" title="PDF version of this document">pdf</a>|<a href="/id/draft-ietf-oauth-v2-bearer-00.xml" title="XML source for this document">xml</a>|<a href="/id/draft-ietf-oauth-v2-bearer-00.html" title="HTML version of this document, from XML2RFC">html</a>] [<a href='https://datatracker.ietf.org/doc/draft-ietf-oauth-v2-bearer' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/oauth" title="The working group handling this document">WG</a>] [<a href="mailto:draft-ietf-oauth-v2-bearer@tools.ietf.org?subject=draft-ietf-oauth-v2-bearer%20" title="Send email to the document authors">Email</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-ietf-oauth-v2-bearer-00.txt" title="Run an idnits check of this document">Nits</a>] [<a href="https://datatracker.ietf.org/ipr/search/?option=document_search&document_search=draft-ietf-oauth-v2-bearer" title="IPR disclosures related to this document">IPR</a>]           </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-ietf-oauth-v2-bearer-00">00</a> <a href="./draft-ietf-oauth-v2-bearer-01">01</a> <a href="./draft-ietf-oauth-v2-bearer-02">02</a> <a href="./draft-ietf-oauth-v2-bearer-03">03</a> <a href="./draft-ietf-oauth-v2-bearer-04">04</a> <a href="./draft-ietf-oauth-v2-bearer-05">05</a> <a href="./draft-ietf-oauth-v2-bearer-06">06</a> <a href="./draft-ietf-oauth-v2-bearer-07">07</a> <a href="./draft-ietf-oauth-v2-bearer-08">08</a> <a href="./draft-ietf-oauth-v2-bearer-09">09</a> <a href="./draft-ietf-oauth-v2-bearer-10">10</a> <a href="./draft-ietf-oauth-v2-bearer-11">11</a>                           
          <a href="./draft-ietf-oauth-v2-bearer-12">12</a> <a href="./draft-ietf-oauth-v2-bearer-13">13</a> <a href="./draft-ietf-oauth-v2-bearer-14">14</a> <a href="./draft-ietf-oauth-v2-bearer-15">15</a> <a href="./draft-ietf-oauth-v2-bearer-16">16</a> <a href="./draft-ietf-oauth-v2-bearer-17">17</a> <a href="./draft-ietf-oauth-v2-bearer-18">18</a> <a href="./draft-ietf-oauth-v2-bearer-19">19</a> <a href="./draft-ietf-oauth-v2-bearer-20">20</a> <a href="./draft-ietf-oauth-v2-bearer-21">21</a> <a href="./draft-ietf-oauth-v2-bearer-22">22</a>                              </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
Network Working Group                                      M. Jones, Ed.
Internet-Draft                                                 Microsoft
Intended status: Standards Track                         E. Hammer-Lahav
Expires: June 3, 2011                                             Yahoo!
                                                                D. Hardt
                                                             independent
                                                             D. Recordon
                                                                Facebook
                                                       November 30, 2010


                 <span class="h1">The OAuth 2.0 Protocol: Bearer Tokens</span>
                     <span class="h1">draft-ietf-oauth-v2-bearer-00</span>

Abstract

   This specification describes how to use bearer tokens when accessing
   OAuth 2.0 protected resources.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on June 3, 2011.

Copyright Notice

   Copyright (c) 2010 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


Table of Contents

   <a href="#section-1">1</a>.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Notational Conventions . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.2">1.2</a>.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
     <a href="#section-1.3">1.3</a>.  Overview . . . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Authenticated Requests . . . . . . . . . . . . . . . . . . . .  <a href="#page-4">4</a>
     <a href="#section-2.1">2.1</a>.  The Authorization Request Header Field . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.2">2.2</a>.  URI Query Parameter  . . . . . . . . . . . . . . . . . . .  <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Form-Encoded Body Parameter  . . . . . . . . . . . . . . .  <a href="#page-6">6</a>
     <a href="#section-2.4">2.4</a>.  The WWW-Authenticate Response Header Field . . . . . . . .  <a href="#page-7">7</a>
     <a href="#section-2.5">2.5</a>.  Error Codes  . . . . . . . . . . . . . . . . . . . . . . .  <a href="#page-8">8</a>
   <a href="#section-3">3</a>.  Security Considerations  . . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.1">3.1</a>.  Validate SSL Certificate Chains  . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.2">3.2</a>.  Always use TLS (https) . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.3">3.3</a>.  Don't store bearer tokens in cookies . . . . . . . . . . .  <a href="#page-9">9</a>
     <a href="#section-3.4">3.4</a>.  Issue short-lived bearer tokens  . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-A">Appendix A</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . .  <a href="#page-9">9</a>
   <a href="#appendix-B">Appendix B</a>.  Document History  . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   <a href="#section-4">4</a>.  Normative References . . . . . . . . . . . . . . . . . . . . . <a href="#page-10">10</a>
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-11">11</a>


























<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   OAuth enables clients to access protected resources by obtaining an
   access token (a string that denotes a specific scope, duration, and
   other attributes), rather than using the resource owner's
   credentials.

   Tokens are issued to third-party clients by an authorization server
   with the approval of the resource owner.  The client uses the access
   token to access the protected resources hosted by the resource
   server.  This specification describes how to make protected resource
   requests by treating an OAuth access token as a bearer token.

   This specification defines the use of OAuth over HTTP [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] (or
   HTTP over TLS as defined by [<a href="./rfc2818" title="&quot;HTTP Over TLS&quot;">RFC2818</a>]).  Other specifications may
   extend it for use with other transport protocols.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Notational Conventions</span>

   The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT',
   'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this
   document are to be interpreted as described in [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].

   This document uses the Augmented Backus-Naur Form (ABNF) notation of
   [<a href="#ref-I-D.ietf-httpbis-p1-messaging">I-D.ietf-httpbis-p1-messaging</a>].  Additionally, the following rules
   are included from [<a href="./rfc2617" title="&quot;HTTP Authentication: Basic and Digest Access Authentication&quot;">RFC2617</a>]: realm, auth-param; from [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>]: URI-
   Reference; and from [<a href="#ref-I-D.ietf-httpbis-p1-messaging">I-D.ietf-httpbis-p1-messaging</a>]: OWS, RWS, and
   quoted-string.

   Unless otherwise noted, all the protocol parameter names and values
   are case sensitive.

<span class="h3"><a class="selflink" name="section-1.2" href="#section-1.2">1.2</a>.  Terminology</span>

   All terms are as defined in The OAuth 2.0 Protocol [<a href="#ref-OAuth2" title="&quot;The OAuth 2.0 Protocol&quot;">OAuth2</a>].

<span class="h3"><a class="selflink" name="section-1.3" href="#section-1.3">1.3</a>.  Overview</span>

   OAuth provides a method for clients to access a protected resource on
   behalf of a resource owner.  Before a client can access a protected
   resource, it must first obtain authorization (access grant) from the
   resource owner, then exchange the access grant for an access token
   (representing the grant's scope, duration, and other attributes).
   The client accesses the protected resource by presenting the access
   token to the resource server.

   The access token provides an abstraction layer, replacing different
   authorization constructs (e.g. username and password, assertion) for



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   a single token understood by the resource server.  This abstraction
   enables issuing access tokens valid for a short time period, as well
   as removing the resource server's need to understand a wide range of
   authentication schemes.

   +--------+                               +---------------+
   |        |--(A)- Authorization Request -&gt;|   Resource    |
   |        |                               |     Owner     |
   |        |&lt;-(B)----- Access Grant -------|               |
   |        |                               +---------------+
   |        |
   |        |           Access Grant &amp;      +---------------+
   |        |--(C)--- Client Credentials --&gt;| Authorization |
   | Client |                               |     Server    |
   |        |&lt;-(D)----- Access Token -------|               |
   |        |                               +---------------+
   |        |
   |        |                               +---------------+
   |        |--(E)----- Access Token ------&gt;|    Resource   |
   |        |                               |     Server    |
   |        |&lt;-(F)--- Protected Resource ---|               |
   +--------+                               +---------------+

                     Figure 1: Abstract Protocol Flow

   The abstract flow illustrated in Figure 1 describes the overall OAuth
   2.0 protocol architecture.  The following steps are specified within
   this document:

      E) The client makes a protected resource request to the resource
      server by presenting the access token.

      F) The resource server validates the access token, and if valid,
      serves the request.


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Authenticated Requests</span>

   Clients make authenticated token requests using the "Authorization"
   request header field.  Resource servers MUST accept authenticated
   requests using the "OAuth" HTTP authentication scheme as described in
   <a href="#section-2.1">Section 2.1</a>, and MAY support additional methods.

   Alternatively, clients MAY attempt to include the access token using
   the HTTP request URI in the query component as described in
   <a href="#section-2.2">Section 2.2</a>, or in the HTTP body when using the
   "application/x-www-form-urlencoded" content type as described in
   <a href="#section-2.3">Section 2.3</a>.  Resource server MAY support these alternative methods.



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   Clients SHOULD only use the request URI or body when the
   "Authorization" request header field is not available, and MUST NOT
   use more than one method in each request.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  The Authorization Request Header Field</span>

   The "Authorization" request header field is used by clients to make
   authenticated token requests.  The client uses the "OAuth"
   authentication scheme to include the access token in the request.

   For example:

   GET /resource HTTP/1.1
   Host: server.example.com
   Authorization: OAuth vF9dft4qmT

   The "Authorization" header field uses the framework defined by
   [<a href="./rfc2617" title="&quot;HTTP Authentication: Basic and Digest Access Authentication&quot;">RFC2617</a>] as follows:

   credentials    = "OAuth" RWS access-token [ RWS 1#auth-param ]
   access-token   = 1*( quoted-char / &lt;"&gt; )

   quoted-char    =   "!" / "#" / "$" / "%" / "&amp;" / "'" / "("
                    / ")" / "*" / "+" / "-" / "." / "/" / DIGIT
                    / ":" / "&lt;" / "=" / "&gt;" / "?" / "@" / ALPHA
                    / "[" / "]" / "^" / "_" / "`" / "{" / "|"
                    / "}" / "~" / "\" / "," / ";"

      NOTE: [<a href="./rfc5849" title="&quot;The OAuth 1.0 Protocol&quot;">RFC5849</a>] defines a different format for the "OAuth"
      authentication scheme.  Resource servers can differentiate between
      the two protocol versions based on the presence of the
      "oauth_signature_method" which is REQUIRED in the previous version
      and is not supported by this specification.

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  URI Query Parameter</span>

   When including the access token in the HTTP request URI, the client
   adds the access token to the request URI query component as defined
   by [<a href="./rfc3986" title="&quot;Uniform Resource Identifier (URI): Generic Syntax&quot;">RFC3986</a>] using the "oauth_token" parameter.

   For example, the client makes the following HTTP request using
   transport-layer security:

   GET /resource?oauth_token=vF9dft4qmT HTTP/1.1
   Host: server.example.com

   The HTTP request URI query can include other request-specific
   parameters, in which case, the "oauth_token" parameters SHOULD be



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   appended following the request-specific parameters, properly
   separated by an "&amp;" character (ASCII code 38).

   For example:

   http://example.com/resource?x=y&amp;oauth_token=vF9dft4qmT

      NOTE: The "oauth_token" parameter is used by the previous version
      of the OAuth protocol as described in [<a href="./rfc5849" title="&quot;The OAuth 1.0 Protocol&quot;">RFC5849</a>].  Resource servers
      can differentiate between the two protocol versions based on the
      presence of the "oauth_signature_method" which is REQUIRED in the
      previous version and is not supported by this specification.

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Form-Encoded Body Parameter</span>

   When including the access token in the HTTP request entity-body, the
   client adds the access token to the request body using the
   "oauth_token" parameter.  The client can use this method only if the
   following REQUIRED conditions are met:

   o  The entity-body is single-part.

   o  The entity-body follows the encoding requirements of the
      "application/x-www-form-urlencoded" content-type as defined by
      [<a href="#ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>].

   o  The HTTP request entity-header includes the "Content-Type" header
      field set to "application/x-www-form-urlencoded".

   o  The HTTP request method is "POST", "PUT", or "DELETE".

   The entity-body can include other request-specific parameters, in
   which case, the "oauth_token" parameters SHOULD be appended following
   the request-specific parameters, properly separated by an "&amp;"
   character (ASCII code 38).

   For example, the client makes the following HTTP request using
   transport-layer security:

   POST /resource HTTP/1.1
   Host: server.example.com
   Content-Type: application/x-www-form-urlencoded

   oauth_token=vF9dft4qmT

      NOTE: The "oauth_token" parameter is used by the previous version
      of the OAuth protocol as described in [<a href="./rfc5849" title="&quot;The OAuth 1.0 Protocol&quot;">RFC5849</a>].  Resource servers
      can differentiate between the two protocol versions based on the



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


      presence of the "oauth_signature_method" which is REQUIRED in the
      previous version and is not supported by this specification.

<span class="h3"><a class="selflink" name="section-2.4" href="#section-2.4">2.4</a>.  The WWW-Authenticate Response Header Field</span>

   If the protected resource request contains an invalid access token or
   is malformed, the resource server MUST include the HTTP
   "WWW-Authenticate" response header field.  The "WWW-Authenticate"
   header field uses the framework defined by [<a href="./rfc2617" title="&quot;HTTP Authentication: Basic and Digest Access Authentication&quot;">RFC2617</a>] as follows:

   challenge       = "OAuth" RWS token-challenge

   token-challenge = realm
                     [ CS error ]
                     [ CS error-desc ]
                     [ CS error-uri ]
                     [ CS scope ]
                     [ CS 1#auth-param ]

   error           = "error" "=" &lt;"&gt; token &lt;"&gt;
   error-desc      = "error_description" "=" quoted-string
   error-uri       = "error_uri" = &lt;"&gt; URI-Reference &lt;"&gt;
   scope           = quoted-value /
                     &lt;"&gt; quoted-value *( 1*SP quoted-value ) &lt;"&gt;
   quoted-value    = 1*quoted-char

   CS              = OWS "," OWS

   For example:

   HTTP/1.1 401 Unauthorized
   WWW-Authenticate: OAuth realm="Example Service",
   error="invalid_token",
   error_description="The access token expired"

   The "realm" attribute is used to provide the protected resources
   partition as defined by [<a href="./rfc2617" title="&quot;HTTP Authentication: Basic and Digest Access Authentication&quot;">RFC2617</a>]. [[ add explanation ]]

   The "error" attribute is used to provide the client with the reason
   why the access request was declined.  The parameter values are
   described in <a href="#section-2.5">Section 2.5</a>.

   The "error_description" attribute provides a human-readable text
   containing additional information, used to assist in the
   understanding and resolution of the error occurred.

   The "error_uri" attribute provides a URI identifying a human-readable
   web page with information about the error, used to offer the end-user



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   with additional information about the error.  If the value is not an
   absolute URI, it is relative to the URI of the requested protected
   resource.

   The "scope" attribute is a space-delimited list of scope values
   indicating the required scope of the access token for accessing the
   requested resource.

<span class="h3"><a class="selflink" name="section-2.5" href="#section-2.5">2.5</a>.  Error Codes</span>

   When a request fails, the resource server responds using the
   appropriate HTTP status code (typically, 400, 401, or 403), and
   includes one of the following error codes in the response:

   invalid_request
         The request is missing a required parameter, includes an
         unsupported parameter or parameter value, repeats the same
         parameter, uses more than one method for including an access
         token, or is otherwise malformed.  The resource server SHOULD
         respond with the HTTP 400 (Bad Request) status code.

   invalid_token
         The access token provided is expired, revoked, malformed, or
         invalid for other reasons.  The resource SHOULD respond with
         the HTTP 401 (Unauthorized) status code.  The client MAY
         request a new access token and retry the protected resource
         request.

   insufficient_scope
         The request requires higher privileges than provided by the
         access token.  The resource server SHOULD respond with the HTTP
         403 (Forbidden) status code and MAY include the "scope"
         attribute with the scope necessary to access the protected
         resource.

   [[ Add mechanism for extending error codes ]]

   If the request lacks any authentication information (i.e. the client
   was unaware authentication is necessary or attempted using an
   unsupported authentication method), the resource server SHOULD not
   include an error code or other error information.

   For example:

   HTTP/1.1 401 Unauthorized
   WWW-Authenticate: OAuth realm="Example Service"





<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Security Considerations</span>

   Implementers and deployers must ensure that bearer tokens are not
   leaked to unintended parties, as they will be able to use them to
   gain access to protected resources.  This is the primary security
   consideration when using bearer tokens with OAuth and underlies all
   the more specific statements that follow.

<span class="h3"><a class="selflink" name="section-3.1" href="#section-3.1">3.1</a>.  Validate SSL Certificate Chains</span>

   The client must validate the TLS certificate chain when making
   requests to protected resources.  Failing to do so may enable DNS
   hijacking attacks to steal the token and gain unintended access.

<span class="h3"><a class="selflink" name="section-3.2" href="#section-3.2">3.2</a>.  Always use TLS (https)</span>

   Clients must always use TLS (https) when making requests with bearer
   tokens.  Failing to do so exposes the token to numerous attacks that
   could give attackers unintended access.

<span class="h3"><a class="selflink" name="section-3.3" href="#section-3.3">3.3</a>.  Don't store bearer tokens in cookies</span>

   As cookies are generally sent in the clear, implementations must not
   store bearer tokens within them.

<span class="h3"><a class="selflink" name="section-3.4" href="#section-3.4">3.4</a>.  Issue short-lived bearer tokens</span>

   Using short-lived (one hour or less) bearer tokens can reduce the
   impact of one of them being leaked.  The User-Agent flow should only
   issue short lived access tokens.


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Acknowledgements</span>

   The following people contributed to preliminary versions of this
   document: Blaine Cook (BT), Brian Eaton (Google), Yaron Goland
   (Microsoft), Brent Goldman (Facebook), Raffi Krikorian (Twitter),
   Luke Shepard (Facebook), and Allen Tom (Yahoo!).  The content and
   concepts within are a product of the OAuth community, WRAP community,
   and the OAuth Working Group.

   The OAuth Working Group has dozens of very active contributors who
   proposed ideas and wording for this document, including: [[ If your
   name is missing or you think someone should be added here, please
   send Mike Jones a note - don't be shy ]]

   Michael Adams, Andrew Arnott, Dirk Balfanz, Brian Campbell, Leah
   Culver, Bill de hOra, Brian Ellin, Igor Faynberg, George Fletcher,



<span class="grey">Jones, et al.             Expires June 3, 2011                  [Page 9]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-10" id="page-10" href="#page-10" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   Tim Freeman, Evan Gilbert, Justin Hart, John Kemp, Chasen Le Hara,
   Michael B. Jones, Torsten Lodderstedt, Eve Maler, James Manger,
   Laurence Miao, Chuck Mortimore, Justin Richer, Peter Saint-Andre, Nat
   Sakimura, Rob Sayre, Marius Scurtescu, Naitik Shah, Justin Smith,
   Jeremy Suriel, Christian Stuebner, Paul Tarjan, and Franklin Tse.


<span class="h2"><a class="selflink" name="appendix-B" href="#appendix-B">Appendix B</a>.  Document History</span>

   [[ to be removed by RFC editor before publication as an RFC ]]

   -00

   o  Initial draft based on preliminary version of OAuth 2.0 draft 11.


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  Normative References</span>

   [<a name="ref-I-D.ietf-httpbis-p1-messaging" id="ref-I-D.ietf-httpbis-p1-messaging">I-D.ietf-httpbis-p1-messaging</a>]
              Fielding, R., Gettys, J., Mogul, J., Nielsen, H.,
              Masinter, L., Leach, P., Berners-Lee, T., and J. Reschke,
              "HTTP/1.1, part 1: URIs, Connections, and Message
              Parsing", <a href="./draft-ietf-httpbis-p1-messaging-09">draft-ietf-httpbis-p1-messaging-09</a> (work in
              progress), March 2010.

   [<a name="ref-OAuth2" id="ref-OAuth2">OAuth2</a>]   Hammer-Lahav, E., Ed., Recordon, D., and D. Hardt, "The
              OAuth 2.0 Protocol", 2010.

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a name="ref-RFC2617" id="ref-RFC2617">RFC2617</a>]  Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
              Leach, P., Luotonen, A., and L. Stewart, "HTTP
              Authentication: Basic and Digest Access Authentication",
              <a href="./rfc2617">RFC 2617</a>, June 1999.

   [<a name="ref-RFC2818" id="ref-RFC2818">RFC2818</a>]  Rescorla, E., "HTTP Over TLS", <a href="./rfc2818">RFC 2818</a>, May 2000.

   [<a name="ref-RFC3986" id="ref-RFC3986">RFC3986</a>]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              <a href="./rfc3986">RFC 3986</a>, January 2005.

   [<a name="ref-RFC5849" id="ref-RFC5849">RFC5849</a>]  Hammer-Lahav, E., "The OAuth 1.0 Protocol", <a href="./rfc5849">RFC 5849</a>,
              April 2010.



<span class="grey">Jones, et al.             Expires June 3, 2011                 [Page 10]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-11" id="page-11" href="#page-11" class="invisible"> </a>
<span class="grey">Internet-Draft           OAuth 2.0 Bearer Tokens           November 2010</span>


   [<a name="ref-W3C.REC-html401-19991224" id="ref-W3C.REC-html401-19991224">W3C.REC-html401-19991224</a>]
              Raggett, D., Hors, A., and I. Jacobs, "HTML 4.01
              Specification", World Wide Web Consortium
              Recommendation REC-html401-19991224, December 1999,
              &lt;<a href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.


Authors' Addresses

   Michael B. Jones (editor)
   Microsoft

   Email: mbj@microsoft.com
   URI:   <a href="http://self-issued.info/">http://self-issued.info/</a>


   Eran Hammer-Lahav
   Yahoo!

   Email: eran@hueniverse.com
   URI:   <a href="http://hueniverse.com">http://hueniverse.com</a>


   Dick Hardt
   independent

   Email: dick.hardt@gmail.com
   URI:   <a href="http://dickhardt.org/">http://dickhardt.org/</a>


   David Recordon
   Facebook

   Email: davidrecordon@facebook.com
   URI:   <a href="http://www.davidrecordon.com/">http://www.davidrecordon.com/</a>
















Jones, et al.             Expires June 3, 2011                 [Page 11]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
