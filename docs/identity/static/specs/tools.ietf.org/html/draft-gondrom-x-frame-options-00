<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="robots" content="index,follow" />
    <meta name="creator" content="rfcmarkup version 1.101" />
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" />
<meta name="DC.Identifier" content="urn:ietf:id:gondrom-x-frame-options" />
<meta name="DC.Description.Abstract" content="To improve the protection of web applications against Cross Site" />
<meta name="DC.Creator" content="Gondrom, Tobias" />
<meta name="DC.Creator" content="&lt;&gt;, David Ross" />
<meta name="DC.Date.Issued" content="2012-03-05" />
<meta name="DC.Title" content="HTTP Header X-Frame-Options" />

    <link rel="icon" href="/images/id.png" type="image/png" />
    <link rel="shortcut icon" href="/images/id.png" type="image/png" />
    <title>draft-gondrom-x-frame-options-00 - HTTP Header X-Frame-Options</title>
    
    
    <style type="text/css">
	body {
	    margin: 0px 8px;
            font-size: 1em;
	}
        h1, h2, h3, h4, h5, h6, .h1, .h2, .h3, .h4, .h5, .h6 {
	    font-weight: bold;
            line-height: 0pt;
            display: inline;
            white-space: pre;
            font-family: monospace;
            font-size: 1em;
	    font-weight: bold;
        }
        pre {
            font-size: 1em;
            margin-top: 0px;
            margin-bottom: 0px;
        }
	.pre {
	    white-space: pre;
	    font-family: monospace;
	}
	.header{
	    font-weight: bold;
	}
        .newpage {
            page-break-before: always;
        }
        .invisible {
            text-decoration: none;
            color: white;
        }
        a.selflink {
          color: black;
          text-decoration: none;
        }
        @media print {
            body {
                font-family: monospace;
                font-size: 10.5pt;
            }
            h1, h2, h3, h4, h5, h6 {
                font-size: 1em;
            }
        
            a:link, a:visited {
                color: inherit;
                text-decoration: none;
            }
            .noprint {
                display: none;
            }
        }
	@media screen {
	    .grey, .grey a:link, .grey a:visited {
		color: #777;
	    }
            .docinfo {
                background-color: #EEE;
            }
            .top {
                border-top: 7px solid #EEE;
            }
            .bgwhite  { background-color: white; }
            .bgred    { background-color: #F44; }
            .bggrey   { background-color: #666; }
            .bgbrown  { background-color: #840; }            
            .bgorange { background-color: #FA0; }
            .bgyellow { background-color: #EE0; }
            .bgmagenta{ background-color: #F4F; }
            .bgblue   { background-color: #66F; }
            .bgcyan   { background-color: #4DD; }
            .bggreen  { background-color: #4F4; }

            .legend   { font-size: 90%; }
            .cplate   { font-size: 70%; border: solid grey 1px; }
	}
    </style>
    <!--[if IE]>
    <style>
    body {
       font-size: 13px;
       margin: 10px 10px;
    }
    </style>
    <![endif]-->

    <script type="text/javascript"><!--
    function addHeaderTags() {
	var spans = document.getElementsByTagName("span");
	for (var i=0; i < spans.length; i++) {
	    var elem = spans[i];
	    if (elem) {
		var level = elem.getAttribute("class");
                if (level == "h1" || level == "h2" || level == "h3" || level == "h4" || level == "h5" || level == "h6") {
                    elem.innerHTML = "<"+level+">"+elem.innerHTML+"</"+level+">";		
                }
	    }
	}
    }
    var legend_html = "Colour legend:<br />      <table>         <tr><td>Unknown:</td>          <td><span class='cplate bgwhite'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft:</td>            <td><span class='cplate bgred'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Informational:</td>    <td><span class='cplate bgorange'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Experimental:</td>     <td><span class='cplate bgyellow'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Best Common Practice:</td><td><span class='cplate bgmagenta'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Proposed Standard:</td><td><span class='cplate bgblue'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Draft Standard:</td>   <td><span class='cplate bgcyan'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Standard:</td>         <td><span class='cplate bggreen'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Historic:</td>         <td><span class='cplate bggrey'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>         <tr><td>Obsolete:</td>         <td><span class='cplate bgbrown'>&nbsp;&nbsp;&nbsp;&nbsp;</span></td></tr>     </table>";
    function showElem(id) {
        var elem = document.getElementById(id);
        elem.innerHTML = eval(id+"_html");
        elem.style.visibility='visible';
    }
    function hideElem(id) {
        var elem = document.getElementById(id);
        elem.style.visibility='hidden';        
        elem.innerHTML = "";
    }
    // -->
    </script>
</head>
<body onload="addHeaderTags()">
   <div style="height: 13px;">
      <div onmouseover="this.style.cursor='pointer';"
         onclick="showElem('legend');"
         onmouseout="hideElem('legend')"
	 style="height: 6px; position: absolute;"
         class="pre noprint docinfo bgred"
         title="Click for colour legend." >                                                                        </div>
      <div id="legend"
           class="docinfo noprint pre legend"
           style="position:absolute; top: 4px; left: 4ex; visibility:hidden; background-color: white; padding: 4px 9px 5px 7px; border: solid #345 1px; "
           onmouseover="showElem('legend');"
           onmouseout="hideElem('legend');">
      </div>
   </div>
<span class="pre noprint docinfo top">[<a href="../html/" title="Document search and retrieval page">Docs</a>] [<a href="http://tools.ietf.org/id/draft-gondrom-x-frame-options-00.txt" title="Plaintext version of this document">txt</a>|<a href="/pdf/draft-gondrom-x-frame-options-00.txt" title="PDF version of this document">pdf</a>] [<a href='https://datatracker.ietf.org/doc/draft-gondrom-x-frame-options' title='IESG Datatracker information for this document'>Tracker</a>] [<a href="../wg/websec" title="The working group handling this document">WG</a>] [<a href="mailto:draft-gondrom-x-frame-options@tools.ietf.org?subject=draft-gondrom-x-frame-options%20" title="Send email to the document authors">Email</a>] [<a href="/idnits?url=http://tools.ietf.org/id/draft-gondrom-x-frame-options-00.txt" title="Run an idnits check of this document">Nits</a>]                          </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<span class="pre noprint docinfo">Versions: <a href="./draft-gondrom-x-frame-options-00">00</a>                                                            </span><br />
<span class="pre noprint docinfo">                                                                        </span><br />
<pre>
WEBSEC                                                           D. Ross
Internet-Draft                                                 Microsoft
Intended status: Informational                                T. Gondrom
Expires: September 6, 2012                                 March 5, 2012


                      <span class="h1">HTTP Header X-Frame-Options</span>
                    <span class="h1">draft-gondrom-x-frame-options-00</span>

Abstract

   To improve the protection of web applications against Cross Site
   Request Forgery (CSRF) and Clickjacking this standards defines a http
   response header that declares a policy communicated from a host to
   the client browser whether the transmitted content MUST NOT be
   displayed in frames of other pages from different origins or a list
   of trusted origins which are allowed to frame the content.  This
   drafts serves to document the existing use and specification of
   X-Frame-Options.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of <a href="./bcp78">BCP 78</a> and <a href="./bcp79">BCP 79</a>.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 6, 2012.

Copyright Notice

   Copyright (c) 2012 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to <a href="./bcp78">BCP 78</a> and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 1]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-2" id="page-2" href="#page-2" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


   include Simplified BSD License text as described in <a href="#section-4">Section 4</a>.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


Table of Contents

   <a href="#section-1">1</a>.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
     <a href="#section-1.1">1.1</a>.  Requirements Language . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
   <a href="#section-2">2</a>.  Frame-Options Header  . . . . . . . . . . . . . . . . . . . . . <a href="#page-3">3</a>
     <a href="#section-2.1">2.1</a>.  Syntax  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-4">4</a>
     <a href="#section-2.2">2.2</a>.  Backus-Naur Form (BNF)  . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
     <a href="#section-2.3">2.3</a>.  Design Issues . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-5">5</a>
       <a href="#section-2.3.1">2.3.1</a>.  Enable HTML content from other domains  . . . . . . . . <a href="#page-5">5</a>
       <a href="#section-2.3.2">2.3.2</a>.  Browser Behaviour and Processing  . . . . . . . . . . . <a href="#page-5">5</a>
     <a href="#section-2.4">2.4</a>.  Examples of Frame-Options Headers . . . . . . . . . . . . . <a href="#page-6">6</a>
       <a href="#section-2.4.1">2.4.1</a>.  Example scenario for the ALLOW-FROM parameter . . . . . <a href="#page-6">6</a>
   <a href="#section-3">3</a>.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>
   <a href="#section-4">4</a>.  IANA Considerations . . . . . . . . . . . . . . . . . . . . . . <a href="#page-6">6</a>
     <a href="#section-4.1">4.1</a>.  Registration Template . . . . . . . . . . . . . . . . . . . <a href="#page-7">7</a>
   <a href="#section-5">5</a>.  Security Considerations . . . . . . . . . . . . . . . . . . . . <a href="#page-7">7</a>
   <a href="#section-6">6</a>.  References  . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-7">7</a>
     <a href="#section-6.1">6.1</a>.  Normative References  . . . . . . . . . . . . . . . . . . . <a href="#page-7">7</a>
     <a href="#section-6.2">6.2</a>.  Informative References  . . . . . . . . . . . . . . . . . . <a href="#page-7">7</a>
   <a href="#appendix-A">Appendix A</a>.  Description of a Clickjacking attack . . . . . . . . . <a href="#page-8">8</a>
     <a href="#appendix-A.1">A.1</a>.  Shop  . . . . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-8">8</a>
     <a href="#appendix-A.2">A.2</a>.  Confirm Purchase Page . . . . . . . . . . . . . . . . . . . <a href="#page-9">9</a>
     <a href="#appendix-A.3">A.3</a>.  Flash Configuration . . . . . . . . . . . . . . . . . . . . <a href="#page-9">9</a>
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . . . <a href="#page-9">9</a>






















<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 2]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-3" id="page-3" href="#page-3" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


<span class="h2"><a class="selflink" name="section-1" href="#section-1">1</a>.  Introduction</span>

   In 2009 and 2010 many browser vendors introduced the use of a non-
   standard http header <a href="./rfc2616">RFC 2616</a> [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>] "X-Frame-Options" to protect
   against Clickjacking [<a href="#ref-Clickjacking">Clickjacking</a>] and Cross Site Request Forgery
   (CSRF) [<a href="#ref-CSRF" title="&quot;OWASP Top-10: Cross-Site Request Forgery (CSRF)&quot;">CSRF</a>].  This draft is to document the current use of X-Frame-
   Options header and shall in the future be replaced by the Frame-
   Options (CSRF) [<a href="#ref-FRAME-OPTIONS">FRAME-OPTIONS</a>] standard.

   In some forms of Clickjacking and CSRF an attacker tricks a user into
   clicking on a button or link to another page and by thus executing an
   unintended command in the context of a different web application.
   For example with Clickjacking the attacker might use transparent or
   opaque layers to integrate and obscure a button to another page so
   that the user may click on it in the expectation of a different
   action.  So, in this way the attacker is "hijacking" the "Click" on a
   button meant by the user to be sent to host A, while clicking the
   button in effect sends a message to host B. If the user does for
   example also have an open session with host B this can lead to a CSRF
   attack and executing a command in the session context of the user
   (using the user's authentication and authorization) on host B without
   his intention or knowledge.

   Existing anti-ClickJacking measures, e.g.  Frame-breaking Javascript,
   have weaknesses so that their protection can be circumvented as a
   study [<a href="#ref-FRAME-BUSTING">FRAME-BUSTING</a>] demonstrated.

   Short of configuring the browser to disable frames and script
   entirely, which massively impairs browser utility, browser users are
   vulnerable to this type of attack.

   The by "Frame-Options" provided defense mechanism against
   Clickjacking is to allow a secure web page from host B to declare
   that its content (for example a button, links, text, etc.) must not
   be displayed in a frame of another page (e.g. from host A).  In
   principle this is done by a policy declared in the HTTP header and
   obeyed by conform browser implementations.

<span class="h3"><a class="selflink" name="section-1.1" href="#section-1.1">1.1</a>.  Requirements Language</span>

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a href="./rfc2119">RFC 2119</a> [<a href="./rfc2119" title="&quot;Key words for use in RFCs to Indicate Requirement Levels&quot;">RFC2119</a>].


<span class="h2"><a class="selflink" name="section-2" href="#section-2">2</a>.  Frame-Options Header</span>

   The Frame-Options HTTP response header indicates a policy whether a



<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 3]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-4" id="page-4" href="#page-4" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


   browser MUST NOT allow to render a page in a &lt;frame&gt; or &lt;iframe&gt; .
   Hosts can declare this policy in the header of their HTTP responses
   to prevent clickjacking attacks, by ensuring that their content is
   not embedded into other pages or frames.

<span class="h3"><a class="selflink" name="section-2.1" href="#section-2.1">2.1</a>.  Syntax</span>

   The header field name is:
   Frame-Options

   There are three different values for the header field.  These values
   are exclusive, that is NOT more than one of the three values MUST be
   set.

   DENY
         A browser receiving content with this header MUST NOT display
         this content in any frame.

   SAMEORIGIN
         A browser receiving content with this header MUST NOT display
         this content in any frame from a page of different origin than
         the content itself.
         If a browser or plugin can not reliably determine whether the
         origin of the content and the frame have the same origin, this
         MUST be treated as "DENY".
         [<a href="#ref-TBD">TBD</a>]current implementations do not display if the origin of
         the top-level-browsing-context is different than the origin of
         the page containing the FRAME-OPTIONS header.

   ALLOW-FROM  (followed by a list of URIs of trusted origins)
         A browser receiving content with this header MUST NOT display
         this content in any frame from a page of different origin than
         any of the listed origins.  This allows deployment with multi-
         domain sites, as the webmaster can define a whitelist of
         origins that are allowed to frame the page.  While this can
         expose the page to risks by the trusted origins, in some cases
         it may be necessary to use content from other domains or more
         than one origin (hostname).
         for example: FRAME-OPTIONS: ALLOW-FROM <a href="https://www.domain.com/">https://www.domain.com/</a>

   The URIs listed for ALLOW-FROM must be valid.
   Any data beyond the domain address (i.e. any data after the "/"
   separator) is to be ignored and to verify a referring page is of the
   same origin as the content or that the referring page is listed in
   the ALLOW-FROM list of URI, the algorithm to compare origins from
   [<a href="./rfc6454" title="&quot;The Web Origin Concept&quot;">RFC6454</a>] should be used.

   Wildcards to declare multiple domains in one statement are not



<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 4]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-5" id="page-5" href="#page-5" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


   permitted.

   [<a name="ref-TBD" id="ref-TBD">TBD</a>] Current Implementations do not consider the port a component of
   the origin - conflicting with [<a href="./rfc6454" title="&quot;The Web Origin Concept&quot;">RFC6454</a>].

<span class="h3"><a class="selflink" name="section-2.2" href="#section-2.2">2.2</a>.  Backus-Naur Form (BNF)</span>

   The <a href="./rfc822">RFC 822</a> [<a href="./rfc0822" title="&quot;Standard for the format of ARPA Internet text messages&quot;">RFC0822</a>] EBNF of the Frame-Options header is:

         Frame-Options = "Frame-Options" ":" "DENY"/ "SAMEORIGIN" /
                                 ("ALLOW-FROM" ":" Origin-List)
             Origin-List = 1*URI


   [<a name="ref-TBD" id="ref-TBD">TBD</a>] with URI as defined in the websec-origin draft
   [<a href="#ref-TBD">TBD</a>] Or should we use the ABNF (<a href="./rfc2234">RFC 2234</a>) alternatively or in
   addition?

<span class="h3"><a class="selflink" name="section-2.3" href="#section-2.3">2.3</a>.  Design Issues</span>

<span class="h4"><a class="selflink" name="section-2.3.1" href="#section-2.3.1">2.3.1</a>.  Enable HTML content from other domains</span>

   There are three main direct vectors that enable HTML content from
   other domains:

   o  IFRAME Tag

   o  Frame tag

   o  The Object tag (requires a redirect)

   Besides these other ways to host HTML content can be possible.  For
   example some plugins may host HTML views directly.  To allow a
   conform security configuration those plugins MUST be conform to the
   FRAME-OPTIONS directive as specified in this draft as well.

<span class="h4"><a class="selflink" name="section-2.3.2" href="#section-2.3.2">2.3.2</a>.  Browser Behaviour and Processing</span>

   To allow secure implementations browser implementations MUST behave
   in a consistent and reliable way conform to thsi specition.

   If a HTTP Header prohibits framing, the user-agent of the browser MAY
   immediately abort downloading or parsing of the document.

   When a browser discovers loaded content with the FRAME-OPTIONS header
   would be displayed in a frame against the specified origin orders of
   the header, the browser SHOULD redirect as soon as possible to a "No-
   Frame" page.



<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 5]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-6" id="page-6" href="#page-6" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


   "No-Frame" Page
   If the display of content is denied by the FRAME-OPTIONS header an
   accroding error page SHOULD be displayed.  For example this can be a
   noframe.html page also stating the full URL of the protected page and
   the hostname of the protected page.

   [<a name="ref-TBD" id="ref-TBD">TBD</a>] The NoFrame page MAY provide the user with an option to open
   the target URL in a new window.

<span class="h3"><a class="selflink" name="section-2.4" href="#section-2.4">2.4</a>.  Examples of Frame-Options Headers</span>

<span class="h4"><a class="selflink" name="section-2.4.1" href="#section-2.4.1">2.4.1</a>.  Example scenario for the ALLOW-FROM parameter</span>

   1.  Inner IFRAME suggests via a querystring parameter what site it
       wants to be hosted by.  This can obviously be specified by an
       attacker, but that's OK.

   2.  Server verifies the hostname meets whatever criteria.  For
       example, for a Facebook "Like" button, the server can check to
       see that the supplied hostname matches the hostname expected for
       that Like button.

   3.  Server serves up the hostname in X-FRAME-OPTIONS: ALLOW-FROM if
       the proper criteria was met in step #2.

   4.  Browser enforces the X-FRAME-OPTIONS: ALLOW-FROM domain.com
       header.


<span class="h2"><a class="selflink" name="section-3" href="#section-3">3</a>.  Acknowledgements</span>

   This document was derived from input from specifications published by
   various browser vendors like Microsoft (Eric Lawrence, David Ross),
   Mozilla, Google, Opera and Apple.


<span class="h2"><a class="selflink" name="section-4" href="#section-4">4</a>.  IANA Considerations</span>

   This memo a request to IANA to include the specified HTTP header in
   registry as outlined in Registration Procedures for Message Header
   Fields [<a href="./rfc3864" title="&quot;Registration Procedures for Message Header Fields&quot;">RFC3864</a>]










<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 6]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-7" id="page-7" href="#page-7" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


<span class="h3"><a class="selflink" name="section-4.1" href="#section-4.1">4.1</a>.  Registration Template</span>


   PERMANENT MESSAGE HEADER FIELD REGISTRATION TEMPLATE:

   Header field name: Frame-Option

   Applicable protocol: http [<a href="./rfc2616" title="&quot;Hypertext Transfer Protocol -- HTTP/1.1&quot;">RFC2616</a>]

   Status: Standard

   Author/Change controller: IETF

   Specification document(s): <a href="./draft-gondrom-frame-options">draft-gondrom-frame-options</a>

   Related information:

                                 Figure 1


<span class="h2"><a class="selflink" name="section-5" href="#section-5">5</a>.  Security Considerations</span>

   The introduction of the http header FRAME-OPTIONS does improve the
   protection against Clickjacking, however it is not self-sufficient on
   its own but MUST be used in conjunction with other security measures
   like secure coding and Content Security Policy (CSP)

   The parameter ALLOW-FROM allows a page possibilities to guess who is
   framing it.  This is by design, but may lead to data leakage or data
   protection concerns.


<span class="h2"><a class="selflink" name="section-6" href="#section-6">6</a>.  References</span>

<span class="h3"><a class="selflink" name="section-6.1" href="#section-6.1">6.1</a>.  Normative References</span>

   [<a name="ref-RFC2119" id="ref-RFC2119">RFC2119</a>]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", <a href="./bcp14">BCP 14</a>, <a href="./rfc2119">RFC 2119</a>, March 1997.

<span class="h3"><a class="selflink" name="section-6.2" href="#section-6.2">6.2</a>.  Informative References</span>

   [<a name="ref-CLICK-DEFENSE-BLOG" id="ref-CLICK-DEFENSE-BLOG">CLICK-DEFENSE-BLOG</a>]
              Microsoft, "Clickjacking Defense", 2009, &lt;http://
              blogs.msdn.com/b/ie/archive/2009/01/27/
              ie8-security-part-vii-clickjacking-defenses.aspx&gt;.

   [<a name="ref-CSRF" id="ref-CSRF">CSRF</a>]     OWASP (Open Web Application Security Project), "OWASP
              Top-10: Cross-Site Request Forgery (CSRF)", 2010,



<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 7]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-8" id="page-8" href="#page-8" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


              &lt;<a href="http://www.owasp.org/index.php/Top_10_2010-A5">http://www.owasp.org/index.php/Top_10_2010-A5</a>&gt;.

   [<a name="ref-Clickjacking" id="ref-Clickjacking">Clickjacking</a>]
              OWASP (Open Web Application Security Project),
              "Clickjacking", 2010,
              &lt;<a href="http://www.owasp.org/index.php/Clickjacking">http://www.owasp.org/index.php/Clickjacking</a>&gt;.

   [<a name="ref-FRAME-BUSTING" id="ref-FRAME-BUSTING">FRAME-BUSTING</a>]
              Stanford Web Security Research, "Busting frame busting: a
              study of clickjacking vulnerabilities at popular sites",
              2010, &lt;<a href="http://seclab.stanford.edu/websec/framebusting/">http://seclab.stanford.edu/websec/framebusting/</a>&gt;.

   [<a name="ref-FRAME-OPTIONS" id="ref-FRAME-OPTIONS">FRAME-OPTIONS</a>]
              IETF, "The Web Origin Concept", December 2010, &lt;<a href="http://tools.ietf.org/id/draft-gondrom-frame-options-02.txt">http://</a>
              <a href="http://tools.ietf.org/id/draft-gondrom-frame-options-02.txt">tools.ietf.org/id/draft-gondrom-frame-options-02.txt</a>&gt;.

   [<a name="ref-RFC0822" id="ref-RFC0822">RFC0822</a>]  Crocker, D., "Standard for the format of ARPA Internet
              text messages", STD 11, <a href="./rfc822">RFC 822</a>, August 1982.

   [<a name="ref-RFC2616" id="ref-RFC2616">RFC2616</a>]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", <a href="./rfc2616">RFC 2616</a>, June 1999.

   [<a name="ref-RFC3864" id="ref-RFC3864">RFC3864</a>]  Klyne, G., Nottingham, M., and J. Mogul, "Registration
              Procedures for Message Header Fields", <a href="./bcp90">BCP 90</a>, <a href="./rfc3864">RFC 3864</a>,
              September 2004.

   [<a name="ref-RFC6454" id="ref-RFC6454">RFC6454</a>]  Barth, A., "The Web Origin Concept", <a href="./rfc6454">RFC 6454</a>,
              December 2011.


<span class="h2"><a class="selflink" name="appendix-A" href="#appendix-A">Appendix A</a>.  Description of a Clickjacking attack</span>

   More detailed explanation of Clickjacking scenarios

<span class="h1"><a class="selflink" name="appendix-A.1" href="#appendix-A.1">A.1</a>.  Shop</span>

   An Internet Marketplace/Shop offering a feature with a link/button to
   "Buy this" Gadget
   The marketplace wants their affiliates (who could be bad guys) to be
   able to stick the "Buy such-and-such from XYZ" IFRAMES into their
   pages.  There is a CSRF-ClickJack possibility here, which is why the
   marketplace/onlineshop needs to then immediately navigate the main
   browsing context (or a new window) to a confirmation page which is
   protected by anti-CSRF/anti-CJ protections.






<span class="grey">Ross &amp; Gondrom          Expires September 6, 2012               [Page 8]</span>
</pre><!--NewPage--><pre class='newpage'><a name="page-9" id="page-9" href="#page-9" class="invisible"> </a>
<span class="grey">Internet-Draft                Frame-Options                   March 2012</span>


<span class="h1"><a class="selflink" name="appendix-A.2" href="#appendix-A.2">A.2</a>.  Confirm Purchase Page</span>

   Onlineshop "Confirm purchase" anti-CSRF page
   The Confirm Purchase page must be shown to the end user without
   possibility of overlay or misuse by an attacker.  For that reason,
   the confirmation page uses anti-CSRF tokens and contains the FRAME-
   OPTIONS directive, mitigating ClickJack attacks.

<span class="h1"><a class="selflink" name="appendix-A.3" href="#appendix-A.3">A.3</a>.  Flash Configuration</span>

   Macromedia Flash configuration page
   Macromedia Flash configuration settings are set by a Flash object
   which can run only from a specific configuration page on Macromedia's
   site.  The object runs inside the page and thus can be subject to a
   ClickJacking attack.  In order to prevent ClickJacking attacks
   against the security settings, the configuration page uses the FRAME-
   OPTIONS directive.


Authors' Addresses

   David Ross
   Microsoft
   U.S.

   Phone:
   Email:


   Tobias Gondrom
   Kruegerstr. 5A
   Unterschleissheim,
   Germany

   Phone: +44 7521003005
   Email: tobias.gondrom@gondrom.org















Ross &amp; Gondrom          Expires September 6, 2012               [Page 9]

</pre><br />
<span class="noprint"><small><small>Html markup produced by rfcmarkup 1.101, available from
<a href="http://tools.ietf.org/tools/rfcmarkup/">http://tools.ietf.org/tools/rfcmarkup/</a>
</small></small></span>
</body></html>
