
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OAuth 2.0 User Authentication and Consent For Clients &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="OAuth 2.0 Multiple Response Type Encoding Practices - draft 11" href="oauth_responses.html" />
    <link rel="prev" title="Link relation Type Registrations for OAuth 2" href="oauth-lrdd.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul>
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_bearer.html">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft21</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft19</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft25</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft24</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">OAuth 2.0 User Authentication and Consent For Clients</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-language">1.1.  Requirements Language</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authenticate-code-grant">2.  Authenticate Code Grant</a><ul>
<li><a class="reference internal" href="#authentication-request">2.1.  Authentication Request</a></li>
<li><a class="reference internal" href="#authentication-response">2.2.  Authentication Response</a><ul>
<li><a class="reference internal" href="#error-responses">2.2.1.  Error Responses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token-request">2.3.  Access Token Request</a></li>
<li><a class="reference internal" href="#access-token-response">2.4.  Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#privacy-considerations">3.  Privacy Considerations</a></li>
<li><a class="reference internal" href="#acknowledgements">4.  Acknowledgements</a></li>
<li><a class="reference internal" href="#iana-considerations">5.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations">6.  Security Considerations</a></li>
<li><a class="reference internal" href="#references">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references">7.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references">7.2.  Informative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="oauth-lrdd.html"
         title="Previous Chapter: Link relation Type Registrations for OAuth 2">&laquo; Link relation Ty...</a></li>
  <li><a href="oauth_responses.html"
         title="Next Chapter: OAuth 2.0 Multiple Response Type Encoding Practices - draft 11">OAuth 2.0 Multip... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/oauth_auth.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="oauth-2-0-user-authentication-and-consent-for-clients">
<span id="oauth-auth-head"></span><h1>OAuth 2.0 User Authentication and Consent For Clients<a class="headerlink" href="#oauth-2-0-user-authentication-and-consent-for-clients" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="http://www.ietf.org/id/draft-hunt-oauth-v2-user-a4c-01.txt">http://www.ietf.org/id/draft-hunt-oauth-v2-user-a4c-01.txt</a></li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://www.independentid.com/2013/08/new-draft-for-enabling-oauth2-to-be.html">New Draft for Enabling OAuth2 To Be Used for Authentication</a></li>
<li><a class="reference external" href="http://www.independentid.com/2013/07/simple-authentication-for-oauth-2-what.html">Simple Authentication for OAuth 2? What is the Right Approach?</a></li>
</ul>
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id4">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id5">1.  Introduction</a><ul>
<li><a class="reference internal" href="#requirements-language" id="id6">1.1.  Requirements Language</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authenticate-code-grant" id="id7">2.  Authenticate Code Grant</a><ul>
<li><a class="reference internal" href="#authentication-request" id="id8">2.1.  Authentication Request</a></li>
<li><a class="reference internal" href="#authentication-response" id="id9">2.2.  Authentication Response</a><ul>
<li><a class="reference internal" href="#error-responses" id="id10">2.2.1.  Error Responses</a></li>
</ul>
</li>
<li><a class="reference internal" href="#access-token-request" id="id11">2.3.  Access Token Request</a></li>
<li><a class="reference internal" href="#access-token-response" id="id12">2.4.  Access Token Response</a></li>
</ul>
</li>
<li><a class="reference internal" href="#privacy-considerations" id="id13">3.  Privacy Considerations</a></li>
<li><a class="reference internal" href="#acknowledgements" id="id14">4.  Acknowledgements</a></li>
<li><a class="reference internal" href="#iana-considerations" id="id15">5.  IANA Considerations</a></li>
<li><a class="reference internal" href="#security-considerations" id="id16">6.  Security Considerations</a></li>
<li><a class="reference internal" href="#references" id="id17">7.  References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id18">7.1.  Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id19">7.2.  Informative References</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="abstract">
<span id="oauth-auth-abstract"></span><h2><a class="toc-backref" href="#id4">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification defines a new OAuth2 endpoint
that enables user authentication session and consent information
to be shared with client applications.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>認証セッション</li>
<li>同意情報</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-auth-1"></span><h2><a class="toc-backref" href="#id5">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="oauth.html#oauth-4-1"><em>Section 4.1 of the OAuth 2.0 Authorization Framework</em></a> [RFC6749]
defines the &#8220;Authorization Code Grant&#8221; flow which defines a redirect
flow, typically via a web browser, that enables confidential clients
to obtain access and refresh tokens.  As part of this flow, resource
owners are authenticated via the user agent so that their consent may
be obtained.  This flow defines the &#8220;Authentication Code Grant&#8221;
extension which enables clients to request re-authentication and
makes authentication session information available to the client in a
standardized format.</p>
<p>This document focuses on extending OAuth2 to provide authentication
session information only.  The specification does not define a
standardized resource owner profile information API.  It is assumed
that other APIs such as the SCIM API [I-D.ietf-scim-api] or Open
Identity Connect [OIDC] could be used for this purpose.  As part of
the session information, a subject profile URL may optionally be
provided.</p>
<div class="section" id="requirements-language">
<span id="oauth-auth-1-1"></span><h3><a class="toc-backref" href="#id6">1.1.  Requirements Language</a><a class="headerlink" href="#requirements-language" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>The key words &#8220;MUST&#8221;, &#8220;MUST NOT&#8221;, &#8220;REQUIRED&#8221;, &#8220;SHALL&#8221;, &#8220;SHALL NOT&#8221;,
&#8220;SHOULD&#8221;, &#8220;SHOULD NOT&#8221;, &#8220;RECOMMENDED&#8221;, &#8220;MAY&#8221;, and &#8220;OPTIONAL&#8221; in this
document are to be interpreted as described in RFC 2119 [RFC2119].</div></blockquote>
</div>
</div>
<div class="section" id="authenticate-code-grant">
<span id="oauth-auth-2"></span><h2><a class="toc-backref" href="#id7">2.  Authenticate Code Grant</a><a class="headerlink" href="#authenticate-code-grant" title="Permalink to this headline">¶</a></h2>
<p>The <em class="xref std std-term">Authentication Code Grant</em> type is used in exactly the same manor
as the Authorization Code Grant <a class="reference internal" href="oauth.html#oauth-4-1"><em>Section 4.1</em></a> [RFC6749]
and has the same features and conditions.</p>
<p>The Authorization Code Grant extends the features available
by making it possible for clients to test and request re-authenticaiton
and authorization as well as obtain login session information
at the end of the grant flow.</p>
<div class="section" id="authentication-request">
<span id="oauth-auth-authreq"></span><span id="oauth-auth-2-1"></span><h3><a class="toc-backref" href="#id8">2.1.  Authentication Request</a><a class="headerlink" href="#authentication-request" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="basic.html#basic-authreq"><em>OpenID Connect AuthReq</em></a></li>
</ul>
</div>
<p>In addition to the parameters defined in Section 4.1.1 [RFC6749], the
following additional parameters are defined:</p>
<dl class="glossary docutils">
<dt id="term-min-alv">min_alv</dt>
<dd>OPTIONAL.  A value of &#8220;1&#8221;, &#8220;2&#8221;, &#8220;3&#8221;, or &#8220;4&#8221;.  The minimum
requested authentication assurance level as defined by
[ISO29115] (see also [NIST_SP-800-63-2]).  If the
authorization server is unable to meet or exceed the
requested authentication assurance level, the server SHALL
return an &#8220;unsupported_response_type&#8221; error per section
4.1.2.1 [RFC6749]. [[should there be a specific error_uri
value for alv not supported?]] When the value is omitted, the
authorization server MAY choose any authentication assurance
level.</dd>
<dt id="term-prompt">prompt</dt>
<dd><p class="first">OPTIONAL.  Space delimited, case sensitive list of ASCII
string values that specifies whether the Authorization Server
prompts the End-User for reauthentication and consent.  The
defined values are:</p>
<dl class="last docutils">
<dt>none</dt>
<dd>The suthorization server MUST NOT display any
authentication or consent user interface pages.  An
error is returned if the End-User is not already
authenticated or the Client does not have pre-
configured consent for the requested Claims or does
not fulfill other conditions for processing.  This
can be used as a method to check for existing
authentication and/or consent.</dd>
<dt>login</dt>
<dd>Regardless of the current user authentication state,
the Authorization Server SHOULD prompt the End-User
for reauthentication.  If it cannot prompt the End-
User, it MUST return an error.</dd>
<dt>select_account</dt>
<dd><p class="first">The Authorization Server SHOULD prompt the
End-User to select a user account.  This allows an
End-User who has multiple accounts at the
Authorization Server to select amongst the multiple
accounts that they might have current sessions for.</p>
<p class="last">If it cannot prompt the End-User, it MUST return an
error.</p>
</dd>
</dl>
</dd>
<dt id="term-hint">hint</dt>
<dd>OPTIONAL.  A helpful text message that should be displayed to
the user during a re-authentication or re-authorization
process.</dd>
</dl>
<p>For xample, the client directs the user-agent to make the following
HTTP request using TLS (with extra line breaks for display purposes only):</p>
<div class="highlight-python"><pre>GET /authenticate?
response_type=code
&amp;client_id=s6BhdRkqt3
&amp;redirect_uri=https%3A%2F%2Fclient.example.com%2Fcb
&amp;state=af0ifjsldkj
&amp;prompt=login
Host: server.example.com</pre>
</div>
<p>The authorization server MUST:</p>
<blockquote>
<div><ul class="simple">
<li>Perform the normal OAuth2 authorization process,</li>
<li>MAY elect not to request consent if no access token is to be issued
(i.e. this is an authentication only request),</li>
<li>MUST re-authenticate the user if &#8220;prompt&#8221; contains the parameter &#8220;login&#8221;,</li>
<li>MUST obtain consent from the user if &#8220;prompt&#8221; contains the
parameter &#8220;consent&#8221;, and,</li>
<li>MUST return an error if &#8220;prompt&#8221; contains &#8220;none&#8221; and the user is
not currently authenticated.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="authentication-response">
<span id="oauth-auth-2-2"></span><h3><a class="toc-backref" href="#id9">2.2.  Authentication Response</a><a class="headerlink" href="#authentication-response" title="Permalink to this headline">¶</a></h3>
<p>The response is identical to the one described in <a class="reference internal" href="oauth.html#oauth-4-1-2"><em>Section 4.1.2</em></a> [RFC6749].</p>
<div class="section" id="error-responses">
<span id="oauth-auth-2-2-1"></span><h4><a class="toc-backref" href="#id10">2.2.1.  Error Responses</a><a class="headerlink" href="#error-responses" title="Permalink to this headline">¶</a></h4>
<p>In addition to those defined in <a class="reference internal" href="oauth.html#oauth-4-1-2-1"><em>Section 4.1.2.1</em></a> [RFC6749],
an additional &#8220;error&#8221; type is defined.</p>
<p>&#8220;<strong>unauthenticated_user</strong>&#8221;, MUST be returned after an authentication request parameter
&#8220;<a class="reference internal" href="standard.html#term-prompt"><em class="xref std std-term">prompt</em></a>&#8221; is provided containing value &#8220;<strong>none</strong>&#8221;
and the user is found to be currently unauthenticated.</p>
</div>
</div>
<div class="section" id="access-token-request">
<span id="oauth-auth-2-3"></span><h3><a class="toc-backref" href="#id11">2.3.  Access Token Request</a><a class="headerlink" href="#access-token-request" title="Permalink to this headline">¶</a></h3>
<p>The access token request is identical to the one described in <a class="reference internal" href="oauth.html#oauth-4-1-3"><em>Section 4.1.3</em></a> [RFC6749].
In cases where there is no associated resource API and an access token is not to be issued,
the normal OAuth2 token request is still made.</p>
</div>
<div class="section" id="access-token-response">
<span id="oauth-auth-2-4"></span><h3><a class="toc-backref" href="#id12">2.4.  Access Token Response</a><a class="headerlink" href="#access-token-response" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="basic.html#basic-token-response"><em>OpenID Connect Basic Token Reponse</em></a></li>
<li><a class="reference internal" href="basic.html#basic-id-token"><em>OpenID Connect Basic ID Token</em></a></li>
<li><a class="reference internal" href="#oauth-auth-session-token"><em>OIDC ID Token vs. OAuth Auth Session Token</em></a></li>
</ul>
</div>
<p>If the access token request is valid and authorized,
the authorization server issues an access token and
optional refresh token as described in <a class="reference internal" href="oauth.html#oauth-5-1"><em>Section 5.1</em></a> [RFC6749]
with the exception that the issuance of access_token is OPTIONAL.</p>
<p>If the request client authentication failed or is invalid,
the authorization server returns an error response as described in <a class="reference internal" href="oauth.html#oauth-5-2"><em>Section 5.2</em></a>.</p>
<p>In addition to the parameters described in <a class="reference internal" href="oauth.html#oauth-5"><em>Section 5</em></a>,
a JSON Web Token (JWT) [I-D.ietf-oauth-json-web-token] known as an &#8220;id_token&#8221; is
returned containing the following possible claims:</p>
<dl class="glossary docutils">
<dt id="term-sub">sub</dt>
<dd>REQUIRED.  An identifier for the authenicated subject.  The
same identifier MUST be return for the same authenticated
user on the same client_id.  The authenticated user&#8217;s &#8220;sub&#8221;
value MAY change for different client_id values.</dd>
<dt id="term-profile">profile</dt>
<dd>OPTIONAL.  A URL which can be used to access the
authenticated subject user profile data.  The URL MUST point
to the same user profile as the one that was authenticated.
The URL MUST be valid for the duration of the associated
access token and refresh_tokens lifetimes.  [[Editors note:
Should this be a structured value to indicate the API type
(SCIM, OIDC, HTML) and to optionally return multiple API
representations]]</dd>
<dt id="term-amr">amr</dt>
<dd><p class="first">OPTIONAL.  Authentication Methods References.  JSON array of
strings that are identifiers for authentication methods used
in the authentication.  For instance, values might indicate
that both password and OTP authentication methods were used.
The definition of particular values to be used in the amr
Claim is beyond the scope of this specification.  Parties
using this claim will need to agree upon the meanings of the
values used, which may be context-specific.  The amr value is
an array of case sensitive strings.  The following is a list
of valid values:</p>
<dl class="last docutils">
<dt>pwd</dt>
<dd>Password authentication, either by user or
service if client_secret is used.</dd>
<dt>rsa</dt>
<dd>If authentication was based on the proof of an
rsa key.  This includes if authentication was
performed by a self-signed JWT with a service
owned x509 certificate.</dd>
<dt>rsa</dt>
<dd>One time password.</dd>
<dt>mfa</dt>
<dd>Multiple factor authentication was used.  When
this is used the other authentication methods
will also be included.</dd>
<dt>fed</dt>
<dd>A federated authentication assertion (e.g.  JWT
or SAML) was used.[[should original federated
assertion be attached?]]</dd>
<dt>none</dt>
<dd>No authentication was performed.  [[This would
not really be used for the amr, but an equivalent
claim that indicates the client authentication
method.  So for native clients &#8216;none&#8217; would be
the auth method]]</dd>
</dl>
</dd>
<dt id="term-auth-time">auth_time</dt>
<dd>REQUIRED.  The time at which the subject user was
authenticated expressed in number of seconds from
1970-01-01T0:0:0Z as measured in UTC until the date/time.
See [RFC3339] for details regarding date/times in general and
UTC in particular. &#8216;lat&#8217; MAY be a time earlier than when the
session information was issued as defined by &#8216;iat&#8221;.</dd>
<dt id="term-iat">iat</dt>
<dd>REQUIRED.  The time at which the response or the session
token was issued expressed in number of seconds from
1970-01-01T0:0:0Z as measured in UTC until the date/time.
See [RFC3339] for details regarding date/times in general and
UTC in particular.[RFC3339] for details regarding date/times
in general and UTC in particular.</dd>
<dt id="term-exp">exp</dt>
<dd>REQUIRED.  The time at which the user authenticated session
(login) expires expressed in number of seconds from
1970-01-01T0:0:0Z as measured in UTC until the date/time.
See [RFC3339] for details regarding date/times in general and
UTC in particular.  Note &#8220;expires_in&#8221; referes to the normal
access token lifespan whereas &#8220;exp&#8221; refers to the lifespace
of the user login session.</dd>
<dt id="term-alv">alv</dt>
<dd>OPTIONAL.  The authentication assurance level as described by
[ISO29115] (see also [NIST_SP-800-63-2]).</dd>
<dt id="term-iss">iss</dt>
<dd>REQUIRED for session token.  An identifier representing the
issuer of the authentication.  MAY be the authorization
endpoint URL.</dd>
<dt id="term-aud">aud</dt>
<dd>REQUIRED for session_token.  Contains the client_id of the
client receiving the assertion.</dd>
</dl>
<p>An non-normative example successful response using session
(with carriage returns for readability):</p>
<div class="highlight-python"><pre>HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache
{
  "access_token":"2YotnFZFEjr1zCsicMWpAA",
  "token_type":"example",
  "expires_in":3600,
  "refresh_token":"tGzv3JOkF0XG5Qx2TlKWIA",
  "id_token":"eyJhbGciOiJub25lIn0.
   eyAic3ViIjoiNWRlZGNjOGItNzM1Yy00MDVmLWUwMjlmIiwicHJvZmlsZSI6Imh0
   dHBzOi8vZXhhbXBsZS5jb20vVXNlcnMvNWRlZGNjOGItNzM1Yy00MDVmLWUwMjlm
   IiwiYXV0aF90aW1lIjoiMTM2Nzk1NjA5NiIsImV4cCI6IjEzNjgwNDI0OTYiLCJh
   bHYiOiIyIiwiaWF0IjoiMTM2Nzk1NjA5OCIsImlzcyI6Imh0dHBzOi8vc2VydmVy
   LmV4YW1wbGUuY29tIiwiYXVkIjoiczZCaGRSa3F0MyIsImV4YW1wbGVfc2Vzc2lv
   bl9wYXJhbWV0ZXIiOiJleGFtcGxlX3ZhbHVlIn0=."
}</pre>
</div>
<p>As per the JWT specification,
the encoded &#8220;id_token&#8221; is separated into parts by the &#8221;.&#8221;,
the first part (&#8220;eyJhbGciOiJub25lIn0&#8221;)
indicates the signature algorithm and in this case decodes as:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;none&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>The claimset is then decoded as:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
  <span class="s2">&quot;sub&quot;</span><span class="o">:</span><span class="s2">&quot;5dedcc8b-735c-405f-e029f&quot;</span><span class="p">,</span>
  <span class="s2">&quot;profile&quot;</span><span class="o">:</span><span class="s2">&quot;https://example.com/Users/5dedcc8b-735c-405f-e029f&quot;</span><span class="p">,</span>
  <span class="s2">&quot;auth_time&quot;</span><span class="o">:</span><span class="s2">&quot;1367956096&quot;</span><span class="p">,</span>
  <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="s2">&quot;1368042496&quot;</span><span class="p">,</span>
  <span class="s2">&quot;alv&quot;</span><span class="o">:</span><span class="s2">&quot;2&quot;</span><span class="p">,</span>
  <span class="s2">&quot;iat&quot;</span><span class="o">:</span><span class="s2">&quot;1367956098&quot;</span><span class="p">,</span>
  <span class="s2">&quot;iss&quot;</span><span class="o">:</span><span class="s2">&quot;https://server.example.com&quot;</span><span class="p">,</span>
  <span class="s2">&quot;aud&quot;</span><span class="o">:</span><span class="s2">&quot;s6BhdRkqt3&quot;</span><span class="p">,</span>
  <span class="s2">&quot;example_session_parameter&quot;</span><span class="o">:</span><span class="s2">&quot;example_value&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the &#8220;id_token&#8221; contains the claim &#8220;alv&#8221; and its value is higher
than &#8220;2&#8221;, the &#8220;id_token&#8221; MUST be signed (has a signature alg value
other than &#8220;none) AND validated.</p>
<p>All claims defined above MUST be understood before proceeding.
Additional claims/parameters that are not understood MAY be ignored.</p>
<p>The client MUST confirm the &#8220;auth_time&#8221; is not future dated and &#8220;exp&#8221;
is not a date currently in the past.</p>
<div class="admonition note" id="oauth-auth-session-token">
<p class="first admonition-title">Note</p>
<table border="1" class="last docutils">
<caption>ID Token/Session Token</caption>
<colgroup>
<col width="40%" />
<col width="30%" />
<col width="30%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Claim</td>
<td>OIDC(ID Token)</td>
<td>OAuth Auth(ID Token/Session Token)</td>
</tr>
<tr class="row-even"><td>iss(Issuer Identifier)</td>
<td>REQUIRED</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>sub(Subject identifier)</td>
<td>REQUIRED(String Array/String)</td>
<td>REQUIRED(client_id)</td>
</tr>
<tr class="row-even"><td>aud(Audience Identifier(s))</td>
<td>REQUIRED</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>exp(Expiration Time)</td>
<td>REQUIRED</td>
<td>REQUIRED</td>
</tr>
<tr class="row-even"><td>iat(Issued At)</td>
<td>REQUIRED</td>
<td>REQUIRED</td>
</tr>
<tr class="row-odd"><td>auth_time</td>
<td>REQUIRED</td>
<td>REQUIRED</td>
</tr>
<tr class="row-even"><td>nonce</td>
<td><a class="reference external" href="basic.html#term-nonce">OPTIONAL</a></td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>at_hash(Access Token hash value)</td>
<td>OPTIONAL</td>
<td>N/A</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="session.html#term-acr"><em class="xref std std-term">acr</em></a> (<a class="reference internal" href="glossary.html#term-16"><em class="xref std std-term">Authentication Context Class Reference</em></a>)</td>
<td>OPTIONAL</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td>amr(Authentication Methods References)</td>
<td><a class="reference external" href="basic.html#term-amr">OPTIONAL</a></td>
<td><a class="reference external" href="oauth_auth.html#term-amr">OPTIONAL</a></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="messages.html#term-azp"><em class="xref std std-term">azp</em></a> (Authorized Party)</td>
<td>OPTIONAL/REQUIRED</td>
<td>N/A</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#term-profile"><em class="xref std std-term">profile</em></a></td>
<td>N/A</td>
<td>OPTIONAL</td>
</tr>
<tr class="row-even"><td>alv(<em class="xref std std-term">Authentication Assurance Level</em>)</td>
<td><a class="reference external" href="basic.html#term-acr">N/A</a></td>
<td><a class="reference external" href="oauth_auth.html#term-alv">OPTIONAL</a></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="privacy-considerations">
<span id="oauth-auth-3"></span><h2><a class="toc-backref" href="#id13">3.  Privacy Considerations</a><a class="headerlink" href="#privacy-considerations" title="Permalink to this headline">¶</a></h2>
<p>Profile url values issued in the id_token and MAY be directed
identifiers.  In other words, the identifier/url returned is valid
only for the &#8220;aud&#8221; indicated.  This prevents multiple clients and
non-OAuth clients from being able to gather and correlate information
about individuals authenticated by the OAuth Authrization Server.</p>
</div>
<div class="section" id="acknowledgements">
<span id="oauth-auth-4"></span><h2><a class="toc-backref" href="#id14">4.  Acknowledgements</a><a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>Thanks to members of the OAuth WG for their contributions and comments.</p>
</div>
<div class="section" id="iana-considerations">
<span id="oauth-auth-5"></span><h2><a class="toc-backref" href="#id15">5.  IANA Considerations</a><a class="headerlink" href="#iana-considerations" title="Permalink to this headline">¶</a></h2>
<p>No IANA request registration is anticipated at this time.</p>
</div>
<div class="section" id="security-considerations">
<span id="oauth-auth-6"></span><h2><a class="toc-backref" href="#id16">6.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>This draft carries the same risk profiles as those outlined in the Security Considerations for [RFC6749]
and OAuth2 Threat Model [RFC6819].</p>
</div>
<div class="section" id="references">
<span id="oauth-auth-7"></span><h2><a class="toc-backref" href="#id17">7.  References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="oauth-auth-7-1"></span><h3><a class="toc-backref" href="#id18">7.1.  Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-ietf-oauth-json-web-token">[I-D.ietf-oauth-json-web-token]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web Token
(JWT)&#8221;, draft-ietf-oauth-json-web-token-11 (work in
progress), July 2013.</dd>
<dt id="term-iso29115">[ISO29115]</dt>
<dd>Brackney, D., Ed. and E. NIST, Ed., &#8220;ISO/IEC 29115:2013
Information technology &#8211; Security techniques &#8211; Entity
authentication assurance framework&#8221;, .</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc3339">[RFC3339]</dt>
<dd>Klyne, G., Ed. and C. Newman, &#8220;Date and Time on the
Internet: Timestamps&#8221;, RFC 3339, July 2002.</dd>
<dt id="term-rfc6749">[RFC6749]</dt>
<dd>Hardt, D., &#8220;The OAuth 2.0 Authorization Framework&#8221;, RFC
6749, October 2012.</dd>
<dt id="term-rfc6755">[RFC6755]</dt>
<dd>Campbell, B. and H. Tschofenig, &#8220;An IETF URN Sub-Namespace
for OAuth&#8221;, RFC 6755, October 2012.</dd>
</dl>
</div>
<div class="section" id="informative-references">
<span id="oauth-auth-7-2"></span><h3><a class="toc-backref" href="#id19">7.2.  Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-ietf-scim-api">[I-D.ietf-scim-api]</dt>
<dd>Drake, T., Mortimore, C., Ansari, M., Grizzle, K., and E.
Wahlstroem, &#8220;System for Cross-Domain Identity
Management:Protocol&#8221;, draft-ietf-scim-api-01 (work in
progress), April 2013.</dd>
<dt id="term-i-d-narten-iana-considerations-rfc2434bis">[I-D.narten-iana-considerations-rfc2434bis]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, draft-narten-iana-
considerations-rfc2434bis-09 (work in progress), March
2008.</dd>
<dt id="term-nist-sp-800-63-2">[NIST_SP-800-63-2]</dt>
<dd>Burr, W., Dodson, D., Newton, E., Perlner, R., Polk, W.,
Newton, S., and E. Nabbus, &#8220;DRAFT NIST Special Publication
800-63-2: Electronic Authentication Guideline&#8221;, February
2013.</dd>
<dt id="term-oidc">[OIDC]</dt>
<dd>Sakimura, N., Ping Identity, Jones, M., de Medeiros, B.,
and C. Mortimore, &#8220;OpenID Connect Basic Client Profile 1.0
- draft 28&#8221;, OpenID Connect Specs
<a class="reference external" href="http://openid.net/connect/">http://openid.net/connect/</a>, .</dd>
<dt id="term-rfc6819">[RFC6819]</dt>
<dd>Lodderstedt, T., McGloin, M., and P. Hunt, &#8220;OAuth 2.0
Threat Model and Security Considerations&#8221;, RFC 6819,
January 2013.</dd>
</dl>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>