

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>SAML 2.0 Bearer Assertion Profiles for OAuth 2.0 &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="HTTP Authentication: MAC Access Authentication" href="oauth_mac.html" />
    <link rel="prev" title="JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0" href="oauth_jwt_bearer.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="saml-2-0-bearer-assertion-profiles-for-oauth-2-0">
<h1><a class="toc-backref" href="#id1">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a><a class="headerlink" href="#saml-2-0-bearer-assertion-profiles-for-oauth-2-0" title="Permalink to this headline">¶</a></h1>
<p>based on <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10</a></p>
<div class="section" id="abstract">
<span id="oauth-saml2-bearer-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification defines the use of a
<em class="xref std std-term">SAML 2.0 Bearer Assertion</em> as means
for requesting an OAuth 2.0 <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
as well as for use as a means of <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>.</p>
<p>(draft 10)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#saml-2-0-bearer-assertion-profiles-for-oauth-2-0" id="id1">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1.  Introduction</a></li>
<li><a class="reference internal" href="#http-parameter-bindings-for-transporting-assertions" id="id4">2.  HTTP Parameter Bindings for Transporting Assertions</a><ul>
<li><a class="reference internal" href="#using-saml-assertions-as-authorization-grants" id="id5">2.1.  Using SAML Assertions as Authorization Grants</a></li>
<li><a class="reference internal" href="#using-saml-assertions-for-client-authentication" id="id6">2.2.  Using SAML Assertions for Client Authentication</a></li>
</ul>
</li>
<li><a class="reference internal" href="#assertion-format-and-processing-requirements" id="id7">3.  Assertion Format and Processing Requirements</a><ul>
<li><a class="reference internal" href="#authorization-grant-processing" id="id8">3.1.  Authorization Grant Processing</a></li>
<li><a class="reference internal" href="#client-authentication-processing" id="id9">3.2.  Client Authentication Processing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-saml2-bearer-1"></span><h2><a class="toc-backref" href="#id3">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Security Assertion Markup Language (SAML) 2.0 [OASIS.saml-core-2.0-os]
is an XML-based framework that allows identity and security information
to be shared across security domains.
The SAML specification,
while primarily targeted at providing cross domain Web browser single sign-on,
was also designed to be modular and extensible to facilitate use in other contexts.</p>
<p>The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a>, an <em class="xref std std-term">XML security token</em>,
is a fundamental construct of SAML that is often adopted for use
in other protocols and specifications.
An Assertion is generally issued by an identity provider
and consumed by a service provider
who relies on its content
to identify the Assertion&#8217;s subject for security related purposes.</p>
<p>The OAuth 2.0 Authorization Protocol [I-D.ietf.oauth-v2] provides a
method for making authenticated HTTP requests to a resource using an
access token.  Access tokens are issued to third-party clients by an
authorization server (AS) with the (sometimes implicit) approval of
the resource owner.  In OAuth, an authorization grant is an abstract
term used to describe intermediate credentials that represent the
resource owner authorization.  An authorization grant is used by the
client to obtain an access token.  Several authorization grant types
are defined to support a wide range of client types and user
experiences.  OAuth also allows for the definition of new extension
grant types to support additional clients or to provide a bridge
between OAuth and other trust frameworks.  Finally, OAuth allows the
definition of additional authentication mechanisms to be used by
clients when interacting with the authorization server.</p>
<p>The OAuth 2.0 Assertion Profile [I-D.ietf.oauth-assertions] is an
abstract extension to OAuth 2.0 that provides a general framework for
the use of assertions as client credentials and/or authorization
grants with OAuth 2.0.  This specification profiles the OAuth 2.0
Assertion Profile [I-D.ietf.oauth-assertions] to define an extension
grant type that uses a SAML 2.0 Bearer Assertion to request an OAuth
2.0 access token as well as for use as client credentials.  The
format and processing rules for the SAML Assertion defined in this
specification are intentionally similar, though not identical, to
those in the Web Browser SSO Profile defined in SAML Profiles
[OASIS.saml-profiles-2.0-os].  This specification is reusing, to the
extent reasonable, concepts and patterns from that well-established
Profile.</p>
<p>This document defines
how a <a class="reference internal" href="glossary.html#term-saml-assertion"><em class="xref std std-term">SAML Assertion</em></a> can be used to request an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
when a client wishes to utilize an existing trust relationship,
expressed through the semantics of
(and digital signature calculated over) the SAML Assertion,
without a direct user approval step at the authorization server.
It also defines how a <a class="reference internal" href="glossary.html#term-saml-assertion"><em class="xref std std-term">SAML Assertion</em></a> can be used
as a <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a> mechanism.
The use of an <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> for <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a> is orthogonal
and separable from using an <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> as an <em class="xref std std-term">authorization grant</em>
and the two can be used either in combination or in isolation.</p>
<p>The process by which the client obtains the <a class="reference internal" href="glossary.html#term-saml-assertion"><em class="xref std std-term">SAML Assertion</em></a>, prior to
exchanging it with the authorization server or using it for client
authentication, is out of scope.</p>
<p>(draft 10)</p>
</div>
<div class="section" id="http-parameter-bindings-for-transporting-assertions">
<span id="oauth-saml2-bearer-2"></span><h2><a class="toc-backref" href="#id4">2.  HTTP Parameter Bindings for Transporting Assertions</a><a class="headerlink" href="#http-parameter-bindings-for-transporting-assertions" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="oauth_assertion.html"><em>OAuth 2.0 Assertion Profile</em></a> [<a class="reference internal" href="oauth_jwt_bearer.html#term-i-d-ietf-oauth-assertions"><em class="xref std std-term">I-D.ietf.oauth-assertions</em></a>]
defines generic HTTP parameters for transporting <a class="reference internal" href="oauth_threat.html#term-assertions"><em class="xref std std-term">assertions</em></a>
during interactions with a <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a>.</p>
<p>This section defines the values
of those parameters for use with SAML 2.0 Bearer Assertions.</p>
<p>(Draft 10, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2</a> )</p>
<div class="section" id="using-saml-assertions-as-authorization-grants">
<span id="oauth-saml2-bearer-2-1"></span><h3><a class="toc-backref" href="#id5">2.1.  Using SAML Assertions as Authorization Grants</a><a class="headerlink" href="#using-saml-assertions-as-authorization-grants" title="Permalink to this headline">¶</a></h3>
<p>To use a <em class="xref std std-term">SAML Bearer Assertion</em> as an <em class="xref std std-term">authorization grant</em>,
use the following parameter values and encodings.</p>
<p>The value of &#8220;<a class="reference internal" href="oauth_assertion.html#term-grant-type"><em class="xref std std-term">grant_type</em></a>&#8221; parameter MUST be
&#8220;<strong>urn:ietf:params:oauth:grant-type:saml2-bearer</strong>&#8220;</p>
<p>The value of the &#8220;<a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>&#8221; parameter MUST contain
a single <em class="xref std std-term">SAML 2.0 Assertion</em>.
The <em class="xref std std-term">SAML Assertion XML data</em> MUST be encoded
using <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a>,
where the encoding adheres to the definition in Section 5 of RFC4648 [RFC4648]
and where the padding bits are set to zero.</p>
<p>To avoid the need for subsequent encoding steps
(by &#8220;application/x-www-form-urlencoded&#8221; [W3C.REC-html401-19991224], for example),
the base64url encoded data SHOULD NOT be line wrapped and pad characters
(&#8220;=&#8221;) SHOULD NOT be included.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No padding for base64url</p>
</div>
<p>(draft 10 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2.1">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2.1</a>  )</p>
</div>
<div class="section" id="using-saml-assertions-for-client-authentication">
<span id="oauth-saml2-bearer-2-2"></span><h3><a class="toc-backref" href="#id6">2.2.  Using SAML Assertions for Client Authentication</a><a class="headerlink" href="#using-saml-assertions-for-client-authentication" title="Permalink to this headline">¶</a></h3>
<p>To use a <em class="xref std std-term">SAML Bearer Assertion</em> for <em class="xref std std-term">client authentication grant</em>,
use the following parameter values and encodings.</p>
<p>The value of &#8220;<a class="reference internal" href="oauth_assertion.html#term-client-assertion-type"><em class="xref std std-term">client_assertion_type</em></a>&#8221; parameter MUST be
&#8220;<strong>urn:ietf:params:oauth:client-assertion-type:saml2-bearer</strong>&#8220;</p>
<blockquote>
<div>The value of the &#8220;<a class="reference internal" href="oauth_assertion.html#term-client-assertion"><em class="xref std std-term">client_assertion</em></a>&#8221; parameter MUST contain</div></blockquote>
<p>a single <em class="xref std std-term">SAML 2.0 Assertion</em>.
The <em class="xref std std-term">SAML Assertion XML data</em> MUST be encoded
using <a class="reference internal" href="session.html#term-base64url"><em class="xref std std-term">base64url</em></a>,
where the encoding adheres to the definition in Section 5 of RFC4648 [RFC4648]
and where the padding bits are set to zero.</p>
<p>To avoid the need for subsequent encoding steps
(by &#8220;application/x-www-form-urlencoded&#8221; [W3C.REC-html401-19991224], for example),
the base64url encoded data SHOULD NOT be line wrapped and
pad characters (&#8220;=&#8221;) SHOULD NOT be included.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>no padding for Base64url</li>
</ul>
</div>
<p>( Draft 10, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2.2">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-2.2</a> )</p>
</div>
</div>
<div class="section" id="assertion-format-and-processing-requirements">
<span id="oauth-saml2-bearer-3"></span><h2><a class="toc-backref" href="#id7">3.  Assertion Format and Processing Requirements</a><a class="headerlink" href="#assertion-format-and-processing-requirements" title="Permalink to this headline">¶</a></h2>
<p>In order to issue an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> response
as described in The OAuth 2.0 Authorization Protocol
[I-D.ietf.oauth-v2]
or to rely on an <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a> for <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>,
the authorization server MUST validate the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> according
to the criteria below.
Application of additional restrictions and policy are
at the discretion of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<blockquote>
<div><ul>
<li><p class="first">The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a>&#8216;s <strong>&lt;Issuer&gt;</strong> element MUST contain
a unique identifier for the entity that issued the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> MUST contain <strong>&lt;Conditions&gt;</strong> element
with an <strong>&lt;AudienceRestriction&gt;</strong> element with an <strong>&lt;Audience&gt;</strong> element
containing a URI reference that identifies the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>,
or the service provider SAML entity of its controlling domain,
as an intended audience.
The <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> URL of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
MAY be used as an acceptable value for an <strong>&lt;Audience&gt;</strong> element.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify that
it is an intended audience for the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> MUST contain a <strong>&lt;Subject&gt;</strong> element.
The subject MAY identify the <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>
for whom the access token is being requested.
For <a class="reference internal" href="glossary.html#term-client-authentication"><em class="xref std std-term">client authentication</em></a>,
the <strong>Subject</strong> MUST be the <a class="reference internal" href="standard.html#term-client-id"><em class="xref std std-term">client_id</em></a> of the OAuth client.
When using <a class="reference internal" href="oauth_threat.html#term-assertions"><em class="xref std std-term">assertions</em></a> as an <em class="xref std std-term">authorization grant</em>,
the Subject SHOULD identify an authorized accessor
for whom the access token is being requested
(typically the resource owner, or an authorized delegate).
Additional information identifying the subject/principal of the transaction
MAY be included in an <strong>&lt;AttributeStatement&gt;</strong>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> MUST have an expiry that limits the time window
during which it can be used.
The expiry can be expressed either as the NotOnOrAfter attribute of
the <strong>&lt;Conditions&gt;</strong> element or as the <strong>NotOnOrAfter</strong> attribute of a suitable
<strong>&lt;SubjectConfirmationData&gt;</strong> element.</p>
</li>
<li><p class="first">The <strong>&lt;Subject&gt;</strong> element MUST contain at least one <strong>&lt;SubjectConfirmation&gt;</strong> element
that allows the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> to confirm it as a <em class="xref std std-term">Bearer Assertion</em>.
Such a <strong>&lt;SubjectConfirmation&gt;</strong> element MUST have a <strong>Method</strong> attribute
with a value of &#8220;<strong>urn:oasis:names:tc:SAML:2.0:cm:bearer</strong>&#8221;.
The <strong>&lt;SubjectConfirmation&gt;</strong> element MUST contain
a <strong>&lt;SubjectConfirmationData&gt;</strong> element,
unless the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> has a suitable <strong>NotOnOrAfter</strong> attribute
on the <strong>&lt;Conditions&gt;</strong> element,
in which case the <strong>&lt;SubjectConfirmationData&gt;</strong> element MAY be omitted.
When present, the <strong>&lt;SubjectConfirmationData&gt;</strong> element MUST have a
<strong>Recipient</strong> attribute with a value indicating the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> URL
of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
<p>The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify
that the value of the <strong>Recipient</strong> attribute matches
the <a class="reference internal" href="uma_core.html#term-token-endpoint"><em class="xref std std-term">token endpoint</em></a> URL (or an acceptable alias)
to which the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> was delivered.</p>
<p>The <strong>&lt;SubjectConfirmationData&gt;</strong> element MUST have a
<strong>NotOnOrAfter</strong> attribute that limits the window during which the
<a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> can be confirmed.</p>
<p>The <strong>&lt;SubjectConfirmationData&gt;</strong> element
MAY also contain an <strong>Address</strong> attribute limiting the <a class="reference internal" href="session.html#term-client"><em class="xref std std-term">client</em></a> address
from which the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> can be delivered.
Verification of the <strong>Address</strong> is at the discretion of the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify that occurrences of the
<strong>NotOnOrAfter</strong> instant has not passed,
subject to allowable clock skew between systems.
An invalid <strong>NotOnOrAfter</strong> instant on the <strong>&lt;Conditions&gt;</strong> element
invalidates the entire <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>.</p>
<p>An invalid <strong>NotOnOrAfter</strong> instant on a <strong>&lt;SubjectConfirmationData&gt;</strong> element only
invalidates the individual <strong>&lt;SubjectConfirmation&gt;</strong>.
The <strong>authorization server</strong> MAY reject <a class="reference internal" href="oauth_threat.html#term-assertions"><em class="xref std std-term">assertions</em></a> with a <strong>NotOnOrAfter</strong>
instant that is unreasonably far in the future.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY ensure that <em class="xref std std-term">Bearer Assertions</em> are not replayed,
by maintaining the set of <strong>used ID</strong> values for the length of time for
which the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> would be considered valid
based on the applicable <strong>NotOnOrAfter</strong> instant.</p>
</li>
<li><p class="first">If the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> issuer authenticated the subject,
the Assertion SHOULD contain a single <strong>&lt;AuthnStatement&gt;</strong>
representing that authentication event.</p>
</li>
<li><p class="first">If the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> was issued with the intention that
the presenter act autonomously on behalf of the subject,
an <strong>&lt;AuthnStatement&gt;</strong> SHOULD NOT be included.</p>
<p>The presenter SHOULD be identified in the <strong>&lt;NameID&gt;</strong> or similar element,
the <strong>&lt;SubjectConfirmation&gt;</strong> element, or
by other available means like [OASIS.saml-deleg-cs].</p>
</li>
<li><p class="first">Other statements, in particular <strong>&lt;AttributeStatement&gt;</strong> elements, MAY
be included in the <em class="xref std std-ref">Assertion</em>.</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> MUST be digitally signed by the <a class="reference internal" href="uma_core.html#term-issuer"><em class="xref std std-term">issuer</em></a> and the
<a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify the signature.</p>
</li>
<li><p class="first">Encrypted elements MAY appear in place of their plain text
counterparts as defined in [OASIS.saml-core-2.0-os].</p>
</li>
<li><p class="first">The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST verify that the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> is valid
in all other respects per [OASIS.saml-core-2.0-os],
such as (but not limited to) evaluating all content within the <strong>Conditions</strong>
element including the <strong>NotOnOrAfter</strong> and <strong>NotBefore</strong> attributes,
rejecting unknown condition types, etc.</p>
</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<table border="1" class="last docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>SAML</td>
<td>OAuth/Connect</td>
</tr>
<tr class="row-even"><td>&lt;Issser&gt;</td>
<td>iss</td>
</tr>
<tr class="row-odd"><td>&lt;AudienceRestriction&gt;</td>
<td>aud</td>
</tr>
<tr class="row-even"><td>&lt;Subject&gt;</td>
<td>user_id (grant) / client_id(client authentication)</td>
</tr>
<tr class="row-odd"><td>&lt;SubjectConfirmationData NotOnOrAfter /&gt;</td>
<td>expires_in</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="authorization-grant-processing">
<span id="oauth-saml2-bearer-3-1"></span><h3><a class="toc-backref" href="#id8">3.1.  Authorization Grant Processing</a><a class="headerlink" href="#authorization-grant-processing" title="Permalink to this headline">¶</a></h3>
<p>If present, the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST also validate
the <a class="reference internal" href="glossary.html#term-client-credentials"><em class="xref std std-term">client credentials</em></a>.</p>
<p><a class="reference internal" href="oauth.html#term-authorization-servers"><em class="xref std std-term">Authorization servers</em></a> SHOULD issue <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> with a limited
lifetime and require clients to refresh them by requesting a new <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
using the same <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>,
if it is still valid, or with a new <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">assertion</em></a>.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> SHOULD NOT issue a <a class="reference internal" href="glossary.html#term-refresh-token"><em class="xref std std-term">refresh token</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">No refresh token!</p>
</div>
<p>If the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> is not valid, or its subject confirmation
requirements cannot be met,
the <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MUST construct an error response
as defined in [I-D.ietf.oauth-v2].</p>
<p>The value of the error parameter MUST be the &#8220;invalid_grant&#8221; error code.
The <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> MAY include additional information
regarding the reasons the <a class="reference internal" href="oauth_assertion.html#term-assertion"><em class="xref std std-term">Assertion</em></a> was considered invalid
using the <a class="reference internal" href="uma_core.html#term-error-description"><em class="xref std std-term">error_description</em></a> or <a class="reference internal" href="uma_core.html#term-error-uri"><em class="xref std std-term">error_uri</em></a> parameters.</p>
<p>For example:</p>
<div class="highlight-python"><pre>HTTP/1.1 400 Bad Request
Content-Type: application/json
Cache-Control: no-store

{
  "error":"invalid_grant",
  "error_description":"Audience validation failed"
}</pre>
</div>
<p>(Draft 10, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-3.1">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-3.1</a> )</p>
</div>
<div class="section" id="client-authentication-processing">
<span id="oauth-saml2-bearer-3-2"></span><h3><a class="toc-backref" href="#id9">3.2.  Client Authentication Processing</a><a class="headerlink" href="#client-authentication-processing" title="Permalink to this headline">¶</a></h3>
<p>If the client Assertion is not valid,
or its subject confirmation requirements cannot be met,
the authorization server MUST construct an error response as defined in [I-D.ietf.oauth-v2].
The value of the error parameter MUST be the &#8220;invalid_client&#8221; error code.
The authorization server MAY include additional information
regarding the reasons the Assertion was considered invalid
using the error_description or error_uri parameters.</p>
<p>(Draft 10, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-3.2">http://tools.ietf.org/html/draft-ietf-oauth-saml2-bearer-10#section-3.2</a> )</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>