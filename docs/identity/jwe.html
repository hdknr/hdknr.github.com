

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Encryption (JWE) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Key (JWK)" href="jwk.html" />
    <link rel="prev" title="Holder-of-Key JSON Web Signature (JWS)" href="jws_hok.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Encryption (JWE)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jwk.html">JSON Web Key (JWK)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-encryption-jwe">
<span id="jwe-head"></span><h1>JSON Web Encryption (JWE)<a class="headerlink" href="#json-web-encryption-jwe" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id7">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id8">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id9">2. Terminology</a></li>
<li><a class="reference internal" href="#json-web-encryption-jwe-overview" id="id10">3. JSON Web Encryption (JWE) Overview</a><ul>
<li><a class="reference internal" href="#example-jwe-using-rsaes-oaep-and-aes-gcm" id="id11">3.1. Example JWE using RSAES OAEP and AES GCM</a></li>
<li><a class="reference internal" href="#example-jwe-using-rsaes-pkcs1-v1-5-and-aes-cbc" id="id12">3.2. Example JWE using RSAES-PKCS1-V1_5 and AES CBC</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwe-header" id="id13">4.  JWE Header</a><ul>
<li><a class="reference internal" href="#reserved-header-parameter-names" id="id14">4.1. Reserved Header Parameter Names</a><ul>
<li><a class="reference internal" href="#alg-algorithm-header-parameter" id="id15">4.1.1. &#8220;alg&#8221; (Algorithm) Header Parameter</a></li>
<li><a class="reference internal" href="#enc-encryption-method-header-parameter" id="id16">4.1.2. &#8220;enc&#8221; (Encryption Method) Header Parameter</a></li>
<li><a class="reference internal" href="#epk-ephemeral-public-key-header-parameter" id="id17">4.1.3. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a></li>
<li><a class="reference internal" href="#jku-jwk-set-url-header-parameter" id="id18">4.1.4. &#8220;jku&#8221; (JWK Set URL) Header Parameter</a></li>
<li><a class="reference internal" href="#jwk-json-web-key-header-parameter" id="id19">4.1.5. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a></li>
<li><a class="reference internal" href="#id1" id="id20">4.1.6. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a></li>
<li><a class="reference internal" href="#x5u-x-509-url-header-parameter" id="id21">4.1.7. &#8220;x5u&#8221; (X.509 URL) Header Parameter</a></li>
<li><a class="reference internal" href="#x5t-x-509-certificate-thumbprint-header-parameter" id="id22">4.1.8. &#8220;x5t&#8221; (X.509 Certificate Thumbprint) Header Parameter</a></li>
<li><a class="reference internal" href="#x5c-x-509-certificate-chain-header-parameter" id="id23">4.1.9. &#8220;x5c&#8221; (X.509 Certificate Chain) Header Parameter</a></li>
<li><a class="reference internal" href="#typ-type-header-parameter" id="id24">4.1.10. &#8220;typ&#8221; (Type) Header Parameter</a></li>
<li><a class="reference internal" href="#cty-content-type-header-parameter" id="id25">4.1.11. &#8220;cty&#8221; (Content Type) Header Parameter</a></li>
<li><a class="reference internal" href="#crit-critical-header-parameter" id="id26">4.1.12. &#8220;crit&#8221; (Critical) Header Parameter</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#encrypting-jwes-with-cryptographic-algorithms" id="id27">6. Encrypting JWEs with Cryptographic Algorithms</a><ul>
<li><a class="reference internal" href="#cmk-encryption" id="id28">6.1. CMK Encryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#serializations" id="id29">7. Serializations</a><ul>
<li><a class="reference internal" href="#jwe-compact-serialization" id="id30">7.1. JWE Compact Serialization</a></li>
<li><a class="reference internal" href="#jwe-json-serialization" id="id31">7.2. JWE JSON Serialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composition" id="id32">8.  Composition</a></li>
<li><a class="reference internal" href="#references" id="id33">9. References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id34">9.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id35">9.2. Informative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwe-13" id="id36">13. References</a><ul>
<li><a class="reference internal" href="#jwe-13-1" id="id37">13.1. Normative References</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-a-jwe-examples" id="id38">Appendix A. JWE Examples</a><ul>
<li><a class="reference internal" href="#a-1-example-jwe-using-rsaes-oaep-and-aes-gcm" id="id39">A.1. Example JWE using RSAES OAEP and AES GCM</a><ul>
<li><a class="reference internal" href="#a-1-1-jwe-header" id="id40">A.1.1. JWE Header</a></li>
<li><a class="reference internal" href="#a-1-2-encoded-jwe-header" id="id41">A.1.2. Encoded JWE Header</a></li>
<li><a class="reference internal" href="#a-1-3-content-master-key-cmk" id="id42">A.1.3. Content Master Key (CMK)</a></li>
<li><a class="reference internal" href="#a-1-4-key-encryption" id="id43">A.1.4. Key Encryption</a></li>
<li><a class="reference internal" href="#a-1-5-encoded-jwe-encrypted-key" id="id44">A.1.5. Encoded JWE Encrypted Key</a></li>
<li><a class="reference internal" href="#a-1-6-initialization-vector" id="id45">A.1.6. Initialization Vector</a></li>
<li><a class="reference internal" href="#a-1-7-additional-authenticated-data-parameter" id="id46">A.1.7. &#8220;Additional Authenticated Data&#8221; Parameter</a></li>
<li><a class="reference internal" href="#a-1-8-plaintext-encryption" id="id47">A.1.8. Plaintext Encryption</a></li>
<li><a class="reference internal" href="#a-1-9-encoded-jwe-ciphertext" id="id48">A.1.9. Encoded JWE Ciphertext</a></li>
<li><a class="reference internal" href="#a-1-10-encoded-jwe-integrity-value" id="id49">A.1.10. Encoded JWE Integrity Value</a></li>
<li><a class="reference internal" href="#a-1-11-complete-representation" id="id50">A.1.11. Complete Representation</a></li>
<li><a class="reference internal" href="#a-1-12-validation" id="id51">A.1.12. Validation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-2-example-jwe-using-rsaes-pkcs1-v1-5-and-aes-128-cbc-hmac-sha-256" id="id52">A.2. Example JWE using RSAES-PKCS1-V1_5 and AES_128_CBC_HMAC_SHA_256</a><ul>
<li><a class="reference internal" href="#a-2-1-jwe-header" id="id53">A.2.1. JWE Header</a></li>
<li><a class="reference internal" href="#a-2-2-encoded-jwe-header" id="id54">A.2.2. Encoded JWE Header</a></li>
<li><a class="reference internal" href="#a-2-3-content-encryption-key-cek" id="id55">A.2.3. Content Encryption Key (CEK)</a></li>
<li><a class="reference internal" href="#a-2-4-key-encryption" id="id56">A.2.4. Key Encryption</a></li>
<li><a class="reference internal" href="#a-2-5-encoded-jwe-encrypted-key" id="id57">A.2.5. Encoded JWE Encrypted Key</a></li>
<li><a class="reference internal" href="#a-2-6-initialization-vector" id="id58">A.2.6. Initialization Vector</a></li>
<li><a class="reference internal" href="#a-2-7-additional-authenticated-data" id="id59">A.2.7. Additional Authenticated Data</a></li>
<li><a class="reference internal" href="#a-2-8-plaintext-encryption" id="id60">A.2.8. Plaintext Encryption</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#appendix-b-example-aes-128-cbc-hmac-sha-256-computation" id="id61">Appendix B. Example AES_128_CBC_HMAC_SHA_256 Computation</a><ul>
<li><a class="reference internal" href="#b-1-extract-mac-key-and-enc-key-from-key" id="id62">B.1. Extract MAC_KEY and ENC_KEY from Key</a></li>
<li><a class="reference internal" href="#b-2-encrypt-plaintext-to-create-ciphertext" id="id63">B.2. Encrypt Plaintext to Create Ciphertext</a></li>
<li><a class="reference internal" href="#b-3-64-bit-big-endian-representation-of-aad-length" id="id64">B.3. 64 Bit Big Endian Representation of AAD Length</a></li>
<li><a class="reference internal" href="#b-4-initialization-vector-value" id="id65">B.4. Initialization Vector Value</a></li>
<li><a class="reference internal" href="#b-5-create-input-to-hmac-computation" id="id66">B.5. Create Input to HMAC Computation</a></li>
<li><a class="reference internal" href="#b-6-compute-hmac-value" id="id67">B.6. Compute HMAC Value</a></li>
<li><a class="reference internal" href="#b-7-truncate-hmac-value-to-create-authentication-tag" id="id68">B.7. Truncate HMAC Value to Create Authentication Tag</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-16">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-16</a></li>
</ul>
</div>
<div class="section" id="abstract">
<span id="jwe-abstract"></span><h2><a class="toc-backref" href="#id7">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Encryption (JWE) is a means of representing encrypted content
using JSON data structures.
Related signature capabilities are described
in the separate JSON Web Signature (<a class="reference internal" href="reg.html#term-jws"><em class="xref std std-term">JWS</em></a>) specification.</p>
<p>(v.01)</p>
<blockquote>
<div>JSON Web Encryption (JWE) represents encrypted content</div></blockquote>
<p>using JavaScript Object Notation (JSON) based data structures.</p>
<p>Cryptographic algorithms and identifiers for use with this
specification are described in the separate JSON Web Algorithms (JWA) <a class="reference internal" href="jwa.html"><em>specification</em></a>
and IANA registries defined by that specification.</p>
<p>Related digital signature and MAC capabilities are described in the
separate JSON Web Signature (JWS) <a class="reference internal" href="jws.html"><em>specification</em></a>.</p>
<p>(draft 16)</p>
</div>
<div class="section" id="introduction">
<span id="jwe-1"></span><h2><a class="toc-backref" href="#id8">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Encryption (JWE) is a compact encryption format intended for
space constrained environments such as HTTP Authorization headers and URI query parameters.
It represents this content using JavaScript Object Notation (JSON) <a class="reference internal" href="oauth_meta.html#term-rfc4627"><em class="xref std std-term">[RFC4627]</em></a> based data structures.
The JWE cryptographic mechanisms encrypt and provide integrity protection for
arbitrary sequences of bytes.</p>
<p>Cryptographic algorithms and identifiers for use with this specification are described
in the separate JSON Web Algorithms (<a class="reference internal" href="jwa.html"><em>JWA</em></a>) <a class="reference internal" href="discovery.html#term-jwa"><em class="xref std std-term">[JWA]</em></a> specification.
Related digital signature and MAC capabilities are described in the separate JSON Web Signature (<a class="reference internal" href="jws.html"><em>JWS</em></a>) <a class="reference internal" href="discovery.html#term-jws"><em class="xref std std-term">[JWS]</em></a> specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-1</a></li>
</ul>
</div>
</div>
<div class="section" id="terminology">
<span id="jwe-2"></span><h2><a class="toc-backref" href="#id9">2. Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-encryption-jwe">JSON Web Encryption (JWE)</dt>
<dd>A data structure representing an encrypted
message.  The structure represents five values: the JWE Header,
the JWE Encrypted Key, the JWE Initialization Vector, the JWE
Ciphertext, and the JWE Authentication Tag.</dd>
<dt id="term-authenticated-encryption-with-associated-data-aead">Authenticated Encryption with Associated Data (AEAD)</dt>
<dd><p class="first">An AEAD algorithm is one that encrypts the Plaintext,
allows Additional Authenticated Data to be specified,
and provides an integrated content integrity check
over the Ciphertext and Additional Authenticated Data.</p>
<p>AEAD algorithms accept two inputs,
the Plaintext and the <em class="xref std std-term">Additional Authenticated Data</em> value,
and produce two outputs,
the Ciphertext and the Authentication Tag value.</p>
<p class="last">AES Galois/Counter Mode (GCM) is one such algorithm.</p>
</dd>
<dt id="term-plaintext">Plaintext</dt>
<dd>The sequence of octets to be encrypted &#8211; a.k.a., the
message.  The plaintext can contain an arbitrary sequence of
octets.</dd>
<dt id="term-ciphertext">Ciphertext</dt>
<dd>An encrypted representation of the Plaintext.</dd>
<dt id="term-additional-authenticated-data-aad">Additional Authenticated Data (AAD)</dt>
<dd>An input to an AEAD operation
that is integrity protected but not encrypted.</dd>
<dt id="term-authentication-tag">Authentication Tag</dt>
<dd>An output of an AEAD operation that ensures the
integrity of the Ciphertext and the Additional Authenticated Data.
Note that some algorithms may not use an Authentication Tag, in
which case this value is the empty octet sequence.</dd>
<dt id="term-content-encryption-key-cek">Content Encryption Key (CEK)</dt>
<dd>A symmetric key for the AEAD algorithm
used to encrypt the Plaintext for the recipient to produce the
Ciphertext and the Authentication Tag.</dd>
<dt id="term-json-text-object">JSON Text Object</dt>
<dd>A UTF-8 [RFC3629] encoded text string representing
a JSON object; the syntax of JSON objects is defined in Section
2.2 of [RFC4627].</dd>
<dt id="term-jwe-header">JWE Header</dt>
<dd><p class="first">A JSON Text Object
(or JSON Text Objects, when using the JWE JSON Serialization)
that describes the encryption operations
applied to create the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>, the <a class="reference internal" href="jwa.html#term-jwe-ciphertext"><em class="xref std std-term">JWE Ciphertext</em></a>, and
the <a class="reference internal" href="#term-jwe-authentication-tag"><em class="xref std std-term">JWE Authentication Tag</em></a>.</p>
<p class="last">The members of the JWE Header object(s) are Header Parameters.</p>
</dd>
<dt id="term-jwe-encrypted-key">JWE Encrypted Key</dt>
<dd>The result of encrypting the Content Encryption
Key (CEK) with the intended recipient&#8217;s key using the specified
algorithm.  Note that for some algorithms, the JWE Encrypted Key
value is specified as being the empty octet sequence.</dd>
<dt id="term-jwe-initialization-vector">JWE Initialization Vector</dt>
<dd>A sequence of octets containing the
Initialization Vector used when encrypting the Plaintext.  Note
that some algorithms may not use an Initialization Vector, in
which case this value is the empty octet sequence.</dd>
<dt id="term-jwe-ciphertext">JWE Ciphertext</dt>
<dd>A sequence of octets containing the Ciphertext for a
JWE.</dd>
<dt id="term-jwe-authentication-tag">JWE Authentication Tag</dt>
<dd>A sequence of octets containing the
Authentication Tag for a JWE.</dd>
<dt id="term-jwe-protected-header">JWE Protected Header</dt>
<dd>A JSON Text Object that contains the portion of
the JWE Header that is integrity protected.  For the JWE Compact
Serialization, this comprises the entire JWE Header.  For the JWE
JSON Serialization, this is one component of the JWE Header.</dd>
<dt id="term-header-parameter">Header Parameter</dt>
<dd>A name/value pair that is member of the JWE Header.</dd>
<dt id="term-15">Header Parameter</dt>
<dd>Name  The name of a member of the JWE Header.</dd>
<dt id="term-header-parameter-value">Header Parameter Value</dt>
<dd>The value of a member of the JWE Header.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>The URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5, with the (non URL-
safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of [JWS] for notes on implementing base64url
encoding without padding.)</dd>
<dt id="term-encoded-jwe-header">Encoded JWE Header</dt>
<dd>Base64url encoding of the <a class="reference internal" href="#term-jwe-protected-header"><em class="xref std std-term">JWE Protected Header</em></a>.</dd>
<dt id="term-encoded-jwe-encrypted-key">Encoded JWE Encrypted Key</dt>
<dd>Base64url encoding of the JWE Encrypted
Key.</dd>
<dt id="term-encoded-jwe-initialization-vector">Encoded JWE Initialization Vector</dt>
<dd>Base64url encoding of the JWE
Initialization Vector.</dd>
<dt id="term-encoded-jwe-ciphertext">Encoded JWE Ciphertext</dt>
<dd>Base64url encoding of the JWE Ciphertext.</dd>
<dt id="term-encoded-jwe-authentication-tag">Encoded JWE Authentication Tag</dt>
<dd>Base64url encoding of the JWE
Authentication Tag.</dd>
<dt id="term-jwe-compact-serialization">JWE Compact Serialization</dt>
<dd>A representation of the JWE as the
concatenation of the Encoded JWE Header, the Encoded JWE Encrypted
Key, the Encoded JWE Initialization Vector, the Encoded JWE
Ciphertext, and the Encoded JWE Authentication Tag in that order,
with the five strings being separated by four period (&#8216;.&#8217;)
characters.  This representation is compact and URL-safe.</dd>
<dt id="term-jwe-json-serialization">JWE JSON Serialization</dt>
<dd>A representation of the JWE as a JSON
structure containing JWE Header, Encoded JWE Encrypted Key,
Encoded JWE Initialization Vector, Encoded JWE Ciphertext, and
Encoded JWE Authentication Tag values.  Unlike the JWE Compact
Serialization, the JWE JSON Serialization enables the same content
to be encrypted to multiple parties.  This representation is
neither compact nor URL-safe.</dd>
<dt id="term-collision-resistant-namespace">Collision Resistant Namespace</dt>
<dd>A namespace that allows names to be
allocated in a manner such that they are highly unlikely to
collide with other names.  For instance, collision resistance can
be achieved through administrative delegation of portions of the
namespace or through use of collision-resistant name allocation
functions.  Examples of Collision Resistant Namespaces include:
Domain Names, Object Identifiers (OIDs) as defined in the ITU-T
X.660 and X.670 Recommendation series, and Universally Unique
IDentifiers (UUIDs) [RFC4122].  When using an administratively
delegated namespace, the definer of a name needs to take
reasonable precautions to ensure they are in control of the
portion of the namespace they use to define the name.</dd>
<dt id="term-stringoruri">StringOrURI</dt>
<dd>A JSON string value, with the additional requirement
that while arbitrary string values MAY be used, any value
containing a &#8221;:&#8221; character MUST be a URI [RFC3986].  StringOrURI
values are compared as case-sensitive strings with no
transformations or canonicalizations applied.</dd>
<dt id="term-key-management-mode">Key Management Mode</dt>
<dd>A method of determining the Content Encryption
Key (CEK) value to use.  Each algorithm used for determining the
CEK value uses a specific Key Management Mode.  Key Management
Modes employed by this specification are Key Encryption, Key
Wrapping, Direct Key Agreement, Key Agreement with Key Wrapping,
and Direct Encryption.</dd>
<dt id="term-key-encryption">Key Encryption</dt>
<dd>A Key Management Mode in which the Content Encryption
Key (CEK) value is encrypted to the intended recipient using an
asymmetric encryption algorithm.</dd>
<dt id="term-key-wrapping">Key Wrapping</dt>
<dd>A Key Management Mode in which the Content Encryption
Key (CEK) value is encrypted to the intended recipient using a
symmetric key wrapping algorithm.</dd>
<dt id="term-direct-key-agreement">Direct Key Agreement</dt>
<dd>A Key Management Mode in which a key agreement
algorithm is used to agree upon the Content Encryption Key (CEK)
value.</dd>
<dt id="term-key-agreement-with-key-wrapping">Key Agreement with Key Wrapping</dt>
<dd>A Key Management Mode in which a key
agreement algorithm is used to agree upon a symmetric key used to
encrypt the Content Encryption Key (CEK) value to the intended
recipient using a symmetric key wrapping algorithm.</dd>
<dt id="term-direct-encryption">Direct Encryption</dt>
<dd>A Key Management Mode in which the Content
Encryption Key (CEK) value used is the secret symmetric key value
shared between the parties.</dd>
</dl>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-2">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-2</a> )</p>
</div>
<div class="section" id="json-web-encryption-jwe-overview">
<span id="jwe-3"></span><h2><a class="toc-backref" href="#id10">3. JSON Web Encryption (JWE) Overview</a><a class="headerlink" href="#json-web-encryption-jwe-overview" title="Permalink to this headline">¶</a></h2>
<p>JWE represents encrypted content using JSON data structures and base64url encoding.
The representation consists of five parts:
the <a class="reference internal" href="jwa.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a>,
the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>,
the <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a>,
the <a class="reference internal" href="jwa.html#term-jwe-ciphertext"><em class="xref std std-term">JWE Ciphertext</em></a>, and
the <a class="reference internal" href="jwa.html#term-jwe-integrity-value"><em class="xref std std-term">JWE Integrity Value</em></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>HEADER.KEY.IV.TEXT.INTEGRITY</strong></p>
</div>
<p>In the <em class="xref std std-term">Compact Serialization</em>,
the five parts are base64url-encoded for transmission,
and represented as the concatenation of the encoded strings
in that order,
with the five strings being separated by four period (&#8216;.&#8217;) characters.
(A <em class="xref std std-term">JSON Serialization</em> for this information is defined in
the separate JSON Web Encryption JSON Serialization (JWE-JS) <a class="reference internal" href="#term-jwe-js"><em class="xref std std-term">[JWE-JS]</em></a> specification.)</p>
<p>JWE utilizes encryption to ensure the confidentiality of the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a>.
JWE adds a content integrity check if not provided by the underlying encryption algorithm.</p>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3</a> )</p>
<div class="section" id="example-jwe-using-rsaes-oaep-and-aes-gcm">
<span id="jwe-3-1"></span><h3><a class="toc-backref" href="#id11">3.1. Example JWE using RSAES OAEP and AES GCM</a><a class="headerlink" href="#example-jwe-using-rsaes-oaep-and-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This example encrypts the plaintext &#8220;Live long and prosper.&#8221;
to the recipient using <em class="xref std std-term">RSAES OAEP</em> and <em class="xref std std-term">AES GCM</em>.
The AES GCM algorithm has an integrated integrity check.</p>
<p>The following example JWE Header declares that:</p>
<blockquote>
<div><ul class="simple">
<li>the <a class="reference internal" href="jwa.html#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a> is encrypted to the recipient
using the <em class="xref std std-term">RSAES OAEP</em> algorithm to produce the JWE Encrypted Key and</li>
<li>the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a> is encrypted using the <em class="xref std std-term">AES GCM</em> algorithm
with a 256 bit key to produce the Ciphertext.</li>
</ul>
</div></blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RSA-OAEP&quot;</span><span class="p">,</span><span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A256GCM&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of
the <a class="reference internal" href="jwa.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> yields this Encoded JWE Header value:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ</span>
</pre></div>
</div>
<p>The remaining steps to finish creating this JWE are:</p>
<blockquote>
<div><ul class="simple">
<li>Generate a random <a class="reference internal" href="jwa.html#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a> (<a class="reference internal" href="jwa.html#term-cmk"><em class="xref std std-term">CMK</em></a>)</li>
<li>Encrypt the CMK with the recipient&#8217;s public key
using the RSAES OAEP algorithm to produce the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a></li>
<li>Base64url encode the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a> to produce
the <a class="reference internal" href="jwa.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a></li>
<li>Generate a random <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a></li>
<li>Base64url encode the <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a> to produce the
<a class="reference internal" href="#term-encoded-jwe-initialization-vector"><em class="xref std std-term">Encoded JWE Initialization Vector</em></a></li>
<li>Concatenate the <em class="xref std std-term">Encoded JWE Header value</em>,
a period character (&#8216;.&#8217;),
the <a class="reference internal" href="jwa.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>,
a second period character (&#8216;.&#8217;),
and the <a class="reference internal" href="#term-encoded-jwe-initialization-vector"><em class="xref std std-term">Encoded JWE Initialization Vector</em></a></li>
</ul>
<blockquote>
<div>to create the &#8220;<strong>additional authenticated data</strong>&#8221; parameter for the <em class="xref std std-term">AES GCM</em> algorithm</div></blockquote>
<ul class="simple">
<li>Encrypt the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a> with <em class="xref std std-term">AES GCM</em>,
using the <a class="reference internal" href="jwa.html#term-cmk"><em class="xref std std-term">CMK</em></a> as the encryption key,
the <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a>,
and the &#8220;<strong>additional authenticated data</strong>&#8221; value above,
requesting a 128 bit &#8220;<strong>authentication tag</strong>&#8221; output</li>
<li>Base64url encode the resulting <a class="reference internal" href="jwa.html#term-ciphertext"><em class="xref std std-term">Ciphertext</em></a> to create
the <a class="reference internal" href="jwa.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a></li>
<li>Base64url encode the resulting &#8220;<strong>authentication tag</strong>&#8221; to create the
<a class="reference internal" href="jwa.html#term-encoded-jwe-integrity-value"><em class="xref std std-term">Encoded JWE Integrity Value</em></a></li>
<li>Assemble the final representation:
The Compact Serialization of this result is the concatenation of
the Encoded JWE Header,
the Encoded JWE Encrypted Key,
the Encoded JWE Initialization Vector,
the Encoded JWE Ciphertext, and
the Encoded JWE Integrity Value
in that order,
with the five strings being separated by four period (&#8216;.&#8217;) characters.</li>
</ul>
</div></blockquote>
<p>The final result in this example (with line breaks for display
purposes only) is:</p>
<div class="highlight-python"><pre>eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.
M2XxpbORKezKSzzQL_95-GjiudRBTqn_omS8z9xgoRb7L0Jw5UsEbxmtyHn2T71m
rZLkjg4Mp8gbhYoltPkEOHvAopz25-vZ8C2e1cOaAo5WPcbSIuFcB4DjBOM3t0UA
O6JHkWLuAEYoe58lcxIQneyKdaYSLbV9cKqoUoFQpvKWYRHZbfszIyfsa18rmgTj
zrtLDTPnc09DSJE24aQ8w3i8RXEDthW9T1J6LsTH_vwHdwUgkI-tC2PNeGrnM-dN
SfzF3Y7-lwcGy0FsdXkPXytvDV7y4pZeeUiQ-0VdibIN2AjjfW60nfrPuOjepMFG
6BBBbR37pHcyzext9epOAQ.
48V1_ALb6US04U3b.
_e21tGGhac_peEFkLXr2dMPUZiUkrw.
7V5ZDko0v_mf2PAc4JMiUg</pre>
</div>
<p>See <a class="reference internal" href="#jwe-appendix-a-1"><em>Appendix A.1</em></a> for the complete details of computing this JWE.</p>
<p>(draft 08 , <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3.1</a> )</p>
</div>
<div class="section" id="example-jwe-using-rsaes-pkcs1-v1-5-and-aes-cbc">
<span id="jwe-3-2"></span><h3><a class="toc-backref" href="#id12">3.2. Example JWE using RSAES-PKCS1-V1_5 and AES CBC</a><a class="headerlink" href="#example-jwe-using-rsaes-pkcs1-v1-5-and-aes-cbc" title="Permalink to this headline">¶</a></h3>
<p>This example encrypts the plaintext &#8220;No matter where you go, there you are.&#8221;
to the recipient using <em class="xref std std-term">RSAES-PKCS1-V1_5</em> and <em class="xref std std-term">AES CBC</em>.</p>
<p>AES CBC does not have an integrated integrity check,
so a separate integrity check calculation is performed
using <a class="reference internal" href="glossary.html#term-hmac-sha-256"><em class="xref std std-term">HMAC SHA-256</em></a>, with separate encryption and integrity keys
being derived from a master key using the <em class="xref std std-term">Concat KDF</em>
with the SHA-256 digest function.</p>
<p>The following example JWE Header
(with line breaks for display purposes only) declares that:</p>
<blockquote>
<div><ul class="simple">
<li>the Content Master Key is encrypted to the recipient using the
RSAES-PKCS1-V1_5 algorithm to produce the JWE Encrypted Key and</li>
<li>the Plaintext is encrypted using the AES CBC algorithm with a 128
bit key to produce the Ciphertext, with the integrity of the
Ciphertext and the parameters used to create it being secured
using the HMAC SHA-256 algorithm.</li>
</ul>
</div></blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RSA1_5&quot;</span><span class="p">,</span><span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A128CBC+HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of
the JWE Header yields this Encoded JWE Header value:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJhbGciOiJSU0ExXzUiLCJlbmMiOiJBMTI4Q0JDK0hTMjU2In0</span>
</pre></div>
</div>
<p>The remaining steps to finish creating this JWE are like the previous example,
but with an additional step to compute the separate integrity value:</p>
<blockquote>
<div><ul class="simple">
<li>Generate a random Content Master Key (CMK)</li>
<li>Encrypt the CMK with the recipient&#8217;s public key
using the <em class="xref std std-term">RSAES-PKCS1-V1_5</em> algorithm to produce the JWE Encrypted Key</li>
<li>Base64url encode the JWE Encrypted Key to produce
the Encoded JWE Encrypted Key</li>
<li>Generate a random JWE Initialization Vector</li>
<li>Base64url encode the JWE Initialization Vector to produce the
Encoded JWE Initialization Vector</li>
<li>Use the Concat key derivation function to derive
<a class="reference internal" href="glossary.html#term-content-encryption-key"><em class="xref std std-term">Content Encryption Key</em></a> (<a class="reference internal" href="jwa.html#term-cek"><em class="xref std std-term">CEK</em></a>) and <a class="reference internal" href="jwa.html#term-content-integrity-key"><em class="xref std std-term">Content Integrity Key</em></a>
(<a class="reference internal" href="jwa.html#term-cik"><em class="xref std std-term">CIK</em></a>) values from the CMK</li>
<li>Encrypt the Plaintext with AES CBC using the CEK
and JWE Initialization Vector to produce the Ciphertext</li>
<li>Base64url encode the resulting Ciphertext to create the Encoded
JWE Ciphertext</li>
<li>Concatenate the Encoded JWE Header value,
a period character (&#8216;.&#8217;),
the Encoded JWE Encrypted Key,
a second period character (&#8216;.&#8217;),
the Encoded JWE Initialization Vector,
a third period (&#8216;.&#8217;) character,
and the Encoded JWE Ciphertext to create the value to integrity protect</li>
<li>Compute the HMAC SHA-256 of this value using the CIK to create the JWE Integrity Value</li>
<li>Base64url encode the resulting JWE Integrity Value to create the Encoded JWE Integrity Value</li>
<li>Assemble the final representation:
The Compact Serialization of this result is the concatenation of
the Encoded JWE Header,
the Encoded JWE Encrypted Key,
the Encoded JWE Initialization Vector,
the Encoded JWE Ciphertext, and
the Encoded JWE Integrity Value in that order,
with the five strings being separated by four period (&#8216;.&#8217;) characters.</li>
</ul>
</div></blockquote>
<p>The final result in this example (with line breaks for display purposes only) is:</p>
<div class="highlight-python"><pre>eyJhbGciOiJSU0ExXzUiLCJlbmMiOiJBMTI4Q0JDK0hTMjU2In0.
O6AqXqgVlJJ4c4lp5sXZd7bpGHAw6ARkHUeXQxD1cAW4-X1x0qtj_AN0mukqEOl4
Y6UOwJXIJY9-G1ELK-RQWrKH_StR-AM9H7GpKmSEji8QYOcMOjr-u9H1Lt_pBEie
G802SxWz0rbFTXRcj4BWLxcpCtjUZ31AP-sc-L_eCZ5UNl0aSRNqFskuPkzRsFZR
DJqSSJeVOyJ7pZCQ83fli19Vgi_3R7XMUqluQuuc7ZHOWixi47jXlBTlWRZ5iFxa
S8G6J8wUrd4BKggAw3qX5XoIfXQVlQZE0Vmkq_zQSIo5LnFKyowooRcdsEuNh9B9
Mkyt0ZQElG-jGdtHWjZSOA.
AxY8DCtDaGlsbGljb3RoZQ.
1eBWFgcrz40wC88cgv8rPgu3EfmC1p4zT0kIxxfSF2zDJcQ-iEHk1jQM95xAdr5Z.
RBGhYzE8_cZLHjJqqHuLhzbgWgL_wV3LDSUrcbkOiIA</pre>
</div>
<p>See <a class="reference internal" href="#jwe-appendix-a-2"><em>Appendix A.2</em></a> for the complete details of computing this JWE.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-3.2</a> )</p>
</div>
</div>
<div class="section" id="jwe-header">
<span id="jwe-4"></span><h2><a class="toc-backref" href="#id13">4.  JWE Header</a><a class="headerlink" href="#jwe-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object represented by the JWE Header describe
the encryption applied to the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a>
and optionally additional properties of the JWE.</p>
<p>The <em class="xref std std-term">Header Parameter Names</em> within this object MUST be unique.
Implementations MUST understand the entire contents of the header;
otherwise, the JWE MUST be rejected for processing.</p>
<p>( draft 02 )</p>
<div class="section" id="reserved-header-parameter-names">
<span id="jwe-4-1"></span><h3><a class="toc-backref" href="#id14">4.1. Reserved Header Parameter Names</a><a class="headerlink" href="#reserved-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>The following Header Parameter Names are reserved with meanings as
defined below.  All the names are short because a core goal of JWE is
for the representations to be compact.</p>
<p>Additional reserved Header Parameter Names MAY be defined via the
IANA JSON Web Signature and Encryption Header Parameters registry
[JWS].  As indicated by the common registry, JWSs and JWEs share a
common header parameter space; when a parameter is used by both
specifications, its usage must be compatible between the
specifications.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1</a></li>
</ul>
</div>
<div class="section" id="alg-algorithm-header-parameter">
<span id="jwe-alg"></span><span id="jwe-4-1-1"></span><h4><a class="toc-backref" href="#id15">4.1.1. &#8220;alg&#8221; (Algorithm) Header Parameter</a><a class="headerlink" href="#alg-algorithm-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;alg&#8221; (algorithm) header parameter identifies
the cryptographic algorithm used to encrypt or determine
the value of the Content Master Key (CMK).</p>
<p>The algorithm specified by the &#8220;alg&#8221; value MUST be
supported by the implementation and there MUST be a key for use with
that algorithm associated with the intended recipient or the JWE MUST
be rejected. &#8220;alg&#8221; values SHOULD either be registered in the IANA
JSON Web Signature and Encryption Algorithms registry [JWA] or be a
value that contains a Collision Resistant Namespace.  The &#8220;alg&#8221; value
is a case sensitive string containing a StringOrURI value.  Use of
this header parameter is REQUIRED.</p>
<p>A list of defined &#8220;alg&#8221; values can be found in the IANA JSON Web
Signature and Encryption Algorithms registry [JWA]; the initial
contents of this registry are the values defined in Section 4.1 of
the JSON Web Algorithms (JWA) [JWA] specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1.1</a></li>
</ul>
</div>
</div>
<div class="section" id="enc-encryption-method-header-parameter">
<span id="jwe-enc"></span><span id="jwe-4-1-2"></span><h4><a class="toc-backref" href="#id16">4.1.2. &#8220;enc&#8221; (Encryption Method) Header Parameter</a><a class="headerlink" href="#enc-encryption-method-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;enc&#8221; (encryption method) header parameter identifies the block
encryption algorithm used to encrypt the Plaintext to produce the
Ciphertext.  This algorithm MUST be an Authenticated Encryption
algorithm with a specified key length.  The algorithm specified by
the &#8220;enc&#8221; value MUST be supported by the implementation or the JWE
MUST be rejected. &#8220;enc&#8221; values SHOULD either be registered in the
IANA JSON Web Signature and Encryption Algorithms registry [JWA] or
be a value that contains a Collision Resistant Namespace.  The &#8220;enc&#8221;
value is a case sensitive string containing a StringOrURI value.  Use
of this header parameter is REQUIRED.</p>
<p>A list of defined &#8220;enc&#8221; values can be found in the IANA JSON Web
Signature and Encryption Algorithms registry [JWA]; the initial
contents of this registry are the values defined in Section 4.2 of
the JSON Web Algorithms (JWA) [JWA] specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-4.1.2</a></li>
</ul>
</div>
</div>
<div class="section" id="epk-ephemeral-public-key-header-parameter">
<span id="jwe-epk"></span><span id="jwe-4-1-3"></span><h4><a class="toc-backref" href="#id17">4.1.3. &#8220;epk&#8221; (Ephemeral Public Key) Header Parameter</a><a class="headerlink" href="#epk-ephemeral-public-key-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;epk&#8221; (ephemeral public key) value created by the originator for
the use in key agreement algorithms.  This key is represented as a
JSON Web Key [JWK] value.  Use of this header parameter is OPTIONAL,
although its use is REQUIRED with some &#8220;alg&#8221; algorithms.</p>
</div>
<div class="section" id="jku-jwk-set-url-header-parameter">
<span id="jwe-jku"></span><span id="jwe-4-1-4"></span><h4><a class="toc-backref" href="#id18">4.1.4. &#8220;jku&#8221; (JWK Set URL) Header Parameter</a><a class="headerlink" href="#jku-jwk-set-url-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;jku&#8221; (JWK Set URL) header parameter is a URI [RFC3986] that
refers to a resource for a set of JSON-encoded public keys,
one of which is the key to which the JWE was encrypted;
this can be used to determine the private key needed to decrypt the JWE.</p>
<p>The keys MUST be encoded as a JSON Web Key Set (JWK Set) [JWK].
The protocol used to acquire the resource MUST provide integrity protection;
an HTTP GET request to retrieve the JWK Set MUST use TLS [RFC2818] [RFC5246];
the identity of the server MUST be validated,
as per Section 3.1 of HTTP Over TLS [RFC2818].</p>
<p>Use of this header parameter is OPTIONAL.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>暗号化に使ったキー</li>
<li>このキーに対応するプライベートキーで復号する</li>
</ul>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.4</a> )</p>
</div>
<div class="section" id="jwk-json-web-key-header-parameter">
<span id="jwe-jwk"></span><span id="jwe-4-1-5"></span><h4><a class="toc-backref" href="#id19">4.1.5. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a><a class="headerlink" href="#jwk-json-web-key-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;jwk&#8221; (JSON Web Key) header parameter is the public key
to which the JWE was encrypted;
this can be used to determine the private key needed to decrypt the JWE.</p>
<p>This key is represented as a JSON Web Key [JWK].</p>
<p>Use of this header parameter is OPTIONAL.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.5</a> )</p>
</div>
<div class="section" id="id1">
<span id="id2"></span><h4><a class="toc-backref" href="#id20">4.1.6. &#8220;jwk&#8221; (JSON Web Key) Header Parameter</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>The &#8220;jwk&#8221; (JSON Web Key) header parameter is a public key that
corresponds to the key used to encrypt the JWE; this can be used to
determine the private key needed to decrypt the JWE.  This key is
represented as a JSON Web Key [JWK].  Use of this header parameter is
OPTIONAL.</div></blockquote>
</div>
<div class="section" id="x5u-x-509-url-header-parameter">
<span id="jwk-x5u"></span><span id="jwe-4-1-7"></span><h4><a class="toc-backref" href="#id21">4.1.7. &#8220;x5u&#8221; (X.509 URL) Header Parameter</a><a class="headerlink" href="#x5u-x-509-url-header-parameter" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>The &#8220;x5u&#8221; (X.509 URL) header parameter is a URI [RFC3986] that refers
to a resource for the X.509 public key certificate or certificate
chain [RFC5280] corresponding to the key used to encrypt the JWE;
this can be used to determine the private key needed to decrypt the
JWE.  The identified resource MUST provide a representation of the
certificate or certificate chain that conforms to RFC 5280 [RFC5280]
in PEM encoded form [RFC1421].  The certificate containing the public
key of the entity that encrypted the JWE MUST be the first
certificate.  This MAY be followed by additional certificates, with
each subsequent certificate being the one used to certify the
previous one.  The protocol used to acquire the resource MUST provide
integrity protection; an HTTP GET request to retrieve the certificate
MUST use TLS [RFC2818] [RFC5246]; the identity of the server MUST be
validated, as per Section 3.1 of HTTP Over TLS [RFC2818].  Use of
this header parameter is OPTIONAL.</div></blockquote>
</div>
<div class="section" id="x5t-x-509-certificate-thumbprint-header-parameter">
<span id="jwe-x5t"></span><span id="jwe-4-1-8"></span><h4><a class="toc-backref" href="#id22">4.1.8. &#8220;x5t&#8221; (X.509 Certificate Thumbprint) Header Parameter</a><a class="headerlink" href="#x5t-x-509-certificate-thumbprint-header-parameter" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The &#8220;x5t&#8221; (X.509 Certificate Thumbprint) header parameter provides a
base64url encoded SHA-1 thumbprint (a.k.a. digest) of the DER
encoding of the X.509 certificate [RFC5280] corresponding to the key
used to encrypt the JWE; this can be used to determine the private
key needed to decrypt the JWE.  Use of this header parameter is
OPTIONAL.</p>
<p>If, in the future, certificate thumbprints need to be computed using
hash functions other than SHA-1, it is suggested that additional
related header parameters be defined for that purpose.  For example,
it is suggested that a new &#8220;x5t#S256&#8221; (X.509 Certificate Thumbprint
using SHA-256) header parameter could be defined by registering it in
the IANA JSON Web Signature and Encryption Header Parameters registry
[JWS].</p>
</div></blockquote>
<span class="target" id="jwe-4-1-9"></span></div>
<div class="section" id="x5c-x-509-certificate-chain-header-parameter">
<h4><a class="toc-backref" href="#id23">4.1.9. &#8220;x5c&#8221; (X.509 Certificate Chain) Header Parameter</a><a class="headerlink" href="#x5c-x-509-certificate-chain-header-parameter" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>The &#8220;x5c&#8221; (X.509 Certificate Chain) header parameter contains the
X.509 public key certificate or certificate chain [RFC5280]
corresponding to the key used to encrypt the JWE; this can be used to
determine the private key needed to decrypt the JWE.  The certificate
or certificate chain is represented as an array of certificate value
strings.  Each string is a base64 encoded ([RFC4648] Section 4 &#8211; not
base64url encoded) DER [ITU.X690.1994] PKIX certificate value.  The
certificate containing the public key of the entity that encrypted
the JWE MUST be the first certificate.  This MAY be followed by
additional certificates, with each subsequent certificate being the
one used to certify the previous one.  The recipient MUST verify the
certificate chain according to [RFC5280] and reject the JWE if any
validation failure occurs.  Use of this header parameter is OPTIONAL.</p>
<p>See Appendix B of [JWS] for an example &#8220;x5c&#8221; value.</p>
</div></blockquote>
</div>
<div class="section" id="typ-type-header-parameter">
<span id="jwe-typ"></span><span id="jwe-4-1-10"></span><h4><a class="toc-backref" href="#id24">4.1.10. &#8220;typ&#8221; (Type) Header Parameter</a><a class="headerlink" href="#typ-type-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;typ&#8221; (type) header parameter MAY be used
to declare the type of this complete JWE object
in an application-specific manner in contexts
where this is useful to the application.</p>
<p>This parameter has no effect upon the JWE processing.</p>
<p>The type value &#8220;JOSE&#8221; MAY be used
to indicate that this object is a JWS or JWE using the JWS Compact
Serialization or the JWE Compact Serialization.</p>
<p>The type value &#8220;JOSE+JSON&#8221; MAY be used to indicate
that this object is a JWS or JWE using the JWS JSON Serialization
or the JWE JSON Serialization.</p>
<p>Other type values MAY be used, and if not understood, SHOULD be ignored.
The &#8220;typ&#8221; value is a case sensitive string.
Use of this header parameter is OPTIONAL.</p>
<p>MIME Media Type [RFC2046] values MAY be used as &#8220;typ&#8221; values.</p>
<p>&#8220;typ&#8221; values SHOULD either be registered in the IANA JSON Web
Signature and Encryption Type Values registry [JWS] or be a value
that contains a Collision Resistant Namespace.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.10">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.10</a> )</p>
</div>
<div class="section" id="cty-content-type-header-parameter">
<span id="jwe-cty"></span><span id="jwe-4-1-11"></span><h4><a class="toc-backref" href="#id25">4.1.11. &#8220;cty&#8221; (Content Type) Header Parameter</a><a class="headerlink" href="#cty-content-type-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;cty&#8221; (content type) header parameter MAY be used
to declare the type of the encrypted content
(the Plaintext) in an application-specific manner in contexts
where this is useful to the application.</p>
<p>This parameter has no effect upon the JWE processing.
Content type values that are not understood SHOULD be ignored.
The &#8220;cty&#8221; value is a case sensitive string.
Use of this header parameter is OPTIONAL.</p>
<p>The values used for the &#8220;cty&#8221; header parameter come from the same
value space as the &#8220;typ&#8221; header parameter, with the same rules
applying.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.11">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.11</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>cty : id_token とか?</li>
</ul>
</div>
</div>
<div class="section" id="crit-critical-header-parameter">
<span id="jwe-crit"></span><span id="jwe-4-1-12"></span><h4><a class="toc-backref" href="#id26">4.1.12. &#8220;crit&#8221; (Critical) Header Parameter</a><a class="headerlink" href="#crit-critical-header-parameter" title="Permalink to this headline">¶</a></h4>
<p>The &#8220;crit&#8221; (critical) header parameter indicates that extensions to
[[ this specification ]] are being used that MUST be understood and
processed.  Its value is an array listing the header parameter names
defined by those extensions that are used in the JWE Header.  If any
of the listed extension header parameters are not understood and
supported by the receiver, it MUST reject the JWE.  Senders MUST NOT
include header parameter names defined by [[ this specification ]] or
by [JWA] for use with JWE, duplicate names, or names that do not
occur as header parameter names within the JWE Header in the &#8220;crit&#8221;
list.  Senders MUST not use the empty list &#8220;[]&#8221; as the &#8220;crit&#8221; value.
Recipients MAY reject the JWE if the critical list contains any
header parameter names defined by [[ this specification ]] or by
[JWA] for use with JWE, or any other constraints on its use are
violated.  This header parameter MUST be integrity protected, and
therefore MUST occur only with the JWE Protected Header, when used.
Use of this header parameter is OPTIONAL.  This header parameter MUST
be understood by implementations.</p>
<p>An example use, along with a hypothetical &#8220;exp&#8221; (expiration-time)
field is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RSA-OAEP&quot;</span><span class="p">,</span>
 <span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A256GCM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;crit&quot;</span><span class="o">:</span><span class="p">[</span><span class="s2">&quot;exp&quot;</span><span class="p">],</span>
 <span class="s2">&quot;exp&quot;</span><span class="o">:</span><span class="mi">1363284000</span>
<span class="p">}</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.12">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-4.1.12</a> )</p>
</div>
</div>
</div>
<div class="section" id="encrypting-jwes-with-cryptographic-algorithms">
<span id="jwe-6"></span><h2><a class="toc-backref" href="#id27">6. Encrypting JWEs with Cryptographic Algorithms</a><a class="headerlink" href="#encrypting-jwes-with-cryptographic-algorithms" title="Permalink to this headline">¶</a></h2>
<p>JWE uses cryptographic algorithms
to encrypt the Plaintext and the Content Encryption Key (CMK)
and to provide integrity protection
for the JWE Header, JWE Encrypted Key, and JWE Ciphertext.</p>
<p>The JSON Web Algorithms (JWA) [JWA] specification specifies
a set of cryptographic algorithms and identifiers to be used
with this specification and defines registries for additional such algorithms.</p>
<p>Specifically,
Section 4.1 specifies a set of &#8220;<a class="reference internal" href="#jwe-alg"><em>alg</em></a>&#8221;
(algorithm) header parameter values and
Section 4.2 specifies a set of &#8220;<a class="reference internal" href="#jwe-enc"><em>enc</em></a>&#8221;
(encryption method) header parameter values
intended for use this specification.</p>
<p>It also describes the semantics and operations that are specific to these algorithms.</p>
<p>Public keys employed for encryption can be identified
using the Header Parameter methods described in Section 4.1 or
can be distributed using methods that are outside the scope of this specification.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-6">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-6</a></li>
</ul>
</div>
<div class="section" id="cmk-encryption">
<span id="jwk-cmk"></span><span id="jwe-6-1"></span><h3><a class="toc-backref" href="#id28">6.1. CMK Encryption</a><a class="headerlink" href="#cmk-encryption" title="Permalink to this headline">¶</a></h3>
<p>JWE supports three forms of Content Master Key (CMK) encryption:</p>
<blockquote>
<div><ul class="simple">
<li>Asymmetric encryption under the recipient&#8217;s <strong>public key</strong>.</li>
<li>Symmetric encryption under <strong>a key shared</strong> between the sender and receiver.</li>
<li>Symmetric encryption under <strong>a key agreed upon</strong> between the sender and receiver.</li>
</ul>
</div></blockquote>
<p>See the algorithms registered for &#8220;<a class="reference internal" href="#jwe-enc"><em>enc</em></a>&#8221; usage
in the IANA JSON Web Signature and Encryption Algorithms registry [JWA]
and <a class="reference internal" href="jwa.html#jwa-4-1"><em>Section 4.1 of the JSON Web Algorithms</em></a> (JWA) [JWA] specification
for lists of encryption algorithms that can be used for CMK encryption.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>draft 08,http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-6.1</li>
</ul>
</div>
</div>
</div>
<div class="section" id="serializations">
<span id="jwe-7"></span><h2><a class="toc-backref" href="#id29">7. Serializations</a><a class="headerlink" href="#serializations" title="Permalink to this headline">¶</a></h2>
<p>JWE objects use one of two serializations, the JWE Compact
Serialization or the JWE JSON Serialization.  The JWE Compact
Serialization is mandatory to implement.  Implementation of the JWE
JSON Serialization is OPTIONAL.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7</a> )</p>
<div class="section" id="jwe-compact-serialization">
<span id="jwe-7-1"></span><span id="id3"></span><h3><a class="toc-backref" href="#id30">7.1. JWE Compact Serialization</a><a class="headerlink" href="#jwe-compact-serialization" title="Permalink to this headline">¶</a></h3>
<p>The JWE Compact Serialization represents encrypted content as a
compact URL-safe string.</p>
<p>This string is the concatenation of</p>
<p>the Encoded JWE Header,
the Encoded JWE Encrypted Key,
the Encoded JWE Initialization Vector,
the Encoded JWE Ciphertext, and
the Encoded JWE Authentication Tag</p>
<p>in that order, with the five strings being
separated by four period (&#8216;.&#8217;) characters.</p>
<p>Only one recipient is supported by the JWE Compact Serialization.</p>
<div class="highlight-python"><pre>[E-HEADER].[E-KEY].[E-IV].[Ciphertext].[E-TAG]</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7.1</a> )</p>
</div>
<div class="section" id="jwe-json-serialization">
<span id="jwe-7-2"></span><span id="id4"></span><h3><a class="toc-backref" href="#id31">7.2. JWE JSON Serialization</a><a class="headerlink" href="#jwe-json-serialization" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="#term-jwe-json-serialization"><em class="xref std std-term">JWE JSON Serialization</em></a> represents encrypted content as a JSON object.
Unlike the <a class="reference internal" href="#term-jwe-compact-serialization"><em class="xref std std-term">JWE Compact Serialization</em></a>,
content using the JWE JSON Serialization can be encrypted to more than one recipient.</p>
<p>The representation is closely related to that used in the JWE Compact Serialization,
with the following differences for the JWE JSON Serialization:</p>
<blockquote>
<div><ul class="simple">
<li>Values in the JWE JSON Serialization are represented as members of
a JSON object, rather than as base64url encoded strings separated
by period (&#8216;.&#8217;) characters.  (However binary values and values
that are integrity protected are still base64url encoded.)</li>
<li>The Encoded JWE Header value, if non-empty, is stored in the
&#8220;protected&#8221; member.</li>
<li>The Encoded JWE Initialization Vector value is stored in the &#8220;iv&#8221;
member.</li>
<li>The Encoded JWE Ciphertext value is stored in the &#8220;ciphertext&#8221;
member.</li>
<li>The Encoded JWE Authentication Tag value is stored in the &#8220;tag&#8221;
member.</li>
<li>The JWE can be encrypted to multiple recipients, rather than just
one.  A JSON array in the &#8220;recipients&#8221; member is used to hold
values that are specific to a particular recipient, with one array
element per recipient represented.  These array elements are JSON
objects.</li>
<li>Each Encoded JWE Encrypted Key value is stored in the
&#8220;encrypted_key&#8221; member of a JSON object that is an element of the
&#8220;recipients&#8221; array.</li>
<li>Some header parameter values, such as the &#8220;alg&#8221; value and
parameters used for selecting keys, can also differ for different
recipient computations.  Per-recipient header parameter values are
stored in the &#8220;header&#8221; members of the same JSON objects that are
elements of the &#8220;recipients&#8221; array.</li>
<li>Some header parameters, including the &#8220;alg&#8221; parameter, can be
shared among all recipient computations.  These header parameters
are stored in either of two top-level member(s) of the JSON
object: the &#8220;protected&#8221; member and the &#8220;unprotected&#8221; member.  The
values of these members are JSON Text Objects containing Header
Parameters.</li>
<li>Not all header parameters are integrity protected.  The shared
header parameters in the &#8220;protected&#8221; member are integrity
protected, and are base64url encoded.  The per-recipient header
parameters in the &#8220;header&#8221; array element members and the shared
header parameters in the &#8220;unprotected&#8221; member are not integrity
protected.  These JSON Text Objects containing header parameters
that are not integrity protected are not base64url encoded.</li>
<li>The header parameter values used when creating or validating per-
recipient Ciphertext and Authentication Tag values are the union
of the three sets of header parameter values that may be present:
(1) the per-recipient values in the &#8220;header&#8221; member of the
recipient&#8217;s array element, (2) the shared integrity-protected
values in the &#8220;protected&#8221; member, and (3) the shared non-
integrity-protected values in the &#8220;unprotected&#8221; member.  The union
of these sets of header parameters comprises the JWE Header.  The
header parameter names in the three locations MUST be disjoint.</li>
<li>An &#8220;aad&#8221; (Additional Authenticated Data) member can be included to
supply a base64url encoded value to be integrity protected but not
encrypted.  (Note that this can also be achieved when using either
serialization by including the AAD value as a protected header
parameter value, but at the cost of the value being double
base64url encoded.)</li>
</ul>
</div></blockquote>
<p>The syntax of a JWE using the JWE JSON Serialization is as follows:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;protected&quot;</span><span class="o">:&lt;</span><span class="nx">integrity</span><span class="o">-</span><span class="kr">protected</span> <span class="nx">shared</span> <span class="nx">header</span> <span class="nx">contents</span><span class="o">&gt;</span><span class="s2">&quot;,</span>
<span class="s2"> &quot;</span><span class="nx">unprotected</span><span class="s2">&quot;:&lt;non-integrity-protected shared header contents&gt;&quot;</span><span class="p">,</span>

 <span class="s2">&quot;recipients&quot;</span><span class="o">:</span><span class="p">[</span>
  <span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;per-recipient unprotected header 1 contents&gt;&quot;</span><span class="p">,</span>
   <span class="s2">&quot;encrypted_key&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;encrypted key 1 contents&gt;&quot;</span><span class="p">},</span>
  <span class="p">...</span>
  <span class="p">{</span><span class="s2">&quot;header&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;per-recipient unprotected header N contents&gt;&quot;</span><span class="p">,</span>
   <span class="s2">&quot;encrypted_key&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;encrypted key N contents&gt;&quot;</span><span class="p">}],</span>

 <span class="s2">&quot;aad&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;additional authenticated data contents&gt;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;iv&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;initialization vector contents&gt;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;ciphertext&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;ciphertext contents&gt;&quot;</span><span class="p">,</span>
 <span class="s2">&quot;tag&quot;</span><span class="o">:</span><span class="s2">&quot;&lt;authentication tag contents&gt;&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Of these members, only the &#8220;ciphertext&#8221; member MUST be present.</p>
<p>The &#8220;iv&#8221;, &#8220;tag&#8221;, and &#8220;encrypted_key&#8221; members MUST be present when
corresponding JWE Initialization Vector,
JWE Authentication Tag, and
JWE Encrypted Key values are non-empty.</p>
<p>The &#8220;recipients&#8221; member MUST be present when any &#8220;header&#8221;
or &#8220;encrypted_key&#8221; members are needed
for recipients.  At least one of the &#8220;header&#8221;, &#8220;protected&#8221;, and
&#8220;unprotected&#8221; members MUST be present so that &#8220;alg&#8221; and &#8220;enc&#8221; header
parameter values are conveyed for each recipient computation.</p>
<p>The contents of the Encoded JWE Encrypted Key, Encoded JWE
Initialization Vector, Encoded JWE Ciphertext, and Encoded JWE
Authentication Tag values are exactly as defined in the rest of this
specification.  They are interpreted and validated in the same
manner, with each corresponding Encoded JWE Encrypted Key, Encoded
JWE Initialization Vector, Encoded JWE Ciphertext, Encoded JWE
Authentication Tag, and set of header parameter values being created
and validated together.  The JWE Header values used are the union of
the header parameters in the &#8220;protected&#8221;, &#8220;unprotected&#8221;, and
corresponding &#8220;header&#8221; members, as described earlier.</p>
<p>Each JWE Encrypted Key value is computed using the parameters of the
corresponding JWE Header value in the same manner as for the JWE
Compact Serialization.  This has the desirable property that each
Encoded JWE Encrypted Key value in the &#8220;recipients&#8221; array is
identical to the value that would have been computed for the same
parameter in the JWE Compact Serialization.  Likewise, the JWE
Ciphertext and JWE Authentication Tag values match those produced for
the JWE Compact Serialization, provided that the Encoded JWE Header
value (which represents the integrity-protected header parameter
values) matches that used in the JWE Compact Serialization.</p>
<p>All recipients use the same JWE Protected Header, JWE Initialization
Vector, JWE Ciphertext, and JWE Authentication Tag values, resulting
in potentially significant space savings if the message is large.
Therefore, all header parameters that specify the treatment of the
Plaintext value MUST be the same for all recipients.  This primarily
means that the &#8220;enc&#8221; (encryption method) header parameter value in
the JWE Header for each recipient and any parameters of that
algorithm MUST be the same.</p>
<p>See Appendix A.4 for an example of computing a JWE using the JWE JSON
Serialization.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#section-7.2</a> )</p>
</div>
</div>
<div class="section" id="composition">
<span id="jwe-8"></span><h2><a class="toc-backref" href="#id32">8.  Composition</a><a class="headerlink" href="#composition" title="Permalink to this headline">¶</a></h2>
<p>This document does not specify a combination signed and encrypted mode.</p>
<p>However, because the contents of a message can be arbitrary,
encryption and data origin authentication can be provided
by recursively encapsulating multiple JWE and JWS messages.</p>
<p>In general,
senders SHOULD sign the message and then encrypt the result
(thus encrypting the signature).
This prevents attacks in which the signature is stripped,
leaving just an encrypted message,
as well as providing privacy for the signer.</p>
<p>(draft 02)</p>
</div>
<div class="section" id="references">
<span id="jwe-9"></span><h2><a class="toc-backref" href="#id33">9. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>( <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9</a> )</p>
<div class="section" id="normative-references">
<span id="jwe-9-1"></span><h3><a class="toc-backref" href="#id34">9.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-itu-x690-1994">[ITU.X690.1994]</dt>
<dd>International Telecommunications Union, &#8220;Information
Technology - ASN.1 encoding rules: Specification of Basic
Encoding Rules (BER), Canonical Encoding Rules (CER) and
Distinguished Encoding Rules (DER)&#8221;, ITU-T Recommendation
X.690, 1994.</dd>
<dt id="term-jwa">[JWA]</dt>
<dd>Jones, M., &#8220;JSON Web Algorithms (JWA)&#8221;,
draft-ietf-jose-json-web-algorithms (work in progress),
December 2012.</dd>
<dt id="term-jwk">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;,
draft-ietf-jose-json-web-key (work in progress),
December 2012.</dd>
<dt id="term-jws">[JWS]</dt>
<dd>Jones, M., Bradley, J., and N. Sakimura, &#8220;JSON Web
Signature (JWS)&#8221;, draft-ietf-jose-json-web-signature (work
in progress), December 2012.</dd>
<dt id="term-rfc1421">[RFC1421]</dt>
<dd>Linn, J., &#8220;Privacy Enhancement for Internet Electronic
Mail: Part I: Message Encryption and Authentication
Procedures&#8221;, RFC 1421, February 1993.</dd>
<dt id="term-rfc1951">[RFC1951]</dt>
<dd>Deutsch, P., &#8220;DEFLATE Compressed Data Format Specification
version 1.3&#8221;, RFC 1951, May 1996.</dd>
<dt id="term-rfc2046">[RFC2046]</dt>
<dd>Freed, N. and N. Borenstein, &#8220;Multipurpose Internet Mail
Extensions (MIME) Part Two: Media Types&#8221;, RFC 2046,
November 1996.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2818">[RFC2818]</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc3986">[RFC3986]</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-rfc4086">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-rfc4288">[RFC4288]</dt>
<dd>Freed, N. and J. Klensin, &#8220;Media Type Specifications and
Registration Procedures&#8221;, BCP 13, RFC 4288, December 2005.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc5246">[RFC5246]</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-rfc5280">[RFC5280]</dt>
<dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
Housley, R., and W. Polk, &#8220;Internet X.509 Public Key
Infrastructure Certificate and Certificate Revocation List
(CRL) Profile&#8221;, RFC 5280, May 2008.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20120313">[W3C.CR-xmlenc-core1-20120313]</dt>
<dd>Eastlake, D., Reagle, J., Roessler, T., and F. Hirsch,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20120313,
March 2012,
&lt;<a class="reference external" href="http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313">http://www.w3.org/TR/2012/CR-xmlenc-core1-20120313</a>&gt;.</dd>
</dl>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9.1</a> )</p>
</div>
<div class="section" id="informative-references">
<span id="jwe-9-2"></span><h3><a class="toc-backref" href="#id35">9.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jse">[JSE]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple
Encryption&#8221;, September 2010.</dd>
<dt id="term-jwe-js">[JWE-JS]</dt>
<dd>Jones, M., &#8220;JSON Web Encryption JSON Serialization
(JWE-JS)&#8221;, draft-jones-jose-jwe-json-serialization
(work in progress), December 2012.</dd>
<dt id="term-rfc4122">[RFC4122]</dt>
<dd>Leach, P., Mealling, M., and R. Salz, &#8220;A Universally
Unique IDentifier (UUID) URN Namespace&#8221;, RFC 4122,
July 2005.</dd>
<dt id="term-rfc5652">[RFC5652]</dt>
<dd>Housley, R., &#8220;Cryptographic Message Syntax (CMS)&#8221;, STD 70,
RFC 5652, September 2009.</dd>
</dl>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#section-9.2</a> )</p>
</div>
</div>
<div class="section" id="jwe-13">
<span id="id5"></span><h2><a class="toc-backref" href="#id36">13. References</a><a class="headerlink" href="#jwe-13" title="Permalink to this headline">¶</a></h2>
<div class="section" id="jwe-13-1">
<span id="id6"></span><h3><a class="toc-backref" href="#id37">13.1. Normative References</a><a class="headerlink" href="#jwe-13-1" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-fips-197">[FIPS-197]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-57">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;, October 2011.</dd>
<dt id="term-58">[JWS]</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
J., Sakimura, N., and P. Tarjan, &#8220;JSON Web Signature
(JWS)&#8221;, October 2011.</dd>
<dt id="term-nist-800-38a">[NIST-800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST-800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST-800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography (Revised)&#8221;, NIST PUB
800-56A, March 2007.</dd>
<dt id="term-62">[RFC1421]</dt>
<dd>Linn, J., &#8220;Privacy Enhancement for Internet Electronic
Mail: Part I: Message Encryption and Authentication
Procedures&#8221;, RFC 1421, February 1993.</dd>
<dt id="term-rfc1738">[RFC1738]</dt>
<dd>Berners-Lee, T., Masinter, L., and M. McCahill, &#8220;Uniform
Resource Locators (URL)&#8221;, RFC 1738, December 1994.</dd>
<dt id="term-rfc1952">[RFC1952]</dt>
<dd>Deutsch, P., Gailly, J-L., Adler, M., Deutsch, L., and G.
Randers-Pehrson, &#8220;GZIP file format specification version
4.3&#8221;, RFC 1952, May 1996.</dd>
<dt id="term-65">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-66">[RFC2818]</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-69">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-70">[RFC3986]</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-71">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-72">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-73">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-75">[RFC5246]</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-76">[RFC5280]</dt>
<dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
Housley, R., and W. Polk, &#8220;Internet X.509 Public Key
Infrastructure Certificate and Certificate Revocation List
(CRL) Profile&#8221;, RFC 5280, May 2008.</dd>
<dt id="term-rfc5785">[RFC5785]</dt>
<dd>Nottingham, M. and E. Hammer-Lahav, &#8220;Defining Well-Known
Uniform Resource Identifiers (URIs)&#8221;, RFC 5785,
April 2010.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-rfc6125">[RFC6125]</dt>
<dd>Saint-Andre, P. and J. Hodges, &#8220;Representation and
Verification of Domain-Based Application Service Identity
within Internet Public Key Infrastructure Using X.509
(PKIX) Certificates in the Context of Transport Layer
Security (TLS)&#8221;, RFC 6125, March 2011.</dd>
</dl>
<p id="jwe-13-2">13.2. Informative References</p>
<dl class="glossary docutils">
<dt id="term-80">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2011.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-jwt">[JWT]</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
J., Sakimura, N., and P. Tarjan, &#8220;JSON Web Token (JWT)&#8221;,
October 2011.  (<a class="reference internal" href="jwt.html"><em>JSON Web Token(JWT)</em></a>)</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-85">[RFC5652]</dt>
<dd>Housley, R., &#8220;Cryptographic Message Syntax (CMS)&#8221;, STD 70,
RFC 5652, September 2009.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20110303">[W3C.CR-xmlenc-core1-20110303]</dt>
<dd>Hirsch, F., Reagle, J., Eastlake, D., and T. Roessler,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20110303,
March 2011,
&lt;<a class="reference external" href="http://www.w3.org/TR/2011/CR-xmlenc-core1-20110303">http://www.w3.org/TR/2011/CR-xmlenc-core1-20110303</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
</div>
</div>
<div class="section" id="appendix-a-jwe-examples">
<span id="jwe-appendix-a"></span><h2><a class="toc-backref" href="#id38">Appendix A. JWE Examples</a><a class="headerlink" href="#appendix-a-jwe-examples" title="Permalink to this headline">¶</a></h2>
<p>This section provides examples of JWE computations.</p>
<div class="section" id="a-1-example-jwe-using-rsaes-oaep-and-aes-gcm">
<span id="jwe-appendix-a-1"></span><h3><a class="toc-backref" href="#id39">A.1. Example JWE using RSAES OAEP and AES GCM</a><a class="headerlink" href="#a-1-example-jwe-using-rsaes-oaep-and-aes-gcm" title="Permalink to this headline">¶</a></h3>
<p>This example encrypts the plaintext &#8220;<strong>Live long and prosper.</strong>&#8221;
to the recipient using <em class="xref std std-term">RSAES OAEP</em> and <em class="xref std std-term">AES GCM</em>.</p>
<p>The AES GCM algorithm has an integrated integrity check.</p>
<p>The representation of this plaintext is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">76</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span>
<span class="mi">112</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">46</span><span class="p">]</span>
</pre></div>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1</a> )</p>
<div class="section" id="a-1-1-jwe-header">
<span id="jwe-appendix-a-1-1"></span><h4><a class="toc-backref" href="#id40">A.1.1. JWE Header</a><a class="headerlink" href="#a-1-1-jwe-header" title="Permalink to this headline">¶</a></h4>
<p>The following example JWE Header declares that:</p>
<blockquote>
<div><ul class="simple">
<li>the <a class="reference internal" href="jwa.html#term-content-master-key"><em class="xref std std-term">Content Master Key</em></a> is encrypted to the recipient
using the <em class="xref std std-term">RSAES OAEP</em> algorithm to produce the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a> and</li>
<li>the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a> is encrypted using the <em class="xref std std-term">AES GCM</em> algorithm
with a <strong>256 bit key</strong> to produce the <a class="reference internal" href="jwa.html#term-ciphertext"><em class="xref std std-term">Ciphertext</em></a>.</li>
</ul>
</div></blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RSA-OAEP&quot;</span><span class="p">,</span><span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A256GCM&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.1">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.1</a> )</p>
</div>
<div class="section" id="a-1-2-encoded-jwe-header">
<span id="jwe-appendix-a-1-2"></span><h4><a class="toc-backref" href="#id41">A.1.2. Encoded JWE Header</a><a class="headerlink" href="#a-1-2-encoded-jwe-header" title="Permalink to this headline">¶</a></h4>
<p>Base64url encoding the bytes of the UTF-8 representation
of the <a class="reference internal" href="jwa.html#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> yields this <a class="reference internal" href="jwa.html#term-encoded-jwe-header"><em class="xref std std-term">Encoded JWE Header</em></a> value:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ</span>
</pre></div>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.2">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.2</a> )</p>
</div>
<div class="section" id="a-1-3-content-master-key-cmk">
<span id="jwe-appendix-a-1-3"></span><h4><a class="toc-backref" href="#id42">A.1.3. Content Master Key (CMK)</a><a class="headerlink" href="#a-1-3-content-master-key-cmk" title="Permalink to this headline">¶</a></h4>
<p>Generate a <strong>256 bit</strong> random <a class="reference internal" href="jwa.html#term-content-master-key-cmk"><em class="xref std std-term">Content Master Key (CMK)</em></a>.</p>
<p>In this example, the value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">177</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span>
<span class="mi">212</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span>
<span class="mi">234</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">252</span><span class="p">]</span>
</pre></div>
</div>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.3">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.3</a>)</p>
</div>
<div class="section" id="a-1-4-key-encryption">
<span id="jwe-appendix-a-1-4"></span><h4><a class="toc-backref" href="#id43">A.1.4. Key Encryption</a><a class="headerlink" href="#a-1-4-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>Encrypt the <a class="reference internal" href="jwa.html#term-cmk"><em class="xref std std-term">CMK</em></a> with the recipient&#8217;s public key
using the <em class="xref std std-term">RSAES OAEP</em> algorithm to produce the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>.</p>
<p>In this example,
the RSA key parameters are:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Parameter
Name</td>
<td>Value</td>
</tr>
<tr class="row-even"><td>Modulus</td>
<td>[161, 168, 84, 34, 133, 176, 208, 173, 46, 176, 163,
110, 57, 30, 135, 227, 9, 31, 226, 128, 84, 92, 116,
241, 70, 248, 27, 227, 193, 62, 5, 91, 241, 145, 224,
205, 141, 176, 184, 133, 239, 43, 81, 103, 9, 161,
153, 157, 179, 104, 123, 51, 189, 34, 152, 69, 97,
69, 78, 93, 140, 131, 87, 182, 169, 101, 92, 142, 3,
22, 167, 8, 212, 56, 35, 79, 210, 222, 192, 208, 252,
49, 109, 138, 173, 253, 210, 166, 201, 63, 102, 74,
5, 158, 41, 90, 144, 108, 160, 79, 10, 89, 222, 231,
172, 31, 227, 197, 0, 19, 72, 81, 138, 78, 136, 221,
121, 118, 196, 17, 146, 10, 244, 188, 72, 113, 55,
221, 162, 217, 171, 27, 57, 233, 210, 101, 236, 154,
199, 56, 138, 239, 101, 48, 198, 186, 202, 160, 76,
111, 234, 71, 57, 183, 5, 211, 171, 136, 126, 64, 40,
75, 58, 89, 244, 254, 107, 84, 103, 7, 236, 69, 163,
18, 180, 251, 58, 153, 46, 151, 174, 12, 103, 197,
181, 161, 162, 55, 250, 235, 123, 110, 17, 11, 158,
24, 47, 133, 8, 199, 235, 107, 126, 130, 246, 73,
195, 20, 108, 202, 176, 214, 187, 45, 146, 182, 118,
54, 32, 200, 61, 201, 71, 243, 1, 255, 131, 84, 37,
111, 211, 168, 228, 45, 192, 118, 27, 197, 235, 232,
36, 10, 230, 248, 190, 82, 182, 140, 35, 204, 108,
190, 253, 186, 186, 27]</td>
</tr>
<tr class="row-odd"><td>Exponent</td>
<td>[1, 0, 1]</td>
</tr>
<tr class="row-even"><td>Private
Exponent</td>
<td>[144, 183, 109, 34, 62, 134, 108, 57, 44, 252, 10,
66, 73, 54, 16, 181, 233, 92, 54, 219, 101, 42, 35,
178, 63, 51, 43, 92, 119, 136, 251, 41, 53, 23, 191,
164, 164, 60, 88, 227, 229, 152, 228, 213, 149, 228,
169, 237, 104, 71, 151, 75, 88, 252, 216, 77, 251,
231, 28, 97, 88, 193, 215, 202, 248, 216, 121, 195,
211, 245, 250, 112, 71, 243, 61, 129, 95, 39, 244,
122, 225, 217, 169, 211, 165, 48, 253, 220, 59, 122,
219, 42, 86, 223, 32, 236, 39, 48, 103, 78, 122, 216,
187, 88, 176, 89, 24, 1, 42, 177, 24, 99, 142, 170,
1, 146, 43, 3, 108, 64, 194, 121, 182, 95, 187, 134,
71, 88, 96, 134, 74, 131, 167, 69, 106, 143, 121, 27,
72, 44, 245, 95, 39, 194, 179, 175, 203, 122, 16,
112, 183, 17, 200, 202, 31, 17, 138, 156, 184, 210,
157, 184, 154, 131, 128, 110, 12, 85, 195, 122, 241,
79, 251, 229, 183, 117, 21, 123, 133, 142, 220, 153,
9, 59, 57, 105, 81, 255, 138, 77, 82, 54, 62, 216,
38, 249, 208, 17, 197, 49, 45, 19, 232, 157, 251,
131, 137, 175, 72, 126, 43, 229, 69, 179, 117, 82,
157, 213, 83, 35, 57, 210, 197, 252, 171, 143, 194,
11, 47, 163, 6, 253, 75, 252, 96, 11, 187, 84, 130,
210, 7, 121, 78, 91, 79, 57, 251, 138, 132, 220, 60,
224, 173, 56, 224, 201]</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>The resulting JWE Encrypted Key value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">51</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">208</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span>
<span class="mi">121</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span>
<span class="mi">220</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span>
<span class="mi">121</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span>
<span class="mi">133</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span>
<span class="mi">217</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span>
<span class="mi">92</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span>
<span class="mi">0</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">123</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">138</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
<span class="mi">45</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span>
<span class="mi">109</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">187</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span>
<span class="mi">13</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">188</span><span class="p">,</span>
<span class="mi">69</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span>
<span class="mi">119</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span>
<span class="mi">73</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span>
<span class="mi">95</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">144</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span>
<span class="mi">137</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">184</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span>
<span class="mi">222</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">251</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span>
<span class="mi">109</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.4">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.4</a> )</p>
</div>
<div class="section" id="a-1-5-encoded-jwe-encrypted-key">
<span id="jwe-appendix-a-1-5"></span><h4><a class="toc-backref" href="#id44">A.1.5. Encoded JWE Encrypted Key</a><a class="headerlink" href="#a-1-5-encoded-jwe-encrypted-key" title="Permalink to this headline">¶</a></h4>
<p>Base64url encode the <a class="reference internal" href="jwa.html#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>
to produce the <a class="reference internal" href="jwa.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>.</p>
<p>This result (with line breaks for display purposes only) is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">M2XxpbORKezKSzzQL_95</span><span class="o">-</span><span class="nx">GjiudRBTqn_omS8z9xgoRb7L0Jw5UsEbxmtyHn2T71m</span>
<span class="nx">rZLkjg4Mp8gbhYoltPkEOHvAopz25</span><span class="o">-</span><span class="nx">vZ8C2e1cOaAo5WPcbSIuFcB4DjBOM3t0UA</span>
<span class="nx">O6JHkWLuAEYoe58lcxIQneyKdaYSLbV9cKqoUoFQpvKWYRHZbfszIyfsa18rmgTj</span>
<span class="nx">zrtLDTPnc09DSJE24aQ8w3i8RXEDthW9T1J6LsTH_vwHdwUgkI</span><span class="o">-</span><span class="nx">tC2PNeGrnM</span><span class="o">-</span><span class="nx">dN</span>
<span class="nx">SfzF3Y7</span><span class="o">-</span><span class="nx">lwcGy0FsdXkPXytvDV7y4pZeeUiQ</span><span class="o">-</span><span class="mi">0</span><span class="nx">VdibIN2AjjfW60nfrPuOjepMFG</span>
<span class="mi">6</span><span class="nx">BBBbR37pHcyzext9epOAQ</span>
</pre></div>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.5</a> )</p>
</div>
<div class="section" id="a-1-6-initialization-vector">
<span id="jwe-appendix-a-1-6"></span><h4><a class="toc-backref" href="#id45">A.1.6. Initialization Vector</a><a class="headerlink" href="#a-1-6-initialization-vector" title="Permalink to this headline">¶</a></h4>
<p>Generate a random <strong>96 bit</strong> <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a>.</p>
<p>In this example, the value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">227</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">219</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding this value yields the <a class="reference internal" href="#term-encoded-jwe-initialization-vector"><em class="xref std std-term">Encoded JWE Initialization Vector</em></a> value:</p>
<div class="highlight-python"><pre>48V1_ALb6US04U3b</pre>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.5">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.5</a> )</p>
</div>
<div class="section" id="a-1-7-additional-authenticated-data-parameter">
<span id="jwe-appendix-a-1-7"></span><h4><a class="toc-backref" href="#id46">A.1.7. &#8220;Additional Authenticated Data&#8221; Parameter</a><a class="headerlink" href="#a-1-7-additional-authenticated-data-parameter" title="Permalink to this headline">¶</a></h4>
<p>Concatenate
the <a class="reference internal" href="jwa.html#term-encoded-jwe-header"><em class="xref std std-term">Encoded JWE Header</em></a> value, a period character (&#8216;.&#8217;),
the <a class="reference internal" href="jwa.html#term-encoded-jwe-encrypted-key"><em class="xref std std-term">Encoded JWE Encrypted Key</em></a>, a second period character (&#8216;.&#8217;), and
the <a class="reference internal" href="#term-encoded-jwe-initialization-vector"><em class="xref std std-term">Encoded JWE Initialization Vector</em></a>
to create the &#8220;<em class="xref std std-term">additional authenticated data</em>&#8221; parameter
for the <em class="xref std std-term">AES GCM</em> algorithm.</p>
<p>This result (with line breaks for display purposes only) is:</p>
<div class="highlight-python"><pre>eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.
M2XxpbORKezKSzzQL_95-GjiudRBTqn_omS8z9xgoRb7L0Jw5UsEbxmtyHn2T71m
rZLkjg4Mp8gbhYoltPkEOHvAopz25-vZ8C2e1cOaAo5WPcbSIuFcB4DjBOM3t0UA
O6JHkWLuAEYoe58lcxIQneyKdaYSLbV9cKqoUoFQpvKWYRHZbfszIyfsa18rmgTj
zrtLDTPnc09DSJE24aQ8w3i8RXEDthW9T1J6LsTH_vwHdwUgkI-tC2PNeGrnM-dN
SfzF3Y7-lwcGy0FsdXkPXytvDV7y4pZeeUiQ-0VdibIN2AjjfW60nfrPuOjepMFG
6BBBbR37pHcyzext9epOAQ.
48V1_ALb6US04U3b</pre>
</div>
<p>The representation of this value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">116</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>
<span class="mi">54</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span>
<span class="mi">77</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span>
<span class="mi">76</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span>
<span class="mi">111</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span>
<span class="mi">119</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span>
<span class="mi">49</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span>
<span class="mi">89</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span>
<span class="mi">53</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span>
<span class="mi">80</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span>
<span class="mi">116</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<span class="mi">101</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span>
<span class="mi">83</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span>
<span class="mi">87</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span>
<span class="mi">114</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span>
<span class="mi">57</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">68</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span>
<span class="mi">72</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span>
<span class="mi">114</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span>
<span class="mi">119</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span>
<span class="mi">68</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
<span class="mi">105</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span>
<span class="mi">80</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span>
<span class="mi">55</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span>
<span class="mi">46</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">98</span><span class="p">]</span>
</pre></div>
</div>
<p>( draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.7">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.7</a> )</p>
</div>
<div class="section" id="a-1-8-plaintext-encryption">
<span id="jwe-appendix-a-1-8"></span><h4><a class="toc-backref" href="#id47">A.1.8. Plaintext Encryption</a><a class="headerlink" href="#a-1-8-plaintext-encryption" title="Permalink to this headline">¶</a></h4>
<p>Encrypt the <a class="reference internal" href="jwa.html#term-plaintext"><em class="xref std std-term">Plaintext</em></a> with <em class="xref std std-term">AES GCM</em>
using the <a class="reference internal" href="jwa.html#term-cmk"><em class="xref std std-term">CMK</em></a> as the encryption key,
the <a class="reference internal" href="#term-jwe-initialization-vector"><em class="xref std std-term">JWE Initialization Vector</em></a>,
and the &#8220;<em class="xref std std-term">additional authenticated data</em>&#8221; value above,
requesting a 128 bit &#8220;<a class="reference internal" href="#term-authentication-tag"><em class="xref std std-term">authentication tag</em></a>&#8221; output.</p>
<p>The resulting Ciphertext is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">253</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span>
<span class="mi">246</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">195</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">175</span><span class="p">]</span>
</pre></div>
</div>
<p>The resulting &#8220;authentication tag&#8221; value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">237</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">159</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span>
<span class="mi">82</span><span class="p">]</span>
</pre></div>
</div>
<p>(draft08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.8">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.8</a>)</p>
</div>
<div class="section" id="a-1-9-encoded-jwe-ciphertext">
<span id="jwe-appendix-a-1-9"></span><h4><a class="toc-backref" href="#id48">A.1.9. Encoded JWE Ciphertext</a><a class="headerlink" href="#a-1-9-encoded-jwe-ciphertext" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>AES GCM encrypt function will produce:</p>
<ul class="last simple">
<li>Ciphertext</li>
<li>authentication tag</li>
</ul>
</div>
<p>Base64url encode the resulting <a class="reference internal" href="jwa.html#term-ciphertext"><em class="xref std std-term">Ciphertext</em></a> to create the <a class="reference internal" href="jwa.html#term-encoded-jwe-ciphertext"><em class="xref std std-term">Encoded JWE Ciphertext</em></a>.</p>
<p>This result is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">_e21tGGhac_peEFkLXr2dMPUZiUkrw</span>
</pre></div>
</div>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.9">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.9</a> )</p>
</div>
<div class="section" id="a-1-10-encoded-jwe-integrity-value">
<span id="jwe-appendix-a-1-10"></span><h4><a class="toc-backref" href="#id49">A.1.10. Encoded JWE Integrity Value</a><a class="headerlink" href="#a-1-10-encoded-jwe-integrity-value" title="Permalink to this headline">¶</a></h4>
<p>Base64url encode the resulting &#8220;<a class="reference internal" href="#term-authentication-tag"><em class="xref std std-term">authentication tag</em></a>&#8221;
to create the <em class="xref std std-term">Encoded JWE Integrity Value.</em></p>
<p>This result is:</p>
<div class="highlight-python"><pre>7V5ZDko0v_mf2PAc4JMiUg</pre>
</div>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.10">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.10</a> )</p>
</div>
<div class="section" id="a-1-11-complete-representation">
<span id="jwe-appendix-a-1-11"></span><h4><a class="toc-backref" href="#id50">A.1.11. Complete Representation</a><a class="headerlink" href="#a-1-11-complete-representation" title="Permalink to this headline">¶</a></h4>
<p>Assemble the final representation:
The <em class="xref std std-term">Compact Serialization</em> of this result is the concatenation of
the Encoded JWE Header,
the Encoded JWE Encrypted Key,
the Encoded JWE Initialization Vector,
the Encoded JWE Ciphertext, and
the Encoded JWE Integrity Value in that order,
with the five strings being separated by four period (&#8216;.&#8217;) characters.</p>
<p>The final result in this example (with line breaks for display purposes only) is:</p>
<div class="highlight-python"><pre>eyJhbGciOiJSU0EtT0FFUCIsImVuYyI6IkEyNTZHQ00ifQ.
M2XxpbORKezKSzzQL_95-GjiudRBTqn_omS8z9xgoRb7L0Jw5UsEbxmtyHn2T71m
rZLkjg4Mp8gbhYoltPkEOHvAopz25-vZ8C2e1cOaAo5WPcbSIuFcB4DjBOM3t0UA
O6JHkWLuAEYoe58lcxIQneyKdaYSLbV9cKqoUoFQpvKWYRHZbfszIyfsa18rmgTj
zrtLDTPnc09DSJE24aQ8w3i8RXEDthW9T1J6LsTH_vwHdwUgkI-tC2PNeGrnM-dN
SfzF3Y7-lwcGy0FsdXkPXytvDV7y4pZeeUiQ-0VdibIN2AjjfW60nfrPuOjepMFG
6BBBbR37pHcyzext9epOAQ.
48V1_ALb6US04U3b.
_e21tGGhac_peEFkLXr2dMPUZiUkrw.
7V5ZDko0v_mf2PAc4JMiUg</pre>
</div>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.11">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.11</a> )</p>
</div>
<div class="section" id="a-1-12-validation">
<span id="jwe-appendix-a-1-12"></span><h4><a class="toc-backref" href="#id51">A.1.12. Validation</a><a class="headerlink" href="#a-1-12-validation" title="Permalink to this headline">¶</a></h4>
<p>This example illustrates the process of creating a JWE
with an <em class="xref std std-term">Authenticated Encryption</em> algorithm.</p>
<p>These results can be used to validate JWE decryption implementations for these algorithms.
Note that since the <em class="xref std std-term">RSAES OAEP</em> computation includes random values,
the encryption results above will not be completely reproducible.</p>
<p>However,
since the <em class="xref std std-term">AES GCM</em> computation is deterministic,
the <em class="xref std std-term">JWE Encrypted Ciphertext</em> values will be the same
for all encryptions performed using these inputs.</p>
<p>(draft 08, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.12">http://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-08#appendix-A.1.12</a> )</p>
</div>
</div>
<div class="section" id="a-2-example-jwe-using-rsaes-pkcs1-v1-5-and-aes-128-cbc-hmac-sha-256">
<span id="jwe-appendix-a-2"></span><h3><a class="toc-backref" href="#id52">A.2. Example JWE using RSAES-PKCS1-V1_5 and AES_128_CBC_HMAC_SHA_256</a><a class="headerlink" href="#a-2-example-jwe-using-rsaes-pkcs1-v1-5-and-aes-128-cbc-hmac-sha-256" title="Permalink to this headline">¶</a></h3>
<p>This example encrypts the plaintext &#8220;Live long and prosper.&#8221; to the
recipient using RSAES-PKCS1-V1_5 for key encryption and
AES_128_CBC_HMAC_SHA_256 for content encryption.  The representation
of this plaintext is:</p>
<blockquote>
<div>[76, 105, 118, 101, 32, 108, 111, 110, 103, 32, 97, 110, 100, 32,
112, 114, 111, 115, 112, 101, 114, 46]</div></blockquote>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2</a> )</p>
<div class="section" id="a-2-1-jwe-header">
<span id="jwe-appendix-a-2-1"></span><h4><a class="toc-backref" href="#id53">A.2.1. JWE Header</a><a class="headerlink" href="#a-2-1-jwe-header" title="Permalink to this headline">¶</a></h4>
<p>The following example JWE Header (with line breaks for display
purposes only) declares that:</p>
<blockquote>
<div><ul class="simple">
<li>the Content Encryption Key is encrypted to the recipient using the
RSAES-PKCS1-V1_5 algorithm to produce the JWE Encrypted Key and</li>
<li>the Plaintext is encrypted using the AES_128_CBC_HMAC_SHA_256
algorithm to produce the Ciphertext.</li>
</ul>
</div></blockquote>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span><span class="s">&quot;alg&quot;</span><span class="p">:</span><span class="s">&quot;RSA1_5&quot;</span><span class="p">,</span><span class="s">&quot;enc&quot;</span><span class="p">:</span><span class="s">&quot;A128CBC-HS256&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.1</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>CEK は RSA AES PKCS1 V.1.5 で非対称暗号化されて JEK となる</li>
<li>Plaintextは AES_128_CBC_HMAC_SHA_256 でCEKを使った共有鍵暗号化で Ciphertextとなる</li>
</ul>
</div>
</div>
<div class="section" id="a-2-2-encoded-jwe-header">
<span id="jwe-appendix-a-2-2"></span><h4><a class="toc-backref" href="#id54">A.2.2. Encoded JWE Header</a><a class="headerlink" href="#a-2-2-encoded-jwe-header" title="Permalink to this headline">¶</a></h4>
<p>Base64url encoding the octets of the UTF-8 representation of the JWE
Header yields this Encoded JWE Header value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJSU0ExXzUiLCJlbmMiOiJBMTI4Q0JDLUhTMjU2In0</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.2</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>JWE Header JSONのオクテットストリングをBase64URL化 -&gt; EJH</li>
</ul>
</div>
</div>
<div class="section" id="a-2-3-content-encryption-key-cek">
<span id="jwe-appendix-a-2-3"></span><h4><a class="toc-backref" href="#id55">A.2.3. Content Encryption Key (CEK)</a><a class="headerlink" href="#a-2-3-content-encryption-key-cek" title="Permalink to this headline">¶</a></h4>
<p>Generate a 256 bit random Content Encryption Key (CEK).  In this
example, the key value is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span>
<span class="mi">206</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span>
<span class="mi">44</span><span class="p">,</span> <span class="mi">207</span><span class="p">]</span>
</pre></div>
</div>
<p>(  <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.3</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>CEK を32オクテット乱数で生成</li>
</ul>
</div>
</div>
<div class="section" id="a-2-4-key-encryption">
<span id="jwe-appendix-a-2-4"></span><h4><a class="toc-backref" href="#id56">A.2.4. Key Encryption</a><a class="headerlink" href="#a-2-4-key-encryption" title="Permalink to this headline">¶</a></h4>
<p>Encrypt the CEK with the recipient&#8217;s public key
using the RSAES-PKCS1-V1_5 algorithm to produce the JWE Encrypted Key.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>相手の公開鍵を使ってCEKを非対称暗号化</li>
<li>RSA AES PKCS1 v.1.5</li>
</ul>
</div>
<p>This example uses the RSA key represented in JSON Web Key [JWK] format below
(with line breaks for display purposes only):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;kty&quot;</span><span class="o">:</span><span class="s2">&quot;RSA&quot;</span><span class="p">,</span>
 <span class="s2">&quot;n&quot;</span><span class="o">:</span><span class="s2">&quot;sXchDaQebHnPiGvyDOAT4saGEUetSyo9MKLOoWFsueri23bOdgWp4Dy1Wl</span>
<span class="s2">      UzewbgBHod5pcM9H95GQRV3JDXboIRROSBigeC5yjU1hGzHHyXss8UDpre</span>
<span class="s2">      cbAYxknTcQkhslANGRUZmdTOQ5qTRsLAt6BTYuyvVRdhS8exSZEy_c4gs_</span>
<span class="s2">      7svlJJQ4H9_NxsiIoLwAEk7-Q3UXERGYw_75IDrGA84-lA_-Ct4eTlXHBI</span>
<span class="s2">      Y2EaV7t7LjJaynVJCpkv4LKjTTAumiGUIuQhrNhZLuF_RJLqHpM2kgWFLU</span>
<span class="s2">      7-VTdL1VbC2tejvcI2BlMkEpk1BzBZI0KQB0GaDWFLN-aEAw3vRw&quot;</span><span class="p">,</span>
 <span class="s2">&quot;e&quot;</span><span class="o">:</span><span class="s2">&quot;AQAB&quot;</span><span class="p">,</span>
 <span class="s2">&quot;d&quot;</span><span class="o">:</span><span class="s2">&quot;VFCWOqXr8nvZNyaaJLXdnNPXZKRaWCjkU5Q2egQQpTBMwhprMzWzpR8Sxq</span>
<span class="s2">      1OPThh_J6MUD8Z35wky9b8eEO0pwNS8xlh1lOFRRBoNqDIKVOku0aZb-ry</span>
<span class="s2">      nq8cxjDTLZQ6Fz7jSjR1Klop-YKaUHc9GsEofQqYruPhzSA-QgajZGPbE_</span>
<span class="s2">      0ZaVDJHfyd7UUBUKunFMScbflYAAOYJqVIVwaYR5zWEEceUjNnTNo_CVSj</span>
<span class="s2">      -VvXLO5VZfCUAVLgW4dpf1SrtZjSt34YLsRarSb127reG_DUwg9Ch-Kyvj</span>
<span class="s2">      T1SkHgUWRVGcyly7uvVGRSDwsXypdrNinPA4jlhoNdizK2zF2CWQ&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The resulting JWE Encrypted Key value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">80</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span>
<span class="mi">176</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span>
<span class="mi">156</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">209</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span>
<span class="mi">116</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span>
<span class="mi">226</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span>
<span class="mi">212</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">161</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span>
<span class="mi">215</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">206</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">158</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span>
<span class="mi">66</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">132</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">137</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span>
<span class="mi">54</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span>
<span class="mi">250</span><span class="p">,</span> <span class="mi">126</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span>
<span class="mi">21</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span>
<span class="mi">166</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">149</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span>
<span class="mi">150</span><span class="p">,</span> <span class="mi">154</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span>
<span class="mi">124</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span>
<span class="mi">16</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">182</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">194</span><span class="p">,</span> <span class="mi">162</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span>
<span class="mi">248</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">207</span><span class="p">,</span> <span class="mi">249</span><span class="p">,</span> <span class="mi">193</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">131</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span>
<span class="mi">101</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">125</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">147</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span>
<span class="mi">146</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">136</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">252</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.4</a> )</p>
</div>
<div class="section" id="a-2-5-encoded-jwe-encrypted-key">
<span id="jwe-appendix-a-2-5"></span><h4><a class="toc-backref" href="#id57">A.2.5. Encoded JWE Encrypted Key</a><a class="headerlink" href="#a-2-5-encoded-jwe-encrypted-key" title="Permalink to this headline">¶</a></h4>
<p>Base64url encode the JWE Encrypted Key
to produce the Encoded JWE Encrypted Key.</p>
<p>This result (with line breaks for display purposes only) is:</p>
<div class="highlight-python"><pre>UGhIOguC7IuEvf_NPVaXsGMoLOmwvc1GyqlIKOK1nN94nHPoltGRhWhw7Zx0-kFm
1NJn8LE9XShH59_i8J0PH5ZZyNfGy2xGdULU7sHNF6Gp2vPLgNZ__deLKxGHZ7Pc
HALUzoOegEI-8E66jX2E4zyJKx-YxzZIItRzC5hlRirb6Y5Cl_p-ko3YvkkysZIF
NPccxRU7qve1WYPxqbb2Yw8kZqa2rMWI5ng8OtvzlV7elprCbuPhcCdZ6XDP0_F8
rkXds2vE4X-ncOIM8hAYHHi29NX0mcKiRaD0-D-ljQTP-cFPgwCp6X-nZZd9OHBv
-B3oWh2TbqmScqXMR4gp_A</pre>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.5</a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>非対称暗合化で生成された JEK を Base64URLして EJEK</li>
</ul>
</div>
</div>
<div class="section" id="a-2-6-initialization-vector">
<span id="jwe-appendix-a-2-6"></span><h4><a class="toc-backref" href="#id58">A.2.6. Initialization Vector</a><a class="headerlink" href="#a-2-6-initialization-vector" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>初期化ベクタは 16 オクテットランダムで作ってみる</li>
</ul>
</div>
<p>Generate a random 128 bit JWE Initialization Vector.
In this example, the value is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">101</span><span class="p">]</span>
</pre></div>
</div>
<p>Base64url encoding this value yields this Encoded JWE Initialization
Vector value:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">AxY8DCtDaGlsbGljb3RoZQ</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.6</a> )</p>
</div>
<div class="section" id="a-2-7-additional-authenticated-data">
<span id="jwe-appendix-a-2-7"></span><h4><a class="toc-backref" href="#id59">A.2.7. Additional Authenticated Data</a><a class="headerlink" href="#a-2-7-additional-authenticated-data" title="Permalink to this headline">¶</a></h4>
<p>Let the Additional Authenticated Data encryption parameter be the
octets of the ASCII representation of the Encoded JWE Header value.
This AAD value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span>
<span class="mi">120</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">122</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">74</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span>
<span class="mi">50</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">48</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.7">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.7</a> )</p>
</div>
<div class="section" id="a-2-8-plaintext-encryption">
<span id="jwe-appendix-a-2-8"></span><h4><a class="toc-backref" href="#id60">A.2.8. Plaintext Encryption</a><a class="headerlink" href="#a-2-8-plaintext-encryption" title="Permalink to this headline">¶</a></h4>
<p>Encrypt the Plaintext with AES_128_CBC_HMAC_SHA_256 using the CEK as
the encryption key, the JWE Initialization Vector, and the Additional
Authenticated Data value above.  The steps for doing this using the
values from Appendix A.3 are detailed in Appendix B.  The resulting
Ciphertext is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
<span class="mi">75</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span>
<span class="mi">112</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">102</span><span class="p">]</span>
</pre></div>
</div>
<p>The resulting Authentication Tag value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">246</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">190</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span>
<span class="mi">191</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.8">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-A.2.8</a> )</p>
</div>
</div>
</div>
<div class="section" id="appendix-b-example-aes-128-cbc-hmac-sha-256-computation">
<span id="jwe-appendix-b"></span><h2><a class="toc-backref" href="#id61">Appendix B. Example AES_128_CBC_HMAC_SHA_256 Computation</a><a class="headerlink" href="#appendix-b-example-aes-128-cbc-hmac-sha-256-computation" title="Permalink to this headline">¶</a></h2>
<p>This example shows the steps in the AES_128_CBC_HMAC_SHA_256
authenticated encryption computation using the values from the example in Appendix A.3.</p>
<p>As described where this algorithm is defined in Sections 4.8 and 4.8.3 of JWA,
the AES_CBC_HMAC_SHA2 family of algorithms are implemented using Advanced Encryption
Standard (AES) in Cipher Block Chaining (CBC) mode with PKCS #5
padding to perform the encryption and an HMAC SHA-2 function to
perform the integrity calculation - in this case, HMAC SHA-256.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B</a> )</p>
<div class="section" id="b-1-extract-mac-key-and-enc-key-from-key">
<span id="jwe-appendix-b-1"></span><h3><a class="toc-backref" href="#id62">B.1. Extract MAC_KEY and ENC_KEY from Key</a><a class="headerlink" href="#b-1-extract-mac-key-and-enc-key-from-key" title="Permalink to this headline">¶</a></h3>
<p>The 256 bit AES_128_CBC_HMAC_SHA_256 key K used in this example is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span>
<span class="mi">206</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span>
<span class="mi">44</span><span class="p">,</span> <span class="mi">207</span><span class="p">]</span>
</pre></div>
</div>
<p>Use the first 128 bits of this key as the HMAC SHA-256 key MAC_KEY,
which is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">197</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">157</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span>
<span class="mi">206</span><span class="p">]</span>
</pre></div>
</div>
<p>Use the last 128 bits of this key as the AES CBC key ENC_KEY, which is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">107</span><span class="p">,</span> <span class="mi">124</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span>
<span class="mi">207</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that the MAC key comes before the encryption key in the input
key K; this is in the opposite order of the algorithm names in the
identifiers &#8220;AES_128_CBC_HMAC_SHA_256&#8221; and &#8220;A128CBC-HS256&#8221;.</p>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.1">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.1</a> )</p>
</div>
<div class="section" id="b-2-encrypt-plaintext-to-create-ciphertext">
<span id="jwe-appendix-b-2"></span><h3><a class="toc-backref" href="#id63">B.2. Encrypt Plaintext to Create Ciphertext</a><a class="headerlink" href="#b-2-encrypt-plaintext-to-create-ciphertext" title="Permalink to this headline">¶</a></h3>
<p>Encrypt the Plaintext with AES in Cipher Block Chaining (CBC) mode
using PKCS #5 padding using the ENC_KEY above.  The Plaintext in this
example is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">76</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span>
<span class="mi">112</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">46</span><span class="p">]</span>
</pre></div>
</div>
<p>The encryption result is as follows, which is the Ciphertext output:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">40</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">152</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span>
<span class="mi">75</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span>
<span class="mi">112</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">102</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.2">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.2</a> )</p>
</div>
<div class="section" id="b-3-64-bit-big-endian-representation-of-aad-length">
<span id="jwe-appendix-b-3"></span><h3><a class="toc-backref" href="#id64">B.3. 64 Bit Big Endian Representation of AAD Length</a><a class="headerlink" href="#b-3-64-bit-big-endian-representation-of-aad-length" title="Permalink to this headline">¶</a></h3>
<p>The Additional Authenticated Data (AAD) in this example is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span>
<span class="mi">83</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span>
<span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>
<span class="mi">110</span><span class="p">,</span> <span class="mi">48</span><span class="p">]</span>
</pre></div>
</div>
<p>This AAD is 51 bytes long, which is 408 bits long.  The octet string
AL, which is the number of bits in AAD expressed as a big endian 64
bit unsigned integer is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">152</span><span class="p">]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>AADのビット数です。オクテット数ではありません。</li>
</ul>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.3">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.3</a> )</p>
</div>
<div class="section" id="b-4-initialization-vector-value">
<span id="jwe-appendix-b-4"></span><h3><a class="toc-backref" href="#id65">B.4. Initialization Vector Value</a><a class="headerlink" href="#b-4-initialization-vector-value" title="Permalink to this headline">¶</a></h3>
<p>The Initialization Vector value used in this example is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span>
<span class="mi">101</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.4">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.4</a> )</p>
</div>
<div class="section" id="b-5-create-input-to-hmac-computation">
<span id="jwe-appendix-b-5"></span><h3><a class="toc-backref" href="#id66">B.5. Create Input to HMAC Computation</a><a class="headerlink" href="#b-5-create-input-to-hmac-computation" title="Permalink to this headline">¶</a></h3>
<p>Concatenate the AAD, the Initialization Vector, the Ciphertext, and
the AL value.  The result of this concatenation is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">101</span><span class="p">,</span> <span class="mi">121</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span>
<span class="mi">83</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span>
<span class="mi">77</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span>
<span class="mi">110</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span>
<span class="mi">116</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">119</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">148</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">185</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span>
<span class="mi">152</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">129</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">183</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span>
<span class="mi">104</span><span class="p">,</span> <span class="mi">143</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">152</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.5">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.5</a> )</p>
</div>
<div class="section" id="b-6-compute-hmac-value">
<span id="jwe-appendix-b-6"></span><h3><a class="toc-backref" href="#id67">B.6. Compute HMAC Value</a><a class="headerlink" href="#b-6-compute-hmac-value" title="Permalink to this headline">¶</a></h3>
<p>Compute the HMAC SHA-256 of the concatenated value above.  This result M is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span>
<span class="mi">194</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">252</span><span class="p">,</span> <span class="mi">145</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">179</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span>
<span class="mi">86</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">116</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.6">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.6</a> )</p>
</div>
<div class="section" id="b-7-truncate-hmac-value-to-create-authentication-tag">
<span id="jwe-appendix-b-7"></span><h3><a class="toc-backref" href="#id68">B.7. Truncate HMAC Value to Create Authentication Tag</a><a class="headerlink" href="#b-7-truncate-hmac-value-to-create-authentication-tag" title="Permalink to this headline">¶</a></h3>
<p>Use the first half (128 bits) of the HMAC output M as the
Authentication Tag output T. This truncated value is:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">[</span><span class="mi">83</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">191</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">205</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">189</span><span class="p">,</span> <span class="mi">199</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span>
<span class="mi">194</span><span class="p">,</span> <span class="mi">85</span><span class="p">]</span>
</pre></div>
</div>
<p>( <a class="reference external" href="https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.7">https://tools.ietf.org/html/draft-ietf-jose-json-web-encryption-13#appendix-B.7</a> )</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jwk.html">JSON Web Key (JWK)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.
    </div>
  </body>
</html>