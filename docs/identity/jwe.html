

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>JSON Web Encryption (JWE) &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="JSON Web Key (JWK)" href="jwk.html" />
    <link rel="prev" title="Holder-of-Key JSON Web Signature (JWS)" href="jws_hok.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>identity 1.0 documentation</span></a></h1>
        <h2 class="heading"><span>JSON Web Encryption (JWE)</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jwk.html">JSON Web Key (JWK)</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="json-web-encryption-jwe">
<h1><a class="toc-backref" href="#id1">JSON Web Encryption (JWE)</a><a class="headerlink" href="#json-web-encryption-jwe" title="Permalink to this headline">¶</a></h1>
<p>Based on draft-jones-json-web-encryption-02(
<a class="reference external" href="http://self-issued.info/docs/draft-jones-json-web-encryption-02.html">http://self-issued.info/docs/draft-jones-json-web-encryption-02.html</a>
)</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">(December 13, 2011)</p>
</div>
<div class="section" id="abstract">
<span id="jwe-abstract"></span><h2><a class="toc-backref" href="#id2">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Encryption (JWE) is a means of representing encrypted content
using JSON data structures.
Related signature capabilities are described
in the separate JSON Web Signature (<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>) specification.</p>
<p>(v.01)</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#json-web-encryption-jwe" id="id1">JSON Web Encryption (JWE)</a><ul>
<li><a class="reference internal" href="#abstract" id="id2">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id3">1.  Introduction</a></li>
<li><a class="reference internal" href="#terminology" id="id4">2. Terminology</a></li>
<li><a class="reference internal" href="#json-web-encryption-jwe-overview" id="id5">3. JSON Web Encryption (JWE) Overview</a><ul>
<li><a class="reference internal" href="#example-jwe" id="id6">3.1.  Example JWE</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jwe-header" id="id7">4.  JWE Header</a><ul>
<li><a class="reference internal" href="#reserved-header-parameter-names" id="id8">4.1.  Reserved Header Parameter Names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cek-encryption" id="id9">7. CEK Encryption</a><ul>
<li><a class="reference internal" href="#asymmetric-encryption" id="id10">7.1.  Asymmetric Encryption</a></li>
<li><a class="reference internal" href="#symmetric-encryption" id="id11">7.2. Symmetric Encryption</a></li>
</ul>
</li>
<li><a class="reference internal" href="#composition" id="id12">8.  Composition</a><ul>
<li><a class="reference internal" href="#encrypting-jwes-with-cryptographic-algorithms" id="id13">9. Encrypting JWEs with Cryptographic Algorithms</a></li>
<li><a class="reference internal" href="#encrypting-a-jwe-with-tbd" id="id14">9.1.  Encrypting a JWE with TBD</a></li>
<li><a class="reference internal" href="#additional-algorithms" id="id15">9.2.  Additional Algorithms</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id16">13. References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id17">13.1. Normative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="jwe-1"></span><h2><a class="toc-backref" href="#id3">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>JSON Web Encryption (JWE) is a compact encryption format
intended for space constrained environments
such as HTTP Authorization headers and
URI query parameters.</p>
<p>It provides a wrapper for encrypted content
using JSON RFC 4627 [<a class="reference internal" href="standard.html#term-rfc4627"><em class="xref std std-term">RFC4627</em></a>] data structures.
The JWE encryption mechanisms are independent of the type of content being encrypted.
A related signature capability is described in a separate JSON Web Signature (JWS) [<a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>] specification.</p>
</div>
<div class="section" id="terminology">
<span id="jwe-2"></span><h2><a class="toc-backref" href="#id4">2. Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h2>
<dl class="glossary docutils">
<dt id="term-json-web-encryption-jwe">JSON Web Encryption (JWE)</dt>
<dd>A data structure representing an encrypted version of a Plaintext.
The structure consists of three parts: the JWE Header, the JWE Encrypted Key, and the JWE Ciphertext.</dd>
<dt id="term-plaintext">Plaintext</dt>
<dd>The bytes to be encrypted - a.k.a., the message.</dd>
<dt id="term-ciphertext">Ciphertext</dt>
<dd>The encrypted version of the Plaintext.</dd>
<dt id="term-content-encryption-key-cek"><span id="term-cek"></span>Content Encryption Key (CEK)<br />CEK</dt>
<dd>A symmetric key generated to encrypt
the Plaintext for the recipient to produce the Ciphertext, which
is encrypted to the recipient as the JWE Encrypted Key.</dd>
<dt id="term-jwe-header">JWE Header</dt>
<dd>A string containing a JSON object that describes the
encryption operations applied to create the JWE Encrypted Key and
the JWE Ciphertext.</dd>
<dt id="term-jwe-encrypted-key">JWE Encrypted Key</dt>
<dd>The <a class="reference internal" href="#term-content-encryption-key-cek"><em class="xref std std-term">Content Encryption Key (CEK)</em></a> is encrypted with the intended recipient&#8217;s key
and the resulting encrypted content is recorded as a byte array,
which is referred to as the JWE Encrypted Key.</dd>
<dt id="term-jwe-ciphertext">JWE Ciphertext</dt>
<dd>A byte array containing the Ciphertext.</dd>
<dt id="term-encoded-jwe-header">Encoded JWE Header</dt>
<dd>Base64url encoding of the bytes of the UTF-8 RFC 3629 [RFC3629] representation of the JWE Header.</dd>
<dt id="term-encoded-jwe-encrypted-key">Encoded JWE Encrypted Key</dt>
<dd>Base64url encoding of the JWE Encrypted Key.</dd>
<dt id="term-encoded-jwe-ciphertext">Encoded JWE Ciphertext</dt>
<dd>Base64url encoding of the JWE Ciphertext.</dd>
<dt id="term-header-parameter-names">Header Parameter Names</dt>
<dd>The names of the members within the JWE Header.</dd>
<dt id="term-header-parameter-values">Header Parameter Values</dt>
<dd>The values of the members within the JWE Header.</dd>
<dt id="term-base64url-encoding">Base64url Encoding</dt>
<dd>For the purposes of this specification, this term always refers to the URL- and filename-safe Base64 encoding
described in RFC 4648 [RFC4648], Section 5,
with the (non URL-safe) &#8216;=&#8217; padding characters omitted, as permitted by Section 3.2.
(See Appendix C of [JWS] for notes on implementing base64url encoding without padding.)</dd>
</dl>
<p>(v.01)</p>
</div>
<div class="section" id="json-web-encryption-jwe-overview">
<span id="jwe-3"></span><h2><a class="toc-backref" href="#id5">3. JSON Web Encryption (JWE) Overview</a><a class="headerlink" href="#json-web-encryption-jwe-overview" title="Permalink to this headline">¶</a></h2>
<p>JWE represents encrypted content using JSON data structures and base64url encoding.
The representation consists of three parts: the JWE Header, the JWE Encrypted Key, and the JWE Ciphertext.
The three parts are base64url-encoded for transmission,
and typically represented as the concatenation of the encoded strings in that order,
with the three strings being separated by period (&#8216;.&#8217;) characters,
as is done when used in JSON Web Tokens (JWTs) <a class="reference internal" href="#term-jwt"><em class="xref std std-term">[JWT]</em></a>.</p>
<p>JWE utilizes encryption to ensure the confidentiality of the contents of the Plaintext.
JWE does not add a content integrity check if not provided by the underlying encryption algorithm.
If such a check is needed, an algorithm providing it such as AES-GCM <a class="reference internal" href="#term-nist-800-38d"><em class="xref std std-term">[NIST-800-38D]</em></a> can be used,
or alternatively, it can be provided through composition by encrypting a representation of the signed content.</p>
<p>(v.01)</p>
<div class="section" id="example-jwe">
<span id="jwe-3-1"></span><h3><a class="toc-backref" href="#id6">3.1.  Example JWE</a><a class="headerlink" href="#example-jwe" title="Permalink to this headline">¶</a></h3>
<p>The following example <a class="reference internal" href="#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> declares that:</p>
<blockquote>
<div><ul class="simple">
<li>the <a class="reference internal" href="glossary.html#term-content-encryption-key"><em class="xref std std-term">Content Encryption Key</em></a> is encrypted to the recipient
using the <em class="xref std std-term">RSA-PKCS1_1.5</em> algorithm to produce the <a class="reference internal" href="#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>,</li>
<li>the <a class="reference internal" href="#term-plaintext"><em class="xref std std-term">Plaintext</em></a> is encrypted using the <em class="xref std std-term">AES-256-GCM</em> algorithm to
produce the <a class="reference internal" href="#term-jwe-ciphertext"><em class="xref std std-term">JWE Ciphertext</em></a>,</li>
<li>the specified <strong>64-bit</strong> <em class="xref std std-term">Initialization Vector</em>
with the base64url encoding <strong>__79_Pv6-fg</strong> was used, and</li>
<li>the <em class="xref std std-term">thumbprint</em> of the <a class="reference internal" href="SamlHokWebSsoProfile.html#term-x-509-certificate"><em class="xref std std-term">X.509 certificate</em></a>
that corresponds to the key used to encrypt the JWE has the base64url encoding <strong>7noOPq-hJ1_hCnvWh6IeYI2w9Q0</strong>.</li>
</ul>
</div></blockquote>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span><span class="s2">&quot;alg&quot;</span><span class="o">:</span><span class="s2">&quot;RSA1_5&quot;</span><span class="p">,</span>
 <span class="s2">&quot;enc&quot;</span><span class="o">:</span><span class="s2">&quot;A256GCM&quot;</span><span class="p">,</span>
 <span class="s2">&quot;iv&quot;</span><span class="o">:</span><span class="s2">&quot;__79_Pv6-fg&quot;</span><span class="p">,</span>
 <span class="s2">&quot;x5t&quot;</span><span class="o">:</span><span class="s2">&quot;7noOPq-hJ1_hCnvWh6IeYI2w9Q0&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Base64url encoding the bytes of the UTF-8 representation of the <a class="reference internal" href="#term-jwe-header"><em class="xref std std-term">JWE Header</em></a> yields
this <a class="reference internal" href="#term-encoded-jwe-header"><em class="xref std std-term">Encoded JWE Header</em></a> value (with line breaks for display purposes only):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">eyJhbGciOiJSU0ExXzUiLA0KICJlbmMiOiJBMjU2R0NNIiwNCiAiaXYiOiJfXzc5</span>
<span class="n">X1B2Ni1mZyIsDQogIng1dCI6Ijdub09QcS1oSjFfaENudldoNkllWUkydzlRMCJ9</span>
</pre></div>
</div>
<p>TBD:
Finish this example by showing generation of a <a class="reference internal" href="glossary.html#term-content-encryption-key"><em class="xref std std-term">Content Encryption Key</em></a> (<a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a>),
using the <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a> to encrypt the <a class="reference internal" href="#term-plaintext"><em class="xref std std-term">Plaintext</em></a> to produce the <a class="reference internal" href="#term-ciphertext"><em class="xref std std-term">Ciphertext</em></a>
(and base64url encoding it),
and using the recipient&#8217;s key to encrypt the <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a>
to produce the <a class="reference internal" href="#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a> (and base64url encoding it).</p>
<p>(December 13, 2011)</p>
</div>
</div>
<div class="section" id="jwe-header">
<span id="jwe-4"></span><h2><a class="toc-backref" href="#id7">4.  JWE Header</a><a class="headerlink" href="#jwe-header" title="Permalink to this headline">¶</a></h2>
<p>The members of the JSON object represented by the JWE Header describe
the encryption applied to the <a class="reference internal" href="#term-plaintext"><em class="xref std std-term">Plaintext</em></a>
and optionally additional properties of the JWE.</p>
<p>The <a class="reference internal" href="jws.html#term-header-parameter-names"><em class="xref std std-term">Header Parameter Names</em></a> within this object MUST be unique.
Implementations MUST understand the entire contents of the header;
otherwise, the JWE MUST be rejected for processing.</p>
<p>( draft 02 )</p>
<div class="section" id="reserved-header-parameter-names">
<span id="jwe-4-1"></span><h3><a class="toc-backref" href="#id8">4.1.  Reserved Header Parameter Names</a><a class="headerlink" href="#reserved-header-parameter-names" title="Permalink to this headline">¶</a></h3>
<p>The following header parameter names are reserved. All the names are short because a core goal of JWE is for the representations to be compact.</p>
<p>TBD:
Describe the relationship between the JWS and JWE header parameters - especially the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> parameter,
which can contain either signature algorithms (from <a class="reference internal" href="jwa.html#term-jws"><em class="xref std std-term">JWS</em></a>)
or encryption algorithms (from <a class="reference internal" href="jwa.html#term-jwe"><em class="xref std std-term">JWE</em></a>),
and the key reference parameters <a class="reference internal" href="glossary.html#term-jku"><em class="xref std std-term">jku</em></a>, <em class="xref std std-term">kid</em>, <em class="xref std std-term">x5u</em>, and <em class="xref std std-term">x5t</em>.</p>
<table border="1" class="docutils" id="jwe-table-1">
<caption>Table 1: Reserved Header Parameter Definitions</caption>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="77%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>Header Parameter Name</td>
<td>JSON Value Type</td>
<td>Header Parameter Syntax</td>
<td>Header Parameter Semantics</td>
</tr>
<tr class="row-even"><td>alg</td>
<td>string</td>
<td>StringOrURI</td>
<td><p class="first">The <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (algorithm) header parameter identifies
the cryptographic algorithm used to secure the <a class="reference internal" href="#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>.</p>
<p>A list of defined <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> values is presented in <a class="reference internal" href="#jwe-table-3"><em>Table 3</em></a>.</p>
<p class="last">The processing of the <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> (algorithm) header parameter requires
that the value MUST be one that is both supported and
for which there exists a key for use with that algorithm associated with the intended recipient.
The <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> value is case sensitive.
This header parameter is REQUIRED.</p>
</td>
</tr>
<tr class="row-odd"><td>enc</td>
<td>string</td>
<td>StringOrURI</td>
<td><p class="first">The <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> (encryption method) header parameter identifies
the <em class="xref std std-term">symmetric encryption algorithm</em> used to secure the <a class="reference internal" href="#term-ciphertext"><em class="xref std std-term">Ciphertext</em></a>.</p>
<p class="last">A list of defined <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> values is presented in <a class="reference internal" href="#jwe-table-4"><em>Table 4</em></a>.
The processing of the enc (encryption method) header parameter requires that the value MUST be one that is supported. The enc value is case sensitive. This header parameter is REQUIRED.</p>
</td>
</tr>
<tr class="row-even"><td>iv</td>
<td>string</td>
<td>String</td>
<td>Initialization Vector (iv) value for algorithms requiring it, represented as a base64url encoded string. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>epk</td>
<td>object</td>
<td>JWK Key Object</td>
<td>Ephemeral Public Key (epk) value created by the originator for the use in ECDH-ES RFC 6090 [RFC6090] encryption. This key is represented in the same manner as a JSON Web Key [JWK] JWK Key Object value, containing crv (curve), x, and y members. The inclusion of the JWK Key Object alg (algorithm) member is OPTIONAL. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>zip</td>
<td>string</td>
<td>String</td>
<td>Compression algorithm (zip) applied to the Plaintext before encryption, if any. This specification defines the value GZIP to refer to the encoding format produced by the file compression program &#8220;gzip&#8221; (GNU zip) as described in [RFC1952]; this format is a Lempel-Ziv coding (LZ77) with a 32 bit CRC. If no zip parameter is present, or its value is none, no compression is applied to the Plaintext before encryption. The zip value is case sensitive. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>jku</td>
<td>string</td>
<td>URL</td>
<td>The jku (JSON Web Key URL) header parameter is an absolute URL that refers to a resource for a set of JSON-encoded public keys, one of which corresponds to the key that was used to encrypt the JWE. The keys MUST be encoded as described in the JSON Web Key (JWK) [JWK] specification. The protocol used to acquire the resource MUST provide integrity protection. An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818] RFC 5246 [RFC5246] with server authentication RFC 6125 [RFC6125]. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>kid</td>
<td>string</td>
<td>String</td>
<td>The kid (key ID) header parameter is a hint indicating which key was used to encrypt the JWE. This allows originators to explicitly signal a change of key to recipients. The interpretation of the contents of the kid parameter is unspecified. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>x5u</td>
<td>string</td>
<td>URL</td>
<td>The x5u (X.509 URL) header parameter is an absolute URL that refers to a resource for the X.509 public key certificate or certificate chain corresponding to the key used to encrypt the JWE. The identified resource MUST provide a representation of the certificate or certificate chain that conforms to RFC 5280 [RFC5280] in PEM encoded form RFC 1421 [RFC1421]. The protocol used to acquire the resource MUST provide integrity protection. An HTTP GET request to retrieve the certificate MUST use TLS RFC 2818 [RFC2818] RFC 5246 [RFC5246] with server authentication RFC 6125 [RFC6125]. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-even"><td>x5t</td>
<td>string</td>
<td>String</td>
<td>The x5t (x.509 certificate thumbprint) header parameter provides a base64url encoded SHA-1 thumbprint (a.k.a. digest) of the DER encoding of the X.509 certificate that corresponds to the key that was used to encrypt the JWE. This header parameter is OPTIONAL.</td>
</tr>
<tr class="row-odd"><td>typ</td>
<td>string</td>
<td>String</td>
<td>The typ (type) header parameter is used to declare the type of the encrypted content. The typ value is case sensitive. This header parameter is OPTIONAL.</td>
</tr>
</tbody>
</table>
<p>Additional reserved header parameter names MAY be defined via the IANA JSON Web Encryption Header Parameters registry, as per Section 10. The syntax values used above are defined as follows:</p>
<table border="1" class="docutils" id="jwe-table-2">
<caption>Table 2: Header Parameter Syntax Definitions</caption>
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Syntax Name</th>
<th class="head">Syntax Definition</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>String</td>
<td>Any string value MAY be used.</td>
</tr>
<tr class="row-odd"><td>StringOrURI</td>
<td>Any string value MAY be used but a value
containing a &#8221;:&#8221; character MUST be a URI
as defined in RFC 3986 [RFC3986].</td>
</tr>
<tr class="row-even"><td>URL</td>
<td>A URL as defined in RFC 1738 [RFC1738].</td>
</tr>
</tbody>
</table>
<p>( : <a class="reference external" href="http://self-issued.info/docs/draft-jones-json-web-encryption.html#ReservedHeaderParameterName">http://self-issued.info/docs/draft-jones-json-web-encryption.html#ReservedHeaderParameterName</a> )</p>
</div>
</div>
<div class="section" id="cek-encryption">
<span id="jwe-7"></span><h2><a class="toc-backref" href="#id9">7. CEK Encryption</a><a class="headerlink" href="#cek-encryption" title="Permalink to this headline">¶</a></h2>
<p>JWE supports two forms of <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a> encryption:</p>
<blockquote>
<div><p>o  Asymmetric encryption under the recipient&#8217;s public key.</p>
<p>o  Symmetric encryption under a shared key.</p>
</div></blockquote>
<div class="section" id="asymmetric-encryption">
<span id="jwe-7-1"></span><h3><a class="toc-backref" href="#id10">7.1.  Asymmetric Encryption</a><a class="headerlink" href="#asymmetric-encryption" title="Permalink to this headline">¶</a></h3>
<p>In the asymmetric encryption mode,
the <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a> is encrypted under the recipient&#8217;s public key.
The asymmetric encryption modes defined for use with this in this specification are listed in in <a class="reference internal" href="#jwe-table-3"><em>Table 3</em></a>.</p>
<p>(draft 02)</p>
</div>
<div class="section" id="symmetric-encryption">
<span id="jwe-7-2"></span><h3><a class="toc-backref" href="#id11">7.2. Symmetric Encryption</a><a class="headerlink" href="#symmetric-encryption" title="Permalink to this headline">¶</a></h3>
<p>In the symmetric encryption mode,
the <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a> is encrypted under a symmetric key shared
between the sender and receiver.</p>
<p>The symmetric encryption modes
defined for use with this in this specification
are listed in in <a class="reference internal" href="#jwe-table-3"><em>Table 3</em></a>.</p>
<p>For <a class="reference internal" href="glossary.html#term-gcm"><em class="xref std std-term">GCM</em></a>, the random 64-bit IV is prepended to the ciphertext.</p>
<p>(draft 02)</p>
</div>
</div>
<div class="section" id="composition">
<span id="jwe-8"></span><h2><a class="toc-backref" href="#id12">8.  Composition</a><a class="headerlink" href="#composition" title="Permalink to this headline">¶</a></h2>
<p>This document does not specify a combination signed and encrypted mode.</p>
<p>However, because the contents of a message can be arbitrary,
encryption and data origin authentication can be provided
by recursively encapsulating multiple JWE and JWS messages.</p>
<p>In general,
senders SHOULD sign the message and then encrypt the result
(thus encrypting the signature).
This prevents attacks in which the signature is stripped,
leaving just an encrypted message,
as well as providing privacy for the signer.</p>
<p>(draft 02)</p>
<div class="section" id="encrypting-jwes-with-cryptographic-algorithms">
<span id="jwe-9"></span><h3><a class="toc-backref" href="#id13">9. Encrypting JWEs with Cryptographic Algorithms</a><a class="headerlink" href="#encrypting-jwes-with-cryptographic-algorithms" title="Permalink to this headline">¶</a></h3>
<p>JWE uses cryptographic algorithms to encrypt the <a class="reference internal" href="#term-content-encryption-key-cek"><em class="xref std std-term">Content Encryption Key (CEK)</em></a> and the Plaintext.
This section specifies a set of specific algorithms for these purposes.</p>
<p>The table below <a class="reference internal" href="#jwe-table-3"><em>Table 3</em></a> is the set of &#8220;<a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a>&#8221; header parameter values
that are reserved by this specification.
These algorithms are used to encrypt the <a class="reference internal" href="#term-cek"><em class="xref std std-term">CEK</em></a>, which produces the <a class="reference internal" href="#term-jwe-encrypted-key"><em class="xref std std-term">JWE Encrypted Key</em></a>.</p>
<table border="1" class="docutils" id="jwe-table-3">
<caption>Table 3: JWE Reserved alg Parameter Values</caption>
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>alg Parameter Value</td>
<td>Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>RSA1_5</td>
<td>RSA using RSA-PKCS1-1.5 padding, as defined in RFC 3447 [<a class="reference internal" href="jwa.html#term-rfc3447"><em class="xref std std-term">RFC3447</em></a>]</td>
</tr>
<tr class="row-odd"><td>RSA-OAEP</td>
<td>RSA using Optimal Asymmetric Encryption Padding (<em class="xref std std-term">OAEP</em>),
as defined in RFC 3447 [<a class="reference internal" href="jwa.html#term-rfc3447"><em class="xref std std-term">RFC3447</em></a>]</td>
</tr>
<tr class="row-even"><td>ECDH-ES</td>
<td>Elliptic Curve Diffie-Hellman Ephemeral Static,
as defined in RFC 6090 [<a class="reference internal" href="jwa.html#term-rfc6090"><em class="xref std std-term">RFC6090</em></a>],
and using the Concat KDF, as defined in [<em class="xref std std-term">NIST‑800‑56A</em>],
where the Digest Method is SHA-256</td>
</tr>
<tr class="row-odd"><td>A128KW</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>) Key Wrap Algorithm
using <strong>128</strong> bit keys, as defined in RFC 3394 [<a class="reference internal" href="jwa.html#term-rfc3394"><em class="xref std std-term">RFC3394</em></a>]</td>
</tr>
<tr class="row-even"><td>A256KW</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>) Key Wrap Algorithm
using <strong>256</strong> bit keys, as defined in RFC 3394 [<a class="reference internal" href="jwa.html#term-rfc3394"><em class="xref std std-term">RFC3394</em></a>]</td>
</tr>
<tr class="row-odd"><td>A128GCM</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using <strong>128</strong> bit keys in Galois/Counter Mode,
as defined in [<em class="xref std std-term">FIPS‑197]</em> and [<em class="xref std std-term">NIST‑800‑38D</em>]</td>
</tr>
<tr class="row-even"><td>A256GCM</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using <strong>256</strong> bit keys in Galois/Counter Mode,
as defined in [<em class="xref std std-term">FIPS‑197</em>] and [<em class="xref std std-term">NIST‑800‑38D</em>]</td>
</tr>
</tbody>
</table>
<p>The table below <a class="reference internal" href="#jwe-table-4"><em>Table 4</em></a> is the set of &#8220;enc&#8221; header parameter values
that are reserved by this specification.  These algorithms are used
to encrypt the Plaintext, which produces the Ciphertext.</p>
<table border="1" class="docutils" id="jwe-table-4">
<caption>Table 4: JWE Reserved enc Parameter Values</caption>
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>enc</td>
<td>Parameter Value Symmetric Encryption Algorithm</td>
</tr>
<tr class="row-even"><td>A128CBC</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using 128 bit keys in Cipher Block Chaining mode, as defined in [FIPS‑197] and [NIST‑800‑38A]</td>
</tr>
<tr class="row-odd"><td>A256CBC</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using 256 bit keys in Cipher Block Chaining mode, as defined in [FIPS‑197] and [NIST‑800‑38A]</td>
</tr>
<tr class="row-even"><td>A128GCM</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using 128 bit keys in Galois/Counter Mode, as defined in [FIPS‑197] and [NIST‑800‑38D]</td>
</tr>
<tr class="row-odd"><td>A256GCM</td>
<td>Advanced Encryption Standard (<em class="xref std std-term">AES</em>)
using 256 bit keys in Galois/Counter Mode, as defined in [FIPS‑197] and [NIST‑800‑38D]</td>
</tr>
</tbody>
</table>
<p>Of these algorithms,
only <a class="reference internal" href="glossary.html#term-rsa-pkcs1-1-5"><em class="xref std std-term">RSA-PKCS1-1.5</em></a> with 2048 bit keys,
<em class="xref std std-term">AES-128-CBC</em>,
and <em class="xref std std-term">AES-256-CBC</em> MUST be implemented by conforming implementations.
It is RECOMMENDED that
implementations also support <a class="reference internal" href="glossary.html#term-ecdh-es"><em class="xref std std-term">ECDH-ES</em></a> with 256 bit keys, <em class="xref std std-term">AES-128-GCM</em>,
and <em class="xref std std-term">AES-256-GCM</em>.
Support for other algorithms and key sizes is OPTIONAL.</p>
</div>
<div class="section" id="encrypting-a-jwe-with-tbd">
<span id="jwe-9-1"></span><h3><a class="toc-backref" href="#id14">9.1.  Encrypting a JWE with TBD</a><a class="headerlink" href="#encrypting-a-jwe-with-tbd" title="Permalink to this headline">¶</a></h3>
<p>TBD: Descriptions of the particulars of using each specified algorithm go here.</p>
<p>(draft 02)</p>
</div>
<div class="section" id="additional-algorithms">
<span id="jwe-9-2"></span><h3><a class="toc-backref" href="#id15">9.2.  Additional Algorithms</a><a class="headerlink" href="#additional-algorithms" title="Permalink to this headline">¶</a></h3>
<p>Additional algorithms MAY be used to protect JWEs
with corresponding <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> and <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> header parameter values
being defined to refer to them.
New <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> and <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> header parameter values
SHOULD either be defined in the <a class="reference internal" href="glossary.html#term-iana-json-web-encryption-algorithms"><em class="xref std std-term">IANA JSON Web Encryption Algorithms</em></a> registry
or be a <strong>URI</strong> that contains a collision resistant namespace.</p>
<p>In particular,
it is permissible to use the algorithm identifiers defined in XML Encryption
[<em class="xref std std-term">W3C.REC‑xmlenc‑core‑20021210</em>], XML Encryption 1.1 [<em class="xref std std-term">W3C.CR‑xmlenc‑core1‑20110303</em>],
and related specifications as <a class="reference internal" href="glossary.html#term-alg"><em class="xref std std-term">alg</em></a> and <a class="reference internal" href="glossary.html#term-enc"><em class="xref std std-term">enc</em></a> values.</p>
<p>(draft 02)</p>
</div>
</div>
<div class="section" id="references">
<span id="jwe-13"></span><h2><a class="toc-backref" href="#id16">13. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<div class="section" id="normative-references">
<span id="jwe-13-1"></span><h3><a class="toc-backref" href="#id17">13.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-fips-197">[FIPS-197]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Advanced Encryption Standard (AES)&#8221;, FIPS PUB 197,
November 2001.</dd>
<dt id="term-jwk">[JWK]</dt>
<dd>Jones, M., &#8220;JSON Web Key (JWK)&#8221;, October 2011.</dd>
<dt id="term-jws">[JWS]</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
J., Sakimura, N., and P. Tarjan, &#8220;JSON Web Signature
(JWS)&#8221;, October 2011.</dd>
<dt id="term-nist-800-38a">[NIST-800-38A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation&#8221;,
NIST PUB 800-38A, December 2001.</dd>
<dt id="term-nist-800-38d">[NIST-800-38D]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Block Cipher Modes of Operation:
Galois/Counter Mode (GCM) and GMAC&#8221;, NIST PUB 800-38D,
December 2001.</dd>
<dt id="term-nist-800-56a">[NIST-800-56A]</dt>
<dd>National Institute of Standards and Technology (NIST),
&#8220;Recommendation for Pair-Wise Key Establishment Schemes
Using Discrete Logarithm Cryptography (Revised)&#8221;, NIST PUB
800-56A, March 2007.</dd>
<dt id="term-rfc1421">[RFC1421]</dt>
<dd>Linn, J., &#8220;Privacy Enhancement for Internet Electronic
Mail: Part I: Message Encryption and Authentication
Procedures&#8221;, RFC 1421, February 1993.</dd>
<dt id="term-rfc1738">[RFC1738]</dt>
<dd>Berners-Lee, T., Masinter, L., and M. McCahill, &#8220;Uniform
Resource Locators (URL)&#8221;, RFC 1738, December 1994.</dd>
<dt id="term-rfc1952">[RFC1952]</dt>
<dd>Deutsch, P., Gailly, J-L., Adler, M., Deutsch, L., and G.
Randers-Pehrson, &#8220;GZIP file format specification version
4.3&#8221;, RFC 1952, May 1996.</dd>
<dt id="term-rfc2119">[RFC2119]</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2818">[RFC2818]</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3394">[RFC3394]</dt>
<dd>Schaad, J. and R. Housley, &#8220;Advanced Encryption Standard
(AES) Key Wrap Algorithm&#8221;, RFC 3394, September 2002.</dd>
<dt id="term-rfc3447">[RFC3447]</dt>
<dd>Jonsson, J. and B. Kaliski, &#8220;Public-Key Cryptography
Standards (PKCS) #1: RSA Cryptography Specifications
Version 2.1&#8221;, RFC 3447, February 2003.</dd>
<dt id="term-rfc3629">[RFC3629]</dt>
<dd>Yergeau, F., &#8220;UTF-8, a transformation format of ISO
10646&#8221;, STD 63, RFC 3629, November 2003.</dd>
<dt id="term-rfc3986">[RFC3986]</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-rfc4086">[RFC4086]</dt>
<dd>Eastlake, D., Schiller, J., and S. Crocker, &#8220;Randomness
Requirements for Security&#8221;, BCP 106, RFC 4086, June 2005.</dd>
<dt id="term-rfc4627">[RFC4627]</dt>
<dd>Crockford, D., &#8220;The application/json Media Type for
JavaScript Object Notation (JSON)&#8221;, RFC 4627, July 2006.</dd>
<dt id="term-rfc4648">[RFC4648]</dt>
<dd>Josefsson, S., &#8220;The Base16, Base32, and Base64 Data
Encodings&#8221;, RFC 4648, October 2006.</dd>
<dt id="term-rfc5226">[RFC5226]</dt>
<dd>Narten, T. and H. Alvestrand, &#8220;Guidelines for Writing an
IANA Considerations Section in RFCs&#8221;, BCP 26, RFC 5226,
May 2008.</dd>
<dt id="term-rfc5246">[RFC5246]</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-rfc5280">[RFC5280]</dt>
<dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
Housley, R., and W. Polk, &#8220;Internet X.509 Public Key
Infrastructure Certificate and Certificate Revocation List
(CRL) Profile&#8221;, RFC 5280, May 2008.</dd>
<dt id="term-rfc5785">[RFC5785]</dt>
<dd>Nottingham, M. and E. Hammer-Lahav, &#8220;Defining Well-Known
Uniform Resource Identifiers (URIs)&#8221;, RFC 5785,
April 2010.</dd>
<dt id="term-rfc6090">[RFC6090]</dt>
<dd>McGrew, D., Igoe, K., and M. Salter, &#8220;Fundamental Elliptic
Curve Cryptography Algorithms&#8221;, RFC 6090, February 2011.</dd>
<dt id="term-rfc6125">[RFC6125]</dt>
<dd>Saint-Andre, P. and J. Hodges, &#8220;Representation and
Verification of Domain-Based Application Service Identity
within Internet Public Key Infrastructure Using X.509
(PKIX) Certificates in the Context of Transport Layer
Security (TLS)&#8221;, RFC 6125, March 2011.</dd>
</dl>
<p id="jwe-13-2">13.2. Informative References</p>
<dl class="glossary docutils">
<dt id="term-i-d-rescorla-jsms">[I-D.rescorla-jsms]</dt>
<dd>Rescorla, E. and J. Hildebrand, &#8220;JavaScript Message
Security Format&#8221;, draft-rescorla-jsms-00 (work in
progress), March 2011.</dd>
<dt id="term-jca">[JCA]</dt>
<dd>Oracle, &#8220;Java Cryptography Architecture&#8221;, 2011.</dd>
<dt id="term-jss">[JSS]</dt>
<dd>Bradley, J. and N. Sakimura (editor), &#8220;JSON Simple Sign&#8221;,
September 2010.</dd>
<dt id="term-jwt">[JWT]</dt>
<dd>Jones, M., Balfanz, D., Bradley, J., Goland, Y., Panzer,
J., Sakimura, N., and P. Tarjan, &#8220;JSON Web Token (JWT)&#8221;,
October 2011.  (<a class="reference internal" href="jwt.html"><em>JSON Web Token(JWT)</em></a>)</dd>
<dt id="term-rfc3275">[RFC3275]</dt>
<dd>Eastlake, D., Reagle, J., and D. Solo, &#8220;(Extensible Markup
Language) XML-Signature Syntax and Processing&#8221;, RFC 3275,
March 2002.</dd>
<dt id="term-rfc5652">[RFC5652]</dt>
<dd>Housley, R., &#8220;Cryptographic Message Syntax (CMS)&#8221;, STD 70,
RFC 5652, September 2009.</dd>
<dt id="term-w3c-cr-xmlenc-core1-20110303">[W3C.CR-xmlenc-core1-20110303]</dt>
<dd>Hirsch, F., Reagle, J., Eastlake, D., and T. Roessler,
&#8220;XML Encryption Syntax and Processing Version 1.1&#8221;, World
Wide Web Consortium CR CR-xmlenc-core1-20110303,
March 2011,
&lt;<a class="reference external" href="http://www.w3.org/TR/2011/CR-xmlenc-core1-20110303">http://www.w3.org/TR/2011/CR-xmlenc-core1-20110303</a>&gt;.</dd>
<dt id="term-w3c-rec-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</dt>
<dd>Eastlake, D. and J. Reagle, &#8220;XML Encryption Syntax and
Processing&#8221;, World Wide Web Consortium Recommendation REC-
xmlenc-core-20021210, December 2002,
&lt;<a class="reference external" href="http://www.w3.org/TR/2002/REC-xmlenc-core-20021210">http://www.w3.org/TR/2002/REC-xmlenc-core-20021210</a>&gt;.</dd>
</dl>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="jwk.html">JSON Web Key (JWK)</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2011, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/660be19d7963.
    </div>
  </body>
</html>