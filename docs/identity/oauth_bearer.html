
<!DOCTYPE html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>The OAuth 2.0 Authorization Framework: Bearer Token Usage &mdash; identity 1.0 documentation</title>
    
    <link rel="stylesheet" href="static/basic.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-3.0.0/css/bootstrap-theme.min.css" type="text/css" />
    <link rel="stylesheet" href="static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="static/openid.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/js/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" src="static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="static/bootstrap-3.0.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="static/bootstrap-sphinx.js"></script>
    <link rel="top" title="identity 1.0 documentation" href="index.html" />
    <link rel="next" title="Auth 2.0 Threat Model and Security Considerations" href="oauth_threat.html" />
    <link rel="prev" title="RFC6759:The OAuth 2.0 Authorization Framework" href="oauth.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">identity</a>
        <span class="navbar-text navbar-version pull-left"><b>1.0</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            <li class="divider-vertical"></li>
            
            
              <li class="dropdown globaltoc-container">
  <a href="index.html"
     class="dropdown-toggle"
     data-toggle="dropdown">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
    ><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="oauth.html">RFC6759:The OAuth 2.0 Authorization Framework</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_threat.html">Auth 2.0 Threat Model and Security Considerations</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_revocation.html">RFC7009:Token Revocation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_jwt_bearer.html">JSON Web Token (JWT) Bearer Token Profiles for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_saml2_bearer.html">SAML 2.0 Bearer Assertion Profiles for OAuth 2.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_assertion.html">Assertion Framework for OAuth 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_mac.html">HTTP Authentication: MAC Access Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_reg.html">OAuth Dynamic Client Registration Protocol</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_introspect.html">OAuth Token Introspection</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_meta.html">JSON Metadata for OAuth Responses</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_res_reg.html">OAuth 2.0 Resource Set Registration</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth-lrdd.html">Link relation Type Registrations for OAuth 2</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_auth.html">OAuth 2.0 User Authentication and Consent For Clients</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_responses.html">OAuth 2.0 Multiple Response Type Encoding Practices - draft 11</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth_post.html">OAuth 2.0 Form Post Response Mode - draft 01</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="oauth_res.html">OAuth Resoure</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="openid_connect.html">OpenID Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">OpenID Connect Core 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="reg.html">OpenID Connect Dynamic Client Registration 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="discovery.html">OpenID Connect Discovery 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="session.html">OpenID Connect Session Management 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="napps.html">OpenID Connect Native Application Token Provisioning Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="napps_api.html">OpenID Connect Native Application Token Agent API Bindings 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="napps_core.html">OpenID Connect Native Application Token Agent Core 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="basic.html">OpenID Connect Basic Client Profile 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="implicit.html">OpenID Connect Implicit Client Implementer&#8217;s Guide 1.0 - draft 14</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="standard.html">OpenID Connect Standard 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="messages.html">OpenID Connect Messages 1.0</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="uma_core.html">User-Managed Access (UMA) Profile of OAuth 2.0 : draft09</a></li>
<li class="toctree-l1"><a class="reference internal" href="uma_trust.html">Binding Obligations on User-Managed Access (UMA) Participants</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jose.html">Terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwa.html">JSON Web Algorithms (JWA) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwt.html">JSON Web Token (JWT) : draft22</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws.html">JSON Web Signature (JWS) : draft28</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe.html">JSON Web Encryption (JWE)(draft30)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwk.html">JSON Web Key (JWK) : draft30</a></li>
<li class="toctree-l1"><a class="reference internal" href="jose_usecase.html">RFC7165:Use Cases and Requirements for JSON Object Signing and Encryption (JOSE)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="jws_hok.html">Holder-of-Key JSON Web Signature (JWS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jws_js.html">JSON Web Signature JSON Serialization (JWS-JS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="jwe_js.html">JSON Web Encryption JSON Serialization (JWE-JS)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="hostmeta.html">Web Host Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="webfinger.html">WebFinger</a></li>
<li class="toctree-l1"><a class="reference internal" href="swd.html">Simple Web Discovery (SWD)</a></li>
<li class="toctree-l1"><a class="reference internal" href="acct.html">The &#8216;acct&#8217; URI Scheme</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="rfc3394.html">RFC3394:Advanced Encryption Standard (AES) Key Wrap Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-59a.html">NIST SP 800-56A:Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography</a></li>
<li class="toctree-l1"><a class="reference internal" href="nist-sp-800-63.html">Electronic Authentication Guideline</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="backplane.html">Backplane</a></li>
<li class="toctree-l1"><a class="reference internal" href="backplane.html#backplane-2-0">Backplane 2.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="lrdd.html">LRDD: Link-based Resource Descriptor Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="revoke.html">Token Revocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="poco.html">Portable Contacts 1.0 Draft C</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Terms</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="saml.html">SAML</a></li>
<li class="toctree-l1"><a class="reference internal" href="xacml.html">XACML</a></li>
<li class="toctree-l1"><a class="reference internal" href="shibboleth.html">Shibboleth</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokProfile.html">SAML V2.0 Holder-of-Key Assertion Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="SamlHokWebSsoProfile.html">SAML V2.0 Holder-of-Key Web Browser SSO Profile Version 1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="wss_saml_token_profile.html">Web Services Security SAML Token Profile Version 1.1.1</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="scim_rest.html">Simple Cloud Identity Management: Protocol 1.0 (REST API 1.0)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="active_directory.html">Active Directory &amp; Connect</a></li>
<li class="toctree-l1"><a class="reference internal" href="todo.html">TODO/TBD</a></li>
<li class="toctree-l1"><a class="reference internal" href="resource.html">Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="discussion.html">Discussion</a></li>
<li class="toctree-l1"><a class="reference internal" href="signed_nonce.html">Decoupling Identity and Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="adtech.html">AdTech</a></li>
<li class="toctree-l1"><a class="reference internal" href="technight_9.html">Technight #9</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="well-known.html">RFC5783: Defining Well-Known Uniform Resource Identifiers (URIs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rfc5988.html">RFC5988:Web Linking</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="impl_id_token.html">ID Token:Implementation</a></li>
<li class="toctree-l1"><a class="reference internal" href="impl_jws.html">JOSE JWS:Implementation</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"><ul>
<li><a class="reference internal" href="#">The OAuth 2.0 Authorization Framework: Bearer Token Usage</a><ul>
<li><a class="reference internal" href="#abstract">Abstract</a></li>
<li><a class="reference internal" href="#introduction">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions">1.1.  Notational Conventions</a></li>
<li><a class="reference internal" href="#terminology">1.2.  Terminology</a></li>
<li><a class="reference internal" href="#overview">1.3.  Overview</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authenticated-requests">2.  Authenticated Requests</a><ul>
<li><a class="reference internal" href="#authorization-request-header-field">2.1.  Authorization Request Header Field</a></li>
<li><a class="reference internal" href="#form-encoded-body-parameter">2.2.  Form-Encoded Body Parameter</a></li>
<li><a class="reference internal" href="#uri-query-parameter">2.3.  URI Query Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-www-authenticate-response-header-field">3.  The WWW-Authenticate Response Header Field</a><ul>
<li><a class="reference internal" href="#error-codes">3.1. Error Codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-access-token-response">4.  Example Access Token Response</a></li>
<li><a class="reference internal" href="#security-considerations">5.  Security Considerations</a><ul>
<li><a class="reference internal" href="#security-threats">5.1.  Security Threats</a><ul>
<li><a class="reference internal" href="#token-manufacture-modification">Token manufacture/modification:</a></li>
<li><a class="reference internal" href="#token-disclosure">Token disclosure:</a></li>
<li><a class="reference internal" href="#token-redirect">Token redirect:</a></li>
<li><a class="reference internal" href="#token-replay">Token replay:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#threat-mitigation">5.2.  Threat Mitigation</a></li>
<li><a class="reference internal" href="#summary-of-recommendations">5.3.  Summary of Recommendations</a><ul>
<li><a class="reference internal" href="#safeguard-bearer-tokens">Safeguard bearer tokens:</a></li>
<li><a class="reference internal" href="#validate-tls-certificate-chains">Validate TLS certificate chains:</a></li>
<li><a class="reference internal" href="#always-use-tls-https">Always use TLS (https):</a></li>
<li><a class="reference internal" href="#don-t-store-bearer-tokens-in-cookies">Don&#8217;t store bearer tokens in cookies:</a></li>
<li><a class="reference internal" href="#issue-short-lived-bearer-tokens">Issue short-lived bearer tokens:</a></li>
<li><a class="reference internal" href="#issue-scoped-bearer-tokens">Issue scoped bearer tokens:</a></li>
<li><a class="reference internal" href="#don-t-pass-bearer-tokens-in-page-urls">Don&#8217;t pass bearer tokens in page URLs:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#references">6. References</a><ul>
<li><a class="reference internal" href="#normative-references">6.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references">6.2. Informative References</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li><a href="oauth.html"
         title="Previous Chapter: RFC6759:The OAuth 2.0 Authorization Framework">&laquo; RFC6759:The OAut...</a></li>
  <li><a href="oauth_threat.html"
         title="Next Chapter: Auth 2.0 Threat Model and Security Considerations">Auth 2.0 Threat ... &raquo;</a></li>
              
            
            
            
            
              <li>
<div id="sourcelink">
  <a href="sources/oauth_bearer.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12">
      
  <div class="section" id="the-oauth-2-0-authorization-framework-bearer-token-usage">
<h1>The OAuth 2.0 Authorization Framework: Bearer Token Usage<a class="headerlink" href="#the-oauth-2-0-authorization-framework-bearer-token-usage" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#abstract" id="id1">Abstract</a></li>
<li><a class="reference internal" href="#introduction" id="id2">1.  Introduction</a><ul>
<li><a class="reference internal" href="#notational-conventions" id="id3">1.1.  Notational Conventions</a></li>
<li><a class="reference internal" href="#terminology" id="id4">1.2.  Terminology</a></li>
<li><a class="reference internal" href="#overview" id="id5">1.3.  Overview</a></li>
</ul>
</li>
<li><a class="reference internal" href="#authenticated-requests" id="id6">2.  Authenticated Requests</a><ul>
<li><a class="reference internal" href="#authorization-request-header-field" id="id7">2.1.  Authorization Request Header Field</a></li>
<li><a class="reference internal" href="#form-encoded-body-parameter" id="id8">2.2.  Form-Encoded Body Parameter</a></li>
<li><a class="reference internal" href="#uri-query-parameter" id="id9">2.3.  URI Query Parameter</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-www-authenticate-response-header-field" id="id10">3.  The WWW-Authenticate Response Header Field</a><ul>
<li><a class="reference internal" href="#error-codes" id="id11">3.1. Error Codes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-access-token-response" id="id12">4.  Example Access Token Response</a></li>
<li><a class="reference internal" href="#security-considerations" id="id13">5.  Security Considerations</a><ul>
<li><a class="reference internal" href="#security-threats" id="id14">5.1.  Security Threats</a><ul>
<li><a class="reference internal" href="#token-manufacture-modification" id="id15">Token manufacture/modification:</a></li>
<li><a class="reference internal" href="#token-disclosure" id="id16">Token disclosure:</a></li>
<li><a class="reference internal" href="#token-redirect" id="id17">Token redirect:</a></li>
<li><a class="reference internal" href="#token-replay" id="id18">Token replay:</a></li>
</ul>
</li>
<li><a class="reference internal" href="#threat-mitigation" id="id19">5.2.  Threat Mitigation</a></li>
<li><a class="reference internal" href="#summary-of-recommendations" id="id20">5.3.  Summary of Recommendations</a><ul>
<li><a class="reference internal" href="#safeguard-bearer-tokens" id="id21">Safeguard bearer tokens:</a></li>
<li><a class="reference internal" href="#validate-tls-certificate-chains" id="id22">Validate TLS certificate chains:</a></li>
<li><a class="reference internal" href="#always-use-tls-https" id="id23">Always use TLS (https):</a></li>
<li><a class="reference internal" href="#don-t-store-bearer-tokens-in-cookies" id="id24">Don&#8217;t store bearer tokens in cookies:</a></li>
<li><a class="reference internal" href="#issue-short-lived-bearer-tokens" id="id25">Issue short-lived bearer tokens:</a></li>
<li><a class="reference internal" href="#issue-scoped-bearer-tokens" id="id26">Issue scoped bearer tokens:</a></li>
<li><a class="reference internal" href="#don-t-pass-bearer-tokens-in-page-urls" id="id27">Don&#8217;t pass bearer tokens in page URLs:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#references" id="id28">6. References</a><ul>
<li><a class="reference internal" href="#normative-references" id="id29">6.1. Normative References</a></li>
<li><a class="reference internal" href="#informative-references" id="id30">6.2. Informative References</a></li>
</ul>
</li>
</ul>
</div>
<p>(<span class="target" id="index-0"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6750.html"><strong>RFC 6750</strong></a> : <a class="reference external" href="http://tools.ietf.org/html/rfc6750">http://tools.ietf.org/html/rfc6750</a> )</p>
<div class="section" id="abstract">
<span id="oauth-bearer-abstract"></span><h2><a class="toc-backref" href="#id1">Abstract</a><a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>This specification describes how to use <a class="reference internal" href="#term-bearer-tokens"><em class="xref std std-term">bearer tokens</em></a>
in HTTP requests to access OAuth 2.0 <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>.
<strong>Any party in possession of a bearer token</strong> (a &#8220;bearer&#8221;) can use it
to get access to the associated resources
(without demonstrating possession of a cryptographic key).</p>
<p>To prevent misuse,
bearer tokens need to be protected from disclosure in storage and in transport.</p>
<p>(<span class="target" id="index-1"></span><a class="rfc reference external" href="http://tools.ietf.org/html/rfc6750.html"><strong>RFC 6750</strong></a> )</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>ベアラトークンを持っている人は「誰でも」それに関連づけられているリソースにアクセスできる</li>
<li>なので、ベアラトークンは部外者に漏らしてはいけません</li>
</ul>
</div>
</div>
<div class="section" id="introduction">
<span id="oauth-bearer-1"></span><h2><a class="toc-backref" href="#id2">1.  Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="glossary.html#term-oauth"><em class="xref std std-term">OAuth</em></a> enables clients
to access <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>
by obtaining an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>,
which is defined in OAuth 2.0 Authorization [I-D.ietf-oauth-v2]
as &#8220;a string representing an <em class="xref std std-term">access authorization</em> issued to the client&#8221;,
rather than using the resource owner&#8217;s credentials directly.</p>
<p>Tokens are issued to clients by
an <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a> with the approval of the <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.
The client uses the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>
to access the <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a> hosted by the <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a>.
This specification describes
how to make <em class="xref std std-term">protected resource requests</em>
when the OAuth <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> is a <a class="reference internal" href="#term-bearer-token"><em class="xref std std-term">bearer token</em></a>.</p>
<p>This specification defines the use of bearer tokens over HTTP/1.1
[I-D.ietf-httpbis-p1-messaging] using TLS [<a class="reference internal" href="#term-rfc5246"><em class="xref std std-term">RFC5246</em></a>]
to access <a class="reference internal" href="glossary.html#term-protected-resources"><em class="xref std std-term">protected resources</em></a>.
TLS is mandatory to implement and use with this specification;
other specifications may extend this specification for use with other transport protocols.
While designed for use with <a class="reference internal" href="glossary.html#term-access-tokens"><em class="xref std std-term">access tokens</em></a> resulting
from OAuth 2.0 Authorization [I-D.ietf-oauth-v2] flows
to access OAuth protected resources,
this specification actually defines a general HTTP authorization method
that can be used with bearer tokens
from any source to access any resources protected by those <a class="reference internal" href="#term-bearer-tokens"><em class="xref std std-term">bearer tokens</em></a>.</p>
<p>(draft  17)</p>
<div class="section" id="notational-conventions">
<span id="oauth-bearer-1-1"></span><h3><a class="toc-backref" href="#id3">1.1.  Notational Conventions</a><a class="headerlink" href="#notational-conventions" title="Permalink to this headline">¶</a></h3>
<p>The key words &#8216;MUST&#8217;, &#8216;MUST NOT&#8217;, &#8216;REQUIRED&#8217;, &#8216;SHALL&#8217;, &#8216;SHALL NOT&#8217;,
&#8216;SHOULD&#8217;, &#8216;SHOULD NOT&#8217;, &#8216;RECOMMENDED&#8217;, &#8216;MAY&#8217;, and &#8216;OPTIONAL&#8217; in this
document are to be interpreted as described in Key words for use in
RFCs to Indicate Requirement Levels [RFC2119].</p>
<p>This document uses the Augmented Backus-Naur Form (ABNF) notation of
HTTP/1.1, Part 1 [I-D.ietf-httpbis-p1-messaging], which is based upon
the Augmented Backus-Naur Form (ABNF) [RFC5234] notation.
Additionally, the following rules are included from HTTP/1.1, Part 7
[I-D.ietf-httpbis-p7-auth]: auth-param, auth-scheme, and b64token;
and from Uniform Resource Identifier (URI) [RFC3986]: URI-Reference.</p>
<p>Unless otherwise noted, all the protocol parameter names and values
are case sensitive.</p>
<p>(draft 17)</p>
</div>
<div class="section" id="terminology">
<span id="oauth-bearer-1-2"></span><h3><a class="toc-backref" href="#id4">1.2.  Terminology</a><a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-bearer-token"><span id="term-bearer-tokens"></span>Bearer Token<br />Bearer Tokens</dt>
<dd><p class="first">A <em class="xref std std-term">security token</em> with the property that
any party in possession of the token (a &#8220;bearer&#8221;) can use the token
in any way that any other party in possession of it can.</p>
<p class="last">Using a bearer token does not
require a bearer to prove possession of cryptographic key material
(proof-of-possession).</p>
</dd>
</dl>
<p>All other terms are as defined in &#8220;<a class="reference internal" href="oauth.html"><em>The OAuth 2.0 Authorization Framework</em></a>&#8221; <a class="reference internal" href="oauth_meta.html#term-rfc6749"><em class="xref std std-term">[RFC6749]</em></a>.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-1.2">http://tools.ietf.org/html/rfc6750#section-1.2</a> )</p>
</div>
<div class="section" id="overview">
<span id="oauth-bearer-1-3"></span><h3><a class="toc-backref" href="#id5">1.3.  Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="oauth.html"><em>OAuth</em></a> provides a method for <a class="reference internal" href="oauth.html#term-clients"><em class="xref std std-term">clients</em></a>
to access a <a class="reference internal" href="glossary.html#term-protected-resource"><em class="xref std std-term">protected resource</em></a>
on behalf of a <a class="reference internal" href="oauth.html#term-resource-owner"><em class="xref std std-term">resource owner</em></a>.</p>
<p>In the general case,
before a client can access a protected resource,
it must first obtain an <em class="xref std std-term">authorization grant</em> from the resource owner
and then exchange the authorization grant for an <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a>.</p>
<p>The access token represents the grant&#8217;s <a class="reference internal" href="messages.html#term-61"><em class="xref std std-term">scope</em></a>, <a class="reference internal" href="glossary.html#term-duration"><em class="xref std std-term">duration</em></a>,
and other attributes granted by the authorization grant.</p>
<p>The client accesses the protected resource
by presenting the access token to the <a class="reference internal" href="oauth.html#term-resource-server"><em class="xref std std-term">resource server</em></a>.</p>
<p>In some cases,
a client can directly present its own <em class="xref std std-term">credentials</em>
to an <a class="reference internal" href="oauth.html#term-authorization-server"><em class="xref std std-term">authorization server</em></a>
to obtain an access token
without having to first obtain an authorization grant from a resource owner.</p>
<p>The access token provides an abstraction,
replacing different authorization constructs
(e.g., username and password, assertion)
for a single token understood by the resource server.</p>
<p>This abstraction enables issuing access tokens valid for a short time period,
as well as removing the resource server&#8217;s need
to understand a wide range of authentication schemes.</p>
<div class="highlight-python"><pre>+--------+                               +---------------+
|        |--(A)- Authorization Request -&gt;|   Resource    |
|        |                               |     Owner     |
|        |&lt;-(B)-- Authorization Grant ---|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(C)-- Authorization Grant --&gt;| Authorization |
| Client |                               |     Server    |
|        |&lt;-(D)----- Access Token -------|               |
|        |                               +---------------+
|        |
|        |                               +---------------+
|        |--(E)----- Access Token ------&gt;|    Resource   |
|        |                               |     Server    |
|        |&lt;-(F)--- Protected Resource ---|               |
+--------+                               +---------------+

                Figure 1: Abstract Protocol Flow</pre>
</div>
<p>The abstract OAuth 2.0 flow illustrated in Figure 1 describes the
interaction between the client, resource owner, authorization server,
and resource server (described in <a class="reference internal" href="oauth_meta.html#term-rfc6749"><em class="xref std std-term">[RFC6749]</em></a>).</p>
<p>The following two steps are specified within this document:</p>
<blockquote>
<div><ol class="upperalpha simple" start="5">
<li>The client requests the protected resource from the resource
server and authenticates by presenting the access token.</li>
<li>The resource server validates the access token, and if valid,
serves the request.</li>
</ol>
</div></blockquote>
<p>This document also imposes <strong>semantic requirements</strong>
upon the access token returned in step (D).</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-1.3">http://tools.ietf.org/html/rfc6750#section-1.3</a> )</p>
</div>
</div>
<div class="section" id="authenticated-requests">
<span id="oauth-bearer-2"></span><h2><a class="toc-backref" href="#id6">2.  Authenticated Requests</a><a class="headerlink" href="#authenticated-requests" title="Permalink to this headline">¶</a></h2>
<p>This section defines three methods of sending bearer access tokens in
resource requests to resource servers.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ol class="last arabic simple">
<li><a class="reference internal" href="#oauth-bearer-2-1"><em>2.1.  Authorization Request Header Field</em></a>  (ヘッダー)</li>
<li><a class="reference internal" href="#oauth-bearer-2-2"><em>2.2.  Form-Encoded Body Parameter</em></a>  ( access_token POST )</li>
<li><a class="reference internal" href="#oauth-bearer-2-3"><em>2.3.  URI Query Parameter</em></a>  ( access_token GET  )</li>
</ol>
</div>
<p>Clients MUST NOT use more than one method to transmit the token in each request.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-2">http://tools.ietf.org/html/rfc6750#section-2</a> )</p>
<div class="section" id="authorization-request-header-field">
<span id="oauth-bearer-2-1"></span><h3><a class="toc-backref" href="#id7">2.1.  Authorization Request Header Field</a><a class="headerlink" href="#authorization-request-header-field" title="Permalink to this headline">¶</a></h3>
<p>When sending the access token in the &#8220;Authorization&#8221; request header
field defined by HTTP/1.1 <a class="reference internal" href="oauth.html#term-rfc2617"><em class="xref std std-term">[RFC2617]</em></a>,
the client uses the &#8220;<strong>Bearer</strong>&#8221; authentication scheme to transmit the access token.</p>
<p>For example:</p>
<div class="highlight-python"><pre>GET /resource HTTP/1.1
Host: server.example.com
Authorization: Bearer mF_9.B5f-4.1JqM</pre>
</div>
<p>The syntax of the &#8220;Authorization&#8221; header field for this scheme
follows the usage of the Basic scheme defined in Section 2 of
[RFC2617].</p>
<p>Note that, as with <strong>Basic</strong>,
it does not conform to the generic syntax defined in Section 1.2 of <a class="reference internal" href="oauth.html#term-rfc2617"><em class="xref std std-term">[RFC2617]</em></a>
but is compatible with the general authentication framework being developed for
HTTP 1.1 <em class="xref std std-term">[HTTP-AUTH]</em>,
although it does not follow the preferred practice outlined
therein in order to reflect existing deployments.</p>
<p>The syntax for <strong>Bearer</strong> credentials is as follows:</p>
<div class="highlight-python"><pre>b64token    = 1*( ALPHA / DIGIT /
                  "-" / "." / "_" / "~" / "+" / "/" ) *"="
credentials = "Bearer" 1*SP b64token</pre>
</div>
<p>Clients SHOULD make authenticated requests with a bearer token using
the &#8220;Authorization&#8221; request header field with the &#8220;Bearer&#8221; HTTP
authorization scheme.  Resource servers MUST support this method.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-2.1">http://tools.ietf.org/html/rfc6750#section-2.1</a> )</p>
</div>
<div class="section" id="form-encoded-body-parameter">
<span id="oauth-bearer-2-2"></span><h3><a class="toc-backref" href="#id8">2.2.  Form-Encoded Body Parameter</a><a class="headerlink" href="#form-encoded-body-parameter" title="Permalink to this headline">¶</a></h3>
<p>When sending the <a class="reference internal" href="glossary.html#term-access-token"><em class="xref std std-term">access token</em></a> in the HTTP request entity-body,
the client adds the access token to the request-body
using the &#8220;<strong>access_token</strong>&#8221; parameter.</p>
<p>The client MUST NOT use this method
unless all of the following conditions are met:</p>
<blockquote>
<div><ul>
<li><p class="first">The HTTP request entity-header includes the &#8220;Content-Type&#8221; header
field set to &#8220;application/x-www-form-urlencoded&#8221;.</p>
</li>
<li><p class="first">The entity-body follows the encoding requirements of the
&#8220;application/x-www-form-urlencoded&#8221; content-type as defined by
HTML 4.01 <a class="reference internal" href="core.html#term-w3c-rec-html401-19991224"><em class="xref std std-term">[W3C.REC-html401-19991224]</em></a>.</p>
</li>
<li><p class="first">The HTTP request <strong>entity-body</strong> is <strong>single-part</strong>.</p>
</li>
<li><p class="first">The content to be encoded in the entity-body MUST consist entirely
of ASCII <a class="reference internal" href="jwa.html#term-usascii"><em class="xref std std-term">[USASCII]</em></a> characters.</p>
</li>
<li><p class="first">The HTTP request method is one for which the <strong>request-body</strong> has
defined semantics.</p>
<p>In particular, this means that the &#8220;GET&#8221; method <strong>MUST NOT</strong> be used.</p>
</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li>POSTのみです</li>
</ul>
</div>
<p>The entity-body MAY include other request-specific parameters, in
which case the &#8220;access_token&#8221; parameter MUST be properly separated
from the request-specific parameters using &#8220;&amp;&#8221; character(s) (ASCII code 38).</p>
<p>For example, the client makes the following HTTP request using
transport-layer security:</p>
<div class="highlight-python"><pre>POST /resource HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded

access_token=mF_9.B5f-4.1JqM</pre>
</div>
<p>The &#8220;application/x-www-form-urlencoded&#8221; method SHOULD NOT be used
except in application contexts where participating browsers do not
have access to the &#8220;Authorization&#8221; request header field.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="#oauth-bearer-2-1"><em>2.1.  Authorization Request Header Field</em></a> が使えるならそっちを使う事</li>
</ul>
</div>
<p>Resource servers <strong>MAY</strong> support this method.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-2.2">http://tools.ietf.org/html/rfc6750#section-2.2</a> )</p>
</div>
<div class="section" id="uri-query-parameter">
<span id="oauth-bearer-2-3"></span><h3><a class="toc-backref" href="#id9">2.3.  URI Query Parameter</a><a class="headerlink" href="#uri-query-parameter" title="Permalink to this headline">¶</a></h3>
<p>When sending the access token in the HTTP request URI,
the client adds the access token to the request URI query component
as defined by &#8220;Uniform Resource Identifier (URI): Generic Syntax&#8221; <a class="reference internal" href="core.html#term-rfc3986"><em class="xref std std-term">[RFC3986]</em></a>,
using the &#8220;<strong>access_token</strong>&#8221; parameter.</p>
<p>For example,
the client makes the following HTTP request using transport-layer security:</p>
<div class="highlight-python"><pre>GET /resource?access_token=mF_9.B5f-4.1JqM HTTP/1.1
Host: server.example.com</pre>
</div>
<p>The HTTP request URI query can include other request-specific parameters,
in which case the &#8220;access_token&#8221; parameter MUST be
properly separated from the request-specific parameters using &#8220;&amp;&#8221;
character(s) (ASCII code 38).</p>
<p>For example:</p>
<div class="highlight-python"><pre>https://server.example.com/resource?access_token=mF_9.B5f-4.1JqM&amp;p=q</pre>
</div>
<p>Clients using the URI Query Parameter method SHOULD also send a
Cache-Control header containing the &#8220;no-store&#8221; option.  Server
success (2XX status) responses to these requests SHOULD contain a
Cache-Control header with the &#8220;private&#8221; option.</p>
<p>Because of the security weaknesses associated with the URI method
(see Section 5), including the high likelihood that the URL
containing the access token will be logged, it SHOULD NOT be used
unless it is impossible to transport the access token in the
&#8220;Authorization&#8221; request header field or the HTTP request entity-body.
Resource servers MAY support this method.</p>
<p>This method is included to document current use; its use is not
recommended, due to its security deficiencies (see Section 5) and
also because it uses a reserved query parameter name, which is
counter to URI namespace best practices, per &#8220;Architecture of the
World Wide Web, Volume One&#8221; <em class="xref std std-term">[W3C.REC-webarch-20041215]</em>.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-2.3">http://tools.ietf.org/html/rfc6750#section-2.3</a>)</p>
</div>
</div>
<div class="section" id="the-www-authenticate-response-header-field">
<span id="oauth-bearer-3"></span><h2><a class="toc-backref" href="#id10">3.  The WWW-Authenticate Response Header Field</a><a class="headerlink" href="#the-www-authenticate-response-header-field" title="Permalink to this headline">¶</a></h2>
<p>If the <em class="xref std std-term">protected resource request</em> does not include
authentication credentials or does not contain an access token
that enables access to the protected resource,
the resource server MUST include the HTTP &#8220;<em class="xref std std-term">WWW-Authenticate</em>&#8221; response header field;
it MAY include it in response to other conditions as well.
The &#8220;WWW-Authenticate&#8221; header field uses the framework defined by HTTP/1.1 <a class="reference internal" href="oauth.html#term-rfc2617"><em class="xref std std-term">[RFC2617]</em></a>.</p>
<p>All challenges defined by this specification MUST use the <strong>auth-scheme</strong> value &#8220;<strong>Bearer</strong>&#8221;.
This scheme MUST be followed by one or more <strong>auth-param</strong> values.
The auth-param attributes used or defined by this specification are as follows.
Other auth-param attributes MAY be used as well.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last">
<li><p class="first">auth-scheme : Bearer</p>
</li>
<li><p class="first">auth-param :</p>
<blockquote>
<div><ul class="simple">
<li>realm</li>
<li>scope</li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<p>A &#8220;<strong>realm</strong>&#8221; attribute MAY be included to indicate the scope of
protection in the manner described in HTTP/1.1 <a class="reference internal" href="oauth.html#term-rfc2617"><em class="xref std std-term">[RFC2617]</em></a>.
The &#8220;realm&#8221; attribute MUST NOT appear more than once.</p>
<p>The &#8220;<strong>scope</strong>&#8221; attribute is defined
in <a class="reference internal" href="oauth.html#oauth-3-3"><em>Section 3.3</em></a> of <a class="reference internal" href="oauth_meta.html#term-rfc6749"><em class="xref std std-term">[RFC6749]</em></a>.
The &#8220;scope&#8221; attribute is a <strong>space-delimited list</strong> of <strong>case-sensitive</strong> <a class="reference internal" href="messages.html#term-61"><em class="xref std std-term">scope</em></a>
values indicating the required scope of the access token for accessing the requested resource.
&#8220;scope&#8221; values are implementation defined;
there is no centralized registry for them;
allowed values are defined by the authorization server.
The order of &#8220;scope&#8221; values is not significant.
In some cases,
the &#8220;scope&#8221; value will be used when requesting a new access token
with sufficient scope of access to utilize the protected resource.
Use of the &#8220;scope&#8221; attribute is OPTIONAL.
The &#8220;scope&#8221; attribute MUST NOT appear more than once.
The &#8220;scope&#8221; value is intended for programmatic use and is not meant to be displayed to end-users.</p>
<p>Two example scope values follow;
these are taken from the OpenID Connect <a class="reference internal" href="jose_usecase.html#term-openid-messages"><em class="xref std std-term">[OpenID.Messages]</em></a>
and the Open Authentication Technology Committee (OATC) Online Multimedia Authorization Protocol <em class="xref std std-term">[OMAP]</em>
OAuth 2.0 use cases, respectively:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">scope</span><span class="o">=</span><span class="s">&quot;openid profile email&quot;</span>
<span class="n">scope</span><span class="o">=</span><span class="s">&quot;urn:example:channel=HBO&amp;urn:example:rating=G,PG-13&quot;</span>
</pre></div>
</div>
<p>If the protected resource request included an access token and failed
authentication, the resource server SHOULD include the &#8220;error&#8221;
attribute to provide the client with the reason why the access
request was declined.  The parameter value is described in
Section 3.1.  In addition, the resource server MAY include the
&#8220;error_description&#8221; attribute to provide developers a human-readable
explanation that is not meant to be displayed to end-users.  It also
MAY include the &#8220;error_uri&#8221; attribute with an absolute URI
identifying a human-readable web page explaining the error.
The &#8220;error&#8221;, &#8220;error_description&#8221;, and &#8220;error_uri&#8221; attributes MUST NOT
appear more than once.</p>
<p>Values for the &#8220;scope&#8221; attribute
(specified in <em class="xref std std-ref">Appendix A.4</em> of [RFC6749])
MUST NOT include characters outside the set %x21 / %x23-5B / %x5D-7E
for representing scope values and %x20 for delimiters
between scope values.
Values for the &#8220;error&#8221; and &#8220;error_description&#8221;
attributes
(specified in <em class="xref std std-ref">Appendixes A.7</em>
and <em class="xref std std-ref">A.8</em> of [RFC6749]) MUST
NOT include characters outside the set %x20-21 / %x23-5B / %x5D-7E.</p>
<p>Values for the &#8220;error_uri&#8221; attribute (specified in <em class="xref std std-ref">Appendix A.9</em>
of [RFC6749]) MUST conform to the URI-reference syntax and thus MUST NOT
include characters outside the set %x21 / %x23-5B / %x5D-7E.</p>
<p>For example, in response to a protected resource request without
authentication:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example"</pre>
</div>
<p>And in response to a protected resource request with an
authentication attempt using an expired access token:</p>
<div class="highlight-python"><pre>HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="example",
                  error="invalid_token",
                  error_description="The access token expired"</pre>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-3">http://tools.ietf.org/html/rfc6750#section-3</a> )</p>
<div class="section" id="error-codes">
<span id="oauth-bearer-3-1"></span><h3><a class="toc-backref" href="#id11">3.1. Error Codes</a><a class="headerlink" href="#error-codes" title="Permalink to this headline">¶</a></h3>
<p>When a request fails, the resource server responds using the
appropriate HTTP status code (typically, 400, 401, 403, or 405), and
includes one of the following error codes in the response:</p>
<dl class="glossary docutils">
<dt id="term-invalid-request">invalid_request</dt>
<dd>The request is missing a required parameter, includes an
unsupported parameter or parameter value, repeats the same
parameter, uses more than one method for including an access
token, or is otherwise malformed.  The resource server SHOULD
respond with the HTTP 400 (Bad Request) status code.</dd>
<dt id="term-invalid-token">invalid_token</dt>
<dd>The access token provided is expired, revoked, malformed, or
invalid for other reasons.  The resource SHOULD respond with
the HTTP 401 (Unauthorized) status code.  The client MAY
request a new access token and retry the protected resource
request.</dd>
<dt id="term-insufficient-scope">insufficient_scope</dt>
<dd>The request requires higher privileges than provided by the
access token.  The resource server SHOULD respond with the HTTP
403 (Forbidden) status code and MAY include the &#8220;scope&#8221;
attribute with the scope necessary to access the protected
resource.</dd>
</dl>
<p>If the request lacks any authentication information (i.e. the client
was unaware authentication is necessary or attempted using an
unsupported authentication method), the resource server SHOULD NOT
include an error code or other error information.</p>
<p>(Draft 17 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-3.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-3.1</a> )</p>
</div>
</div>
<div class="section" id="example-access-token-response">
<span id="oauth-bearer-4"></span><h2><a class="toc-backref" href="#id12">4.  Example Access Token Response</a><a class="headerlink" href="#example-access-token-response" title="Permalink to this headline">¶</a></h2>
<p>Typically, a bearer token is returned to the client as part of an
OAuth 2.0 [RFC6749] access token response.  An example of such a
response is:</p>
<dl class="docutils">
<dt>::</dt>
<dd><p class="first">HTTP/1.1 200 OK
Content-Type: application/json;charset=UTF-8
Cache-Control: no-store
Pragma: no-cache</p>
<dl class="docutils">
<dt>{</dt>
<dd>&#8220;access_token&#8221;:&#8221;mF_9.B5f-4.1JqM&#8221;,
&#8220;token_type&#8221;:&#8221;Bearer&#8221;,
&#8220;expires_in&#8221;:3600,
&#8220;refresh_token&#8221;:&#8221;tGzv3JOkF0XG5Qx2TlKWIA&#8221;</dd>
</dl>
<p class="last">}</p>
</dd>
</dl>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<ul class="last simple">
<li><a class="reference internal" href="napps_core.html#term-token-type"><em class="xref std std-term">token_type</em></a> は <em class="xref std std-ref">oauth.11.2.2</em> で <a class="reference internal" href="glossary.html#term-iana"><em class="xref std std-term">IANA</em></a> 登録されています</li>
</ul>
</div>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-4">http://tools.ietf.org/html/rfc6750#section-4</a> )</p>
</div>
<div class="section" id="security-considerations">
<span id="oauth-bearer-5"></span><h2><a class="toc-backref" href="#id13">5.  Security Considerations</a><a class="headerlink" href="#security-considerations" title="Permalink to this headline">¶</a></h2>
<p>This section describes the relevant security threats regarding
token handling
when using bearer tokens and describes how to mitigate these threats.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-5">http://tools.ietf.org/html/rfc6750#section-5</a> )</p>
<div class="section" id="security-threats">
<span id="oauth-bearer-5-1"></span><h3><a class="toc-backref" href="#id14">5.1.  Security Threats</a><a class="headerlink" href="#security-threats" title="Permalink to this headline">¶</a></h3>
<p>The following list presents several common threats against protocols
utilizing some form of tokens.  This list of threats is based on NIST
Special Publication 800-63 [NIST800-63].  Since this document builds
on the OAuth 2.0 Authorization specification [RFC6749], we exclude a
discussion of threats that are described there or in related documents.</p>
<div class="section" id="token-manufacture-modification">
<h4><a class="toc-backref" href="#id15">Token manufacture/modification:</a><a class="headerlink" href="#token-manufacture-modification" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><p>An attacker may generate a bogus token or modify the token contents
(such as the authentication or attribute statements) of an existing token,
causing the resource server to grant inappropriate access to the client.</p>
<p>For example,
an attacker may modify the token to extend the validity period; a
malicious client may modify the assertion to gain access to
information that they should not be able to view.</p>
</div></blockquote>
</div>
<div class="section" id="token-disclosure">
<h4><a class="toc-backref" href="#id16">Token disclosure:</a><a class="headerlink" href="#token-disclosure" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Tokens may contain authentication and attribute
statements that include sensitive information.</div></blockquote>
</div>
<div class="section" id="token-redirect">
<h4><a class="toc-backref" href="#id17">Token redirect:</a><a class="headerlink" href="#token-redirect" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>An attacker uses a token generated for consumption
by one resource server to gain access to a different resource
server that mistakenly believes the token to be for it.</div></blockquote>
</div>
<div class="section" id="token-replay">
<h4><a class="toc-backref" href="#id18">Token replay:</a><a class="headerlink" href="#token-replay" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>An attacker attempts to use a token that has already
been used with that resource server in the past.</div></blockquote>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-5.1">http://tools.ietf.org/html/rfc6750#section-5.1</a> )</p>
</div>
</div>
<div class="section" id="threat-mitigation">
<span id="oauth-bearer-5-2"></span><h3><a class="toc-backref" href="#id19">5.2.  Threat Mitigation</a><a class="headerlink" href="#threat-mitigation" title="Permalink to this headline">¶</a></h3>
<p>A large range of threats can be mitigated by protecting the contents
of the token by using a digital signature or a Message Authentication
Code (MAC).  Alternatively, a bearer token can contain a reference to
authorization information, rather than encoding the information
directly.  Such references MUST be infeasible for an attacker to
guess; using a reference may require an extra interaction between a
server and the token issuer to resolve the reference to the
authorization information.  The mechanics of such an interaction are
not defined by this specification.</p>
<p>This document does not specify the encoding or the contents of the
token; hence, detailed recommendations about the means of
guaranteeing token integrity protection are outside the scope of this
document.  The token integrity protection MUST be sufficient to
prevent the token from being modified.</p>
<p>To deal with token redirect, it is important for the authorization
server to include the identity of the intended recipients (the
audience), typically a single resource server (or a list of resource
servers), in the token.  Restricting the use of the token to a
specific scope is also RECOMMENDED.</p>
<p>The authorization server MUST implement TLS.  Which version(s) ought
to be implemented will vary over time and will depend on the
widespread deployment and known security vulnerabilities at the time
of implementation.  At the time of this writing, TLS version 1.2
[RFC5246] is the most recent version, but it has very limited actual
deployment and might not be readily available in implementation
toolkits.  TLS version 1.0 [RFC2246] is the most widely deployed
version and will give the broadest interoperability.</p>
<p>To protect against token disclosure, confidentiality protection MUST
be applied using TLS [RFC5246] with a ciphersuite that provides
confidentiality and integrity protection.  This requires that the
communication interaction between the client and the authorization
server, as well as the interaction between the client and the
resource server, utilize confidentiality and integrity protection.
Since TLS is mandatory to implement and to use with this
specification, it is the preferred approach for preventing token
disclosure via the communication channel.  For those cases where the
client is prevented from observing the contents of the token, token
encryption MUST be applied in addition to the usage of TLS
protection.  As a further defense against token disclosure, the
client MUST validate the TLS certificate chain when making requests
to protected resources, including checking the Certificate Revocation
List (CRL) [RFC5280].</p>
<p>Cookies are typically transmitted in the clear.  Thus, any
information contained in them is at risk of disclosure.  Therefore,
bearer tokens MUST NOT be stored in cookies that can be sent in the
clear.  See &#8220;HTTP State Management Mechanism&#8221; [RFC6265] for security
considerations about cookies.</p>
<p>In some deployments, including those utilizing load balancers, the
TLS connection to the resource server terminates prior to the actual
server that provides the resource.  This could leave the token
unprotected between the front-end server where the TLS connection
terminates and the back-end server that provides the resource.  In
such deployments, sufficient measures MUST be employed to ensure
confidentiality of the token between the front-end and back-end
servers; encryption of the token is one such possible measure.</p>
<p>To deal with token capture and replay, the following recommendations
are made: First, the lifetime of the token MUST be limited; one means
of achieving this is by putting a validity time field inside the
protected part of the token.  Note that using short-lived (one hour
or less) tokens reduces the impact of them being leaked.  Second,
confidentiality protection of the exchanges between the client and
the authorization server and between the client and the resource
server MUST be applied.  As a consequence, no eavesdropper along the
communication path is able to observe the token exchange.
Consequently, such an on-path adversary cannot replay the token.
Furthermore, when presenting the token to a resource server, the
client MUST verify the identity of that resource server, as per
Section 3.1 of &#8220;HTTP Over TLS&#8221; [RFC2818].  Note that the client MUST
validate the TLS certificate chain when making these requests to
protected resources.  Presenting the token to an unauthenticated and
unauthorized resource server or failing to validate the certificate
chain will allow adversaries to steal the token and gain unauthorized
access to protected resources.</p>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-5.2">http://tools.ietf.org/html/rfc6750#section-5.2</a> )</p>
</div>
<div class="section" id="summary-of-recommendations">
<span id="oauth-bearer-5-3"></span><h3><a class="toc-backref" href="#id20">5.3.  Summary of Recommendations</a><a class="headerlink" href="#summary-of-recommendations" title="Permalink to this headline">¶</a></h3>
<div class="section" id="safeguard-bearer-tokens">
<h4><a class="toc-backref" href="#id21">Safeguard bearer tokens:</a><a class="headerlink" href="#safeguard-bearer-tokens" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Client implementations MUST ensure that
bearer tokens are not leaked to unintended parties, as they will
be able to use them to gain access to protected resources.  This
is the primary security consideration when using bearer tokens and
underlies all the more specific recommendations that follow.</div></blockquote>
</div>
<div class="section" id="validate-tls-certificate-chains">
<h4><a class="toc-backref" href="#id22">Validate TLS certificate chains:</a><a class="headerlink" href="#validate-tls-certificate-chains" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>The client MUST validate the TLS
certificate chain when making requests to protected resources.
Failing to do so may enable DNS hijacking attacks to steal the
token and gain unintended access.</div></blockquote>
</div>
<div class="section" id="always-use-tls-https">
<h4><a class="toc-backref" href="#id23">Always use TLS (https):</a><a class="headerlink" href="#always-use-tls-https" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Clients MUST always use TLS [RFC5246]
(https) or equivalent transport security when making requests with
bearer tokens.  Failing to do so exposes the token to numerous
attacks that could give attackers unintended access.</div></blockquote>
</div>
<div class="section" id="don-t-store-bearer-tokens-in-cookies">
<h4><a class="toc-backref" href="#id24">Don&#8217;t store bearer tokens in cookies:</a><a class="headerlink" href="#don-t-store-bearer-tokens-in-cookies" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Implementations MUST NOT store
bearer tokens within cookies that can be sent in the clear (which
is the default transmission mode for cookies).  Implementations
that do store bearer tokens in cookies MUST take precautions
against cross-site request forgery.</div></blockquote>
</div>
<div class="section" id="issue-short-lived-bearer-tokens">
<h4><a class="toc-backref" href="#id25">Issue short-lived bearer tokens:</a><a class="headerlink" href="#issue-short-lived-bearer-tokens" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Token servers SHOULD issue
short-lived (one hour or less) bearer tokens, particularly when
issuing tokens to clients that run within a web browser or other
environments where information leakage may occur.  Using
short-lived bearer tokens can reduce the impact of them being
leaked.</div></blockquote>
</div>
<div class="section" id="issue-scoped-bearer-tokens">
<h4><a class="toc-backref" href="#id26">Issue scoped bearer tokens:</a><a class="headerlink" href="#issue-scoped-bearer-tokens" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Token servers SHOULD issue bearer tokens
that contain an audience restriction, scoping their use to the
intended relying party or set of relying parties.</div></blockquote>
</div>
<div class="section" id="don-t-pass-bearer-tokens-in-page-urls">
<h4><a class="toc-backref" href="#id27">Don&#8217;t pass bearer tokens in page URLs:</a><a class="headerlink" href="#don-t-pass-bearer-tokens-in-page-urls" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div>Bearer tokens SHOULD NOT be
passed in page URLs (for example, as query string parameters).
Instead, bearer tokens SHOULD be passed in HTTP message headers or
message bodies for which confidentiality measures are taken.
Browsers, web servers, and other software may not adequately
secure URLs in the browser history, web server logs, and other
data structures.  If bearer tokens are passed in page URLs,
attackers might be able to steal them from the history data, logs,
or other unsecured locations.</div></blockquote>
<p>( <a class="reference external" href="http://tools.ietf.org/html/rfc6750#section-5.3">http://tools.ietf.org/html/rfc6750#section-5.3</a> )</p>
</div>
</div>
</div>
<div class="section" id="references">
<span id="oauth-bearer-6"></span><h2><a class="toc-backref" href="#id28">6. References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>(Draft 17 <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6</a> )</p>
<div class="section" id="normative-references">
<span id="oauth-bearer-6-1"></span><h3><a class="toc-backref" href="#id29">6.1. Normative References</a><a class="headerlink" href="#normative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-i-d-ietf-httpbis-p1-messaging">I-D.ietf-httpbis-p1-messaging</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Nielsen, H.,
Masinter, L., Leach, P., Berners-Lee, T., Lafon, Y., and
J. Reschke, &#8220;HTTP/1.1, part 1: URIs, Connections, and
Message Parsing&#8221;, draft-ietf-httpbis-p1-messaging-18 (work
in progress), January 2012.</dd>
<dt id="term-i-d-ietf-httpbis-p7-auth">I-D.ietf-httpbis-p7-auth</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Nielsen, H.,
Masinter, L., Leach, P., Berners-Lee, T., Lafon, Y., and
J. Reschke, &#8220;HTTP/1.1, part 7: Authentication&#8221;,
draft-ietf-httpbis-p7-auth-18 (work in progress),
January 2012.</dd>
<dt id="term-i-d-ietf-oauth-v2">I-D.ietf-oauth-v2</dt>
<dd>Hammer, E., Recordon, D., and D. Hardt, &#8220;The OAuth 2.0
Authorization Protocol&#8221;, draft-ietf-oauth-v2-23 (work in
progress), January 2012.</dd>
<dt id="term-rfc2119">RFC2119</dt>
<dd>Bradner, S., &#8220;Key words for use in RFCs to Indicate
Requirement Levels&#8221;, BCP 14, RFC 2119, March 1997.</dd>
<dt id="term-rfc2246">RFC2246</dt>
<dd>Dierks, T. and C. Allen, &#8220;The TLS Protocol Version 1.0&#8221;,
RFC 2246, January 1999.</dd>
<dt id="term-rfc2818">RFC2818</dt>
<dd>Rescorla, E., &#8220;HTTP Over TLS&#8221;, RFC 2818, May 2000.</dd>
<dt id="term-rfc3986">RFC3986</dt>
<dd>Berners-Lee, T., Fielding, R., and L. Masinter, &#8220;Uniform
Resource Identifier (URI): Generic Syntax&#8221;, STD 66,
RFC 3986, January 2005.</dd>
<dt id="term-rfc5234">RFC5234</dt>
<dd>Crocker, D. and P. Overell, &#8220;Augmented BNF for Syntax
Specifications: ABNF&#8221;, STD 68, RFC 5234, January 2008.</dd>
<dt id="term-rfc5246">RFC5246</dt>
<dd>Dierks, T. and E. Rescorla, &#8220;The Transport Layer Security
(TLS) Protocol Version 1.2&#8221;, RFC 5246, August 2008.</dd>
<dt id="term-rfc5280">RFC5280</dt>
<dd>Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
Housley, R., and W. Polk, &#8220;Internet X.509 Public Key
Infrastructure Certificate and Certificate Revocation List
(CRL) Profile&#8221;, RFC 5280, May 2008.</dd>
<dt id="term-usascii">USASCII</dt>
<dd>American National Standards Institute, &#8220;Coded Character
Set &#8211; 7-bit American Standard Code for Information
Interchange&#8221;, ANSI X3.4, 1986.</dd>
<dt id="term-w3c-rec-html401-19991224">W3C.REC-html401-19991224</dt>
<dd>Hors, A., Raggett, D., and I. Jacobs, &#8220;HTML 4.01
Specification&#8221;, World Wide Web Consortium
Recommendation REC-html401-19991224, December 1999,
&lt;<a class="reference external" href="http://www.w3.org/TR/1999/REC-html401-19991224">http://www.w3.org/TR/1999/REC-html401-19991224</a>&gt;.</dd>
</dl>
<p>(Draft 17, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6.1">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6.1</a>)</p>
</div>
<div class="section" id="informative-references">
<span id="oauth-bearer-6-2"></span><h3><a class="toc-backref" href="#id30">6.2. Informative References</a><a class="headerlink" href="#informative-references" title="Permalink to this headline">¶</a></h3>
<dl class="glossary docutils">
<dt id="term-nist800-63">NIST800-63</dt>
<dd>Burr, W., Dodson, D., Perlner, R., Polk, T., Gupta, S.,
and E. Nabbus, &#8220;NIST Special Publication 800-63-1,
INFORMATION SECURITY&#8221;, December 2008.</dd>
<dt id="term-rfc2616">RFC2616</dt>
<dd>Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
Masinter, L., Leach, P., and T. Berners-Lee, &#8220;Hypertext
Transfer Protocol &#8211; HTTP/1.1&#8221;, RFC 2616, June 1999.</dd>
<dt id="term-rfc2617">RFC2617</dt>
<dd>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S.,
Leach, P., Luotonen, A., and L. Stewart, &#8220;HTTP
Authentication: Basic and Digest Access Authentication&#8221;,
RFC 2617, June 1999.</dd>
</dl>
<p>(Draft 17, <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6.2">http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-17#section-6.2</a> )</p>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
  <h2>HDKNR.COM</h2>
  
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2011, HDKNR.COM.<br/>
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2.<br/>
    </p>
  </div>
</footer>

  </body>
</html>