

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>django.contrib.gis.gdal.prototypes.srs &mdash; Django Cheat 1 documentation</title>
    
    <link rel="stylesheet" href="../../../../../../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../../../../static/doctools.js"></script>
    <script type="text/javascript" src="../../../../../../static/theme_extras.js"></script>
    <link rel="top" title="Django Cheat 1 documentation" href="../../../../../../index.html" />
    <link rel="up" title="Module code" href="../../../../../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../../../../../index.html">
          <span>Django Cheat 1 documentation</span></a></h1>
        <h2 class="heading"><span>django.contrib.gis.gdal.prototypes.srs</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../../../../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for django.contrib.gis.gdal.prototypes.srs</h1><div class="highlight"><pre>
<span class="kn">from</span> <span class="nn">ctypes</span> <span class="kn">import</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span>
<span class="kn">from</span> <span class="nn">django.contrib.gis.gdal.libgdal</span> <span class="kn">import</span> <span class="n">lgdal</span><span class="p">,</span> <span class="n">std_call</span>
<span class="kn">from</span> <span class="nn">django.contrib.gis.gdal.prototypes.generation</span> <span class="kn">import</span> \
    <span class="n">const_string_output</span><span class="p">,</span> <span class="n">double_output</span><span class="p">,</span> <span class="n">int_output</span><span class="p">,</span> \
    <span class="n">srs_output</span><span class="p">,</span> <span class="n">string_output</span><span class="p">,</span> <span class="n">void_output</span>

<span class="c">## Shortcut generation for routines with known parameters.</span>
<div class="viewcode-block" id="srs_double"><a class="viewcode-back" href="../../../../../../django.contrib.gis.gdal.prototypes.html#django.contrib.gis.gdal.prototypes.srs.srs_double">[docs]</a><span class="k">def</span> <span class="nf">srs_double</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a function prototype for the OSR routines that take</span>
<span class="sd">    the OSRSpatialReference object and</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">double_output</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_int</span><span class="p">)],</span> <span class="n">errcheck</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="units_func"><a class="viewcode-back" href="../../../../../../django.contrib.gis.gdal.prototypes.html#django.contrib.gis.gdal.prototypes.srs.units_func">[docs]</a><span class="k">def</span> <span class="nf">units_func</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a ctypes function prototype for OSR units functions, e.g.,</span>
<span class="sd">    OSRGetAngularUnits, OSRGetLinearUnits.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">double_output</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">)],</span> <span class="n">strarg</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c"># Creation &amp; destruction.</span></div>
<span class="n">clone_srs</span> <span class="o">=</span> <span class="n">srs_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRClone&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>
<span class="n">new_srs</span> <span class="o">=</span> <span class="n">srs_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRNewSpatialReference&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_char_p</span><span class="p">])</span>
<span class="n">release_srs</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRRelease</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">],</span> <span class="n">errcheck</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">destroy_srs</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRDestroySpatialReference&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">],</span> <span class="n">errcheck</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">srs_validate</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRValidate</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>

<span class="c"># Getting the semi_major, semi_minor, and flattening functions.</span>
<span class="n">semi_major</span> <span class="o">=</span> <span class="n">srs_double</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetSemiMajor</span><span class="p">)</span>
<span class="n">semi_minor</span> <span class="o">=</span> <span class="n">srs_double</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetSemiMinor</span><span class="p">)</span>
<span class="n">invflattening</span> <span class="o">=</span> <span class="n">srs_double</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetInvFlattening</span><span class="p">)</span>

<span class="c"># WKT, PROJ, EPSG, XML importation routines.</span>
<span class="n">from_wkt</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRImportFromWkt</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">)])</span>
<span class="n">from_proj</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRImportFromProj4</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">])</span>
<span class="n">from_epsg</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRImportFromEPSG&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">])</span>
<span class="n">from_xml</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRImportFromXML</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">])</span>
<span class="n">from_user_input</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRSetFromUserInput&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">])</span>

<span class="c"># Morphing to/from ESRI WKT.</span>
<span class="n">morph_to_esri</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRMorphToESRI</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>
<span class="n">morph_from_esri</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRMorphFromESRI</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>

<span class="c"># Identifying the EPSG</span>
<span class="n">identify_epsg</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRAutoIdentifyEPSG</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>

<span class="c"># Getting the angular_units, linear_units functions</span>
<span class="n">linear_units</span> <span class="o">=</span> <span class="n">units_func</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetLinearUnits</span><span class="p">)</span>
<span class="n">angular_units</span> <span class="o">=</span> <span class="n">units_func</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetAngularUnits</span><span class="p">)</span>

<span class="c"># For exporting to WKT, PROJ.4, &quot;Pretty&quot; WKT, and XML.</span>
<span class="n">to_wkt</span> <span class="o">=</span> <span class="n">string_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRExportToWkt&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">)])</span>
<span class="n">to_proj</span> <span class="o">=</span> <span class="n">string_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRExportToProj4&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">)])</span>
<span class="n">to_pretty_wkt</span> <span class="o">=</span> <span class="n">string_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRExportToPrettyWkt&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">),</span> <span class="n">c_int</span><span class="p">],</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># Memory leak fixed in GDAL 1.5; still exists in 1.4.</span>
<span class="n">to_xml</span> <span class="o">=</span> <span class="n">string_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRExportToXML</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">POINTER</span><span class="p">(</span><span class="n">c_char_p</span><span class="p">),</span> <span class="n">c_char_p</span><span class="p">],</span> <span class="n">offset</span><span class="o">=-</span><span class="mi">2</span><span class="p">)</span>

<span class="c"># String attribute retrival routines.</span>
<span class="n">get_attr_value</span> <span class="o">=</span> <span class="n">const_string_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OSRGetAttrValue&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">,</span> <span class="n">c_int</span><span class="p">])</span>
<span class="n">get_auth_name</span> <span class="o">=</span> <span class="n">const_string_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetAuthorityName</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">])</span>
<span class="n">get_auth_code</span> <span class="o">=</span> <span class="n">const_string_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRGetAuthorityCode</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_char_p</span><span class="p">])</span>

<span class="c"># SRS Properties</span>
<span class="n">isgeographic</span> <span class="o">=</span> <span class="n">int_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRIsGeographic</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>
<span class="n">islocal</span> <span class="o">=</span> <span class="n">int_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRIsLocal</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>
<span class="n">isprojected</span> <span class="o">=</span> <span class="n">int_output</span><span class="p">(</span><span class="n">lgdal</span><span class="o">.</span><span class="n">OSRIsProjected</span><span class="p">,</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">])</span>

<span class="c"># Coordinate transformation</span>
<span class="n">new_ct</span><span class="o">=</span> <span class="n">srs_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OCTNewCoordinateTransformation&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">,</span> <span class="n">c_void_p</span><span class="p">])</span>
<span class="n">destroy_ct</span> <span class="o">=</span> <span class="n">void_output</span><span class="p">(</span><span class="n">std_call</span><span class="p">(</span><span class="s">&#39;OCTDestroyCoordinateTransformation&#39;</span><span class="p">),</span> <span class="p">[</span><span class="n">c_void_p</span><span class="p">],</span> <span class="n">errcheck</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../../../../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>