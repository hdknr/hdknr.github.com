

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>django.utils.dateformat &mdash; Django Cheat 1 documentation</title>
    
    <link rel="stylesheet" href="../../../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../static/jquery.js"></script>
    <script type="text/javascript" src="../../../static/underscore.js"></script>
    <script type="text/javascript" src="../../../static/doctools.js"></script>
    <script type="text/javascript" src="../../../static/theme_extras.js"></script>
    <link rel="top" title="Django Cheat 1 documentation" href="../../../index.html" />
    <link rel="up" title="Module code" href="../../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../../index.html">
          <span>Django Cheat 1 documentation</span></a></h1>
        <h2 class="heading"><span>django.utils.dateformat</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for django.utils.dateformat</h1><div class="highlight"><pre>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">PHP date() style date formatting</span>
<span class="sd">See http://www.php.net/date for format strings</span>

<span class="sd">Usage:</span>
<span class="sd">&gt;&gt;&gt; import datetime</span>
<span class="sd">&gt;&gt;&gt; d = datetime.datetime.now()</span>
<span class="sd">&gt;&gt;&gt; df = DateFormat(d)</span>
<span class="sd">&gt;&gt;&gt; print df.format(&#39;jS F Y H:i&#39;)</span>
<span class="sd">7th October 2003 11:39</span>
<span class="sd">&gt;&gt;&gt;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">calendar</span>
<span class="kn">from</span> <span class="nn">django.utils.dates</span> <span class="kn">import</span> <span class="n">MONTHS</span><span class="p">,</span> <span class="n">MONTHS_3</span><span class="p">,</span> <span class="n">MONTHS_ALT</span><span class="p">,</span> <span class="n">MONTHS_AP</span><span class="p">,</span> <span class="n">WEEKDAYS</span><span class="p">,</span> <span class="n">WEEKDAYS_ABBR</span>
<span class="kn">from</span> <span class="nn">django.utils.tzinfo</span> <span class="kn">import</span> <span class="n">LocalTimezone</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">django.utils.encoding</span> <span class="kn">import</span> <span class="n">force_unicode</span>

<span class="n">re_formatchars</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;(?&lt;!</span><span class="se">\\</span><span class="s">)([aAbBcdDEfFgGhHiIjlLmMnNOPrsStTUuwWyYzZ])&#39;</span><span class="p">)</span>
<span class="n">re_escaped</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s">r&#39;</span><span class="se">\\</span><span class="s">(.)&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Formatter</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formatstr</span><span class="p">):</span>
        <span class="n">pieces</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">piece</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">re_formatchars</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">force_unicode</span><span class="p">(</span><span class="n">formatstr</span><span class="p">))):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">force_unicode</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">piece</span><span class="p">)()))</span>
            <span class="k">elif</span> <span class="n">piece</span><span class="p">:</span>
                <span class="n">pieces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">re_escaped</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\1&#39;</span><span class="p">,</span> <span class="n">piece</span><span class="p">))</span>
        <span class="k">return</span> <span class="s">u&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">pieces</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">TimeFormat</span><span class="p">(</span><span class="n">Formatter</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">t</span>

    <span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;&#39;a.m.&#39; or &#39;p.m.&#39;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;p.m.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;a.m.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">A</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;&#39;AM&#39; or &#39;PM&#39;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;</span> <span class="mi">11</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;PM&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;AM&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Swatch Internet time&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time, in 12-hour hours and minutes, with minutes left off if they&#39;re</span>
<span class="sd">        zero.</span>
<span class="sd">        Examples: &#39;1&#39;, &#39;1:30&#39;, &#39;2:05&#39;, &#39;2&#39;</span>
<span class="sd">        Proprietary extension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%s</span><span class="s">:</span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">i</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">g</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Hour, 12-hour format without leading zeros; i.e. &#39;1&#39; to &#39;12&#39;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">12</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">&gt;</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">-</span> <span class="mi">12</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span>

    <span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Hour, 24-hour format without leading zeros; i.e. &#39;0&#39; to &#39;23&#39;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span>

    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Hour, 12-hour format; i.e. &#39;01&#39; to &#39;12&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">H</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Hour, 24-hour format; i.e. &#39;00&#39; to &#39;23&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">G</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">i</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Minutes; i.e. &#39;00&#39; to &#39;59&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">minute</span>

    <span class="k">def</span> <span class="nf">P</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time, in 12-hour hours, minutes and &#39;a.m.&#39;/&#39;p.m.&#39;, with minutes left off</span>
<span class="sd">        if they&#39;re zero and the strings &#39;midnight&#39; and &#39;noon&#39; if appropriate.</span>
<span class="sd">        Examples: &#39;1 a.m.&#39;, &#39;1:30 p.m.&#39;, &#39;midnight&#39;, &#39;noon&#39;, &#39;12:30 p.m.&#39;</span>
<span class="sd">        Proprietary extension.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;midnight&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">minute</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">hour</span> <span class="o">==</span> <span class="mi">12</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_</span><span class="p">(</span><span class="s">&#39;noon&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%s</span><span class="s"> </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">s</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Seconds; i.e. &#39;00&#39; to &#39;59&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">second</span>

    <span class="k">def</span> <span class="nf">u</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Microseconds&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">microsecond</span>


<span class="k">class</span> <span class="nc">DateFormat</span><span class="p">(</span><span class="n">TimeFormat</span><span class="p">):</span>
    <span class="n">year_days</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">212</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">273</span><span class="p">,</span> <span class="mi">304</span><span class="p">,</span> <span class="mi">334</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dt</span><span class="p">):</span>
        <span class="c"># Accepts either a datetime or date object.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">dt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="s">&#39;tzinfo&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;hour&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="o">=</span> <span class="n">LocalTimezone</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month, textual, 3 letters, lowercase; e.g. &#39;jan&#39;&quot;</span>
        <span class="k">return</span> <span class="n">MONTHS_3</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ISO 8601 Format</span>
<span class="sd">        Example : &#39;2008-01-02T10:30:00.000123&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the month, 2 digits with leading zeros; i.e. &#39;01&#39; to &#39;31&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">day</span>

    <span class="k">def</span> <span class="nf">D</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the week, textual, 3 letters; e.g. &#39;Fri&#39;&quot;</span>
        <span class="k">return</span> <span class="n">WEEKDAYS_ABBR</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weekday</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">E</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Alternative month names as required by some locales. Proprietary extension.&quot;</span>
        <span class="k">return</span> <span class="n">MONTHS_ALT</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month, textual, long; e.g. &#39;January&#39;&quot;</span>
        <span class="k">return</span> <span class="n">MONTHS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">I</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;&#39;1&#39; if Daylight Savings Time, &#39;0&#39; otherwise.&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">dst</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
            <span class="k">return</span> <span class="s">u&#39;1&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;0&#39;</span>

    <span class="k">def</span> <span class="nf">j</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the month without leading zeros; i.e. &#39;1&#39; to &#39;31&#39;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">day</span>

    <span class="k">def</span> <span class="nf">l</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the week, textual, long; e.g. &#39;Friday&#39;&quot;</span>
        <span class="k">return</span> <span class="n">WEEKDAYS</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weekday</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">L</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Boolean for whether it is a leap year; i.e. True or False&quot;</span>
        <span class="k">return</span> <span class="n">calendar</span><span class="o">.</span><span class="n">isleap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">m</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month; i.e. &#39;01&#39; to &#39;12&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span>

    <span class="k">def</span> <span class="nf">M</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month, textual, 3 letters; e.g. &#39;Jan&#39;&quot;</span>
        <span class="k">return</span> <span class="n">MONTHS_3</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span><span class="o">.</span><span class="n">title</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">n</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month without leading zeros; i.e. &#39;1&#39; to &#39;12&#39;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span>

    <span class="k">def</span> <span class="nf">N</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Month abbreviation in Associated Press style. Proprietary extension.&quot;</span>
        <span class="k">return</span> <span class="n">MONTHS_AP</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">O</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Difference to Greenwich time in hours; e.g. &#39;+0200&#39;&quot;</span>
        <span class="n">seconds</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Z</span><span class="p">()</span>
        <span class="k">return</span> <span class="s">u&quot;</span><span class="si">%+03d%02d</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">3600</span><span class="p">,</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">//</span> <span class="mi">60</span><span class="p">)</span> <span class="o">%</span> <span class="mi">60</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">r</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;RFC 2822 formatted date; e.g. &#39;Thu, 21 Dec 2000 16:01:07 +0200&#39;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;D, j M Y H:i:s O&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">S</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;English ordinal suffix for the day of the month, 2 characters; i.e. &#39;st&#39;, &#39;nd&#39;, &#39;rd&#39; or &#39;th&#39;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">day</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">):</span> <span class="c"># Special case</span>
            <span class="k">return</span> <span class="s">u&#39;th&#39;</span>
        <span class="n">last</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">day</span> <span class="o">%</span> <span class="mi">10</span>
        <span class="k">if</span> <span class="n">last</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;st&#39;</span>
        <span class="k">if</span> <span class="n">last</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;nd&#39;</span>
        <span class="k">if</span> <span class="n">last</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">u&#39;rd&#39;</span>
        <span class="k">return</span> <span class="s">u&#39;th&#39;</span>

    <span class="k">def</span> <span class="nf">t</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Number of days in the given month; i.e. &#39;28&#39; to &#39;31&#39;&quot;</span>
        <span class="k">return</span> <span class="s">u&#39;</span><span class="si">%02d</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">calendar</span><span class="o">.</span><span class="n">monthrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">T</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Time zone of this machine; e.g. &#39;EST&#39; or &#39;MDT&#39;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">tzname</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">None</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s">&#39;O&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">unicode</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">U</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Seconds since the Unix epoch (January 1 1970 00:00:00 GMT)&quot;</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s">&#39;tzinfo&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">calendar</span><span class="o">.</span><span class="n">timegm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">utctimetuple</span><span class="p">()))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">mktime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()))</span>

    <span class="k">def</span> <span class="nf">w</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the week, numeric, i.e. &#39;0&#39; (Sunday) to &#39;6&#39; (Saturday)&quot;</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">7</span>

    <span class="k">def</span> <span class="nf">W</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;ISO-8601 week number of year, weeks starting on Monday&quot;</span>
        <span class="c"># Algorithm from http://www.personal.ecu.edu/mccartyr/ISOwdALG.txt</span>
        <span class="n">week_number</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="n">jan1_weekday</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">month</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">day</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">weekday</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">day_of_year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">day_of_year</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="mi">8</span> <span class="o">-</span> <span class="n">jan1_weekday</span><span class="p">)</span> <span class="ow">and</span> <span class="n">jan1_weekday</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">jan1_weekday</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">or</span> <span class="p">(</span><span class="n">jan1_weekday</span> <span class="o">==</span> <span class="mi">6</span> <span class="ow">and</span> <span class="n">calendar</span><span class="o">.</span><span class="n">isleap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
                <span class="n">week_number</span> <span class="o">=</span> <span class="mi">53</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">week_number</span> <span class="o">=</span> <span class="mi">52</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">calendar</span><span class="o">.</span><span class="n">isleap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">366</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">i</span> <span class="o">=</span> <span class="mi">365</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">day_of_year</span><span class="p">)</span> <span class="o">&lt;</span> <span class="p">(</span><span class="mi">4</span> <span class="o">-</span> <span class="n">weekday</span><span class="p">):</span>
                <span class="n">week_number</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">day_of_year</span> <span class="o">+</span> <span class="p">(</span><span class="mi">7</span> <span class="o">-</span> <span class="n">weekday</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">jan1_weekday</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">week_number</span> <span class="o">=</span> <span class="n">j</span> <span class="o">//</span> <span class="mi">7</span>
                <span class="k">if</span> <span class="n">jan1_weekday</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
                    <span class="n">week_number</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">week_number</span>

    <span class="k">def</span> <span class="nf">y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Year, 2 digits; e.g. &#39;99&#39;&quot;</span>
        <span class="k">return</span> <span class="nb">unicode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">Y</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Year, 4 digits; e.g. &#39;1999&#39;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">year</span>

    <span class="k">def</span> <span class="nf">z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&quot;Day of the year; i.e. &#39;0&#39; to &#39;365&#39;&quot;</span>
        <span class="n">doy</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">year_days</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span><span class="p">]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">day</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">L</span><span class="p">()</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">month</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">doy</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">doy</span>

    <span class="k">def</span> <span class="nf">Z</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Time zone offset in seconds (i.e. &#39;-43200&#39; to &#39;43200&#39;). The offset for</span>
<span class="sd">        timezones west of UTC is always negative, and for those east of UTC is</span>
<span class="sd">        always positive.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="n">offset</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timezone</span><span class="o">.</span><span class="n">utcoffset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="c"># Only days can be negative, so negative offsets have days=-1 and</span>
        <span class="c"># seconds positive. Positive offsets have days=0</span>
        <span class="k">return</span> <span class="n">offset</span><span class="o">.</span><span class="n">days</span> <span class="o">*</span> <span class="mi">86400</span> <span class="o">+</span> <span class="n">offset</span><span class="o">.</span><span class="n">seconds</span>

<div class="viewcode-block" id="format"><a class="viewcode-back" href="../../../django.utils.html#django.utils.dateformat.format">[docs]</a><span class="k">def</span> <span class="nf">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">format_string</span><span class="p">):</span>
    <span class="s">&quot;Convenience function&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">DateFormat</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_string</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="time_format"><a class="viewcode-back" href="../../../django.utils.html#django.utils.dateformat.time_format">[docs]</a><span class="k">def</span> <span class="nf">time_format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">format_string</span><span class="p">):</span>
    <span class="s">&quot;Convenience function&quot;</span>
    <span class="n">tf</span> <span class="o">=</span> <span class="n">TimeFormat</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">format_string</span><span class="p">)</span></div>
</pre></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/660be19d7963.
    </div>
  </body>
</html>