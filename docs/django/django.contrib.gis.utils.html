

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>django.contrib.gis.utils &mdash; Django Cheat 1 documentation</title>
    
    <link rel="stylesheet" href="static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="static/jquery.js"></script>
    <script type="text/javascript" src="static/underscore.js"></script>
    <script type="text/javascript" src="static/doctools.js"></script>
    <script type="text/javascript" src="static/theme_extras.js"></script>
    <link rel="top" title="Django Cheat 1 documentation" href="index.html" />
    <link rel="next" title="django.contrib.humanize" href="django.contrib.humanize.html" />
    <link rel="prev" title="django.contrib.gis.tests.relatedapp" href="django.contrib.gis.tests.relatedapp.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>Django Cheat 1 documentation</span></a></h1>
        <h2 class="heading"><span>django.contrib.gis.utils</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a href="/">Home</a>:
        «&#160;&#160;<a href="django.contrib.gis.tests.relatedapp.html">django.contrib.gis.tests.relatedapp</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="django.contrib.humanize.html">django.contrib.humanize</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="django-contrib-gis-utils">
<h1><a class="toc-backref" href="#id16">django.contrib.gis.utils</a><a class="headerlink" href="#django-contrib-gis-utils" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="id1">
<p class="topic-title first">django.contrib.gis.utils</p>
<ul class="simple">
<li><a class="reference internal" href="#django-contrib-gis-utils" id="id16">django.contrib.gis.utils</a><ul>
<li><a class="reference internal" href="#id2" id="id17">django.contrib.gis.utils</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-geoip" id="id18">django.contrib.gis.utils.geoip</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-layermapping" id="id19">django.contrib.gis.utils.layermapping</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-ogrinfo" id="id20">django.contrib.gis.utils.ogrinfo</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-ogrinspect" id="id21">django.contrib.gis.utils.ogrinspect</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-srs" id="id22">django.contrib.gis.utils.srs</a></li>
<li><a class="reference internal" href="#django-contrib-gis-utils-wkt" id="id23">django.contrib.gis.utils.wkt</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id2">
<span id="id3"></span><h2><a class="toc-backref" href="#id17">django.contrib.gis.utils</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/__init__.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils"></span><p>This module contains useful utilities for GeoDjango.</p>
</div>
<div class="section" id="django-contrib-gis-utils-geoip">
<span id="id4"></span><h2><a class="toc-backref" href="#id18">django.contrib.gis.utils.geoip</a><a class="headerlink" href="#django-contrib-gis-utils-geoip" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/geoip.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.geoip"></span><p>This module houses the GeoIP object, a ctypes wrapper for the MaxMind GeoIP(R)
C API (<a class="reference external" href="http://www.maxmind.com/app/c">http://www.maxmind.com/app/c</a>).  This is an alternative to the GPL
licensed Python GeoIP interface provided by MaxMind.</p>
<p>GeoIP(R) is a registered trademark of MaxMind, LLC of Boston, Massachusetts.</p>
<p>For IP-based geolocation, this module requires the GeoLite Country and City
datasets, in binary format (CSV will not work!).  The datasets may be
downloaded from MaxMind at <a class="reference external" href="http://www.maxmind.com/download/geoip/database/">http://www.maxmind.com/download/geoip/database/</a>.
Grab GeoIP.dat.gz and GeoLiteCity.dat.gz, and unzip them in the directory
corresponding to settings.GEOIP_PATH.  See the GeoIP docstring and examples
below for more details.</p>
<p>TODO: Verify compatibility with Windows.</p>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.gis.utils</span> <span class="kn">import</span> <span class="n">GeoIP</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">GeoIP</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">country</span><span class="p">(</span><span class="s">&#39;google.com&#39;</span><span class="p">)</span>
<span class="go">{&#39;country_code&#39;: &#39;US&#39;, &#39;country_name&#39;: &#39;United States&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">city</span><span class="p">(</span><span class="s">&#39;72.14.207.99&#39;</span><span class="p">)</span>
<span class="go">{&#39;area_code&#39;: 650,</span>
<span class="go">&#39;city&#39;: &#39;Mountain View&#39;,</span>
<span class="go">&#39;country_code&#39;: &#39;US&#39;,</span>
<span class="go">&#39;country_code3&#39;: &#39;USA&#39;,</span>
<span class="go">&#39;country_name&#39;: &#39;United States&#39;,</span>
<span class="go">&#39;dma_code&#39;: 807,</span>
<span class="go">&#39;latitude&#39;: 37.419200897216797,</span>
<span class="go">&#39;longitude&#39;: -122.05740356445312,</span>
<span class="go">&#39;postal_code&#39;: &#39;94043&#39;,</span>
<span class="go">&#39;region&#39;: &#39;CA&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">lat_lon</span><span class="p">(</span><span class="s">&#39;salon.com&#39;</span><span class="p">)</span>
<span class="go">(37.789798736572266, -122.39420318603516)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">lon_lat</span><span class="p">(</span><span class="s">&#39;uh.edu&#39;</span><span class="p">)</span>
<span class="go">(-95.415199279785156, 29.77549934387207)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="o">.</span><span class="n">geos</span><span class="p">(</span><span class="s">&#39;24.124.1.80&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">wkt</span>
<span class="go">&#39;POINT (-95.2087020874023438 39.0392990112304688)&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="django-contrib-gis-utils-layermapping">
<span id="id6"></span><h2><a class="toc-backref" href="#id19">django.contrib.gis.utils.layermapping</a><a class="headerlink" href="#django-contrib-gis-utils-layermapping" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/layermapping.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.layermapping"></span><p>The LayerMapping class provides a way to map the contents of OGR
vector files (e.g. SHP files) to Geographic-enabled Django models.</p>
<dl class="docutils">
<dt>For more information, please consult the GeoDjango documentation:</dt>
<dd><a class="reference external" href="http://geodjango.org/docs/layermapping.html">http://geodjango.org/docs/layermapping.html</a></dd>
</dl>
<dl class="class">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping">
<em class="property">class </em><tt class="descclassname">django.contrib.gis.utils.layermapping.</tt><tt class="descname">LayerMapping</tt><big>(</big><em>model</em>, <em>data</em>, <em>mapping</em>, <em>layer=0</em>, <em>source_srs=None</em>, <em>encoding=None</em>, <em>transaction_mode='commit_on_success'</em>, <em>transform=True</em>, <em>unique=None</em>, <em>using='default'</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping" title="Permalink to this definition">¶</a></dt>
<dd><p>A class that maps OGR Layers to GeoDjango Models.</p>
<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.check_fid_range">
<tt class="descname">check_fid_range</tt><big>(</big><em>fid_range</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.check_fid_range"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.check_fid_range" title="Permalink to this definition">¶</a></dt>
<dd><p>This checks the <cite>fid_range</cite> keyword.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.check_layer">
<tt class="descname">check_layer</tt><big>(</big><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.check_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.check_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>This checks the Layer metadata, and ensures that it is compatible
with the mapping information and model.  Unlike previous revisions,
there is no need to increment through each feature in the Layer.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.check_srs">
<tt class="descname">check_srs</tt><big>(</big><em>source_srs</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.check_srs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.check_srs" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the compatibility of the given spatial reference object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.check_unique">
<tt class="descname">check_unique</tt><big>(</big><em>unique</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.check_unique"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.check_unique" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks the <cite>unique</cite> keyword parameter &#8211; may be a sequence or string.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.coord_transform">
<tt class="descname">coord_transform</tt><big>(</big><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.coord_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.coord_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the coordinate transformation object.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.feature_kwargs">
<tt class="descname">feature_kwargs</tt><big>(</big><em>feat</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.feature_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.feature_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an OGR Feature, this will return a dictionary of keyword arguments
for constructing the mapped model.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.geometry_field">
<tt class="descname">geometry_field</tt><big>(</big><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.geometry_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.geometry_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the GeometryField instance associated with the geographic column.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.make_multi">
<tt class="descname">make_multi</tt><big>(</big><em>geom_type</em>, <em>model_field</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.make_multi"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.make_multi" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the OGRGeomType for a geometry and its associated GeometryField,
determine whether the geometry should be turned into a GeometryCollection.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.save">
<tt class="descname">save</tt><big>(</big><em>verbose=False</em>, <em>fid_range=False</em>, <em>step=False</em>, <em>progress=False</em>, <em>silent=False</em>, <em>stream=&lt;open file '&lt;stdout&gt;'</em>, <em>mode 'w' at 0x2b23cf7cf150&gt;</em>, <em>strict=False</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the contents from the OGR DataSource Layer into the database
according to the mapping dictionary given at initialization.</p>
<dl class="docutils">
<dt>Keyword Parameters:</dt>
<dd><dl class="first last docutils">
<dt>verbose:</dt>
<dd>If set, information will be printed subsequent to each model save
executed on the database.</dd>
<dt>fid_range:</dt>
<dd>May be set with a slice or tuple of (begin, end) feature ID&#8217;s to map
from the data source.  In other words, this keyword enables the user
to selectively import a subset range of features in the geographic
data source.</dd>
<dt>step:</dt>
<dd>If set with an integer, transactions will occur at every step
interval. For example, if step=1000, a commit would occur after
the 1,000th feature, the 2,000th feature etc.</dd>
<dt>progress:</dt>
<dd>When this keyword is set, status information will be printed giving
the number of features processed and sucessfully saved.  By default,
progress information will pe printed every 1000 features processed,
however, this default may be overridden by setting this keyword with an
integer for the desired interval.</dd>
<dt>stream:</dt>
<dd>Status information will be written to this file handle.  Defaults to
using <cite>sys.stdout</cite>, but any object with a <cite>write</cite> method is supported.</dd>
<dt>silent:</dt>
<dd>By default, non-fatal error notifications are printed to stdout, but
this keyword may be set to disable these notifications.</dd>
<dt>strict:</dt>
<dd>Execution of the model mapping will cease upon the first error
encountered.  The default behavior is to attempt to continue.</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.unique_kwargs">
<tt class="descname">unique_kwargs</tt><big>(</big><em>kwargs</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.unique_kwargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.unique_kwargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the feature keyword arguments (from <cite>feature_kwargs</cite>) this routine
will construct and return the uniqueness keyword arguments &#8211; a subset
of the feature kwargs.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.verify_fk">
<tt class="descname">verify_fk</tt><big>(</big><em>feat</em>, <em>rel_model</em>, <em>rel_mapping</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.verify_fk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.verify_fk" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an OGR Feature, the related model and its dictionary mapping,
this routine will retrieve the related model for the ForeignKey
mapping.</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.verify_geom">
<tt class="descname">verify_geom</tt><big>(</big><em>geom</em>, <em>model_field</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.verify_geom"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.verify_geom" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies the geometry &#8211; will construct and return a GeometryCollection
if necessary (for example if the model field is MultiPolygonField while
the mapped shapefile only contains Polygons).</p>
</dd></dl>

<dl class="method">
<dt id="django.contrib.gis.utils.layermapping.LayerMapping.verify_ogr_field">
<tt class="descname">verify_ogr_field</tt><big>(</big><em>ogr_field</em>, <em>model_field</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/layermapping.html#LayerMapping.verify_ogr_field"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.layermapping.LayerMapping.verify_ogr_field" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies if the OGR Field contents are acceptable to the Django
model field.  If they are, the verified value is returned,
otherwise the proper exception is raised.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="django-contrib-gis-utils-ogrinfo">
<span id="id8"></span><h2><a class="toc-backref" href="#id20">django.contrib.gis.utils.ogrinfo</a><a class="headerlink" href="#django-contrib-gis-utils-ogrinfo" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/ogrinfo.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.ogrinfo"></span><p>This module includes some utility functions for inspecting the layout
of a GDAL data source &#8211; the functionality is analogous to the output
produced by the <cite>ogrinfo</cite> utility.</p>
<dl class="function">
<dt id="django.contrib.gis.utils.ogrinfo.ogrinfo">
<tt class="descclassname">django.contrib.gis.utils.ogrinfo.</tt><tt class="descname">ogrinfo</tt><big>(</big><em>data_source</em>, <em>num_features=10</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/ogrinfo.html#ogrinfo"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.ogrinfo.ogrinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks the available layers in the supplied <cite>data_source</cite>, displaying
the fields for the first <cite>num_features</cite> features.</p>
</dd></dl>

<dl class="function">
<dt id="django.contrib.gis.utils.ogrinfo.sample">
<tt class="descclassname">django.contrib.gis.utils.ogrinfo.</tt><tt class="descname">sample</tt><big>(</big><em>data_source</em>, <em>num_features=10</em><big>)</big><a class="headerlink" href="#django.contrib.gis.utils.ogrinfo.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks the available layers in the supplied <cite>data_source</cite>, displaying
the fields for the first <cite>num_features</cite> features.</p>
</dd></dl>

</div>
<div class="section" id="django-contrib-gis-utils-ogrinspect">
<span id="id10"></span><h2><a class="toc-backref" href="#id21">django.contrib.gis.utils.ogrinspect</a><a class="headerlink" href="#django-contrib-gis-utils-ogrinspect" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/ogrinspect.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.ogrinspect"></span><p>This module is for inspecting OGR data sources and generating either
models for GeoDjango and/or mapping dictionaries for use with the
<cite>LayerMapping</cite> utility.</p>
<p>Author: Travis Pinney, Dane Springmeyer, &amp; Justin Bronn</p>
<dl class="function">
<dt id="django.contrib.gis.utils.ogrinspect.mapping">
<tt class="descclassname">django.contrib.gis.utils.ogrinspect.</tt><tt class="descname">mapping</tt><big>(</big><em>data_source</em>, <em>geom_name='geom'</em>, <em>layer_key=0</em>, <em>multi_geom=False</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/ogrinspect.html#mapping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.ogrinspect.mapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a DataSource, generates a dictionary that may be used
for invoking the LayerMapping utility.</p>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><p class="first"><cite>geom_name</cite> =&gt; The name of the geometry field to use for the model.</p>
<dl class="docutils">
<dt><cite>layer_key</cite> =&gt; The key for specifying which layer in the DataSource to use;</dt>
<dd>defaults to 0 (the first layer).  May be an integer index or a string
identifier for the layer.</dd>
</dl>
<p class="last"><cite>multi_geom</cite> =&gt; Boolean (default: False) - specify as multigeometry.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="django.contrib.gis.utils.ogrinspect.ogrinspect">
<tt class="descclassname">django.contrib.gis.utils.ogrinspect.</tt><tt class="descname">ogrinspect</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/ogrinspect.html#ogrinspect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.ogrinspect.ogrinspect" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a data source (either a string or a DataSource object) and a string
model name this function will generate a GeoDjango model.</p>
<p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.gis.utils</span> <span class="kn">import</span> <span class="n">ogrinspect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ogrinspect</span><span class="p">(</span><span class="s">&#39;/path/to/shapefile.shp&#39;</span><span class="p">,</span><span class="s">&#39;NewModel&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>...will print model definition to stout</p>
<p>or put this in a python script and use to redirect the output to a new
model like:</p>
<p>$ python generate_model.py &gt; myapp/models.py</p>
<p># generate_model.py
from django.contrib.gis.utils import ogrinspect
shp_file = &#8216;data/mapping_hacks/world_borders.shp&#8217;
model_name = &#8216;WorldBorders&#8217;</p>
<dl class="docutils">
<dt>print ogrinspect(shp_file, model_name, multi_geom=True, srid=4326,</dt>
<dd>geom_name=&#8217;shapes&#8217;, blank=True)</dd>
<dt>Required Arguments</dt>
<dd><p class="first"><cite>datasource</cite> =&gt; string or DataSource object to file pointer</p>
<p class="last"><cite>model name</cite> =&gt; string of name of new model class to create</p>
</dd>
<dt>Optional Keyword Arguments</dt>
<dd><dl class="first docutils">
<dt><cite>geom_name</cite> =&gt; For specifying the model name for the Geometry Field.</dt>
<dd>Otherwise will default to <cite>geom</cite></dd>
<dt><cite>layer_key</cite> =&gt; The key for specifying which layer in the DataSource to use;</dt>
<dd>defaults to 0 (the first layer).  May be an integer index or a string
identifier for the layer.</dd>
<dt><cite>srid</cite> =&gt; The SRID to use for the Geometry Field.  If it can be determined,</dt>
<dd>the SRID of the datasource is used.</dd>
</dl>
<p><cite>multi_geom</cite> =&gt; Boolean (default: False) - specify as multigeometry.</p>
<dl class="last docutils">
<dt><cite>name_field</cite> =&gt; String - specifies a field name to return for the</dt>
<dd><cite>__unicode__</cite> function (which will be generated if specified).</dd>
<dt><cite>imports</cite> =&gt; Boolean (default: True) - set to False to omit the</dt>
<dd><cite>from django.contrib.gis.db import models</cite> code from the
autogenerated models thus avoiding duplicated imports when building
more than one model by batching ogrinspect()</dd>
<dt><cite>decimal</cite> =&gt; Boolean or sequence (default: False).  When set to True</dt>
<dd>all generated model fields corresponding to the <cite>OFTReal</cite> type will
be <cite>DecimalField</cite> instead of <cite>FloatField</cite>.  A sequence of specific
field names to generate as <cite>DecimalField</cite> may also be used.</dd>
<dt><cite>blank</cite> =&gt; Boolean or sequence (default: False).  When set to True all</dt>
<dd>generated model fields will have <cite>blank=True</cite>.  If the user wants to
give specific fields to have blank, then a list/tuple of OGR field
names may be used.</dd>
<dt><cite>null</cite> =&gt; Boolean (default: False) - When set to True all generated</dt>
<dd>model fields will have <cite>null=True</cite>.  If the user wants to specify
give specific fields to have null, then a list/tuple of OGR field
names may be used.</dd>
</dl>
</dd>
</dl>
<p>Note: This routine calls the _ogrinspect() helper to do the heavy lifting.</p>
</dd></dl>

</div>
<div class="section" id="django-contrib-gis-utils-srs">
<span id="id12"></span><h2><a class="toc-backref" href="#id22">django.contrib.gis.utils.srs</a><a class="headerlink" href="#django-contrib-gis-utils-srs" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/srs.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.srs"></span><dl class="function">
<dt id="django.contrib.gis.utils.srs.add_postgis_srs">
<tt class="descclassname">django.contrib.gis.utils.srs.</tt><tt class="descname">add_postgis_srs</tt><big>(</big><em>srs</em>, <em>auth_name='EPSG'</em>, <em>auth_srid=None</em>, <em>ref_sys_name=None</em>, <em>database='default'</em><big>)</big><a class="headerlink" href="#django.contrib.gis.utils.srs.add_postgis_srs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a GDAL SpatialReference system and adds its information
to the <cite>spatial_ref_sys</cite> table of the spatial backend.  Doing this enables
database-level spatial transformations for the backend.  Thus, this utility
is useful for adding spatial reference systems not included by default with
the backend &#8211; for example, the so-called &#8220;Google Maps Mercator Projection&#8221;
is excluded in PostGIS 1.3 and below, and the following adds it to the
<cite>spatial_ref_sys</cite> table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.gis.utils</span> <span class="kn">import</span> <span class="n">add_srs_entry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_srs_entry</span><span class="p">(</span><span class="mi">900913</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>auth_name:</dt>
<dd>This keyword may be customized with the value of the <cite>auth_name</cite> field.
Defaults to &#8216;EPSG&#8217;.</dd>
<dt>auth_srid:</dt>
<dd>This keyword may be customized with the value of the <cite>auth_srid</cite> field.
Defaults to the SRID determined by GDAL.</dd>
<dt>ref_sys_name:</dt>
<dd>For SpatiaLite users only, sets the value of the the <cite>ref_sys_name</cite> field.
Defaults to the name determined by GDAL.</dd>
<dt>database:</dt>
<dd>The name of the database connection to use; the default is the value
of <cite>django.db.DEFAULT_DB_ALIAS</cite> (at the time of this writing, it&#8217;s value
is &#8216;default&#8217;).</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="django.contrib.gis.utils.srs.add_srs_entry">
<tt class="descclassname">django.contrib.gis.utils.srs.</tt><tt class="descname">add_srs_entry</tt><big>(</big><em>srs</em>, <em>auth_name='EPSG'</em>, <em>auth_srid=None</em>, <em>ref_sys_name=None</em>, <em>database='default'</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/srs.html#add_srs_entry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.srs.add_srs_entry" title="Permalink to this definition">¶</a></dt>
<dd><p>This function takes a GDAL SpatialReference system and adds its information
to the <cite>spatial_ref_sys</cite> table of the spatial backend.  Doing this enables
database-level spatial transformations for the backend.  Thus, this utility
is useful for adding spatial reference systems not included by default with
the backend &#8211; for example, the so-called &#8220;Google Maps Mercator Projection&#8221;
is excluded in PostGIS 1.3 and below, and the following adds it to the
<cite>spatial_ref_sys</cite> table:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">django.contrib.gis.utils</span> <span class="kn">import</span> <span class="n">add_srs_entry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">add_srs_entry</span><span class="p">(</span><span class="mi">900913</span><span class="p">)</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Keyword Arguments:</dt>
<dd><dl class="first last docutils">
<dt>auth_name:</dt>
<dd>This keyword may be customized with the value of the <cite>auth_name</cite> field.
Defaults to &#8216;EPSG&#8217;.</dd>
<dt>auth_srid:</dt>
<dd>This keyword may be customized with the value of the <cite>auth_srid</cite> field.
Defaults to the SRID determined by GDAL.</dd>
<dt>ref_sys_name:</dt>
<dd>For SpatiaLite users only, sets the value of the the <cite>ref_sys_name</cite> field.
Defaults to the name determined by GDAL.</dd>
<dt>database:</dt>
<dd>The name of the database connection to use; the default is the value
of <cite>django.db.DEFAULT_DB_ALIAS</cite> (at the time of this writing, it&#8217;s value
is &#8216;default&#8217;).</dd>
</dl>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="django-contrib-gis-utils-wkt">
<span id="id14"></span><h2><a class="toc-backref" href="#id23">django.contrib.gis.utils.wkt</a><a class="headerlink" href="#django-contrib-gis-utils-wkt" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="https://code.djangoproject.com/browser/django/trunk/django/contrib/gis/utils/wkt.py">source</a></li>
</ul>
<span class="target" id="module-django.contrib.gis.utils.wkt"></span><p>Utilities for manipulating Geometry WKT.</p>
<dl class="function">
<dt id="django.contrib.gis.utils.wkt.precision_wkt">
<tt class="descclassname">django.contrib.gis.utils.wkt.</tt><tt class="descname">precision_wkt</tt><big>(</big><em>geom</em>, <em>prec</em><big>)</big><a class="reference internal" href="modules/django/contrib/gis/utils/wkt.html#precision_wkt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#django.contrib.gis.utils.wkt.precision_wkt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns WKT text of the geometry according to the given precision (an 
integer or a string).  If the precision is an integer, then the decimal
places of coordinates WKT will be truncated to that number:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pnt</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">23</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pnt</span><span class="o">.</span><span class="n">wkt</span>
<span class="go">&#39;POINT (5.0000000000000000 23.0000000000000000)&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">precision</span><span class="p">(</span><span class="n">geom</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">&#39;POINT (5.0 23.0)&#39;</span>
</pre></div>
</div>
<p>If the precision is a string, it must be valid Python format string 
(e.g., &#8216;%20.7f&#8217;) &#8211; thus, you should know what you&#8217;re doing.</p>
</dd></dl>

</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a href="/">Home</a>:
        «&#160;&#160;<a href="django.contrib.gis.tests.relatedapp.html">django.contrib.gis.tests.relatedapp</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="django.contrib.humanize.html">django.contrib.humanize</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre.
    </div>
  </body>
</html>