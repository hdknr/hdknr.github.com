

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Change history &mdash; Celery 1 documentation</title>
    
    <link rel="stylesheet" href="../static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/theme_extras.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Celery 1 documentation" href="../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../index.html">
          <span>Celery 1 documentation</span></a></h1>
        <h2 class="heading"><span>Change history</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="change-history">
<span id="changelog"></span><h1>Change history<a class="headerlink" href="#change-history" title="Permalink to this headline">¶</a></h1>
<div class="section" id="version-2-3-2">
<span id="id1"></span><h2>2.3.2<a class="headerlink" href="#version-2-3-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-08-01 06:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixes problem with deserialization in Python 3.</li>
</ul>
</div>
<div class="section" id="version-2-3-1">
<span id="id2"></span><h2>2.3.1<a class="headerlink" href="#version-2-3-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-08-01 04:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">librabbitmq: Can now handle messages that does not have a
content_encoding/content_type set (Issue #149).</p>
<blockquote>
<div><p>Fix contributed by C Anthony Risinger.</p>
</div></blockquote>
</li>
<li><p class="first">Beanstalk: Now uses localhost by default if the URL does not contain a host.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-3-0">
<span id="id3"></span><h2>2.3.0<a class="headerlink" href="#version-2-3-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-07-24 03:50 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">New <tt class="docutils literal"><span class="pre">pyamqp://</span></tt> transport!</p>
<blockquote>
<div><p>The new <a class="reference external" href="http://amqp.readthedocs.org/">py-amqp</a> library is a fork of amqplib started with the
following goals:</p>
<blockquote>
<div><ul class="simple">
<li>Uses AMQP 0.9.1 instead of 0.8</li>
<li>Should support all RabbitMQ extensions</li>
<li>API compatible with <tt class="xref py py-mod docutils literal"><span class="pre">librabbitmq</span></tt> so that it can be used
as a pure-python replacement in environments where rabbitmq-c cannot
be compiled.</li>
</ul>
</div></blockquote>
<p>If you start using use py-amqp instead of amqplib you can enjoy many
advantages including:</p>
<blockquote>
<div><ul class="simple">
<li>Heartbeat support (Issue #79 + Issue #131)</li>
<li>Consumer Cancel Notifications (Issue #131)</li>
<li>Publisher Confirms</li>
</ul>
</div></blockquote>
<p>amqplib has not been updated in a long while, so maintaining our own fork
ensures that we can quickly roll out new features and fixes without
resorting to monkey patching.</p>
<p>To use the py-amqp transport you must install the <tt class="xref py py-mod docutils literal"><span class="pre">amqp</span></tt> library:</p>
<div class="highlight-python"><pre>$ pip install amqp</pre>
</div>
<p>and change the connection URL to use the correct transport:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">&#39;pyamqp://guest:guest@localhost//&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">pyamqp://</span></tt> transport will be the default fallback transport
in Kombu version 3.0, when <tt class="xref py py-mod docutils literal"><span class="pre">librabbitmq</span></tt> is not installed,
and librabbitmq will also be updated to support the same features.</p>
</div></blockquote>
</li>
<li><p class="first">Connection now supports heartbeat argument.</p>
<blockquote>
<div><p>If enabled you must make sure to manually maintain heartbeats
by calling the <tt class="docutils literal"><span class="pre">Connection.heartbeat_check</span></tt> at twice the rate
of the specified heartbeat interval.</p>
<p>E.g. if you have <tt class="docutils literal"><span class="pre">Connection(heartbeat=10)</span></tt>,
then you must call <tt class="docutils literal"><span class="pre">Connection.heartbeat_check()</span></tt> every 5 seconds.</p>
<p>if the server has not sent heartbeats at a suitable rate then
the heartbeat check method must raise an error that is listed
in <tt class="docutils literal"><span class="pre">Connection.connection_errors</span></tt>.</p>
<p>The attribute <tt class="docutils literal"><span class="pre">Connection.supports_heartbeats</span></tt> has been added
for the ability to inspect if a transport supports heartbeats
or not.</p>
<p>Calling <tt class="docutils literal"><span class="pre">heartbeat_check</span></tt> on a transport that does
not support heartbeats results in a noop operation.</p>
</div></blockquote>
</li>
<li><p class="first">SQS: Fixed bug with invalid characters in queue names.</p>
<blockquote>
<div><p>Fix contributed by Zach Smith.</p>
</div></blockquote>
</li>
<li><p class="first">utils.reprcall: Fixed typo where kwargs argument was an empty tuple by
default, and not an empty dict.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-2-6">
<span id="id4"></span><h2>2.2.6<a class="headerlink" href="#version-2-2-6" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-07-10 17:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Adds <tt class="docutils literal"><span class="pre">messaging.entry_to_queue</span></tt> for compat with previous versions.</li>
</ul>
</div>
<div class="section" id="version-2-2-5">
<span id="id5"></span><h2>2.2.5<a class="headerlink" href="#version-2-2-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-07-10 17:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Pidbox: Now sets queue expire at 10 seconds for reply queues.</p>
</li>
<li><p class="first">EventIO: Now ignores <tt class="docutils literal"><span class="pre">ValueError</span></tt> raised by epoll unregister.</p>
</li>
<li><p class="first">MongoDB: Fixes Issue #142</p>
<blockquote>
<div><p>Fix by Flavio Percoco Premoli</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-2-4">
<span id="id6"></span><h2>2.2.4<a class="headerlink" href="#version-2-2-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-07-05 16:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Support for msgpack-python 0.2.0 (Issue #143)</p>
<blockquote>
<div><p>The latest msgpack version no longer supports Python 2.5, so if you&#8217;re
still using that you need to depend on an earlier msgpack-python version.</p>
<p>Fix contributed by Sebastian Insua</p>
</div></blockquote>
</li>
<li><p class="first"><a class="reference internal" href="reference/kombu.common.html#kombu.common.maybe_declare" title="kombu.common.maybe_declare"><tt class="xref py py-func docutils literal"><span class="pre">maybe_declare()</span></tt></a> no longer caches entities with the
<tt class="docutils literal"><span class="pre">auto_delete</span></tt> flag set.</p>
</li>
<li><p class="first">New experimental filesystem transport.</p>
<blockquote>
<div><p>Contributed by Bobby Beever.</p>
</div></blockquote>
</li>
<li><p class="first">Virtual Transports: Now support anonymous queues and exchanges.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-2-3">
<span id="id7"></span><h2>2.2.3<a class="headerlink" href="#version-2-2-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-06-24 17:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">BrokerConnection</span></tt> now renamed to <tt class="docutils literal"><span class="pre">Connection</span></tt>.</p>
<blockquote>
<div><p>The name <tt class="docutils literal"><span class="pre">Connection</span></tt> has been an alias for a very long time,
but now the rename is official in the documentation as well.</p>
<p>The Connection alias has been available since version 1.1.3,
and <tt class="docutils literal"><span class="pre">BrokerConnection</span></tt> will still work and is not deprecated.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.clone()</span></tt> now works for the sqlalchemy transport.</p>
</li>
<li><p class="first"><a class="reference internal" href="reference/kombu.common.html#kombu.common.eventloop" title="kombu.common.eventloop"><tt class="xref py py-func docutils literal"><span class="pre">kombu.common.eventloop()</span></tt></a>, <a class="reference internal" href="reference/kombu.utils.html#kombu.utils.uuid" title="kombu.utils.uuid"><tt class="xref py py-func docutils literal"><span class="pre">kombu.utils.uuid()</span></tt></a>,
and <a class="reference internal" href="reference/kombu.utils.url.html#kombu.utils.url.parse_url" title="kombu.utils.url.parse_url"><tt class="xref py py-func docutils literal"><span class="pre">kombu.utils.url.parse_url()</span></tt></a> can now be
imported from the <tt class="xref py py-mod docutils literal"><span class="pre">kombu</span></tt> module directly.</p>
</li>
<li><p class="first">Pidbox transport callback <tt class="docutils literal"><span class="pre">after_reply_message_received</span></tt> now happens
in a finally block.</p>
</li>
<li><p class="first">Trying to use the <tt class="docutils literal"><span class="pre">librabbitmq://</span></tt> transport will now show the right
name in the <tt class="xref py py-exc docutils literal"><span class="pre">ImportError</span></tt> if <tt class="xref py py-mod docutils literal"><span class="pre">librabbitmq</span></tt> is not installed.</p>
<blockquote>
<div><p>The librabbitmq falls back to the older <tt class="docutils literal"><span class="pre">pylibrabbitmq</span></tt> name for
compatibility reasons and would therefore show <tt class="docutils literal"><span class="pre">No</span> <span class="pre">module</span> <span class="pre">named</span>
<span class="pre">pylibrabbitmq</span></tt> instead of librabbitmq.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-2-2">
<span id="id8"></span><h2>2.2.2<a class="headerlink" href="#version-2-2-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-06-22 02:30 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Now depends on <tt class="xref py py-mod docutils literal"><span class="pre">anyjson</span></tt> 0.3.3</p>
</li>
<li><p class="first">Json serializer: Now passes <tt class="xref py py-class docutils literal"><span class="pre">buffer</span></tt> objects directly,
since this is supported in the latest <tt class="xref py py-mod docutils literal"><span class="pre">anyjson</span></tt> version.</p>
</li>
<li><p class="first">Fixes blocking epoll call if timeout was set to 0.</p>
<blockquote>
<div><p>Fix contributed by John Watson.</p>
</div></blockquote>
</li>
<li><p class="first">setup.py now takes requirements from the <tt class="file docutils literal"><span class="pre">requirements/</span></tt> directory.</p>
</li>
<li><p class="first">The distribution directory <tt class="file docutils literal"><span class="pre">contrib/</span></tt> is now renamed to <tt class="file docutils literal"><span class="pre">extra/</span></tt></p>
</li>
</ul>
</div>
<div class="section" id="version-2-2-1">
<span id="id9"></span><h2>2.2.1<a class="headerlink" href="#version-2-2-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-06-21 01:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">SQS: Default visibility timeout is now 30 minutes.</p>
<blockquote>
<div><p>Since we have ack emulation the visibility timeout is
only in effect if the consumer is abrubtly terminated.</p>
</div></blockquote>
</li>
<li><p class="first">retry argument to <tt class="docutils literal"><span class="pre">Producer.publish</span></tt> now works properly,
when the declare argument is specified.</p>
</li>
<li><p class="first">Json serializer: didn&#8217;t handle buffer objects (Issue #135).</p>
<blockquote>
<div><p>Fix contributed by Jens Hoffrichter.</p>
</div></blockquote>
</li>
<li><p class="first">Virtual: Now supports passive argument to <tt class="docutils literal"><span class="pre">exchange_declare</span></tt>.</p>
</li>
<li><p class="first">Exchange &amp; Queue can now be bound to connections (which will use the default
channel):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">exchange</span> <span class="o">=</span> <span class="n">Exchange</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bound_exchange</span> <span class="o">=</span> <span class="n">exchange</span><span class="p">(</span><span class="n">connection</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bound_exchange</span><span class="o">.</span><span class="n">declare</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">SimpleQueue</span></tt> &amp; <tt class="docutils literal"><span class="pre">SimpleBuffer</span></tt> can now be bound to connections (which
will use the default channel).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.manager.get_bindings</span></tt> now works for librabbitmq and pika.</p>
</li>
<li><p class="first">Adds new transport info attributes:</p>
<div class="highlight-python"><pre>- ``Transport.driver_type``

    Type of underlying driver, e.g. "amqp", "redis", "sql".

- ``Transport.driver_name``

    Name of library used e.g. "amqplib", "redis", "pymongo".

- ``Transport.driver_version()``

    Version of underlying library.</pre>
</div>
</li>
</ul>
</div>
<div class="section" id="version-2-2-0">
<span id="id10"></span><h2>2.2.0<a class="headerlink" href="#version-2-2-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-06-07 3:10 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="important-notes">
<span id="v220-important"></span><h3>Important Notes<a class="headerlink" href="#important-notes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">The canonical source code repository has been moved to</p>
<blockquote>
<div><p><a class="reference external" href="http://github.com/celery/kombu">http://github.com/celery/kombu</a></p>
</div></blockquote>
</li>
<li><p class="first">Pidbox: Exchanges used by pidbox are no longer auto_delete.</p>
<blockquote>
<div><p>Auto delete has been described as a misfeature,
and therefore we have disabled it.</p>
<p>For RabbitMQ users old exchanges used by pidbox must be removed,
these are named <tt class="docutils literal"><span class="pre">mailbox_name.pidbox</span></tt>,
and <tt class="docutils literal"><span class="pre">reply.mailbox_name.pidbox</span></tt>.</p>
<p>The following command can be used to clean up these exchanges:</p>
<div class="highlight-python"><pre>VHOST=/ URL=amqp:// python -c'import sys,kombu;[kombu.Connection(
    sys.argv[-1]).channel().exchange_delete(x)
        for x in sys.argv[1:-1]]' \
    $(sudo rabbitmqctl -q list_exchanges -p "$VHOST" \
    | grep \.pidbox | awk '{print $1}') "$URL"</pre>
</div>
<p>The <span class="target" id="index-0"></span><tt class="xref std std-envvar docutils literal"><span class="pre">VHOST</span></tt> variable must be set to the target RabbitMQ virtual host,
and the <span class="target" id="index-1"></span><tt class="xref std std-envvar docutils literal"><span class="pre">URL</span></tt> must be the AMQP URL to the server.</p>
</div></blockquote>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">amqp</span></tt> transport alias will now use <tt class="xref py py-mod docutils literal"><span class="pre">librabbitmq</span></tt>
if installed.</p>
<blockquote>
<div><p><a class="reference external" href="https://github.com/celery/librabbitmq">py-librabbitmq</a> is a fast AMQP client for Python
using the librabbitmq C library.</p>
<p>It can be installed by:</p>
<div class="highlight-python"><pre>$ pip install librabbitmq</pre>
</div>
<p>It will not be used if the process is monkey patched by eventlet/gevent.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="news">
<span id="v220-news"></span><h3>News<a class="headerlink" href="#news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Redis: Ack emulation improvements.</p>
<blockquote>
<div><p>Reducing the possibility of data loss.</p>
<p>Acks are now implemented by storing a copy of the message when the message
is consumed.  The copy is not removed until the consumer acknowledges
or rejects it.</p>
<p>This means that unacknowledged messages will be redelivered either
when the connection is closed, or when the visibility timeout is exceeded.</p>
<ul>
<li><p class="first">Visibility timeout</p>
<blockquote>
<div><p>This is a timeout for acks, so that if the consumer
does not ack the message within this time limit, the message
is redelivered to another consumer.</p>
<p>The timeout is set to one hour by default, but
can be changed by configuring a transport option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Connection</span><span class="p">(</span><span class="s">&#39;redis://&#39;</span><span class="p">,</span> <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>    <span class="s">&#39;visibility_timeout&#39;</span><span class="p">:</span> <span class="mi">1800</span><span class="p">,</span>  <span class="c"># 30 minutes</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p><strong>NOTE</strong>: Messages that have not been acked will be redelivered
if the visibility timeout is exceeded, for Celery users
this means that ETA/countdown tasks that are scheduled to execute
with a time that exceeds the visibility timeout will be executed
twice (or more).  If you plan on using long ETA/countdowns you
should tweak the visibility timeout accordingly:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">BROKER_TRANSPORT_OPTIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;visibility_timeout&#39;</span><span class="p">:</span> <span class="mi">18000</span><span class="p">}</span>  <span class="c"># 5 hours</span>
</pre></div>
</div>
<p>Setting a long timeout means that it will take a long time
for messages to be redelivered in the event of a power failure,
but if so happens you could temporarily set the visibility timeout lower
to flush out messages when you start up the systems again.</p>
</div></blockquote>
</li>
<li><p class="first">Experimental <a href="#id55"><span class="problematic" id="id56">`Apache ZooKeeper`_</span></a> transport</p>
<blockquote>
<div><p>More information is in the module reference:
<tt class="xref py py-mod docutils literal"><span class="pre">kombu.transport.zookeeper</span></tt>.</p>
<p>Contributed by Mahendra M.</p>
</div></blockquote>
</li>
<li><p class="first">Redis: Priority support.</p>
<blockquote>
<div><p>The message&#8217;s <tt class="docutils literal"><span class="pre">priority</span></tt> field is now respected by the Redis
transport by having multiple lists for each named queue.
The queues are then consumed by in order of priority.</p>
<p>The priority field is a number in the range of 0 - 9, where
0 is the default and highest priority.</p>
<p>The priority range is collapsed into four steps by default, since it is
unlikely that nine steps will yield more benefit than using four steps.
The number of steps can be configured by setting the <tt class="docutils literal"><span class="pre">priority_steps</span></tt>
transport option, which must be a list of numbers in <strong>sorted order</strong>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">&#39;redis://&#39;</span><span class="p">,</span> <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>    <span class="s">&#39;priority_steps&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
<span class="gp">... </span><span class="p">})</span>
</pre></div>
</div>
<p>Priorities implemented in this way is not as reliable as
priorities on the server side, which is why
nickname the feature &#8220;quasi-priorities&#8221;;
<strong>Using routing is still the suggested way of ensuring
quality of service</strong>, as client implemented priorities
fall short in a number of ways, e.g. if the worker
is busy with long running tasks, has prefetched many messages,
or the queues are congested.</p>
<p>Still, it is possible that using priorities in combination
with routing can be more beneficial than using routing
or priorities alone.  Experimentation and monitoring
should be used to prove this.</p>
<p>Contributed by Germán M. Bravo.</p>
</div></blockquote>
</li>
<li><p class="first">Redis: Now cycles queues so that consuming is fair.</p>
<blockquote>
<div><p>This ensures that a very busy queue won&#8217;t block messages
from other queues, and ensures that all queues have
an equal chance of being consumed from.</p>
<p>This used to be the case before, but the behavior was
accidentally changed while switching to using blocking pop.</p>
</div></blockquote>
</li>
<li><p class="first">Redis: Auto delete queues that are bound to fanout exchanges
is now deleted at channel.close.</p>
</li>
<li><p class="first">amqplib: Refactored the drain_events implementation.</p>
</li>
<li><p class="first">Pidbox: Now uses <tt class="docutils literal"><span class="pre">connection.default_channel</span></tt>.</p>
</li>
<li><p class="first">Pickle serialization: Can now decode buffer objects.</p>
</li>
<li><p class="first">Exchange/Queue declarations can now be cached even if
the entity is non-durable.</p>
<blockquote>
<div><p>This is possible because the list of cached declarations
are now kept with the connection, so that the entities
will be redeclared if the connection is lost.</p>
</div></blockquote>
</li>
<li><p class="first">Kombu source code now only uses one-level of explicit relative imports.</p>
</li>
</ul>
</div>
<div class="section" id="fixes">
<span id="v220-fixes"></span><h3>Fixes<a class="headerlink" href="#fixes" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">eventio: Now ignores ENOENT raised by <tt class="docutils literal"><span class="pre">epoll.register</span></tt>, and
EEXIST from <tt class="docutils literal"><span class="pre">epoll.unregister</span></tt>.</p>
</li>
<li><p class="first">eventio: kqueue now ignores <tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt> on unregister.</p>
</li>
<li><p class="first">Redis: <tt class="docutils literal"><span class="pre">Message.reject</span></tt> now supports the <tt class="docutils literal"><span class="pre">requeue</span></tt> argument.</p>
</li>
<li><p class="first">Redis: Remove superfluous pipeline call.</p>
<blockquote>
<div><p>Fix contributed by Thomas Johansson.</p>
</div></blockquote>
</li>
<li><p class="first">Redis: Now sets redelivered header for redelivered messages.</p>
</li>
<li><p class="first">Now always makes sure references to <a class="reference external" href="http://www.python.jp/doc/release/library/sys.html#sys.exc_info" title="(in Python v2.7)"><tt class="xref py py-func docutils literal"><span class="pre">sys.exc_info()</span></tt></a> is removed.</p>
</li>
<li><p class="first">Virtual: The compression header is now removed before restoring messages.</p>
</li>
<li><p class="first">More tests for the SQLAlchemy backend.</p>
<blockquote>
<div><p>Contributed by Franck Cuny.</p>
</div></blockquote>
</li>
<li><p class="first">Url parsing did not handle MongoDB URLs properly.</p>
<blockquote>
<div><p>Fix contributed by Flavio Percoco Premoli.</p>
</div></blockquote>
</li>
<li><p class="first">Beanstalk: Ignore default tube when reserving.</p>
<blockquote>
<div><p>Fix contributed by Zhao Xiaohong.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="nonblocking-consume-support">
<h3>Nonblocking consume support<a class="headerlink" href="#nonblocking-consume-support" title="Permalink to this headline">¶</a></h3>
<p>librabbitmq, amqplib and redis transports can now be used
non-blocking.</p>
<p>The interface is very manual, and only consuming messages
is non-blocking so far.</p>
<p>The API should not be regarded as stable or final
in any way. It is used by Celery which has very limited
needs at this point. Hopefully we can introduce a proper
callback-based API later.</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">Transport.eventmap</span></tt></p>
<blockquote>
<div><p>Is a map of <tt class="docutils literal"><span class="pre">fd</span> <span class="pre">-&gt;</span> <span class="pre">callback(fileno,</span> <span class="pre">event)</span></tt>
to register in an eventloop.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Transport.on_poll_start()</span></tt></p>
<blockquote>
<div><p>Is called before every call to poll.
The poller must support <tt class="docutils literal"><span class="pre">register(fd,</span> <span class="pre">callback)</span></tt>
and <tt class="docutils literal"><span class="pre">unregister(fd)</span></tt> methods.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Transport.on_poll_start(poller)</span></tt></p>
<blockquote>
<div><p>Called when the hub is initialized.
The poller argument must support the same
interface as <tt class="xref py py-class docutils literal"><span class="pre">kombu.utils.eventio.poll</span></tt>.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.ensure_connection</span></tt> now takes a callback
argument which is called for every loop while
the connection is down.</p>
</li>
<li><p class="first">Adds <tt class="docutils literal"><span class="pre">connection.drain_nowait</span></tt></p>
<blockquote>
<div><p>This is a non-blocking alternative to drain_events,
but only supported by amqplib/librabbitmq.</p>
</div></blockquote>
</li>
<li><p class="first">drain_events now sets <tt class="docutils literal"><span class="pre">connection.more_to_read</span></tt> if
there is more data to read.</p>
<blockquote>
<div><p>This is to support eventloops where other things
must be handled between draining events.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="version-2-1-8">
<span id="id11"></span><h2>2.1.8<a class="headerlink" href="#version-2-1-8" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-05-06 3:06 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Bound Exchange/Queue&#8217;s are now pickleable.</p>
</li>
<li><p class="first">Consumer/Producer can now be instantiated without a channel,
and only later bound using <tt class="docutils literal"><span class="pre">.revive(channel)</span></tt>.</p>
</li>
<li><p class="first">ProducerPool now takes <tt class="docutils literal"><span class="pre">Producer</span></tt> argument.</p>
</li>
<li><p class="first"><a class="reference internal" href="reference/kombu.utils.html#kombu.utils.fxrange" title="kombu.utils.fxrange"><tt class="xref py py-func docutils literal"><span class="pre">fxrange()</span></tt></a> now counts forever if the
stop argument is set to None.
(fxrange is like xrange but for decimals).</p>
</li>
<li><p class="first">Auto delete support for virtual transports were incomplete
and could lead to problems so it was removed.</p>
</li>
<li><p class="first">Cached declarations (<a class="reference internal" href="reference/kombu.common.html#kombu.common.maybe_declare" title="kombu.common.maybe_declare"><tt class="xref py py-func docutils literal"><span class="pre">maybe_declare()</span></tt></a>)
are now bound to the underlying connection, so that
entities are redeclared if the connection is lost.</p>
<blockquote>
<div><p>This also means that previously uncacheable entities
(e.g. non-durable) can now be cached.</p>
</div></blockquote>
</li>
<li><p class="first">compat ConsumerSet: can now specify channel.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-1-7">
<span id="id12"></span><h2>2.1.7<a class="headerlink" href="#version-2-1-7" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-04-27 6:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>compat consumerset now accepts optional channel argument.</li>
</ul>
</div>
<div class="section" id="version-2-1-6">
<span id="id13"></span><h2>2.1.6<a class="headerlink" href="#version-2-1-6" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-04-23 1:30 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">SQLAlchemy transport was not working correctly after URL parser change.</p>
</li>
<li><p class="first">maybe_declare now stores cached declarations per underlying connection
instead of globally, in the rare case that data disappears from the
broker after connection loss.</p>
</li>
<li><p class="first">Django: Added South migrations.</p>
<blockquote>
<div><p>Contributed by Joseph Crosland.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-1-5">
<span id="id14"></span><h2>2.1.5<a class="headerlink" href="#version-2-1-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-04-13 3:30 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">The url parser removed more than the first leading slash (Issue #121).</p>
</li>
<li><p class="first">SQLAlchemy: Can now specify url using + separator</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Connection</span><span class="p">(</span><span class="s">&#39;sqla+mysql://localhost/db&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Better support for anonymous queues (Issue #116).</p>
<blockquote>
<div><p>Contributed by Michael Barrett.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.as_uri</span></tt> now quotes url parts (Issue #117).</p>
</li>
<li><p class="first">Beanstalk: Can now set message TTR as a message property.</p>
<blockquote>
<div><p>Contributed by Andrii Kostenko</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-1-4">
<span id="id15"></span><h2>2.1.4<a class="headerlink" href="#version-2-1-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-04-03 4:00 P.M GMT</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">MongoDB:  URL parsing are now delegated to the pymongo library
(Fixes Issue #103 and Issue #87).</p>
<blockquote>
<div><p>Fix contributed by Flavio Percoco Premoli and James Sullivan</p>
</div></blockquote>
</li>
<li><p class="first">SQS:  A bug caused SimpleDB to be used even if sdb persistence
was not enabled (Issue #108).</p>
<blockquote>
<div><p>Fix contributed by Anand Kumria.</p>
</div></blockquote>
</li>
<li><p class="first">Django:  Transaction was committed in the wrong place, causing
data cleanup to fail (Issue #115).</p>
<blockquote>
<div><p>Fix contributed by Daisuke Fujiwara.</p>
</div></blockquote>
</li>
<li><p class="first">MongoDB: Now supports replica set URLs.</p>
<blockquote>
<div><p>Contributed by Flavio Percoco Premoli.</p>
</div></blockquote>
</li>
<li><p class="first">Redis: Now raises a channel error if a queue key that is currently
being consumed from disappears.</p>
<blockquote>
<div><p>Fix contributed by Stephan Jaekel.</p>
</div></blockquote>
</li>
<li><p class="first">All transport &#8216;channel_errors&#8217; lists now includes
<tt class="xref py py-exc docutils literal"><span class="pre">StdChannelError</span></tt>.</p>
</li>
<li><p class="first">All kombu exceptions now inherit from a common
<tt class="xref py py-exc docutils literal"><span class="pre">KombuError</span></tt>.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-1-3">
<span id="id16"></span><h2>2.1.3<a class="headerlink" href="#version-2-1-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-03-20 3:00 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixes Jython compatibility issues.</li>
<li>Fixes Python 2.5 compatibility issues.</li>
</ul>
</div>
<div class="section" id="version-2-1-2">
<span id="id17"></span><h2>2.1.2<a class="headerlink" href="#version-2-1-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-03-01 01:00 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>amqplib: Last version broke SSL support.</li>
</ul>
</div>
<div class="section" id="version-2-1-1">
<span id="id18"></span><h2>2.1.1<a class="headerlink" href="#version-2-1-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-02-24 02:00 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Connection URLs now supports encoded characters.</p>
</li>
<li><p class="first">Fixed a case where connection pool could not recover from connection loss.</p>
<blockquote>
<div><p>Fix contributed by Florian Munz.</p>
</div></blockquote>
</li>
<li><p class="first">We now patch amqplib&#8217;s <tt class="docutils literal"><span class="pre">__del__</span></tt> method to skip trying to close the socket
if it is not connected, as this resulted in an annoying warning.</p>
</li>
<li><p class="first">Compression can now be used with binary message payloads.</p>
<blockquote>
<div><p>Fix contributed by Steeve Morin.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-2-1-0">
<span id="id19"></span><h2>2.1.0<a class="headerlink" href="#version-2-1-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-02-04 10:38 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">MongoDB: Now supports fanout (broadcast) (Issue #98).</p>
<blockquote>
<div><p>Contributed by Scott Lyons.</p>
</div></blockquote>
</li>
<li><p class="first">amqplib: Now detects broken connections by using <tt class="docutils literal"><span class="pre">MSG_PEEK</span></tt>.</p>
</li>
<li><p class="first">pylibrabbitmq: Now supports <tt class="docutils literal"><span class="pre">basic_get</span></tt> (Issue #97).</p>
</li>
<li><p class="first">gevent: Now always uses the <tt class="docutils literal"><span class="pre">select</span></tt> polling backend.</p>
</li>
<li><p class="first">pika transport: Now works with pika 0.9.5 and 0.9.6dev.</p>
<blockquote>
<div><p>The old pika transport (supporting 0.5.x) is now available
as alias <tt class="docutils literal"><span class="pre">oldpika</span></tt>.</p>
<p>(Note terribly latency has been experienced with the new pika
versions, so this is still an experimental transport).</p>
</div></blockquote>
</li>
<li><p class="first">Virtual transports: can now set polling interval via the
transport options (Issue #96).</p>
<blockquote>
<div><p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Connection</span><span class="p">(</span><span class="s">&#39;sqs://&#39;</span><span class="p">,</span> <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span>
<span class="gp">... </span>    <span class="s">&#39;polling_interval&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">})</span>
</pre></div>
</div>
<p>The default interval is transport specific, but usually
1.0s (or 5.0s for the Django database transport, which
can also be set using the <tt class="docutils literal"><span class="pre">KOMBU_POLLING_INTERVAL</span></tt> setting).</p>
</div></blockquote>
</li>
<li><p class="first">Adds convenience function: <a class="reference internal" href="reference/kombu.common.html#kombu.common.eventloop" title="kombu.common.eventloop"><tt class="xref py py-func docutils literal"><span class="pre">kombu.common.eventloop()</span></tt></a>.</p>
</li>
</ul>
</div>
<div class="section" id="version-2-0-0">
<span id="id20"></span><h2>2.0.0<a class="headerlink" href="#version-2-0-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2012-01-15 18:34 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<div class="section" id="v200-important">
<span id="id21"></span><h3>Important Notes<a class="headerlink" href="#v200-important" title="Permalink to this headline">¶</a></h3>
<div class="section" id="python-compatibility">
<span id="v200-python-compatibility"></span><h4>Python Compatibility<a class="headerlink" href="#python-compatibility" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">No longer supports Python 2.4.</p>
<blockquote>
<div><p>Users of Python 2.4 can still use the 1.x series.</p>
<p>The 1.x series has entered bugfix-only maintenance mode, and will
stay that way as long as there is demand, and a willingness to
maintain it.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="new-transports">
<span id="v200-new-transports"></span><h4>New Transports<a class="headerlink" href="#new-transports" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">django-kombu</span></tt> is now part of Kombu core.</p>
<blockquote>
<div><p>The Django message transport uses the Django ORM to store messages.</p>
<p>It uses polling, with a default polling interval of 5 seconds.
The polling interval can be increased or decreased by configuring the
<tt class="docutils literal"><span class="pre">KOMBU_POLLING_INTERVAL</span></tt> Django setting, which is the polling
interval in seconds as an int or a float.  Note that shorter polling
intervals can cause extreme strain on the database: if responsiveness
is needed you shall consider switching to a non-polling transport.</p>
<p>To use it you must use transport alias <tt class="docutils literal"><span class="pre">&quot;django&quot;</span></tt>,
or as an URL:</p>
<div class="highlight-python"><pre>django://</pre>
</div>
<p>and then add <tt class="docutils literal"><span class="pre">kombu.transport.django</span></tt> to <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt>, and
run <tt class="docutils literal"><span class="pre">manage.py</span> <span class="pre">syncdb</span></tt> to create the necessary database tables.</p>
<p><strong>Upgrading</strong></p>
<p>If you have previously used <tt class="docutils literal"><span class="pre">django-kombu</span></tt>, then the entry
in <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> must be changed from <tt class="docutils literal"><span class="pre">djkombu</span></tt>
to <tt class="docutils literal"><span class="pre">kombu.transport.django</span></tt>:</p>
<div class="highlight-python"><pre>INSTALLED_APPS = (…,
                  'kombu.transport.django')</pre>
</div>
<p>If you have previously used django-kombu, then there is no need
to recreate the tables, as the old tables will be fully compatible
with the new version.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">kombu-sqlalchemy</span></tt> is now part of Kombu core.</p>
<blockquote>
<div><p>This change requires no code changes given that the
<tt class="docutils literal"><span class="pre">sqlalchemy</span></tt> transport alias is used.</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
<div class="section" id="v200-news">
<span id="id22"></span><h3>News<a class="headerlink" href="#v200-news" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first"><a class="reference internal" href="reference/kombu.mixins.html#kombu.mixins.ConsumerMixin" title="kombu.mixins.ConsumerMixin"><tt class="xref py py-class docutils literal"><span class="pre">kombu.mixins.ConsumerMixin</span></tt></a> is a mixin class that lets you
easily write consumer programs and threads.</p>
<p>See <a class="reference internal" href="userguide/examples.html#examples"><em>Examples</em></a> and <a class="reference internal" href="userguide/consumers.html#guide-consumers"><em>Consumers</em></a>.</p>
</li>
<li><p class="first">SQS Transport: Added support for SQS queue prefixes (Issue #84).</p>
<blockquote>
<div><p>The queue prefix can be set using the transport option
<tt class="docutils literal"><span class="pre">queue_name_prefix</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">BrokerTransport</span><span class="p">(</span><span class="s">&#39;SQS://&#39;</span><span class="p">,</span> <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span>
    <span class="s">&#39;queue_name_prefix&#39;</span><span class="p">:</span> <span class="s">&#39;myapp&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>Contributed by Nitzan Miron.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Producer.publish</span></tt> now supports automatic retry.</p>
<blockquote>
<div><p>Retry is enabled by the <tt class="docutils literal"><span class="pre">reply</span></tt> argument, and retry options
set by the <tt class="docutils literal"><span class="pre">retry_policy</span></tt> argument:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">exchange</span> <span class="o">=</span> <span class="n">Exchange</span><span class="p">(</span><span class="s">&#39;foo&#39;</span><span class="p">)</span>
<span class="n">producer</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">exchange</span><span class="o">=</span><span class="n">exchange</span><span class="p">,</span> <span class="n">retry</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                 <span class="n">declare</span><span class="o">=</span><span class="p">[</span><span class="n">exchange</span><span class="p">],</span> <span class="n">retry_policy</span><span class="o">=</span><span class="p">{</span>
                    <span class="s">&#39;interval_start&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="reference/kombu.connection.html#kombu.connection.Connection.ensure" title="kombu.connection.Connection.ensure"><tt class="xref py py-meth docutils literal"><span class="pre">ensure()</span></tt></a>
for a list of supported retry policy options.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Producer.publish</span></tt> now supports a <tt class="docutils literal"><span class="pre">declare</span></tt> keyword argument.</p>
<blockquote>
<div><p>This is a list of entities (<tt class="xref py py-class docutils literal"><span class="pre">Exchange</span></tt>, or <tt class="xref py py-class docutils literal"><span class="pre">Queue</span></tt>)
that should be declared before the message is published.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="v200-fixes">
<span id="id23"></span><h3>Fixes<a class="headerlink" href="#v200-fixes" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Redis transport: Timeout was multiplied by 1000 seconds when using
<tt class="docutils literal"><span class="pre">select</span></tt> for event I/O (Issue #86).</li>
</ul>
</div>
</div>
<div class="section" id="version-1-5-1">
<span id="id24"></span><h2>1.5.1<a class="headerlink" href="#version-1-5-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-11-30 01:00 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Fixes issue with <tt class="docutils literal"><span class="pre">kombu.compat</span></tt> introduced in 1.5.0 (Issue #83).</p>
</li>
<li><p class="first">Adds the ability to disable content_types in the serializer registry.</p>
<blockquote>
<div><p>Any message with a content type that is disabled will be refused.
One example would be to disable the Pickle serializer:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kombu.serialization</span> <span class="kn">import</span> <span class="n">registry</span>
<span class="go"># by name</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">registry</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="s">&#39;pickle&#39;</span><span class="p">)</span>
<span class="go"># or by mime-type.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">registry</span><span class="o">.</span><span class="n">disable</span><span class="p">(</span><span class="s">&#39;application/x-python-serialize&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-5-0">
<span id="id25"></span><h2>1.5.0<a class="headerlink" href="#version-1-5-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-11-27 06:00 P.M GMT</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">kombu.pools: Fixed a bug resulting in resources not being properly released.</p>
<p>This was caused by the use of <tt class="docutils literal"><span class="pre">__hash__</span></tt> to distinguish them.</p>
</li>
<li><p class="first">Virtual transports: Dead-letter queue is now disabled by default.</p>
<blockquote>
<div><p>The dead-letter queue was enabled by default to help application
authors, but now that Kombu is stable it should be removed.
There are after all many cases where messages should just be dropped
when there are no queues to buffer them, and keeping them without
supporting automatic cleanup is rather considered a resource leak
than a feature.</p>
<p>If wanted the dead-letter queue can still be enabled, by using
the <tt class="docutils literal"><span class="pre">deadletter_queue</span></tt> transport option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">&#39;redis://&#39;</span><span class="p">,</span>
<span class="gp">... </span>      <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;deadletter_queue&#39;</span><span class="p">:</span> <span class="s">&#39;ae.undeliver&#39;</span><span class="p">})</span>
</pre></div>
</div>
<p>In addition, an <tt class="xref py py-class docutils literal"><span class="pre">UndeliverableWarning</span></tt> is now emitted when
the dead-letter queue is enabled and a message ends up there.</p>
<p>Contributed by Ionel Maries Cristian.</p>
</div></blockquote>
</li>
<li><p class="first">MongoDB transport now supports Replicasets (Issue #81).</p>
<blockquote>
<div><p>Contributed by Ivan Metzlar.</p>
</div></blockquote>
</li>
<li><p class="first">The <tt class="docutils literal"><span class="pre">Connection.ensure</span></tt> methods now accepts a <tt class="docutils literal"><span class="pre">max_retries</span></tt> value
of 0.</p>
<blockquote>
<div><p>A value of 0 now means <em>do not retry</em>, which is distinct from <tt class="xref py py-const docutils literal"><span class="pre">None</span></tt>
which means <em>retry indefinitely</em>.</p>
<p>Contributed by Dan McGee.</p>
</div></blockquote>
</li>
<li><p class="first">SQS Transport: Now has a lowercase <tt class="docutils literal"><span class="pre">sqs</span></tt> alias, so that it can be
used with broker URLs (Issue #82).</p>
<blockquote>
<div><p>Fix contributed by Hong Minhee</p>
</div></blockquote>
</li>
<li><p class="first">SQS Transport: Fixes KeyError on message acknowledgements (Issue #73).</p>
<blockquote>
<div><p>The SQS transport now uses UUID&#8217;s for delivery tags, rather than
a counter.</p>
<p>Fix contributed by Brian Bernstein.</p>
</div></blockquote>
</li>
<li><p class="first">SQS Transport: Unicode related fixes (Issue #82).</p>
<blockquote>
<div><p>Fix contributed by Hong Minhee.</p>
</div></blockquote>
</li>
<li><p class="first">Redis version check could crash because of improper handling of types
(Issue #63).</p>
</li>
<li><p class="first">Fixed error with <cite>Resource.force_close_all</cite> when resources
were not yet properly initialized (Issue #78).</p>
</li>
</ul>
</div>
<div class="section" id="version-1-4-3">
<span id="id26"></span><h2>1.4.3<a class="headerlink" href="#version-1-4-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-10-27 10:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixes bug in ProducerPool where too many resources would be acquired.</li>
</ul>
</div>
<div class="section" id="version-1-4-2">
<span id="id27"></span><h2>1.4.2<a class="headerlink" href="#version-1-4-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-10-26 05:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Eventio: Polling should ignore <cite>errno.EINTR</cite></p>
</li>
<li><p class="first">SQS: str.encode did only start accepting kwargs after Py2.7.</p>
</li>
<li><p class="first">simple_task_queue example didn&#8217;t run correctly (Issue #72).</p>
<blockquote>
<div><p>Fix contributed by Stefan Eletzhofer.</p>
</div></blockquote>
</li>
<li><p class="first">Empty messages would not raise an exception not able to be handled
by <cite>on_decode_error</cite> (Issue #72)</p>
<blockquote>
<div><p>Fix contributed by Christophe Chauvet.</p>
</div></blockquote>
</li>
<li><p class="first">CouchDB: Properly authenticate if user/password set (Issue #70)</p>
<blockquote>
<div><p>Fix contributed by Rafael Duran Castaneda</p>
</div></blockquote>
</li>
<li><p class="first">Connection.Consumer had the wrong signature.</p>
<blockquote>
<div><p>Fix contributed by Pavel Skvazh</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-4-1">
<span id="id28"></span><h2>1.4.1<a class="headerlink" href="#version-1-4-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-26 04:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>1.4.0 broke the producer pool, resulting in new connections being
established for every acquire.</li>
</ul>
</div>
<div class="section" id="version-1-4-0">
<span id="id29"></span><h2>1.4.0<a class="headerlink" href="#version-1-4-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-22 05:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Adds module <a class="reference internal" href="reference/kombu.mixins.html#module-kombu.mixins" title="kombu.mixins"><tt class="xref py py-mod docutils literal"><span class="pre">kombu.mixins</span></tt></a>.</p>
<blockquote>
<div><p>This module contains a <a class="reference internal" href="reference/kombu.mixins.html#kombu.mixins.ConsumerMixin" title="kombu.mixins.ConsumerMixin"><tt class="xref py py-class docutils literal"><span class="pre">ConsumerMixin</span></tt></a> class
that can be used to easily implement a message consumer
thread that consumes messages from one or more
<a class="reference internal" href="reference/kombu.messaging.html#kombu.messaging.Consumer" title="kombu.messaging.Consumer"><tt class="xref py py-class docutils literal"><span class="pre">kombu.messaging.Consumer</span></tt></a> instances.</p>
</div></blockquote>
</li>
<li><p class="first">New example: <a class="reference internal" href="userguide/examples.html#task-queue-example"><em>Task Queue Example</em></a></p>
<blockquote>
<div><p>Using the <tt class="docutils literal"><span class="pre">ConsumerMixin</span></tt>, default channels and
the global connection pool to demonstrate new Kombu features.</p>
</div></blockquote>
</li>
<li><p class="first">MongoDB transport did not work with MongoDB &gt;= 2.0 (Issue #66)</p>
<blockquote>
<div><p>Fix contributed by James Turk.</p>
</div></blockquote>
</li>
<li><p class="first">Redis-py version check did not account for beta identifiers
in version string.</p>
<blockquote>
<div><p>Fix contributed by David Ziegler.</p>
</div></blockquote>
</li>
<li><p class="first">Producer and Consumer now accepts a connection instance as the
first argument.</p>
<blockquote>
<div><p>The connections default channel will then be used.</p>
<p>In addition shortcut methods has been added to Connection:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span><span class="o">.</span><span class="n">Producer</span><span class="p">(</span><span class="n">exchange</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span><span class="o">.</span><span class="n">Consumer</span><span class="p">(</span><span class="n">queues</span><span class="o">=...</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">Connection has aquired a <tt class="docutils literal"><span class="pre">connected</span></tt> attribute that
can be used to check if the connection instance has established
a connection.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ConnectionPool.acquire_channel</span></tt> now returns the connections
default channel rather than establising a new channel that
must be manually handled.</p>
</li>
<li><p class="first">Added <tt class="docutils literal"><span class="pre">kombu.common.maybe_declare</span></tt></p>
<blockquote>
<div><p><tt class="docutils literal"><span class="pre">maybe_declare(entity)</span></tt> declares an entity if it has
not previously been declared in the same process.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="xref py py-func docutils literal"><span class="pre">kombu.compat.entry_to_queue()</span></tt> has been moved to <a class="reference internal" href="reference/kombu.common.html#module-kombu.common" title="kombu.common"><tt class="xref py py-mod docutils literal"><span class="pre">kombu.common</span></tt></a></p>
</li>
<li><p class="first">New module <a class="reference internal" href="reference/kombu.clocks.html#module-kombu.clocks" title="kombu.clocks"><tt class="xref py py-mod docutils literal"><span class="pre">kombu.clocks</span></tt></a> now contains an implementation
of Lamports logical clock.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-3-5">
<span id="id30"></span><h2>1.3.5<a class="headerlink" href="#version-1-3-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-16 06:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Python 3: AMQP_PROTOCOL_HEADER must be bytes, not str.</li>
</ul>
</div>
<div class="section" id="version-1-3-4">
<span id="id31"></span><h2>1.3.4<a class="headerlink" href="#version-1-3-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-16 06:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixes syntax error in pools.reset</li>
</ul>
</div>
<div class="section" id="version-1-3-3">
<span id="id32"></span><h2>1.3.3<a class="headerlink" href="#version-1-3-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-15 02:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Ask Solem</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>pools.reset did not support after forker arguments.</li>
</ul>
</div>
<div class="section" id="version-1-3-2">
<span id="id33"></span><h2>1.3.2<a class="headerlink" href="#version-1-3-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-09-10 01:00 P.M BST</td>
</tr>
<tr class="field-even field"><th class="field-name">by:</th><td class="field-body">Mher Movsisyan</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Broke Python 2.5 compatibility by importing <tt class="docutils literal"><span class="pre">parse_qsl</span></tt> from <tt class="docutils literal"><span class="pre">urlparse</span></tt></li>
<li>Connection.default_channel is now closed when connection is revived
after connection failures.</li>
<li>Pika: Channel now supports the <tt class="docutils literal"><span class="pre">connection.client</span></tt> attribute
as required by the simple interface.</li>
<li>pools.set_limit now raises an exception if the limit is lower
than the previous limit.</li>
<li>pools.set_limit no longer resets the pools.</li>
</ul>
</div>
<div class="section" id="version-1-3-1">
<span id="id34"></span><h2>1.3.1<a class="headerlink" href="#version-1-3-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-10-07 03:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Last release broke after fork for pool reinitialization.</p>
</li>
<li><p class="first">Producer/Consumer now has a <tt class="docutils literal"><span class="pre">connection</span></tt> attribute,
giving access to the <tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt> of the
instance.</p>
</li>
<li><p class="first">Pika: Channels now have access to the underlying
<tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt> instance using <tt class="docutils literal"><span class="pre">channel.connection.client</span></tt>.</p>
<blockquote>
<div><p>This was previously required by the <tt class="docutils literal"><span class="pre">Simple</span></tt> classes and is now
also required by <tt class="xref py py-class docutils literal"><span class="pre">Consumer</span></tt> and <tt class="xref py py-class docutils literal"><span class="pre">Producer</span></tt>.</p>
</div></blockquote>
</li>
<li><p class="first">Connection.default_channel is now closed at object revival.</p>
</li>
<li><p class="first">Adds kombu.clocks.LamportClock.</p>
</li>
<li><p class="first">compat.entry_to_queue has been moved to new module <a class="reference internal" href="reference/kombu.common.html#module-kombu.common" title="kombu.common"><tt class="xref py py-mod docutils literal"><span class="pre">kombu.common</span></tt></a>.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-3-0">
<span id="id35"></span><h2>1.3.0<a class="headerlink" href="#version-1-3-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-10-05 01:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Broker connection info can be now be specified using URLs</p>
<blockquote>
<div><p>The broker hostname can now be given as an URL instead, of the format:</p>
<div class="highlight-python"><pre>transport://user:password@hostname:port/virtual_host</pre>
</div>
<p>for example the default broker is expressed as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Connection</span><span class="p">(</span><span class="s">&#39;amqp://guest:guest@localhost:5672//&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Transport defaults to amqp, and is not required.
user, password, port and virtual_host is also not mandatory and
will default to the corresponding transports default.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Note that the path component (virtual_host) always starts with a
forward-slash.  This is necessary to distinguish between the virtual
host &#8216;&#8217; (empty) and &#8216;/&#8217;, which are both acceptable virtual host names.</p>
<p>A virtual host of &#8216;/&#8217; becomes:</p>
<blockquote>
<div><p>amqp://guest:guest&#64;localhost:5672//</p>
</div></blockquote>
<p>and a virtual host of &#8216;&#8217; (empty) becomes:</p>
<div class="highlight-python"><pre>amqp://guest:guest@localhost:5672/</pre>
</div>
<p class="last">So the leading slash in the path component is <strong>always required</strong>.</p>
</div>
</div></blockquote>
</li>
<li><p class="first">Now comes with default global connection and producer pools.</p>
<blockquote>
<div><p>The acquire a connection using the connection parameters
from a <tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kombu</span> <span class="kn">import</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">connections</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">&#39;amqp://guest:guest@localhost//&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">connections</span><span class="p">[</span><span class="n">connection</span><span class="p">]</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>    <span class="c"># do something with connection</span>
</pre></div>
</div>
<p>To acquire a producer using the connection parameters
from a <tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kombu</span> <span class="kn">import</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">producers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">connection</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="s">&#39;amqp://guest:guest@localhost//&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">producers</span><span class="p">[</span><span class="n">connection</span><span class="p">]</span><span class="o">.</span><span class="n">acquire</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">producer</span><span class="o">.</span><span class="n">publish</span><span class="p">({</span><span class="s">&#39;hello&#39;</span><span class="p">:</span> <span class="s">&#39;world&#39;</span><span class="p">},</span> <span class="n">exchange</span><span class="o">=</span><span class="s">&#39;hello&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Acquiring a producer will in turn also acquire a connection
from the associated pool in <tt class="docutils literal"><span class="pre">connections</span></tt>, so you the number
of producers is bound the same limit as number of connections.</p>
<p>The default limit of 100 connections per connection instance
can be changed by doing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kombu</span> <span class="kn">import</span> <span class="n">pools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pools</span><span class="o">.</span><span class="n">set_limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>The pool can also be forcefully closed by doing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">kombu</span> <span class="kn">import</span> <span class="n">pools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pool</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">SQS Transport: Persistence using SimpleDB is now disabled by default,
after reports of unstable SimpleDB connections leading to errors.</p>
</li>
<li><p class="first"><tt class="xref py py-class docutils literal"><span class="pre">Producer</span></tt> can now be used as a context manager.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Producer.__exit__</span></tt> now properly calls <tt class="docutils literal"><span class="pre">release</span></tt> instead of close.</p>
<blockquote>
<div><p>The previous behavior would lead to a memory leak when using
the <a class="reference internal" href="reference/kombu.pools.html#kombu.pools.ProducerPool" title="kombu.pools.ProducerPool"><tt class="xref py py-class docutils literal"><span class="pre">kombu.pools.ProducerPool</span></tt></a></p>
</div></blockquote>
</li>
<li><p class="first">Now silences all exceptions from <cite>import ctypes</cite> to match behaviour
of the standard Python uuid module, and avoid passing on MemoryError
exceptions on SELinux-enabled systems (Issue #52 + Issue #53)</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">amqp</span></tt> is now an alias to the <tt class="docutils literal"><span class="pre">amqplib</span></tt> transport.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">kombu.syn.detect_environment</span></tt> now returns &#8216;default&#8217;, &#8216;eventlet&#8217;, or
&#8216;gevent&#8217; depending on what monkey patches have been installed.</p>
</li>
<li><p class="first">Serialization registry has new attribute <tt class="docutils literal"><span class="pre">type_to_name</span></tt> so it is
possible to lookup serializater name by content type.</p>
</li>
<li><p class="first">Exchange argument to <tt class="docutils literal"><span class="pre">Producer.publish</span></tt> can now be an <tt class="xref py py-class docutils literal"><span class="pre">Exchange</span></tt>
instance.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">compat.Publisher</span></tt> now supports the <tt class="docutils literal"><span class="pre">channel</span></tt> keyword argument.</p>
</li>
<li><p class="first">Acking a message on some transports could lead to <tt class="xref py py-exc docutils literal"><span class="pre">KeyError</span></tt> being
raised (Issue #57).</p>
</li>
<li><p class="first">Connection pool:  Connections are no long instantiated when the pool is
created, but instantiated as needed instead.</p>
</li>
<li><p class="first">Tests now pass on PyPy.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.as_uri</span></tt> now includes the password if the keyword argument
<tt class="docutils literal"><span class="pre">include_password</span></tt> is set.</p>
</li>
<li><p class="first">Virtual transports now comes with a default <tt class="docutils literal"><span class="pre">default_connection_params</span></tt>
attribute.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-2-1">
<span id="id36"></span><h2>1.2.1<a class="headerlink" href="#version-1-2-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-07-29 12:52 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Now depends on amqplib &gt;= 1.0.0.</p>
</li>
<li><p class="first">Redis: Now automatically deletes auto_delete queues at <tt class="docutils literal"><span class="pre">basic_cancel</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">serialization.unregister</span></tt> added so it is possible to remove unwanted
seralizers.</p>
</li>
<li><p class="first">Fixes MemoryError while importing ctypes on SELinux (Issue #52).</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.autoretry</span></tt> is a version of <tt class="docutils literal"><span class="pre">ensure</span></tt> that works
with arbitrary functions (i.e. it does not need an associated object
that implements the <tt class="docutils literal"><span class="pre">revive</span></tt> method.</p>
<p>Example usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">channel</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">channel</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ret</span><span class="p">,</span> <span class="n">channel</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">autoretry</span><span class="p">(</span><span class="n">send_messages</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">channel</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">ConnectionPool.acquire</span></tt> no longer force establishes the connection.</p>
<blockquote>
<div><p>The connection will be established as needed.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Connection.ensure</span></tt> now supports an <tt class="docutils literal"><span class="pre">on_revive</span></tt> callback
that is applied whenever the connection is re-established.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Consumer.consuming_from(queue)</span></tt> returns True if the Consumer is
consuming from <tt class="docutils literal"><span class="pre">queue</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">Consumer.cancel_by_queue</span></tt> did not remove the queue from <tt class="docutils literal"><span class="pre">queues</span></tt>.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">compat.ConsumerSet.add_queue_from_dict</span></tt> now automatically declared
the queue if <tt class="docutils literal"><span class="pre">auto_declare</span></tt> set.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-2-0">
<span id="id37"></span><h2>1.2.0<a class="headerlink" href="#version-1-2-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-07-15 12:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Virtual: Fixes cyclic reference in Channel.close (Issue #49).</li>
<li>Producer.publish: Can now set additional properties using keyword
arguments (Issue #48).</li>
<li>Adds Queue.no_ack option to control the no_ack option for individual queues.</li>
<li>Recent versions broke pylibrabbitmq support.</li>
<li>SimpleQueue and SimpleBuffer can now be used as contexts.</li>
<li>Test requirements specifies PyYAML==3.09 as 3.10 dropped Python 2.4 support</li>
<li>Now properly reports default values in Connection.info/.as_uri</li>
</ul>
</div>
<div class="section" id="version-1-1-6">
<span id="id38"></span><h2>1.1.6<a class="headerlink" href="#version-1-1-6" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-06-13 04:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Redis: Fixes issue introduced in 1.1.4, where a redis connection
failure could leave consumer hanging forever.</p>
</li>
<li><p class="first">SQS: Now supports fanout messaging by using SimpleDB to store routing
tables.</p>
<blockquote>
<div><p>This can be disabled by setting the <cite>supports_fanout</cite> transport option:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Connection</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s">&#39;SQS&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;supports_fanout&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">})</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p class="first">SQS: Now properly deletes a message when a message is acked.</p>
</li>
<li><p class="first">SQS: Can now set the Amazon AWS region, by using the <tt class="docutils literal"><span class="pre">region</span></tt>
transport option.</p>
</li>
<li><p class="first">amqplib: Now uses <cite>localhost</cite> as default hostname instead of raising an
error.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-1-5">
<span id="id39"></span><h2>1.1.5<a class="headerlink" href="#version-1-1-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-06-07 06:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Fixes compatibility with redis-py 2.4.4.</li>
</ul>
</div>
<div class="section" id="version-1-1-4">
<span id="id40"></span><h2>1.1.4<a class="headerlink" href="#version-1-1-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-06-07 04:00 P.M BST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Redis transport: Now requires redis-py version 2.4.4 or later.</p>
</li>
<li><p class="first">New Amazon SQS transport added.</p>
<blockquote>
<div><p>Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">conn</span> <span class="o">=</span> <span class="n">Connection</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s">&#39;SQS&#39;</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">userid</span><span class="o">=</span><span class="n">aws_access_key_id</span><span class="p">,</span>
<span class="gp">... </span>                  <span class="n">password</span><span class="o">=</span><span class="n">aws_secret_access_key</span><span class="p">)</span>
</pre></div>
</div>
<p>The environment variables <span class="target" id="index-2"></span><tt class="xref std std-envvar docutils literal"><span class="pre">AWS_ACCESS_KEY_ID</span></tt> and
<span class="target" id="index-3"></span><tt class="xref std std-envvar docutils literal"><span class="pre">AWS_SECRET_ACCESS_KEY</span></tt> are also supported.</p>
</div></blockquote>
</li>
<li><p class="first">librabbitmq transport: Fixes default credentials support.</p>
</li>
<li><p class="first">amqplib transport: Now supports <cite>login_method</cite> for SSL auth.</p>
<blockquote>
<div><p><tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt> now supports the <cite>login_method</cite>
keyword argument.</p>
<p>Default <cite>login_method</cite> is <tt class="docutils literal"><span class="pre">AMQPLAIN</span></tt>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-1-3">
<span id="id41"></span><h2>1.1.3<a class="headerlink" href="#version-1-1-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-04-21 16:00 P.M CEST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Redis: Consuming from multiple connections now works with Eventlet.</p>
</li>
<li><p class="first">Redis: Can now perform channel operations while the channel is in
BRPOP/LISTEN mode (Issue #35).</p>
<blockquote>
<div><p>Also the async BRPOP now times out after 1 second, this means that
cancelling consuming from a queue/starting consuming from additional queues
has a latency of up to one second (BRPOP does not support subsecond
timeouts).</p>
</div></blockquote>
</li>
<li><p class="first">Virtual: Allow channel objects to be closed multiple times without error.</p>
</li>
<li><p class="first">amqplib: <tt class="docutils literal"><span class="pre">AttributeError</span></tt> has been added to the list of known
connection related errors (<tt class="xref py py-attr docutils literal"><span class="pre">Connection.connection_errors</span></tt>).</p>
</li>
<li><p class="first">amqplib: Now converts <tt class="xref py py-exc docutils literal"><span class="pre">SSLError</span></tt> timeout errors to
<a class="reference external" href="http://www.python.jp/doc/release/library/socket.html#socket.timeout" title="(in Python v2.7)"><tt class="xref py py-exc docutils literal"><span class="pre">socket.timeout</span></tt></a> (<a class="reference external" href="http://bugs.python.org/issue10272">http://bugs.python.org/issue10272</a>)</p>
</li>
<li><p class="first">Ensures cyclic references are destroyed when the connection is closed.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-1-2">
<span id="id42"></span><h2>1.1.2<a class="headerlink" href="#version-1-1-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-04-06 16:00 P.M CEST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Redis: Fixes serious issue where messages could be lost.</p>
<blockquote>
<div><p>The issue could happen if the message exceeded a certain number
of kilobytes in size.</p>
<p>It is recommended that all users of the Redis transport should
upgrade to this version, even if not currently experiencing any
issues.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-1-1">
<span id="id43"></span><h2>1.1.1<a class="headerlink" href="#version-1-1-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-04-05 15:51 P.M CEST</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>1.1.0 started using <tt class="docutils literal"><span class="pre">Queue.LifoQueue</span></tt> which is only available
in Python 2.6+ (Issue #33).  We now ship with our own LifoQueue.</li>
</ul>
</div>
<div class="section" id="version-1-1-0">
<span id="id44"></span><h2>1.1.0<a class="headerlink" href="#version-1-1-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-04-05 01:05 P.M CEST</td>
</tr>
</tbody>
</table>
<div class="section" id="v110-important">
<span id="id45"></span><h3>Important Notes<a class="headerlink" href="#v110-important" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Virtual transports: Message body is now base64 encoded by default
(Issue #27).</p>
<blockquote>
<div><p>This should solve problems sending binary data with virtual
transports.</p>
<p>Message compatibility is handled by adding a <tt class="docutils literal"><span class="pre">body_encoding</span></tt>
property, so messages sent by older versions is compatible
with this release.  However &#8211; If you are accessing the messages
directly not using Kombu, then you have to respect
the <tt class="docutils literal"><span class="pre">body_encoding</span></tt> property.</p>
<p>If you need to disable base64 encoding then you can do so
via the transport options:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Connection</span><span class="p">(</span><span class="n">transport</span><span class="o">=</span><span class="s">&#39;...&#39;</span><span class="p">,</span>
           <span class="n">transport_options</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;body_encoding&#39;</span><span class="p">:</span> <span class="bp">None</span><span class="p">})</span>
</pre></div>
</div>
<p><strong>For transport authors</strong>:</p>
<blockquote>
<div><p>You don&#8217;t have to change anything in your custom transports,
as this is handled automatically by the base class.</p>
<p>If you want to use a different encoder you can do so by adding
a key to <tt class="docutils literal"><span class="pre">Channel.codecs</span></tt>.  Default encoding is specified
by the <tt class="docutils literal"><span class="pre">Channel.body_encoding</span></tt> attribute.</p>
<p>A new codec must provide two methods: <tt class="docutils literal"><span class="pre">encode(data)</span></tt> and
<tt class="docutils literal"><span class="pre">decode(data)</span></tt>.</p>
</div></blockquote>
</div></blockquote>
</li>
<li><p class="first">ConnectionPool/ChannelPool/Resource: Setting <tt class="docutils literal"><span class="pre">limit=None</span></tt> (or 0)
now disables pool semantics, and will establish and close
the resource whenever acquired or released.</p>
</li>
<li><p class="first">ConnectionPool/ChannelPool/Resource: Is now using a LIFO queue
instead of the previous FIFO behavior.</p>
<blockquote>
<div><p>This means that the last resource released will be the one
acquired next.  I.e. if only a single thread is using the pool
this means only a single connection will ever be used.</p>
</div></blockquote>
</li>
<li><p class="first">Connection: Cloned connections did not inherit transport_options
(<tt class="docutils literal"><span class="pre">__copy__</span></tt>).</p>
</li>
<li><p class="first">contrib/requirements is now located in the top directory
of the distribution.</p>
</li>
<li><p class="first">MongoDB: Now supports authentication using the <tt class="docutils literal"><span class="pre">userid</span></tt> and <tt class="docutils literal"><span class="pre">password</span></tt>
arguments to <tt class="xref py py-class docutils literal"><span class="pre">Connection</span></tt> (Issue #30).</p>
</li>
<li><p class="first">Connection: Default autentication credentials are now delegated to
the individual transports.</p>
<blockquote>
<div><p>This means that the <tt class="docutils literal"><span class="pre">userid</span></tt> and <tt class="docutils literal"><span class="pre">password</span></tt> arguments to
Connection is no longer <em>guest/guest</em> by default.</p>
<p>The amqplib and pika transports will still have the default
credentials.</p>
</div></blockquote>
</li>
<li><p class="first"><tt class="xref py py-meth docutils literal"><span class="pre">Consumer.__exit__()</span></tt> did not have the correct signature (Issue #32).</p>
</li>
<li><p class="first">Channel objects now have a <tt class="docutils literal"><span class="pre">channel_id</span></tt> attribute.</p>
</li>
<li><dl class="first docutils">
<dt>MongoDB: Version sniffing broke with development versions of</dt>
<dd><p class="first last">mongod (Issue #29).</p>
</dd>
</dl>
</li>
<li><p class="first">New environment variable <span class="target" id="index-4"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_CONNECTION</span></tt> will now emit debug
log messages for connection related actions.</p>
<p><span class="target" id="index-5"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_DEBUG</span></tt> will also enable <span class="target" id="index-6"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_CONNECTION</span></tt>.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="version-1-0-7">
<span id="id46"></span><h2>1.0.7<a class="headerlink" href="#version-1-0-7" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-03-28 05:45 P.M CEST</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Now depends on anyjson 0.3.1</p>
<blockquote>
<div><p>cjson is no longer a recommended json implementation, and anyjson
will now emit a deprecation warning if used.</p>
</div></blockquote>
</li>
<li><p class="first">Please note that the Pika backend only works with version 0.5.2.</p>
<blockquote>
<div><p>The latest version (0.9.x) drastically changed API, and it is not
compatible yet.</p>
</div></blockquote>
</li>
<li><p class="first">on_decode_error is now called for exceptions in message_to_python
(Issue #24).</p>
</li>
<li><p class="first">Redis: did not respect QoS settings.</p>
</li>
<li><p class="first">Redis: Creating a connection now ensures the connection is established.</p>
<blockquote>
<div><p>This means <tt class="docutils literal"><span class="pre">Connection.ensure_connection</span></tt> works properly with
Redis.</p>
</div></blockquote>
</li>
<li><p class="first">consumer_tag argument to <tt class="docutils literal"><span class="pre">Queue.consume</span></tt> can&#8217;t be <tt class="xref py py-const docutils literal"><span class="pre">None</span></tt>
(Issue #21).</p>
<blockquote>
<div><p>A None value is now automatically converted to empty string.
An empty string will make the server generate a unique tag.</p>
</div></blockquote>
</li>
<li><p class="first">Connection now supports a <tt class="docutils literal"><span class="pre">transport_options</span></tt> argument.</p>
<blockquote>
<div><p>This can be used to pass additional arguments to transports.</p>
</div></blockquote>
</li>
<li><p class="first">Pika: <tt class="docutils literal"><span class="pre">drain_events</span></tt> raised <a class="reference external" href="http://www.python.jp/doc/release/library/socket.html#socket.timeout" title="(in Python v2.7)"><tt class="xref py py-exc docutils literal"><span class="pre">socket.timeout</span></tt></a> even if no timeout
set (Issue #8).</p>
</li>
</ul>
</div>
<div class="section" id="id47">
<h2>1.0.6<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-03-22 04:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">The <tt class="docutils literal"><span class="pre">delivery_mode</span></tt> aliases (persistent/transient) were not automatically
converted to integer, and would cause a crash if using the amqplib
transport.</p>
</li>
<li><p class="first">Redis: The redis-py <tt class="xref py py-exc docutils literal"><span class="pre">InvalidData</span></tt> exception suddenly changed name to
<tt class="xref py py-exc docutils literal"><span class="pre">DataError</span></tt>.</p>
</li>
<li><p class="first">The <span class="target" id="index-7"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_DEBUG</span></tt> environment variable can now be set to log all
channel method calls.</p>
<p>Support for the following environment variables have been added:</p>
<blockquote>
<div><ul class="simple">
<li><span class="target" id="index-8"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_CHANNEL</span></tt> will wrap channels in an object that
logs every method call.</li>
<li><span class="target" id="index-9"></span><tt class="xref std std-envvar docutils literal"><span class="pre">KOMBU_LOG_DEBUG</span></tt> both enables channel logging and configures the
root logger to emit messages to standard error.</li>
</ul>
<p><strong>Example Usage</strong>:</p>
<div class="highlight-python"><pre>$ KOMBU_LOG_DEBUG=1 python
&gt;&gt;&gt; from kombu import Connection
&gt;&gt;&gt; conn = Connection()
&gt;&gt;&gt; channel = conn.channel()
Start from server, version: 8.0, properties:
    {u'product': 'RabbitMQ',..............  }
Open OK! known_hosts []
using channel_id: 1
Channel open
&gt;&gt;&gt; channel.queue_declare('myq', passive=True)
[Kombu channel:1] queue_declare('myq', passive=True)
(u'myq', 0, 1)</pre>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-0-5">
<span id="id48"></span><h2>1.0.5<a class="headerlink" href="#version-1-0-5" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-03-17 04:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Fixed memory leak when creating virtual channels.  All virtual transports
affected (redis, mongodb, memory, django, sqlalchemy, couchdb, beanstalk).</p>
</li>
<li><p class="first">Virtual Transports: Fixed potential race condition when acking messages.</p>
<blockquote>
<div><p>If you have been affected by this, the error would show itself as an
exception raised by the OrderedDict implementation. (<tt class="docutils literal"><span class="pre">object</span> <span class="pre">no</span> <span class="pre">longer</span>
<span class="pre">exists</span></tt>).</p>
</div></blockquote>
</li>
<li><p class="first">MongoDB transport requires the <tt class="docutils literal"><span class="pre">findandmodify</span></tt> command only available in
MongoDB 1.3+, so now raises an exception if connected to an incompatible
server version.</p>
</li>
<li><p class="first">Virtual Transports: <tt class="docutils literal"><span class="pre">basic.cancel</span></tt> should not try to remove unknown
consumer tag.</p>
</li>
</ul>
</div>
<div class="section" id="version-1-0-4">
<span id="id49"></span><h2>1.0.4<a class="headerlink" href="#version-1-0-4" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-02-28 04:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul>
<li><p class="first">Added Transport.polling_interval</p>
<blockquote>
<div><p>Used by django-kombu to increase the time to sleep between SELECTs when
there are no messages in the queue.</p>
<p>Users of django-kombu should upgrade to django-kombu v0.9.2.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="version-1-0-3">
<span id="id50"></span><h2>1.0.3<a class="headerlink" href="#version-1-0-3" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-02-12 04:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>ConnectionPool: Re-connect if amqplib connection closed</li>
<li>Adds <tt class="docutils literal"><span class="pre">Queue.as_dict</span></tt> + <tt class="docutils literal"><span class="pre">Exchange.as_dict</span></tt>.</li>
<li>Copyright headers updated to include 2011.</li>
</ul>
</div>
<div class="section" id="version-1-0-2">
<span id="id51"></span><h2>1.0.2<a class="headerlink" href="#version-1-0-2" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-01-31 10:45 P.M CET</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>amqplib: Message properties were not set properly.</li>
<li>Ghettoq backend names are now automatically translated to the new names.</li>
</ul>
</div>
<div class="section" id="version-1-0-1">
<span id="id52"></span><h2>1.0.1<a class="headerlink" href="#version-1-0-1" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-01-28 12:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Redis: Now works with Linux (epoll)</li>
</ul>
</div>
<div class="section" id="version-1-0-0">
<span id="id53"></span><h2>1.0.0<a class="headerlink" href="#version-1-0-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2011-01-27 12:00 P.M CET</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Initial release</li>
</ul>
</div>
<div class="section" id="version-0-1-0">
<span id="id54"></span><h2>0.1.0<a class="headerlink" href="#version-0-1-0" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">release-date:</th><td class="field-body">2010-07-22 04:20 P.M CET</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>Initial fork of carrot</li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        <a href="/">Home</a>:
        <a class="uplink" href="../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, HDKNR.COM.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.2pre/3c28de26aac2.
    </div>
  </body>
</html>